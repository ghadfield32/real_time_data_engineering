-- =============================================================================
-- 00_catalog_rest.sql.tmpl â€” Iceberg REST Catalog Init (CATALOG=rest)
-- =============================================================================
-- Used when CATALOG=rest (Lakekeeper REST catalog from catalog.rest-lakekeeper.yml).
-- Rendered by scripts/render_sql.py from environment variables.
-- =============================================================================

CREATE CATALOG IF NOT EXISTS iceberg_catalog WITH (
    'type'            = 'iceberg',
    'catalog-type'    = 'rest',
    'uri'             = 'http://lakekeeper:8181/catalog',
    'warehouse'       = 'iceberg_catalog',
    'io-impl'         = 'org.apache.iceberg.aws.s3.S3FileIO',
    'fs.s3a.endpoint' = '${S3_ENDPOINT}',
    'fs.s3a.path.style.access'      = '${S3_PATH_STYLE}',
    'fs.s3a.connection.ssl.enabled' = '${S3_USE_SSL}',
    'fs.s3a.access.key'  = '${AWS_ACCESS_KEY_ID}',
    'fs.s3a.secret.key'  = '${AWS_SECRET_ACCESS_KEY}'
);

USE CATALOG iceberg_catalog;

CREATE DATABASE IF NOT EXISTS bronze;
CREATE DATABASE IF NOT EXISTS silver;
