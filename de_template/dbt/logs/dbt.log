[0m13:54:07.910383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70aada0a8aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70aada2167b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70aada53c1a0>]}


============================== 13:54:07.915592 | 5e92f7f9-e086-44d2-8563-7886d8f3e580 ==============================
[0m13:54:07.915592 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:54:07.916064 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'log_cache_events': 'False', 'log_format': 'default', 'empty': 'None', 'log_path': '/dbt/logs', 'version_check': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'quiet': 'False', 'introspect': 'True', 'profiles_dir': '.', 'invocation_command': 'dbt deps --profiles-dir .', 'static_parser': 'True', 'no_print': 'None', 'printer_width': '80', 'cache_selected_only': 'False'}
[0m13:54:07.984924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e92f7f9-e086-44d2-8563-7886d8f3e580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70aad9909190>]}
[0m13:54:07.996353 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-xqid23zu'
[0m13:54:07.996897 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:54:08.350650 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:54:08.351827 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:54:08.486443 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:54:08.495354 [info ] [MainThread]: Updating lock file in file path: /dbt/package-lock.yml
[0m13:54:08.503477 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vfzf4j3y'
[0m13:54:08.505179 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:54:11.173934 [info ] [MainThread]: Installed from version 1.3.3
[0m13:54:11.174358 [info ] [MainThread]: Up to date!
[0m13:54:11.174878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5e92f7f9-e086-44d2-8563-7886d8f3e580', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70aad96e1880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70aad96e2120>]}
[0m13:54:11.176339 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 3.33351, "process_in_blocks": "3960", "process_kernel_time": 0.381177, "process_mem_max_rss": "107188", "process_out_blocks": "3400", "process_user_time": 1.031421}
[0m13:54:11.176736 [debug] [MainThread]: Command `dbt deps` succeeded at 13:54:11.176653 after 3.33 seconds
[0m13:54:11.177052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70aada10df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70aad9909190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70aad96e2120>]}
[0m13:54:11.177343 [debug] [MainThread]: Flushing usage events
[0m13:54:14.885744 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:54:15.777713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7566a494ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7566a3dfe540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7566a494f1a0>]}


============================== 13:54:15.780167 | d29b19d9-f4ff-4134-900c-c096522f9002 ==============================
[0m13:54:15.780167 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:54:15.780598 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'introspect': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'profiles_dir': '.', 'quiet': 'False', 'target_path': 'None', 'invocation_command': 'dbt build --full-refresh --profiles-dir .', 'write_json': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'empty': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'log_format': 'default', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': '/dbt/logs'}
[0m13:54:15.903709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd29b19d9-f4ff-4134-900c-c096522f9002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756693d60aa0>]}
[0m13:54:15.936041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd29b19d9-f4ff-4134-900c-c096522f9002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7566a4783020>]}
[0m13:54:15.937414 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m13:54:15.979245 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m13:54:15.983398 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:54:15.983780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd29b19d9-f4ff-4134-900c-c096522f9002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756693c4f0b0>]}
[0m13:54:17.648980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd29b19d9-f4ff-4134-900c-c096522f9002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7566909aa9c0>]}
[0m13:54:17.724403 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:54:17.728344 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:54:17.757890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd29b19d9-f4ff-4134-900c-c096522f9002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756655457e00>]}
[0m13:54:17.758422 [info ] [MainThread]: Found 16 models, 79 data tests, 4 seeds, 1 source, 607 macros
[0m13:54:17.762226 [info ] [MainThread]: 
[0m13:54:17.762723 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:54:17.763009 [info ] [MainThread]: 
[0m13:54:17.763477 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:54:17.767840 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_de_pipeline'
[0m13:54:17.771920 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_de_pipeline'
[0m13:54:17.773328 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_de_pipeline'
[0m13:54:17.773924 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_de_pipeline'
[0m13:54:17.800821 [debug] [ThreadPool]: Using duckdb connection "list_de_pipeline"
[0m13:54:17.801119 [debug] [ThreadPool]: Using duckdb connection "list_de_pipeline"
[0m13:54:17.801337 [debug] [ThreadPool]: On list_de_pipeline: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "list_de_pipeline"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"de_pipeline"'
    
  
  
[0m13:54:17.801582 [debug] [ThreadPool]: Using duckdb connection "list_de_pipeline"
[0m13:54:17.801787 [debug] [ThreadPool]: Using duckdb connection "list_de_pipeline"
[0m13:54:17.801951 [debug] [ThreadPool]: On list_de_pipeline: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "list_de_pipeline"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"de_pipeline"'
    
  
  
[0m13:54:17.802286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:17.802515 [debug] [ThreadPool]: On list_de_pipeline: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "list_de_pipeline"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"de_pipeline"'
    
  
  
[0m13:54:17.802800 [debug] [ThreadPool]: On list_de_pipeline: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "list_de_pipeline"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"de_pipeline"'
    
  
  
[0m13:54:17.803017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:17.803518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:17.804136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:21.535479 [debug] [ThreadPool]: SQL status: OK in 3.733 seconds
[0m13:54:21.535887 [debug] [ThreadPool]: SQL status: OK in 3.733 seconds
[0m13:54:21.536799 [debug] [ThreadPool]: On list_de_pipeline: Close
[0m13:54:21.537838 [debug] [ThreadPool]: On list_de_pipeline: Close
[0m13:54:21.538717 [debug] [ThreadPool]: SQL status: OK in 3.735 seconds
[0m13:54:21.539920 [debug] [ThreadPool]: On list_de_pipeline: Close
[0m13:54:21.540477 [debug] [ThreadPool]: SQL status: OK in 3.736 seconds
[0m13:54:21.541204 [debug] [ThreadPool]: On list_de_pipeline: Close
[0m13:54:21.541720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de_pipeline, now create_de_pipeline_main_marts)
[0m13:54:21.541974 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de_pipeline, now create_de_pipeline_main_staging)
[0m13:54:21.542282 [debug] [ThreadPool]: Creating schema "database: "de_pipeline"
schema: "main_marts"
"
[0m13:54:21.542502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de_pipeline, now create_de_pipeline_main_intermediate)
[0m13:54:21.542761 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de_pipeline, now create_de_pipeline_main_raw)
[0m13:54:21.543132 [debug] [ThreadPool]: Creating schema "database: "de_pipeline"
schema: "main_staging"
"
[0m13:54:21.546905 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_marts"
[0m13:54:21.547528 [debug] [ThreadPool]: Creating schema "database: "de_pipeline"
schema: "main_intermediate"
"
[0m13:54:21.547974 [debug] [ThreadPool]: Creating schema "database: "de_pipeline"
schema: "main_raw"
"
[0m13:54:21.549040 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_staging"
[0m13:54:21.549300 [debug] [ThreadPool]: On create_de_pipeline_main_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "create_de_pipeline_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='de_pipeline'
        and type='sqlite'
    
  
[0m13:54:21.550365 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_intermediate"
[0m13:54:21.551592 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_raw"
[0m13:54:21.551895 [debug] [ThreadPool]: On create_de_pipeline_main_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "create_de_pipeline_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='de_pipeline'
        and type='sqlite'
    
  
[0m13:54:21.552215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:21.552511 [debug] [ThreadPool]: On create_de_pipeline_main_intermediate: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "create_de_pipeline_main_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='de_pipeline'
        and type='sqlite'
    
  
[0m13:54:21.552804 [debug] [ThreadPool]: On create_de_pipeline_main_raw: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "create_de_pipeline_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='de_pipeline'
        and type='sqlite'
    
  
[0m13:54:21.553053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:21.553674 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:21.553979 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:21.555205 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:54:21.556085 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_marts"
[0m13:54:21.556325 [debug] [ThreadPool]: On create_de_pipeline_main_marts: BEGIN
[0m13:54:21.556671 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:54:21.556937 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_marts"
[0m13:54:21.557171 [debug] [ThreadPool]: On create_de_pipeline_main_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "create_de_pipeline_main_marts"} */

    
    
        create schema if not exists "de_pipeline"."main_marts"
    
[0m13:54:21.557577 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:54:21.557761 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m13:54:21.558292 [debug] [ThreadPool]: On create_de_pipeline_main_marts: COMMIT
[0m13:54:21.559029 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_staging"
[0m13:54:21.559433 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_marts"
[0m13:54:21.559900 [debug] [ThreadPool]: On create_de_pipeline_main_staging: BEGIN
[0m13:54:21.560141 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m13:54:21.560318 [debug] [ThreadPool]: On create_de_pipeline_main_marts: COMMIT
[0m13:54:21.561336 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_intermediate"
[0m13:54:21.561558 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:54:21.561852 [debug] [ThreadPool]: On create_de_pipeline_main_intermediate: BEGIN
[0m13:54:21.562107 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_staging"
[0m13:54:21.562342 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m13:54:21.562631 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:54:21.562820 [debug] [ThreadPool]: On create_de_pipeline_main_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "create_de_pipeline_main_staging"} */

    
    
        create schema if not exists "de_pipeline"."main_staging"
    
[0m13:54:21.563537 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_raw"
[0m13:54:21.563688 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_intermediate"
[0m13:54:21.564052 [debug] [ThreadPool]: On create_de_pipeline_main_raw: BEGIN
[0m13:54:21.564459 [debug] [ThreadPool]: On create_de_pipeline_main_intermediate: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "create_de_pipeline_main_intermediate"} */

    
    
        create schema if not exists "de_pipeline"."main_intermediate"
    
[0m13:54:21.564865 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:54:21.565178 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_raw"
[0m13:54:21.565406 [debug] [ThreadPool]: On create_de_pipeline_main_raw: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "create_de_pipeline_main_raw"} */

    
    
        create schema if not exists "de_pipeline"."main_raw"
    
[0m13:54:21.565950 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m13:54:21.566134 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:54:21.566341 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:54:21.566522 [debug] [ThreadPool]: On create_de_pipeline_main_marts: Close
[0m13:54:21.566701 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:54:21.567353 [debug] [ThreadPool]: On create_de_pipeline_main_intermediate: COMMIT
[0m13:54:21.567855 [debug] [ThreadPool]: On create_de_pipeline_main_staging: COMMIT
[0m13:54:21.568576 [debug] [ThreadPool]: On create_de_pipeline_main_raw: COMMIT
[0m13:54:21.568894 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_intermediate"
[0m13:54:21.569189 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_staging"
[0m13:54:21.569440 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_raw"
[0m13:54:21.569642 [debug] [ThreadPool]: On create_de_pipeline_main_intermediate: COMMIT
[0m13:54:21.569934 [debug] [ThreadPool]: On create_de_pipeline_main_staging: COMMIT
[0m13:54:21.570170 [debug] [ThreadPool]: On create_de_pipeline_main_raw: COMMIT
[0m13:54:21.574620 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m13:54:21.574994 [debug] [ThreadPool]: On create_de_pipeline_main_intermediate: Close
[0m13:54:21.577077 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m13:54:21.577367 [debug] [ThreadPool]: On create_de_pipeline_main_raw: Close
[0m13:54:21.580365 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m13:54:21.580643 [debug] [ThreadPool]: On create_de_pipeline_main_staging: Close
[0m13:54:21.582220 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_de_pipeline_main_staging, now list_de_pipeline_main_marts)
[0m13:54:21.582530 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_de_pipeline_main_raw, now list_de_pipeline_main_staging)
[0m13:54:21.585579 [debug] [ThreadPool]: Using duckdb connection "list_de_pipeline_main_marts"
[0m13:54:21.585826 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_de_pipeline_main_marts, now list_de_pipeline_main_intermediate)
[0m13:54:21.586166 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_de_pipeline_main_intermediate, now list_de_pipeline_main_raw)
[0m13:54:21.587862 [debug] [ThreadPool]: Using duckdb connection "list_de_pipeline_main_staging"
[0m13:54:21.588264 [debug] [ThreadPool]: On list_de_pipeline_main_marts: BEGIN
[0m13:54:21.589329 [debug] [ThreadPool]: Using duckdb connection "list_de_pipeline_main_intermediate"
[0m13:54:21.590488 [debug] [ThreadPool]: Using duckdb connection "list_de_pipeline_main_raw"
[0m13:54:21.591051 [debug] [ThreadPool]: On list_de_pipeline_main_staging: BEGIN
[0m13:54:21.591369 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:21.591648 [debug] [ThreadPool]: On list_de_pipeline_main_intermediate: BEGIN
[0m13:54:21.591898 [debug] [ThreadPool]: On list_de_pipeline_main_raw: BEGIN
[0m13:54:21.592258 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:21.592864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:21.593291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:21.594028 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:54:21.594282 [debug] [ThreadPool]: Using duckdb connection "list_de_pipeline_main_marts"
[0m13:54:21.594525 [debug] [ThreadPool]: On list_de_pipeline_main_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "list_de_pipeline_main_marts"} */
select
      'de_pipeline' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'de_pipeline'
  
[0m13:54:21.595256 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:54:21.595544 [debug] [ThreadPool]: Using duckdb connection "list_de_pipeline_main_staging"
[0m13:54:21.595757 [debug] [ThreadPool]: On list_de_pipeline_main_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "list_de_pipeline_main_staging"} */
select
      'de_pipeline' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'de_pipeline'
  
[0m13:54:21.596515 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m13:54:21.596878 [debug] [ThreadPool]: Using duckdb connection "list_de_pipeline_main_intermediate"
[0m13:54:21.597161 [debug] [ThreadPool]: On list_de_pipeline_main_intermediate: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "list_de_pipeline_main_intermediate"} */
select
      'de_pipeline' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_intermediate'
    and lower(table_catalog) = 'de_pipeline'
  
[0m13:54:21.598012 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m13:54:21.598284 [debug] [ThreadPool]: Using duckdb connection "list_de_pipeline_main_raw"
[0m13:54:21.598654 [debug] [ThreadPool]: On list_de_pipeline_main_raw: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "list_de_pipeline_main_raw"} */
select
      'de_pipeline' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'de_pipeline'
  
[0m13:54:21.599948 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m13:54:21.600166 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m13:54:21.600374 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:54:21.600672 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:54:21.601307 [debug] [ThreadPool]: On list_de_pipeline_main_marts: ROLLBACK
[0m13:54:21.601900 [debug] [ThreadPool]: On list_de_pipeline_main_staging: ROLLBACK
[0m13:54:21.602445 [debug] [ThreadPool]: On list_de_pipeline_main_intermediate: ROLLBACK
[0m13:54:21.602996 [debug] [ThreadPool]: On list_de_pipeline_main_raw: ROLLBACK
[0m13:54:21.603599 [debug] [ThreadPool]: Failed to rollback 'list_de_pipeline_main_marts'
[0m13:54:21.603997 [debug] [ThreadPool]: Failed to rollback 'list_de_pipeline_main_staging'
[0m13:54:21.604364 [debug] [ThreadPool]: Failed to rollback 'list_de_pipeline_main_intermediate'
[0m13:54:21.604947 [debug] [ThreadPool]: Failed to rollback 'list_de_pipeline_main_raw'
[0m13:54:21.606041 [debug] [ThreadPool]: On list_de_pipeline_main_raw: Close
[0m13:54:21.605488 [debug] [ThreadPool]: On list_de_pipeline_main_staging: Close
[0m13:54:21.605787 [debug] [ThreadPool]: On list_de_pipeline_main_intermediate: Close
[0m13:54:21.605236 [debug] [ThreadPool]: On list_de_pipeline_main_marts: Close
[0m13:54:21.607403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd29b19d9-f4ff-4134-900c-c096522f9002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75665579af30>]}
[0m13:54:21.607770 [debug] [MainThread]: Using duckdb connection "master"
[0m13:54:21.607993 [debug] [MainThread]: On master: BEGIN
[0m13:54:21.608227 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:54:21.609161 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:54:21.609395 [debug] [MainThread]: On master: COMMIT
[0m13:54:21.609620 [debug] [MainThread]: Using duckdb connection "master"
[0m13:54:21.609797 [debug] [MainThread]: On master: COMMIT
[0m13:54:21.610162 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:54:21.610421 [debug] [MainThread]: On master: Close
[0m13:54:21.614667 [debug] [Thread-1 (]: Began running node model.de_pipeline.dim_dates
[0m13:54:21.614900 [debug] [Thread-2 (]: Began running node model.de_pipeline.stg_yellow_trips
[0m13:54:21.615108 [debug] [Thread-3 (]: Began running node seed.de_pipeline.payment_type_lookup
[0m13:54:21.615584 [debug] [Thread-4 (]: Began running node seed.de_pipeline.rate_code_lookup
[0m13:54:21.615406 [info ] [Thread-1 (]: 1 of 99 START sql table model main_marts.dim_dates ............................. [RUN]
[0m13:54:21.616118 [info ] [Thread-2 (]: 2 of 99 START sql table model main_staging.stg_yellow_trips .................... [RUN]
[0m13:54:21.616472 [info ] [Thread-3 (]: 3 of 99 START seed file main_raw.payment_type_lookup ........................... [RUN]
[0m13:54:21.616857 [info ] [Thread-4 (]: 4 of 99 START seed file main_raw.rate_code_lookup .............................. [RUN]
[0m13:54:21.617268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de_pipeline_main_marts, now model.de_pipeline.dim_dates)
[0m13:54:21.617601 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_de_pipeline_main_intermediate, now model.de_pipeline.stg_yellow_trips)
[0m13:54:21.617889 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_de_pipeline_main_staging, now seed.de_pipeline.payment_type_lookup)
[0m13:54:21.618239 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_de_pipeline_main_raw, now seed.de_pipeline.rate_code_lookup)
[0m13:54:21.618534 [debug] [Thread-1 (]: Began compiling node model.de_pipeline.dim_dates
[0m13:54:21.618858 [debug] [Thread-2 (]: Began compiling node model.de_pipeline.stg_yellow_trips
[0m13:54:21.619614 [debug] [Thread-3 (]: Began compiling node seed.de_pipeline.payment_type_lookup
[0m13:54:21.620157 [debug] [Thread-4 (]: Began compiling node seed.de_pipeline.rate_code_lookup
[0m13:54:21.626475 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.dim_dates"
[0m13:54:21.627918 [debug] [Thread-2 (]: Writing injected SQL for node "model.de_pipeline.stg_yellow_trips"
[0m13:54:21.628289 [debug] [Thread-3 (]: Began executing node seed.de_pipeline.payment_type_lookup
[0m13:54:21.628687 [debug] [Thread-4 (]: Began executing node seed.de_pipeline.rate_code_lookup
[0m13:54:21.628999 [debug] [Thread-1 (]: On model.de_pipeline.dim_dates: BEGIN
[0m13:54:21.638416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:21.644482 [debug] [Thread-3 (]: Using duckdb connection "seed.de_pipeline.payment_type_lookup"
[0m13:54:21.644859 [debug] [Thread-3 (]: On seed.de_pipeline.payment_type_lookup: BEGIN
[0m13:54:21.645139 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:21.645702 [debug] [Thread-4 (]: Using duckdb connection "seed.de_pipeline.rate_code_lookup"
[0m13:54:21.646089 [debug] [Thread-4 (]: On seed.de_pipeline.rate_code_lookup: BEGIN
[0m13:54:21.646307 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m13:54:21.646518 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:21.647064 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.dim_dates"
[0m13:54:21.647514 [debug] [Thread-1 (]: On model.de_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_dates"} */


        select 
        (date_diff('day', cast('2024-01-01' as date)::timestamp, cast('2024-02-01' as date)::timestamp ))
    
[0m13:54:21.648229 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:54:21.648416 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:21.648641 [debug] [Thread-3 (]: Using duckdb connection "seed.de_pipeline.payment_type_lookup"
[0m13:54:21.649813 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_pipeline.dim_dates"
[0m13:54:21.650050 [debug] [Thread-3 (]: On seed.de_pipeline.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "seed.de_pipeline.payment_type_lookup"} */

    create table "de_pipeline"."main_raw"."payment_type_lookup" ("payment_type_id" INTEGER,"payment_type_name" VARCHAR)
  
[0m13:54:21.650760 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m13:54:21.651127 [debug] [Thread-4 (]: Using duckdb connection "seed.de_pipeline.rate_code_lookup"
[0m13:54:21.651346 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:54:21.651557 [debug] [Thread-4 (]: On seed.de_pipeline.rate_code_lookup: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "seed.de_pipeline.rate_code_lookup"} */

    create table "de_pipeline"."main_raw"."rate_code_lookup" ("rate_code_id" INTEGER,"rate_code_name" VARCHAR)
  
[0m13:54:21.657841 [debug] [Thread-3 (]: Using duckdb connection "seed.de_pipeline.payment_type_lookup"
[0m13:54:21.658348 [debug] [Thread-3 (]: On seed.de_pipeline.payment_type_lookup: 
          COPY "de_pipeline"."main_raw"."payment_type_lookup" FROM '/dbt/seeds/payment_type_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:54:21.658601 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m13:54:21.659430 [debug] [Thread-4 (]: Using duckdb connection "seed.de_pipeline.rate_code_lookup"
[0m13:54:21.659659 [debug] [Thread-2 (]: Began executing node model.de_pipeline.stg_yellow_trips
[0m13:54:21.659873 [debug] [Thread-4 (]: On seed.de_pipeline.rate_code_lookup: 
          COPY "de_pipeline"."main_raw"."rate_code_lookup" FROM '/dbt/seeds/rate_code_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:54:21.673449 [debug] [Thread-2 (]: Writing runtime sql for node "model.de_pipeline.stg_yellow_trips"
[0m13:54:21.673803 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m13:54:21.676898 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.de_pipeline.payment_type_lookup"
[0m13:54:21.677170 [debug] [Thread-1 (]: Began executing node model.de_pipeline.dim_dates
[0m13:54:21.686532 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.dim_dates"
[0m13:54:21.687113 [debug] [Thread-1 (]: On model.de_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_dates"} */
DESCRIBE (select * from (
        /*
    Dimension table: Calendar dates for January 2024.
    Uses adapter-dispatched macros for dayname/monthname.
*/

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 31
    order by generated_number



),

all_periods as (

    select (
        

    (cast('2024-01-01' as date) + cast(row_number() over (order by generated_number) - 1 as bigint) * interval 1 day)
    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-02-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week_num,
        
    dayname(date_day)
 as day_of_week_name,
        
    monthname(date_day)
 as month_name,
        extract(week from date_day) as week_of_year,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when cast(date_day as date) in (
                cast('2024-01-01' as date),
                cast('2024-01-15' as date)
            ) then true
            else false
        end as is_holiday

    from date_spine
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:54:21.687609 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m13:54:21.689630 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.de_pipeline.rate_code_lookup"
[0m13:54:21.690838 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:21.697489 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.dim_dates"
[0m13:54:21.697893 [debug] [Thread-1 (]: On model.de_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_dates"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as date_key, 
      
    cast(null as bigint)
 as year, 
      
    cast(null as bigint)
 as month, 
      
    cast(null as bigint)
 as day_of_month, 
      
    cast(null as bigint)
 as day_of_week_num, 
      
    cast(null as varchar)
 as day_of_week_name, 
      
    cast(null as varchar)
 as month_name, 
      
    cast(null as bigint)
 as week_of_year, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as boolean)
 as is_holiday
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:54:21.698707 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:21.708477 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_pipeline.dim_dates"
[0m13:54:21.709722 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.stg_yellow_trips"
[0m13:54:21.716936 [debug] [Thread-4 (]: On seed.de_pipeline.rate_code_lookup: COMMIT
[0m13:54:21.717210 [debug] [Thread-2 (]: On model.de_pipeline.stg_yellow_trips: BEGIN
[0m13:54:21.718235 [debug] [Thread-3 (]: On seed.de_pipeline.payment_type_lookup: COMMIT
[0m13:54:21.718675 [debug] [Thread-4 (]: Using duckdb connection "seed.de_pipeline.rate_code_lookup"
[0m13:54:21.719004 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:21.719293 [debug] [Thread-3 (]: Using duckdb connection "seed.de_pipeline.payment_type_lookup"
[0m13:54:21.719591 [debug] [Thread-4 (]: On seed.de_pipeline.rate_code_lookup: COMMIT
[0m13:54:21.720205 [debug] [Thread-3 (]: On seed.de_pipeline.payment_type_lookup: COMMIT
[0m13:54:21.721490 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:54:21.721903 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.stg_yellow_trips"
[0m13:54:21.722169 [debug] [Thread-2 (]: On model.de_pipeline.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_yellow_trips"} */

  
    
    

    create  table
      "de_pipeline"."main_staging"."stg_yellow_trips__dbt_tmp"
  
    as (
      

with source as (
    select * from iceberg_scan('s3://warehouse/silver/cleaned_trips', allow_moved_paths = true)
),

final as (
    select
        -- Flink already generated the surrogate key
        trip_id,

        -- identifiers (already renamed and cast by Flink)
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        payment_type_id,

        -- timestamps (already parsed by Flink)
        cast(pickup_datetime as timestamp) as pickup_datetime,
        cast(dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        passenger_count,
        trip_distance_miles,
        store_and_fwd_flag,

        -- financials (already rounded by Flink)
        round(cast(fare_amount as decimal(10, 2)), 2) as fare_amount,
        round(cast(extra_amount as decimal(10, 2)), 2) as extra_amount,
        round(cast(mta_tax as decimal(10, 2)), 2) as mta_tax,
        round(cast(tip_amount as decimal(10, 2)), 2) as tip_amount,
        round(cast(tolls_amount as decimal(10, 2)), 2) as tolls_amount,
        round(cast(improvement_surcharge as decimal(10, 2)), 2) as improvement_surcharge,
        round(cast(total_amount as decimal(10, 2)), 2) as total_amount,
        round(cast(congestion_surcharge as decimal(10, 2)), 2) as congestion_surcharge,
        round(cast(airport_fee as decimal(10, 2)), 2) as airport_fee

    from source
    -- Flink already applied quality filters; this is a safety net
    where pickup_datetime is not null
      and dropoff_datetime is not null
)

select * from final
    );
  
  
[0m13:54:21.722730 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:54:21.723841 [debug] [Thread-4 (]: On seed.de_pipeline.rate_code_lookup: Close
[0m13:54:21.724948 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd29b19d9-f4ff-4134-900c-c096522f9002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7566a655e9c0>]}
[0m13:54:21.725196 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m13:54:21.725574 [info ] [Thread-4 (]: 4 of 99 OK loaded seed file main_raw.rate_code_lookup .......................... [[32mCREATE 7[0m in 0.11s]
[0m13:54:21.726327 [debug] [Thread-3 (]: On seed.de_pipeline.payment_type_lookup: Close
[0m13:54:21.726921 [debug] [Thread-4 (]: Finished running node seed.de_pipeline.rate_code_lookup
[0m13:54:21.727362 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd29b19d9-f4ff-4134-900c-c096522f9002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7566553a3e30>]}
[0m13:54:21.727650 [debug] [Thread-4 (]: Began running node seed.de_pipeline.taxi_zone_lookup
[0m13:54:21.728180 [info ] [Thread-3 (]: 3 of 99 OK loaded seed file main_raw.payment_type_lookup ....................... [[32mCREATE 6[0m in 0.11s]
[0m13:54:21.728846 [info ] [Thread-4 (]: 5 of 99 START seed file main_raw.taxi_zone_lookup .............................. [RUN]
[0m13:54:21.729258 [debug] [Thread-3 (]: Finished running node seed.de_pipeline.payment_type_lookup
[0m13:54:21.729499 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.dim_dates"
[0m13:54:21.729761 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.de_pipeline.rate_code_lookup, now seed.de_pipeline.taxi_zone_lookup)
[0m13:54:21.730112 [debug] [Thread-3 (]: Began running node seed.de_pipeline.vendor_lookup
[0m13:54:21.730546 [debug] [Thread-1 (]: On model.de_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_dates"} */

  
    
    
      
    

    create  table
      "de_pipeline"."main_marts"."dim_dates__dbt_tmp"
  
  (
    date_key date,
    year bigint,
    month bigint,
    day_of_month bigint,
    day_of_week_num bigint,
    day_of_week_name varchar,
    month_name varchar,
    week_of_year bigint,
    is_weekend boolean,
    is_holiday boolean
    
    )
 ;
    insert into "de_pipeline"."main_marts"."dim_dates__dbt_tmp" 
  (
    
      
      date_key ,
    
      
      year ,
    
      
      month ,
    
      
      day_of_month ,
    
      
      day_of_week_num ,
    
      
      day_of_week_name ,
    
      
      month_name ,
    
      
      week_of_year ,
    
      
      is_weekend ,
    
      
      is_holiday 
    
  )
 (
      
    select date_key, year, month, day_of_month, day_of_week_num, day_of_week_name, month_name, week_of_year, is_weekend, is_holiday
    from (
        /*
    Dimension table: Calendar dates for January 2024.
    Uses adapter-dispatched macros for dayname/monthname.
*/

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 31
    order by generated_number



),

all_periods as (

    select (
        

    (cast('2024-01-01' as date) + cast(row_number() over (order by generated_number) - 1 as bigint) * interval 1 day)
    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-02-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week_num,
        
    dayname(date_day)
 as day_of_week_name,
        
    monthname(date_day)
 as month_name,
        extract(week from date_day) as week_of_year,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when cast(date_day as date) in (
                cast('2024-01-01' as date),
                cast('2024-01-15' as date)
            ) then true
            else false
        end as is_holiday

    from date_spine
)

select * from final
    ) as model_subq
    );
  
  
[0m13:54:21.731232 [debug] [Thread-4 (]: Began compiling node seed.de_pipeline.taxi_zone_lookup
[0m13:54:21.732055 [info ] [Thread-3 (]: 6 of 99 START seed file main_raw.vendor_lookup ................................. [RUN]
[0m13:54:21.733821 [debug] [Thread-4 (]: Began executing node seed.de_pipeline.taxi_zone_lookup
[0m13:54:21.734365 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.de_pipeline.payment_type_lookup, now seed.de_pipeline.vendor_lookup)
[0m13:54:21.736815 [debug] [Thread-3 (]: Began compiling node seed.de_pipeline.vendor_lookup
[0m13:54:21.737202 [debug] [Thread-3 (]: Began executing node seed.de_pipeline.vendor_lookup
[0m13:54:21.737780 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:54:21.744044 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.dim_dates"
[0m13:54:21.744827 [debug] [Thread-1 (]: On model.de_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_dates"} */
alter table "de_pipeline"."main_marts"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m13:54:21.745590 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:21.746399 [debug] [Thread-1 (]: On model.de_pipeline.dim_dates: COMMIT
[0m13:54:21.800306 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.dim_dates"
[0m13:54:21.801083 [debug] [Thread-4 (]: Using duckdb connection "seed.de_pipeline.taxi_zone_lookup"
[0m13:54:21.801365 [debug] [Thread-2 (]: SQL status: OK in 0.079 seconds
[0m13:54:21.801613 [debug] [Thread-1 (]: On model.de_pipeline.dim_dates: COMMIT
[0m13:54:21.802047 [debug] [Thread-3 (]: Using duckdb connection "seed.de_pipeline.vendor_lookup"
[0m13:54:21.802395 [debug] [Thread-4 (]: On seed.de_pipeline.taxi_zone_lookup: BEGIN
[0m13:54:21.804226 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.stg_yellow_trips"
[0m13:54:21.804846 [debug] [Thread-3 (]: On seed.de_pipeline.vendor_lookup: BEGIN
[0m13:54:21.805147 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:21.805474 [debug] [Thread-2 (]: On model.de_pipeline.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_yellow_trips"} */
alter table "de_pipeline"."main_staging"."stg_yellow_trips__dbt_tmp" rename to "stg_yellow_trips"
[0m13:54:21.805763 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:21.806687 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:54:21.807626 [debug] [Thread-2 (]: On model.de_pipeline.stg_yellow_trips: COMMIT
[0m13:54:21.807853 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:21.808131 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.stg_yellow_trips"
[0m13:54:21.811209 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.dim_dates"
[0m13:54:21.811628 [debug] [Thread-2 (]: On model.de_pipeline.stg_yellow_trips: COMMIT
[0m13:54:21.811984 [debug] [Thread-1 (]: On model.de_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_dates"} */

      drop table if exists "de_pipeline"."main_marts"."dim_dates__dbt_backup" cascade
    
[0m13:54:21.812628 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m13:54:21.812891 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:21.813162 [debug] [Thread-4 (]: Using duckdb connection "seed.de_pipeline.taxi_zone_lookup"
[0m13:54:21.814018 [debug] [Thread-1 (]: On model.de_pipeline.dim_dates: Close
[0m13:54:21.814549 [debug] [Thread-4 (]: On seed.de_pipeline.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "seed.de_pipeline.taxi_zone_lookup"} */

    create table "de_pipeline"."main_raw"."taxi_zone_lookup" ("LocationID" INTEGER,"Borough" VARCHAR,"Zone" VARCHAR,"service_zone" VARCHAR)
  
[0m13:54:21.815407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd29b19d9-f4ff-4134-900c-c096522f9002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756634729af0>]}
[0m13:54:21.815726 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m13:54:21.816499 [info ] [Thread-1 (]: 1 of 99 OK created sql table model main_marts.dim_dates ........................ [[32mOK[0m in 0.20s]
[0m13:54:21.816827 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:54:21.817191 [debug] [Thread-3 (]: Using duckdb connection "seed.de_pipeline.vendor_lookup"
[0m13:54:21.817593 [debug] [Thread-1 (]: Finished running node model.de_pipeline.dim_dates
[0m13:54:21.818568 [debug] [Thread-4 (]: Using duckdb connection "seed.de_pipeline.taxi_zone_lookup"
[0m13:54:21.818918 [debug] [Thread-3 (]: On seed.de_pipeline.vendor_lookup: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "seed.de_pipeline.vendor_lookup"} */

    create table "de_pipeline"."main_raw"."vendor_lookup" ("vendor_id" INTEGER,"vendor_name" VARCHAR,"vendor_abbr" VARCHAR)
  
[0m13:54:21.819286 [debug] [Thread-1 (]: Began running node test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m13:54:21.819785 [debug] [Thread-4 (]: On seed.de_pipeline.taxi_zone_lookup: 
          COPY "de_pipeline"."main_raw"."taxi_zone_lookup" FROM '/dbt/seeds/taxi_zone_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:54:21.820388 [info ] [Thread-1 (]: 7 of 99 START test not_null_rate_code_lookup_rate_code_id ...................... [RUN]
[0m13:54:21.820702 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:54:21.821362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_pipeline.dim_dates, now test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec)
[0m13:54:21.822122 [debug] [Thread-3 (]: Using duckdb connection "seed.de_pipeline.vendor_lookup"
[0m13:54:21.822454 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m13:54:21.822786 [debug] [Thread-3 (]: On seed.de_pipeline.vendor_lookup: 
          COPY "de_pipeline"."main_raw"."vendor_lookup" FROM '/dbt/seeds/vendor_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:54:21.827176 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m13:54:21.827459 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m13:54:21.828262 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m13:54:21.829604 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.stg_yellow_trips"
[0m13:54:21.830101 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.de_pipeline.taxi_zone_lookup"
[0m13:54:21.830501 [debug] [Thread-2 (]: On model.de_pipeline.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_yellow_trips"} */

      drop table if exists "de_pipeline"."main_staging"."stg_yellow_trips__dbt_backup" cascade
    
[0m13:54:21.831432 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:54:21.832296 [debug] [Thread-2 (]: On model.de_pipeline.stg_yellow_trips: Close
[0m13:54:21.832795 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd29b19d9-f4ff-4134-900c-c096522f9002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7566a4318380>]}
[0m13:54:21.833012 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m13:54:21.833377 [info ] [Thread-2 (]: 2 of 99 OK created sql table model main_staging.stg_yellow_trips ............... [[32mOK[0m in 0.22s]
[0m13:54:21.833810 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.de_pipeline.vendor_lookup"
[0m13:54:21.834302 [debug] [Thread-2 (]: Finished running node model.de_pipeline.stg_yellow_trips
[0m13:54:21.835000 [debug] [Thread-2 (]: Began running node test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m13:54:21.835559 [info ] [Thread-2 (]: 8 of 99 START test unique_rate_code_lookup_rate_code_id ........................ [RUN]
[0m13:54:21.835946 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.de_pipeline.stg_yellow_trips, now test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d)
[0m13:54:21.836272 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m13:54:21.837212 [debug] [Thread-4 (]: On seed.de_pipeline.taxi_zone_lookup: COMMIT
[0m13:54:21.840472 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m13:54:21.841404 [debug] [Thread-3 (]: On seed.de_pipeline.vendor_lookup: COMMIT
[0m13:54:21.841625 [debug] [Thread-4 (]: Using duckdb connection "seed.de_pipeline.taxi_zone_lookup"
[0m13:54:21.842327 [debug] [Thread-3 (]: Using duckdb connection "seed.de_pipeline.vendor_lookup"
[0m13:54:21.842693 [debug] [Thread-4 (]: On seed.de_pipeline.taxi_zone_lookup: COMMIT
[0m13:54:21.843017 [debug] [Thread-3 (]: On seed.de_pipeline.vendor_lookup: COMMIT
[0m13:54:21.844580 [debug] [Thread-1 (]: Began executing node test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m13:54:21.853428 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m13:54:21.853783 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m13:54:21.853983 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m13:54:21.854780 [debug] [Thread-4 (]: On seed.de_pipeline.taxi_zone_lookup: Close
[0m13:54:21.855142 [debug] [Thread-2 (]: Began executing node test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m13:54:21.855559 [debug] [Thread-3 (]: On seed.de_pipeline.vendor_lookup: Close
[0m13:54:21.856195 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd29b19d9-f4ff-4134-900c-c096522f9002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7566347bafc0>]}
[0m13:54:21.857596 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m13:54:21.858066 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd29b19d9-f4ff-4134-900c-c096522f9002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7566347e04a0>]}
[0m13:54:21.858389 [info ] [Thread-4 (]: 5 of 99 OK loaded seed file main_raw.taxi_zone_lookup .......................... [[32mCREATE 265[0m in 0.13s]
[0m13:54:21.859000 [info ] [Thread-3 (]: 6 of 99 OK loaded seed file main_raw.vendor_lookup ............................. [[32mCREATE 2[0m in 0.12s]
[0m13:54:21.859488 [debug] [Thread-4 (]: Finished running node seed.de_pipeline.taxi_zone_lookup
[0m13:54:21.859948 [debug] [Thread-3 (]: Finished running node seed.de_pipeline.vendor_lookup
[0m13:54:21.860743 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m13:54:21.861309 [debug] [Thread-3 (]: Began running node test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m13:54:21.861737 [info ] [Thread-4 (]: 9 of 99 START test not_null_payment_type_lookup_payment_type_id ................ [RUN]
[0m13:54:21.862097 [info ] [Thread-3 (]: 10 of 99 START test unique_payment_type_lookup_payment_type_id ................. [RUN]
[0m13:54:21.863696 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.de_pipeline.taxi_zone_lookup, now test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521)
[0m13:54:21.864086 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.de_pipeline.vendor_lookup, now test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7)
[0m13:54:21.864389 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m13:54:21.864657 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m13:54:21.865080 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m13:54:21.867374 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m13:54:21.867609 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m13:54:21.869387 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m13:54:21.870262 [debug] [Thread-2 (]: On test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d: BEGIN
[0m13:54:21.870818 [debug] [Thread-1 (]: On test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec: BEGIN
[0m13:54:21.871349 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:21.871664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:21.873231 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:54:21.873596 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m13:54:21.874005 [debug] [Thread-2 (]: On test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rate_code_id as unique_field,
    count(*) as n_records

from "de_pipeline"."main_raw"."rate_code_lookup"
where rate_code_id is not null
group by rate_code_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:54:21.874410 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:21.874974 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m13:54:21.875403 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m13:54:21.875687 [debug] [Thread-1 (]: On test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_id
from "de_pipeline"."main_raw"."rate_code_lookup"
where rate_code_id is null



  
  
      
    ) dbt_internal_test
[0m13:54:21.875975 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:54:21.877655 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m13:54:21.877890 [debug] [Thread-3 (]: Began executing node test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m13:54:21.880136 [debug] [Thread-2 (]: On test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d: ROLLBACK
[0m13:54:21.880569 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:21.881757 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m13:54:21.882401 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d'
[0m13:54:21.883277 [debug] [Thread-1 (]: On test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec: ROLLBACK
[0m13:54:21.883790 [debug] [Thread-2 (]: On test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d: Close
[0m13:54:21.884577 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec'
[0m13:54:21.885419 [info ] [Thread-2 (]: 8 of 99 PASS unique_rate_code_lookup_rate_code_id .............................. [[32mPASS[0m in 0.05s]
[0m13:54:21.885818 [debug] [Thread-1 (]: On test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec: Close
[0m13:54:21.886470 [debug] [Thread-2 (]: Finished running node test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m13:54:21.887378 [info ] [Thread-1 (]: 7 of 99 PASS not_null_rate_code_lookup_rate_code_id ............................ [[32mPASS[0m in 0.07s]
[0m13:54:21.887775 [debug] [Thread-2 (]: Began running node test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348
[0m13:54:21.888288 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m13:54:21.888650 [debug] [Thread-1 (]: Finished running node test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m13:54:21.889651 [info ] [Thread-2 (]: 11 of 99 START test not_null_dim_dates_date_key ................................ [RUN]
[0m13:54:21.890137 [debug] [Thread-4 (]: On test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521: BEGIN
[0m13:54:21.890473 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m13:54:21.890931 [debug] [Thread-1 (]: Began running node test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541
[0m13:54:21.891445 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d, now test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348)
[0m13:54:21.891887 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:21.892295 [debug] [Thread-3 (]: On test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7: BEGIN
[0m13:54:21.892636 [info ] [Thread-1 (]: 12 of 99 START test not_null_dim_dates_day_of_week_name ........................ [RUN]
[0m13:54:21.893027 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348
[0m13:54:21.893785 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:21.894251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec, now test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541)
[0m13:54:21.897168 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348"
[0m13:54:21.897827 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541
[0m13:54:21.900636 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m13:54:21.901538 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m13:54:21.901919 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m13:54:21.902333 [debug] [Thread-4 (]: On test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "de_pipeline"."main_raw"."payment_type_lookup"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m13:54:21.903187 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:54:21.903411 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m13:54:21.904401 [debug] [Thread-4 (]: On test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521: ROLLBACK
[0m13:54:21.904664 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m13:54:21.905519 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521'
[0m13:54:21.905771 [debug] [Thread-3 (]: On test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "de_pipeline"."main_raw"."payment_type_lookup"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:54:21.906123 [debug] [Thread-4 (]: On test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521: Close
[0m13:54:21.906959 [info ] [Thread-4 (]: 9 of 99 PASS not_null_payment_type_lookup_payment_type_id ...................... [[32mPASS[0m in 0.04s]
[0m13:54:21.907403 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m13:54:21.907675 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:54:21.907947 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a
[0m13:54:21.909170 [debug] [Thread-3 (]: On test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7: ROLLBACK
[0m13:54:21.909434 [info ] [Thread-4 (]: 13 of 99 START test not_null_dim_dates_is_holiday .............................. [RUN]
[0m13:54:21.910007 [debug] [Thread-2 (]: Began executing node test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348
[0m13:54:21.910464 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7'
[0m13:54:21.910694 [debug] [Thread-1 (]: Began executing node test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541
[0m13:54:21.911010 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521, now test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a)
[0m13:54:21.912679 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348"
[0m13:54:21.913047 [debug] [Thread-3 (]: On test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7: Close
[0m13:54:21.914331 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m13:54:21.914707 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a
[0m13:54:21.915690 [info ] [Thread-3 (]: 10 of 99 PASS unique_payment_type_lookup_payment_type_id ....................... [[32mPASS[0m in 0.05s]
[0m13:54:21.919434 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a"
[0m13:54:21.919986 [debug] [Thread-3 (]: Finished running node test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m13:54:21.920552 [debug] [Thread-3 (]: Began running node test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0
[0m13:54:21.920892 [info ] [Thread-3 (]: 14 of 99 START test not_null_dim_dates_is_weekend .............................. [RUN]
[0m13:54:21.921365 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7, now test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0)
[0m13:54:21.921733 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0
[0m13:54:21.924106 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0"
[0m13:54:21.927628 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a
[0m13:54:21.927959 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m13:54:21.929358 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a"
[0m13:54:21.929840 [debug] [Thread-1 (]: On test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541: BEGIN
[0m13:54:21.930303 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348"
[0m13:54:21.930523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:21.930933 [debug] [Thread-3 (]: Began executing node test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0
[0m13:54:21.931191 [debug] [Thread-2 (]: On test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348: BEGIN
[0m13:54:21.933465 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0"
[0m13:54:21.933955 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:21.935211 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:54:21.935617 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m13:54:21.935900 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a"
[0m13:54:21.936292 [debug] [Thread-1 (]: On test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select day_of_week_name
from "de_pipeline"."main_marts"."dim_dates"
where day_of_week_name is null



  
  
      
    ) dbt_internal_test
[0m13:54:21.936891 [debug] [Thread-4 (]: On test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a: BEGIN
[0m13:54:21.937483 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:54:21.937690 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:21.937938 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:21.938161 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0"
[0m13:54:21.938348 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348"
[0m13:54:21.939586 [debug] [Thread-1 (]: On test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541: ROLLBACK
[0m13:54:21.940053 [debug] [Thread-3 (]: On test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0: BEGIN
[0m13:54:21.940438 [debug] [Thread-2 (]: On test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "de_pipeline"."main_marts"."dim_dates"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m13:54:21.940631 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:54:21.941340 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541'
[0m13:54:21.941523 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:21.942012 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a"
[0m13:54:21.942255 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:54:21.942446 [debug] [Thread-1 (]: On test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541: Close
[0m13:54:21.943012 [debug] [Thread-4 (]: On test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_holiday
from "de_pipeline"."main_marts"."dim_dates"
where is_holiday is null



  
  
      
    ) dbt_internal_test
[0m13:54:21.944079 [debug] [Thread-2 (]: On test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348: ROLLBACK
[0m13:54:21.944496 [info ] [Thread-1 (]: 12 of 99 PASS not_null_dim_dates_day_of_week_name .............................. [[32mPASS[0m in 0.05s]
[0m13:54:21.944958 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:54:21.945574 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348'
[0m13:54:21.945856 [debug] [Thread-1 (]: Finished running node test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541
[0m13:54:21.946126 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:54:21.946328 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0"
[0m13:54:21.946654 [debug] [Thread-2 (]: On test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348: Close
[0m13:54:21.947011 [debug] [Thread-1 (]: Began running node test.de_pipeline.unique_dim_dates_date_key.61e1d0726d
[0m13:54:21.948039 [debug] [Thread-4 (]: On test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a: ROLLBACK
[0m13:54:21.948252 [debug] [Thread-3 (]: On test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "de_pipeline"."main_marts"."dim_dates"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m13:54:21.948716 [info ] [Thread-2 (]: 11 of 99 PASS not_null_dim_dates_date_key ...................................... [[32mPASS[0m in 0.06s]
[0m13:54:21.948945 [info ] [Thread-1 (]: 15 of 99 START test unique_dim_dates_date_key .................................. [RUN]
[0m13:54:21.949739 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a'
[0m13:54:21.950435 [debug] [Thread-2 (]: Finished running node test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348
[0m13:54:21.950706 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:54:21.950978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541, now test.de_pipeline.unique_dim_dates_date_key.61e1d0726d)
[0m13:54:21.951346 [debug] [Thread-4 (]: On test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a: Close
[0m13:54:21.951700 [debug] [Thread-2 (]: Began running node test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m13:54:21.952675 [debug] [Thread-3 (]: On test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0: ROLLBACK
[0m13:54:21.952904 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.unique_dim_dates_date_key.61e1d0726d
[0m13:54:21.953426 [info ] [Thread-4 (]: 13 of 99 PASS not_null_dim_dates_is_holiday .................................... [[32mPASS[0m in 0.04s]
[0m13:54:21.953813 [info ] [Thread-2 (]: 16 of 99 START test accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6  [RUN]
[0m13:54:21.954477 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0'
[0m13:54:21.956921 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.unique_dim_dates_date_key.61e1d0726d"
[0m13:54:21.957423 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a
[0m13:54:21.957812 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348, now test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44)
[0m13:54:21.958193 [debug] [Thread-3 (]: On test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0: Close
[0m13:54:21.958789 [debug] [Thread-4 (]: Began running node test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m13:54:21.959115 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m13:54:21.959833 [info ] [Thread-3 (]: 14 of 99 PASS not_null_dim_dates_is_weekend .................................... [[32mPASS[0m in 0.04s]
[0m13:54:21.960076 [info ] [Thread-4 (]: 17 of 99 START test accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99  [RUN]
[0m13:54:21.962554 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m13:54:21.963024 [debug] [Thread-3 (]: Finished running node test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0
[0m13:54:21.963484 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a, now test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098)
[0m13:54:21.964040 [debug] [Thread-3 (]: Began running node test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m13:54:21.964441 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m13:54:21.964857 [info ] [Thread-3 (]: 18 of 99 START test accepted_values_stg_yellow_trips_vendor_id__1__2__6 ........ [RUN]
[0m13:54:21.968027 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m13:54:21.968656 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0, now test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27)
[0m13:54:21.969436 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m13:54:21.971858 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m13:54:21.972085 [debug] [Thread-1 (]: Began executing node test.de_pipeline.unique_dim_dates_date_key.61e1d0726d
[0m13:54:21.973598 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.unique_dim_dates_date_key.61e1d0726d"
[0m13:54:21.974127 [debug] [Thread-4 (]: Began executing node test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m13:54:21.974375 [debug] [Thread-2 (]: Began executing node test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m13:54:21.975593 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m13:54:21.975837 [debug] [Thread-3 (]: Began executing node test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m13:54:21.977965 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m13:54:21.979372 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m13:54:21.982707 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.unique_dim_dates_date_key.61e1d0726d"
[0m13:54:21.983188 [debug] [Thread-1 (]: On test.de_pipeline.unique_dim_dates_date_key.61e1d0726d: BEGIN
[0m13:54:21.983473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:21.984632 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:21.984908 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m13:54:21.985104 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.unique_dim_dates_date_key.61e1d0726d"
[0m13:54:21.985444 [debug] [Thread-3 (]: On test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: BEGIN
[0m13:54:21.985847 [debug] [Thread-1 (]: On test.de_pipeline.unique_dim_dates_date_key.61e1d0726d: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_dim_dates_date_key.61e1d0726d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "de_pipeline"."main_marts"."dim_dates"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:54:21.986215 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:21.986494 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m13:54:21.987286 [debug] [Thread-4 (]: On test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: BEGIN
[0m13:54:21.987568 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:21.987772 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:21.987993 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m13:54:21.989109 [debug] [Thread-1 (]: On test.de_pipeline.unique_dim_dates_date_key.61e1d0726d: ROLLBACK
[0m13:54:21.989830 [debug] [Thread-2 (]: On test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: BEGIN
[0m13:54:21.990311 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m13:54:21.990816 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.unique_dim_dates_date_key.61e1d0726d'
[0m13:54:21.991128 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:21.991480 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m13:54:21.991781 [debug] [Thread-1 (]: On test.de_pipeline.unique_dim_dates_date_key.61e1d0726d: Close
[0m13:54:21.992253 [debug] [Thread-3 (]: On test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        vendor_id as value_field,
        count(*) as n_records

    from "de_pipeline"."main_staging"."stg_yellow_trips"
    group by vendor_id

)

select *
from all_values
where value_field not in (
    '1','2','6'
)



  
  
      
    ) dbt_internal_test
[0m13:54:21.992557 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m13:54:21.993066 [info ] [Thread-1 (]: 15 of 99 PASS unique_dim_dates_date_key ........................................ [[32mPASS[0m in 0.04s]
[0m13:54:21.993564 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m13:54:21.993959 [debug] [Thread-1 (]: Finished running node test.de_pipeline.unique_dim_dates_date_key.61e1d0726d
[0m13:54:21.994679 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:54:21.994951 [debug] [Thread-4 (]: On test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rate_code_id as value_field,
        count(*) as n_records

    from "de_pipeline"."main_staging"."stg_yellow_trips"
    group by rate_code_id

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5','6','99'
)



  
  
      
    ) dbt_internal_test
[0m13:54:21.995469 [debug] [Thread-1 (]: Began running node test.de_pipeline.assert_fare_not_exceeds_total
[0m13:54:21.996669 [debug] [Thread-3 (]: On test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: ROLLBACK
[0m13:54:21.996917 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m13:54:21.997348 [info ] [Thread-1 (]: 19 of 99 START test assert_fare_not_exceeds_total .............................. [RUN]
[0m13:54:21.998058 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27'
[0m13:54:21.998342 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:54:21.998553 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m13:54:21.998995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.unique_dim_dates_date_key.61e1d0726d, now test.de_pipeline.assert_fare_not_exceeds_total)
[0m13:54:21.999316 [debug] [Thread-3 (]: On test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: Close
[0m13:54:22.000207 [debug] [Thread-4 (]: On test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: ROLLBACK
[0m13:54:22.000409 [debug] [Thread-2 (]: On test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        payment_type_id as value_field,
        count(*) as n_records

    from "de_pipeline"."main_staging"."stg_yellow_trips"
    group by payment_type_id

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6'
)



  
  
      
    ) dbt_internal_test
[0m13:54:22.000739 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.assert_fare_not_exceeds_total
[0m13:54:22.001201 [info ] [Thread-3 (]: 18 of 99 PASS accepted_values_stg_yellow_trips_vendor_id__1__2__6 .............. [[32mPASS[0m in 0.03s]
[0m13:54:22.001632 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098'
[0m13:54:22.003606 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.assert_fare_not_exceeds_total"
[0m13:54:22.003868 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:54:22.004138 [debug] [Thread-3 (]: Finished running node test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m13:54:22.004423 [debug] [Thread-4 (]: On test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: Close
[0m13:54:22.005420 [debug] [Thread-2 (]: On test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: ROLLBACK
[0m13:54:22.005762 [debug] [Thread-3 (]: Began running node test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m13:54:22.006258 [info ] [Thread-4 (]: 17 of 99 PASS accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99  [[32mPASS[0m in 0.04s]
[0m13:54:22.006753 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44'
[0m13:54:22.007134 [info ] [Thread-3 (]: 20 of 99 START test not_null_stg_yellow_trips_dropoff_datetime ................. [RUN]
[0m13:54:22.007579 [debug] [Thread-4 (]: Finished running node test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m13:54:22.007851 [debug] [Thread-2 (]: On test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: Close
[0m13:54:22.008187 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27, now test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052)
[0m13:54:22.008589 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m13:54:22.009008 [info ] [Thread-2 (]: 16 of 99 PASS accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6  [[32mPASS[0m in 0.05s]
[0m13:54:22.009247 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m13:54:22.009584 [info ] [Thread-4 (]: 21 of 99 START test not_null_stg_yellow_trips_dropoff_location_id .............. [RUN]
[0m13:54:22.010021 [debug] [Thread-2 (]: Finished running node test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m13:54:22.012702 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m13:54:22.013137 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098, now test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048)
[0m13:54:22.013498 [debug] [Thread-2 (]: Began running node test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m13:54:22.014149 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m13:54:22.014413 [debug] [Thread-1 (]: Began executing node test.de_pipeline.assert_fare_not_exceeds_total
[0m13:54:22.014686 [info ] [Thread-2 (]: 22 of 99 START test not_null_stg_yellow_trips_fare_amount ...................... [RUN]
[0m13:54:22.016743 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m13:54:22.017978 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.assert_fare_not_exceeds_total"
[0m13:54:22.018296 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44, now test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97)
[0m13:54:22.019076 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m13:54:22.021359 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m13:54:22.022526 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m13:54:22.022777 [debug] [Thread-3 (]: Began executing node test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m13:54:22.024094 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m13:54:22.025688 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m13:54:22.027429 [debug] [Thread-2 (]: Began executing node test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m13:54:22.030285 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m13:54:22.031415 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.assert_fare_not_exceeds_total"
[0m13:54:22.031746 [debug] [Thread-1 (]: On test.de_pipeline.assert_fare_not_exceeds_total: BEGIN
[0m13:54:22.032054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:22.033384 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m13:54:22.033753 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: BEGIN
[0m13:54:22.034224 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:22.034484 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:54:22.034899 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m13:54:22.035424 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.assert_fare_not_exceeds_total"
[0m13:54:22.035806 [debug] [Thread-3 (]: On test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052: BEGIN
[0m13:54:22.036510 [debug] [Thread-1 (]: On test.de_pipeline.assert_fare_not_exceeds_total: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.assert_fare_not_exceeds_total"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
    Singular test: fare_amount should not exceed total_amount.
*/

select
    trip_id,
    fare_amount,
    total_amount
from "de_pipeline"."main_staging"."stg_yellow_trips"
where fare_amount > total_amount + 0.01
  and total_amount > 0
  
  
      
    ) dbt_internal_test
[0m13:54:22.036921 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:54:22.037196 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:22.037501 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m13:54:22.037896 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m13:54:22.038616 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97: BEGIN
[0m13:54:22.038985 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.039456 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:54:22.039740 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_location_id
from "de_pipeline"."main_staging"."stg_yellow_trips"
where dropoff_location_id is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.040122 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:22.041335 [debug] [Thread-1 (]: On test.de_pipeline.assert_fare_not_exceeds_total: ROLLBACK
[0m13:54:22.041554 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m13:54:22.043282 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.assert_fare_not_exceeds_total'
[0m13:54:22.043727 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:54:22.044187 [debug] [Thread-3 (]: On test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_datetime
from "de_pipeline"."main_staging"."stg_yellow_trips"
where dropoff_datetime is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.044720 [debug] [Thread-1 (]: On test.de_pipeline.assert_fare_not_exceeds_total: Close
[0m13:54:22.046094 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: ROLLBACK
[0m13:54:22.047105 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.047673 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048'
[0m13:54:22.046752 [info ] [Thread-1 (]: 19 of 99 PASS assert_fare_not_exceeds_total .................................... [[32mPASS[0m in 0.05s]
[0m13:54:22.050405 [debug] [Thread-3 (]: On test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052: ROLLBACK
[0m13:54:22.050808 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: Close
[0m13:54:22.051152 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m13:54:22.051486 [debug] [Thread-1 (]: Finished running node test.de_pipeline.assert_fare_not_exceeds_total
[0m13:54:22.052178 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052'
[0m13:54:22.052717 [info ] [Thread-4 (]: 21 of 99 PASS not_null_stg_yellow_trips_dropoff_location_id .................... [[32mPASS[0m in 0.04s]
[0m13:54:22.052945 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m13:54:22.053262 [debug] [Thread-1 (]: Began running node test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m13:54:22.053625 [debug] [Thread-3 (]: On test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052: Close
[0m13:54:22.054027 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m13:54:22.054371 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fare_amount
from "de_pipeline"."main_staging"."stg_yellow_trips"
where fare_amount is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.054851 [info ] [Thread-1 (]: 23 of 99 START test not_null_stg_yellow_trips_pickup_datetime .................. [RUN]
[0m13:54:22.055444 [info ] [Thread-3 (]: 20 of 99 PASS not_null_stg_yellow_trips_dropoff_datetime ....................... [[32mPASS[0m in 0.05s]
[0m13:54:22.056001 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m13:54:22.056732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.assert_fare_not_exceeds_total, now test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed)
[0m13:54:22.057131 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.057437 [debug] [Thread-3 (]: Finished running node test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m13:54:22.057787 [info ] [Thread-4 (]: 24 of 99 START test not_null_stg_yellow_trips_pickup_location_id ............... [RUN]
[0m13:54:22.058105 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m13:54:22.059199 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97: ROLLBACK
[0m13:54:22.059417 [debug] [Thread-3 (]: Began running node test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m13:54:22.059771 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048, now test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1)
[0m13:54:22.062226 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m13:54:22.062903 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97'
[0m13:54:22.063268 [info ] [Thread-3 (]: 25 of 99 START test not_null_stg_yellow_trips_total_amount ..................... [RUN]
[0m13:54:22.063605 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m13:54:22.064191 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97: Close
[0m13:54:22.064583 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052, now test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6)
[0m13:54:22.066886 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m13:54:22.067417 [info ] [Thread-2 (]: 22 of 99 PASS not_null_stg_yellow_trips_fare_amount ............................ [[32mPASS[0m in 0.05s]
[0m13:54:22.067637 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m13:54:22.068243 [debug] [Thread-2 (]: Finished running node test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m13:54:22.070364 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m13:54:22.070845 [debug] [Thread-2 (]: Began running node test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m13:54:22.071499 [info ] [Thread-2 (]: 26 of 99 START test not_null_stg_yellow_trips_trip_distance_miles .............. [RUN]
[0m13:54:22.071746 [debug] [Thread-1 (]: Began executing node test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m13:54:22.072034 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97, now test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7)
[0m13:54:22.073563 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m13:54:22.073946 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m13:54:22.074178 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m13:54:22.076494 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m13:54:22.076775 [debug] [Thread-3 (]: Began executing node test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m13:54:22.078153 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m13:54:22.080251 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m13:54:22.081150 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m13:54:22.081422 [debug] [Thread-1 (]: On test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: BEGIN
[0m13:54:22.081681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:22.082775 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m13:54:22.083310 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: BEGIN
[0m13:54:22.083725 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:54:22.083959 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:22.084623 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m13:54:22.085407 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m13:54:22.085712 [debug] [Thread-2 (]: Began executing node test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m13:54:22.086010 [debug] [Thread-1 (]: On test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "de_pipeline"."main_staging"."stg_yellow_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.086533 [debug] [Thread-3 (]: On test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6: BEGIN
[0m13:54:22.088711 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m13:54:22.089106 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m13:54:22.089587 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:22.090061 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.090252 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m13:54:22.091863 [debug] [Thread-1 (]: On test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: ROLLBACK
[0m13:54:22.092228 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_location_id
from "de_pipeline"."main_staging"."stg_yellow_trips"
where pickup_location_id is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.092956 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed'
[0m13:54:22.093618 [debug] [Thread-1 (]: On test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: Close
[0m13:54:22.093847 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.094315 [info ] [Thread-1 (]: 23 of 99 PASS not_null_stg_yellow_trips_pickup_datetime ........................ [[32mPASS[0m in 0.04s]
[0m13:54:22.095269 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: ROLLBACK
[0m13:54:22.095545 [debug] [Thread-1 (]: Finished running node test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m13:54:22.095762 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m13:54:22.096210 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1'
[0m13:54:22.096593 [debug] [Thread-1 (]: Began running node test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m13:54:22.096899 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m13:54:22.097199 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: Close
[0m13:54:22.097558 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m13:54:22.097763 [info ] [Thread-1 (]: 27 of 99 START test not_null_stg_yellow_trips_trip_id .......................... [RUN]
[0m13:54:22.098161 [debug] [Thread-3 (]: On test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "de_pipeline"."main_staging"."stg_yellow_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.098681 [info ] [Thread-4 (]: 24 of 99 PASS not_null_stg_yellow_trips_pickup_location_id ..................... [[32mPASS[0m in 0.04s]
[0m13:54:22.098901 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: BEGIN
[0m13:54:22.099290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed, now test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1)
[0m13:54:22.100087 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m13:54:22.100418 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.100661 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:22.101130 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m13:54:22.101485 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m13:54:22.102567 [debug] [Thread-3 (]: On test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6: ROLLBACK
[0m13:54:22.106249 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m13:54:22.106746 [info ] [Thread-4 (]: 28 of 99 START test not_null_stg_yellow_trips_vendor_id ........................ [RUN]
[0m13:54:22.107510 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6'
[0m13:54:22.108159 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1, now test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57)
[0m13:54:22.108550 [debug] [Thread-3 (]: On test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6: Close
[0m13:54:22.108788 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m13:54:22.108983 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m13:54:22.109435 [info ] [Thread-3 (]: 25 of 99 PASS not_null_stg_yellow_trips_total_amount ........................... [[32mPASS[0m in 0.04s]
[0m13:54:22.109665 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m13:54:22.111907 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m13:54:22.112411 [debug] [Thread-3 (]: Finished running node test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m13:54:22.112744 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_distance_miles
from "de_pipeline"."main_staging"."stg_yellow_trips"
where trip_distance_miles is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.113347 [debug] [Thread-3 (]: Began running node test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965
[0m13:54:22.114101 [info ] [Thread-3 (]: 29 of 99 START test unique_stg_yellow_trips_trip_id ............................ [RUN]
[0m13:54:22.114408 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.114699 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6, now test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965)
[0m13:54:22.115752 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: ROLLBACK
[0m13:54:22.116003 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965
[0m13:54:22.116706 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7'
[0m13:54:22.119303 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965"
[0m13:54:22.119565 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m13:54:22.119779 [debug] [Thread-1 (]: Began executing node test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m13:54:22.119972 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: Close
[0m13:54:22.121417 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m13:54:22.122628 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m13:54:22.123169 [info ] [Thread-2 (]: 26 of 99 PASS not_null_stg_yellow_trips_trip_distance_miles .................... [[32mPASS[0m in 0.05s]
[0m13:54:22.123902 [debug] [Thread-2 (]: Finished running node test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m13:54:22.124213 [debug] [Thread-2 (]: Began running node test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m13:54:22.124699 [info ] [Thread-2 (]: 30 of 99 START test not_null_taxi_zone_lookup_Borough .......................... [RUN]
[0m13:54:22.125077 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7, now test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa)
[0m13:54:22.125592 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m13:54:22.127846 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m13:54:22.128812 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m13:54:22.129025 [debug] [Thread-3 (]: Began executing node test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965
[0m13:54:22.129308 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m13:54:22.129505 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: BEGIN
[0m13:54:22.131527 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965"
[0m13:54:22.132081 [debug] [Thread-1 (]: On test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1: BEGIN
[0m13:54:22.132500 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:22.133203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:22.134012 [debug] [Thread-2 (]: Began executing node test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m13:54:22.135596 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m13:54:22.136433 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m13:54:22.136780 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m13:54:22.137123 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "de_pipeline"."main_staging"."stg_yellow_trips"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.137603 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:54:22.137860 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m13:54:22.138053 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m13:54:22.139147 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: ROLLBACK
[0m13:54:22.139387 [debug] [Thread-1 (]: On test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "de_pipeline"."main_staging"."stg_yellow_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.140123 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57'
[0m13:54:22.140520 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965"
[0m13:54:22.140824 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:22.141003 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: Close
[0m13:54:22.141216 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m13:54:22.141486 [debug] [Thread-3 (]: On test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965: BEGIN
[0m13:54:22.142417 [debug] [Thread-1 (]: On test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1: ROLLBACK
[0m13:54:22.142808 [info ] [Thread-4 (]: 28 of 99 PASS not_null_stg_yellow_trips_vendor_id .............................. [[32mPASS[0m in 0.03s]
[0m13:54:22.143137 [debug] [Thread-2 (]: On test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa: BEGIN
[0m13:54:22.143417 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:22.144064 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1'
[0m13:54:22.144367 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m13:54:22.144940 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:22.145765 [debug] [Thread-1 (]: On test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1: Close
[0m13:54:22.146261 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a
[0m13:54:22.147059 [info ] [Thread-1 (]: 27 of 99 PASS not_null_stg_yellow_trips_trip_id ................................ [[32mPASS[0m in 0.05s]
[0m13:54:22.147305 [info ] [Thread-4 (]: 31 of 99 START test not_null_taxi_zone_lookup_LocationID ....................... [RUN]
[0m13:54:22.147745 [debug] [Thread-1 (]: Finished running node test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m13:54:22.148098 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57, now test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a)
[0m13:54:22.148448 [debug] [Thread-1 (]: Began running node test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m13:54:22.148889 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m13:54:22.149089 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a
[0m13:54:22.149533 [info ] [Thread-1 (]: 32 of 99 START test unique_taxi_zone_lookup_LocationID ......................... [RUN]
[0m13:54:22.149906 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:54:22.150104 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965"
[0m13:54:22.152697 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m13:54:22.153041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1, now test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8)
[0m13:54:22.153314 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m13:54:22.153745 [debug] [Thread-3 (]: On test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "de_pipeline"."main_staging"."stg_yellow_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:54:22.154433 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m13:54:22.154790 [debug] [Thread-2 (]: On test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Borough
from "de_pipeline"."main_raw"."taxi_zone_lookup"
where Borough is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.158163 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m13:54:22.158462 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:54:22.159196 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:54:22.160170 [debug] [Thread-3 (]: On test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965: ROLLBACK
[0m13:54:22.161050 [debug] [Thread-2 (]: On test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa: ROLLBACK
[0m13:54:22.161582 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965'
[0m13:54:22.162251 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa'
[0m13:54:22.162569 [debug] [Thread-3 (]: On test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965: Close
[0m13:54:22.162853 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a
[0m13:54:22.163061 [debug] [Thread-2 (]: On test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa: Close
[0m13:54:22.163527 [info ] [Thread-3 (]: 29 of 99 PASS unique_stg_yellow_trips_trip_id .................................. [[32mPASS[0m in 0.05s]
[0m13:54:22.163754 [debug] [Thread-1 (]: Began executing node test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m13:54:22.165161 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m13:54:22.165621 [info ] [Thread-2 (]: 30 of 99 PASS not_null_taxi_zone_lookup_Borough ................................ [[32mPASS[0m in 0.04s]
[0m13:54:22.165925 [debug] [Thread-3 (]: Finished running node test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965
[0m13:54:22.167222 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m13:54:22.167792 [debug] [Thread-2 (]: Finished running node test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m13:54:22.168097 [debug] [Thread-3 (]: Began running node test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422
[0m13:54:22.168700 [debug] [Thread-2 (]: Began running node test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183
[0m13:54:22.168995 [info ] [Thread-3 (]: 33 of 99 START test not_null_vendor_lookup_vendor_abbr ......................... [RUN]
[0m13:54:22.169522 [info ] [Thread-2 (]: 34 of 99 START test not_null_vendor_lookup_vendor_id ........................... [RUN]
[0m13:54:22.170063 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965, now test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422)
[0m13:54:22.170417 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa, now test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183)
[0m13:54:22.170906 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422
[0m13:54:22.171201 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183
[0m13:54:22.173738 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422"
[0m13:54:22.176454 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183"
[0m13:54:22.176894 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m13:54:22.177519 [debug] [Thread-4 (]: On test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a: BEGIN
[0m13:54:22.177859 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:22.178078 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m13:54:22.178774 [debug] [Thread-1 (]: On test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8: BEGIN
[0m13:54:22.179445 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:54:22.179646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:22.179955 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m13:54:22.180526 [debug] [Thread-4 (]: On test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select LocationID
from "de_pipeline"."main_raw"."taxi_zone_lookup"
where LocationID is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.181003 [debug] [Thread-3 (]: Began executing node test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422
[0m13:54:22.181338 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.182674 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422"
[0m13:54:22.183318 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:54:22.184295 [debug] [Thread-4 (]: On test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a: ROLLBACK
[0m13:54:22.184539 [debug] [Thread-2 (]: Began executing node test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183
[0m13:54:22.184809 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m13:54:22.185597 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a'
[0m13:54:22.186954 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183"
[0m13:54:22.187312 [debug] [Thread-1 (]: On test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    LocationID as unique_field,
    count(*) as n_records

from "de_pipeline"."main_raw"."taxi_zone_lookup"
where LocationID is not null
group by LocationID
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:54:22.187674 [debug] [Thread-4 (]: On test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a: Close
[0m13:54:22.188728 [info ] [Thread-4 (]: 31 of 99 PASS not_null_taxi_zone_lookup_LocationID ............................. [[32mPASS[0m in 0.04s]
[0m13:54:22.189064 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.189396 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a
[0m13:54:22.190571 [debug] [Thread-1 (]: On test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8: ROLLBACK
[0m13:54:22.190856 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0
[0m13:54:22.191553 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422"
[0m13:54:22.192045 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8'
[0m13:54:22.192269 [info ] [Thread-4 (]: 35 of 99 START test not_null_vendor_lookup_vendor_name ......................... [RUN]
[0m13:54:22.192615 [debug] [Thread-3 (]: On test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422: BEGIN
[0m13:54:22.193047 [debug] [Thread-1 (]: On test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8: Close
[0m13:54:22.193436 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a, now test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0)
[0m13:54:22.193763 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:22.194031 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183"
[0m13:54:22.194406 [info ] [Thread-1 (]: 32 of 99 PASS unique_taxi_zone_lookup_LocationID ............................... [[32mPASS[0m in 0.04s]
[0m13:54:22.194647 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0
[0m13:54:22.195483 [debug] [Thread-2 (]: On test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183: BEGIN
[0m13:54:22.195990 [debug] [Thread-1 (]: Finished running node test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m13:54:22.198615 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0"
[0m13:54:22.199325 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:22.199659 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m13:54:22.199897 [debug] [Thread-1 (]: Began running node test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf
[0m13:54:22.200810 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422"
[0m13:54:22.201171 [info ] [Thread-1 (]: 36 of 99 START test unique_vendor_lookup_vendor_abbr ........................... [RUN]
[0m13:54:22.201819 [debug] [Thread-3 (]: On test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_abbr
from "de_pipeline"."main_raw"."vendor_lookup"
where vendor_abbr is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.202372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8, now test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf)
[0m13:54:22.203270 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:54:22.203562 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf
[0m13:54:22.203889 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.204180 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183"
[0m13:54:22.207281 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf"
[0m13:54:22.208584 [debug] [Thread-3 (]: On test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422: ROLLBACK
[0m13:54:22.208819 [debug] [Thread-2 (]: On test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "de_pipeline"."main_raw"."vendor_lookup"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.209315 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0
[0m13:54:22.209875 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422'
[0m13:54:22.213204 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0"
[0m13:54:22.213566 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:54:22.213825 [debug] [Thread-3 (]: On test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422: Close
[0m13:54:22.215286 [debug] [Thread-2 (]: On test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183: ROLLBACK
[0m13:54:22.215603 [debug] [Thread-1 (]: Began executing node test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf
[0m13:54:22.215991 [info ] [Thread-3 (]: 33 of 99 PASS not_null_vendor_lookup_vendor_abbr ............................... [[32mPASS[0m in 0.05s]
[0m13:54:22.216672 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183'
[0m13:54:22.218358 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf"
[0m13:54:22.218998 [debug] [Thread-3 (]: Finished running node test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422
[0m13:54:22.219310 [debug] [Thread-2 (]: On test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183: Close
[0m13:54:22.219992 [debug] [Thread-3 (]: Began running node test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c
[0m13:54:22.220431 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0"
[0m13:54:22.220975 [info ] [Thread-2 (]: 34 of 99 PASS not_null_vendor_lookup_vendor_id ................................. [[32mPASS[0m in 0.05s]
[0m13:54:22.221292 [info ] [Thread-3 (]: 37 of 99 START test unique_vendor_lookup_vendor_id ............................. [RUN]
[0m13:54:22.221777 [debug] [Thread-4 (]: On test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0: BEGIN
[0m13:54:22.222305 [debug] [Thread-2 (]: Finished running node test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183
[0m13:54:22.222769 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422, now test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c)
[0m13:54:22.223176 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:22.223637 [debug] [Thread-2 (]: Began running node model.de_pipeline.stg_rate_codes
[0m13:54:22.223972 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c
[0m13:54:22.224206 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf"
[0m13:54:22.224930 [info ] [Thread-2 (]: 38 of 99 START sql view model main_staging.stg_rate_codes ...................... [RUN]
[0m13:54:22.227512 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c"
[0m13:54:22.228165 [debug] [Thread-1 (]: On test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf: BEGIN
[0m13:54:22.228610 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183, now model.de_pipeline.stg_rate_codes)
[0m13:54:22.229174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:22.229822 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m13:54:22.230055 [debug] [Thread-2 (]: Began compiling node model.de_pipeline.stg_rate_codes
[0m13:54:22.230659 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0"
[0m13:54:22.232393 [debug] [Thread-2 (]: Writing injected SQL for node "model.de_pipeline.stg_rate_codes"
[0m13:54:22.232768 [debug] [Thread-4 (]: On test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_name
from "de_pipeline"."main_raw"."vendor_lookup"
where vendor_name is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.233294 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:54:22.233800 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf"
[0m13:54:22.234046 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.234299 [debug] [Thread-1 (]: On test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    vendor_abbr as unique_field,
    count(*) as n_records

from "de_pipeline"."main_raw"."vendor_lookup"
where vendor_abbr is not null
group by vendor_abbr
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:54:22.235632 [debug] [Thread-4 (]: On test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0: ROLLBACK
[0m13:54:22.236453 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0'
[0m13:54:22.236943 [debug] [Thread-4 (]: On test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0: Close
[0m13:54:22.237702 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:54:22.237495 [info ] [Thread-4 (]: 35 of 99 PASS not_null_vendor_lookup_vendor_name ............................... [[32mPASS[0m in 0.04s]
[0m13:54:22.237999 [debug] [Thread-3 (]: Began executing node test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c
[0m13:54:22.239212 [debug] [Thread-1 (]: On test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf: ROLLBACK
[0m13:54:22.239568 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0
[0m13:54:22.239866 [debug] [Thread-2 (]: Began executing node model.de_pipeline.stg_rate_codes
[0m13:54:22.241453 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c"
[0m13:54:22.242259 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf'
[0m13:54:22.242526 [debug] [Thread-4 (]: Began running node model.de_pipeline.stg_payment_types
[0m13:54:22.251268 [debug] [Thread-2 (]: Writing runtime sql for node "model.de_pipeline.stg_rate_codes"
[0m13:54:22.251860 [debug] [Thread-1 (]: On test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf: Close
[0m13:54:22.252294 [info ] [Thread-4 (]: 39 of 99 START sql view model main_staging.stg_payment_types ................... [RUN]
[0m13:54:22.253099 [info ] [Thread-1 (]: 36 of 99 PASS unique_vendor_lookup_vendor_abbr ................................. [[32mPASS[0m in 0.05s]
[0m13:54:22.253364 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0, now model.de_pipeline.stg_payment_types)
[0m13:54:22.253895 [debug] [Thread-1 (]: Finished running node test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf
[0m13:54:22.254259 [debug] [Thread-4 (]: Began compiling node model.de_pipeline.stg_payment_types
[0m13:54:22.254636 [debug] [Thread-1 (]: Began running node model.de_pipeline.int_trip_metrics
[0m13:54:22.256420 [debug] [Thread-4 (]: Writing injected SQL for node "model.de_pipeline.stg_payment_types"
[0m13:54:22.256844 [info ] [Thread-1 (]: 40 of 99 START sql view model main_intermediate.int_trip_metrics ............... [RUN]
[0m13:54:22.257567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf, now model.de_pipeline.int_trip_metrics)
[0m13:54:22.257928 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.stg_rate_codes"
[0m13:54:22.258160 [debug] [Thread-1 (]: Began compiling node model.de_pipeline.int_trip_metrics
[0m13:54:22.258400 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c"
[0m13:54:22.258790 [debug] [Thread-2 (]: On model.de_pipeline.stg_rate_codes: BEGIN
[0m13:54:22.261252 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_pipeline.int_trip_metrics"
[0m13:54:22.261576 [debug] [Thread-3 (]: On test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c: BEGIN
[0m13:54:22.262036 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:22.262472 [debug] [Thread-4 (]: Began executing node model.de_pipeline.stg_payment_types
[0m13:54:22.262715 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:22.265911 [debug] [Thread-4 (]: Writing runtime sql for node "model.de_pipeline.stg_payment_types"
[0m13:54:22.267224 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:54:22.267578 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.stg_rate_codes"
[0m13:54:22.267880 [debug] [Thread-2 (]: On model.de_pipeline.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_rate_codes"} */

  
  create view "de_pipeline"."main_staging"."stg_rate_codes__dbt_tmp" as (
    /*
    Staging model: Rate code lookup
    Maps rate_code_id to human-readable names.
*/

with source as (
    select * from "de_pipeline"."main_raw"."rate_code_lookup"
),

renamed as (
    select
        rate_code_id,
        rate_code_name
    from source
)

select * from renamed
  );

[0m13:54:22.268512 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:54:22.270330 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.stg_rate_codes"
[0m13:54:22.270538 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m13:54:22.270807 [debug] [Thread-2 (]: On model.de_pipeline.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_rate_codes"} */
alter view "de_pipeline"."main_staging"."stg_rate_codes__dbt_tmp" rename to "stg_rate_codes"
[0m13:54:22.271076 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c"
[0m13:54:22.271558 [debug] [Thread-3 (]: On test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    vendor_id as unique_field,
    count(*) as n_records

from "de_pipeline"."main_raw"."vendor_lookup"
where vendor_id is not null
group by vendor_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:54:22.271824 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:54:22.272221 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.stg_payment_types"
[0m13:54:22.272429 [debug] [Thread-1 (]: Began executing node model.de_pipeline.int_trip_metrics
[0m13:54:22.273192 [debug] [Thread-2 (]: On model.de_pipeline.stg_rate_codes: COMMIT
[0m13:54:22.273436 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.273631 [debug] [Thread-4 (]: On model.de_pipeline.stg_payment_types: BEGIN
[0m13:54:22.275664 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_pipeline.int_trip_metrics"
[0m13:54:22.276018 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.stg_rate_codes"
[0m13:54:22.277002 [debug] [Thread-3 (]: On test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c: ROLLBACK
[0m13:54:22.277194 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:22.277791 [debug] [Thread-2 (]: On model.de_pipeline.stg_rate_codes: COMMIT
[0m13:54:22.278450 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c'
[0m13:54:22.279457 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:54:22.280042 [debug] [Thread-3 (]: On test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c: Close
[0m13:54:22.280365 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.stg_payment_types"
[0m13:54:22.280969 [debug] [Thread-4 (]: On model.de_pipeline.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_payment_types"} */

  
  create view "de_pipeline"."main_staging"."stg_payment_types__dbt_tmp" as (
    /*
    Staging model: Payment type lookup
    Maps payment_type_id to human-readable names.
*/

with source as (
    select * from "de_pipeline"."main_raw"."payment_type_lookup"
),

renamed as (
    select
        payment_type_id,
        payment_type_name
    from source
)

select * from renamed
  );

[0m13:54:22.282464 [info ] [Thread-3 (]: 37 of 99 PASS unique_vendor_lookup_vendor_id ................................... [[32mPASS[0m in 0.06s]
[0m13:54:22.282742 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:54:22.282964 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:54:22.283276 [debug] [Thread-3 (]: Finished running node test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c
[0m13:54:22.285067 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.stg_rate_codes"
[0m13:54:22.286992 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.stg_payment_types"
[0m13:54:22.287404 [debug] [Thread-3 (]: Began running node model.de_pipeline.stg_taxi_zones
[0m13:54:22.287794 [debug] [Thread-2 (]: On model.de_pipeline.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_rate_codes"} */

      drop view if exists "de_pipeline"."main_staging"."stg_rate_codes__dbt_backup" cascade
    
[0m13:54:22.288131 [debug] [Thread-4 (]: On model.de_pipeline.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_payment_types"} */
alter view "de_pipeline"."main_staging"."stg_payment_types__dbt_tmp" rename to "stg_payment_types"
[0m13:54:22.288609 [info ] [Thread-3 (]: 41 of 99 START sql view model main_staging.stg_taxi_zones ...................... [RUN]
[0m13:54:22.289504 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.289810 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c, now model.de_pipeline.stg_taxi_zones)
[0m13:54:22.290070 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.290315 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.int_trip_metrics"
[0m13:54:22.291092 [debug] [Thread-2 (]: On model.de_pipeline.stg_rate_codes: Close
[0m13:54:22.291407 [debug] [Thread-3 (]: Began compiling node model.de_pipeline.stg_taxi_zones
[0m13:54:22.292171 [debug] [Thread-4 (]: On model.de_pipeline.stg_payment_types: COMMIT
[0m13:54:22.292520 [debug] [Thread-1 (]: On model.de_pipeline.int_trip_metrics: BEGIN
[0m13:54:22.292979 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd29b19d9-f4ff-4134-900c-c096522f9002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75663470db20>]}
[0m13:54:22.294792 [debug] [Thread-3 (]: Writing injected SQL for node "model.de_pipeline.stg_taxi_zones"
[0m13:54:22.295237 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.stg_payment_types"
[0m13:54:22.295612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:22.296163 [info ] [Thread-2 (]: 38 of 99 OK created sql view model main_staging.stg_rate_codes ................. [[32mOK[0m in 0.06s]
[0m13:54:22.296822 [debug] [Thread-4 (]: On model.de_pipeline.stg_payment_types: COMMIT
[0m13:54:22.297551 [debug] [Thread-2 (]: Finished running node model.de_pipeline.stg_rate_codes
[0m13:54:22.298125 [debug] [Thread-2 (]: Began running node model.de_pipeline.stg_vendors
[0m13:54:22.298592 [info ] [Thread-2 (]: 42 of 99 START sql view model main_staging.stg_vendors ......................... [RUN]
[0m13:54:22.299006 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.de_pipeline.stg_rate_codes, now model.de_pipeline.stg_vendors)
[0m13:54:22.299298 [debug] [Thread-2 (]: Began compiling node model.de_pipeline.stg_vendors
[0m13:54:22.301152 [debug] [Thread-2 (]: Writing injected SQL for node "model.de_pipeline.stg_vendors"
[0m13:54:22.301428 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m13:54:22.302905 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.stg_payment_types"
[0m13:54:22.303131 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m13:54:22.303347 [debug] [Thread-4 (]: On model.de_pipeline.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_payment_types"} */

      drop view if exists "de_pipeline"."main_staging"."stg_payment_types__dbt_backup" cascade
    
[0m13:54:22.303587 [debug] [Thread-3 (]: Began executing node model.de_pipeline.stg_taxi_zones
[0m13:54:22.303900 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.int_trip_metrics"
[0m13:54:22.305915 [debug] [Thread-3 (]: Writing runtime sql for node "model.de_pipeline.stg_taxi_zones"
[0m13:54:22.306165 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:54:22.306386 [debug] [Thread-2 (]: Began executing node model.de_pipeline.stg_vendors
[0m13:54:22.306644 [debug] [Thread-1 (]: On model.de_pipeline.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.int_trip_metrics"} */

  
  create view "de_pipeline"."main_intermediate"."int_trip_metrics__dbt_tmp" as (
    /*
    Intermediate model: Trip-level enrichment with calculated metrics.
    Uses adapter-dispatched macros for cross-dialect compatibility.
*/

with trips as (
    select * from "de_pipeline"."main_staging"."stg_yellow_trips"
),

enriched as (
    select
        trip_id,
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        payment_type_id,
        pickup_datetime,
        dropoff_datetime,
        passenger_count,
        trip_distance_miles,
        store_and_fwd_flag,

        -- calculated: duration in minutes
        
    datediff('minute', pickup_datetime, dropoff_datetime)
 as trip_duration_minutes,

        -- calculated: average speed (avoid division by zero)
        case
            when 
    datediff('minute', pickup_datetime, dropoff_datetime)
 > 0
            then round(
                trip_distance_miles / (
    datediff('minute', pickup_datetime, dropoff_datetime)
 / 60.0),
                2
            )
            else null
        end as avg_speed_mph,

        -- calculated: cost per mile
        case
            when trip_distance_miles > 0
            then round(fare_amount / trip_distance_miles, 2)
            else null
        end as cost_per_mile,

        -- calculated: tip percentage
        case
            when fare_amount > 0
            then round((tip_amount / fare_amount) * 100, 2)
            else null
        end as tip_percentage,

        -- time dimensions (using adapter-dispatched macros)
        date_trunc('day', pickup_datetime)::date as pickup_date,
        extract(hour from pickup_datetime) as pickup_hour,
        
    dayname(pickup_datetime)
 as pickup_day_of_week,
        case
            when extract(dow from pickup_datetime) in (0, 6) then true
            else false
        end as is_weekend,

        -- financials passthrough
        fare_amount,
        extra_amount,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount,
        congestion_surcharge,
        airport_fee

    from trips
)

select *
from enriched
where trip_duration_minutes between 1 and 720
  and (avg_speed_mph is null or avg_speed_mph < 100)
  );

[0m13:54:22.307748 [debug] [Thread-4 (]: On model.de_pipeline.stg_payment_types: Close
[0m13:54:22.310140 [debug] [Thread-2 (]: Writing runtime sql for node "model.de_pipeline.stg_vendors"
[0m13:54:22.311210 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd29b19d9-f4ff-4134-900c-c096522f9002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756625f21070>]}
[0m13:54:22.311792 [info ] [Thread-4 (]: 39 of 99 OK created sql view model main_staging.stg_payment_types .............. [[32mOK[0m in 0.06s]
[0m13:54:22.312115 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.312429 [debug] [Thread-4 (]: Finished running node model.de_pipeline.stg_payment_types
[0m13:54:22.314276 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.int_trip_metrics"
[0m13:54:22.314798 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m13:54:22.315393 [debug] [Thread-1 (]: On model.de_pipeline.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.int_trip_metrics"} */
alter view "de_pipeline"."main_intermediate"."int_trip_metrics__dbt_tmp" rename to "int_trip_metrics"
[0m13:54:22.315988 [info ] [Thread-4 (]: 43 of 99 START test not_null_stg_rate_codes_rate_code_id ....................... [RUN]
[0m13:54:22.316381 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.stg_taxi_zones"
[0m13:54:22.316744 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.stg_vendors"
[0m13:54:22.318007 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.de_pipeline.stg_payment_types, now test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a)
[0m13:54:22.318434 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.318775 [debug] [Thread-3 (]: On model.de_pipeline.stg_taxi_zones: BEGIN
[0m13:54:22.319258 [debug] [Thread-2 (]: On model.de_pipeline.stg_vendors: BEGIN
[0m13:54:22.319998 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m13:54:22.321262 [debug] [Thread-1 (]: On model.de_pipeline.int_trip_metrics: COMMIT
[0m13:54:22.321787 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:22.322265 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:22.325948 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m13:54:22.326735 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.int_trip_metrics"
[0m13:54:22.328230 [debug] [Thread-1 (]: On model.de_pipeline.int_trip_metrics: COMMIT
[0m13:54:22.329209 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m13:54:22.329680 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.stg_taxi_zones"
[0m13:54:22.330274 [debug] [Thread-3 (]: On model.de_pipeline.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_taxi_zones"} */

  
  create view "de_pipeline"."main_staging"."stg_taxi_zones__dbt_tmp" as (
    /*
    Staging model: Taxi zone lookup
    Maps LocationID to borough and zone name.
*/

with source as (
    select * from "de_pipeline"."main_raw"."taxi_zone_lookup"
),

renamed as (
    select
        cast("LocationID" as integer) as location_id,
        "Borough" as borough,
        "Zone" as zone_name,
        service_zone
    from source
)

select * from renamed
  );

[0m13:54:22.331648 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m13:54:22.332009 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:22.332326 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.stg_vendors"
[0m13:54:22.332593 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:54:22.335121 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.int_trip_metrics"
[0m13:54:22.335527 [debug] [Thread-2 (]: On model.de_pipeline.stg_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_vendors"} */

  
  create view "de_pipeline"."main_staging"."stg_vendors__dbt_tmp" as (
    /*
    Staging model: Vendor lookup
    Maps vendor_id to vendor name and abbreviation.
*/

with source as (
    select * from "de_pipeline"."main_raw"."vendor_lookup"
),

renamed as (
    select
        vendor_id,
        vendor_name,
        vendor_abbr
    from source
)

select * from renamed
  );

[0m13:54:22.337349 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.stg_taxi_zones"
[0m13:54:22.337602 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m13:54:22.337822 [debug] [Thread-1 (]: On model.de_pipeline.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.int_trip_metrics"} */

      drop view if exists "de_pipeline"."main_intermediate"."int_trip_metrics__dbt_backup" cascade
    
[0m13:54:22.338526 [debug] [Thread-3 (]: On model.de_pipeline.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_taxi_zones"} */
alter view "de_pipeline"."main_staging"."stg_taxi_zones__dbt_tmp" rename to "stg_taxi_zones"
[0m13:54:22.338849 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.340053 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m13:54:22.341059 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:22.343444 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.stg_vendors"
[0m13:54:22.343683 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:54:22.344776 [debug] [Thread-1 (]: On model.de_pipeline.int_trip_metrics: Close
[0m13:54:22.345058 [debug] [Thread-2 (]: On model.de_pipeline.stg_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_vendors"} */
alter view "de_pipeline"."main_staging"."stg_vendors__dbt_tmp" rename to "stg_vendors"
[0m13:54:22.345964 [debug] [Thread-3 (]: On model.de_pipeline.stg_taxi_zones: COMMIT
[0m13:54:22.346787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd29b19d9-f4ff-4134-900c-c096522f9002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75662c579a60>]}
[0m13:54:22.347274 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.stg_taxi_zones"
[0m13:54:22.347823 [info ] [Thread-1 (]: 40 of 99 OK created sql view model main_intermediate.int_trip_metrics .......... [[32mOK[0m in 0.09s]
[0m13:54:22.348074 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.348401 [debug] [Thread-3 (]: On model.de_pipeline.stg_taxi_zones: COMMIT
[0m13:54:22.348946 [debug] [Thread-1 (]: Finished running node model.de_pipeline.int_trip_metrics
[0m13:54:22.349747 [debug] [Thread-2 (]: On model.de_pipeline.stg_vendors: COMMIT
[0m13:54:22.350444 [debug] [Thread-1 (]: Began running node test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m13:54:22.350910 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.stg_vendors"
[0m13:54:22.351148 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m13:54:22.351560 [info ] [Thread-1 (]: 44 of 99 START test not_null_stg_rate_codes_rate_code_name ..................... [RUN]
[0m13:54:22.351912 [debug] [Thread-2 (]: On model.de_pipeline.stg_vendors: COMMIT
[0m13:54:22.352245 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:54:22.352459 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: BEGIN
[0m13:54:22.352888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_pipeline.int_trip_metrics, now test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f)
[0m13:54:22.354869 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.stg_taxi_zones"
[0m13:54:22.355275 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:22.355674 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m13:54:22.355945 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:54:22.356153 [debug] [Thread-3 (]: On model.de_pipeline.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_taxi_zones"} */

      drop view if exists "de_pipeline"."main_staging"."stg_taxi_zones__dbt_backup" cascade
    
[0m13:54:22.359655 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m13:54:22.361010 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.stg_vendors"
[0m13:54:22.361821 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:54:22.362198 [debug] [Thread-2 (]: On model.de_pipeline.stg_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_vendors"} */

      drop view if exists "de_pipeline"."main_staging"."stg_vendors__dbt_backup" cascade
    
[0m13:54:22.362616 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m13:54:22.363316 [debug] [Thread-3 (]: On model.de_pipeline.stg_taxi_zones: Close
[0m13:54:22.363829 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m13:54:22.364266 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd29b19d9-f4ff-4134-900c-c096522f9002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756625f36e70>]}
[0m13:54:22.364471 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.364794 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_id
from "de_pipeline"."main_staging"."stg_rate_codes"
where rate_code_id is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.365232 [info ] [Thread-3 (]: 41 of 99 OK created sql view model main_staging.stg_taxi_zones ................. [[32mOK[0m in 0.07s]
[0m13:54:22.366077 [debug] [Thread-2 (]: On model.de_pipeline.stg_vendors: Close
[0m13:54:22.366838 [debug] [Thread-3 (]: Finished running node model.de_pipeline.stg_taxi_zones
[0m13:54:22.367100 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.367384 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd29b19d9-f4ff-4134-900c-c096522f9002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756625f37e00>]}
[0m13:54:22.367614 [debug] [Thread-3 (]: Began running node test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m13:54:22.368094 [debug] [Thread-1 (]: Began executing node test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m13:54:22.368844 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: ROLLBACK
[0m13:54:22.369193 [info ] [Thread-2 (]: 42 of 99 OK created sql view model main_staging.stg_vendors .................... [[32mOK[0m in 0.07s]
[0m13:54:22.369577 [info ] [Thread-3 (]: 45 of 99 START test unique_stg_rate_codes_rate_code_id ......................... [RUN]
[0m13:54:22.371640 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m13:54:22.372380 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a'
[0m13:54:22.372657 [debug] [Thread-2 (]: Finished running node model.de_pipeline.stg_vendors
[0m13:54:22.372985 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.de_pipeline.stg_taxi_zones, now test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3)
[0m13:54:22.373472 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: Close
[0m13:54:22.373925 [debug] [Thread-2 (]: Began running node test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m13:54:22.374332 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m13:54:22.374808 [info ] [Thread-4 (]: 43 of 99 PASS not_null_stg_rate_codes_rate_code_id ............................. [[32mPASS[0m in 0.06s]
[0m13:54:22.375026 [info ] [Thread-2 (]: 46 of 99 START test not_null_stg_payment_types_payment_type_id ................. [RUN]
[0m13:54:22.377171 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m13:54:22.377674 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m13:54:22.378053 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.de_pipeline.stg_vendors, now test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78)
[0m13:54:22.378571 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m13:54:22.378905 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m13:54:22.379276 [info ] [Thread-4 (]: 47 of 99 START test not_null_stg_payment_types_payment_type_name ............... [RUN]
[0m13:54:22.381508 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m13:54:22.381937 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a, now test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39)
[0m13:54:22.382650 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m13:54:22.384704 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m13:54:22.385012 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m13:54:22.385595 [debug] [Thread-1 (]: On test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: BEGIN
[0m13:54:22.386071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:22.386448 [debug] [Thread-3 (]: Began executing node test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m13:54:22.388410 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m13:54:22.389198 [debug] [Thread-2 (]: Began executing node test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m13:54:22.390589 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m13:54:22.390864 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m13:54:22.391163 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:54:22.392220 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m13:54:22.392554 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m13:54:22.393157 [debug] [Thread-1 (]: On test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_name
from "de_pipeline"."main_staging"."stg_rate_codes"
where rate_code_name is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.393849 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m13:54:22.394164 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.394371 [debug] [Thread-3 (]: On test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3: BEGIN
[0m13:54:22.395481 [debug] [Thread-1 (]: On test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: ROLLBACK
[0m13:54:22.395760 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m13:54:22.396024 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:22.396694 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f'
[0m13:54:22.396901 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78: BEGIN
[0m13:54:22.397230 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m13:54:22.397822 [debug] [Thread-1 (]: On test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: Close
[0m13:54:22.398146 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:22.398938 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39: BEGIN
[0m13:54:22.399191 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:54:22.399732 [info ] [Thread-1 (]: 44 of 99 PASS not_null_stg_rate_codes_rate_code_name ........................... [[32mPASS[0m in 0.05s]
[0m13:54:22.400220 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:22.400788 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m13:54:22.401458 [debug] [Thread-1 (]: Finished running node test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m13:54:22.401718 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:54:22.402224 [debug] [Thread-3 (]: On test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rate_code_id as unique_field,
    count(*) as n_records

from "de_pipeline"."main_staging"."stg_rate_codes"
where rate_code_id is not null
group by rate_code_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:54:22.402732 [debug] [Thread-1 (]: Began running node test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534
[0m13:54:22.403154 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m13:54:22.403679 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:54:22.403880 [info ] [Thread-1 (]: 48 of 99 START test unique_stg_payment_types_payment_type_id ................... [RUN]
[0m13:54:22.404255 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.404497 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "de_pipeline"."main_staging"."stg_payment_types"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.404838 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m13:54:22.405219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f, now test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534)
[0m13:54:22.406204 [debug] [Thread-3 (]: On test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3: ROLLBACK
[0m13:54:22.406634 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_name
from "de_pipeline"."main_staging"."stg_payment_types"
where payment_type_name is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.406902 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:54:22.407104 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534
[0m13:54:22.407639 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3'
[0m13:54:22.408618 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78: ROLLBACK
[0m13:54:22.411351 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534"
[0m13:54:22.411618 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m13:54:22.411849 [debug] [Thread-3 (]: On test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3: Close
[0m13:54:22.412469 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78'
[0m13:54:22.414596 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39: ROLLBACK
[0m13:54:22.414983 [info ] [Thread-3 (]: 45 of 99 PASS unique_stg_rate_codes_rate_code_id ............................... [[32mPASS[0m in 0.04s]
[0m13:54:22.415212 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78: Close
[0m13:54:22.416036 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39'
[0m13:54:22.416346 [debug] [Thread-3 (]: Finished running node test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m13:54:22.416857 [info ] [Thread-2 (]: 46 of 99 PASS not_null_stg_payment_types_payment_type_id ....................... [[32mPASS[0m in 0.04s]
[0m13:54:22.417082 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39: Close
[0m13:54:22.417541 [debug] [Thread-3 (]: Began running node test.de_pipeline.assert_trip_duration_positive
[0m13:54:22.417996 [debug] [Thread-2 (]: Finished running node test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m13:54:22.418455 [info ] [Thread-4 (]: 47 of 99 PASS not_null_stg_payment_types_payment_type_name ..................... [[32mPASS[0m in 0.04s]
[0m13:54:22.418703 [info ] [Thread-3 (]: 49 of 99 START test assert_trip_duration_positive .............................. [RUN]
[0m13:54:22.419086 [debug] [Thread-2 (]: Began running node test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m13:54:22.419452 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m13:54:22.419858 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3, now test.de_pipeline.assert_trip_duration_positive)
[0m13:54:22.420281 [info ] [Thread-2 (]: 50 of 99 START test dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0  [RUN]
[0m13:54:22.420651 [debug] [Thread-4 (]: Began running node test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m13:54:22.420974 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.assert_trip_duration_positive
[0m13:54:22.421284 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78, now test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574)
[0m13:54:22.421539 [debug] [Thread-1 (]: Began executing node test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534
[0m13:54:22.421743 [info ] [Thread-4 (]: 51 of 99 START test dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1  [RUN]
[0m13:54:22.423617 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.assert_trip_duration_positive"
[0m13:54:22.424007 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m13:54:22.425323 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534"
[0m13:54:22.425740 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39, now test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718)
[0m13:54:22.427868 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m13:54:22.428404 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m13:54:22.430919 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m13:54:22.432022 [debug] [Thread-3 (]: Began executing node test.de_pipeline.assert_trip_duration_positive
[0m13:54:22.433286 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.assert_trip_duration_positive"
[0m13:54:22.434259 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534"
[0m13:54:22.434650 [debug] [Thread-1 (]: On test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534: BEGIN
[0m13:54:22.434987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:22.436316 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.assert_trip_duration_positive"
[0m13:54:22.436550 [debug] [Thread-2 (]: Began executing node test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m13:54:22.436834 [debug] [Thread-3 (]: On test.de_pipeline.assert_trip_duration_positive: BEGIN
[0m13:54:22.438283 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m13:54:22.438574 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:54:22.439142 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:22.439829 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534"
[0m13:54:22.440354 [debug] [Thread-4 (]: Began executing node test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m13:54:22.440586 [debug] [Thread-1 (]: On test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "de_pipeline"."main_staging"."stg_payment_types"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:54:22.442035 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m13:54:22.442930 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m13:54:22.443229 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.assert_trip_duration_positive"
[0m13:54:22.443442 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.443642 [debug] [Thread-3 (]: On test.de_pipeline.assert_trip_duration_positive: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.assert_trip_duration_positive"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
    Singular test: No trip should have negative duration.
*/

select
    trip_id,
    pickup_datetime,
    dropoff_datetime,
    trip_duration_minutes
from "de_pipeline"."main_intermediate"."int_trip_metrics"
where trip_duration_minutes < 0
  
  
      
    ) dbt_internal_test
[0m13:54:22.444863 [debug] [Thread-1 (]: On test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534: ROLLBACK
[0m13:54:22.445747 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534'
[0m13:54:22.446068 [debug] [Thread-1 (]: On test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534: Close
[0m13:54:22.446577 [info ] [Thread-1 (]: 48 of 99 PASS unique_stg_payment_types_payment_type_id ......................... [[32mPASS[0m in 0.04s]
[0m13:54:22.446890 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:54:22.447125 [debug] [Thread-1 (]: Finished running node test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534
[0m13:54:22.448056 [debug] [Thread-3 (]: On test.de_pipeline.assert_trip_duration_positive: ROLLBACK
[0m13:54:22.448290 [debug] [Thread-1 (]: Began running node test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m13:54:22.448946 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.assert_trip_duration_positive'
[0m13:54:22.449317 [info ] [Thread-1 (]: 52 of 99 START test not_null_int_trip_metrics_is_weekend ....................... [RUN]
[0m13:54:22.449653 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m13:54:22.449985 [debug] [Thread-3 (]: On test.de_pipeline.assert_trip_duration_positive: Close
[0m13:54:22.450247 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m13:54:22.450471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534, now test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed)
[0m13:54:22.450831 [debug] [Thread-2 (]: On test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: BEGIN
[0m13:54:22.451343 [info ] [Thread-3 (]: 49 of 99 PASS assert_trip_duration_positive .................................... [[32mPASS[0m in 0.03s]
[0m13:54:22.451574 [debug] [Thread-4 (]: On test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: BEGIN
[0m13:54:22.451916 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m13:54:22.452350 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:22.452753 [debug] [Thread-3 (]: Finished running node test.de_pipeline.assert_trip_duration_positive
[0m13:54:22.453057 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:22.455472 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m13:54:22.456155 [debug] [Thread-3 (]: Began running node test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m13:54:22.456811 [info ] [Thread-3 (]: 53 of 99 START test not_null_int_trip_metrics_pickup_date ...................... [RUN]
[0m13:54:22.457217 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.assert_trip_duration_positive, now test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3)
[0m13:54:22.457581 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m13:54:22.459825 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m13:54:22.460139 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m13:54:22.460639 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m13:54:22.460928 [debug] [Thread-2 (]: On test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "de_pipeline"."main_intermediate"."int_trip_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m13:54:22.461455 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m13:54:22.461755 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m13:54:22.462048 [debug] [Thread-4 (]: On test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "de_pipeline"."main_intermediate"."int_trip_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not trip_duration_minutes >= 1
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not trip_duration_minutes <= 720
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m13:54:22.462707 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.463683 [debug] [Thread-2 (]: On test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: ROLLBACK
[0m13:54:22.463927 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:54:22.464399 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574'
[0m13:54:22.465416 [debug] [Thread-4 (]: On test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: ROLLBACK
[0m13:54:22.465612 [debug] [Thread-2 (]: On test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: Close
[0m13:54:22.466267 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718'
[0m13:54:22.466512 [debug] [Thread-3 (]: Began executing node test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m13:54:22.466737 [debug] [Thread-1 (]: Began executing node test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m13:54:22.467055 [info ] [Thread-2 (]: 50 of 99 PASS dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0 ..... [[32mPASS[0m in 0.05s]
[0m13:54:22.467271 [debug] [Thread-4 (]: On test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: Close
[0m13:54:22.469811 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m13:54:22.470971 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m13:54:22.471385 [debug] [Thread-2 (]: Finished running node test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m13:54:22.471826 [info ] [Thread-4 (]: 51 of 99 PASS dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1  [[32mPASS[0m in 0.05s]
[0m13:54:22.472969 [debug] [Thread-2 (]: Began running node test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m13:54:22.473392 [debug] [Thread-4 (]: Finished running node test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m13:54:22.473783 [info ] [Thread-2 (]: 54 of 99 START test not_null_int_trip_metrics_pickup_hour ...................... [RUN]
[0m13:54:22.474429 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m13:54:22.475007 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574, now test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082)
[0m13:54:22.475385 [info ] [Thread-4 (]: 55 of 99 START test not_null_int_trip_metrics_trip_duration_minutes ............ [RUN]
[0m13:54:22.475768 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m13:54:22.476144 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718, now test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c)
[0m13:54:22.478658 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m13:54:22.479122 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m13:54:22.479429 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m13:54:22.481987 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m13:54:22.482290 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m13:54:22.482535 [debug] [Thread-3 (]: On test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3: BEGIN
[0m13:54:22.483145 [debug] [Thread-1 (]: On test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed: BEGIN
[0m13:54:22.483451 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:22.483809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:22.485266 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:54:22.485584 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m13:54:22.485890 [debug] [Thread-3 (]: On test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "de_pipeline"."main_intermediate"."int_trip_metrics"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.486756 [debug] [Thread-2 (]: Began executing node test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m13:54:22.488310 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m13:54:22.488576 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:54:22.488903 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:54:22.489510 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m13:54:22.490112 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m13:54:22.491166 [debug] [Thread-3 (]: On test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3: ROLLBACK
[0m13:54:22.491400 [debug] [Thread-1 (]: On test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "de_pipeline"."main_intermediate"."int_trip_metrics"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.493400 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m13:54:22.494147 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3'
[0m13:54:22.495048 [debug] [Thread-3 (]: On test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3: Close
[0m13:54:22.495601 [info ] [Thread-3 (]: 53 of 99 PASS not_null_int_trip_metrics_pickup_date ............................ [[32mPASS[0m in 0.04s]
[0m13:54:22.496059 [debug] [Thread-3 (]: Finished running node test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m13:54:22.496351 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:54:22.496590 [debug] [Thread-3 (]: Began running node test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m13:54:22.497688 [debug] [Thread-1 (]: On test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed: ROLLBACK
[0m13:54:22.497982 [info ] [Thread-3 (]: 56 of 99 START test not_null_int_trip_metrics_trip_id .......................... [RUN]
[0m13:54:22.498988 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed'
[0m13:54:22.499259 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m13:54:22.499746 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3, now test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f)
[0m13:54:22.500216 [debug] [Thread-1 (]: On test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed: Close
[0m13:54:22.500544 [debug] [Thread-2 (]: On test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082: BEGIN
[0m13:54:22.500807 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m13:54:22.501176 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m13:54:22.501791 [info ] [Thread-1 (]: 52 of 99 PASS not_null_int_trip_metrics_is_weekend ............................. [[32mPASS[0m in 0.05s]
[0m13:54:22.502046 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:22.502407 [debug] [Thread-4 (]: On test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: BEGIN
[0m13:54:22.505069 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m13:54:22.505798 [debug] [Thread-1 (]: Finished running node test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m13:54:22.506710 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:22.507438 [debug] [Thread-1 (]: Began running node test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m13:54:22.508000 [info ] [Thread-1 (]: 57 of 99 START test not_null_stg_taxi_zones_borough ............................ [RUN]
[0m13:54:22.508688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed, now test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b)
[0m13:54:22.508910 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m13:54:22.509137 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m13:54:22.509432 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m13:54:22.512377 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m13:54:22.512757 [debug] [Thread-2 (]: On test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "de_pipeline"."main_intermediate"."int_trip_metrics"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.513522 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m13:54:22.513926 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m13:54:22.514153 [debug] [Thread-3 (]: Began executing node test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m13:54:22.514376 [debug] [Thread-4 (]: On test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_duration_minutes
from "de_pipeline"."main_intermediate"."int_trip_metrics"
where trip_duration_minutes is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.514714 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.516189 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m13:54:22.517442 [debug] [Thread-2 (]: On test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082: ROLLBACK
[0m13:54:22.517788 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.518295 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082'
[0m13:54:22.519133 [debug] [Thread-4 (]: On test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: ROLLBACK
[0m13:54:22.519378 [debug] [Thread-2 (]: On test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082: Close
[0m13:54:22.519679 [debug] [Thread-1 (]: Began executing node test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m13:54:22.520213 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c'
[0m13:54:22.520929 [info ] [Thread-2 (]: 54 of 99 PASS not_null_int_trip_metrics_pickup_hour ............................ [[32mPASS[0m in 0.05s]
[0m13:54:22.523917 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m13:54:22.524299 [debug] [Thread-4 (]: On test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: Close
[0m13:54:22.524845 [debug] [Thread-2 (]: Finished running node test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m13:54:22.525356 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m13:54:22.525777 [info ] [Thread-4 (]: 55 of 99 PASS not_null_int_trip_metrics_trip_duration_minutes .................. [[32mPASS[0m in 0.05s]
[0m13:54:22.526016 [debug] [Thread-2 (]: Began running node test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m13:54:22.526377 [debug] [Thread-3 (]: On test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f: BEGIN
[0m13:54:22.526820 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m13:54:22.527147 [info ] [Thread-2 (]: 58 of 99 START test not_null_stg_taxi_zones_location_id ........................ [RUN]
[0m13:54:22.527476 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:22.527823 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m13:54:22.528156 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082, now test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf)
[0m13:54:22.528808 [info ] [Thread-4 (]: 59 of 99 START test not_null_stg_taxi_zones_zone_name .......................... [RUN]
[0m13:54:22.529284 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m13:54:22.529674 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c, now test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84)
[0m13:54:22.532287 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m13:54:22.532626 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m13:54:22.533016 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m13:54:22.533354 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m13:54:22.533745 [debug] [Thread-1 (]: On test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b: BEGIN
[0m13:54:22.536167 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m13:54:22.536655 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m13:54:22.537010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:22.537543 [debug] [Thread-3 (]: On test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "de_pipeline"."main_intermediate"."int_trip_metrics"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.538858 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:54:22.539167 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m13:54:22.539436 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.539629 [debug] [Thread-1 (]: On test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select borough
from "de_pipeline"."main_staging"."stg_taxi_zones"
where borough is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.540730 [debug] [Thread-3 (]: On test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f: ROLLBACK
[0m13:54:22.541065 [debug] [Thread-2 (]: Began executing node test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m13:54:22.541578 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f'
[0m13:54:22.541854 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.543230 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m13:54:22.543464 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m13:54:22.543654 [debug] [Thread-3 (]: On test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f: Close
[0m13:54:22.544523 [debug] [Thread-1 (]: On test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b: ROLLBACK
[0m13:54:22.545921 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m13:54:22.546513 [info ] [Thread-3 (]: 56 of 99 PASS not_null_int_trip_metrics_trip_id ................................ [[32mPASS[0m in 0.05s]
[0m13:54:22.546987 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b'
[0m13:54:22.547957 [debug] [Thread-3 (]: Finished running node test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m13:54:22.548226 [debug] [Thread-1 (]: On test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b: Close
[0m13:54:22.548588 [debug] [Thread-3 (]: Began running node test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m13:54:22.549127 [info ] [Thread-1 (]: 57 of 99 PASS not_null_stg_taxi_zones_borough .................................. [[32mPASS[0m in 0.04s]
[0m13:54:22.549403 [info ] [Thread-3 (]: 60 of 99 START test relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_  [RUN]
[0m13:54:22.549829 [debug] [Thread-1 (]: Finished running node test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m13:54:22.550250 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f, now test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a)
[0m13:54:22.550791 [debug] [Thread-1 (]: Began running node test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m13:54:22.551164 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m13:54:22.551668 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m13:54:22.552131 [info ] [Thread-1 (]: 61 of 99 START test relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_  [RUN]
[0m13:54:22.552663 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf: BEGIN
[0m13:54:22.555891 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m13:54:22.556165 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m13:54:22.556394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b, now test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f)
[0m13:54:22.556775 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:22.557330 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84: BEGIN
[0m13:54:22.557683 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m13:54:22.558394 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:22.561294 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m13:54:22.562244 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:54:22.562591 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m13:54:22.562904 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "de_pipeline"."main_staging"."stg_taxi_zones"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.563557 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m13:54:22.563810 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.564000 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m13:54:22.565438 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf: ROLLBACK
[0m13:54:22.565824 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select zone_name
from "de_pipeline"."main_staging"."stg_taxi_zones"
where zone_name is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.566102 [debug] [Thread-3 (]: Began executing node test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m13:54:22.566750 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf'
[0m13:54:22.568418 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m13:54:22.568658 [debug] [Thread-1 (]: Began executing node test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m13:54:22.568901 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:54:22.569087 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf: Close
[0m13:54:22.570513 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m13:54:22.571486 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84: ROLLBACK
[0m13:54:22.571857 [info ] [Thread-2 (]: 58 of 99 PASS not_null_stg_taxi_zones_location_id .............................. [[32mPASS[0m in 0.04s]
[0m13:54:22.572546 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84'
[0m13:54:22.572808 [debug] [Thread-2 (]: Finished running node test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m13:54:22.573131 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84: Close
[0m13:54:22.573521 [debug] [Thread-2 (]: Began running node test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c
[0m13:54:22.573994 [info ] [Thread-4 (]: 59 of 99 PASS not_null_stg_taxi_zones_zone_name ................................ [[32mPASS[0m in 0.04s]
[0m13:54:22.574250 [info ] [Thread-2 (]: 62 of 99 START test unique_stg_taxi_zones_location_id .......................... [RUN]
[0m13:54:22.574792 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m13:54:22.575345 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf, now test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c)
[0m13:54:22.575628 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m13:54:22.575868 [debug] [Thread-4 (]: Began running node model.de_pipeline.dim_vendors
[0m13:54:22.576177 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c
[0m13:54:22.576497 [debug] [Thread-3 (]: On test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: BEGIN
[0m13:54:22.576919 [info ] [Thread-4 (]: 63 of 99 START sql table model main_marts.dim_vendors .......................... [RUN]
[0m13:54:22.577142 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m13:54:22.580969 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m13:54:22.581607 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:22.582044 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84, now model.de_pipeline.dim_vendors)
[0m13:54:22.582419 [debug] [Thread-1 (]: On test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: BEGIN
[0m13:54:22.583307 [debug] [Thread-4 (]: Began compiling node model.de_pipeline.dim_vendors
[0m13:54:22.583628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:22.585287 [debug] [Thread-4 (]: Writing injected SQL for node "model.de_pipeline.dim_vendors"
[0m13:54:22.586293 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m13:54:22.586651 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m13:54:22.586914 [debug] [Thread-3 (]: On test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select dropoff_location_id as from_field
    from "de_pipeline"."main_staging"."stg_yellow_trips"
    where dropoff_location_id is not null
),

parent as (
    select location_id as to_field
    from "de_pipeline"."main_staging"."stg_taxi_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.587579 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:54:22.587881 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m13:54:22.588309 [debug] [Thread-1 (]: On test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select pickup_location_id as from_field
    from "de_pipeline"."main_staging"."stg_yellow_trips"
    where pickup_location_id is not null
),

parent as (
    select location_id as to_field
    from "de_pipeline"."main_staging"."stg_taxi_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.588562 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.590210 [debug] [Thread-3 (]: On test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: ROLLBACK
[0m13:54:22.590496 [debug] [Thread-2 (]: Began executing node test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c
[0m13:54:22.590768 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:54:22.591094 [debug] [Thread-4 (]: Began executing node model.de_pipeline.dim_vendors
[0m13:54:22.591575 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a'
[0m13:54:22.592957 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m13:54:22.593888 [debug] [Thread-1 (]: On test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: ROLLBACK
[0m13:54:22.595729 [debug] [Thread-4 (]: Writing runtime sql for node "model.de_pipeline.dim_vendors"
[0m13:54:22.596327 [debug] [Thread-3 (]: On test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: Close
[0m13:54:22.597269 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f'
[0m13:54:22.597987 [info ] [Thread-3 (]: 60 of 99 PASS relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_  [[32mPASS[0m in 0.05s]
[0m13:54:22.598240 [debug] [Thread-1 (]: On test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: Close
[0m13:54:22.598717 [debug] [Thread-3 (]: Finished running node test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m13:54:22.599274 [info ] [Thread-1 (]: 61 of 99 PASS relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_  [[32mPASS[0m in 0.04s]
[0m13:54:22.599557 [debug] [Thread-3 (]: Began running node model.de_pipeline.dim_payment_types
[0m13:54:22.600139 [debug] [Thread-1 (]: Finished running node test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m13:54:22.600567 [info ] [Thread-3 (]: 64 of 99 START sql table model main_marts.dim_payment_types .................... [RUN]
[0m13:54:22.601030 [debug] [Thread-1 (]: Began running node model.de_pipeline.int_daily_summary
[0m13:54:22.601408 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a, now model.de_pipeline.dim_payment_types)
[0m13:54:22.602127 [info ] [Thread-1 (]: 65 of 99 START sql view model main_intermediate.int_daily_summary .............. [RUN]
[0m13:54:22.602499 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m13:54:22.602747 [debug] [Thread-3 (]: Began compiling node model.de_pipeline.dim_payment_types
[0m13:54:22.602994 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.dim_vendors"
[0m13:54:22.603229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f, now model.de_pipeline.int_daily_summary)
[0m13:54:22.603562 [debug] [Thread-2 (]: On test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c: BEGIN
[0m13:54:22.605476 [debug] [Thread-3 (]: Writing injected SQL for node "model.de_pipeline.dim_payment_types"
[0m13:54:22.605875 [debug] [Thread-4 (]: On model.de_pipeline.dim_vendors: BEGIN
[0m13:54:22.606215 [debug] [Thread-1 (]: Began compiling node model.de_pipeline.int_daily_summary
[0m13:54:22.606551 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:22.607001 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:22.608603 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_pipeline.int_daily_summary"
[0m13:54:22.610521 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:54:22.610977 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m13:54:22.611349 [debug] [Thread-2 (]: On test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "de_pipeline"."main_staging"."stg_taxi_zones"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:54:22.611939 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m13:54:22.612290 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.dim_vendors"
[0m13:54:22.612561 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.612760 [debug] [Thread-4 (]: On model.de_pipeline.dim_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_vendors"} */

  
    
    

    create  table
      "de_pipeline"."main_marts"."dim_vendors__dbt_tmp"
  
    as (
      /*
    Dimension table: Taxi vendor descriptions.
    TPEP provider: 1=Creative Mobile Technologies (CMT), 2=VeriFone Inc. (VFI)
*/

with vendors as (
    select * from "de_pipeline"."main_staging"."stg_vendors"
),

final as (
    select
        vendor_id,
        vendor_name,
        vendor_abbr
    from vendors
)

select * from final
    );
  
  
[0m13:54:22.614019 [debug] [Thread-2 (]: On test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c: ROLLBACK
[0m13:54:22.614383 [debug] [Thread-1 (]: Began executing node model.de_pipeline.int_daily_summary
[0m13:54:22.614735 [debug] [Thread-3 (]: Began executing node model.de_pipeline.dim_payment_types
[0m13:54:22.615264 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c'
[0m13:54:22.615460 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.617372 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_pipeline.int_daily_summary"
[0m13:54:22.619302 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.dim_payment_types"
[0m13:54:22.619777 [debug] [Thread-2 (]: On test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c: Close
[0m13:54:22.622372 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.dim_vendors"
[0m13:54:22.622986 [debug] [Thread-3 (]: On model.de_pipeline.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_payment_types"} */
DESCRIBE (select * from (
        /*
    Dimension table: Payment type descriptions.
*/

with payment_types as (
    select * from "de_pipeline"."main_staging"."stg_payment_types"
),

final as (
    select
        payment_type_id,
        payment_type_name
    from payment_types
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:54:22.623588 [info ] [Thread-2 (]: 62 of 99 PASS unique_stg_taxi_zones_location_id ................................ [[32mPASS[0m in 0.05s]
[0m13:54:22.623819 [debug] [Thread-4 (]: On model.de_pipeline.dim_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_vendors"} */
alter table "de_pipeline"."main_marts"."dim_vendors__dbt_tmp" rename to "dim_vendors"
[0m13:54:22.624530 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:22.625060 [debug] [Thread-2 (]: Finished running node test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c
[0m13:54:22.626080 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.626509 [debug] [Thread-2 (]: Began running node model.de_pipeline.int_hourly_patterns
[0m13:54:22.627678 [debug] [Thread-4 (]: On model.de_pipeline.dim_vendors: COMMIT
[0m13:54:22.628200 [info ] [Thread-2 (]: 66 of 99 START sql view model main_intermediate.int_hourly_patterns ............ [RUN]
[0m13:54:22.628584 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.dim_vendors"
[0m13:54:22.629067 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c, now model.de_pipeline.int_hourly_patterns)
[0m13:54:22.629439 [debug] [Thread-4 (]: On model.de_pipeline.dim_vendors: COMMIT
[0m13:54:22.629795 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m13:54:22.630027 [debug] [Thread-2 (]: Began compiling node model.de_pipeline.int_hourly_patterns
[0m13:54:22.630269 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.int_daily_summary"
[0m13:54:22.631269 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.dim_payment_types"
[0m13:54:22.633032 [debug] [Thread-2 (]: Writing injected SQL for node "model.de_pipeline.int_hourly_patterns"
[0m13:54:22.633440 [debug] [Thread-1 (]: On model.de_pipeline.int_daily_summary: BEGIN
[0m13:54:22.633810 [debug] [Thread-3 (]: On model.de_pipeline.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_payment_types"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as payment_type_id, 
      
    cast(null as varchar)
 as payment_type_name
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:54:22.634112 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m13:54:22.634467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:22.636147 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.dim_vendors"
[0m13:54:22.636393 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:54:22.636815 [debug] [Thread-4 (]: On model.de_pipeline.dim_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_vendors"} */

      drop table if exists "de_pipeline"."main_marts"."dim_vendors__dbt_backup" cascade
    
[0m13:54:22.637695 [debug] [Thread-3 (]: Writing runtime sql for node "model.de_pipeline.dim_payment_types"
[0m13:54:22.638116 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m13:54:22.639172 [debug] [Thread-4 (]: On model.de_pipeline.dim_vendors: Close
[0m13:54:22.639653 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd29b19d9-f4ff-4134-900c-c096522f9002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75657403e8d0>]}
[0m13:54:22.639923 [debug] [Thread-2 (]: Began executing node model.de_pipeline.int_hourly_patterns
[0m13:54:22.640297 [info ] [Thread-4 (]: 63 of 99 OK created sql table model main_marts.dim_vendors ..................... [[32mOK[0m in 0.06s]
[0m13:54:22.640803 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m13:54:22.642811 [debug] [Thread-2 (]: Writing runtime sql for node "model.de_pipeline.int_hourly_patterns"
[0m13:54:22.643288 [debug] [Thread-4 (]: Finished running node model.de_pipeline.dim_vendors
[0m13:54:22.643627 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.int_daily_summary"
[0m13:54:22.644273 [debug] [Thread-4 (]: Began running node model.de_pipeline.dim_locations
[0m13:54:22.644607 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.dim_payment_types"
[0m13:54:22.644842 [debug] [Thread-1 (]: On model.de_pipeline.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.int_daily_summary"} */

  
  create view "de_pipeline"."main_intermediate"."int_daily_summary__dbt_tmp" as (
    /*
    Intermediate model: Daily aggregated trip and revenue metrics.
    One row per day with counts, averages, and revenue totals.
*/

with trip_metrics as (
    select * from "de_pipeline"."main_intermediate"."int_trip_metrics"
),

daily_agg as (
    select
        pickup_date,
        pickup_day_of_week,
        is_weekend,

        count(*) as total_trips,
        sum(passenger_count) as total_passengers,

        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(avg(avg_speed_mph), 2) as avg_speed_mph,

        round(sum(fare_amount), 2) as total_fare_revenue,
        round(sum(tip_amount), 2) as total_tip_revenue,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_trip_revenue,
        round(avg(tip_percentage), 2) as avg_tip_percentage,

        count(case when payment_type_id = 1 then 1 end) as credit_card_trips,
        count(case when payment_type_id = 2 then 1 end) as cash_trips

    from trip_metrics
    group by pickup_date, pickup_day_of_week, is_weekend
)

select * from daily_agg
  );

[0m13:54:22.645251 [info ] [Thread-4 (]: 67 of 99 START sql table model main_marts.dim_locations ........................ [RUN]
[0m13:54:22.645668 [debug] [Thread-3 (]: On model.de_pipeline.dim_payment_types: BEGIN
[0m13:54:22.646435 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.de_pipeline.dim_vendors, now model.de_pipeline.dim_locations)
[0m13:54:22.647040 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:54:22.647280 [debug] [Thread-4 (]: Began compiling node model.de_pipeline.dim_locations
[0m13:54:22.647575 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:54:22.647773 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.dim_payment_types"
[0m13:54:22.649554 [debug] [Thread-4 (]: Writing injected SQL for node "model.de_pipeline.dim_locations"
[0m13:54:22.649904 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.int_hourly_patterns"
[0m13:54:22.651490 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.int_daily_summary"
[0m13:54:22.651864 [debug] [Thread-3 (]: On model.de_pipeline.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_payment_types"} */

  
    
    
      
    

    create  table
      "de_pipeline"."main_marts"."dim_payment_types__dbt_tmp"
  
  (
    payment_type_id integer,
    payment_type_name varchar
    
    )
 ;
    insert into "de_pipeline"."main_marts"."dim_payment_types__dbt_tmp" 
  (
    
      
      payment_type_id ,
    
      
      payment_type_name 
    
  )
 (
      
    select payment_type_id, payment_type_name
    from (
        /*
    Dimension table: Payment type descriptions.
*/

with payment_types as (
    select * from "de_pipeline"."main_staging"."stg_payment_types"
),

final as (
    select
        payment_type_id,
        payment_type_name
    from payment_types
)

select * from final
    ) as model_subq
    );
  
  
[0m13:54:22.652383 [debug] [Thread-2 (]: On model.de_pipeline.int_hourly_patterns: BEGIN
[0m13:54:22.652935 [debug] [Thread-1 (]: On model.de_pipeline.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.int_daily_summary"} */
alter view "de_pipeline"."main_intermediate"."int_daily_summary__dbt_tmp" rename to "int_daily_summary"
[0m13:54:22.653491 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:22.654162 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:22.654491 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.655290 [debug] [Thread-1 (]: On model.de_pipeline.int_daily_summary: COMMIT
[0m13:54:22.657988 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.dim_payment_types"
[0m13:54:22.658467 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.int_daily_summary"
[0m13:54:22.658986 [debug] [Thread-3 (]: On model.de_pipeline.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_payment_types"} */
alter table "de_pipeline"."main_marts"."dim_payment_types__dbt_tmp" rename to "dim_payment_types"
[0m13:54:22.659345 [debug] [Thread-1 (]: On model.de_pipeline.int_daily_summary: COMMIT
[0m13:54:22.659726 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m13:54:22.659973 [debug] [Thread-4 (]: Began executing node model.de_pipeline.dim_locations
[0m13:54:22.660486 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:54:22.660685 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.int_hourly_patterns"
[0m13:54:22.662502 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.dim_locations"
[0m13:54:22.662817 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:54:22.663515 [debug] [Thread-3 (]: On model.de_pipeline.dim_payment_types: COMMIT
[0m13:54:22.663840 [debug] [Thread-2 (]: On model.de_pipeline.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.int_hourly_patterns"} */

  
  create view "de_pipeline"."main_intermediate"."int_hourly_patterns__dbt_tmp" as (
    /*
    Intermediate model: Hourly trip patterns by date.
    One row per date + hour combination.
*/

with trip_metrics as (
    select * from "de_pipeline"."main_intermediate"."int_trip_metrics"
),

hourly_agg as (
    select
        pickup_date,
        pickup_hour,
        pickup_day_of_week,
        is_weekend,

        count(*) as total_trips,
        round(avg(trip_distance_miles), 2) as avg_distance,
        round(avg(trip_duration_minutes), 2) as avg_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue

    from trip_metrics
    group by pickup_date, pickup_hour, pickup_day_of_week, is_weekend
)

select * from hourly_agg
  );

[0m13:54:22.664187 [debug] [Thread-4 (]: On model.de_pipeline.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_locations"} */
DESCRIBE (select * from (
        /*
    Dimension table: TLC Taxi Zone locations.
*/

with zones as (
    select * from "de_pipeline"."main_staging"."stg_taxi_zones"
),

final as (
    select
        location_id,
        borough,
        zone_name,
        service_zone
    from zones
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:54:22.666229 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.int_daily_summary"
[0m13:54:22.666559 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.dim_payment_types"
[0m13:54:22.667251 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:22.667605 [debug] [Thread-1 (]: On model.de_pipeline.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.int_daily_summary"} */

      drop view if exists "de_pipeline"."main_intermediate"."int_daily_summary__dbt_backup" cascade
    
[0m13:54:22.667916 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.668097 [debug] [Thread-3 (]: On model.de_pipeline.dim_payment_types: COMMIT
[0m13:54:22.670000 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.int_hourly_patterns"
[0m13:54:22.670284 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:54:22.670897 [debug] [Thread-2 (]: On model.de_pipeline.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.int_hourly_patterns"} */
alter view "de_pipeline"."main_intermediate"."int_hourly_patterns__dbt_tmp" rename to "int_hourly_patterns"
[0m13:54:22.671786 [debug] [Thread-1 (]: On model.de_pipeline.int_daily_summary: Close
[0m13:54:22.672655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd29b19d9-f4ff-4134-900c-c096522f9002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756574133dd0>]}
[0m13:54:22.672878 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.673420 [info ] [Thread-1 (]: 65 of 99 OK created sql view model main_intermediate.int_daily_summary ......... [[32mOK[0m in 0.07s]
[0m13:54:22.673751 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m13:54:22.673988 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:54:22.674710 [debug] [Thread-2 (]: On model.de_pipeline.int_hourly_patterns: COMMIT
[0m13:54:22.675205 [debug] [Thread-1 (]: Finished running node model.de_pipeline.int_daily_summary
[0m13:54:22.676087 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.dim_locations"
[0m13:54:22.677427 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.dim_payment_types"
[0m13:54:22.677727 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.int_hourly_patterns"
[0m13:54:22.678242 [debug] [Thread-4 (]: On model.de_pipeline.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_locations"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as location_id, 
      
    cast(null as varchar)
 as borough, 
      
    cast(null as varchar)
 as zone_name, 
      
    cast(null as varchar)
 as service_zone
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:54:22.678629 [debug] [Thread-1 (]: Began running node test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m13:54:22.678817 [debug] [Thread-3 (]: On model.de_pipeline.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_payment_types"} */

      drop table if exists "de_pipeline"."main_marts"."dim_payment_types__dbt_backup" cascade
    
[0m13:54:22.679101 [debug] [Thread-2 (]: On model.de_pipeline.int_hourly_patterns: COMMIT
[0m13:54:22.679670 [info ] [Thread-1 (]: 68 of 99 START test dbt_utils_accepted_range_int_daily_summary_total_trips__0 .. [RUN]
[0m13:54:22.679925 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m13:54:22.680316 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:54:22.680710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_pipeline.int_daily_summary, now test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863)
[0m13:54:22.681635 [debug] [Thread-4 (]: Writing runtime sql for node "model.de_pipeline.dim_locations"
[0m13:54:22.682361 [debug] [Thread-3 (]: On model.de_pipeline.dim_payment_types: Close
[0m13:54:22.682644 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:54:22.682853 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m13:54:22.683468 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd29b19d9-f4ff-4134-900c-c096522f9002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756574132b70>]}
[0m13:54:22.684869 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.int_hourly_patterns"
[0m13:54:22.687310 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m13:54:22.687961 [info ] [Thread-3 (]: 64 of 99 OK created sql table model main_marts.dim_payment_types ............... [[32mOK[0m in 0.08s]
[0m13:54:22.688336 [debug] [Thread-2 (]: On model.de_pipeline.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.int_hourly_patterns"} */

      drop view if exists "de_pipeline"."main_intermediate"."int_hourly_patterns__dbt_backup" cascade
    
[0m13:54:22.688963 [debug] [Thread-3 (]: Finished running node model.de_pipeline.dim_payment_types
[0m13:54:22.689468 [debug] [Thread-3 (]: Began running node test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686
[0m13:54:22.689827 [info ] [Thread-3 (]: 69 of 99 START test not_null_int_daily_summary_pickup_date ..................... [RUN]
[0m13:54:22.690221 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.690541 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.de_pipeline.dim_payment_types, now test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686)
[0m13:54:22.691623 [debug] [Thread-2 (]: On model.de_pipeline.int_hourly_patterns: Close
[0m13:54:22.691860 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.dim_locations"
[0m13:54:22.692068 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686
[0m13:54:22.692524 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd29b19d9-f4ff-4134-900c-c096522f9002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75662c568350>]}
[0m13:54:22.692773 [debug] [Thread-4 (]: On model.de_pipeline.dim_locations: BEGIN
[0m13:54:22.695203 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m13:54:22.695819 [info ] [Thread-2 (]: 66 of 99 OK created sql view model main_intermediate.int_hourly_patterns ....... [[32mOK[0m in 0.06s]
[0m13:54:22.696336 [debug] [Thread-1 (]: Began executing node test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m13:54:22.696650 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m13:54:22.696920 [debug] [Thread-2 (]: Finished running node model.de_pipeline.int_hourly_patterns
[0m13:54:22.698399 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m13:54:22.698867 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.dim_locations"
[0m13:54:22.699334 [debug] [Thread-2 (]: Began running node test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m13:54:22.699931 [debug] [Thread-4 (]: On model.de_pipeline.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_locations"} */

  
    
    
      
    

    create  table
      "de_pipeline"."main_marts"."dim_locations__dbt_tmp"
  
  (
    location_id integer,
    borough varchar,
    zone_name varchar,
    service_zone varchar
    
    )
 ;
    insert into "de_pipeline"."main_marts"."dim_locations__dbt_tmp" 
  (
    
      
      location_id ,
    
      
      borough ,
    
      
      zone_name ,
    
      
      service_zone 
    
  )
 (
      
    select location_id, borough, zone_name, service_zone
    from (
        /*
    Dimension table: TLC Taxi Zone locations.
*/

with zones as (
    select * from "de_pipeline"."main_staging"."stg_taxi_zones"
),

final as (
    select
        location_id,
        borough,
        zone_name,
        service_zone
    from zones
)

select * from final
    ) as model_subq
    );
  
  
[0m13:54:22.700294 [info ] [Thread-2 (]: 70 of 99 START test not_null_int_daily_summary_total_revenue ................... [RUN]
[0m13:54:22.701055 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.de_pipeline.int_hourly_patterns, now test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50)
[0m13:54:22.701457 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m13:54:22.704466 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m13:54:22.704864 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m13:54:22.707045 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.dim_locations"
[0m13:54:22.707286 [debug] [Thread-3 (]: Began executing node test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686
[0m13:54:22.707522 [debug] [Thread-4 (]: On model.de_pipeline.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_locations"} */
alter table "de_pipeline"."main_marts"."dim_locations__dbt_tmp" rename to "dim_locations"
[0m13:54:22.709886 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m13:54:22.710710 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m13:54:22.710948 [debug] [Thread-2 (]: Began executing node test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m13:54:22.711173 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.711382 [debug] [Thread-1 (]: On test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: BEGIN
[0m13:54:22.712785 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m13:54:22.714442 [debug] [Thread-4 (]: On model.de_pipeline.dim_locations: COMMIT
[0m13:54:22.714892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:22.715513 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.dim_locations"
[0m13:54:22.716275 [debug] [Thread-4 (]: On model.de_pipeline.dim_locations: COMMIT
[0m13:54:22.717204 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m13:54:22.717569 [debug] [Thread-3 (]: On test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686: BEGIN
[0m13:54:22.717936 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:22.718760 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m13:54:22.719119 [debug] [Thread-2 (]: On test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50: BEGIN
[0m13:54:22.719398 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:54:22.719685 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:22.719991 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m13:54:22.720539 [debug] [Thread-1 (]: On test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "de_pipeline"."main_intermediate"."int_daily_summary"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_trips >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m13:54:22.720785 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m13:54:22.722409 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.dim_locations"
[0m13:54:22.722881 [debug] [Thread-4 (]: On model.de_pipeline.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_locations"} */

      drop table if exists "de_pipeline"."main_marts"."dim_locations__dbt_backup" cascade
    
[0m13:54:22.723280 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m13:54:22.723561 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m13:54:22.723773 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m13:54:22.724755 [debug] [Thread-4 (]: On model.de_pipeline.dim_locations: Close
[0m13:54:22.725022 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:54:22.725241 [debug] [Thread-3 (]: On test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "de_pipeline"."main_intermediate"."int_daily_summary"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.725972 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd29b19d9-f4ff-4134-900c-c096522f9002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75656675b4d0>]}
[0m13:54:22.726865 [debug] [Thread-1 (]: On test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: ROLLBACK
[0m13:54:22.727253 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m13:54:22.727884 [info ] [Thread-4 (]: 67 of 99 OK created sql table model main_marts.dim_locations ................... [[32mOK[0m in 0.08s]
[0m13:54:22.728580 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863'
[0m13:54:22.728911 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m13:54:22.729459 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:54:22.729742 [debug] [Thread-4 (]: Finished running node model.de_pipeline.dim_locations
[0m13:54:22.730092 [debug] [Thread-1 (]: On test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: Close
[0m13:54:22.730493 [debug] [Thread-2 (]: On test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "de_pipeline"."main_intermediate"."int_daily_summary"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.731735 [debug] [Thread-3 (]: On test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686: ROLLBACK
[0m13:54:22.731974 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10
[0m13:54:22.732577 [info ] [Thread-1 (]: 68 of 99 PASS dbt_utils_accepted_range_int_daily_summary_total_trips__0 ........ [[32mPASS[0m in 0.05s]
[0m13:54:22.733267 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686'
[0m13:54:22.733492 [info ] [Thread-4 (]: 71 of 99 START test not_null_int_daily_summary_total_trips ..................... [RUN]
[0m13:54:22.733974 [debug] [Thread-1 (]: Finished running node test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m13:54:22.734318 [debug] [Thread-3 (]: On test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686: Close
[0m13:54:22.734744 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.de_pipeline.dim_locations, now test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10)
[0m13:54:22.735102 [debug] [Thread-1 (]: Began running node test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e
[0m13:54:22.735679 [info ] [Thread-3 (]: 69 of 99 PASS not_null_int_daily_summary_pickup_date ........................... [[32mPASS[0m in 0.05s]
[0m13:54:22.735956 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10
[0m13:54:22.736389 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:54:22.736632 [info ] [Thread-1 (]: 72 of 99 START test unique_int_daily_summary_pickup_date ....................... [RUN]
[0m13:54:22.737076 [debug] [Thread-3 (]: Finished running node test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686
[0m13:54:22.739538 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10"
[0m13:54:22.740887 [debug] [Thread-2 (]: On test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50: ROLLBACK
[0m13:54:22.741199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863, now test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e)
[0m13:54:22.741624 [debug] [Thread-3 (]: Began running node test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10
[0m13:54:22.742488 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50'
[0m13:54:22.742833 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e
[0m13:54:22.743203 [info ] [Thread-3 (]: 73 of 99 START test not_null_dim_payment_types_payment_type_id ................. [RUN]
[0m13:54:22.743517 [debug] [Thread-2 (]: On test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50: Close
[0m13:54:22.746217 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m13:54:22.746776 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686, now test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10)
[0m13:54:22.747327 [info ] [Thread-2 (]: 70 of 99 PASS not_null_int_daily_summary_total_revenue ......................... [[32mPASS[0m in 0.05s]
[0m13:54:22.747722 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10
[0m13:54:22.748212 [debug] [Thread-2 (]: Finished running node test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m13:54:22.750420 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m13:54:22.750865 [debug] [Thread-2 (]: Began running node test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m13:54:22.751389 [info ] [Thread-2 (]: 74 of 99 START test not_null_dim_payment_types_payment_type_name ............... [RUN]
[0m13:54:22.751621 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10
[0m13:54:22.751874 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50, now test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0)
[0m13:54:22.752101 [debug] [Thread-1 (]: Began executing node test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e
[0m13:54:22.753278 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10"
[0m13:54:22.753656 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m13:54:22.755089 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m13:54:22.757525 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m13:54:22.758495 [debug] [Thread-3 (]: Began executing node test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10
[0m13:54:22.760808 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m13:54:22.761938 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10"
[0m13:54:22.762237 [debug] [Thread-4 (]: On test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10: BEGIN
[0m13:54:22.762438 [debug] [Thread-2 (]: Began executing node test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m13:54:22.762750 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:22.828213 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m13:54:22.828584 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m13:54:22.829911 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m13:54:22.830363 [debug] [Thread-1 (]: On test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e: BEGIN
[0m13:54:22.830921 [debug] [Thread-3 (]: On test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10: BEGIN
[0m13:54:22.831378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:22.831715 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:22.832058 [debug] [Thread-4 (]: SQL status: OK in 0.069 seconds
[0m13:54:22.832622 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10"
[0m13:54:22.832874 [debug] [Thread-4 (]: On test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_trips
from "de_pipeline"."main_intermediate"."int_daily_summary"
where total_trips is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.833605 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:54:22.833911 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m13:54:22.834488 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:54:22.834783 [debug] [Thread-1 (]: On test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pickup_date as unique_field,
    count(*) as n_records

from "de_pipeline"."main_intermediate"."int_daily_summary"
where pickup_date is not null
group by pickup_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:54:22.835169 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m13:54:22.835834 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m13:54:22.836086 [debug] [Thread-3 (]: On test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "de_pipeline"."main_marts"."dim_payment_types"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.836520 [debug] [Thread-2 (]: On test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0: BEGIN
[0m13:54:22.837259 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m13:54:22.837510 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:22.837745 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.838877 [debug] [Thread-4 (]: On test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10: ROLLBACK
[0m13:54:22.839166 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:54:22.840478 [debug] [Thread-3 (]: On test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10: ROLLBACK
[0m13:54:22.841051 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10'
[0m13:54:22.841853 [debug] [Thread-1 (]: On test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e: ROLLBACK
[0m13:54:22.842395 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10'
[0m13:54:22.842740 [debug] [Thread-4 (]: On test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10: Close
[0m13:54:22.843264 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e'
[0m13:54:22.843596 [debug] [Thread-3 (]: On test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10: Close
[0m13:54:22.844126 [info ] [Thread-4 (]: 71 of 99 PASS not_null_int_daily_summary_total_trips ........................... [[32mPASS[0m in 0.11s]
[0m13:54:22.844588 [debug] [Thread-1 (]: On test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e: Close
[0m13:54:22.845107 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m13:54:22.845554 [info ] [Thread-3 (]: 73 of 99 PASS not_null_dim_payment_types_payment_type_id ....................... [[32mPASS[0m in 0.10s]
[0m13:54:22.846039 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10
[0m13:54:22.846424 [info ] [Thread-1 (]: 72 of 99 PASS unique_int_daily_summary_pickup_date ............................. [[32mPASS[0m in 0.11s]
[0m13:54:22.846658 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m13:54:22.847011 [debug] [Thread-3 (]: Finished running node test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10
[0m13:54:22.847278 [debug] [Thread-4 (]: Began running node test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62
[0m13:54:22.847585 [debug] [Thread-1 (]: Finished running node test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e
[0m13:54:22.847853 [debug] [Thread-2 (]: On test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_name
from "de_pipeline"."main_marts"."dim_payment_types"
where payment_type_name is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.848185 [debug] [Thread-3 (]: Began running node test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m13:54:22.848493 [info ] [Thread-4 (]: 75 of 99 START test unique_dim_payment_types_payment_type_id ................... [RUN]
[0m13:54:22.848804 [debug] [Thread-1 (]: Began running node test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m13:54:22.849547 [info ] [Thread-3 (]: 76 of 99 START test dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0  [RUN]
[0m13:54:22.849855 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.850123 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10, now test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62)
[0m13:54:22.850473 [info ] [Thread-1 (]: 77 of 99 START test not_null_int_hourly_patterns_pickup_date ................... [RUN]
[0m13:54:22.850902 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10, now test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe)
[0m13:54:22.852101 [debug] [Thread-2 (]: On test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0: ROLLBACK
[0m13:54:22.852343 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62
[0m13:54:22.852715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e, now test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2)
[0m13:54:22.853016 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m13:54:22.853560 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0'
[0m13:54:22.855810 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m13:54:22.856230 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m13:54:22.858152 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m13:54:22.858519 [debug] [Thread-2 (]: On test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0: Close
[0m13:54:22.860667 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m13:54:22.861312 [info ] [Thread-2 (]: 74 of 99 PASS not_null_dim_payment_types_payment_type_name ..................... [[32mPASS[0m in 0.11s]
[0m13:54:22.861751 [debug] [Thread-2 (]: Finished running node test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m13:54:22.862062 [debug] [Thread-2 (]: Began running node test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m13:54:22.862370 [info ] [Thread-2 (]: 78 of 99 START test not_null_int_hourly_patterns_pickup_hour ................... [RUN]
[0m13:54:22.862745 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0, now test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d)
[0m13:54:22.863037 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m13:54:22.865319 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m13:54:22.866603 [debug] [Thread-1 (]: Began executing node test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m13:54:22.866937 [debug] [Thread-4 (]: Began executing node test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62
[0m13:54:22.867163 [debug] [Thread-3 (]: Began executing node test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m13:54:22.868859 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m13:54:22.870194 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m13:54:22.871796 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m13:54:22.872109 [debug] [Thread-2 (]: Began executing node test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m13:54:22.875208 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m13:54:22.878969 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m13:54:22.879646 [debug] [Thread-1 (]: On test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2: BEGIN
[0m13:54:22.880115 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m13:54:22.880336 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:22.880629 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m13:54:22.881000 [debug] [Thread-4 (]: On test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62: BEGIN
[0m13:54:22.881940 [debug] [Thread-3 (]: On test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: BEGIN
[0m13:54:22.882395 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:22.882705 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m13:54:22.882872 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:22.883314 [debug] [Thread-2 (]: On test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: BEGIN
[0m13:54:22.883713 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:22.884095 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:54:22.884397 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m13:54:22.884651 [debug] [Thread-1 (]: On test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "de_pipeline"."main_intermediate"."int_hourly_patterns"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.885373 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:54:22.885858 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m13:54:22.886171 [debug] [Thread-4 (]: On test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "de_pipeline"."main_marts"."dim_payment_types"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:54:22.886441 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:54:22.886952 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m13:54:22.888117 [debug] [Thread-1 (]: On test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2: ROLLBACK
[0m13:54:22.888408 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:54:22.888587 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m13:54:22.889384 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2'
[0m13:54:22.890173 [debug] [Thread-4 (]: On test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62: ROLLBACK
[0m13:54:22.890514 [debug] [Thread-3 (]: On test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "de_pipeline"."main_intermediate"."int_hourly_patterns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m13:54:22.890823 [debug] [Thread-1 (]: On test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2: Close
[0m13:54:22.891022 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m13:54:22.891406 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62'
[0m13:54:22.892196 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m13:54:22.892004 [info ] [Thread-1 (]: 77 of 99 PASS not_null_int_hourly_patterns_pickup_date ......................... [[32mPASS[0m in 0.04s]
[0m13:54:22.892622 [debug] [Thread-4 (]: On test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62: Close
[0m13:54:22.892954 [debug] [Thread-2 (]: On test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "de_pipeline"."main_intermediate"."int_hourly_patterns"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.893373 [debug] [Thread-1 (]: Finished running node test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m13:54:22.893603 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:54:22.894489 [info ] [Thread-4 (]: 75 of 99 PASS unique_dim_payment_types_payment_type_id ......................... [[32mPASS[0m in 0.04s]
[0m13:54:22.895085 [debug] [Thread-1 (]: Began running node test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m13:54:22.896238 [debug] [Thread-3 (]: On test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: ROLLBACK
[0m13:54:22.896602 [debug] [Thread-4 (]: Finished running node test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62
[0m13:54:22.896889 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:54:22.897122 [info ] [Thread-1 (]: 79 of 99 START test not_null_int_hourly_patterns_total_trips ................... [RUN]
[0m13:54:22.897749 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe'
[0m13:54:22.898021 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af
[0m13:54:22.898925 [debug] [Thread-2 (]: On test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: ROLLBACK
[0m13:54:22.899165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2, now test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf)
[0m13:54:22.899457 [debug] [Thread-3 (]: On test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: Close
[0m13:54:22.899738 [info ] [Thread-4 (]: 80 of 99 START test not_null_dim_locations_borough ............................. [RUN]
[0m13:54:22.900286 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d'
[0m13:54:22.900569 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m13:54:22.901021 [info ] [Thread-3 (]: 76 of 99 PASS dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0 .. [[32mPASS[0m in 0.05s]
[0m13:54:22.901263 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62, now test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af)
[0m13:54:22.901571 [debug] [Thread-2 (]: On test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: Close
[0m13:54:22.903901 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m13:54:22.904402 [debug] [Thread-3 (]: Finished running node test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m13:54:22.904817 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af
[0m13:54:22.905226 [info ] [Thread-2 (]: 78 of 99 PASS not_null_int_hourly_patterns_pickup_hour ......................... [[32mPASS[0m in 0.04s]
[0m13:54:22.905607 [debug] [Thread-3 (]: Began running node test.de_pipeline.not_null_dim_locations_location_id.70b6875476
[0m13:54:22.907948 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af"
[0m13:54:22.908370 [debug] [Thread-2 (]: Finished running node test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m13:54:22.908675 [info ] [Thread-3 (]: 81 of 99 START test not_null_dim_locations_location_id ......................... [RUN]
[0m13:54:22.909340 [debug] [Thread-2 (]: Began running node test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d
[0m13:54:22.909920 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe, now test.de_pipeline.not_null_dim_locations_location_id.70b6875476)
[0m13:54:22.910285 [info ] [Thread-2 (]: 82 of 99 START test not_null_dim_locations_zone_name ........................... [RUN]
[0m13:54:22.910644 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.not_null_dim_locations_location_id.70b6875476
[0m13:54:22.911020 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d, now test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d)
[0m13:54:22.914105 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.not_null_dim_locations_location_id.70b6875476"
[0m13:54:22.914473 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d
[0m13:54:22.914745 [debug] [Thread-1 (]: Began executing node test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m13:54:22.916842 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d"
[0m13:54:22.917081 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af
[0m13:54:22.918237 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m13:54:22.919730 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af"
[0m13:54:22.920826 [debug] [Thread-3 (]: Began executing node test.de_pipeline.not_null_dim_locations_location_id.70b6875476
[0m13:54:22.922067 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.not_null_dim_locations_location_id.70b6875476"
[0m13:54:22.922347 [debug] [Thread-2 (]: Began executing node test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d
[0m13:54:22.923674 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d"
[0m13:54:22.925793 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m13:54:22.926109 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af"
[0m13:54:22.926356 [debug] [Thread-1 (]: On test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: BEGIN
[0m13:54:22.926832 [debug] [Thread-4 (]: On test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af: BEGIN
[0m13:54:22.927293 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_dim_locations_location_id.70b6875476"
[0m13:54:22.927594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:22.928016 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:22.928325 [debug] [Thread-3 (]: On test.de_pipeline.not_null_dim_locations_location_id.70b6875476: BEGIN
[0m13:54:22.929015 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d"
[0m13:54:22.929380 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:22.929767 [debug] [Thread-2 (]: On test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d: BEGIN
[0m13:54:22.930244 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:22.930846 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:22.931214 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m13:54:22.931573 [debug] [Thread-1 (]: On test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_trips
from "de_pipeline"."main_intermediate"."int_hourly_patterns"
where total_trips is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.932114 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m13:54:22.932456 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af"
[0m13:54:22.932745 [debug] [Thread-4 (]: On test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select borough
from "de_pipeline"."main_marts"."dim_locations"
where borough is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.933209 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m13:54:22.933559 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.933824 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_dim_locations_location_id.70b6875476"
[0m13:54:22.935334 [debug] [Thread-4 (]: On test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af: ROLLBACK
[0m13:54:22.935623 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:54:22.935940 [debug] [Thread-3 (]: On test.de_pipeline.not_null_dim_locations_location_id.70b6875476: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_dim_locations_location_id.70b6875476"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "de_pipeline"."main_marts"."dim_locations"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.936564 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af'
[0m13:54:22.937424 [debug] [Thread-1 (]: On test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: ROLLBACK
[0m13:54:22.937800 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m13:54:22.937999 [debug] [Thread-4 (]: On test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af: Close
[0m13:54:22.938245 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.938689 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf'
[0m13:54:22.939465 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d"
[0m13:54:22.940011 [info ] [Thread-4 (]: 80 of 99 PASS not_null_dim_locations_borough ................................... [[32mPASS[0m in 0.04s]
[0m13:54:22.940845 [debug] [Thread-3 (]: On test.de_pipeline.not_null_dim_locations_location_id.70b6875476: ROLLBACK
[0m13:54:22.941046 [debug] [Thread-1 (]: On test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: Close
[0m13:54:22.941453 [debug] [Thread-2 (]: On test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select zone_name
from "de_pipeline"."main_marts"."dim_locations"
where zone_name is null



  
  
      
    ) dbt_internal_test
[0m13:54:22.941822 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af
[0m13:54:22.942339 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.not_null_dim_locations_location_id.70b6875476'
[0m13:54:22.942704 [info ] [Thread-1 (]: 79 of 99 PASS not_null_int_hourly_patterns_total_trips ......................... [[32mPASS[0m in 0.04s]
[0m13:54:22.943220 [debug] [Thread-4 (]: Began running node test.de_pipeline.unique_dim_locations_location_id.09f471618d
[0m13:54:22.943531 [debug] [Thread-3 (]: On test.de_pipeline.not_null_dim_locations_location_id.70b6875476: Close
[0m13:54:22.943724 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.944066 [debug] [Thread-1 (]: Finished running node test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m13:54:22.944320 [info ] [Thread-4 (]: 83 of 99 START test unique_dim_locations_location_id ........................... [RUN]
[0m13:54:22.944745 [info ] [Thread-3 (]: 81 of 99 PASS not_null_dim_locations_location_id ............................... [[32mPASS[0m in 0.03s]
[0m13:54:22.945500 [debug] [Thread-2 (]: On test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d: ROLLBACK
[0m13:54:22.945739 [debug] [Thread-1 (]: Began running node model.de_pipeline.mart_daily_revenue
[0m13:54:22.946089 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af, now test.de_pipeline.unique_dim_locations_location_id.09f471618d)
[0m13:54:22.946463 [debug] [Thread-3 (]: Finished running node test.de_pipeline.not_null_dim_locations_location_id.70b6875476
[0m13:54:22.947013 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d'
[0m13:54:22.947484 [info ] [Thread-1 (]: 84 of 99 START sql table model main_marts.mart_daily_revenue ................... [RUN]
[0m13:54:22.947838 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.unique_dim_locations_location_id.09f471618d
[0m13:54:22.948232 [debug] [Thread-3 (]: Began running node model.de_pipeline.mart_hourly_demand
[0m13:54:22.948564 [debug] [Thread-2 (]: On test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d: Close
[0m13:54:22.948872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf, now model.de_pipeline.mart_daily_revenue)
[0m13:54:22.952273 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.unique_dim_locations_location_id.09f471618d"
[0m13:54:22.952702 [info ] [Thread-3 (]: 85 of 99 START sql table model main_marts.mart_hourly_demand ................... [RUN]
[0m13:54:22.953234 [info ] [Thread-2 (]: 82 of 99 PASS not_null_dim_locations_zone_name ................................. [[32mPASS[0m in 0.04s]
[0m13:54:22.953470 [debug] [Thread-1 (]: Began compiling node model.de_pipeline.mart_daily_revenue
[0m13:54:22.954017 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_dim_locations_location_id.70b6875476, now model.de_pipeline.mart_hourly_demand)
[0m13:54:22.954529 [debug] [Thread-2 (]: Finished running node test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d
[0m13:54:22.956584 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_pipeline.mart_daily_revenue"
[0m13:54:22.956916 [debug] [Thread-3 (]: Began compiling node model.de_pipeline.mart_hourly_demand
[0m13:54:22.958737 [debug] [Thread-3 (]: Writing injected SQL for node "model.de_pipeline.mart_hourly_demand"
[0m13:54:22.959764 [debug] [Thread-4 (]: Began executing node test.de_pipeline.unique_dim_locations_location_id.09f471618d
[0m13:54:22.961018 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.unique_dim_locations_location_id.09f471618d"
[0m13:54:22.962192 [debug] [Thread-1 (]: Began executing node model.de_pipeline.mart_daily_revenue
[0m13:54:22.964102 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.mart_daily_revenue"
[0m13:54:22.964545 [debug] [Thread-1 (]: On model.de_pipeline.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_daily_revenue"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Daily revenue metrics with running totals.
*/

with daily as (
    select * from "de_pipeline"."main_intermediate"."int_daily_summary"
),

dates as (
    select * from "de_pipeline"."main_marts"."dim_dates"
),

final as (
    select
        d.date_key,
        d.day_of_week_name,
        d.is_weekend,
        d.is_holiday,
        d.week_of_year,

        daily.total_trips,
        daily.total_passengers,
        daily.total_fare_revenue,
        daily.total_tip_revenue,
        daily.total_revenue,
        daily.avg_trip_revenue,
        daily.avg_tip_percentage,
        daily.credit_card_trips,
        daily.cash_trips,
        daily.avg_trip_distance,
        daily.avg_trip_duration_min,

        -- running total
        sum(daily.total_revenue) over (order by d.date_key) as cumulative_revenue,

        -- day-over-day change
        daily.total_revenue - lag(daily.total_revenue) over (order by d.date_key) as revenue_change_vs_prior_day

    from daily
    inner join dates d
        on daily.pickup_date = d.date_key
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:54:22.965041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:22.965686 [debug] [Thread-3 (]: Began executing node model.de_pipeline.mart_hourly_demand
[0m13:54:22.967459 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.mart_hourly_demand"
[0m13:54:22.967845 [debug] [Thread-3 (]: On model.de_pipeline.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_hourly_demand"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Hourly demand patterns.
*/

with hourly as (
    select * from "de_pipeline"."main_intermediate"."int_hourly_patterns"
),

final as (
    select
        pickup_hour,
        is_weekend,

        count(*) as days_observed,
        round(avg(total_trips), 0) as avg_trips_per_period,
        round(avg(avg_distance), 2) as avg_distance,
        round(avg(avg_duration_min), 2) as avg_duration_min,
        round(avg(total_revenue), 2) as avg_revenue_per_period,
        sum(total_trips) as total_trips_all_days

    from hourly
    group by pickup_hour, is_weekend
)

select * from final
order by is_weekend, pickup_hour
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:54:22.968209 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:22.969396 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.unique_dim_locations_location_id.09f471618d"
[0m13:54:22.969757 [debug] [Thread-4 (]: On test.de_pipeline.unique_dim_locations_location_id.09f471618d: BEGIN
[0m13:54:22.970089 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:22.970478 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:54:22.972849 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.mart_daily_revenue"
[0m13:54:22.973332 [debug] [Thread-1 (]: On model.de_pipeline.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_daily_revenue"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as date_key, 
      
    cast(null as varchar)
 as day_of_week_name, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as boolean)
 as is_holiday, 
      
    cast(null as bigint)
 as week_of_year, 
      
    cast(null as bigint)
 as total_trips, 
      
    cast(null as hugeint)
 as total_passengers, 
      
    cast(null as decimal(38,2))
 as total_fare_revenue, 
      
    cast(null as decimal(38,2))
 as total_tip_revenue, 
      
    cast(null as decimal(38,2))
 as total_revenue, 
      
    cast(null as double)
 as avg_trip_revenue, 
      
    cast(null as double)
 as avg_tip_percentage, 
      
    cast(null as bigint)
 as credit_card_trips, 
      
    cast(null as bigint)
 as cash_trips, 
      
    cast(null as double)
 as avg_trip_distance, 
      
    cast(null as double)
 as avg_trip_duration_min, 
      
    cast(null as decimal(38,2))
 as cumulative_revenue, 
      
    cast(null as decimal(38,2))
 as revenue_change_vs_prior_day
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:54:22.974041 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m13:54:22.974281 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.974503 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m13:54:22.974786 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.unique_dim_locations_location_id.09f471618d"
[0m13:54:22.976601 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_pipeline.mart_daily_revenue"
[0m13:54:22.977667 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.mart_hourly_demand"
[0m13:54:22.977866 [debug] [Thread-4 (]: On test.de_pipeline.unique_dim_locations_location_id.09f471618d: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_dim_locations_location_id.09f471618d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "de_pipeline"."main_marts"."dim_locations"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:54:22.978569 [debug] [Thread-3 (]: On model.de_pipeline.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_hourly_demand"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as bigint)
 as pickup_hour, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as bigint)
 as days_observed, 
      
    cast(null as double)
 as avg_trips_per_period, 
      
    cast(null as double)
 as avg_distance, 
      
    cast(null as double)
 as avg_duration_min, 
      
    cast(null as double)
 as avg_revenue_per_period, 
      
    cast(null as hugeint)
 as total_trips_all_days
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:54:22.979623 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:54:22.979890 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:54:22.980799 [debug] [Thread-3 (]: Writing runtime sql for node "model.de_pipeline.mart_hourly_demand"
[0m13:54:22.981647 [debug] [Thread-4 (]: On test.de_pipeline.unique_dim_locations_location_id.09f471618d: ROLLBACK
[0m13:54:22.982358 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.unique_dim_locations_location_id.09f471618d'
[0m13:54:22.982652 [debug] [Thread-4 (]: On test.de_pipeline.unique_dim_locations_location_id.09f471618d: Close
[0m13:54:22.983196 [info ] [Thread-4 (]: 83 of 99 PASS unique_dim_locations_location_id ................................. [[32mPASS[0m in 0.04s]
[0m13:54:22.983571 [debug] [Thread-4 (]: Finished running node test.de_pipeline.unique_dim_locations_location_id.09f471618d
[0m13:54:22.984224 [debug] [Thread-2 (]: Began running node model.de_pipeline.fct_trips
[0m13:54:22.984661 [info ] [Thread-2 (]: 86 of 99 START sql incremental model main_marts.fct_trips ...................... [RUN]
[0m13:54:22.985043 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d, now model.de_pipeline.fct_trips)
[0m13:54:22.985363 [debug] [Thread-2 (]: Began compiling node model.de_pipeline.fct_trips
[0m13:54:22.988990 [debug] [Thread-2 (]: Writing injected SQL for node "model.de_pipeline.fct_trips"
[0m13:54:22.990076 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.mart_hourly_demand"
[0m13:54:22.990403 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.mart_daily_revenue"
[0m13:54:22.990607 [debug] [Thread-3 (]: On model.de_pipeline.mart_hourly_demand: BEGIN
[0m13:54:22.990959 [debug] [Thread-1 (]: On model.de_pipeline.mart_daily_revenue: BEGIN
[0m13:54:22.991684 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:54:22.991907 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:22.992083 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.mart_hourly_demand"
[0m13:54:22.992368 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.mart_daily_revenue"
[0m13:54:22.992649 [debug] [Thread-3 (]: On model.de_pipeline.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_hourly_demand"} */

  
    
    
      
    

    create  table
      "de_pipeline"."main_marts"."mart_hourly_demand__dbt_tmp"
  
  (
    pickup_hour bigint,
    is_weekend boolean,
    days_observed bigint,
    avg_trips_per_period double,
    avg_distance double,
    avg_duration_min double,
    avg_revenue_per_period double,
    total_trips_all_days hugeint
    
    )
 ;
    insert into "de_pipeline"."main_marts"."mart_hourly_demand__dbt_tmp" 
  (
    
      
      pickup_hour ,
    
      
      is_weekend ,
    
      
      days_observed ,
    
      
      avg_trips_per_period ,
    
      
      avg_distance ,
    
      
      avg_duration_min ,
    
      
      avg_revenue_per_period ,
    
      
      total_trips_all_days 
    
  )
 (
      
    select pickup_hour, is_weekend, days_observed, avg_trips_per_period, avg_distance, avg_duration_min, avg_revenue_per_period, total_trips_all_days
    from (
        /*
    Analytics mart: Hourly demand patterns.
*/

with hourly as (
    select * from "de_pipeline"."main_intermediate"."int_hourly_patterns"
),

final as (
    select
        pickup_hour,
        is_weekend,

        count(*) as days_observed,
        round(avg(total_trips), 0) as avg_trips_per_period,
        round(avg(avg_distance), 2) as avg_distance,
        round(avg(avg_duration_min), 2) as avg_duration_min,
        round(avg(total_revenue), 2) as avg_revenue_per_period,
        sum(total_trips) as total_trips_all_days

    from hourly
    group by pickup_hour, is_weekend
)

select * from final
order by is_weekend, pickup_hour
    ) as model_subq
    );
  
  
[0m13:54:22.992954 [debug] [Thread-1 (]: On model.de_pipeline.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_daily_revenue"} */

  
    
    
      
    

    create  table
      "de_pipeline"."main_marts"."mart_daily_revenue__dbt_tmp"
  
  (
    date_key date,
    day_of_week_name varchar,
    is_weekend boolean,
    is_holiday boolean,
    week_of_year bigint,
    total_trips bigint,
    total_passengers hugeint,
    total_fare_revenue decimal(38,2),
    total_tip_revenue decimal(38,2),
    total_revenue decimal(38,2),
    avg_trip_revenue double,
    avg_tip_percentage double,
    credit_card_trips bigint,
    cash_trips bigint,
    avg_trip_distance double,
    avg_trip_duration_min double,
    cumulative_revenue decimal(38,2),
    revenue_change_vs_prior_day decimal(38,2)
    
    )
 ;
    insert into "de_pipeline"."main_marts"."mart_daily_revenue__dbt_tmp" 
  (
    
      
      date_key ,
    
      
      day_of_week_name ,
    
      
      is_weekend ,
    
      
      is_holiday ,
    
      
      week_of_year ,
    
      
      total_trips ,
    
      
      total_passengers ,
    
      
      total_fare_revenue ,
    
      
      total_tip_revenue ,
    
      
      total_revenue ,
    
      
      avg_trip_revenue ,
    
      
      avg_tip_percentage ,
    
      
      credit_card_trips ,
    
      
      cash_trips ,
    
      
      avg_trip_distance ,
    
      
      avg_trip_duration_min ,
    
      
      cumulative_revenue ,
    
      
      revenue_change_vs_prior_day 
    
  )
 (
      
    select date_key, day_of_week_name, is_weekend, is_holiday, week_of_year, total_trips, total_passengers, total_fare_revenue, total_tip_revenue, total_revenue, avg_trip_revenue, avg_tip_percentage, credit_card_trips, cash_trips, avg_trip_distance, avg_trip_duration_min, cumulative_revenue, revenue_change_vs_prior_day
    from (
        /*
    Analytics mart: Daily revenue metrics with running totals.
*/

with daily as (
    select * from "de_pipeline"."main_intermediate"."int_daily_summary"
),

dates as (
    select * from "de_pipeline"."main_marts"."dim_dates"
),

final as (
    select
        d.date_key,
        d.day_of_week_name,
        d.is_weekend,
        d.is_holiday,
        d.week_of_year,

        daily.total_trips,
        daily.total_passengers,
        daily.total_fare_revenue,
        daily.total_tip_revenue,
        daily.total_revenue,
        daily.avg_trip_revenue,
        daily.avg_tip_percentage,
        daily.credit_card_trips,
        daily.cash_trips,
        daily.avg_trip_distance,
        daily.avg_trip_duration_min,

        -- running total
        sum(daily.total_revenue) over (order by d.date_key) as cumulative_revenue,

        -- day-over-day change
        daily.total_revenue - lag(daily.total_revenue) over (order by d.date_key) as revenue_change_vs_prior_day

    from daily
    inner join dates d
        on daily.pickup_date = d.date_key
)

select * from final
    ) as model_subq
    );
  
  
[0m13:54:22.994837 [debug] [Thread-2 (]: Began executing node model.de_pipeline.fct_trips
[0m13:54:23.012086 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.fct_trips"
[0m13:54:23.012456 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m13:54:23.012706 [debug] [Thread-3 (]: SQL status: OK in 0.019 seconds
[0m13:54:23.012923 [debug] [Thread-2 (]: On model.de_pipeline.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.fct_trips"} */
DESCRIBE (select * from (
        /*
    Fact table: Fully enriched trip records with location names.
    Incremental with delete+insert strategy.
*/



with trip_metrics as (
    select * from "de_pipeline"."main_intermediate"."int_trip_metrics"
),

pickup_locations as (
    select * from "de_pipeline"."main_marts"."dim_locations"
),

dropoff_locations as (
    select * from "de_pipeline"."main_marts"."dim_locations"
),

final as (
    select
        t.trip_id,
        t.vendor_id,
        t.rate_code_id,
        t.payment_type_id,
        t.pickup_location_id,
        t.dropoff_location_id,
        t.pickup_datetime,
        t.dropoff_datetime,
        t.pickup_date,
        t.pickup_hour,
        t.pickup_day_of_week,
        t.is_weekend,
        t.passenger_count,
        t.trip_distance_miles,
        t.trip_duration_minutes,
        t.avg_speed_mph,
        t.cost_per_mile,
        t.fare_amount,
        t.extra_amount,
        t.mta_tax,
        t.tip_amount,
        t.tip_percentage,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.congestion_surcharge,
        t.airport_fee,

        -- enriched from dimensions
        pu.borough as pickup_borough,
        pu.zone_name as pickup_zone,
        do_loc.borough as dropoff_borough,
        do_loc.zone_name as dropoff_zone

    from trip_metrics t
    left join pickup_locations pu
        on t.pickup_location_id = pu.location_id
    left join dropoff_locations do_loc
        on t.dropoff_location_id = do_loc.location_id

    
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:54:23.014670 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.mart_daily_revenue"
[0m13:54:23.016297 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.mart_hourly_demand"
[0m13:54:23.016584 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:23.016949 [debug] [Thread-1 (]: On model.de_pipeline.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_daily_revenue"} */
alter table "de_pipeline"."main_marts"."mart_daily_revenue__dbt_tmp" rename to "mart_daily_revenue"
[0m13:54:23.017254 [debug] [Thread-3 (]: On model.de_pipeline.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_hourly_demand"} */
alter table "de_pipeline"."main_marts"."mart_hourly_demand__dbt_tmp" rename to "mart_hourly_demand"
[0m13:54:23.018322 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:23.018679 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:54:23.019455 [debug] [Thread-1 (]: On model.de_pipeline.mart_daily_revenue: COMMIT
[0m13:54:23.020252 [debug] [Thread-3 (]: On model.de_pipeline.mart_hourly_demand: COMMIT
[0m13:54:23.020730 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.mart_daily_revenue"
[0m13:54:23.021184 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.mart_hourly_demand"
[0m13:54:23.021464 [debug] [Thread-1 (]: On model.de_pipeline.mart_daily_revenue: COMMIT
[0m13:54:23.021714 [debug] [Thread-3 (]: On model.de_pipeline.mart_hourly_demand: COMMIT
[0m13:54:23.022192 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m13:54:23.023802 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.fct_trips"
[0m13:54:23.024151 [debug] [Thread-2 (]: On model.de_pipeline.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.fct_trips"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as varchar)
 as trip_id, 
      
    cast(null as integer)
 as vendor_id, 
      
    cast(null as integer)
 as rate_code_id, 
      
    cast(null as integer)
 as payment_type_id, 
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as integer)
 as dropoff_location_id, 
      
    cast(null as timestamp)
 as pickup_datetime, 
      
    cast(null as timestamp)
 as dropoff_datetime, 
      
    cast(null as date)
 as pickup_date, 
      
    cast(null as bigint)
 as pickup_hour, 
      
    cast(null as varchar)
 as pickup_day_of_week, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as integer)
 as passenger_count, 
      
    cast(null as double)
 as trip_distance_miles, 
      
    cast(null as bigint)
 as trip_duration_minutes, 
      
    cast(null as double)
 as avg_speed_mph, 
      
    cast(null as double)
 as cost_per_mile, 
      
    cast(null as decimal(10,2))
 as fare_amount, 
      
    cast(null as decimal(10,2))
 as extra_amount, 
      
    cast(null as decimal(10,2))
 as mta_tax, 
      
    cast(null as decimal(10,2))
 as tip_amount, 
      
    cast(null as double)
 as tip_percentage, 
      
    cast(null as decimal(10,2))
 as tolls_amount, 
      
    cast(null as decimal(10,2))
 as improvement_surcharge, 
      
    cast(null as decimal(10,2))
 as total_amount, 
      
    cast(null as decimal(10,2))
 as congestion_surcharge, 
      
    cast(null as decimal(10,2))
 as airport_fee, 
      
    cast(null as varchar)
 as pickup_borough, 
      
    cast(null as varchar)
 as pickup_zone, 
      
    cast(null as varchar)
 as dropoff_borough, 
      
    cast(null as varchar)
 as dropoff_zone
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:54:23.024583 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:23.024857 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:54:23.026079 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.mart_daily_revenue"
[0m13:54:23.028234 [debug] [Thread-2 (]: Writing runtime sql for node "model.de_pipeline.fct_trips"
[0m13:54:23.028427 [debug] [Thread-1 (]: On model.de_pipeline.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_daily_revenue"} */

      drop table if exists "de_pipeline"."main_marts"."mart_daily_revenue__dbt_backup" cascade
    
[0m13:54:23.028657 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m13:54:23.029192 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:23.030374 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.mart_hourly_demand"
[0m13:54:23.031313 [debug] [Thread-1 (]: On model.de_pipeline.mart_daily_revenue: Close
[0m13:54:23.031658 [debug] [Thread-3 (]: On model.de_pipeline.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_hourly_demand"} */

      drop table if exists "de_pipeline"."main_marts"."mart_hourly_demand__dbt_backup" cascade
    
[0m13:54:23.032133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd29b19d9-f4ff-4134-900c-c096522f9002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756634727ec0>]}
[0m13:54:23.032685 [info ] [Thread-1 (]: 84 of 99 OK created sql table model main_marts.mart_daily_revenue .............. [[32mOK[0m in 0.08s]
[0m13:54:23.033027 [debug] [Thread-1 (]: Finished running node model.de_pipeline.mart_daily_revenue
[0m13:54:23.033222 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:54:23.033654 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a
[0m13:54:23.033873 [debug] [Thread-1 (]: Began running node test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m13:54:23.034536 [debug] [Thread-3 (]: On model.de_pipeline.mart_hourly_demand: Close
[0m13:54:23.034947 [info ] [Thread-4 (]: 87 of 99 START test not_null_mart_daily_revenue_date_key ....................... [RUN]
[0m13:54:23.035442 [info ] [Thread-1 (]: 88 of 99 START test not_null_mart_daily_revenue_total_revenue .................. [RUN]
[0m13:54:23.035952 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd29b19d9-f4ff-4134-900c-c096522f9002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756566769b80>]}
[0m13:54:23.036203 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.unique_dim_locations_location_id.09f471618d, now test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a)
[0m13:54:23.036451 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.fct_trips"
[0m13:54:23.036651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_pipeline.mart_daily_revenue, now test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9)
[0m13:54:23.037103 [info ] [Thread-3 (]: 85 of 99 OK created sql table model main_marts.mart_hourly_demand .............. [[32mOK[0m in 0.08s]
[0m13:54:23.037422 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a
[0m13:54:23.037698 [debug] [Thread-2 (]: On model.de_pipeline.fct_trips: BEGIN
[0m13:54:23.038008 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m13:54:23.038381 [debug] [Thread-3 (]: Finished running node model.de_pipeline.mart_hourly_demand
[0m13:54:23.041623 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m13:54:23.043828 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m13:54:23.044105 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:54:23.044429 [debug] [Thread-3 (]: Began running node test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m13:54:23.045231 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.fct_trips"
[0m13:54:23.045604 [info ] [Thread-3 (]: 89 of 99 START test unique_mart_daily_revenue_date_key ......................... [RUN]
[0m13:54:23.046323 [debug] [Thread-2 (]: On model.de_pipeline.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.fct_trips"} */

  
    
    
      
    

    create  table
      "de_pipeline"."main_marts"."fct_trips"
  
  (
    trip_id varchar,
    vendor_id integer,
    rate_code_id integer,
    payment_type_id integer,
    pickup_location_id integer,
    dropoff_location_id integer,
    pickup_datetime timestamp,
    dropoff_datetime timestamp,
    pickup_date date,
    pickup_hour bigint,
    pickup_day_of_week varchar,
    is_weekend boolean,
    passenger_count integer,
    trip_distance_miles double,
    trip_duration_minutes bigint,
    avg_speed_mph double,
    cost_per_mile double,
    fare_amount decimal(10,2),
    extra_amount decimal(10,2),
    mta_tax decimal(10,2),
    tip_amount decimal(10,2),
    tip_percentage double,
    tolls_amount decimal(10,2),
    improvement_surcharge decimal(10,2),
    total_amount decimal(10,2),
    congestion_surcharge decimal(10,2),
    airport_fee decimal(10,2),
    pickup_borough varchar,
    pickup_zone varchar,
    dropoff_borough varchar,
    dropoff_zone varchar
    
    )
 ;
    insert into "de_pipeline"."main_marts"."fct_trips" 
  (
    
      
      trip_id ,
    
      
      vendor_id ,
    
      
      rate_code_id ,
    
      
      payment_type_id ,
    
      
      pickup_location_id ,
    
      
      dropoff_location_id ,
    
      
      pickup_datetime ,
    
      
      dropoff_datetime ,
    
      
      pickup_date ,
    
      
      pickup_hour ,
    
      
      pickup_day_of_week ,
    
      
      is_weekend ,
    
      
      passenger_count ,
    
      
      trip_distance_miles ,
    
      
      trip_duration_minutes ,
    
      
      avg_speed_mph ,
    
      
      cost_per_mile ,
    
      
      fare_amount ,
    
      
      extra_amount ,
    
      
      mta_tax ,
    
      
      tip_amount ,
    
      
      tip_percentage ,
    
      
      tolls_amount ,
    
      
      improvement_surcharge ,
    
      
      total_amount ,
    
      
      congestion_surcharge ,
    
      
      airport_fee ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      dropoff_borough ,
    
      
      dropoff_zone 
    
  )
 (
      
    select trip_id, vendor_id, rate_code_id, payment_type_id, pickup_location_id, dropoff_location_id, pickup_datetime, dropoff_datetime, pickup_date, pickup_hour, pickup_day_of_week, is_weekend, passenger_count, trip_distance_miles, trip_duration_minutes, avg_speed_mph, cost_per_mile, fare_amount, extra_amount, mta_tax, tip_amount, tip_percentage, tolls_amount, improvement_surcharge, total_amount, congestion_surcharge, airport_fee, pickup_borough, pickup_zone, dropoff_borough, dropoff_zone
    from (
        /*
    Fact table: Fully enriched trip records with location names.
    Incremental with delete+insert strategy.
*/



with trip_metrics as (
    select * from "de_pipeline"."main_intermediate"."int_trip_metrics"
),

pickup_locations as (
    select * from "de_pipeline"."main_marts"."dim_locations"
),

dropoff_locations as (
    select * from "de_pipeline"."main_marts"."dim_locations"
),

final as (
    select
        t.trip_id,
        t.vendor_id,
        t.rate_code_id,
        t.payment_type_id,
        t.pickup_location_id,
        t.dropoff_location_id,
        t.pickup_datetime,
        t.dropoff_datetime,
        t.pickup_date,
        t.pickup_hour,
        t.pickup_day_of_week,
        t.is_weekend,
        t.passenger_count,
        t.trip_distance_miles,
        t.trip_duration_minutes,
        t.avg_speed_mph,
        t.cost_per_mile,
        t.fare_amount,
        t.extra_amount,
        t.mta_tax,
        t.tip_amount,
        t.tip_percentage,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.congestion_surcharge,
        t.airport_fee,

        -- enriched from dimensions
        pu.borough as pickup_borough,
        pu.zone_name as pickup_zone,
        do_loc.borough as dropoff_borough,
        do_loc.zone_name as dropoff_zone

    from trip_metrics t
    left join pickup_locations pu
        on t.pickup_location_id = pu.location_id
    left join dropoff_locations do_loc
        on t.dropoff_location_id = do_loc.location_id

    
)

select * from final
    ) as model_subq
    );
  
  
  
[0m13:54:23.046853 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.de_pipeline.mart_hourly_demand, now test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7)
[0m13:54:23.047747 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m13:54:23.050303 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m13:54:23.054812 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a
[0m13:54:23.056534 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m13:54:23.057383 [debug] [Thread-1 (]: Began executing node test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m13:54:23.058844 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m13:54:23.059188 [debug] [Thread-3 (]: Began executing node test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m13:54:23.061292 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m13:54:23.061958 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m13:54:23.063028 [debug] [Thread-2 (]: On model.de_pipeline.fct_trips: COMMIT
[0m13:54:23.063361 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.fct_trips"
[0m13:54:23.063676 [debug] [Thread-2 (]: On model.de_pipeline.fct_trips: COMMIT
[0m13:54:23.065542 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m13:54:23.065890 [debug] [Thread-4 (]: On test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a: BEGIN
[0m13:54:23.066271 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:23.067198 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m13:54:23.067567 [debug] [Thread-3 (]: On test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7: BEGIN
[0m13:54:23.067899 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:23.069055 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:54:23.069474 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m13:54:23.069805 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m13:54:23.070250 [debug] [Thread-1 (]: On test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9: BEGIN
[0m13:54:23.070865 [debug] [Thread-4 (]: On test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "de_pipeline"."main_marts"."mart_daily_revenue"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m13:54:23.071192 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:54:23.071383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:23.071909 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m13:54:23.072418 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:54:23.072752 [debug] [Thread-3 (]: On test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "de_pipeline"."main_marts"."mart_daily_revenue"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:54:23.074215 [debug] [Thread-4 (]: On test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a: ROLLBACK
[0m13:54:23.075333 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:54:23.075693 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:54:23.076171 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a'
[0m13:54:23.076403 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m13:54:23.077528 [debug] [Thread-3 (]: On test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7: ROLLBACK
[0m13:54:23.077720 [debug] [Thread-4 (]: On test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a: Close
[0m13:54:23.078053 [debug] [Thread-1 (]: On test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "de_pipeline"."main_marts"."mart_daily_revenue"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m13:54:23.078696 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7'
[0m13:54:23.079135 [debug] [Thread-3 (]: On test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7: Close
[0m13:54:23.082239 [info ] [Thread-4 (]: 87 of 99 PASS not_null_mart_daily_revenue_date_key ............................. [[32mPASS[0m in 0.05s]
[0m13:54:23.082605 [info ] [Thread-3 (]: 89 of 99 PASS unique_mart_daily_revenue_date_key ............................... [[32mPASS[0m in 0.04s]
[0m13:54:23.082919 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a
[0m13:54:23.083146 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:54:23.083376 [debug] [Thread-2 (]: SQL status: OK in 0.019 seconds
[0m13:54:23.083654 [debug] [Thread-3 (]: Finished running node test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m13:54:23.083992 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m13:54:23.085278 [debug] [Thread-1 (]: On test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9: ROLLBACK
[0m13:54:23.085723 [debug] [Thread-2 (]: On model.de_pipeline.fct_trips: Close
[0m13:54:23.086167 [debug] [Thread-3 (]: Began running node test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m13:54:23.086530 [info ] [Thread-4 (]: 90 of 99 START test not_null_mart_hourly_demand_is_weekend ..................... [RUN]
[0m13:54:23.087329 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9'
[0m13:54:23.087903 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd29b19d9-f4ff-4134-900c-c096522f9002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756655454e90>]}
[0m13:54:23.088116 [info ] [Thread-3 (]: 91 of 99 START test not_null_mart_hourly_demand_pickup_hour .................... [RUN]
[0m13:54:23.088780 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a, now test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8)
[0m13:54:23.089119 [debug] [Thread-1 (]: On test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9: Close
[0m13:54:23.089646 [info ] [Thread-2 (]: 86 of 99 OK created sql incremental model main_marts.fct_trips ................. [[32mOK[0m in 0.10s]
[0m13:54:23.090030 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7, now test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418)
[0m13:54:23.090356 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m13:54:23.090917 [info ] [Thread-1 (]: 88 of 99 PASS not_null_mart_daily_revenue_total_revenue ........................ [[32mPASS[0m in 0.05s]
[0m13:54:23.091265 [debug] [Thread-2 (]: Finished running node model.de_pipeline.fct_trips
[0m13:54:23.091564 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m13:54:23.093950 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m13:54:23.094329 [debug] [Thread-1 (]: Finished running node test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m13:54:23.096551 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m13:54:23.096767 [debug] [Thread-2 (]: Began running node test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83
[0m13:54:23.097275 [debug] [Thread-1 (]: Began running node test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d
[0m13:54:23.097812 [info ] [Thread-2 (]: 92 of 99 START test not_null_fct_trips_pickup_datetime ......................... [RUN]
[0m13:54:23.098131 [info ] [Thread-1 (]: 93 of 99 START test not_null_fct_trips_total_amount ............................ [RUN]
[0m13:54:23.098474 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.de_pipeline.fct_trips, now test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83)
[0m13:54:23.099119 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83
[0m13:54:23.098819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9, now test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d)
[0m13:54:23.102230 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m13:54:23.102611 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d
[0m13:54:23.103251 [debug] [Thread-3 (]: Began executing node test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m13:54:23.105277 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d"
[0m13:54:23.105588 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m13:54:23.107512 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m13:54:23.109143 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m13:54:23.110002 [debug] [Thread-2 (]: Began executing node test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83
[0m13:54:23.111546 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m13:54:23.111828 [debug] [Thread-1 (]: Began executing node test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d
[0m13:54:23.113181 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d"
[0m13:54:23.116203 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m13:54:23.116661 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d"
[0m13:54:23.116976 [debug] [Thread-4 (]: On test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8: BEGIN
[0m13:54:23.117496 [debug] [Thread-1 (]: On test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d: BEGIN
[0m13:54:23.117960 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:23.118248 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m13:54:23.118487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:23.118800 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m13:54:23.119386 [debug] [Thread-3 (]: On test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: BEGIN
[0m13:54:23.120023 [debug] [Thread-2 (]: On test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83: BEGIN
[0m13:54:23.120461 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:23.121005 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:23.121542 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m13:54:23.122035 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m13:54:23.122343 [debug] [Thread-4 (]: On test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "de_pipeline"."main_marts"."mart_hourly_demand"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m13:54:23.123054 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:54:23.123286 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:54:23.123526 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d"
[0m13:54:23.124710 [debug] [Thread-4 (]: On test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8: ROLLBACK
[0m13:54:23.124938 [debug] [Thread-1 (]: On test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "de_pipeline"."main_marts"."fct_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m13:54:23.125641 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m13:54:23.126079 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8'
[0m13:54:23.126576 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m13:54:23.126881 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:23.127058 [debug] [Thread-4 (]: On test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8: Close
[0m13:54:23.127375 [debug] [Thread-3 (]: On test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "de_pipeline"."main_marts"."mart_hourly_demand"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m13:54:23.127763 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m13:54:23.128507 [debug] [Thread-1 (]: On test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d: ROLLBACK
[0m13:54:23.129052 [info ] [Thread-4 (]: 90 of 99 PASS not_null_mart_hourly_demand_is_weekend ........................... [[32mPASS[0m in 0.04s]
[0m13:54:23.129576 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m13:54:23.129850 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:54:23.130337 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d'
[0m13:54:23.130790 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m13:54:23.131097 [debug] [Thread-2 (]: On test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "de_pipeline"."main_marts"."fct_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m13:54:23.132015 [debug] [Thread-3 (]: On test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: ROLLBACK
[0m13:54:23.132243 [debug] [Thread-1 (]: On test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d: Close
[0m13:54:23.132569 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d
[0m13:54:23.133198 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418'
[0m13:54:23.133435 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:54:23.133822 [info ] [Thread-1 (]: 93 of 99 PASS not_null_fct_trips_total_amount .................................. [[32mPASS[0m in 0.03s]
[0m13:54:23.134029 [info ] [Thread-4 (]: 94 of 99 START test not_null_fct_trips_trip_id ................................. [RUN]
[0m13:54:23.134386 [debug] [Thread-3 (]: On test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: Close
[0m13:54:23.135501 [debug] [Thread-2 (]: On test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83: ROLLBACK
[0m13:54:23.135846 [debug] [Thread-1 (]: Finished running node test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d
[0m13:54:23.136263 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8, now test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d)
[0m13:54:23.136817 [info ] [Thread-3 (]: 91 of 99 PASS not_null_mart_hourly_demand_pickup_hour .......................... [[32mPASS[0m in 0.05s]
[0m13:54:23.137385 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83'
[0m13:54:23.137640 [debug] [Thread-1 (]: Began running node test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab
[0m13:54:23.137983 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d
[0m13:54:23.138413 [debug] [Thread-3 (]: Finished running node test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m13:54:23.138740 [debug] [Thread-2 (]: On test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83: Close
[0m13:54:23.139066 [info ] [Thread-1 (]: 95 of 99 START test unique_fct_trips_trip_id ................................... [RUN]
[0m13:54:23.141478 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d"
[0m13:54:23.142248 [info ] [Thread-2 (]: 92 of 99 PASS not_null_fct_trips_pickup_datetime ............................... [[32mPASS[0m in 0.04s]
[0m13:54:23.142511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d, now test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab)
[0m13:54:23.143239 [debug] [Thread-2 (]: Finished running node test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83
[0m13:54:23.143527 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab
[0m13:54:23.145873 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab"
[0m13:54:23.149156 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d
[0m13:54:23.150676 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d"
[0m13:54:23.152029 [debug] [Thread-1 (]: Began executing node test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab
[0m13:54:23.153309 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab"
[0m13:54:23.156785 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d"
[0m13:54:23.157099 [debug] [Thread-4 (]: On test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d: BEGIN
[0m13:54:23.157454 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:23.158143 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab"
[0m13:54:23.158463 [debug] [Thread-1 (]: On test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab: BEGIN
[0m13:54:23.158746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:23.159358 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:54:23.159671 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d"
[0m13:54:23.159962 [debug] [Thread-4 (]: On test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "de_pipeline"."main_marts"."fct_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m13:54:23.160607 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:54:23.160872 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:54:23.162258 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab"
[0m13:54:23.163380 [debug] [Thread-4 (]: On test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d: ROLLBACK
[0m13:54:23.163635 [debug] [Thread-1 (]: On test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "de_pipeline"."main_marts"."fct_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:54:23.164277 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d'
[0m13:54:23.164762 [debug] [Thread-4 (]: On test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d: Close
[0m13:54:23.165322 [info ] [Thread-4 (]: 94 of 99 PASS not_null_fct_trips_trip_id ....................................... [[32mPASS[0m in 0.03s]
[0m13:54:23.165759 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d
[0m13:54:23.166701 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:54:23.167876 [debug] [Thread-1 (]: On test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab: ROLLBACK
[0m13:54:23.168610 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab'
[0m13:54:23.169141 [debug] [Thread-1 (]: On test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab: Close
[0m13:54:23.169815 [info ] [Thread-1 (]: 95 of 99 PASS unique_fct_trips_trip_id ......................................... [[32mPASS[0m in 0.03s]
[0m13:54:23.170498 [debug] [Thread-1 (]: Finished running node test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab
[0m13:54:23.171353 [debug] [Thread-3 (]: Began running node model.de_pipeline.mart_location_performance
[0m13:54:23.171868 [info ] [Thread-3 (]: 96 of 99 START sql table model main_marts.mart_location_performance ............ [RUN]
[0m13:54:23.172363 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418, now model.de_pipeline.mart_location_performance)
[0m13:54:23.172888 [debug] [Thread-3 (]: Began compiling node model.de_pipeline.mart_location_performance
[0m13:54:23.175654 [debug] [Thread-3 (]: Writing injected SQL for node "model.de_pipeline.mart_location_performance"
[0m13:54:23.183785 [debug] [Thread-3 (]: Began executing node model.de_pipeline.mart_location_performance
[0m13:54:23.186352 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.mart_location_performance"
[0m13:54:23.186776 [debug] [Thread-3 (]: On model.de_pipeline.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_location_performance"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Location-level performance summary.
    Uses adapter-dispatched mode_compat() for cross-dialect support.
*/

with trips as (
    select * from "de_pipeline"."main_marts"."fct_trips"
),

final as (
    select
        pickup_location_id,
        pickup_borough,
        pickup_zone,

        count(*) as total_pickups,
        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue_per_trip,
        round(avg(tip_percentage), 2) as avg_tip_pct,
        round(avg(passenger_count), 2) as avg_passengers,

        -- most common dropoff destination
        
    mode() within group (order by dropoff_zone)
 as most_common_dropoff_zone,

        -- busiest hour
        
    mode() within group (order by pickup_hour)
 as peak_pickup_hour

    from trips
    where pickup_zone is not null
    group by pickup_location_id, pickup_borough, pickup_zone
)

select * from final
order by total_pickups desc
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:54:23.187229 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:23.190566 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:54:23.192166 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.mart_location_performance"
[0m13:54:23.192557 [debug] [Thread-3 (]: On model.de_pipeline.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_location_performance"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as varchar)
 as pickup_borough, 
      
    cast(null as varchar)
 as pickup_zone, 
      
    cast(null as bigint)
 as total_pickups, 
      
    cast(null as double)
 as avg_trip_distance, 
      
    cast(null as double)
 as avg_trip_duration_min, 
      
    cast(null as decimal(38,2))
 as total_revenue, 
      
    cast(null as double)
 as avg_revenue_per_trip, 
      
    cast(null as double)
 as avg_tip_pct, 
      
    cast(null as double)
 as avg_passengers, 
      
    cast(null as varchar)
 as most_common_dropoff_zone, 
      
    cast(null as bigint)
 as peak_pickup_hour
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:54:23.193237 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:54:23.194620 [debug] [Thread-3 (]: Writing runtime sql for node "model.de_pipeline.mart_location_performance"
[0m13:54:23.201317 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.mart_location_performance"
[0m13:54:23.201663 [debug] [Thread-3 (]: On model.de_pipeline.mart_location_performance: BEGIN
[0m13:54:23.202748 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:54:23.203072 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.mart_location_performance"
[0m13:54:23.203394 [debug] [Thread-3 (]: On model.de_pipeline.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_location_performance"} */

  
    
    
      
    

    create  table
      "de_pipeline"."main_marts"."mart_location_performance__dbt_tmp"
  
  (
    pickup_location_id integer,
    pickup_borough varchar,
    pickup_zone varchar,
    total_pickups bigint,
    avg_trip_distance double,
    avg_trip_duration_min double,
    total_revenue decimal(38,2),
    avg_revenue_per_trip double,
    avg_tip_pct double,
    avg_passengers double,
    most_common_dropoff_zone varchar,
    peak_pickup_hour bigint
    
    )
 ;
    insert into "de_pipeline"."main_marts"."mart_location_performance__dbt_tmp" 
  (
    
      
      pickup_location_id ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      total_pickups ,
    
      
      avg_trip_distance ,
    
      
      avg_trip_duration_min ,
    
      
      total_revenue ,
    
      
      avg_revenue_per_trip ,
    
      
      avg_tip_pct ,
    
      
      avg_passengers ,
    
      
      most_common_dropoff_zone ,
    
      
      peak_pickup_hour 
    
  )
 (
      
    select pickup_location_id, pickup_borough, pickup_zone, total_pickups, avg_trip_distance, avg_trip_duration_min, total_revenue, avg_revenue_per_trip, avg_tip_pct, avg_passengers, most_common_dropoff_zone, peak_pickup_hour
    from (
        /*
    Analytics mart: Location-level performance summary.
    Uses adapter-dispatched mode_compat() for cross-dialect support.
*/

with trips as (
    select * from "de_pipeline"."main_marts"."fct_trips"
),

final as (
    select
        pickup_location_id,
        pickup_borough,
        pickup_zone,

        count(*) as total_pickups,
        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue_per_trip,
        round(avg(tip_percentage), 2) as avg_tip_pct,
        round(avg(passenger_count), 2) as avg_passengers,

        -- most common dropoff destination
        
    mode() within group (order by dropoff_zone)
 as most_common_dropoff_zone,

        -- busiest hour
        
    mode() within group (order by pickup_hour)
 as peak_pickup_hour

    from trips
    where pickup_zone is not null
    group by pickup_location_id, pickup_borough, pickup_zone
)

select * from final
order by total_pickups desc
    ) as model_subq
    );
  
  
[0m13:54:23.209166 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m13:54:23.211565 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.mart_location_performance"
[0m13:54:23.211970 [debug] [Thread-3 (]: On model.de_pipeline.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_location_performance"} */
alter table "de_pipeline"."main_marts"."mart_location_performance__dbt_tmp" rename to "mart_location_performance"
[0m13:54:23.212670 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:54:23.213483 [debug] [Thread-3 (]: On model.de_pipeline.mart_location_performance: COMMIT
[0m13:54:23.213732 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.mart_location_performance"
[0m13:54:23.213995 [debug] [Thread-3 (]: On model.de_pipeline.mart_location_performance: COMMIT
[0m13:54:23.217978 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m13:54:23.219359 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.mart_location_performance"
[0m13:54:23.219700 [debug] [Thread-3 (]: On model.de_pipeline.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_location_performance"} */

      drop table if exists "de_pipeline"."main_marts"."mart_location_performance__dbt_backup" cascade
    
[0m13:54:23.220158 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:54:23.221054 [debug] [Thread-3 (]: On model.de_pipeline.mart_location_performance: Close
[0m13:54:23.221506 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd29b19d9-f4ff-4134-900c-c096522f9002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75663ef54f50>]}
[0m13:54:23.221918 [info ] [Thread-3 (]: 96 of 99 OK created sql table model main_marts.mart_location_performance ....... [[32mOK[0m in 0.05s]
[0m13:54:23.222338 [debug] [Thread-3 (]: Finished running node model.de_pipeline.mart_location_performance
[0m13:54:23.223040 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m13:54:23.223268 [debug] [Thread-1 (]: Began running node test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m13:54:23.223456 [debug] [Thread-2 (]: Began running node test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m13:54:23.223638 [info ] [Thread-4 (]: 97 of 99 START test not_null_mart_location_performance_pickup_location_id ...... [RUN]
[0m13:54:23.224417 [info ] [Thread-1 (]: 98 of 99 START test not_null_mart_location_performance_total_pickups ........... [RUN]
[0m13:54:23.224836 [info ] [Thread-2 (]: 99 of 99 START test unique_mart_location_performance_pickup_location_id ........ [RUN]
[0m13:54:23.225369 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d, now test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c)
[0m13:54:23.225861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab, now test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259)
[0m13:54:23.226317 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83, now test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62)
[0m13:54:23.226666 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m13:54:23.226973 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m13:54:23.227791 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m13:54:23.230161 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m13:54:23.232167 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m13:54:23.234216 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m13:54:23.238383 [debug] [Thread-2 (]: Began executing node test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m13:54:23.240793 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m13:54:23.241774 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m13:54:23.243023 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m13:54:23.243227 [debug] [Thread-1 (]: Began executing node test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m13:54:23.244424 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m13:54:23.245748 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m13:54:23.246083 [debug] [Thread-2 (]: On test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62: BEGIN
[0m13:54:23.246427 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:23.247254 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m13:54:23.247669 [debug] [Thread-4 (]: On test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c: BEGIN
[0m13:54:23.248217 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:23.249267 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:54:23.249561 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m13:54:23.249816 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m13:54:23.250122 [debug] [Thread-1 (]: On test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259: BEGIN
[0m13:54:23.250518 [debug] [Thread-2 (]: On test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pickup_location_id as unique_field,
    count(*) as n_records

from "de_pipeline"."main_marts"."mart_location_performance"
where pickup_location_id is not null
group by pickup_location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:54:23.250897 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:54:23.251073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:23.251550 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m13:54:23.252040 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:54:23.252306 [debug] [Thread-4 (]: On test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_location_id
from "de_pipeline"."main_marts"."mart_location_performance"
where pickup_location_id is null



  
  
      
    ) dbt_internal_test
[0m13:54:23.253477 [debug] [Thread-2 (]: On test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62: ROLLBACK
[0m13:54:23.254162 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:54:23.254416 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:54:23.254951 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62'
[0m13:54:23.255165 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m13:54:23.256235 [debug] [Thread-4 (]: On test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c: ROLLBACK
[0m13:54:23.256434 [debug] [Thread-2 (]: On test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62: Close
[0m13:54:23.256776 [debug] [Thread-1 (]: On test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_pickups
from "de_pipeline"."main_marts"."mart_location_performance"
where total_pickups is null



  
  
      
    ) dbt_internal_test
[0m13:54:23.257331 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c'
[0m13:54:23.257784 [info ] [Thread-2 (]: 99 of 99 PASS unique_mart_location_performance_pickup_location_id .............. [[32mPASS[0m in 0.03s]
[0m13:54:23.258305 [debug] [Thread-4 (]: On test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c: Close
[0m13:54:23.258524 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:23.258790 [debug] [Thread-2 (]: Finished running node test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m13:54:23.259179 [info ] [Thread-4 (]: 97 of 99 PASS not_null_mart_location_performance_pickup_location_id ............ [[32mPASS[0m in 0.03s]
[0m13:54:23.259952 [debug] [Thread-1 (]: On test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259: ROLLBACK
[0m13:54:23.260466 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m13:54:23.260948 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259'
[0m13:54:23.261365 [debug] [Thread-1 (]: On test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259: Close
[0m13:54:23.261736 [info ] [Thread-1 (]: 98 of 99 PASS not_null_mart_location_performance_total_pickups ................. [[32mPASS[0m in 0.04s]
[0m13:54:23.262111 [debug] [Thread-1 (]: Finished running node test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m13:54:23.263263 [debug] [MainThread]: Using duckdb connection "master"
[0m13:54:23.263545 [debug] [MainThread]: On master: BEGIN
[0m13:54:23.263772 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:54:23.264754 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:54:23.265023 [debug] [MainThread]: On master: COMMIT
[0m13:54:23.265299 [debug] [MainThread]: Using duckdb connection "master"
[0m13:54:23.265528 [debug] [MainThread]: On master: COMMIT
[0m13:54:23.265988 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:54:23.266257 [debug] [MainThread]: On master: Close
[0m13:54:23.266656 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:23.267027 [debug] [MainThread]: Connection 'test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62' was properly closed.
[0m13:54:23.267250 [debug] [MainThread]: Connection 'test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259' was properly closed.
[0m13:54:23.267468 [debug] [MainThread]: Connection 'test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c' was properly closed.
[0m13:54:23.267679 [debug] [MainThread]: Connection 'model.de_pipeline.mart_location_performance' was properly closed.
[0m13:54:23.268073 [info ] [MainThread]: 
[0m13:54:23.268355 [info ] [MainThread]: Finished running 1 incremental model, 4 seeds, 8 table models, 79 data tests, 7 view models in 0 hours 0 minutes and 5.50 seconds (5.50s).
[0m13:54:23.273034 [debug] [MainThread]: Command end result
[0m13:54:23.310985 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:54:23.315963 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:54:23.325177 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:54:23.325574 [info ] [MainThread]: 
[0m13:54:23.325989 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:54:23.326373 [info ] [MainThread]: 
[0m13:54:23.326699 [info ] [MainThread]: Done. PASS=99 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=99
[0m13:54:23.327519 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 7.5905766, "process_in_blocks": "152", "process_kernel_time": 0.834685, "process_mem_max_rss": "287140", "process_out_blocks": "245472", "process_user_time": 4.75813}
[0m13:54:23.327906 [debug] [MainThread]: Command `dbt build` succeeded at 13:54:23.327815 after 7.59 seconds
[0m13:54:23.328301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7566a40f63f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7566a48a0920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7566a40a80b0>]}
[0m13:54:23.328609 [debug] [MainThread]: Flushing usage events
[0m13:54:23.548753 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:53:04.958510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be1e6d13d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be1e90bd100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be1e72a7ce0>]}


============================== 15:53:04.965594 | 74104285-8652-416f-b62c-d317068128b6 ==============================
[0m15:53:04.965594 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:53:04.966028 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt deps --profiles-dir .', 'log_path': '/dbt/logs', 'quiet': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'no_print': 'None', 'target_path': 'None', 'partial_parse': 'True', 'profiles_dir': '.', 'fail_fast': 'False', 'printer_width': '80', 'introspect': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'empty': 'None', 'debug': 'False', 'use_colors': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'write_json': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True'}
[0m15:53:05.038753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74104285-8652-416f-b62c-d317068128b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be1e61602f0>]}
[0m15:53:06.152306 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-4zh_zmbt'
[0m15:53:06.152766 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:53:08.960941 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:53:08.962572 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:53:09.060281 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:53:09.063438 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:53:12.589039 [info ] [MainThread]: Installed from version 1.3.3
[0m15:53:12.589551 [info ] [MainThread]: Up to date!
[0m15:53:12.590066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '74104285-8652-416f-b62c-d317068128b6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be1e6062030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be1e6062ff0>]}
[0m15:53:12.592041 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.3787293, "process_in_blocks": "4296", "process_kernel_time": 0.824427, "process_mem_max_rss": "107108", "process_out_blocks": "3400", "process_user_time": 1.517297}
[0m15:53:12.592547 [debug] [MainThread]: Command `dbt deps` succeeded at 15:53:12.592469 after 4.38 seconds
[0m15:53:12.592940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be1e6430470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be1e644b830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be1e625b980>]}
[0m15:53:12.593384 [debug] [MainThread]: Flushing usage events
[0m15:53:12.900984 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:53:13.861890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acae86064e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acae829e3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acae86059a0>]}


============================== 15:53:13.864581 | e112fb35-b2dd-4364-a6cd-45ba3ff28547 ==============================
[0m15:53:13.864581 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:53:13.865003 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_path': '/dbt/logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt build --full-refresh --profiles-dir .', 'introspect': 'True', 'quiet': 'False', 'use_colors': 'True', 'printer_width': '80', 'profiles_dir': '.', 'static_parser': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'debug': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'partial_parse': 'True', 'target_path': 'None', 'no_print': 'None'}
[0m15:53:14.000474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e112fb35-b2dd-4364-a6cd-45ba3ff28547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acae7eec7a0>]}
[0m15:53:14.189730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e112fb35-b2dd-4364-a6cd-45ba3ff28547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acae9dc8cb0>]}
[0m15:53:14.192800 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m15:53:14.268909 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:53:15.108297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:53:15.108780 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:53:15.109060 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:53:15.140870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e112fb35-b2dd-4364-a6cd-45ba3ff28547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acae7cfe030>]}
[0m15:53:15.242388 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m15:53:15.254202 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m15:53:15.347515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e112fb35-b2dd-4364-a6cd-45ba3ff28547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acad7ecc3e0>]}
[0m15:53:15.348041 [info ] [MainThread]: Found 16 models, 79 data tests, 4 seeds, 1 source, 607 macros
[0m15:53:15.352055 [info ] [MainThread]: 
[0m15:53:15.352508 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:53:15.352831 [info ] [MainThread]: 
[0m15:53:15.353319 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:53:15.356886 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_de_pipeline'
[0m15:53:15.365631 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_de_pipeline'
[0m15:53:15.368912 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_de_pipeline'
[0m15:53:15.370385 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_de_pipeline'
[0m15:53:15.419047 [debug] [ThreadPool]: Using duckdb connection "list_de_pipeline"
[0m15:53:15.420205 [debug] [ThreadPool]: Using duckdb connection "list_de_pipeline"
[0m15:53:15.421829 [debug] [ThreadPool]: On list_de_pipeline: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "list_de_pipeline"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"de_pipeline"'
    
  
  
[0m15:53:15.422059 [debug] [ThreadPool]: Using duckdb connection "list_de_pipeline"
[0m15:53:15.422810 [debug] [ThreadPool]: Using duckdb connection "list_de_pipeline"
[0m15:53:15.423076 [debug] [ThreadPool]: On list_de_pipeline: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "list_de_pipeline"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"de_pipeline"'
    
  
  
[0m15:53:15.423599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:15.424047 [debug] [ThreadPool]: On list_de_pipeline: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "list_de_pipeline"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"de_pipeline"'
    
  
  
[0m15:53:15.424490 [debug] [ThreadPool]: On list_de_pipeline: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "list_de_pipeline"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"de_pipeline"'
    
  
  
[0m15:53:15.424800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:15.426279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:15.427966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:19.330121 [debug] [ThreadPool]: SQL status: OK in 3.905 seconds
[0m15:53:19.331285 [debug] [ThreadPool]: SQL status: OK in 3.907 seconds
[0m15:53:19.333727 [debug] [ThreadPool]: On list_de_pipeline: Close
[0m15:53:19.334754 [debug] [ThreadPool]: On list_de_pipeline: Close
[0m15:53:19.335959 [debug] [ThreadPool]: SQL status: OK in 3.910 seconds
[0m15:53:19.337753 [debug] [ThreadPool]: On list_de_pipeline: Close
[0m15:53:19.338857 [debug] [ThreadPool]: SQL status: OK in 3.911 seconds
[0m15:53:19.339774 [debug] [ThreadPool]: On list_de_pipeline: Close
[0m15:53:19.340453 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de_pipeline, now create_de_pipeline_main_intermediate)
[0m15:53:19.340762 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de_pipeline, now create_de_pipeline_main_raw)
[0m15:53:19.341058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de_pipeline, now create_de_pipeline_main_marts)
[0m15:53:19.341358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de_pipeline, now create_de_pipeline_main_staging)
[0m15:53:19.342061 [debug] [ThreadPool]: Creating schema "database: "de_pipeline"
schema: "main_intermediate"
"
[0m15:53:19.343507 [debug] [ThreadPool]: Creating schema "database: "de_pipeline"
schema: "main_raw"
"
[0m15:53:19.343960 [debug] [ThreadPool]: Creating schema "database: "de_pipeline"
schema: "main_marts"
"
[0m15:53:19.344593 [debug] [ThreadPool]: Creating schema "database: "de_pipeline"
schema: "main_staging"
"
[0m15:53:19.361562 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_intermediate"
[0m15:53:19.361976 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_raw"
[0m15:53:19.363262 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_marts"
[0m15:53:19.364977 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_staging"
[0m15:53:19.365425 [debug] [ThreadPool]: On create_de_pipeline_main_intermediate: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "create_de_pipeline_main_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='de_pipeline'
        and type='sqlite'
    
  
[0m15:53:19.365829 [debug] [ThreadPool]: On create_de_pipeline_main_raw: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "create_de_pipeline_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='de_pipeline'
        and type='sqlite'
    
  
[0m15:53:19.366220 [debug] [ThreadPool]: On create_de_pipeline_main_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "create_de_pipeline_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='de_pipeline'
        and type='sqlite'
    
  
[0m15:53:19.367854 [debug] [ThreadPool]: On create_de_pipeline_main_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "create_de_pipeline_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='de_pipeline'
        and type='sqlite'
    
  
[0m15:53:19.369402 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:53:19.369770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:53:19.370141 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:53:19.370543 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:53:19.373412 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m15:53:19.374672 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_intermediate"
[0m15:53:19.374968 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m15:53:19.375313 [debug] [ThreadPool]: On create_de_pipeline_main_intermediate: BEGIN
[0m15:53:19.376370 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_raw"
[0m15:53:19.377150 [debug] [ThreadPool]: On create_de_pipeline_main_raw: BEGIN
[0m15:53:19.376940 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:53:19.377653 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:53:19.377904 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_intermediate"
[0m15:53:19.378549 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_raw"
[0m15:53:19.378934 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m15:53:19.379182 [debug] [ThreadPool]: On create_de_pipeline_main_intermediate: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "create_de_pipeline_main_intermediate"} */

    
    
        create schema if not exists "de_pipeline"."main_intermediate"
    
[0m15:53:19.379517 [debug] [ThreadPool]: On create_de_pipeline_main_raw: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "create_de_pipeline_main_raw"} */

    
    
        create schema if not exists "de_pipeline"."main_raw"
    
[0m15:53:19.380430 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_marts"
[0m15:53:19.382021 [debug] [ThreadPool]: On create_de_pipeline_main_marts: BEGIN
[0m15:53:19.382251 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:53:19.382505 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:53:19.382926 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:53:19.383468 [debug] [ThreadPool]: On create_de_pipeline_main_intermediate: COMMIT
[0m15:53:19.384314 [debug] [ThreadPool]: On create_de_pipeline_main_raw: COMMIT
[0m15:53:19.384625 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m15:53:19.385213 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_marts"
[0m15:53:19.386352 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_intermediate"
[0m15:53:19.386751 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_raw"
[0m15:53:19.387985 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_staging"
[0m15:53:19.388347 [debug] [ThreadPool]: On create_de_pipeline_main_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "create_de_pipeline_main_marts"} */

    
    
        create schema if not exists "de_pipeline"."main_marts"
    
[0m15:53:19.388745 [debug] [ThreadPool]: On create_de_pipeline_main_intermediate: COMMIT
[0m15:53:19.389126 [debug] [ThreadPool]: On create_de_pipeline_main_raw: COMMIT
[0m15:53:19.389459 [debug] [ThreadPool]: On create_de_pipeline_main_staging: BEGIN
[0m15:53:19.390200 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:53:19.390540 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:53:19.390828 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:53:19.391138 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:53:19.391754 [debug] [ThreadPool]: On create_de_pipeline_main_marts: COMMIT
[0m15:53:19.392141 [debug] [ThreadPool]: On create_de_pipeline_main_intermediate: Close
[0m15:53:19.392539 [debug] [ThreadPool]: On create_de_pipeline_main_raw: Close
[0m15:53:19.392985 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_staging"
[0m15:53:19.393366 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_marts"
[0m15:53:19.394325 [debug] [ThreadPool]: On create_de_pipeline_main_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "create_de_pipeline_main_staging"} */

    
    
        create schema if not exists "de_pipeline"."main_staging"
    
[0m15:53:19.394740 [debug] [ThreadPool]: On create_de_pipeline_main_marts: COMMIT
[0m15:53:19.395635 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:53:19.395866 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:53:19.396118 [debug] [ThreadPool]: On create_de_pipeline_main_marts: Close
[0m15:53:19.396833 [debug] [ThreadPool]: On create_de_pipeline_main_staging: COMMIT
[0m15:53:19.397563 [debug] [ThreadPool]: Using duckdb connection "create_de_pipeline_main_staging"
[0m15:53:19.397908 [debug] [ThreadPool]: On create_de_pipeline_main_staging: COMMIT
[0m15:53:19.398528 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:53:19.398941 [debug] [ThreadPool]: On create_de_pipeline_main_staging: Close
[0m15:53:19.401575 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_de_pipeline_main_raw, now list_de_pipeline_main_intermediate)
[0m15:53:19.402109 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_de_pipeline_main_staging, now list_de_pipeline_main_raw)
[0m15:53:19.406451 [debug] [ThreadPool]: Using duckdb connection "list_de_pipeline_main_intermediate"
[0m15:53:19.406924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_de_pipeline_main_marts, now list_de_pipeline_main_marts)
[0m15:53:19.407548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_de_pipeline_main_intermediate, now list_de_pipeline_main_staging)
[0m15:53:19.409172 [debug] [ThreadPool]: Using duckdb connection "list_de_pipeline_main_raw"
[0m15:53:19.409759 [debug] [ThreadPool]: On list_de_pipeline_main_intermediate: BEGIN
[0m15:53:19.411245 [debug] [ThreadPool]: Using duckdb connection "list_de_pipeline_main_marts"
[0m15:53:19.413205 [debug] [ThreadPool]: Using duckdb connection "list_de_pipeline_main_staging"
[0m15:53:19.413625 [debug] [ThreadPool]: On list_de_pipeline_main_raw: BEGIN
[0m15:53:19.413975 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:53:19.414434 [debug] [ThreadPool]: On list_de_pipeline_main_marts: BEGIN
[0m15:53:19.414849 [debug] [ThreadPool]: On list_de_pipeline_main_staging: BEGIN
[0m15:53:19.415189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:53:19.416059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:53:19.416512 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:53:19.417595 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m15:53:19.417999 [debug] [ThreadPool]: Using duckdb connection "list_de_pipeline_main_intermediate"
[0m15:53:19.418384 [debug] [ThreadPool]: On list_de_pipeline_main_intermediate: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "list_de_pipeline_main_intermediate"} */
select
      'de_pipeline' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_intermediate'
    and lower(table_catalog) = 'de_pipeline'
  
[0m15:53:19.419448 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m15:53:19.419828 [debug] [ThreadPool]: Using duckdb connection "list_de_pipeline_main_raw"
[0m15:53:19.420169 [debug] [ThreadPool]: On list_de_pipeline_main_raw: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "list_de_pipeline_main_raw"} */
select
      'de_pipeline' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'de_pipeline'
  
[0m15:53:19.421129 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m15:53:19.421513 [debug] [ThreadPool]: Using duckdb connection "list_de_pipeline_main_marts"
[0m15:53:19.421848 [debug] [ThreadPool]: On list_de_pipeline_main_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "list_de_pipeline_main_marts"} */
select
      'de_pipeline' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'de_pipeline'
  
[0m15:53:19.422821 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m15:53:19.423203 [debug] [ThreadPool]: Using duckdb connection "list_de_pipeline_main_staging"
[0m15:53:19.423793 [debug] [ThreadPool]: On list_de_pipeline_main_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "connection_name": "list_de_pipeline_main_staging"} */
select
      'de_pipeline' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'de_pipeline'
  
[0m15:53:19.429730 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m15:53:19.430065 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m15:53:19.430293 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m15:53:19.430922 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m15:53:19.432968 [debug] [ThreadPool]: On list_de_pipeline_main_marts: ROLLBACK
[0m15:53:19.433639 [debug] [ThreadPool]: On list_de_pipeline_main_raw: ROLLBACK
[0m15:53:19.434546 [debug] [ThreadPool]: On list_de_pipeline_main_staging: ROLLBACK
[0m15:53:19.435476 [debug] [ThreadPool]: On list_de_pipeline_main_intermediate: ROLLBACK
[0m15:53:19.436327 [debug] [ThreadPool]: Failed to rollback 'list_de_pipeline_main_marts'
[0m15:53:19.436830 [debug] [ThreadPool]: Failed to rollback 'list_de_pipeline_main_raw'
[0m15:53:19.437491 [debug] [ThreadPool]: Failed to rollback 'list_de_pipeline_main_staging'
[0m15:53:19.438206 [debug] [ThreadPool]: Failed to rollback 'list_de_pipeline_main_intermediate'
[0m15:53:19.438633 [debug] [ThreadPool]: On list_de_pipeline_main_marts: Close
[0m15:53:19.438980 [debug] [ThreadPool]: On list_de_pipeline_main_raw: Close
[0m15:53:19.439318 [debug] [ThreadPool]: On list_de_pipeline_main_staging: Close
[0m15:53:19.439597 [debug] [ThreadPool]: On list_de_pipeline_main_intermediate: Close
[0m15:53:19.443480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e112fb35-b2dd-4364-a6cd-45ba3ff28547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca7675f5f0>]}
[0m15:53:19.444047 [debug] [MainThread]: Using duckdb connection "master"
[0m15:53:19.444364 [debug] [MainThread]: On master: BEGIN
[0m15:53:19.444668 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:53:19.446331 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m15:53:19.446730 [debug] [MainThread]: On master: COMMIT
[0m15:53:19.447085 [debug] [MainThread]: Using duckdb connection "master"
[0m15:53:19.447432 [debug] [MainThread]: On master: COMMIT
[0m15:53:19.447924 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:53:19.448262 [debug] [MainThread]: On master: Close
[0m15:53:19.453649 [debug] [Thread-1 (]: Began running node model.de_pipeline.dim_dates
[0m15:53:19.453926 [debug] [Thread-2 (]: Began running node model.de_pipeline.stg_yellow_trips
[0m15:53:19.454398 [debug] [Thread-3 (]: Began running node seed.de_pipeline.payment_type_lookup
[0m15:53:19.454818 [info ] [Thread-1 (]: 1 of 99 START sql table model main_marts.dim_dates ............................. [RUN]
[0m15:53:19.455130 [debug] [Thread-4 (]: Began running node seed.de_pipeline.rate_code_lookup
[0m15:53:19.455452 [info ] [Thread-2 (]: 2 of 99 START sql table model main_staging.stg_yellow_trips .................... [RUN]
[0m15:53:19.455943 [info ] [Thread-3 (]: 3 of 99 START seed file main_raw.payment_type_lookup ........................... [RUN]
[0m15:53:19.456447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de_pipeline_main_intermediate, now model.de_pipeline.dim_dates)
[0m15:53:19.456971 [info ] [Thread-4 (]: 4 of 99 START seed file main_raw.rate_code_lookup .............................. [RUN]
[0m15:53:19.457488 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_de_pipeline_main_staging, now model.de_pipeline.stg_yellow_trips)
[0m15:53:19.457940 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_de_pipeline_main_raw, now seed.de_pipeline.payment_type_lookup)
[0m15:53:19.458406 [debug] [Thread-1 (]: Began compiling node model.de_pipeline.dim_dates
[0m15:53:19.458975 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_de_pipeline_main_marts, now seed.de_pipeline.rate_code_lookup)
[0m15:53:19.459468 [debug] [Thread-2 (]: Began compiling node model.de_pipeline.stg_yellow_trips
[0m15:53:19.459878 [debug] [Thread-3 (]: Began compiling node seed.de_pipeline.payment_type_lookup
[0m15:53:19.470834 [debug] [Thread-4 (]: Began compiling node seed.de_pipeline.rate_code_lookup
[0m15:53:19.475161 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.dim_dates"
[0m15:53:19.477910 [debug] [Thread-2 (]: Writing injected SQL for node "model.de_pipeline.stg_yellow_trips"
[0m15:53:19.478404 [debug] [Thread-3 (]: Began executing node seed.de_pipeline.payment_type_lookup
[0m15:53:19.478860 [debug] [Thread-4 (]: Began executing node seed.de_pipeline.rate_code_lookup
[0m15:53:19.479370 [debug] [Thread-1 (]: On model.de_pipeline.dim_dates: BEGIN
[0m15:53:19.491406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:19.493691 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:53:19.494251 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.dim_dates"
[0m15:53:19.499864 [debug] [Thread-1 (]: On model.de_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_dates"} */


        select 
        (date_diff('day', cast('2024-01-01' as date)::timestamp, cast('2024-02-01' as date)::timestamp ))
    
[0m15:53:19.505164 [debug] [Thread-3 (]: Using duckdb connection "seed.de_pipeline.payment_type_lookup"
[0m15:53:19.506082 [debug] [Thread-3 (]: On seed.de_pipeline.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "seed.de_pipeline.payment_type_lookup"} */

      drop table if exists "de_pipeline"."main_raw"."payment_type_lookup" cascade
    
[0m15:53:19.507763 [debug] [Thread-4 (]: Using duckdb connection "seed.de_pipeline.rate_code_lookup"
[0m15:53:19.508135 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:19.508568 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:53:19.508855 [debug] [Thread-4 (]: On seed.de_pipeline.rate_code_lookup: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "seed.de_pipeline.rate_code_lookup"} */

      drop table if exists "de_pipeline"."main_raw"."rate_code_lookup" cascade
    
[0m15:53:19.509556 [debug] [Thread-2 (]: Began executing node model.de_pipeline.stg_yellow_trips
[0m15:53:19.519842 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_pipeline.dim_dates"
[0m15:53:19.520488 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:19.540153 [debug] [Thread-2 (]: Writing runtime sql for node "model.de_pipeline.stg_yellow_trips"
[0m15:53:19.548365 [debug] [Thread-3 (]: SQL status: OK in 0.040 seconds
[0m15:53:19.553233 [debug] [Thread-3 (]: Using duckdb connection "seed.de_pipeline.payment_type_lookup"
[0m15:53:19.553582 [debug] [Thread-4 (]: SQL status: OK in 0.033 seconds
[0m15:53:19.554887 [debug] [Thread-3 (]: On seed.de_pipeline.payment_type_lookup: BEGIN
[0m15:53:19.556940 [debug] [Thread-4 (]: Using duckdb connection "seed.de_pipeline.rate_code_lookup"
[0m15:53:19.557271 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.stg_yellow_trips"
[0m15:53:19.557704 [debug] [Thread-4 (]: On seed.de_pipeline.rate_code_lookup: BEGIN
[0m15:53:19.558016 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:53:19.558393 [debug] [Thread-2 (]: On model.de_pipeline.stg_yellow_trips: BEGIN
[0m15:53:19.558642 [debug] [Thread-1 (]: Began executing node model.de_pipeline.dim_dates
[0m15:53:19.559135 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m15:53:19.559358 [debug] [Thread-3 (]: Using duckdb connection "seed.de_pipeline.payment_type_lookup"
[0m15:53:19.559745 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:19.570654 [debug] [Thread-4 (]: Using duckdb connection "seed.de_pipeline.rate_code_lookup"
[0m15:53:19.572813 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.dim_dates"
[0m15:53:19.573464 [debug] [Thread-3 (]: On seed.de_pipeline.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "seed.de_pipeline.payment_type_lookup"} */

    create table "de_pipeline"."main_raw"."payment_type_lookup" ("payment_type_id" INTEGER,"payment_type_name" VARCHAR)
  
[0m15:53:19.574480 [debug] [Thread-4 (]: On seed.de_pipeline.rate_code_lookup: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "seed.de_pipeline.rate_code_lookup"} */

    create table "de_pipeline"."main_raw"."rate_code_lookup" ("rate_code_id" INTEGER,"rate_code_name" VARCHAR)
  
[0m15:53:19.575278 [debug] [Thread-1 (]: On model.de_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_dates"} */
DESCRIBE (select * from (
        /*
    Dimension table: Calendar dates for January 2024.
    Uses adapter-dispatched macros for dayname/monthname.
*/

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 31
    order by generated_number



),

all_periods as (

    select (
        

    (cast('2024-01-01' as date) + cast(row_number() over (order by generated_number) - 1 as bigint) * interval 1 day)
    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-02-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week_num,
        
    dayname(date_day)
 as day_of_week_name,
        
    monthname(date_day)
 as month_name,
        extract(week from date_day) as week_of_year,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when cast(date_day as date) in (
                cast('2024-01-01' as date),
                cast('2024-01-15' as date)
            ) then true
            else false
        end as is_holiday

    from date_spine
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m15:53:19.576317 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m15:53:19.578022 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:53:19.578379 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m15:53:19.578690 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.stg_yellow_trips"
[0m15:53:19.585939 [debug] [Thread-4 (]: Using duckdb connection "seed.de_pipeline.rate_code_lookup"
[0m15:53:19.586889 [debug] [Thread-3 (]: Using duckdb connection "seed.de_pipeline.payment_type_lookup"
[0m15:53:19.587575 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m15:53:19.587963 [debug] [Thread-2 (]: On model.de_pipeline.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_yellow_trips"} */

  
    
    

    create  table
      "de_pipeline"."main_staging"."stg_yellow_trips__dbt_tmp"
  
    as (
      

with source as (
    select * from iceberg_scan('s3://warehouse/silver/cleaned_trips', allow_moved_paths = true)
),

final as (
    select
        -- Flink already generated the surrogate key
        trip_id,

        -- identifiers (already renamed and cast by Flink)
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        payment_type_id,

        -- timestamps (already parsed by Flink)
        cast(pickup_datetime as timestamp) as pickup_datetime,
        cast(dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        passenger_count,
        trip_distance_miles,
        store_and_fwd_flag,

        -- financials (already rounded by Flink)
        round(cast(fare_amount as decimal(10, 2)), 2) as fare_amount,
        round(cast(extra_amount as decimal(10, 2)), 2) as extra_amount,
        round(cast(mta_tax as decimal(10, 2)), 2) as mta_tax,
        round(cast(tip_amount as decimal(10, 2)), 2) as tip_amount,
        round(cast(tolls_amount as decimal(10, 2)), 2) as tolls_amount,
        round(cast(improvement_surcharge as decimal(10, 2)), 2) as improvement_surcharge,
        round(cast(total_amount as decimal(10, 2)), 2) as total_amount,
        round(cast(congestion_surcharge as decimal(10, 2)), 2) as congestion_surcharge,
        round(cast(airport_fee as decimal(10, 2)), 2) as airport_fee

    from source
    -- Flink already applied quality filters; this is a safety net
    where pickup_datetime is not null
      and dropoff_datetime is not null
)

select * from final
    );
  
  
[0m15:53:19.588394 [debug] [Thread-4 (]: On seed.de_pipeline.rate_code_lookup: 
          COPY "de_pipeline"."main_raw"."rate_code_lookup" FROM '/dbt/seeds/rate_code_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m15:53:19.588777 [debug] [Thread-3 (]: On seed.de_pipeline.payment_type_lookup: 
          COPY "de_pipeline"."main_raw"."payment_type_lookup" FROM '/dbt/seeds/payment_type_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m15:53:19.597760 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.dim_dates"
[0m15:53:19.599155 [debug] [Thread-1 (]: On model.de_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_dates"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as date_key, 
      
    cast(null as bigint)
 as year, 
      
    cast(null as bigint)
 as month, 
      
    cast(null as bigint)
 as day_of_month, 
      
    cast(null as bigint)
 as day_of_week_num, 
      
    cast(null as varchar)
 as day_of_week_name, 
      
    cast(null as varchar)
 as month_name, 
      
    cast(null as bigint)
 as week_of_year, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as boolean)
 as is_holiday
    ) as __dbt_sbq
    where false
    limit 0
)
[0m15:53:19.600115 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:53:19.617599 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_pipeline.dim_dates"
[0m15:53:19.618020 [debug] [Thread-4 (]: SQL status: OK in 0.020 seconds
[0m15:53:19.618552 [debug] [Thread-3 (]: SQL status: OK in 0.020 seconds
[0m15:53:19.622931 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.de_pipeline.rate_code_lookup"
[0m15:53:19.623855 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.de_pipeline.payment_type_lookup"
[0m15:53:19.645927 [debug] [Thread-4 (]: On seed.de_pipeline.rate_code_lookup: COMMIT
[0m15:53:19.646432 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.dim_dates"
[0m15:53:19.644758 [debug] [Thread-3 (]: On seed.de_pipeline.payment_type_lookup: COMMIT
[0m15:53:19.647018 [debug] [Thread-4 (]: Using duckdb connection "seed.de_pipeline.rate_code_lookup"
[0m15:53:19.647534 [debug] [Thread-1 (]: On model.de_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_dates"} */

  
    
    
      
    

    create  table
      "de_pipeline"."main_marts"."dim_dates__dbt_tmp"
  
  (
    date_key date,
    year bigint,
    month bigint,
    day_of_month bigint,
    day_of_week_num bigint,
    day_of_week_name varchar,
    month_name varchar,
    week_of_year bigint,
    is_weekend boolean,
    is_holiday boolean
    
    )
 ;
    insert into "de_pipeline"."main_marts"."dim_dates__dbt_tmp" 
  (
    
      
      date_key ,
    
      
      year ,
    
      
      month ,
    
      
      day_of_month ,
    
      
      day_of_week_num ,
    
      
      day_of_week_name ,
    
      
      month_name ,
    
      
      week_of_year ,
    
      
      is_weekend ,
    
      
      is_holiday 
    
  )
 (
      
    select date_key, year, month, day_of_month, day_of_week_num, day_of_week_name, month_name, week_of_year, is_weekend, is_holiday
    from (
        /*
    Dimension table: Calendar dates for January 2024.
    Uses adapter-dispatched macros for dayname/monthname.
*/

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 31
    order by generated_number



),

all_periods as (

    select (
        

    (cast('2024-01-01' as date) + cast(row_number() over (order by generated_number) - 1 as bigint) * interval 1 day)
    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-02-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week_num,
        
    dayname(date_day)
 as day_of_week_name,
        
    monthname(date_day)
 as month_name,
        extract(week from date_day) as week_of_year,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when cast(date_day as date) in (
                cast('2024-01-01' as date),
                cast('2024-01-15' as date)
            ) then true
            else false
        end as is_holiday

    from date_spine
)

select * from final
    ) as model_subq
    );
  
  
[0m15:53:19.647996 [debug] [Thread-2 (]: SQL status: OK in 0.053 seconds
[0m15:53:19.648235 [debug] [Thread-3 (]: Using duckdb connection "seed.de_pipeline.payment_type_lookup"
[0m15:53:19.648681 [debug] [Thread-4 (]: On seed.de_pipeline.rate_code_lookup: COMMIT
[0m15:53:19.654697 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.stg_yellow_trips"
[0m15:53:19.655357 [debug] [Thread-3 (]: On seed.de_pipeline.payment_type_lookup: COMMIT
[0m15:53:19.655918 [debug] [Thread-2 (]: On model.de_pipeline.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_yellow_trips"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_staging'
      AND table_name = 'stg_yellow_trips'
  
[0m15:53:19.657584 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:53:19.658719 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.stg_yellow_trips"
[0m15:53:19.659193 [debug] [Thread-2 (]: On model.de_pipeline.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_yellow_trips"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_staging'
      AND table_name = 'stg_yellow_trips'
  
[0m15:53:19.659796 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m15:53:19.661192 [debug] [Thread-4 (]: On seed.de_pipeline.rate_code_lookup: Close
[0m15:53:19.661434 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:53:19.662635 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m15:53:19.666847 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.stg_yellow_trips"
[0m15:53:19.667759 [debug] [Thread-3 (]: On seed.de_pipeline.payment_type_lookup: Close
[0m15:53:19.668192 [debug] [Thread-2 (]: On model.de_pipeline.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_yellow_trips"} */
alter table "de_pipeline"."main_staging"."stg_yellow_trips" rename to "stg_yellow_trips__dbt_backup"
[0m15:53:19.668468 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e112fb35-b2dd-4364-a6cd-45ba3ff28547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acad7ecc3b0>]}
[0m15:53:19.668927 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e112fb35-b2dd-4364-a6cd-45ba3ff28547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acae43e2720>]}
[0m15:53:19.669778 [info ] [Thread-4 (]: 4 of 99 OK loaded seed file main_raw.rate_code_lookup .......................... [[32mCREATE 7[0m in 0.20s]
[0m15:53:19.670156 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:53:19.670523 [info ] [Thread-3 (]: 3 of 99 OK loaded seed file main_raw.payment_type_lookup ....................... [[32mCREATE 6[0m in 0.21s]
[0m15:53:19.671194 [debug] [Thread-4 (]: Finished running node seed.de_pipeline.rate_code_lookup
[0m15:53:19.673295 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.stg_yellow_trips"
[0m15:53:19.673915 [debug] [Thread-3 (]: Finished running node seed.de_pipeline.payment_type_lookup
[0m15:53:19.674442 [debug] [Thread-4 (]: Began running node seed.de_pipeline.taxi_zone_lookup
[0m15:53:19.675159 [debug] [Thread-2 (]: On model.de_pipeline.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_yellow_trips"} */
alter table "de_pipeline"."main_staging"."stg_yellow_trips__dbt_tmp" rename to "stg_yellow_trips"
[0m15:53:19.675725 [debug] [Thread-3 (]: Began running node seed.de_pipeline.vendor_lookup
[0m15:53:19.676424 [info ] [Thread-4 (]: 5 of 99 START seed file main_raw.taxi_zone_lookup .............................. [RUN]
[0m15:53:19.677606 [info ] [Thread-3 (]: 6 of 99 START seed file main_raw.vendor_lookup ................................. [RUN]
[0m15:53:19.677984 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:53:19.678361 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.de_pipeline.rate_code_lookup, now seed.de_pipeline.taxi_zone_lookup)
[0m15:53:19.678883 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.de_pipeline.payment_type_lookup, now seed.de_pipeline.vendor_lookup)
[0m15:53:19.680241 [debug] [Thread-2 (]: On model.de_pipeline.stg_yellow_trips: COMMIT
[0m15:53:19.680550 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m15:53:19.680807 [debug] [Thread-4 (]: Began compiling node seed.de_pipeline.taxi_zone_lookup
[0m15:53:19.681260 [debug] [Thread-3 (]: Began compiling node seed.de_pipeline.vendor_lookup
[0m15:53:19.681732 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.stg_yellow_trips"
[0m15:53:19.682662 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.dim_dates"
[0m15:53:19.683255 [debug] [Thread-4 (]: Began executing node seed.de_pipeline.taxi_zone_lookup
[0m15:53:19.683745 [debug] [Thread-3 (]: Began executing node seed.de_pipeline.vendor_lookup
[0m15:53:19.684241 [debug] [Thread-2 (]: On model.de_pipeline.stg_yellow_trips: COMMIT
[0m15:53:19.684674 [debug] [Thread-1 (]: On model.de_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_dates"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'dim_dates'
  
[0m15:53:19.691831 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:53:19.695238 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.dim_dates"
[0m15:53:19.696076 [debug] [Thread-1 (]: On model.de_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_dates"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'dim_dates'
  
[0m15:53:19.699018 [debug] [Thread-4 (]: Using duckdb connection "seed.de_pipeline.taxi_zone_lookup"
[0m15:53:19.699406 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:53:19.699710 [debug] [Thread-4 (]: On seed.de_pipeline.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "seed.de_pipeline.taxi_zone_lookup"} */

      drop table if exists "de_pipeline"."main_raw"."taxi_zone_lookup" cascade
    
[0m15:53:19.702754 [debug] [Thread-3 (]: Using duckdb connection "seed.de_pipeline.vendor_lookup"
[0m15:53:19.705163 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.dim_dates"
[0m15:53:19.705552 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:19.706523 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m15:53:19.707765 [debug] [Thread-3 (]: On seed.de_pipeline.vendor_lookup: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "seed.de_pipeline.vendor_lookup"} */

      drop table if exists "de_pipeline"."main_raw"."vendor_lookup" cascade
    
[0m15:53:19.708344 [debug] [Thread-1 (]: On model.de_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_dates"} */
alter table "de_pipeline"."main_marts"."dim_dates" rename to "dim_dates__dbt_backup"
[0m15:53:19.710908 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.stg_yellow_trips"
[0m15:53:19.711453 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:19.712183 [debug] [Thread-2 (]: On model.de_pipeline.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_yellow_trips"} */

      drop table if exists "de_pipeline"."main_staging"."stg_yellow_trips__dbt_backup" cascade
    
[0m15:53:19.712599 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:53:19.715364 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.dim_dates"
[0m15:53:19.715750 [debug] [Thread-1 (]: On model.de_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_dates"} */
alter table "de_pipeline"."main_marts"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m15:53:19.716092 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m15:53:19.717237 [debug] [Thread-4 (]: Using duckdb connection "seed.de_pipeline.taxi_zone_lookup"
[0m15:53:19.717601 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:53:19.718641 [debug] [Thread-4 (]: On seed.de_pipeline.taxi_zone_lookup: BEGIN
[0m15:53:19.720009 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m15:53:19.720959 [debug] [Thread-1 (]: On model.de_pipeline.dim_dates: COMMIT
[0m15:53:19.721865 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m15:53:19.722828 [debug] [Thread-2 (]: On model.de_pipeline.stg_yellow_trips: Close
[0m15:53:19.723234 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.dim_dates"
[0m15:53:19.723633 [debug] [Thread-4 (]: Using duckdb connection "seed.de_pipeline.taxi_zone_lookup"
[0m15:53:19.724531 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m15:53:19.726005 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e112fb35-b2dd-4364-a6cd-45ba3ff28547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca745cfec0>]}
[0m15:53:19.726277 [debug] [Thread-1 (]: On model.de_pipeline.dim_dates: COMMIT
[0m15:53:19.726767 [debug] [Thread-4 (]: On seed.de_pipeline.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "seed.de_pipeline.taxi_zone_lookup"} */

    create table "de_pipeline"."main_raw"."taxi_zone_lookup" ("LocationID" INTEGER,"Borough" VARCHAR,"Zone" VARCHAR,"service_zone" VARCHAR)
  
[0m15:53:19.727820 [debug] [Thread-3 (]: Using duckdb connection "seed.de_pipeline.vendor_lookup"
[0m15:53:19.728669 [info ] [Thread-2 (]: 2 of 99 OK created sql table model main_staging.stg_yellow_trips ............... [[32mOK[0m in 0.27s]
[0m15:53:19.729776 [debug] [Thread-3 (]: On seed.de_pipeline.vendor_lookup: BEGIN
[0m15:53:19.730180 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:53:19.730661 [debug] [Thread-2 (]: Finished running node model.de_pipeline.stg_yellow_trips
[0m15:53:19.731768 [debug] [Thread-4 (]: Using duckdb connection "seed.de_pipeline.taxi_zone_lookup"
[0m15:53:19.732071 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:53:19.732457 [debug] [Thread-2 (]: Began running node test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m15:53:19.732894 [debug] [Thread-4 (]: On seed.de_pipeline.taxi_zone_lookup: 
          COPY "de_pipeline"."main_raw"."taxi_zone_lookup" FROM '/dbt/seeds/taxi_zone_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m15:53:19.733151 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:53:19.733796 [debug] [Thread-3 (]: Using duckdb connection "seed.de_pipeline.vendor_lookup"
[0m15:53:19.734169 [info ] [Thread-2 (]: 7 of 99 START test not_null_rate_code_lookup_rate_code_id ...................... [RUN]
[0m15:53:19.738272 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.dim_dates"
[0m15:53:19.738852 [debug] [Thread-3 (]: On seed.de_pipeline.vendor_lookup: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "seed.de_pipeline.vendor_lookup"} */

    create table "de_pipeline"."main_raw"."vendor_lookup" ("vendor_id" INTEGER,"vendor_name" VARCHAR,"vendor_abbr" VARCHAR)
  
[0m15:53:19.740805 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.de_pipeline.stg_yellow_trips, now test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec)
[0m15:53:19.741757 [debug] [Thread-1 (]: On model.de_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_dates"} */

      drop table if exists "de_pipeline"."main_marts"."dim_dates__dbt_backup" cascade
    
[0m15:53:19.742042 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m15:53:19.743718 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m15:53:19.744701 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.de_pipeline.taxi_zone_lookup"
[0m15:53:19.744991 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:53:19.750342 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:53:19.753862 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m15:53:19.755010 [debug] [Thread-3 (]: Using duckdb connection "seed.de_pipeline.vendor_lookup"
[0m15:53:19.756010 [debug] [Thread-1 (]: On model.de_pipeline.dim_dates: Close
[0m15:53:19.756536 [debug] [Thread-3 (]: On seed.de_pipeline.vendor_lookup: 
          COPY "de_pipeline"."main_raw"."vendor_lookup" FROM '/dbt/seeds/vendor_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m15:53:19.757152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e112fb35-b2dd-4364-a6cd-45ba3ff28547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca7677e900>]}
[0m15:53:19.758215 [info ] [Thread-1 (]: 1 of 99 OK created sql table model main_marts.dim_dates ........................ [[32mOK[0m in 0.30s]
[0m15:53:19.758944 [debug] [Thread-1 (]: Finished running node model.de_pipeline.dim_dates
[0m15:53:19.760596 [debug] [Thread-1 (]: Began running node test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m15:53:19.762112 [info ] [Thread-1 (]: 8 of 99 START test unique_rate_code_lookup_rate_code_id ........................ [RUN]
[0m15:53:19.762689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_pipeline.dim_dates, now test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d)
[0m15:53:19.763092 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m15:53:19.767650 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m15:53:19.770208 [debug] [Thread-4 (]: On seed.de_pipeline.taxi_zone_lookup: COMMIT
[0m15:53:19.770531 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m15:53:19.770838 [debug] [Thread-4 (]: Using duckdb connection "seed.de_pipeline.taxi_zone_lookup"
[0m15:53:19.771339 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.de_pipeline.vendor_lookup"
[0m15:53:19.771712 [debug] [Thread-4 (]: On seed.de_pipeline.taxi_zone_lookup: COMMIT
[0m15:53:19.773367 [debug] [Thread-2 (]: Began executing node test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m15:53:19.787353 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m15:53:19.791956 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m15:53:19.792738 [debug] [Thread-4 (]: On seed.de_pipeline.taxi_zone_lookup: Close
[0m15:53:19.794038 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e112fb35-b2dd-4364-a6cd-45ba3ff28547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca745742f0>]}
[0m15:53:19.794336 [debug] [Thread-1 (]: Began executing node test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m15:53:19.794778 [info ] [Thread-4 (]: 5 of 99 OK loaded seed file main_raw.taxi_zone_lookup .......................... [[32mCREATE 265[0m in 0.12s]
[0m15:53:19.797369 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m15:53:19.798161 [debug] [Thread-4 (]: Finished running node seed.de_pipeline.taxi_zone_lookup
[0m15:53:19.799112 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m15:53:19.799523 [info ] [Thread-4 (]: 9 of 99 START test not_null_payment_type_lookup_payment_type_id ................ [RUN]
[0m15:53:19.800844 [debug] [Thread-3 (]: On seed.de_pipeline.vendor_lookup: COMMIT
[0m15:53:19.801415 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.de_pipeline.taxi_zone_lookup, now test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521)
[0m15:53:19.801993 [debug] [Thread-3 (]: Using duckdb connection "seed.de_pipeline.vendor_lookup"
[0m15:53:19.802448 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m15:53:19.803168 [debug] [Thread-3 (]: On seed.de_pipeline.vendor_lookup: COMMIT
[0m15:53:19.806745 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m15:53:19.809363 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m15:53:19.811871 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:53:19.812222 [debug] [Thread-2 (]: On test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec: BEGIN
[0m15:53:19.812602 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m15:53:19.813465 [debug] [Thread-3 (]: On seed.de_pipeline.vendor_lookup: Close
[0m15:53:19.813897 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:19.814463 [debug] [Thread-1 (]: On test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d: BEGIN
[0m15:53:19.815150 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e112fb35-b2dd-4364-a6cd-45ba3ff28547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca7458f9b0>]}
[0m15:53:19.815829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:19.816680 [info ] [Thread-3 (]: 6 of 99 OK loaded seed file main_raw.vendor_lookup ............................. [[32mCREATE 2[0m in 0.14s]
[0m15:53:19.818149 [debug] [Thread-3 (]: Finished running node seed.de_pipeline.vendor_lookup
[0m15:53:19.818609 [debug] [Thread-3 (]: Began running node test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m15:53:19.819751 [info ] [Thread-3 (]: 10 of 99 START test unique_payment_type_lookup_payment_type_id ................. [RUN]
[0m15:53:19.820635 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.de_pipeline.vendor_lookup, now test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7)
[0m15:53:19.821181 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m15:53:19.824917 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m15:53:19.825409 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m15:53:19.826191 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m15:53:19.826518 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m15:53:19.827028 [debug] [Thread-2 (]: On test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_id
from "de_pipeline"."main_raw"."rate_code_lookup"
where rate_code_id is null



  
  
      
    ) dbt_internal_test
[0m15:53:19.829109 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m15:53:19.829936 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m15:53:19.830545 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m15:53:19.831086 [debug] [Thread-1 (]: On test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rate_code_id as unique_field,
    count(*) as n_records

from "de_pipeline"."main_raw"."rate_code_lookup"
where rate_code_id is not null
group by rate_code_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:53:19.832100 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:53:19.834922 [debug] [Thread-2 (]: On test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec: ROLLBACK
[0m15:53:19.835290 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:53:19.835888 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec'
[0m15:53:19.836953 [debug] [Thread-2 (]: On test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec: Close
[0m15:53:19.838050 [debug] [Thread-1 (]: On test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d: ROLLBACK
[0m15:53:19.838455 [debug] [Thread-3 (]: Began executing node test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m15:53:19.838957 [info ] [Thread-2 (]: 7 of 99 PASS not_null_rate_code_lookup_rate_code_id ............................ [[32mPASS[0m in 0.10s]
[0m15:53:19.839600 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d'
[0m15:53:19.842212 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m15:53:19.842973 [debug] [Thread-2 (]: Finished running node test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m15:53:19.843650 [debug] [Thread-1 (]: On test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d: Close
[0m15:53:19.844720 [debug] [Thread-2 (]: Began running node test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m15:53:19.845176 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m15:53:19.845693 [info ] [Thread-1 (]: 8 of 99 PASS unique_rate_code_lookup_rate_code_id .............................. [[32mPASS[0m in 0.08s]
[0m15:53:19.846020 [info ] [Thread-2 (]: 11 of 99 START test accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6  [RUN]
[0m15:53:19.846511 [debug] [Thread-4 (]: On test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521: BEGIN
[0m15:53:19.847134 [debug] [Thread-1 (]: Finished running node test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m15:53:19.848819 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_rate_code_lookup_rate_code_id.63f831eaec, now test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44)
[0m15:53:19.849427 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:19.850011 [debug] [Thread-1 (]: Began running node test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m15:53:19.851136 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m15:53:19.852298 [info ] [Thread-1 (]: 12 of 99 START test accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99  [RUN]
[0m15:53:19.859593 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m15:53:19.860430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.unique_rate_code_lookup_rate_code_id.dabde9102d, now test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098)
[0m15:53:19.861611 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m15:53:19.862007 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m15:53:19.862414 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m15:53:19.865722 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m15:53:19.866251 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m15:53:19.866749 [debug] [Thread-3 (]: On test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7: BEGIN
[0m15:53:19.867791 [debug] [Thread-4 (]: On test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "de_pipeline"."main_raw"."payment_type_lookup"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m15:53:19.868253 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:19.869873 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:53:19.872023 [debug] [Thread-4 (]: On test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521: ROLLBACK
[0m15:53:19.872922 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521'
[0m15:53:19.873288 [debug] [Thread-4 (]: On test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521: Close
[0m15:53:19.873848 [info ] [Thread-4 (]: 9 of 99 PASS not_null_payment_type_lookup_payment_type_id ...................... [[32mPASS[0m in 0.07s]
[0m15:53:19.874188 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m15:53:19.874587 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m15:53:19.875082 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m15:53:19.875587 [debug] [Thread-4 (]: Began running node test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m15:53:19.876066 [debug] [Thread-3 (]: On test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "de_pipeline"."main_raw"."payment_type_lookup"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:53:19.876559 [info ] [Thread-4 (]: 13 of 99 START test accepted_values_stg_yellow_trips_vendor_id__1__2__6 ........ [RUN]
[0m15:53:19.877570 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_payment_type_lookup_payment_type_id.5e37661521, now test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27)
[0m15:53:19.878069 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m15:53:19.881463 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m15:53:19.881832 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m15:53:19.883150 [debug] [Thread-1 (]: Began executing node test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m15:53:19.886356 [debug] [Thread-3 (]: On test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7: ROLLBACK
[0m15:53:19.888018 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m15:53:19.888293 [debug] [Thread-2 (]: Began executing node test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m15:53:19.892763 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7'
[0m15:53:19.896405 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m15:53:19.896906 [debug] [Thread-3 (]: On test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7: Close
[0m15:53:19.898432 [debug] [Thread-4 (]: Began executing node test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m15:53:19.898097 [info ] [Thread-3 (]: 10 of 99 PASS unique_payment_type_lookup_payment_type_id ....................... [[32mPASS[0m in 0.08s]
[0m15:53:19.900151 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m15:53:19.900869 [debug] [Thread-3 (]: Finished running node test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m15:53:19.901749 [debug] [Thread-3 (]: Began running node test.de_pipeline.assert_fare_not_exceeds_total
[0m15:53:19.902239 [info ] [Thread-3 (]: 14 of 99 START test assert_fare_not_exceeds_total .............................. [RUN]
[0m15:53:19.904073 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.unique_payment_type_lookup_payment_type_id.cabba233a7, now test.de_pipeline.assert_fare_not_exceeds_total)
[0m15:53:19.905904 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.assert_fare_not_exceeds_total
[0m15:53:19.908430 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.assert_fare_not_exceeds_total"
[0m15:53:19.910163 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m15:53:19.910732 [debug] [Thread-1 (]: On test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: BEGIN
[0m15:53:19.911099 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m15:53:19.911379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:19.911934 [debug] [Thread-2 (]: On test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: BEGIN
[0m15:53:19.913718 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:19.915275 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m15:53:19.915821 [debug] [Thread-4 (]: On test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: BEGIN
[0m15:53:19.916300 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:19.917126 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:53:19.917551 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m15:53:19.918046 [debug] [Thread-1 (]: On test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rate_code_id as value_field,
        count(*) as n_records

    from "de_pipeline"."main_staging"."stg_yellow_trips"
    group by rate_code_id

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5','6','99'
)



  
  
      
    ) dbt_internal_test
[0m15:53:19.919282 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m15:53:19.919889 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m15:53:19.920215 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:53:19.920626 [debug] [Thread-2 (]: On test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        payment_type_id as value_field,
        count(*) as n_records

    from "de_pipeline"."main_staging"."stg_yellow_trips"
    group by payment_type_id

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6'
)



  
  
      
    ) dbt_internal_test
[0m15:53:19.922181 [debug] [Thread-1 (]: On test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: ROLLBACK
[0m15:53:19.922665 [debug] [Thread-3 (]: Began executing node test.de_pipeline.assert_fare_not_exceeds_total
[0m15:53:19.923710 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098'
[0m15:53:19.925497 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.assert_fare_not_exceeds_total"
[0m15:53:19.925778 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m15:53:19.926048 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:53:19.927356 [debug] [Thread-1 (]: On test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: Close
[0m15:53:19.929204 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m15:53:19.930496 [debug] [Thread-2 (]: On test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: ROLLBACK
[0m15:53:19.931049 [info ] [Thread-1 (]: 12 of 99 PASS accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99  [[32mPASS[0m in 0.07s]
[0m15:53:19.931427 [debug] [Thread-4 (]: On test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        vendor_id as value_field,
        count(*) as n_records

    from "de_pipeline"."main_staging"."stg_yellow_trips"
    group by vendor_id

)

select *
from all_values
where value_field not in (
    '1','2','6'
)



  
  
      
    ) dbt_internal_test
[0m15:53:19.932455 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44'
[0m15:53:19.933107 [debug] [Thread-1 (]: Finished running node test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m15:53:19.934047 [debug] [Thread-2 (]: On test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: Close
[0m15:53:19.934657 [debug] [Thread-1 (]: Began running node test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m15:53:19.935215 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:53:19.935967 [info ] [Thread-2 (]: 11 of 99 PASS accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6  [[32mPASS[0m in 0.09s]
[0m15:53:19.936449 [info ] [Thread-1 (]: 15 of 99 START test not_null_stg_yellow_trips_dropoff_datetime ................. [RUN]
[0m15:53:19.938268 [debug] [Thread-4 (]: On test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: ROLLBACK
[0m15:53:19.938792 [debug] [Thread-2 (]: Finished running node test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m15:53:19.939320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098, now test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052)
[0m15:53:19.940285 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27'
[0m15:53:19.940632 [debug] [Thread-2 (]: Began running node test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m15:53:19.941102 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m15:53:19.941532 [debug] [Thread-4 (]: On test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: Close
[0m15:53:19.941963 [info ] [Thread-2 (]: 16 of 99 START test not_null_stg_yellow_trips_dropoff_location_id .............. [RUN]
[0m15:53:19.945463 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m15:53:19.946309 [info ] [Thread-4 (]: 13 of 99 PASS accepted_values_stg_yellow_trips_vendor_id__1__2__6 .............. [[32mPASS[0m in 0.07s]
[0m15:53:19.946765 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44, now test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048)
[0m15:53:19.947113 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.assert_fare_not_exceeds_total"
[0m15:53:19.947952 [debug] [Thread-4 (]: Finished running node test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m15:53:19.948376 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m15:53:19.948827 [debug] [Thread-3 (]: On test.de_pipeline.assert_fare_not_exceeds_total: BEGIN
[0m15:53:19.949293 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m15:53:19.953814 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m15:53:19.954518 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:19.955103 [info ] [Thread-4 (]: 17 of 99 START test not_null_stg_yellow_trips_fare_amount ...................... [RUN]
[0m15:53:19.956450 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27, now test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97)
[0m15:53:19.956883 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m15:53:19.963838 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m15:53:19.965156 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m15:53:19.965645 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.assert_fare_not_exceeds_total"
[0m15:53:19.966025 [debug] [Thread-2 (]: Began executing node test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m15:53:19.966426 [debug] [Thread-3 (]: On test.de_pipeline.assert_fare_not_exceeds_total: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.assert_fare_not_exceeds_total"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
    Singular test: fare_amount should not exceed total_amount.
*/

select
    trip_id,
    fare_amount,
    total_amount
from "de_pipeline"."main_staging"."stg_yellow_trips"
where fare_amount > total_amount + 0.01
  and total_amount > 0
  
  
      
    ) dbt_internal_test
[0m15:53:19.968455 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m15:53:19.969594 [debug] [Thread-1 (]: Began executing node test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m15:53:19.972573 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m15:53:19.973180 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:53:19.974816 [debug] [Thread-3 (]: On test.de_pipeline.assert_fare_not_exceeds_total: ROLLBACK
[0m15:53:19.975179 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m15:53:19.976088 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.assert_fare_not_exceeds_total'
[0m15:53:19.977740 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m15:53:19.978152 [debug] [Thread-3 (]: On test.de_pipeline.assert_fare_not_exceeds_total: Close
[0m15:53:19.982144 [info ] [Thread-3 (]: 14 of 99 PASS assert_fare_not_exceeds_total .................................... [[32mPASS[0m in 0.08s]
[0m15:53:19.984550 [debug] [Thread-3 (]: Finished running node test.de_pipeline.assert_fare_not_exceeds_total
[0m15:53:19.985002 [debug] [Thread-3 (]: Began running node test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m15:53:19.985506 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m15:53:19.985843 [info ] [Thread-3 (]: 18 of 99 START test not_null_stg_yellow_trips_pickup_datetime .................. [RUN]
[0m15:53:19.986172 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m15:53:19.986704 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: BEGIN
[0m15:53:19.987367 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.assert_fare_not_exceeds_total, now test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed)
[0m15:53:19.987803 [debug] [Thread-1 (]: On test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052: BEGIN
[0m15:53:19.988181 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:19.988488 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m15:53:19.988934 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m15:53:19.989409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:19.990238 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97: BEGIN
[0m15:53:19.993601 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m15:53:19.994290 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:19.995755 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m15:53:19.996146 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m15:53:19.996513 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_location_id
from "de_pipeline"."main_staging"."stg_yellow_trips"
where dropoff_location_id is null



  
  
      
    ) dbt_internal_test
[0m15:53:19.997495 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m15:53:19.997880 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:53:19.998192 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m15:53:19.999714 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: ROLLBACK
[0m15:53:20.000123 [debug] [Thread-1 (]: On test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_datetime
from "de_pipeline"."main_staging"."stg_yellow_trips"
where dropoff_datetime is null



  
  
      
    ) dbt_internal_test
[0m15:53:20.000948 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048'
[0m15:53:20.001964 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: Close
[0m15:53:20.002256 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m15:53:20.002723 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:53:20.003347 [info ] [Thread-2 (]: 16 of 99 PASS not_null_stg_yellow_trips_dropoff_location_id .................... [[32mPASS[0m in 0.06s]
[0m15:53:20.003703 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m15:53:20.005312 [debug] [Thread-1 (]: On test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052: ROLLBACK
[0m15:53:20.005725 [debug] [Thread-2 (]: Finished running node test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m15:53:20.006190 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fare_amount
from "de_pipeline"."main_staging"."stg_yellow_trips"
where fare_amount is null



  
  
      
    ) dbt_internal_test
[0m15:53:20.009990 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052'
[0m15:53:20.012517 [debug] [Thread-2 (]: Began running node test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m15:53:20.016246 [debug] [Thread-1 (]: On test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052: Close
[0m15:53:20.016669 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:53:20.016983 [info ] [Thread-2 (]: 19 of 99 START test not_null_stg_yellow_trips_pickup_location_id ............... [RUN]
[0m15:53:20.017363 [debug] [Thread-3 (]: Began executing node test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m15:53:20.018135 [info ] [Thread-1 (]: 15 of 99 PASS not_null_stg_yellow_trips_dropoff_datetime ....................... [[32mPASS[0m in 0.08s]
[0m15:53:20.019541 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97: ROLLBACK
[0m15:53:20.019884 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048, now test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1)
[0m15:53:20.021912 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m15:53:20.022596 [debug] [Thread-1 (]: Finished running node test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m15:53:20.023480 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97'
[0m15:53:20.023924 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m15:53:20.024680 [debug] [Thread-1 (]: Began running node test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m15:53:20.025148 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97: Close
[0m15:53:20.028266 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m15:53:20.028758 [info ] [Thread-1 (]: 20 of 99 START test not_null_stg_yellow_trips_total_amount ..................... [RUN]
[0m15:53:20.029429 [info ] [Thread-4 (]: 17 of 99 PASS not_null_stg_yellow_trips_fare_amount ............................ [[32mPASS[0m in 0.07s]
[0m15:53:20.030297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_yellow_trips_dropoff_datetime.369e989052, now test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6)
[0m15:53:20.030965 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m15:53:20.031493 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m15:53:20.031960 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m15:53:20.034463 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m15:53:20.034986 [info ] [Thread-4 (]: 21 of 99 START test not_null_stg_yellow_trips_trip_distance_miles .............. [RUN]
[0m15:53:20.035759 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_yellow_trips_fare_amount.7dfa275a97, now test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7)
[0m15:53:20.036881 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m15:53:20.042725 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m15:53:20.044950 [debug] [Thread-2 (]: Began executing node test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m15:53:20.045367 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m15:53:20.047048 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m15:53:20.047605 [debug] [Thread-3 (]: On test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: BEGIN
[0m15:53:20.048148 [debug] [Thread-1 (]: Began executing node test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m15:53:20.049020 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:20.050824 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m15:53:20.052733 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:53:20.054728 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m15:53:20.055560 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m15:53:20.055893 [debug] [Thread-3 (]: On test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "de_pipeline"."main_staging"."stg_yellow_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m15:53:20.057865 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m15:53:20.059318 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:53:20.060567 [debug] [Thread-3 (]: On test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: ROLLBACK
[0m15:53:20.061296 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed'
[0m15:53:20.061710 [debug] [Thread-3 (]: On test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: Close
[0m15:53:20.062562 [info ] [Thread-3 (]: 18 of 99 PASS not_null_stg_yellow_trips_pickup_datetime ........................ [[32mPASS[0m in 0.08s]
[0m15:53:20.063174 [debug] [Thread-3 (]: Finished running node test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m15:53:20.063531 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m15:53:20.063902 [debug] [Thread-3 (]: Began running node test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m15:53:20.064501 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: BEGIN
[0m15:53:20.064817 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m15:53:20.065125 [info ] [Thread-3 (]: 22 of 99 START test not_null_stg_yellow_trips_trip_id .......................... [RUN]
[0m15:53:20.065749 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:20.066165 [debug] [Thread-1 (]: On test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6: BEGIN
[0m15:53:20.066786 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_yellow_trips_pickup_datetime.069acef7ed, now test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1)
[0m15:53:20.067822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:20.068394 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m15:53:20.069184 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:53:20.069731 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m15:53:20.072844 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m15:53:20.073375 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m15:53:20.073876 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: BEGIN
[0m15:53:20.074595 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_location_id
from "de_pipeline"."main_staging"."stg_yellow_trips"
where pickup_location_id is null



  
  
      
    ) dbt_internal_test
[0m15:53:20.075749 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:20.076384 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m15:53:20.076901 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m15:53:20.077285 [debug] [Thread-1 (]: On test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "de_pipeline"."main_staging"."stg_yellow_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m15:53:20.077531 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:53:20.079634 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: ROLLBACK
[0m15:53:20.080719 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:53:20.081305 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1'
[0m15:53:20.082568 [debug] [Thread-1 (]: On test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6: ROLLBACK
[0m15:53:20.083094 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: Close
[0m15:53:20.083557 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m15:53:20.084148 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6'
[0m15:53:20.084860 [info ] [Thread-2 (]: 19 of 99 PASS not_null_stg_yellow_trips_pickup_location_id ..................... [[32mPASS[0m in 0.06s]
[0m15:53:20.085158 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m15:53:20.085618 [debug] [Thread-1 (]: On test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6: Close
[0m15:53:20.086309 [debug] [Thread-2 (]: Finished running node test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m15:53:20.086879 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_distance_miles
from "de_pipeline"."main_staging"."stg_yellow_trips"
where trip_distance_miles is null



  
  
      
    ) dbt_internal_test
[0m15:53:20.087652 [info ] [Thread-1 (]: 20 of 99 PASS not_null_stg_yellow_trips_total_amount ........................... [[32mPASS[0m in 0.06s]
[0m15:53:20.088000 [debug] [Thread-2 (]: Began running node test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m15:53:20.088363 [debug] [Thread-3 (]: Began executing node test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m15:53:20.089084 [debug] [Thread-1 (]: Finished running node test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m15:53:20.089438 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:53:20.089750 [info ] [Thread-2 (]: 23 of 99 START test not_null_stg_yellow_trips_vendor_id ........................ [RUN]
[0m15:53:20.091763 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m15:53:20.092334 [debug] [Thread-1 (]: Began running node test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965
[0m15:53:20.093723 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: ROLLBACK
[0m15:53:20.094068 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1, now test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57)
[0m15:53:20.095932 [info ] [Thread-1 (]: 24 of 99 START test unique_stg_yellow_trips_trip_id ............................ [RUN]
[0m15:53:20.097557 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7'
[0m15:53:20.098822 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m15:53:20.101873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_yellow_trips_total_amount.64a0bc33f6, now test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965)
[0m15:53:20.104082 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: Close
[0m15:53:20.107329 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m15:53:20.107837 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965
[0m15:53:20.108699 [info ] [Thread-4 (]: 21 of 99 PASS not_null_stg_yellow_trips_trip_distance_miles .................... [[32mPASS[0m in 0.07s]
[0m15:53:20.112195 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965"
[0m15:53:20.112911 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m15:53:20.113742 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348
[0m15:53:20.114169 [info ] [Thread-4 (]: 25 of 99 START test not_null_dim_dates_date_key ................................ [RUN]
[0m15:53:20.114566 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m15:53:20.114924 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7, now test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348)
[0m15:53:20.115321 [debug] [Thread-3 (]: On test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1: BEGIN
[0m15:53:20.115801 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348
[0m15:53:20.116262 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:20.119273 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348"
[0m15:53:20.120735 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:53:20.121156 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m15:53:20.121644 [debug] [Thread-3 (]: On test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "de_pipeline"."main_staging"."stg_yellow_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m15:53:20.123294 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:53:20.124449 [debug] [Thread-1 (]: Began executing node test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965
[0m15:53:20.124759 [debug] [Thread-2 (]: Began executing node test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m15:53:20.125953 [debug] [Thread-3 (]: On test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1: ROLLBACK
[0m15:53:20.129164 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965"
[0m15:53:20.136516 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m15:53:20.137397 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1'
[0m15:53:20.139640 [debug] [Thread-3 (]: On test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1: Close
[0m15:53:20.141518 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348
[0m15:53:20.142254 [info ] [Thread-3 (]: 22 of 99 PASS not_null_stg_yellow_trips_trip_id ................................ [[32mPASS[0m in 0.08s]
[0m15:53:20.144270 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348"
[0m15:53:20.144912 [debug] [Thread-3 (]: Finished running node test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m15:53:20.146845 [debug] [Thread-3 (]: Began running node test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541
[0m15:53:20.149492 [info ] [Thread-3 (]: 26 of 99 START test not_null_dim_dates_day_of_week_name ........................ [RUN]
[0m15:53:20.150049 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_yellow_trips_trip_id.cf5e2695a1, now test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541)
[0m15:53:20.150595 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541
[0m15:53:20.154355 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m15:53:20.155805 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965"
[0m15:53:20.156161 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m15:53:20.156454 [debug] [Thread-1 (]: On test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965: BEGIN
[0m15:53:20.156977 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: BEGIN
[0m15:53:20.157491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:20.158526 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:20.163598 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348"
[0m15:53:20.165568 [debug] [Thread-4 (]: On test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348: BEGIN
[0m15:53:20.166209 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:20.166867 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m15:53:20.167339 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965"
[0m15:53:20.167845 [debug] [Thread-1 (]: On test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "de_pipeline"."main_staging"."stg_yellow_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:53:20.168933 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m15:53:20.169422 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m15:53:20.169872 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "de_pipeline"."main_staging"."stg_yellow_trips"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m15:53:20.171093 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:53:20.171446 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:53:20.172749 [debug] [Thread-1 (]: On test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965: ROLLBACK
[0m15:53:20.173114 [debug] [Thread-3 (]: Began executing node test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541
[0m15:53:20.174734 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: ROLLBACK
[0m15:53:20.175423 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965'
[0m15:53:20.177369 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m15:53:20.177655 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m15:53:20.178435 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57'
[0m15:53:20.178891 [debug] [Thread-1 (]: On test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965: Close
[0m15:53:20.179963 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348"
[0m15:53:20.181682 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: Close
[0m15:53:20.183582 [info ] [Thread-1 (]: 24 of 99 PASS unique_stg_yellow_trips_trip_id .................................. [[32mPASS[0m in 0.08s]
[0m15:53:20.183883 [debug] [Thread-4 (]: On test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "de_pipeline"."main_marts"."dim_dates"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m15:53:20.184617 [info ] [Thread-2 (]: 23 of 99 PASS not_null_stg_yellow_trips_vendor_id .............................. [[32mPASS[0m in 0.09s]
[0m15:53:20.185070 [debug] [Thread-1 (]: Finished running node test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965
[0m15:53:20.185875 [debug] [Thread-2 (]: Finished running node test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m15:53:20.186390 [debug] [Thread-1 (]: Began running node test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a
[0m15:53:20.187706 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:53:20.188994 [debug] [Thread-2 (]: Began running node test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0
[0m15:53:20.189474 [info ] [Thread-1 (]: 27 of 99 START test not_null_dim_dates_is_holiday .............................. [RUN]
[0m15:53:20.191034 [debug] [Thread-4 (]: On test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348: ROLLBACK
[0m15:53:20.191382 [info ] [Thread-2 (]: 28 of 99 START test not_null_dim_dates_is_weekend .............................. [RUN]
[0m15:53:20.193345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.unique_stg_yellow_trips_trip_id.a67db06965, now test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a)
[0m15:53:20.195480 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348'
[0m15:53:20.195891 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57, now test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0)
[0m15:53:20.196835 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a
[0m15:53:20.197822 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m15:53:20.198097 [debug] [Thread-4 (]: On test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348: Close
[0m15:53:20.198468 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0
[0m15:53:20.201620 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a"
[0m15:53:20.202068 [debug] [Thread-3 (]: On test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541: BEGIN
[0m15:53:20.202727 [info ] [Thread-4 (]: 25 of 99 PASS not_null_dim_dates_date_key ...................................... [[32mPASS[0m in 0.09s]
[0m15:53:20.205336 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0"
[0m15:53:20.206392 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:20.207039 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348
[0m15:53:20.209209 [debug] [Thread-4 (]: Began running node test.de_pipeline.unique_dim_dates_date_key.61e1d0726d
[0m15:53:20.209826 [info ] [Thread-4 (]: 29 of 99 START test unique_dim_dates_date_key .................................. [RUN]
[0m15:53:20.210546 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_dim_dates_date_key.8dfe93e348, now test.de_pipeline.unique_dim_dates_date_key.61e1d0726d)
[0m15:53:20.212201 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.unique_dim_dates_date_key.61e1d0726d
[0m15:53:20.225811 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.unique_dim_dates_date_key.61e1d0726d"
[0m15:53:20.226643 [debug] [Thread-3 (]: SQL status: OK in 0.020 seconds
[0m15:53:20.227532 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m15:53:20.227859 [debug] [Thread-1 (]: Began executing node test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a
[0m15:53:20.228202 [debug] [Thread-3 (]: On test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select day_of_week_name
from "de_pipeline"."main_marts"."dim_dates"
where day_of_week_name is null



  
  
      
    ) dbt_internal_test
[0m15:53:20.228580 [debug] [Thread-2 (]: Began executing node test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0
[0m15:53:20.230172 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a"
[0m15:53:20.233697 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0"
[0m15:53:20.234262 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:53:20.236045 [debug] [Thread-3 (]: On test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541: ROLLBACK
[0m15:53:20.236838 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541'
[0m15:53:20.237276 [debug] [Thread-3 (]: On test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541: Close
[0m15:53:20.237948 [info ] [Thread-3 (]: 26 of 99 PASS not_null_dim_dates_day_of_week_name .............................. [[32mPASS[0m in 0.09s]
[0m15:53:20.238614 [debug] [Thread-3 (]: Finished running node test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541
[0m15:53:20.239215 [debug] [Thread-3 (]: Began running node test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m15:53:20.239684 [info ] [Thread-3 (]: 30 of 99 START test not_null_taxi_zone_lookup_Borough .......................... [RUN]
[0m15:53:20.240192 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_dim_dates_day_of_week_name.c9f15af541, now test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa)
[0m15:53:20.240560 [debug] [Thread-4 (]: Began executing node test.de_pipeline.unique_dim_dates_date_key.61e1d0726d
[0m15:53:20.240837 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m15:53:20.242920 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.unique_dim_dates_date_key.61e1d0726d"
[0m15:53:20.246578 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m15:53:20.248182 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a"
[0m15:53:20.248482 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0"
[0m15:53:20.248774 [debug] [Thread-1 (]: On test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a: BEGIN
[0m15:53:20.249439 [debug] [Thread-2 (]: On test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0: BEGIN
[0m15:53:20.249928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:20.250369 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:20.252029 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:53:20.252476 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a"
[0m15:53:20.253113 [debug] [Thread-1 (]: On test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_holiday
from "de_pipeline"."main_marts"."dim_dates"
where is_holiday is null



  
  
      
    ) dbt_internal_test
[0m15:53:20.253489 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:53:20.253937 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0"
[0m15:53:20.254437 [debug] [Thread-2 (]: On test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "de_pipeline"."main_marts"."dim_dates"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m15:53:20.254786 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:53:20.257128 [debug] [Thread-1 (]: On test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a: ROLLBACK
[0m15:53:20.257885 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a'
[0m15:53:20.258211 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:53:20.259419 [debug] [Thread-1 (]: On test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a: Close
[0m15:53:20.260679 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.unique_dim_dates_date_key.61e1d0726d"
[0m15:53:20.262638 [debug] [Thread-2 (]: On test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0: ROLLBACK
[0m15:53:20.263389 [info ] [Thread-1 (]: 27 of 99 PASS not_null_dim_dates_is_holiday .................................... [[32mPASS[0m in 0.07s]
[0m15:53:20.263698 [debug] [Thread-4 (]: On test.de_pipeline.unique_dim_dates_date_key.61e1d0726d: BEGIN
[0m15:53:20.264201 [debug] [Thread-3 (]: Began executing node test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m15:53:20.264758 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0'
[0m15:53:20.265306 [debug] [Thread-1 (]: Finished running node test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a
[0m15:53:20.265754 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:20.268175 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m15:53:20.268683 [debug] [Thread-2 (]: On test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0: Close
[0m15:53:20.269155 [debug] [Thread-1 (]: Began running node test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a
[0m15:53:20.271274 [info ] [Thread-2 (]: 28 of 99 PASS not_null_dim_dates_is_weekend .................................... [[32mPASS[0m in 0.08s]
[0m15:53:20.271654 [info ] [Thread-1 (]: 31 of 99 START test not_null_taxi_zone_lookup_LocationID ....................... [RUN]
[0m15:53:20.272278 [debug] [Thread-2 (]: Finished running node test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0
[0m15:53:20.272921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_dim_dates_is_holiday.9c87ee151a, now test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a)
[0m15:53:20.273454 [debug] [Thread-2 (]: Began running node test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m15:53:20.273818 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m15:53:20.274164 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a
[0m15:53:20.274626 [info ] [Thread-2 (]: 32 of 99 START test unique_taxi_zone_lookup_LocationID ......................... [RUN]
[0m15:53:20.275352 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.unique_dim_dates_date_key.61e1d0726d"
[0m15:53:20.278658 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m15:53:20.279176 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_dim_dates_is_weekend.11ee2914a0, now test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8)
[0m15:53:20.279569 [debug] [Thread-4 (]: On test.de_pipeline.unique_dim_dates_date_key.61e1d0726d: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_dim_dates_date_key.61e1d0726d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "de_pipeline"."main_marts"."dim_dates"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:53:20.280123 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m15:53:20.283380 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m15:53:20.283931 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m15:53:20.285452 [debug] [Thread-4 (]: On test.de_pipeline.unique_dim_dates_date_key.61e1d0726d: ROLLBACK
[0m15:53:20.285928 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m15:53:20.286605 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.unique_dim_dates_date_key.61e1d0726d'
[0m15:53:20.287003 [debug] [Thread-3 (]: On test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa: BEGIN
[0m15:53:20.287378 [debug] [Thread-4 (]: On test.de_pipeline.unique_dim_dates_date_key.61e1d0726d: Close
[0m15:53:20.287818 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:20.288855 [info ] [Thread-4 (]: 29 of 99 PASS unique_dim_dates_date_key ........................................ [[32mPASS[0m in 0.08s]
[0m15:53:20.289704 [debug] [Thread-4 (]: Finished running node test.de_pipeline.unique_dim_dates_date_key.61e1d0726d
[0m15:53:20.290104 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422
[0m15:53:20.291600 [info ] [Thread-4 (]: 33 of 99 START test not_null_vendor_lookup_vendor_abbr ......................... [RUN]
[0m15:53:20.293275 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.unique_dim_dates_date_key.61e1d0726d, now test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422)
[0m15:53:20.293860 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422
[0m15:53:20.297524 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422"
[0m15:53:20.298459 [debug] [Thread-2 (]: Began executing node test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m15:53:20.299784 [debug] [Thread-1 (]: Began executing node test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a
[0m15:53:20.300469 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m15:53:20.302138 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m15:53:20.303878 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m15:53:20.304365 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m15:53:20.305277 [debug] [Thread-3 (]: On test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Borough
from "de_pipeline"."main_raw"."taxi_zone_lookup"
where Borough is null



  
  
      
    ) dbt_internal_test
[0m15:53:20.306665 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:53:20.307881 [debug] [Thread-3 (]: On test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa: ROLLBACK
[0m15:53:20.308612 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa'
[0m15:53:20.309008 [debug] [Thread-3 (]: On test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa: Close
[0m15:53:20.309697 [info ] [Thread-3 (]: 30 of 99 PASS not_null_taxi_zone_lookup_Borough ................................ [[32mPASS[0m in 0.07s]
[0m15:53:20.310236 [debug] [Thread-3 (]: Finished running node test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m15:53:20.310660 [debug] [Thread-3 (]: Began running node test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183
[0m15:53:20.311071 [info ] [Thread-3 (]: 34 of 99 START test not_null_vendor_lookup_vendor_id ........................... [RUN]
[0m15:53:20.311583 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_taxi_zone_lookup_Borough.b38d52d9fa, now test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183)
[0m15:53:20.311986 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183
[0m15:53:20.316050 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183"
[0m15:53:20.317506 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422
[0m15:53:20.317982 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m15:53:20.318479 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m15:53:20.324596 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422"
[0m15:53:20.325001 [debug] [Thread-2 (]: On test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8: BEGIN
[0m15:53:20.325497 [debug] [Thread-1 (]: On test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a: BEGIN
[0m15:53:20.326282 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:20.326796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:20.327168 [debug] [Thread-3 (]: Began executing node test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183
[0m15:53:20.329438 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183"
[0m15:53:20.330757 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m15:53:20.331217 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m15:53:20.331717 [debug] [Thread-2 (]: On test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    LocationID as unique_field,
    count(*) as n_records

from "de_pipeline"."main_raw"."taxi_zone_lookup"
where LocationID is not null
group by LocationID
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:53:20.332990 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:53:20.333402 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:53:20.333692 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m15:53:20.335123 [debug] [Thread-2 (]: On test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8: ROLLBACK
[0m15:53:20.335404 [debug] [Thread-1 (]: On test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select LocationID
from "de_pipeline"."main_raw"."taxi_zone_lookup"
where LocationID is null



  
  
      
    ) dbt_internal_test
[0m15:53:20.336877 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8'
[0m15:53:20.338212 [debug] [Thread-2 (]: On test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8: Close
[0m15:53:20.339095 [info ] [Thread-2 (]: 32 of 99 PASS unique_taxi_zone_lookup_LocationID ............................... [[32mPASS[0m in 0.06s]
[0m15:53:20.339750 [debug] [Thread-2 (]: Finished running node test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m15:53:20.340150 [debug] [Thread-2 (]: Began running node test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0
[0m15:53:20.340542 [info ] [Thread-2 (]: 35 of 99 START test not_null_vendor_lookup_vendor_name ......................... [RUN]
[0m15:53:20.340960 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:53:20.341370 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.unique_taxi_zone_lookup_LocationID.7117f203c8, now test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0)
[0m15:53:20.342171 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422"
[0m15:53:20.343474 [debug] [Thread-1 (]: On test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a: ROLLBACK
[0m15:53:20.343819 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183"
[0m15:53:20.344131 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0
[0m15:53:20.344623 [debug] [Thread-4 (]: On test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422: BEGIN
[0m15:53:20.345714 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a'
[0m15:53:20.346291 [debug] [Thread-3 (]: On test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183: BEGIN
[0m15:53:20.349918 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0"
[0m15:53:20.350527 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:20.351569 [debug] [Thread-1 (]: On test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a: Close
[0m15:53:20.352616 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:20.354217 [info ] [Thread-1 (]: 31 of 99 PASS not_null_taxi_zone_lookup_LocationID ............................. [[32mPASS[0m in 0.08s]
[0m15:53:20.355086 [debug] [Thread-1 (]: Finished running node test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a
[0m15:53:20.356214 [debug] [Thread-1 (]: Began running node test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf
[0m15:53:20.357423 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m15:53:20.357742 [info ] [Thread-1 (]: 36 of 99 START test unique_vendor_lookup_vendor_abbr ........................... [RUN]
[0m15:53:20.358251 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422"
[0m15:53:20.358962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_taxi_zone_lookup_LocationID.681670029a, now test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf)
[0m15:53:20.359478 [debug] [Thread-4 (]: On test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_abbr
from "de_pipeline"."main_raw"."vendor_lookup"
where vendor_abbr is null



  
  
      
    ) dbt_internal_test
[0m15:53:20.360143 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf
[0m15:53:20.360891 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m15:53:20.364460 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf"
[0m15:53:20.364918 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m15:53:20.365245 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183"
[0m15:53:20.366775 [debug] [Thread-4 (]: On test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422: ROLLBACK
[0m15:53:20.367058 [debug] [Thread-3 (]: On test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "de_pipeline"."main_raw"."vendor_lookup"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m15:53:20.367885 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422'
[0m15:53:20.368587 [debug] [Thread-4 (]: On test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422: Close
[0m15:53:20.369171 [info ] [Thread-4 (]: 33 of 99 PASS not_null_vendor_lookup_vendor_abbr ............................... [[32mPASS[0m in 0.08s]
[0m15:53:20.369470 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:53:20.369898 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422
[0m15:53:20.370197 [debug] [Thread-2 (]: Began executing node test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0
[0m15:53:20.371286 [debug] [Thread-3 (]: On test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183: ROLLBACK
[0m15:53:20.371615 [debug] [Thread-4 (]: Began running node test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c
[0m15:53:20.373575 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0"
[0m15:53:20.377361 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183'
[0m15:53:20.379467 [info ] [Thread-4 (]: 37 of 99 START test unique_vendor_lookup_vendor_id ............................. [RUN]
[0m15:53:20.380607 [debug] [Thread-3 (]: On test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183: Close
[0m15:53:20.381262 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_vendor_lookup_vendor_abbr.0ca5bc9422, now test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c)
[0m15:53:20.381886 [debug] [Thread-1 (]: Began executing node test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf
[0m15:53:20.382318 [info ] [Thread-3 (]: 34 of 99 PASS not_null_vendor_lookup_vendor_id ................................. [[32mPASS[0m in 0.07s]
[0m15:53:20.382619 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c
[0m15:53:20.384733 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf"
[0m15:53:20.385371 [debug] [Thread-3 (]: Finished running node test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183
[0m15:53:20.392263 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c"
[0m15:53:20.393515 [debug] [Thread-3 (]: Began running node model.de_pipeline.stg_rate_codes
[0m15:53:20.394480 [info ] [Thread-3 (]: 38 of 99 START sql view model main_staging.stg_rate_codes ...................... [RUN]
[0m15:53:20.395165 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_vendor_lookup_vendor_id.79551d1183, now model.de_pipeline.stg_rate_codes)
[0m15:53:20.395553 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0"
[0m15:53:20.395847 [debug] [Thread-3 (]: Began compiling node model.de_pipeline.stg_rate_codes
[0m15:53:20.396312 [debug] [Thread-2 (]: On test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0: BEGIN
[0m15:53:20.398437 [debug] [Thread-3 (]: Writing injected SQL for node "model.de_pipeline.stg_rate_codes"
[0m15:53:20.399016 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:20.401830 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:53:20.403611 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0"
[0m15:53:20.406868 [debug] [Thread-2 (]: On test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_name
from "de_pipeline"."main_raw"."vendor_lookup"
where vendor_name is null



  
  
      
    ) dbt_internal_test
[0m15:53:20.409687 [debug] [Thread-4 (]: Began executing node test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c
[0m15:53:20.410128 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf"
[0m15:53:20.413038 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c"
[0m15:53:20.413393 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m15:53:20.413751 [debug] [Thread-3 (]: Began executing node model.de_pipeline.stg_rate_codes
[0m15:53:20.414048 [debug] [Thread-1 (]: On test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf: BEGIN
[0m15:53:20.415746 [debug] [Thread-2 (]: On test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0: ROLLBACK
[0m15:53:20.483691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:20.488567 [debug] [Thread-3 (]: Writing runtime sql for node "model.de_pipeline.stg_rate_codes"
[0m15:53:20.489732 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0'
[0m15:53:20.490767 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c"
[0m15:53:20.491119 [debug] [Thread-2 (]: On test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0: Close
[0m15:53:20.492289 [debug] [Thread-4 (]: On test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c: BEGIN
[0m15:53:20.493020 [info ] [Thread-2 (]: 35 of 99 PASS not_null_vendor_lookup_vendor_name ............................... [[32mPASS[0m in 0.15s]
[0m15:53:20.493431 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:20.494038 [debug] [Thread-2 (]: Finished running node test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0
[0m15:53:20.494790 [debug] [Thread-2 (]: Began running node model.de_pipeline.stg_payment_types
[0m15:53:20.495489 [info ] [Thread-2 (]: 39 of 99 START sql view model main_staging.stg_payment_types ................... [RUN]
[0m15:53:20.496146 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_vendor_lookup_vendor_name.11ef94fdf0, now model.de_pipeline.stg_payment_types)
[0m15:53:20.496581 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m15:53:20.496999 [debug] [Thread-2 (]: Began compiling node model.de_pipeline.stg_payment_types
[0m15:53:20.497722 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf"
[0m15:53:20.500105 [debug] [Thread-2 (]: Writing injected SQL for node "model.de_pipeline.stg_payment_types"
[0m15:53:20.500687 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m15:53:20.500991 [debug] [Thread-1 (]: On test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    vendor_abbr as unique_field,
    count(*) as n_records

from "de_pipeline"."main_raw"."vendor_lookup"
where vendor_abbr is not null
group by vendor_abbr
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:53:20.501789 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c"
[0m15:53:20.502834 [debug] [Thread-4 (]: On test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    vendor_id as unique_field,
    count(*) as n_records

from "de_pipeline"."main_raw"."vendor_lookup"
where vendor_id is not null
group by vendor_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:53:20.503757 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.stg_rate_codes"
[0m15:53:20.504133 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:53:20.504411 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:53:20.504692 [debug] [Thread-3 (]: On model.de_pipeline.stg_rate_codes: BEGIN
[0m15:53:20.505994 [debug] [Thread-1 (]: On test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf: ROLLBACK
[0m15:53:20.506996 [debug] [Thread-4 (]: On test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c: ROLLBACK
[0m15:53:20.507278 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:20.508081 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf'
[0m15:53:20.508778 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c'
[0m15:53:20.509646 [debug] [Thread-1 (]: On test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf: Close
[0m15:53:20.510328 [debug] [Thread-4 (]: On test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c: Close
[0m15:53:20.511338 [info ] [Thread-1 (]: 36 of 99 PASS unique_vendor_lookup_vendor_abbr ................................. [[32mPASS[0m in 0.15s]
[0m15:53:20.511983 [info ] [Thread-4 (]: 37 of 99 PASS unique_vendor_lookup_vendor_id ................................... [[32mPASS[0m in 0.13s]
[0m15:53:20.512495 [debug] [Thread-1 (]: Finished running node test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf
[0m15:53:20.513406 [debug] [Thread-4 (]: Finished running node test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c
[0m15:53:20.513990 [debug] [Thread-1 (]: Began running node model.de_pipeline.int_trip_metrics
[0m15:53:20.514706 [debug] [Thread-4 (]: Began running node model.de_pipeline.stg_taxi_zones
[0m15:53:20.515096 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m15:53:20.515709 [info ] [Thread-1 (]: 40 of 99 START sql view model main_intermediate.int_trip_metrics ............... [RUN]
[0m15:53:20.516018 [debug] [Thread-2 (]: Began executing node model.de_pipeline.stg_payment_types
[0m15:53:20.516631 [info ] [Thread-4 (]: 41 of 99 START sql view model main_staging.stg_taxi_zones ...................... [RUN]
[0m15:53:20.517125 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.stg_rate_codes"
[0m15:53:20.517704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.unique_vendor_lookup_vendor_abbr.015baab4bf, now model.de_pipeline.int_trip_metrics)
[0m15:53:20.520174 [debug] [Thread-2 (]: Writing runtime sql for node "model.de_pipeline.stg_payment_types"
[0m15:53:20.520705 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.unique_vendor_lookup_vendor_id.8fc989c73c, now model.de_pipeline.stg_taxi_zones)
[0m15:53:20.521267 [debug] [Thread-3 (]: On model.de_pipeline.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_rate_codes"} */

  
  create view "de_pipeline"."main_staging"."stg_rate_codes__dbt_tmp" as (
    /*
    Staging model: Rate code lookup
    Maps rate_code_id to human-readable names.
*/

with source as (
    select * from "de_pipeline"."main_raw"."rate_code_lookup"
),

renamed as (
    select
        rate_code_id,
        rate_code_name
    from source
)

select * from renamed
  );

[0m15:53:20.521684 [debug] [Thread-1 (]: Began compiling node model.de_pipeline.int_trip_metrics
[0m15:53:20.522405 [debug] [Thread-4 (]: Began compiling node model.de_pipeline.stg_taxi_zones
[0m15:53:20.528286 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_pipeline.int_trip_metrics"
[0m15:53:20.530370 [debug] [Thread-4 (]: Writing injected SQL for node "model.de_pipeline.stg_taxi_zones"
[0m15:53:20.530773 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m15:53:20.533270 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.stg_rate_codes"
[0m15:53:20.533669 [debug] [Thread-3 (]: On model.de_pipeline.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_rate_codes"} */
alter view "de_pipeline"."main_staging"."stg_rate_codes" rename to "stg_rate_codes__dbt_backup"
[0m15:53:20.534429 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m15:53:20.536303 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.stg_rate_codes"
[0m15:53:20.536699 [debug] [Thread-3 (]: On model.de_pipeline.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_rate_codes"} */
alter view "de_pipeline"."main_staging"."stg_rate_codes__dbt_tmp" rename to "stg_rate_codes"
[0m15:53:20.537325 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m15:53:20.538280 [debug] [Thread-3 (]: On model.de_pipeline.stg_rate_codes: COMMIT
[0m15:53:20.538815 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.stg_rate_codes"
[0m15:53:20.539268 [debug] [Thread-3 (]: On model.de_pipeline.stg_rate_codes: COMMIT
[0m15:53:20.540166 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.stg_payment_types"
[0m15:53:20.540643 [debug] [Thread-2 (]: On model.de_pipeline.stg_payment_types: BEGIN
[0m15:53:20.541138 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:20.542728 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:53:20.543246 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.stg_payment_types"
[0m15:53:20.543891 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:53:20.544395 [debug] [Thread-2 (]: On model.de_pipeline.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_payment_types"} */

  
  create view "de_pipeline"."main_staging"."stg_payment_types__dbt_tmp" as (
    /*
    Staging model: Payment type lookup
    Maps payment_type_id to human-readable names.
*/

with source as (
    select * from "de_pipeline"."main_raw"."payment_type_lookup"
),

renamed as (
    select
        payment_type_id,
        payment_type_name
    from source
)

select * from renamed
  );

[0m15:53:20.546633 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.stg_rate_codes"
[0m15:53:20.546971 [debug] [Thread-4 (]: Began executing node model.de_pipeline.stg_taxi_zones
[0m15:53:20.547283 [debug] [Thread-1 (]: Began executing node model.de_pipeline.int_trip_metrics
[0m15:53:20.547917 [debug] [Thread-3 (]: On model.de_pipeline.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_rate_codes"} */

      drop view if exists "de_pipeline"."main_staging"."stg_rate_codes__dbt_backup" cascade
    
[0m15:53:20.549374 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:53:20.552085 [debug] [Thread-4 (]: Writing runtime sql for node "model.de_pipeline.stg_taxi_zones"
[0m15:53:20.554788 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_pipeline.int_trip_metrics"
[0m15:53:20.558814 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.stg_payment_types"
[0m15:53:20.559896 [debug] [Thread-2 (]: On model.de_pipeline.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_payment_types"} */
alter view "de_pipeline"."main_staging"."stg_payment_types" rename to "stg_payment_types__dbt_backup"
[0m15:53:20.560798 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m15:53:20.563662 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.stg_payment_types"
[0m15:53:20.564039 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m15:53:20.564335 [debug] [Thread-2 (]: On model.de_pipeline.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_payment_types"} */
alter view "de_pipeline"."main_staging"."stg_payment_types__dbt_tmp" rename to "stg_payment_types"
[0m15:53:20.565405 [debug] [Thread-3 (]: On model.de_pipeline.stg_rate_codes: Close
[0m15:53:20.566285 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e112fb35-b2dd-4364-a6cd-45ba3ff28547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca767d8440>]}
[0m15:53:20.566900 [info ] [Thread-3 (]: 38 of 99 OK created sql view model main_staging.stg_rate_codes ................. [[32mOK[0m in 0.17s]
[0m15:53:20.568140 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:53:20.569599 [debug] [Thread-3 (]: Finished running node model.de_pipeline.stg_rate_codes
[0m15:53:20.570913 [debug] [Thread-2 (]: On model.de_pipeline.stg_payment_types: COMMIT
[0m15:53:20.571505 [debug] [Thread-3 (]: Began running node model.de_pipeline.stg_vendors
[0m15:53:20.572334 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.stg_payment_types"
[0m15:53:20.572727 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.stg_taxi_zones"
[0m15:53:20.573052 [info ] [Thread-3 (]: 42 of 99 START sql view model main_staging.stg_vendors ......................... [RUN]
[0m15:53:20.573452 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.int_trip_metrics"
[0m15:53:20.573783 [debug] [Thread-2 (]: On model.de_pipeline.stg_payment_types: COMMIT
[0m15:53:20.574614 [debug] [Thread-4 (]: On model.de_pipeline.stg_taxi_zones: BEGIN
[0m15:53:20.575369 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.de_pipeline.stg_rate_codes, now model.de_pipeline.stg_vendors)
[0m15:53:20.576166 [debug] [Thread-1 (]: On model.de_pipeline.int_trip_metrics: BEGIN
[0m15:53:20.577000 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:20.577458 [debug] [Thread-3 (]: Began compiling node model.de_pipeline.stg_vendors
[0m15:53:20.578066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:20.581691 [debug] [Thread-3 (]: Writing injected SQL for node "model.de_pipeline.stg_vendors"
[0m15:53:20.582502 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m15:53:20.584810 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.stg_payment_types"
[0m15:53:20.585190 [debug] [Thread-2 (]: On model.de_pipeline.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_payment_types"} */

      drop view if exists "de_pipeline"."main_staging"."stg_payment_types__dbt_backup" cascade
    
[0m15:53:20.585807 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m15:53:20.586247 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.stg_taxi_zones"
[0m15:53:20.586750 [debug] [Thread-4 (]: On model.de_pipeline.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_taxi_zones"} */

  
  create view "de_pipeline"."main_staging"."stg_taxi_zones__dbt_tmp" as (
    /*
    Staging model: Taxi zone lookup
    Maps LocationID to borough and zone name.
*/

with source as (
    select * from "de_pipeline"."main_raw"."taxi_zone_lookup"
),

renamed as (
    select
        cast("LocationID" as integer) as location_id,
        "Borough" as borough,
        "Zone" as zone_name,
        service_zone
    from source
)

select * from renamed
  );

[0m15:53:20.587629 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m15:53:20.587901 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:53:20.588186 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.int_trip_metrics"
[0m15:53:20.588547 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:53:20.589608 [debug] [Thread-2 (]: On model.de_pipeline.stg_payment_types: Close
[0m15:53:20.590813 [debug] [Thread-1 (]: On model.de_pipeline.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.int_trip_metrics"} */

  
  create view "de_pipeline"."main_intermediate"."int_trip_metrics__dbt_tmp" as (
    /*
    Intermediate model: Trip-level enrichment with calculated metrics.
    Uses adapter-dispatched macros for cross-dialect compatibility.
*/

with trips as (
    select * from "de_pipeline"."main_staging"."stg_yellow_trips"
),

enriched as (
    select
        trip_id,
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        payment_type_id,
        pickup_datetime,
        dropoff_datetime,
        passenger_count,
        trip_distance_miles,
        store_and_fwd_flag,

        -- calculated: duration in minutes
        
    datediff('minute', pickup_datetime, dropoff_datetime)
 as trip_duration_minutes,

        -- calculated: average speed (avoid division by zero)
        case
            when 
    datediff('minute', pickup_datetime, dropoff_datetime)
 > 0
            then round(
                trip_distance_miles / (
    datediff('minute', pickup_datetime, dropoff_datetime)
 / 60.0),
                2
            )
            else null
        end as avg_speed_mph,

        -- calculated: cost per mile
        case
            when trip_distance_miles > 0
            then round(fare_amount / trip_distance_miles, 2)
            else null
        end as cost_per_mile,

        -- calculated: tip percentage
        case
            when fare_amount > 0
            then round((tip_amount / fare_amount) * 100, 2)
            else null
        end as tip_percentage,

        -- time dimensions (using adapter-dispatched macros)
        date_trunc('day', pickup_datetime)::date as pickup_date,
        extract(hour from pickup_datetime) as pickup_hour,
        
    dayname(pickup_datetime)
 as pickup_day_of_week,
        case
            when extract(dow from pickup_datetime) in (0, 6) then true
            else false
        end as is_weekend,

        -- financials passthrough
        fare_amount,
        extra_amount,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount,
        congestion_surcharge,
        airport_fee

    from trips
)

select *
from enriched
where trip_duration_minutes between 1 and 720
  and (avg_speed_mph is null or avg_speed_mph < 100)
  );

[0m15:53:20.593959 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.stg_taxi_zones"
[0m15:53:20.594768 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e112fb35-b2dd-4364-a6cd-45ba3ff28547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca589202c0>]}
[0m15:53:20.596514 [debug] [Thread-4 (]: On model.de_pipeline.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_taxi_zones"} */
alter view "de_pipeline"."main_staging"."stg_taxi_zones" rename to "stg_taxi_zones__dbt_backup"
[0m15:53:20.597766 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:53:20.597289 [info ] [Thread-2 (]: 39 of 99 OK created sql view model main_staging.stg_payment_types .............. [[32mOK[0m in 0.10s]
[0m15:53:20.600727 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.int_trip_metrics"
[0m15:53:20.601044 [debug] [Thread-3 (]: Began executing node model.de_pipeline.stg_vendors
[0m15:53:20.601450 [debug] [Thread-2 (]: Finished running node model.de_pipeline.stg_payment_types
[0m15:53:20.601741 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m15:53:20.602011 [debug] [Thread-1 (]: On model.de_pipeline.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.int_trip_metrics"} */
alter view "de_pipeline"."main_intermediate"."int_trip_metrics" rename to "int_trip_metrics__dbt_backup"
[0m15:53:20.604933 [debug] [Thread-3 (]: Writing runtime sql for node "model.de_pipeline.stg_vendors"
[0m15:53:20.605391 [debug] [Thread-2 (]: Began running node test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m15:53:20.607629 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.stg_taxi_zones"
[0m15:53:20.608592 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:53:20.608871 [info ] [Thread-2 (]: 43 of 99 START test not_null_stg_rate_codes_rate_code_id ....................... [RUN]
[0m15:53:20.609300 [debug] [Thread-4 (]: On model.de_pipeline.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_taxi_zones"} */
alter view "de_pipeline"."main_staging"."stg_taxi_zones__dbt_tmp" rename to "stg_taxi_zones"
[0m15:53:20.611345 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.int_trip_metrics"
[0m15:53:20.611970 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.de_pipeline.stg_payment_types, now test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a)
[0m15:53:20.612786 [debug] [Thread-1 (]: On model.de_pipeline.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.int_trip_metrics"} */
alter view "de_pipeline"."main_intermediate"."int_trip_metrics__dbt_tmp" rename to "int_trip_metrics"
[0m15:53:20.613160 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:53:20.613475 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m15:53:20.615203 [debug] [Thread-4 (]: On model.de_pipeline.stg_taxi_zones: COMMIT
[0m15:53:20.617961 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m15:53:20.618267 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:53:20.618551 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.stg_taxi_zones"
[0m15:53:20.620072 [debug] [Thread-1 (]: On model.de_pipeline.int_trip_metrics: COMMIT
[0m15:53:20.620528 [debug] [Thread-4 (]: On model.de_pipeline.stg_taxi_zones: COMMIT
[0m15:53:20.622103 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.int_trip_metrics"
[0m15:53:20.624009 [debug] [Thread-1 (]: On model.de_pipeline.int_trip_metrics: COMMIT
[0m15:53:20.624977 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.stg_vendors"
[0m15:53:20.625494 [debug] [Thread-3 (]: On model.de_pipeline.stg_vendors: BEGIN
[0m15:53:20.625913 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:20.627289 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m15:53:20.629484 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.stg_taxi_zones"
[0m15:53:20.629922 [debug] [Thread-4 (]: On model.de_pipeline.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_taxi_zones"} */

      drop view if exists "de_pipeline"."main_staging"."stg_taxi_zones__dbt_backup" cascade
    
[0m15:53:20.631007 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:53:20.631309 [debug] [Thread-2 (]: Began executing node test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m15:53:20.633050 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.int_trip_metrics"
[0m15:53:20.633360 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m15:53:20.633624 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m15:53:20.635175 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m15:53:20.635659 [debug] [Thread-1 (]: On model.de_pipeline.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.int_trip_metrics"} */

      drop view if exists "de_pipeline"."main_intermediate"."int_trip_metrics__dbt_backup" cascade
    
[0m15:53:20.636115 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.stg_vendors"
[0m15:53:20.637128 [debug] [Thread-4 (]: On model.de_pipeline.stg_taxi_zones: Close
[0m15:53:20.638496 [debug] [Thread-3 (]: On model.de_pipeline.stg_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_vendors"} */

  
  create view "de_pipeline"."main_staging"."stg_vendors__dbt_tmp" as (
    /*
    Staging model: Vendor lookup
    Maps vendor_id to vendor name and abbreviation.
*/

with source as (
    select * from "de_pipeline"."main_raw"."vendor_lookup"
),

renamed as (
    select
        vendor_id,
        vendor_name,
        vendor_abbr
    from source
)

select * from renamed
  );

[0m15:53:20.639329 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e112fb35-b2dd-4364-a6cd-45ba3ff28547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acad4b1cb30>]}
[0m15:53:20.640173 [info ] [Thread-4 (]: 41 of 99 OK created sql view model main_staging.stg_taxi_zones ................. [[32mOK[0m in 0.12s]
[0m15:53:20.640912 [debug] [Thread-4 (]: Finished running node model.de_pipeline.stg_taxi_zones
[0m15:53:20.641238 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:53:20.641630 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:53:20.641988 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m15:53:20.649353 [debug] [Thread-1 (]: On model.de_pipeline.int_trip_metrics: Close
[0m15:53:20.652616 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.stg_vendors"
[0m15:53:20.653425 [info ] [Thread-4 (]: 44 of 99 START test not_null_stg_rate_codes_rate_code_name ..................... [RUN]
[0m15:53:20.654231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e112fb35-b2dd-4364-a6cd-45ba3ff28547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca76738b00>]}
[0m15:53:20.654694 [debug] [Thread-3 (]: On model.de_pipeline.stg_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_vendors"} */
alter view "de_pipeline"."main_staging"."stg_vendors" rename to "stg_vendors__dbt_backup"
[0m15:53:20.655244 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.de_pipeline.stg_taxi_zones, now test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f)
[0m15:53:20.655604 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m15:53:20.656073 [info ] [Thread-1 (]: 40 of 99 OK created sql view model main_intermediate.int_trip_metrics .......... [[32mOK[0m in 0.14s]
[0m15:53:20.657190 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m15:53:20.657564 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:53:20.657855 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: BEGIN
[0m15:53:20.660322 [debug] [Thread-1 (]: Finished running node model.de_pipeline.int_trip_metrics
[0m15:53:20.665150 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m15:53:20.670092 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.stg_vendors"
[0m15:53:20.670648 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:20.671125 [debug] [Thread-1 (]: Began running node test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m15:53:20.671959 [debug] [Thread-3 (]: On model.de_pipeline.stg_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_vendors"} */
alter view "de_pipeline"."main_staging"."stg_vendors__dbt_tmp" rename to "stg_vendors"
[0m15:53:20.672715 [info ] [Thread-1 (]: 45 of 99 START test unique_stg_rate_codes_rate_code_id ......................... [RUN]
[0m15:53:20.673541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_pipeline.int_trip_metrics, now test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3)
[0m15:53:20.673901 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:53:20.674341 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m15:53:20.675551 [debug] [Thread-3 (]: On model.de_pipeline.stg_vendors: COMMIT
[0m15:53:20.678350 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m15:53:20.678830 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.stg_vendors"
[0m15:53:20.679410 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m15:53:20.679798 [debug] [Thread-3 (]: On model.de_pipeline.stg_vendors: COMMIT
[0m15:53:20.680205 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m15:53:20.680780 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_id
from "de_pipeline"."main_staging"."stg_rate_codes"
where rate_code_id is null



  
  
      
    ) dbt_internal_test
[0m15:53:20.681971 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:53:20.683283 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: ROLLBACK
[0m15:53:20.683964 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a'
[0m15:53:20.684248 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:53:20.684477 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: Close
[0m15:53:20.686519 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.stg_vendors"
[0m15:53:20.688037 [info ] [Thread-2 (]: 43 of 99 PASS not_null_stg_rate_codes_rate_code_id ............................. [[32mPASS[0m in 0.08s]
[0m15:53:20.688385 [debug] [Thread-3 (]: On model.de_pipeline.stg_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.stg_vendors"} */

      drop view if exists "de_pipeline"."main_staging"."stg_vendors__dbt_backup" cascade
    
[0m15:53:20.688662 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m15:53:20.689212 [debug] [Thread-2 (]: Finished running node test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m15:53:20.689458 [debug] [Thread-1 (]: Began executing node test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m15:53:20.691607 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m15:53:20.692064 [debug] [Thread-2 (]: Began running node test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m15:53:20.693600 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m15:53:20.693938 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:53:20.694482 [info ] [Thread-2 (]: 46 of 99 START test not_null_stg_payment_types_payment_type_id ................. [RUN]
[0m15:53:20.695877 [debug] [Thread-3 (]: On model.de_pipeline.stg_vendors: Close
[0m15:53:20.696317 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_rate_codes_rate_code_id.a3d3d6524a, now test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78)
[0m15:53:20.697003 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e112fb35-b2dd-4364-a6cd-45ba3ff28547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca5888e8d0>]}
[0m15:53:20.697241 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m15:53:20.697875 [info ] [Thread-3 (]: 42 of 99 OK created sql view model main_staging.stg_vendors .................... [[32mOK[0m in 0.12s]
[0m15:53:20.700737 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m15:53:20.701302 [debug] [Thread-3 (]: Finished running node model.de_pipeline.stg_vendors
[0m15:53:20.702017 [debug] [Thread-3 (]: Began running node test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m15:53:20.702525 [info ] [Thread-3 (]: 47 of 99 START test not_null_stg_payment_types_payment_type_name ............... [RUN]
[0m15:53:20.703061 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.de_pipeline.stg_vendors, now test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39)
[0m15:53:20.703507 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m15:53:20.706332 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m15:53:20.706659 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m15:53:20.707147 [debug] [Thread-1 (]: On test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3: BEGIN
[0m15:53:20.707534 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m15:53:20.707754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:20.708960 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: BEGIN
[0m15:53:20.711852 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:20.716496 [debug] [Thread-2 (]: Began executing node test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m15:53:20.718510 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m15:53:20.718920 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m15:53:20.719267 [debug] [Thread-3 (]: Began executing node test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m15:53:20.720480 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m15:53:20.722789 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m15:53:20.723319 [debug] [Thread-1 (]: On test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rate_code_id as unique_field,
    count(*) as n_records

from "de_pipeline"."main_staging"."stg_rate_codes"
where rate_code_id is not null
group by rate_code_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:53:20.724267 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m15:53:20.724655 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m15:53:20.724929 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:53:20.725149 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_name
from "de_pipeline"."main_staging"."stg_rate_codes"
where rate_code_name is null



  
  
      
    ) dbt_internal_test
[0m15:53:20.726838 [debug] [Thread-1 (]: On test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3: ROLLBACK
[0m15:53:20.727930 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:53:20.728492 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3'
[0m15:53:20.729463 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: ROLLBACK
[0m15:53:20.730380 [debug] [Thread-1 (]: On test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3: Close
[0m15:53:20.731943 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f'
[0m15:53:20.732591 [info ] [Thread-1 (]: 45 of 99 PASS unique_stg_rate_codes_rate_code_id ............................... [[32mPASS[0m in 0.06s]
[0m15:53:20.732920 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: Close
[0m15:53:20.733570 [debug] [Thread-1 (]: Finished running node test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m15:53:20.733992 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m15:53:20.734484 [info ] [Thread-4 (]: 44 of 99 PASS not_null_stg_rate_codes_rate_code_name ........................... [[32mPASS[0m in 0.08s]
[0m15:53:20.734828 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m15:53:20.735388 [debug] [Thread-1 (]: Began running node test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534
[0m15:53:20.735848 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78: BEGIN
[0m15:53:20.736325 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m15:53:20.736754 [debug] [Thread-3 (]: On test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39: BEGIN
[0m15:53:20.737224 [info ] [Thread-1 (]: 48 of 99 START test unique_stg_payment_types_payment_type_id ................... [RUN]
[0m15:53:20.737721 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:20.738159 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m15:53:20.738619 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:20.739164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.unique_stg_rate_codes_rate_code_id.6afe3a82e3, now test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534)
[0m15:53:20.739990 [info ] [Thread-4 (]: 49 of 99 START test not_null_stg_taxi_zones_borough ............................ [RUN]
[0m15:53:20.740808 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534
[0m15:53:20.741922 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_rate_codes_rate_code_name.d13a52ad0f, now test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b)
[0m15:53:20.746393 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534"
[0m15:53:20.746977 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m15:53:20.748268 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m15:53:20.752449 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m15:53:20.752962 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m15:53:20.753902 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "de_pipeline"."main_staging"."stg_payment_types"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m15:53:20.754607 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m15:53:20.755224 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m15:53:20.755607 [debug] [Thread-3 (]: On test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_name
from "de_pipeline"."main_staging"."stg_payment_types"
where payment_type_name is null



  
  
      
    ) dbt_internal_test
[0m15:53:20.756206 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:53:20.758092 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:53:20.759645 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78: ROLLBACK
[0m15:53:20.760835 [debug] [Thread-3 (]: On test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39: ROLLBACK
[0m15:53:20.764542 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78'
[0m15:53:20.766424 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39'
[0m15:53:20.766851 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78: Close
[0m15:53:20.767576 [debug] [Thread-3 (]: On test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39: Close
[0m15:53:20.768396 [info ] [Thread-2 (]: 46 of 99 PASS not_null_stg_payment_types_payment_type_id ....................... [[32mPASS[0m in 0.07s]
[0m15:53:20.768804 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m15:53:20.769315 [info ] [Thread-3 (]: 47 of 99 PASS not_null_stg_payment_types_payment_type_name ..................... [[32mPASS[0m in 0.07s]
[0m15:53:20.769728 [debug] [Thread-2 (]: Finished running node test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m15:53:20.769988 [debug] [Thread-1 (]: Began executing node test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534
[0m15:53:20.771809 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m15:53:20.772357 [debug] [Thread-3 (]: Finished running node test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m15:53:20.772775 [debug] [Thread-2 (]: Began running node test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m15:53:20.774259 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534"
[0m15:53:20.774921 [debug] [Thread-3 (]: Began running node test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m15:53:20.775382 [info ] [Thread-2 (]: 50 of 99 START test not_null_stg_taxi_zones_location_id ........................ [RUN]
[0m15:53:20.776132 [info ] [Thread-3 (]: 51 of 99 START test not_null_stg_taxi_zones_zone_name .......................... [RUN]
[0m15:53:20.776925 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_payment_types_payment_type_id.65f5cf5d78, now test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf)
[0m15:53:20.777474 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_payment_types_payment_type_name.16ff531e39, now test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84)
[0m15:53:20.778449 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m15:53:20.778962 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m15:53:20.782081 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m15:53:20.800035 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m15:53:20.802411 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m15:53:20.802834 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b: BEGIN
[0m15:53:20.803168 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534"
[0m15:53:20.803443 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:20.803879 [debug] [Thread-1 (]: On test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534: BEGIN
[0m15:53:20.804950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:20.805929 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:53:20.806329 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m15:53:20.806648 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select borough
from "de_pipeline"."main_staging"."stg_taxi_zones"
where borough is null



  
  
      
    ) dbt_internal_test
[0m15:53:20.807399 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:53:20.807716 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:53:20.807942 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534"
[0m15:53:20.809244 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b: ROLLBACK
[0m15:53:20.809866 [debug] [Thread-1 (]: On test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "de_pipeline"."main_staging"."stg_payment_types"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:53:20.811392 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b'
[0m15:53:20.811791 [debug] [Thread-4 (]: On test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b: Close
[0m15:53:20.812146 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:53:20.813258 [debug] [Thread-2 (]: Began executing node test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m15:53:20.814266 [debug] [Thread-1 (]: On test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534: ROLLBACK
[0m15:53:20.812849 [info ] [Thread-4 (]: 49 of 99 PASS not_null_stg_taxi_zones_borough .................................. [[32mPASS[0m in 0.07s]
[0m15:53:20.814611 [debug] [Thread-3 (]: Began executing node test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m15:53:20.816203 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m15:53:20.817027 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534'
[0m15:53:20.817489 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m15:53:20.819072 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m15:53:20.820342 [debug] [Thread-1 (]: On test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534: Close
[0m15:53:20.820849 [debug] [Thread-4 (]: Began running node test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m15:53:20.821925 [info ] [Thread-1 (]: 48 of 99 PASS unique_stg_payment_types_payment_type_id ......................... [[32mPASS[0m in 0.08s]
[0m15:53:20.822385 [info ] [Thread-4 (]: 52 of 99 START test relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_  [RUN]
[0m15:53:20.823023 [debug] [Thread-1 (]: Finished running node test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534
[0m15:53:20.824664 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_taxi_zones_borough.4c0b9ae98b, now test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a)
[0m15:53:20.826987 [debug] [Thread-1 (]: Began running node test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m15:53:20.828416 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m15:53:20.828792 [info ] [Thread-1 (]: 53 of 99 START test relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_  [RUN]
[0m15:53:20.833945 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m15:53:20.834554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.unique_stg_payment_types_payment_type_id.0455602534, now test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f)
[0m15:53:20.835338 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m15:53:20.835752 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m15:53:20.836012 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m15:53:20.836537 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf: BEGIN
[0m15:53:20.837012 [debug] [Thread-3 (]: On test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84: BEGIN
[0m15:53:20.841835 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m15:53:20.842367 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:20.843258 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:20.845924 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:53:20.846423 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m15:53:20.846946 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "de_pipeline"."main_staging"."stg_taxi_zones"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m15:53:20.847752 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:53:20.848145 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m15:53:20.848461 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:53:20.848708 [debug] [Thread-3 (]: On test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select zone_name
from "de_pipeline"."main_staging"."stg_taxi_zones"
where zone_name is null



  
  
      
    ) dbt_internal_test
[0m15:53:20.849914 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf: ROLLBACK
[0m15:53:20.851362 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf'
[0m15:53:20.851702 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:53:20.853007 [debug] [Thread-2 (]: On test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf: Close
[0m15:53:20.855450 [debug] [Thread-3 (]: On test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84: ROLLBACK
[0m15:53:20.856154 [info ] [Thread-2 (]: 50 of 99 PASS not_null_stg_taxi_zones_location_id .............................. [[32mPASS[0m in 0.08s]
[0m15:53:20.856755 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84'
[0m15:53:20.857095 [debug] [Thread-4 (]: Began executing node test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m15:53:20.857565 [debug] [Thread-2 (]: Finished running node test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m15:53:20.857947 [debug] [Thread-3 (]: On test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84: Close
[0m15:53:20.858193 [debug] [Thread-1 (]: Began executing node test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m15:53:20.860352 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m15:53:20.861036 [debug] [Thread-2 (]: Began running node test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c
[0m15:53:20.861724 [info ] [Thread-3 (]: 51 of 99 PASS not_null_stg_taxi_zones_zone_name ................................ [[32mPASS[0m in 0.08s]
[0m15:53:20.872260 [info ] [Thread-2 (]: 54 of 99 START test unique_stg_taxi_zones_location_id .......................... [RUN]
[0m15:53:20.869816 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m15:53:20.873601 [debug] [Thread-3 (]: Finished running node test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m15:53:20.874098 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_taxi_zones_location_id.5b95dc00bf, now test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c)
[0m15:53:20.874949 [debug] [Thread-3 (]: Began running node test.de_pipeline.assert_trip_duration_positive
[0m15:53:20.875377 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c
[0m15:53:20.875817 [info ] [Thread-3 (]: 55 of 99 START test assert_trip_duration_positive .............................. [RUN]
[0m15:53:20.879093 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m15:53:20.879681 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_stg_taxi_zones_zone_name.a3a6153c84, now test.de_pipeline.assert_trip_duration_positive)
[0m15:53:20.880312 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.assert_trip_duration_positive
[0m15:53:20.882253 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.assert_trip_duration_positive"
[0m15:53:20.885129 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m15:53:20.885659 [debug] [Thread-1 (]: On test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: BEGIN
[0m15:53:20.886065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:20.886388 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m15:53:20.887210 [debug] [Thread-4 (]: On test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: BEGIN
[0m15:53:20.887824 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:20.888302 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:53:20.888856 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m15:53:20.889274 [debug] [Thread-1 (]: On test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select pickup_location_id as from_field
    from "de_pipeline"."main_staging"."stg_yellow_trips"
    where pickup_location_id is not null
),

parent as (
    select location_id as to_field
    from "de_pipeline"."main_staging"."stg_taxi_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:53:20.890013 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:53:20.890522 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m15:53:20.890991 [debug] [Thread-4 (]: On test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select dropoff_location_id as from_field
    from "de_pipeline"."main_staging"."stg_yellow_trips"
    where dropoff_location_id is not null
),

parent as (
    select location_id as to_field
    from "de_pipeline"."main_staging"."stg_taxi_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:53:20.893055 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:53:20.894326 [debug] [Thread-3 (]: Began executing node test.de_pipeline.assert_trip_duration_positive
[0m15:53:20.894689 [debug] [Thread-2 (]: Began executing node test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c
[0m15:53:20.895021 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m15:53:20.896212 [debug] [Thread-1 (]: On test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: ROLLBACK
[0m15:53:20.897830 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.assert_trip_duration_positive"
[0m15:53:20.900016 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m15:53:20.901528 [debug] [Thread-4 (]: On test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: ROLLBACK
[0m15:53:20.902344 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f'
[0m15:53:20.903559 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a'
[0m15:53:20.903965 [debug] [Thread-1 (]: On test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: Close
[0m15:53:20.904471 [debug] [Thread-4 (]: On test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: Close
[0m15:53:20.905199 [info ] [Thread-1 (]: 53 of 99 PASS relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_  [[32mPASS[0m in 0.07s]
[0m15:53:20.905730 [info ] [Thread-4 (]: 52 of 99 PASS relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_  [[32mPASS[0m in 0.08s]
[0m15:53:20.906239 [debug] [Thread-1 (]: Finished running node test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m15:53:20.906788 [debug] [Thread-4 (]: Finished running node test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m15:53:20.907316 [debug] [Thread-1 (]: Began running node test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m15:53:20.907821 [debug] [Thread-4 (]: Began running node test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m15:53:20.908299 [info ] [Thread-1 (]: 56 of 99 START test dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0  [RUN]
[0m15:53:20.909010 [info ] [Thread-4 (]: 57 of 99 START test dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1  [RUN]
[0m15:53:20.909530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f, now test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574)
[0m15:53:20.909931 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a, now test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718)
[0m15:53:20.910387 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m15:53:20.910817 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m15:53:20.918113 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m15:53:20.920695 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m15:53:20.921701 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.assert_trip_duration_positive"
[0m15:53:20.922070 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m15:53:20.922336 [debug] [Thread-3 (]: On test.de_pipeline.assert_trip_duration_positive: BEGIN
[0m15:53:20.923033 [debug] [Thread-2 (]: On test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c: BEGIN
[0m15:53:20.923417 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:20.923837 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:20.925540 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:53:20.925978 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.assert_trip_duration_positive"
[0m15:53:20.926603 [debug] [Thread-3 (]: On test.de_pipeline.assert_trip_duration_positive: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.assert_trip_duration_positive"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
    Singular test: No trip should have negative duration.
*/

select
    trip_id,
    pickup_datetime,
    dropoff_datetime,
    trip_duration_minutes
from "de_pipeline"."main_intermediate"."int_trip_metrics"
where trip_duration_minutes < 0
  
  
      
    ) dbt_internal_test
[0m15:53:20.928417 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:53:20.934207 [debug] [Thread-3 (]: On test.de_pipeline.assert_trip_duration_positive: ROLLBACK
[0m15:53:20.935598 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.assert_trip_duration_positive'
[0m15:53:20.936028 [debug] [Thread-4 (]: Began executing node test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m15:53:20.936347 [debug] [Thread-3 (]: On test.de_pipeline.assert_trip_duration_positive: Close
[0m15:53:20.936870 [debug] [Thread-1 (]: Began executing node test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m15:53:20.939758 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m15:53:20.940167 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m15:53:20.940630 [info ] [Thread-3 (]: 55 of 99 PASS assert_trip_duration_positive .................................... [[32mPASS[0m in 0.06s]
[0m15:53:20.942053 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m15:53:20.943295 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m15:53:20.943859 [debug] [Thread-3 (]: Finished running node test.de_pipeline.assert_trip_duration_positive
[0m15:53:20.944523 [debug] [Thread-2 (]: On test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "de_pipeline"."main_staging"."stg_taxi_zones"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:53:20.944941 [debug] [Thread-3 (]: Began running node test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m15:53:20.945604 [info ] [Thread-3 (]: 58 of 99 START test not_null_int_trip_metrics_is_weekend ....................... [RUN]
[0m15:53:20.946386 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.assert_trip_duration_positive, now test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed)
[0m15:53:20.946765 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:53:20.947029 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m15:53:20.948258 [debug] [Thread-2 (]: On test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c: ROLLBACK
[0m15:53:20.950952 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m15:53:20.951716 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c'
[0m15:53:20.952443 [debug] [Thread-2 (]: On test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c: Close
[0m15:53:20.953142 [info ] [Thread-2 (]: 54 of 99 PASS unique_stg_taxi_zones_location_id ................................ [[32mPASS[0m in 0.08s]
[0m15:53:20.953712 [debug] [Thread-2 (]: Finished running node test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c
[0m15:53:20.954158 [debug] [Thread-2 (]: Began running node test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m15:53:20.954581 [info ] [Thread-2 (]: 59 of 99 START test not_null_int_trip_metrics_pickup_date ...................... [RUN]
[0m15:53:20.955103 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.unique_stg_taxi_zones_location_id.ff20549a5c, now test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3)
[0m15:53:20.955539 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m15:53:20.955833 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m15:53:20.959381 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m15:53:20.959823 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m15:53:20.960111 [debug] [Thread-1 (]: On test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: BEGIN
[0m15:53:20.960912 [debug] [Thread-4 (]: On test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: BEGIN
[0m15:53:20.961313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:20.961727 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:20.964957 [debug] [Thread-3 (]: Began executing node test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m15:53:20.967031 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m15:53:20.969481 [debug] [Thread-2 (]: Began executing node test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m15:53:20.971279 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m15:53:20.971878 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m15:53:20.972634 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m15:53:20.973078 [debug] [Thread-1 (]: On test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "de_pipeline"."main_intermediate"."int_trip_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m15:53:20.973973 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m15:53:20.974365 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m15:53:20.974816 [debug] [Thread-4 (]: On test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "de_pipeline"."main_intermediate"."int_trip_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not trip_duration_minutes >= 1
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not trip_duration_minutes <= 720
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m15:53:20.976301 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:53:20.978045 [debug] [Thread-1 (]: On test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: ROLLBACK
[0m15:53:20.978480 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m15:53:20.979289 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574'
[0m15:53:20.980499 [debug] [Thread-4 (]: On test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: ROLLBACK
[0m15:53:20.980743 [debug] [Thread-1 (]: On test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: Close
[0m15:53:20.981587 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718'
[0m15:53:20.982070 [info ] [Thread-1 (]: 56 of 99 PASS dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0 ..... [[32mPASS[0m in 0.07s]
[0m15:53:20.982422 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m15:53:20.982922 [debug] [Thread-4 (]: On test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: Close
[0m15:53:20.983755 [debug] [Thread-1 (]: Finished running node test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m15:53:20.984262 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m15:53:20.984824 [debug] [Thread-3 (]: On test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed: BEGIN
[0m15:53:20.985555 [info ] [Thread-4 (]: 57 of 99 PASS dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1  [[32mPASS[0m in 0.08s]
[0m15:53:20.985944 [debug] [Thread-1 (]: Began running node test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m15:53:20.986462 [debug] [Thread-2 (]: On test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3: BEGIN
[0m15:53:20.986918 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:20.987588 [debug] [Thread-4 (]: Finished running node test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m15:53:20.988109 [info ] [Thread-1 (]: 60 of 99 START test not_null_int_trip_metrics_pickup_hour ...................... [RUN]
[0m15:53:20.988571 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:20.989500 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m15:53:20.990037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574, now test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082)
[0m15:53:20.991259 [info ] [Thread-4 (]: 61 of 99 START test not_null_int_trip_metrics_trip_duration_minutes ............ [RUN]
[0m15:53:20.991707 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m15:53:20.991983 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m15:53:20.992617 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718, now test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c)
[0m15:53:20.993073 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m15:53:20.996012 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m15:53:20.996438 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m15:53:20.996754 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m15:53:20.997015 [debug] [Thread-3 (]: On test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "de_pipeline"."main_intermediate"."int_trip_metrics"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m15:53:21.000329 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m15:53:21.000751 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m15:53:21.001641 [debug] [Thread-2 (]: On test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "de_pipeline"."main_intermediate"."int_trip_metrics"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m15:53:21.003255 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:53:21.003612 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:53:21.005143 [debug] [Thread-3 (]: On test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed: ROLLBACK
[0m15:53:21.006899 [debug] [Thread-2 (]: On test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3: ROLLBACK
[0m15:53:21.007704 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed'
[0m15:53:21.008601 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3'
[0m15:53:21.008893 [debug] [Thread-3 (]: On test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed: Close
[0m15:53:21.009458 [debug] [Thread-2 (]: On test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3: Close
[0m15:53:21.010769 [info ] [Thread-3 (]: 58 of 99 PASS not_null_int_trip_metrics_is_weekend ............................. [[32mPASS[0m in 0.06s]
[0m15:53:21.011993 [debug] [Thread-3 (]: Finished running node test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m15:53:21.011493 [info ] [Thread-2 (]: 59 of 99 PASS not_null_int_trip_metrics_pickup_date ............................ [[32mPASS[0m in 0.06s]
[0m15:53:21.012480 [debug] [Thread-3 (]: Began running node test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m15:53:21.013185 [debug] [Thread-2 (]: Finished running node test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m15:53:21.013758 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m15:53:21.014120 [info ] [Thread-3 (]: 62 of 99 START test not_null_int_trip_metrics_trip_id .......................... [RUN]
[0m15:53:21.014833 [debug] [Thread-2 (]: Began running node model.de_pipeline.dim_vendors
[0m15:53:21.015298 [debug] [Thread-1 (]: Began executing node test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m15:53:21.017470 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m15:53:21.018254 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_int_trip_metrics_is_weekend.d4657ab4ed, now test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f)
[0m15:53:21.019109 [info ] [Thread-2 (]: 63 of 99 START sql table model main_marts.dim_vendors .......................... [RUN]
[0m15:53:21.023063 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m15:53:21.024062 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m15:53:21.024644 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_int_trip_metrics_pickup_date.f3d690f1e3, now model.de_pipeline.dim_vendors)
[0m15:53:21.029105 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m15:53:21.029863 [debug] [Thread-2 (]: Began compiling node model.de_pipeline.dim_vendors
[0m15:53:21.032883 [debug] [Thread-2 (]: Writing injected SQL for node "model.de_pipeline.dim_vendors"
[0m15:53:21.041131 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m15:53:21.041622 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m15:53:21.041949 [debug] [Thread-1 (]: On test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082: BEGIN
[0m15:53:21.042400 [debug] [Thread-4 (]: On test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: BEGIN
[0m15:53:21.042862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:21.043381 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:21.044148 [debug] [Thread-3 (]: Began executing node test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m15:53:21.046100 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m15:53:21.046557 [debug] [Thread-2 (]: Began executing node model.de_pipeline.dim_vendors
[0m15:53:21.049123 [debug] [Thread-2 (]: Writing runtime sql for node "model.de_pipeline.dim_vendors"
[0m15:53:21.050194 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:53:21.050767 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m15:53:21.051205 [debug] [Thread-1 (]: On test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "de_pipeline"."main_intermediate"."int_trip_metrics"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m15:53:21.052250 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m15:53:21.052715 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m15:53:21.053093 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.053338 [debug] [Thread-4 (]: On test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_duration_minutes
from "de_pipeline"."main_intermediate"."int_trip_metrics"
where trip_duration_minutes is null



  
  
      
    ) dbt_internal_test
[0m15:53:21.054621 [debug] [Thread-1 (]: On test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082: ROLLBACK
[0m15:53:21.056339 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082'
[0m15:53:21.056733 [debug] [Thread-1 (]: On test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082: Close
[0m15:53:21.057288 [info ] [Thread-1 (]: 60 of 99 PASS not_null_int_trip_metrics_pickup_hour ............................ [[32mPASS[0m in 0.07s]
[0m15:53:21.057812 [debug] [Thread-1 (]: Finished running node test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m15:53:21.059274 [debug] [Thread-1 (]: Began running node model.de_pipeline.dim_payment_types
[0m15:53:21.060674 [info ] [Thread-1 (]: 64 of 99 START sql table model main_marts.dim_payment_types .................... [RUN]
[0m15:53:21.061048 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m15:53:21.061418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_int_trip_metrics_pickup_hour.8a05fd6082, now model.de_pipeline.dim_payment_types)
[0m15:53:21.062977 [debug] [Thread-4 (]: On test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: ROLLBACK
[0m15:53:21.063385 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m15:53:21.064194 [debug] [Thread-1 (]: Began compiling node model.de_pipeline.dim_payment_types
[0m15:53:21.065433 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.dim_vendors"
[0m15:53:21.066779 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c'
[0m15:53:21.067337 [debug] [Thread-3 (]: On test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f: BEGIN
[0m15:53:21.069787 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_pipeline.dim_payment_types"
[0m15:53:21.070350 [debug] [Thread-2 (]: On model.de_pipeline.dim_vendors: BEGIN
[0m15:53:21.070845 [debug] [Thread-4 (]: On test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: Close
[0m15:53:21.071342 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:21.072114 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:21.072812 [info ] [Thread-4 (]: 61 of 99 PASS not_null_int_trip_metrics_trip_duration_minutes .................. [[32mPASS[0m in 0.08s]
[0m15:53:21.074542 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m15:53:21.075085 [debug] [Thread-4 (]: Began running node model.de_pipeline.dim_locations
[0m15:53:21.075618 [info ] [Thread-4 (]: 65 of 99 START sql table model main_marts.dim_locations ........................ [RUN]
[0m15:53:21.076266 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c, now model.de_pipeline.dim_locations)
[0m15:53:21.076659 [debug] [Thread-4 (]: Began compiling node model.de_pipeline.dim_locations
[0m15:53:21.078932 [debug] [Thread-4 (]: Writing injected SQL for node "model.de_pipeline.dim_locations"
[0m15:53:21.079728 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m15:53:21.080212 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m15:53:21.080619 [debug] [Thread-3 (]: On test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "de_pipeline"."main_intermediate"."int_trip_metrics"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m15:53:21.081427 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m15:53:21.081876 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.dim_vendors"
[0m15:53:21.082304 [debug] [Thread-2 (]: On model.de_pipeline.dim_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_vendors"} */

  
    
    

    create  table
      "de_pipeline"."main_marts"."dim_vendors__dbt_tmp"
  
    as (
      /*
    Dimension table: Taxi vendor descriptions.
    TPEP provider: 1=Creative Mobile Technologies (CMT), 2=VeriFone Inc. (VFI)
*/

with vendors as (
    select * from "de_pipeline"."main_staging"."stg_vendors"
),

final as (
    select
        vendor_id,
        vendor_name,
        vendor_abbr
    from vendors
)

select * from final
    );
  
  
[0m15:53:21.082622 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:53:21.084151 [debug] [Thread-3 (]: On test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f: ROLLBACK
[0m15:53:21.084475 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:53:21.085142 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f'
[0m15:53:21.085858 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.dim_vendors"
[0m15:53:21.086339 [debug] [Thread-3 (]: On test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f: Close
[0m15:53:21.086796 [debug] [Thread-2 (]: On model.de_pipeline.dim_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_vendors"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'dim_vendors'
  
[0m15:53:21.087581 [info ] [Thread-3 (]: 62 of 99 PASS not_null_int_trip_metrics_trip_id ................................ [[32mPASS[0m in 0.07s]
[0m15:53:21.088386 [debug] [Thread-3 (]: Finished running node test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m15:53:21.088655 [debug] [Thread-1 (]: Began executing node model.de_pipeline.dim_payment_types
[0m15:53:21.089215 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.089635 [debug] [Thread-3 (]: Began running node model.de_pipeline.int_daily_summary
[0m15:53:21.092642 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.dim_payment_types"
[0m15:53:21.093087 [debug] [Thread-4 (]: Began executing node model.de_pipeline.dim_locations
[0m15:53:21.094024 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.dim_vendors"
[0m15:53:21.094609 [info ] [Thread-3 (]: 66 of 99 START sql view model main_intermediate.int_daily_summary .............. [RUN]
[0m15:53:21.095204 [debug] [Thread-1 (]: On model.de_pipeline.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_payment_types"} */
DESCRIBE (select * from (
        /*
    Dimension table: Payment type descriptions.
*/

with payment_types as (
    select * from "de_pipeline"."main_staging"."stg_payment_types"
),

final as (
    select
        payment_type_id,
        payment_type_name
    from payment_types
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m15:53:21.099304 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.dim_locations"
[0m15:53:21.099851 [debug] [Thread-2 (]: On model.de_pipeline.dim_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_vendors"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'dim_vendors'
  
[0m15:53:21.100370 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_int_trip_metrics_trip_id.1101f7bb5f, now model.de_pipeline.int_daily_summary)
[0m15:53:21.100864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:21.101390 [debug] [Thread-4 (]: On model.de_pipeline.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_locations"} */
DESCRIBE (select * from (
        /*
    Dimension table: TLC Taxi Zone locations.
*/

with zones as (
    select * from "de_pipeline"."main_staging"."stg_taxi_zones"
),

final as (
    select
        location_id,
        borough,
        zone_name,
        service_zone
    from zones
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m15:53:21.102243 [debug] [Thread-3 (]: Began compiling node model.de_pipeline.int_daily_summary
[0m15:53:21.102742 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.105309 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:21.113912 [debug] [Thread-3 (]: Writing injected SQL for node "model.de_pipeline.int_daily_summary"
[0m15:53:21.116997 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.dim_vendors"
[0m15:53:21.117283 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m15:53:21.119592 [debug] [Thread-2 (]: On model.de_pipeline.dim_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_vendors"} */
alter table "de_pipeline"."main_marts"."dim_vendors" rename to "dim_vendors__dbt_backup"
[0m15:53:21.121465 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.dim_payment_types"
[0m15:53:21.122125 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m15:53:21.122401 [debug] [Thread-1 (]: On model.de_pipeline.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_payment_types"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as payment_type_id, 
      
    cast(null as varchar)
 as payment_type_name
    ) as __dbt_sbq
    where false
    limit 0
)
[0m15:53:21.122831 [debug] [Thread-4 (]: SQL status: OK in 0.019 seconds
[0m15:53:21.124801 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.dim_vendors"
[0m15:53:21.126348 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.dim_locations"
[0m15:53:21.126952 [debug] [Thread-2 (]: On model.de_pipeline.dim_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_vendors"} */
alter table "de_pipeline"."main_marts"."dim_vendors__dbt_tmp" rename to "dim_vendors"
[0m15:53:21.128364 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:53:21.129587 [debug] [Thread-4 (]: On model.de_pipeline.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_locations"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as location_id, 
      
    cast(null as varchar)
 as borough, 
      
    cast(null as varchar)
 as zone_name, 
      
    cast(null as varchar)
 as service_zone
    ) as __dbt_sbq
    where false
    limit 0
)
[0m15:53:21.135701 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m15:53:21.136225 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_pipeline.dim_payment_types"
[0m15:53:21.137374 [debug] [Thread-2 (]: On model.de_pipeline.dim_vendors: COMMIT
[0m15:53:21.137711 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:53:21.138317 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.dim_vendors"
[0m15:53:21.138959 [debug] [Thread-2 (]: On model.de_pipeline.dim_vendors: COMMIT
[0m15:53:21.139232 [debug] [Thread-3 (]: Began executing node model.de_pipeline.int_daily_summary
[0m15:53:21.140258 [debug] [Thread-4 (]: Writing runtime sql for node "model.de_pipeline.dim_locations"
[0m15:53:21.142830 [debug] [Thread-3 (]: Writing runtime sql for node "model.de_pipeline.int_daily_summary"
[0m15:53:21.143917 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:53:21.145716 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.dim_vendors"
[0m15:53:21.146171 [debug] [Thread-2 (]: On model.de_pipeline.dim_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_vendors"} */

      drop table if exists "de_pipeline"."main_marts"."dim_vendors__dbt_backup" cascade
    
[0m15:53:21.149103 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:53:21.150348 [debug] [Thread-2 (]: On model.de_pipeline.dim_vendors: Close
[0m15:53:21.151016 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e112fb35-b2dd-4364-a6cd-45ba3ff28547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca5896cb30>]}
[0m15:53:21.151697 [info ] [Thread-2 (]: 63 of 99 OK created sql table model main_marts.dim_vendors ..................... [[32mOK[0m in 0.13s]
[0m15:53:21.152019 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.dim_payment_types"
[0m15:53:21.152620 [debug] [Thread-2 (]: Finished running node model.de_pipeline.dim_vendors
[0m15:53:21.153047 [debug] [Thread-1 (]: On model.de_pipeline.dim_payment_types: BEGIN
[0m15:53:21.153376 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.dim_locations"
[0m15:53:21.153654 [debug] [Thread-2 (]: Began running node model.de_pipeline.int_hourly_patterns
[0m15:53:21.154388 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:53:21.154658 [debug] [Thread-4 (]: On model.de_pipeline.dim_locations: BEGIN
[0m15:53:21.155234 [info ] [Thread-2 (]: 67 of 99 START sql view model main_intermediate.int_hourly_patterns ............ [RUN]
[0m15:53:21.155676 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.dim_payment_types"
[0m15:53:21.156387 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m15:53:21.156756 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.de_pipeline.dim_vendors, now model.de_pipeline.int_hourly_patterns)
[0m15:53:21.157653 [debug] [Thread-1 (]: On model.de_pipeline.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_payment_types"} */

  
    
    
      
    

    create  table
      "de_pipeline"."main_marts"."dim_payment_types__dbt_tmp"
  
  (
    payment_type_id integer,
    payment_type_name varchar
    
    )
 ;
    insert into "de_pipeline"."main_marts"."dim_payment_types__dbt_tmp" 
  (
    
      
      payment_type_id ,
    
      
      payment_type_name 
    
  )
 (
      
    select payment_type_id, payment_type_name
    from (
        /*
    Dimension table: Payment type descriptions.
*/

with payment_types as (
    select * from "de_pipeline"."main_staging"."stg_payment_types"
),

final as (
    select
        payment_type_id,
        payment_type_name
    from payment_types
)

select * from final
    ) as model_subq
    );
  
  
[0m15:53:21.158827 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.int_daily_summary"
[0m15:53:21.159157 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.dim_locations"
[0m15:53:21.159693 [debug] [Thread-2 (]: Began compiling node model.de_pipeline.int_hourly_patterns
[0m15:53:21.160590 [debug] [Thread-3 (]: On model.de_pipeline.int_daily_summary: BEGIN
[0m15:53:21.160965 [debug] [Thread-4 (]: On model.de_pipeline.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_locations"} */

  
    
    
      
    

    create  table
      "de_pipeline"."main_marts"."dim_locations__dbt_tmp"
  
  (
    location_id integer,
    borough varchar,
    zone_name varchar,
    service_zone varchar
    
    )
 ;
    insert into "de_pipeline"."main_marts"."dim_locations__dbt_tmp" 
  (
    
      
      location_id ,
    
      
      borough ,
    
      
      zone_name ,
    
      
      service_zone 
    
  )
 (
      
    select location_id, borough, zone_name, service_zone
    from (
        /*
    Dimension table: TLC Taxi Zone locations.
*/

with zones as (
    select * from "de_pipeline"."main_staging"."stg_taxi_zones"
),

final as (
    select
        location_id,
        borough,
        zone_name,
        service_zone
    from zones
)

select * from final
    ) as model_subq
    );
  
  
[0m15:53:21.166643 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:53:21.165667 [debug] [Thread-2 (]: Writing injected SQL for node "model.de_pipeline.int_hourly_patterns"
[0m15:53:21.167040 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:21.170836 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.dim_payment_types"
[0m15:53:21.171973 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m15:53:21.172314 [debug] [Thread-1 (]: On model.de_pipeline.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_payment_types"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'dim_payment_types'
  
[0m15:53:21.173273 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.dim_locations"
[0m15:53:21.174196 [debug] [Thread-4 (]: On model.de_pipeline.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_locations"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'dim_locations'
  
[0m15:53:21.174533 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.175789 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.dim_payment_types"
[0m15:53:21.176076 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.176422 [debug] [Thread-1 (]: On model.de_pipeline.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_payment_types"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'dim_payment_types'
  
[0m15:53:21.176722 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m15:53:21.177527 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.dim_locations"
[0m15:53:21.177983 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.int_daily_summary"
[0m15:53:21.178443 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.178806 [debug] [Thread-4 (]: On model.de_pipeline.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_locations"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'dim_locations'
  
[0m15:53:21.179239 [debug] [Thread-3 (]: On model.de_pipeline.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.int_daily_summary"} */

  
  create view "de_pipeline"."main_intermediate"."int_daily_summary__dbt_tmp" as (
    /*
    Intermediate model: Daily aggregated trip and revenue metrics.
    One row per day with counts, averages, and revenue totals.
*/

with trip_metrics as (
    select * from "de_pipeline"."main_intermediate"."int_trip_metrics"
),

daily_agg as (
    select
        pickup_date,
        pickup_day_of_week,
        is_weekend,

        count(*) as total_trips,
        sum(passenger_count) as total_passengers,

        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(avg(avg_speed_mph), 2) as avg_speed_mph,

        round(sum(fare_amount), 2) as total_fare_revenue,
        round(sum(tip_amount), 2) as total_tip_revenue,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_trip_revenue,
        round(avg(tip_percentage), 2) as avg_tip_percentage,

        count(case when payment_type_id = 1 then 1 end) as credit_card_trips,
        count(case when payment_type_id = 2 then 1 end) as cash_trips

    from trip_metrics
    group by pickup_date, pickup_day_of_week, is_weekend
)

select * from daily_agg
  );

[0m15:53:21.182022 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.dim_payment_types"
[0m15:53:21.183200 [debug] [Thread-1 (]: On model.de_pipeline.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_payment_types"} */
alter table "de_pipeline"."main_marts"."dim_payment_types" rename to "dim_payment_types__dbt_backup"
[0m15:53:21.183543 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.184204 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:53:21.187821 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.dim_locations"
[0m15:53:21.188100 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m15:53:21.189817 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.dim_payment_types"
[0m15:53:21.190105 [debug] [Thread-2 (]: Began executing node model.de_pipeline.int_hourly_patterns
[0m15:53:21.190598 [debug] [Thread-4 (]: On model.de_pipeline.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_locations"} */
alter table "de_pipeline"."main_marts"."dim_locations" rename to "dim_locations__dbt_backup"
[0m15:53:21.202337 [debug] [Thread-1 (]: On model.de_pipeline.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_payment_types"} */
alter table "de_pipeline"."main_marts"."dim_payment_types__dbt_tmp" rename to "dim_payment_types"
[0m15:53:21.203203 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.int_daily_summary"
[0m15:53:21.205892 [debug] [Thread-2 (]: Writing runtime sql for node "model.de_pipeline.int_hourly_patterns"
[0m15:53:21.207065 [debug] [Thread-3 (]: On model.de_pipeline.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.int_daily_summary"} */
alter view "de_pipeline"."main_intermediate"."int_daily_summary" rename to "int_daily_summary__dbt_backup"
[0m15:53:21.207435 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.207750 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.210408 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.dim_locations"
[0m15:53:21.210972 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m15:53:21.212057 [debug] [Thread-1 (]: On model.de_pipeline.dim_payment_types: COMMIT
[0m15:53:21.212829 [debug] [Thread-4 (]: On model.de_pipeline.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_locations"} */
alter table "de_pipeline"."main_marts"."dim_locations__dbt_tmp" rename to "dim_locations"
[0m15:53:21.215053 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.int_daily_summary"
[0m15:53:21.215498 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.dim_payment_types"
[0m15:53:21.216403 [debug] [Thread-3 (]: On model.de_pipeline.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.int_daily_summary"} */
alter view "de_pipeline"."main_intermediate"."int_daily_summary__dbt_tmp" rename to "int_daily_summary"
[0m15:53:21.216832 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.217052 [debug] [Thread-1 (]: On model.de_pipeline.dim_payment_types: COMMIT
[0m15:53:21.218627 [debug] [Thread-4 (]: On model.de_pipeline.dim_locations: COMMIT
[0m15:53:21.218960 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.219972 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.dim_locations"
[0m15:53:21.221151 [debug] [Thread-3 (]: On model.de_pipeline.int_daily_summary: COMMIT
[0m15:53:21.221781 [debug] [Thread-4 (]: On model.de_pipeline.dim_locations: COMMIT
[0m15:53:21.222591 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.int_daily_summary"
[0m15:53:21.223424 [debug] [Thread-3 (]: On model.de_pipeline.int_daily_summary: COMMIT
[0m15:53:21.224386 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.int_hourly_patterns"
[0m15:53:21.224746 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:53:21.225034 [debug] [Thread-2 (]: On model.de_pipeline.int_hourly_patterns: BEGIN
[0m15:53:21.227066 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.dim_payment_types"
[0m15:53:21.228039 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:21.228499 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m15:53:21.228777 [debug] [Thread-1 (]: On model.de_pipeline.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_payment_types"} */

      drop table if exists "de_pipeline"."main_marts"."dim_payment_types__dbt_backup" cascade
    
[0m15:53:21.232144 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.dim_locations"
[0m15:53:21.232510 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m15:53:21.233994 [debug] [Thread-4 (]: On model.de_pipeline.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.dim_locations"} */

      drop table if exists "de_pipeline"."main_marts"."dim_locations__dbt_backup" cascade
    
[0m15:53:21.235220 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:53:21.236683 [debug] [Thread-3 (]: Using duckdb connection "model.de_pipeline.int_daily_summary"
[0m15:53:21.237527 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m15:53:21.238530 [debug] [Thread-1 (]: On model.de_pipeline.dim_payment_types: Close
[0m15:53:21.238920 [debug] [Thread-3 (]: On model.de_pipeline.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.int_daily_summary"} */

      drop view if exists "de_pipeline"."main_intermediate"."int_daily_summary__dbt_backup" cascade
    
[0m15:53:21.239384 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.int_hourly_patterns"
[0m15:53:21.240177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e112fb35-b2dd-4364-a6cd-45ba3ff28547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca7674a090>]}
[0m15:53:21.241237 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m15:53:21.241560 [debug] [Thread-2 (]: On model.de_pipeline.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.int_hourly_patterns"} */

  
  create view "de_pipeline"."main_intermediate"."int_hourly_patterns__dbt_tmp" as (
    /*
    Intermediate model: Hourly trip patterns by date.
    One row per date + hour combination.
*/

with trip_metrics as (
    select * from "de_pipeline"."main_intermediate"."int_trip_metrics"
),

hourly_agg as (
    select
        pickup_date,
        pickup_hour,
        pickup_day_of_week,
        is_weekend,

        count(*) as total_trips,
        round(avg(trip_distance_miles), 2) as avg_distance,
        round(avg(trip_duration_minutes), 2) as avg_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue

    from trip_metrics
    group by pickup_date, pickup_hour, pickup_day_of_week, is_weekend
)

select * from hourly_agg
  );

[0m15:53:21.242201 [info ] [Thread-1 (]: 64 of 99 OK created sql table model main_marts.dim_payment_types ............... [[32mOK[0m in 0.18s]
[0m15:53:21.243644 [debug] [Thread-4 (]: On model.de_pipeline.dim_locations: Close
[0m15:53:21.243948 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m15:53:21.244640 [debug] [Thread-1 (]: Finished running node model.de_pipeline.dim_payment_types
[0m15:53:21.245314 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e112fb35-b2dd-4364-a6cd-45ba3ff28547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca76749a00>]}
[0m15:53:21.246207 [debug] [Thread-3 (]: On model.de_pipeline.int_daily_summary: Close
[0m15:53:21.246531 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:53:21.247329 [info ] [Thread-4 (]: 65 of 99 OK created sql table model main_marts.dim_locations ................... [[32mOK[0m in 0.17s]
[0m15:53:21.247698 [debug] [Thread-1 (]: Began running node test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10
[0m15:53:21.248267 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e112fb35-b2dd-4364-a6cd-45ba3ff28547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca7675f110>]}
[0m15:53:21.255962 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.int_hourly_patterns"
[0m15:53:21.258826 [debug] [Thread-4 (]: Finished running node model.de_pipeline.dim_locations
[0m15:53:21.260413 [info ] [Thread-1 (]: 68 of 99 START test not_null_dim_payment_types_payment_type_id ................. [RUN]
[0m15:53:21.261063 [info ] [Thread-3 (]: 66 of 99 OK created sql view model main_intermediate.int_daily_summary ......... [[32mOK[0m in 0.15s]
[0m15:53:21.261507 [debug] [Thread-2 (]: On model.de_pipeline.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.int_hourly_patterns"} */
alter view "de_pipeline"."main_intermediate"."int_hourly_patterns" rename to "int_hourly_patterns__dbt_backup"
[0m15:53:21.261990 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m15:53:21.262568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_pipeline.dim_payment_types, now test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10)
[0m15:53:21.263428 [debug] [Thread-3 (]: Finished running node model.de_pipeline.int_daily_summary
[0m15:53:21.264213 [info ] [Thread-4 (]: 69 of 99 START test not_null_dim_payment_types_payment_type_name ............... [RUN]
[0m15:53:21.264671 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.265330 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10
[0m15:53:21.265891 [debug] [Thread-3 (]: Began running node test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62
[0m15:53:21.266479 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.de_pipeline.dim_locations, now test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0)
[0m15:53:21.268864 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.int_hourly_patterns"
[0m15:53:21.272079 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m15:53:21.272813 [info ] [Thread-3 (]: 70 of 99 START test unique_dim_payment_types_payment_type_id ................... [RUN]
[0m15:53:21.274527 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m15:53:21.275814 [debug] [Thread-2 (]: On model.de_pipeline.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.int_hourly_patterns"} */
alter view "de_pipeline"."main_intermediate"."int_hourly_patterns__dbt_tmp" rename to "int_hourly_patterns"
[0m15:53:21.276928 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.de_pipeline.int_daily_summary, now test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62)
[0m15:53:21.280199 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m15:53:21.281288 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62
[0m15:53:21.281618 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.284221 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m15:53:21.285379 [debug] [Thread-2 (]: On model.de_pipeline.int_hourly_patterns: COMMIT
[0m15:53:21.286088 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.int_hourly_patterns"
[0m15:53:21.286431 [debug] [Thread-2 (]: On model.de_pipeline.int_hourly_patterns: COMMIT
[0m15:53:21.289786 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:53:21.299646 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.int_hourly_patterns"
[0m15:53:21.301851 [debug] [Thread-2 (]: On model.de_pipeline.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.int_hourly_patterns"} */

      drop view if exists "de_pipeline"."main_intermediate"."int_hourly_patterns__dbt_backup" cascade
    
[0m15:53:21.304333 [debug] [Thread-1 (]: Began executing node test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10
[0m15:53:21.304787 [debug] [Thread-3 (]: Began executing node test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62
[0m15:53:21.306698 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m15:53:21.307220 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m15:53:21.307529 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:53:21.309069 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m15:53:21.310878 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m15:53:21.311909 [debug] [Thread-2 (]: On model.de_pipeline.int_hourly_patterns: Close
[0m15:53:21.312828 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e112fb35-b2dd-4364-a6cd-45ba3ff28547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac9fd344650>]}
[0m15:53:21.313368 [info ] [Thread-2 (]: 67 of 99 OK created sql view model main_intermediate.int_hourly_patterns ....... [[32mOK[0m in 0.16s]
[0m15:53:21.313859 [debug] [Thread-2 (]: Finished running node model.de_pipeline.int_hourly_patterns
[0m15:53:21.314252 [debug] [Thread-2 (]: Began running node test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af
[0m15:53:21.314827 [info ] [Thread-2 (]: 71 of 99 START test not_null_dim_locations_borough ............................. [RUN]
[0m15:53:21.315265 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.de_pipeline.int_hourly_patterns, now test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af)
[0m15:53:21.315597 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af
[0m15:53:21.319359 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af"
[0m15:53:21.323920 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m15:53:21.324392 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m15:53:21.324754 [debug] [Thread-3 (]: On test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62: BEGIN
[0m15:53:21.325134 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m15:53:21.325409 [debug] [Thread-4 (]: On test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0: BEGIN
[0m15:53:21.325830 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:21.326237 [debug] [Thread-1 (]: On test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10: BEGIN
[0m15:53:21.326607 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:21.327773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:21.331636 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m15:53:21.332181 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m15:53:21.332589 [debug] [Thread-3 (]: On test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "de_pipeline"."main_marts"."dim_payment_types"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:53:21.334076 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.334427 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m15:53:21.334826 [debug] [Thread-2 (]: Began executing node test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af
[0m15:53:21.336544 [debug] [Thread-3 (]: On test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62: ROLLBACK
[0m15:53:21.337054 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m15:53:21.339069 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af"
[0m15:53:21.339909 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62'
[0m15:53:21.340416 [debug] [Thread-4 (]: On test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_name
from "de_pipeline"."main_marts"."dim_payment_types"
where payment_type_name is null



  
  
      
    ) dbt_internal_test
[0m15:53:21.340731 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m15:53:21.341195 [debug] [Thread-3 (]: On test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62: Close
[0m15:53:21.341927 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m15:53:21.342502 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.343248 [info ] [Thread-3 (]: 70 of 99 PASS unique_dim_payment_types_payment_type_id ......................... [[32mPASS[0m in 0.07s]
[0m15:53:21.343575 [debug] [Thread-1 (]: On test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "de_pipeline"."main_marts"."dim_payment_types"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m15:53:21.344892 [debug] [Thread-4 (]: On test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0: ROLLBACK
[0m15:53:21.345484 [debug] [Thread-3 (]: Finished running node test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62
[0m15:53:21.346649 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0'
[0m15:53:21.347095 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.347446 [debug] [Thread-3 (]: Began running node test.de_pipeline.not_null_dim_locations_location_id.70b6875476
[0m15:53:21.347884 [debug] [Thread-4 (]: On test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0: Close
[0m15:53:21.349113 [debug] [Thread-1 (]: On test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10: ROLLBACK
[0m15:53:21.349420 [info ] [Thread-3 (]: 72 of 99 START test not_null_dim_locations_location_id ......................... [RUN]
[0m15:53:21.350138 [info ] [Thread-4 (]: 69 of 99 PASS not_null_dim_payment_types_payment_type_name ..................... [[32mPASS[0m in 0.08s]
[0m15:53:21.350806 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10'
[0m15:53:21.351255 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.unique_dim_payment_types_payment_type_id.24066a2d62, now test.de_pipeline.not_null_dim_locations_location_id.70b6875476)
[0m15:53:21.351751 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m15:53:21.352084 [debug] [Thread-1 (]: On test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10: Close
[0m15:53:21.352627 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.not_null_dim_locations_location_id.70b6875476
[0m15:53:21.353197 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d
[0m15:53:21.353912 [info ] [Thread-1 (]: 68 of 99 PASS not_null_dim_payment_types_payment_type_id ....................... [[32mPASS[0m in 0.09s]
[0m15:53:21.356867 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.not_null_dim_locations_location_id.70b6875476"
[0m15:53:21.357367 [info ] [Thread-4 (]: 73 of 99 START test not_null_dim_locations_zone_name ........................... [RUN]
[0m15:53:21.358019 [debug] [Thread-1 (]: Finished running node test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10
[0m15:53:21.360097 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_dim_payment_types_payment_type_name.1acd2a71b0, now test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d)
[0m15:53:21.361492 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af"
[0m15:53:21.362030 [debug] [Thread-1 (]: Began running node test.de_pipeline.unique_dim_locations_location_id.09f471618d
[0m15:53:21.362706 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d
[0m15:53:21.363210 [debug] [Thread-2 (]: On test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af: BEGIN
[0m15:53:21.363712 [info ] [Thread-1 (]: 74 of 99 START test unique_dim_locations_location_id ........................... [RUN]
[0m15:53:21.366881 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d"
[0m15:53:21.367471 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:21.368110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_dim_payment_types_payment_type_id.8406acab10, now test.de_pipeline.unique_dim_locations_location_id.09f471618d)
[0m15:53:21.369855 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.unique_dim_locations_location_id.09f471618d
[0m15:53:21.372901 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.unique_dim_locations_location_id.09f471618d"
[0m15:53:21.374203 [debug] [Thread-3 (]: Began executing node test.de_pipeline.not_null_dim_locations_location_id.70b6875476
[0m15:53:21.374500 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m15:53:21.376201 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.not_null_dim_locations_location_id.70b6875476"
[0m15:53:21.376749 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af"
[0m15:53:21.377520 [debug] [Thread-2 (]: On test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select borough
from "de_pipeline"."main_marts"."dim_locations"
where borough is null



  
  
      
    ) dbt_internal_test
[0m15:53:21.378599 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d
[0m15:53:21.379118 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.381246 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d"
[0m15:53:21.383318 [debug] [Thread-2 (]: On test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af: ROLLBACK
[0m15:53:21.383722 [debug] [Thread-1 (]: Began executing node test.de_pipeline.unique_dim_locations_location_id.09f471618d
[0m15:53:21.384512 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af'
[0m15:53:21.386404 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.unique_dim_locations_location_id.09f471618d"
[0m15:53:21.386968 [debug] [Thread-2 (]: On test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af: Close
[0m15:53:21.388166 [info ] [Thread-2 (]: 71 of 99 PASS not_null_dim_locations_borough ................................... [[32mPASS[0m in 0.07s]
[0m15:53:21.388894 [debug] [Thread-2 (]: Finished running node test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af
[0m15:53:21.389399 [debug] [Thread-2 (]: Began running node test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m15:53:21.389835 [info ] [Thread-2 (]: 75 of 99 START test dbt_utils_accepted_range_int_daily_summary_total_trips__0 .. [RUN]
[0m15:53:21.390369 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_dim_locations_borough.0b7e3fa5af, now test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863)
[0m15:53:21.390892 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m15:53:21.394114 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m15:53:21.395686 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_dim_locations_location_id.70b6875476"
[0m15:53:21.396040 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d"
[0m15:53:21.396291 [debug] [Thread-3 (]: On test.de_pipeline.not_null_dim_locations_location_id.70b6875476: BEGIN
[0m15:53:21.396692 [debug] [Thread-4 (]: On test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d: BEGIN
[0m15:53:21.397084 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:21.397626 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:21.399126 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.unique_dim_locations_location_id.09f471618d"
[0m15:53:21.399732 [debug] [Thread-1 (]: On test.de_pipeline.unique_dim_locations_location_id.09f471618d: BEGIN
[0m15:53:21.400084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:21.400989 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:53:21.401502 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_dim_locations_location_id.70b6875476"
[0m15:53:21.402214 [debug] [Thread-3 (]: On test.de_pipeline.not_null_dim_locations_location_id.70b6875476: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_dim_locations_location_id.70b6875476"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "de_pipeline"."main_marts"."dim_locations"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m15:53:21.403448 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m15:53:21.403784 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.404983 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d"
[0m15:53:21.407292 [debug] [Thread-3 (]: On test.de_pipeline.not_null_dim_locations_location_id.70b6875476: ROLLBACK
[0m15:53:21.407646 [debug] [Thread-4 (]: On test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select zone_name
from "de_pipeline"."main_marts"."dim_locations"
where zone_name is null



  
  
      
    ) dbt_internal_test
[0m15:53:21.408330 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m15:53:21.408969 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.not_null_dim_locations_location_id.70b6875476'
[0m15:53:21.409603 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.unique_dim_locations_location_id.09f471618d"
[0m15:53:21.409965 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.410203 [debug] [Thread-3 (]: On test.de_pipeline.not_null_dim_locations_location_id.70b6875476: Close
[0m15:53:21.410830 [debug] [Thread-1 (]: On test.de_pipeline.unique_dim_locations_location_id.09f471618d: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_dim_locations_location_id.09f471618d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "de_pipeline"."main_marts"."dim_locations"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:53:21.414849 [debug] [Thread-4 (]: On test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d: ROLLBACK
[0m15:53:21.416078 [info ] [Thread-3 (]: 72 of 99 PASS not_null_dim_locations_location_id ............................... [[32mPASS[0m in 0.06s]
[0m15:53:21.417210 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d'
[0m15:53:21.417524 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.417901 [debug] [Thread-3 (]: Finished running node test.de_pipeline.not_null_dim_locations_location_id.70b6875476
[0m15:53:21.418291 [debug] [Thread-4 (]: On test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d: Close
[0m15:53:21.419486 [debug] [Thread-1 (]: On test.de_pipeline.unique_dim_locations_location_id.09f471618d: ROLLBACK
[0m15:53:21.420701 [debug] [Thread-3 (]: Began running node test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686
[0m15:53:21.422008 [info ] [Thread-4 (]: 73 of 99 PASS not_null_dim_locations_zone_name ................................. [[32mPASS[0m in 0.06s]
[0m15:53:21.422705 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.unique_dim_locations_location_id.09f471618d'
[0m15:53:21.423359 [info ] [Thread-3 (]: 76 of 99 START test not_null_int_daily_summary_pickup_date ..................... [RUN]
[0m15:53:21.424202 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d
[0m15:53:21.424932 [debug] [Thread-1 (]: On test.de_pipeline.unique_dim_locations_location_id.09f471618d: Close
[0m15:53:21.425545 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_dim_locations_location_id.70b6875476, now test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686)
[0m15:53:21.426014 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m15:53:21.427057 [info ] [Thread-1 (]: 74 of 99 PASS unique_dim_locations_location_id ................................. [[32mPASS[0m in 0.06s]
[0m15:53:21.427434 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686
[0m15:53:21.428012 [info ] [Thread-4 (]: 77 of 99 START test not_null_int_daily_summary_total_revenue ................... [RUN]
[0m15:53:21.428603 [debug] [Thread-1 (]: Finished running node test.de_pipeline.unique_dim_locations_location_id.09f471618d
[0m15:53:21.433424 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m15:53:21.434131 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_dim_locations_zone_name.612cdedf7d, now test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50)
[0m15:53:21.434798 [debug] [Thread-1 (]: Began running node test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10
[0m15:53:21.435507 [debug] [Thread-2 (]: Began executing node test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m15:53:21.435802 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m15:53:21.436366 [info ] [Thread-1 (]: 78 of 99 START test not_null_int_daily_summary_total_trips ..................... [RUN]
[0m15:53:21.438249 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m15:53:21.441456 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m15:53:21.442103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.unique_dim_locations_location_id.09f471618d, now test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10)
[0m15:53:21.443391 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10
[0m15:53:21.446404 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10"
[0m15:53:21.449384 [debug] [Thread-3 (]: Began executing node test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686
[0m15:53:21.451266 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m15:53:21.452463 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m15:53:21.454395 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m15:53:21.456382 [debug] [Thread-1 (]: Began executing node test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10
[0m15:53:21.456935 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m15:53:21.459443 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10"
[0m15:53:21.460053 [debug] [Thread-2 (]: On test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: BEGIN
[0m15:53:21.460886 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:21.461237 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m15:53:21.462037 [debug] [Thread-3 (]: On test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686: BEGIN
[0m15:53:21.462603 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:21.463594 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m15:53:21.464852 [debug] [Thread-4 (]: On test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50: BEGIN
[0m15:53:21.467707 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:21.469708 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m15:53:21.470581 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m15:53:21.471293 [debug] [Thread-2 (]: On test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "de_pipeline"."main_intermediate"."int_daily_summary"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_trips >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m15:53:21.472264 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10"
[0m15:53:21.472633 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m15:53:21.473014 [debug] [Thread-1 (]: On test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10: BEGIN
[0m15:53:21.473903 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m15:53:21.475903 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m15:53:21.477997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:21.478605 [debug] [Thread-3 (]: On test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "de_pipeline"."main_intermediate"."int_daily_summary"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m15:53:21.479063 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m15:53:21.479629 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m15:53:21.481756 [debug] [Thread-2 (]: On test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: ROLLBACK
[0m15:53:21.483386 [debug] [Thread-4 (]: On test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "de_pipeline"."main_intermediate"."int_daily_summary"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m15:53:21.485004 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m15:53:21.489020 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863'
[0m15:53:21.491878 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m15:53:21.493262 [debug] [Thread-3 (]: On test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686: ROLLBACK
[0m15:53:21.493536 [debug] [Thread-2 (]: On test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: Close
[0m15:53:21.494001 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10"
[0m15:53:21.494829 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686'
[0m15:53:21.495497 [info ] [Thread-2 (]: 75 of 99 PASS dbt_utils_accepted_range_int_daily_summary_total_trips__0 ........ [[32mPASS[0m in 0.11s]
[0m15:53:21.495836 [debug] [Thread-1 (]: On test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_trips
from "de_pipeline"."main_intermediate"."int_daily_summary"
where total_trips is null



  
  
      
    ) dbt_internal_test
[0m15:53:21.496280 [debug] [Thread-3 (]: On test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686: Close
[0m15:53:21.496836 [debug] [Thread-2 (]: Finished running node test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m15:53:21.497777 [info ] [Thread-3 (]: 76 of 99 PASS not_null_int_daily_summary_pickup_date ........................... [[32mPASS[0m in 0.07s]
[0m15:53:21.498104 [debug] [Thread-2 (]: Began running node test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e
[0m15:53:21.498936 [debug] [Thread-3 (]: Finished running node test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686
[0m15:53:21.499439 [info ] [Thread-2 (]: 79 of 99 START test unique_int_daily_summary_pickup_date ....................... [RUN]
[0m15:53:21.500030 [debug] [Thread-3 (]: Began running node test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m15:53:21.500797 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863, now test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e)
[0m15:53:21.501295 [info ] [Thread-3 (]: 80 of 99 START test dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0  [RUN]
[0m15:53:21.501764 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e
[0m15:53:21.502412 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_int_daily_summary_pickup_date.b3f7570686, now test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe)
[0m15:53:21.502812 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:53:21.505995 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m15:53:21.506470 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m15:53:21.507272 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m15:53:21.509031 [debug] [Thread-1 (]: On test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10: ROLLBACK
[0m15:53:21.510232 [debug] [Thread-4 (]: On test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50: ROLLBACK
[0m15:53:21.513282 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m15:53:21.514242 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10'
[0m15:53:21.515133 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50'
[0m15:53:21.516051 [debug] [Thread-1 (]: On test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10: Close
[0m15:53:21.516550 [debug] [Thread-4 (]: On test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50: Close
[0m15:53:21.517301 [info ] [Thread-1 (]: 78 of 99 PASS not_null_int_daily_summary_total_trips ........................... [[32mPASS[0m in 0.08s]
[0m15:53:21.517845 [info ] [Thread-4 (]: 77 of 99 PASS not_null_int_daily_summary_total_revenue ......................... [[32mPASS[0m in 0.08s]
[0m15:53:21.518248 [debug] [Thread-1 (]: Finished running node test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10
[0m15:53:21.518927 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m15:53:21.519455 [debug] [Thread-1 (]: Began running node test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m15:53:21.519914 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m15:53:21.520305 [info ] [Thread-1 (]: 81 of 99 START test not_null_int_hourly_patterns_pickup_date ................... [RUN]
[0m15:53:21.520839 [info ] [Thread-4 (]: 82 of 99 START test not_null_int_hourly_patterns_pickup_hour ................... [RUN]
[0m15:53:21.521412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_int_daily_summary_total_trips.0365021a10, now test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2)
[0m15:53:21.521910 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_int_daily_summary_total_revenue.3b1f27ad50, now test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d)
[0m15:53:21.522399 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m15:53:21.522879 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m15:53:21.527410 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m15:53:21.530318 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m15:53:21.531854 [debug] [Thread-3 (]: Began executing node test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m15:53:21.532205 [debug] [Thread-2 (]: Began executing node test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e
[0m15:53:21.533879 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m15:53:21.535786 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m15:53:21.540155 [debug] [Thread-1 (]: Began executing node test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m15:53:21.542399 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m15:53:21.542907 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m15:53:21.551593 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m15:53:21.553246 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m15:53:21.553666 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m15:53:21.554051 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m15:53:21.554421 [debug] [Thread-3 (]: On test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: BEGIN
[0m15:53:21.555056 [debug] [Thread-2 (]: On test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e: BEGIN
[0m15:53:21.555576 [debug] [Thread-1 (]: On test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2: BEGIN
[0m15:53:21.556286 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:21.557089 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:21.557725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:21.560879 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:53:21.561665 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m15:53:21.562415 [debug] [Thread-3 (]: On test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "de_pipeline"."main_intermediate"."int_hourly_patterns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m15:53:21.563557 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m15:53:21.564078 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m15:53:21.564392 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m15:53:21.564938 [debug] [Thread-4 (]: On test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: BEGIN
[0m15:53:21.566114 [debug] [Thread-2 (]: On test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pickup_date as unique_field,
    count(*) as n_records

from "de_pipeline"."main_intermediate"."int_daily_summary"
where pickup_date is not null
group by pickup_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:53:21.566525 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m15:53:21.566852 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:21.569479 [debug] [Thread-3 (]: On test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: ROLLBACK
[0m15:53:21.570618 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe'
[0m15:53:21.571097 [debug] [Thread-3 (]: On test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: Close
[0m15:53:21.571584 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m15:53:21.572365 [info ] [Thread-3 (]: 80 of 99 PASS dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0 .. [[32mPASS[0m in 0.07s]
[0m15:53:21.572943 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m15:53:21.573403 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m15:53:21.574164 [debug] [Thread-3 (]: Finished running node test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m15:53:21.574893 [debug] [Thread-1 (]: On test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "de_pipeline"."main_intermediate"."int_hourly_patterns"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m15:53:21.575229 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m15:53:21.576866 [debug] [Thread-2 (]: On test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e: ROLLBACK
[0m15:53:21.577297 [debug] [Thread-3 (]: Began running node test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m15:53:21.578172 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m15:53:21.579048 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e'
[0m15:53:21.579764 [info ] [Thread-3 (]: 83 of 99 START test not_null_int_hourly_patterns_total_trips ................... [RUN]
[0m15:53:21.580162 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:53:21.580515 [debug] [Thread-4 (]: On test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "de_pipeline"."main_intermediate"."int_hourly_patterns"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m15:53:21.581137 [debug] [Thread-2 (]: On test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e: Close
[0m15:53:21.581734 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe, now test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf)
[0m15:53:21.583149 [debug] [Thread-1 (]: On test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2: ROLLBACK
[0m15:53:21.584244 [info ] [Thread-2 (]: 79 of 99 PASS unique_int_daily_summary_pickup_date ............................. [[32mPASS[0m in 0.08s]
[0m15:53:21.584595 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m15:53:21.585548 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2'
[0m15:53:21.586865 [debug] [Thread-2 (]: Finished running node test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e
[0m15:53:21.587260 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m15:53:21.590518 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m15:53:21.591079 [debug] [Thread-1 (]: On test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2: Close
[0m15:53:21.592047 [debug] [Thread-2 (]: Began running node model.de_pipeline.fct_trips
[0m15:53:21.600931 [debug] [Thread-4 (]: On test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: ROLLBACK
[0m15:53:21.603881 [info ] [Thread-1 (]: 81 of 99 PASS not_null_int_hourly_patterns_pickup_date ......................... [[32mPASS[0m in 0.08s]
[0m15:53:21.604333 [info ] [Thread-2 (]: 84 of 99 START sql incremental model main_marts.fct_trips ...................... [RUN]
[0m15:53:21.605799 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d'
[0m15:53:21.606455 [debug] [Thread-1 (]: Finished running node test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m15:53:21.606988 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.unique_int_daily_summary_pickup_date.b93ee4526e, now model.de_pipeline.fct_trips)
[0m15:53:21.607519 [debug] [Thread-4 (]: On test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: Close
[0m15:53:21.608013 [debug] [Thread-1 (]: Began running node model.de_pipeline.mart_daily_revenue
[0m15:53:21.608539 [debug] [Thread-2 (]: Began compiling node model.de_pipeline.fct_trips
[0m15:53:21.609331 [info ] [Thread-4 (]: 82 of 99 PASS not_null_int_hourly_patterns_pickup_hour ......................... [[32mPASS[0m in 0.09s]
[0m15:53:21.609803 [info ] [Thread-1 (]: 85 of 99 START sql table model main_marts.mart_daily_revenue ................... [RUN]
[0m15:53:21.616149 [debug] [Thread-2 (]: Writing injected SQL for node "model.de_pipeline.fct_trips"
[0m15:53:21.616783 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m15:53:21.617312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_int_hourly_patterns_pickup_date.75261743f2, now model.de_pipeline.mart_daily_revenue)
[0m15:53:21.618394 [debug] [Thread-1 (]: Began compiling node model.de_pipeline.mart_daily_revenue
[0m15:53:21.621630 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_pipeline.mart_daily_revenue"
[0m15:53:21.623011 [debug] [Thread-3 (]: Began executing node test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m15:53:21.627318 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m15:53:21.633654 [debug] [Thread-2 (]: Began executing node model.de_pipeline.fct_trips
[0m15:53:21.634103 [debug] [Thread-1 (]: Began executing node model.de_pipeline.mart_daily_revenue
[0m15:53:21.653165 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.mart_daily_revenue"
[0m15:53:21.659156 [debug] [Thread-1 (]: On model.de_pipeline.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_daily_revenue"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Daily revenue metrics with running totals.
*/

with daily as (
    select * from "de_pipeline"."main_intermediate"."int_daily_summary"
),

dates as (
    select * from "de_pipeline"."main_marts"."dim_dates"
),

final as (
    select
        d.date_key,
        d.day_of_week_name,
        d.is_weekend,
        d.is_holiday,
        d.week_of_year,

        daily.total_trips,
        daily.total_passengers,
        daily.total_fare_revenue,
        daily.total_tip_revenue,
        daily.total_revenue,
        daily.avg_trip_revenue,
        daily.avg_tip_percentage,
        daily.credit_card_trips,
        daily.cash_trips,
        daily.avg_trip_distance,
        daily.avg_trip_duration_min,

        -- running total
        sum(daily.total_revenue) over (order by d.date_key) as cumulative_revenue,

        -- day-over-day change
        daily.total_revenue - lag(daily.total_revenue) over (order by d.date_key) as revenue_change_vs_prior_day

    from daily
    inner join dates d
        on daily.pickup_date = d.date_key
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m15:53:21.664196 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.fct_trips"
[0m15:53:21.664714 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m15:53:21.665319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:21.666149 [debug] [Thread-2 (]: On model.de_pipeline.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.fct_trips"} */
DESCRIBE (select * from (
        /*
    Fact table: Fully enriched trip records with location names.
    Incremental with delete+insert strategy.
*/



with trip_metrics as (
    select * from "de_pipeline"."main_intermediate"."int_trip_metrics"
),

pickup_locations as (
    select * from "de_pipeline"."main_marts"."dim_locations"
),

dropoff_locations as (
    select * from "de_pipeline"."main_marts"."dim_locations"
),

final as (
    select
        t.trip_id,
        t.vendor_id,
        t.rate_code_id,
        t.payment_type_id,
        t.pickup_location_id,
        t.dropoff_location_id,
        t.pickup_datetime,
        t.dropoff_datetime,
        t.pickup_date,
        t.pickup_hour,
        t.pickup_day_of_week,
        t.is_weekend,
        t.passenger_count,
        t.trip_distance_miles,
        t.trip_duration_minutes,
        t.avg_speed_mph,
        t.cost_per_mile,
        t.fare_amount,
        t.extra_amount,
        t.mta_tax,
        t.tip_amount,
        t.tip_percentage,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.congestion_surcharge,
        t.airport_fee,

        -- enriched from dimensions
        pu.borough as pickup_borough,
        pu.zone_name as pickup_zone,
        do_loc.borough as dropoff_borough,
        do_loc.zone_name as dropoff_zone

    from trip_metrics t
    left join pickup_locations pu
        on t.pickup_location_id = pu.location_id
    left join dropoff_locations do_loc
        on t.dropoff_location_id = do_loc.location_id

    
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m15:53:21.666759 [debug] [Thread-3 (]: On test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: BEGIN
[0m15:53:21.668828 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:21.669673 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:21.673473 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m15:53:21.674297 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m15:53:21.677471 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.mart_daily_revenue"
[0m15:53:21.681198 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.fct_trips"
[0m15:53:21.681852 [debug] [Thread-1 (]: On model.de_pipeline.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_daily_revenue"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as date_key, 
      
    cast(null as varchar)
 as day_of_week_name, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as boolean)
 as is_holiday, 
      
    cast(null as bigint)
 as week_of_year, 
      
    cast(null as bigint)
 as total_trips, 
      
    cast(null as hugeint)
 as total_passengers, 
      
    cast(null as decimal(38,2))
 as total_fare_revenue, 
      
    cast(null as decimal(38,2))
 as total_tip_revenue, 
      
    cast(null as decimal(38,2))
 as total_revenue, 
      
    cast(null as double)
 as avg_trip_revenue, 
      
    cast(null as double)
 as avg_tip_percentage, 
      
    cast(null as bigint)
 as credit_card_trips, 
      
    cast(null as bigint)
 as cash_trips, 
      
    cast(null as double)
 as avg_trip_distance, 
      
    cast(null as double)
 as avg_trip_duration_min, 
      
    cast(null as decimal(38,2))
 as cumulative_revenue, 
      
    cast(null as decimal(38,2))
 as revenue_change_vs_prior_day
    ) as __dbt_sbq
    where false
    limit 0
)
[0m15:53:21.682631 [debug] [Thread-2 (]: On model.de_pipeline.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.fct_trips"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as varchar)
 as trip_id, 
      
    cast(null as integer)
 as vendor_id, 
      
    cast(null as integer)
 as rate_code_id, 
      
    cast(null as integer)
 as payment_type_id, 
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as integer)
 as dropoff_location_id, 
      
    cast(null as timestamp)
 as pickup_datetime, 
      
    cast(null as timestamp)
 as dropoff_datetime, 
      
    cast(null as date)
 as pickup_date, 
      
    cast(null as bigint)
 as pickup_hour, 
      
    cast(null as varchar)
 as pickup_day_of_week, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as integer)
 as passenger_count, 
      
    cast(null as double)
 as trip_distance_miles, 
      
    cast(null as bigint)
 as trip_duration_minutes, 
      
    cast(null as double)
 as avg_speed_mph, 
      
    cast(null as double)
 as cost_per_mile, 
      
    cast(null as decimal(10,2))
 as fare_amount, 
      
    cast(null as decimal(10,2))
 as extra_amount, 
      
    cast(null as decimal(10,2))
 as mta_tax, 
      
    cast(null as decimal(10,2))
 as tip_amount, 
      
    cast(null as double)
 as tip_percentage, 
      
    cast(null as decimal(10,2))
 as tolls_amount, 
      
    cast(null as decimal(10,2))
 as improvement_surcharge, 
      
    cast(null as decimal(10,2))
 as total_amount, 
      
    cast(null as decimal(10,2))
 as congestion_surcharge, 
      
    cast(null as decimal(10,2))
 as airport_fee, 
      
    cast(null as varchar)
 as pickup_borough, 
      
    cast(null as varchar)
 as pickup_zone, 
      
    cast(null as varchar)
 as dropoff_borough, 
      
    cast(null as varchar)
 as dropoff_zone
    ) as __dbt_sbq
    where false
    limit 0
)
[0m15:53:21.683690 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m15:53:21.684310 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.685143 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m15:53:21.686092 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:53:21.688774 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_pipeline.mart_daily_revenue"
[0m15:53:21.689127 [debug] [Thread-3 (]: On test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_trips
from "de_pipeline"."main_intermediate"."int_hourly_patterns"
where total_trips is null



  
  
      
    ) dbt_internal_test
[0m15:53:21.692545 [debug] [Thread-2 (]: Writing runtime sql for node "model.de_pipeline.fct_trips"
[0m15:53:21.701114 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m15:53:21.702791 [debug] [Thread-3 (]: On test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: ROLLBACK
[0m15:53:21.703888 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf'
[0m15:53:21.704350 [debug] [Thread-3 (]: On test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: Close
[0m15:53:21.705504 [info ] [Thread-3 (]: 83 of 99 PASS not_null_int_hourly_patterns_total_trips ......................... [[32mPASS[0m in 0.12s]
[0m15:53:21.706058 [debug] [Thread-3 (]: Finished running node test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m15:53:21.707265 [debug] [Thread-4 (]: Began running node model.de_pipeline.mart_hourly_demand
[0m15:53:21.707859 [info ] [Thread-4 (]: 86 of 99 START sql table model main_marts.mart_hourly_demand ................... [RUN]
[0m15:53:21.708460 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d, now model.de_pipeline.mart_hourly_demand)
[0m15:53:21.709909 [debug] [Thread-4 (]: Began compiling node model.de_pipeline.mart_hourly_demand
[0m15:53:21.710389 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.fct_trips"
[0m15:53:21.713655 [debug] [Thread-4 (]: Writing injected SQL for node "model.de_pipeline.mart_hourly_demand"
[0m15:53:21.714275 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.mart_daily_revenue"
[0m15:53:21.714603 [debug] [Thread-2 (]: On model.de_pipeline.fct_trips: BEGIN
[0m15:53:21.715420 [debug] [Thread-1 (]: On model.de_pipeline.mart_daily_revenue: BEGIN
[0m15:53:21.716838 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.717283 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.717623 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.fct_trips"
[0m15:53:21.718174 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.mart_daily_revenue"
[0m15:53:21.718951 [debug] [Thread-2 (]: On model.de_pipeline.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.fct_trips"} */

  
    
    
      
    

    create  table
      "de_pipeline"."main_marts"."fct_trips__dbt_tmp"
  
  (
    trip_id varchar,
    vendor_id integer,
    rate_code_id integer,
    payment_type_id integer,
    pickup_location_id integer,
    dropoff_location_id integer,
    pickup_datetime timestamp,
    dropoff_datetime timestamp,
    pickup_date date,
    pickup_hour bigint,
    pickup_day_of_week varchar,
    is_weekend boolean,
    passenger_count integer,
    trip_distance_miles double,
    trip_duration_minutes bigint,
    avg_speed_mph double,
    cost_per_mile double,
    fare_amount decimal(10,2),
    extra_amount decimal(10,2),
    mta_tax decimal(10,2),
    tip_amount decimal(10,2),
    tip_percentage double,
    tolls_amount decimal(10,2),
    improvement_surcharge decimal(10,2),
    total_amount decimal(10,2),
    congestion_surcharge decimal(10,2),
    airport_fee decimal(10,2),
    pickup_borough varchar,
    pickup_zone varchar,
    dropoff_borough varchar,
    dropoff_zone varchar
    
    )
 ;
    insert into "de_pipeline"."main_marts"."fct_trips__dbt_tmp" 
  (
    
      
      trip_id ,
    
      
      vendor_id ,
    
      
      rate_code_id ,
    
      
      payment_type_id ,
    
      
      pickup_location_id ,
    
      
      dropoff_location_id ,
    
      
      pickup_datetime ,
    
      
      dropoff_datetime ,
    
      
      pickup_date ,
    
      
      pickup_hour ,
    
      
      pickup_day_of_week ,
    
      
      is_weekend ,
    
      
      passenger_count ,
    
      
      trip_distance_miles ,
    
      
      trip_duration_minutes ,
    
      
      avg_speed_mph ,
    
      
      cost_per_mile ,
    
      
      fare_amount ,
    
      
      extra_amount ,
    
      
      mta_tax ,
    
      
      tip_amount ,
    
      
      tip_percentage ,
    
      
      tolls_amount ,
    
      
      improvement_surcharge ,
    
      
      total_amount ,
    
      
      congestion_surcharge ,
    
      
      airport_fee ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      dropoff_borough ,
    
      
      dropoff_zone 
    
  )
 (
      
    select trip_id, vendor_id, rate_code_id, payment_type_id, pickup_location_id, dropoff_location_id, pickup_datetime, dropoff_datetime, pickup_date, pickup_hour, pickup_day_of_week, is_weekend, passenger_count, trip_distance_miles, trip_duration_minutes, avg_speed_mph, cost_per_mile, fare_amount, extra_amount, mta_tax, tip_amount, tip_percentage, tolls_amount, improvement_surcharge, total_amount, congestion_surcharge, airport_fee, pickup_borough, pickup_zone, dropoff_borough, dropoff_zone
    from (
        /*
    Fact table: Fully enriched trip records with location names.
    Incremental with delete+insert strategy.
*/



with trip_metrics as (
    select * from "de_pipeline"."main_intermediate"."int_trip_metrics"
),

pickup_locations as (
    select * from "de_pipeline"."main_marts"."dim_locations"
),

dropoff_locations as (
    select * from "de_pipeline"."main_marts"."dim_locations"
),

final as (
    select
        t.trip_id,
        t.vendor_id,
        t.rate_code_id,
        t.payment_type_id,
        t.pickup_location_id,
        t.dropoff_location_id,
        t.pickup_datetime,
        t.dropoff_datetime,
        t.pickup_date,
        t.pickup_hour,
        t.pickup_day_of_week,
        t.is_weekend,
        t.passenger_count,
        t.trip_distance_miles,
        t.trip_duration_minutes,
        t.avg_speed_mph,
        t.cost_per_mile,
        t.fare_amount,
        t.extra_amount,
        t.mta_tax,
        t.tip_amount,
        t.tip_percentage,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.congestion_surcharge,
        t.airport_fee,

        -- enriched from dimensions
        pu.borough as pickup_borough,
        pu.zone_name as pickup_zone,
        do_loc.borough as dropoff_borough,
        do_loc.zone_name as dropoff_zone

    from trip_metrics t
    left join pickup_locations pu
        on t.pickup_location_id = pu.location_id
    left join dropoff_locations do_loc
        on t.dropoff_location_id = do_loc.location_id

    
)

select * from final
    ) as model_subq
    );
  
  
  
[0m15:53:21.719722 [debug] [Thread-1 (]: On model.de_pipeline.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_daily_revenue"} */

  
    
    
      
    

    create  table
      "de_pipeline"."main_marts"."mart_daily_revenue__dbt_tmp"
  
  (
    date_key date,
    day_of_week_name varchar,
    is_weekend boolean,
    is_holiday boolean,
    week_of_year bigint,
    total_trips bigint,
    total_passengers hugeint,
    total_fare_revenue decimal(38,2),
    total_tip_revenue decimal(38,2),
    total_revenue decimal(38,2),
    avg_trip_revenue double,
    avg_tip_percentage double,
    credit_card_trips bigint,
    cash_trips bigint,
    avg_trip_distance double,
    avg_trip_duration_min double,
    cumulative_revenue decimal(38,2),
    revenue_change_vs_prior_day decimal(38,2)
    
    )
 ;
    insert into "de_pipeline"."main_marts"."mart_daily_revenue__dbt_tmp" 
  (
    
      
      date_key ,
    
      
      day_of_week_name ,
    
      
      is_weekend ,
    
      
      is_holiday ,
    
      
      week_of_year ,
    
      
      total_trips ,
    
      
      total_passengers ,
    
      
      total_fare_revenue ,
    
      
      total_tip_revenue ,
    
      
      total_revenue ,
    
      
      avg_trip_revenue ,
    
      
      avg_tip_percentage ,
    
      
      credit_card_trips ,
    
      
      cash_trips ,
    
      
      avg_trip_distance ,
    
      
      avg_trip_duration_min ,
    
      
      cumulative_revenue ,
    
      
      revenue_change_vs_prior_day 
    
  )
 (
      
    select date_key, day_of_week_name, is_weekend, is_holiday, week_of_year, total_trips, total_passengers, total_fare_revenue, total_tip_revenue, total_revenue, avg_trip_revenue, avg_tip_percentage, credit_card_trips, cash_trips, avg_trip_distance, avg_trip_duration_min, cumulative_revenue, revenue_change_vs_prior_day
    from (
        /*
    Analytics mart: Daily revenue metrics with running totals.
*/

with daily as (
    select * from "de_pipeline"."main_intermediate"."int_daily_summary"
),

dates as (
    select * from "de_pipeline"."main_marts"."dim_dates"
),

final as (
    select
        d.date_key,
        d.day_of_week_name,
        d.is_weekend,
        d.is_holiday,
        d.week_of_year,

        daily.total_trips,
        daily.total_passengers,
        daily.total_fare_revenue,
        daily.total_tip_revenue,
        daily.total_revenue,
        daily.avg_trip_revenue,
        daily.avg_tip_percentage,
        daily.credit_card_trips,
        daily.cash_trips,
        daily.avg_trip_distance,
        daily.avg_trip_duration_min,

        -- running total
        sum(daily.total_revenue) over (order by d.date_key) as cumulative_revenue,

        -- day-over-day change
        daily.total_revenue - lag(daily.total_revenue) over (order by d.date_key) as revenue_change_vs_prior_day

    from daily
    inner join dates d
        on daily.pickup_date = d.date_key
)

select * from final
    ) as model_subq
    );
  
  
[0m15:53:21.734389 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m15:53:21.736076 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.mart_daily_revenue"
[0m15:53:21.737294 [debug] [Thread-1 (]: On model.de_pipeline.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_daily_revenue"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'mart_daily_revenue'
  
[0m15:53:21.738865 [debug] [Thread-4 (]: Began executing node model.de_pipeline.mart_hourly_demand
[0m15:53:21.739651 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:53:21.747859 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.mart_hourly_demand"
[0m15:53:21.749001 [debug] [Thread-2 (]: SQL status: OK in 0.028 seconds
[0m15:53:21.750687 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.mart_daily_revenue"
[0m15:53:21.751099 [debug] [Thread-4 (]: On model.de_pipeline.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_hourly_demand"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Hourly demand patterns.
*/

with hourly as (
    select * from "de_pipeline"."main_intermediate"."int_hourly_patterns"
),

final as (
    select
        pickup_hour,
        is_weekend,

        count(*) as days_observed,
        round(avg(total_trips), 0) as avg_trips_per_period,
        round(avg(avg_distance), 2) as avg_distance,
        round(avg(avg_duration_min), 2) as avg_duration_min,
        round(avg(total_revenue), 2) as avg_revenue_per_period,
        sum(total_trips) as total_trips_all_days

    from hourly
    group by pickup_hour, is_weekend
)

select * from final
order by is_weekend, pickup_hour
    ) as __dbt_sbq
    where false
    limit 0
)
[0m15:53:21.752428 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.fct_trips"
[0m15:53:21.753082 [debug] [Thread-1 (]: On model.de_pipeline.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_daily_revenue"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'mart_daily_revenue'
  
[0m15:53:21.753999 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:21.755058 [debug] [Thread-2 (]: On model.de_pipeline.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.fct_trips"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'fct_trips'
  
[0m15:53:21.756831 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.760706 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.mart_daily_revenue"
[0m15:53:21.761203 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m15:53:21.761785 [debug] [Thread-1 (]: On model.de_pipeline.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_daily_revenue"} */
alter table "de_pipeline"."main_marts"."mart_daily_revenue" rename to "mart_daily_revenue__dbt_backup"
[0m15:53:21.763671 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.fct_trips"
[0m15:53:21.764928 [debug] [Thread-2 (]: On model.de_pipeline.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.fct_trips"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'fct_trips'
  
[0m15:53:21.765439 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.766352 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m15:53:21.769259 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.mart_daily_revenue"
[0m15:53:21.769781 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m15:53:21.771795 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.mart_hourly_demand"
[0m15:53:21.772458 [debug] [Thread-1 (]: On model.de_pipeline.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_daily_revenue"} */
alter table "de_pipeline"."main_marts"."mart_daily_revenue__dbt_tmp" rename to "mart_daily_revenue"
[0m15:53:21.775579 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.fct_trips"
[0m15:53:21.775976 [debug] [Thread-4 (]: On model.de_pipeline.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_hourly_demand"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as bigint)
 as pickup_hour, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as bigint)
 as days_observed, 
      
    cast(null as double)
 as avg_trips_per_period, 
      
    cast(null as double)
 as avg_distance, 
      
    cast(null as double)
 as avg_duration_min, 
      
    cast(null as double)
 as avg_revenue_per_period, 
      
    cast(null as hugeint)
 as total_trips_all_days
    ) as __dbt_sbq
    where false
    limit 0
)
[0m15:53:21.776991 [debug] [Thread-2 (]: On model.de_pipeline.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.fct_trips"} */
alter table "de_pipeline"."main_marts"."fct_trips" rename to "fct_trips__dbt_backup"
[0m15:53:21.777460 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.778305 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.779769 [debug] [Thread-1 (]: On model.de_pipeline.mart_daily_revenue: COMMIT
[0m15:53:21.780205 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:53:21.781869 [debug] [Thread-4 (]: Writing runtime sql for node "model.de_pipeline.mart_hourly_demand"
[0m15:53:21.782268 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.mart_daily_revenue"
[0m15:53:21.784803 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.fct_trips"
[0m15:53:21.785821 [debug] [Thread-1 (]: On model.de_pipeline.mart_daily_revenue: COMMIT
[0m15:53:21.786376 [debug] [Thread-2 (]: On model.de_pipeline.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.fct_trips"} */
alter table "de_pipeline"."main_marts"."fct_trips__dbt_tmp" rename to "fct_trips"
[0m15:53:21.788426 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.791572 [debug] [Thread-2 (]: On model.de_pipeline.fct_trips: COMMIT
[0m15:53:21.792008 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:53:21.793102 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.fct_trips"
[0m15:53:21.796295 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.mart_daily_revenue"
[0m15:53:21.796831 [debug] [Thread-2 (]: On model.de_pipeline.fct_trips: COMMIT
[0m15:53:21.797378 [debug] [Thread-1 (]: On model.de_pipeline.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_daily_revenue"} */

      drop table if exists "de_pipeline"."main_marts"."mart_daily_revenue__dbt_backup" cascade
    
[0m15:53:21.806478 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.mart_hourly_demand"
[0m15:53:21.807277 [debug] [Thread-4 (]: On model.de_pipeline.mart_hourly_demand: BEGIN
[0m15:53:21.808117 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m15:53:21.808613 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.mart_hourly_demand"
[0m15:53:21.809089 [debug] [Thread-4 (]: On model.de_pipeline.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_hourly_demand"} */

  
    
    
      
    

    create  table
      "de_pipeline"."main_marts"."mart_hourly_demand__dbt_tmp"
  
  (
    pickup_hour bigint,
    is_weekend boolean,
    days_observed bigint,
    avg_trips_per_period double,
    avg_distance double,
    avg_duration_min double,
    avg_revenue_per_period double,
    total_trips_all_days hugeint
    
    )
 ;
    insert into "de_pipeline"."main_marts"."mart_hourly_demand__dbt_tmp" 
  (
    
      
      pickup_hour ,
    
      
      is_weekend ,
    
      
      days_observed ,
    
      
      avg_trips_per_period ,
    
      
      avg_distance ,
    
      
      avg_duration_min ,
    
      
      avg_revenue_per_period ,
    
      
      total_trips_all_days 
    
  )
 (
      
    select pickup_hour, is_weekend, days_observed, avg_trips_per_period, avg_distance, avg_duration_min, avg_revenue_per_period, total_trips_all_days
    from (
        /*
    Analytics mart: Hourly demand patterns.
*/

with hourly as (
    select * from "de_pipeline"."main_intermediate"."int_hourly_patterns"
),

final as (
    select
        pickup_hour,
        is_weekend,

        count(*) as days_observed,
        round(avg(total_trips), 0) as avg_trips_per_period,
        round(avg(avg_distance), 2) as avg_distance,
        round(avg(avg_duration_min), 2) as avg_duration_min,
        round(avg(total_revenue), 2) as avg_revenue_per_period,
        sum(total_trips) as total_trips_all_days

    from hourly
    group by pickup_hour, is_weekend
)

select * from final
order by is_weekend, pickup_hour
    ) as model_subq
    );
  
  
[0m15:53:21.816357 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m15:53:21.817669 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.mart_hourly_demand"
[0m15:53:21.818383 [debug] [Thread-4 (]: On model.de_pipeline.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_hourly_demand"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'mart_hourly_demand'
  
[0m15:53:21.819374 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m15:53:21.820634 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.mart_hourly_demand"
[0m15:53:21.820984 [debug] [Thread-4 (]: On model.de_pipeline.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_hourly_demand"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'mart_hourly_demand'
  
[0m15:53:21.821809 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m15:53:21.824420 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.mart_hourly_demand"
[0m15:53:21.824823 [debug] [Thread-2 (]: SQL status: OK in 0.027 seconds
[0m15:53:21.825112 [debug] [Thread-4 (]: On model.de_pipeline.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_hourly_demand"} */
alter table "de_pipeline"."main_marts"."mart_hourly_demand" rename to "mart_hourly_demand__dbt_backup"
[0m15:53:21.825407 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m15:53:21.825927 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.fct_trips"
[0m15:53:21.827305 [debug] [Thread-1 (]: On model.de_pipeline.mart_daily_revenue: Close
[0m15:53:21.827640 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.827907 [debug] [Thread-2 (]: On model.de_pipeline.fct_trips: BEGIN
[0m15:53:21.828715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e112fb35-b2dd-4364-a6cd-45ba3ff28547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca7673a0c0>]}
[0m15:53:21.830990 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.mart_hourly_demand"
[0m15:53:21.832021 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m15:53:21.832709 [info ] [Thread-1 (]: 85 of 99 OK created sql table model main_marts.mart_daily_revenue .............. [[32mOK[0m in 0.21s]
[0m15:53:21.833801 [debug] [Thread-4 (]: On model.de_pipeline.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_hourly_demand"} */
alter table "de_pipeline"."main_marts"."mart_hourly_demand__dbt_tmp" rename to "mart_hourly_demand"
[0m15:53:21.834944 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.fct_trips"
[0m15:53:21.835650 [debug] [Thread-1 (]: Finished running node model.de_pipeline.mart_daily_revenue
[0m15:53:21.837140 [debug] [Thread-2 (]: On model.de_pipeline.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.fct_trips"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'fct_trips__dbt_backup'
  
[0m15:53:21.837493 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.838412 [debug] [Thread-3 (]: Began running node test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a
[0m15:53:21.839753 [debug] [Thread-4 (]: On model.de_pipeline.mart_hourly_demand: COMMIT
[0m15:53:21.840121 [debug] [Thread-1 (]: Began running node test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m15:53:21.840503 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:53:21.840829 [info ] [Thread-3 (]: 87 of 99 START test not_null_mart_daily_revenue_date_key ....................... [RUN]
[0m15:53:21.841347 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.mart_hourly_demand"
[0m15:53:21.841790 [info ] [Thread-1 (]: 88 of 99 START test not_null_mart_daily_revenue_total_revenue .................. [RUN]
[0m15:53:21.845133 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.fct_trips"
[0m15:53:21.845590 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_int_hourly_patterns_total_trips.a66c4ed8cf, now test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a)
[0m15:53:21.846038 [debug] [Thread-4 (]: On model.de_pipeline.mart_hourly_demand: COMMIT
[0m15:53:21.846590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_pipeline.mart_daily_revenue, now test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9)
[0m15:53:21.847034 [debug] [Thread-2 (]: On model.de_pipeline.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.fct_trips"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'fct_trips__dbt_backup'
  
[0m15:53:21.847429 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a
[0m15:53:21.848135 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m15:53:21.852545 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m15:53:21.852924 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m15:53:21.853199 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m15:53:21.855561 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m15:53:21.857545 [debug] [Thread-4 (]: Using duckdb connection "model.de_pipeline.mart_hourly_demand"
[0m15:53:21.861191 [debug] [Thread-2 (]: Using duckdb connection "model.de_pipeline.fct_trips"
[0m15:53:21.862039 [debug] [Thread-4 (]: On model.de_pipeline.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_hourly_demand"} */

      drop table if exists "de_pipeline"."main_marts"."mart_hourly_demand__dbt_backup" cascade
    
[0m15:53:21.862651 [debug] [Thread-2 (]: On model.de_pipeline.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.fct_trips"} */

      drop table if exists "de_pipeline"."main_marts"."fct_trips__dbt_backup" cascade
    
[0m15:53:21.864989 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m15:53:21.866186 [debug] [Thread-2 (]: On model.de_pipeline.fct_trips: ROLLBACK
[0m15:53:21.866968 [debug] [Thread-2 (]: Failed to rollback 'model.de_pipeline.fct_trips'
[0m15:53:21.868524 [debug] [Thread-2 (]: On model.de_pipeline.fct_trips: Close
[0m15:53:21.870199 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m15:53:21.871628 [debug] [Thread-4 (]: On model.de_pipeline.mart_hourly_demand: Close
[0m15:53:21.872105 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e112fb35-b2dd-4364-a6cd-45ba3ff28547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca745d2000>]}
[0m15:53:21.873171 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e112fb35-b2dd-4364-a6cd-45ba3ff28547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca58885b50>]}
[0m15:53:21.874114 [info ] [Thread-2 (]: 84 of 99 OK created sql incremental model main_marts.fct_trips ................. [[32mOK[0m in 0.27s]
[0m15:53:21.875020 [info ] [Thread-4 (]: 86 of 99 OK created sql table model main_marts.mart_hourly_demand .............. [[32mOK[0m in 0.16s]
[0m15:53:21.875451 [debug] [Thread-1 (]: Began executing node test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m15:53:21.876187 [debug] [Thread-2 (]: Finished running node model.de_pipeline.fct_trips
[0m15:53:21.876728 [debug] [Thread-4 (]: Finished running node model.de_pipeline.mart_hourly_demand
[0m15:53:21.877026 [debug] [Thread-3 (]: Began executing node test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a
[0m15:53:21.878788 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m15:53:21.879273 [debug] [Thread-2 (]: Began running node test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m15:53:21.879969 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83
[0m15:53:21.881435 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m15:53:21.882171 [info ] [Thread-2 (]: 89 of 99 START test unique_mart_daily_revenue_date_key ......................... [RUN]
[0m15:53:21.882786 [info ] [Thread-4 (]: 90 of 99 START test not_null_fct_trips_pickup_datetime ......................... [RUN]
[0m15:53:21.883547 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.de_pipeline.fct_trips, now test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7)
[0m15:53:21.883936 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.de_pipeline.mart_hourly_demand, now test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83)
[0m15:53:21.884299 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m15:53:21.884743 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83
[0m15:53:21.888175 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m15:53:21.891245 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m15:53:21.894684 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m15:53:21.895257 [debug] [Thread-3 (]: On test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a: BEGIN
[0m15:53:21.895598 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m15:53:21.895917 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:21.896359 [debug] [Thread-1 (]: On test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9: BEGIN
[0m15:53:21.898488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:21.900319 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:53:21.900751 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m15:53:21.901158 [debug] [Thread-3 (]: On test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "de_pipeline"."main_marts"."mart_daily_revenue"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m15:53:21.902310 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.904003 [debug] [Thread-3 (]: On test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a: ROLLBACK
[0m15:53:21.904344 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83
[0m15:53:21.905156 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a'
[0m15:53:21.905520 [debug] [Thread-2 (]: Began executing node test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m15:53:21.907310 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m15:53:21.908047 [debug] [Thread-3 (]: On test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a: Close
[0m15:53:21.910937 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m15:53:21.911716 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m15:53:21.913086 [info ] [Thread-3 (]: 87 of 99 PASS not_null_mart_daily_revenue_date_key ............................. [[32mPASS[0m in 0.07s]
[0m15:53:21.914430 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m15:53:21.915080 [debug] [Thread-3 (]: Finished running node test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a
[0m15:53:21.915536 [debug] [Thread-1 (]: On test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "de_pipeline"."main_marts"."mart_daily_revenue"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m15:53:21.916019 [debug] [Thread-3 (]: Began running node test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d
[0m15:53:21.916803 [info ] [Thread-3 (]: 91 of 99 START test not_null_fct_trips_total_amount ............................ [RUN]
[0m15:53:21.917308 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_mart_daily_revenue_date_key.7065ce323a, now test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d)
[0m15:53:21.917647 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.917960 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d
[0m15:53:21.919321 [debug] [Thread-1 (]: On test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9: ROLLBACK
[0m15:53:21.922122 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d"
[0m15:53:21.923108 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9'
[0m15:53:21.923638 [debug] [Thread-1 (]: On test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9: Close
[0m15:53:21.924270 [info ] [Thread-1 (]: 88 of 99 PASS not_null_mart_daily_revenue_total_revenue ........................ [[32mPASS[0m in 0.08s]
[0m15:53:21.924800 [debug] [Thread-1 (]: Finished running node test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m15:53:21.925226 [debug] [Thread-1 (]: Began running node test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d
[0m15:53:21.925718 [info ] [Thread-1 (]: 92 of 99 START test not_null_fct_trips_trip_id ................................. [RUN]
[0m15:53:21.926366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_mart_daily_revenue_total_revenue.75c9f689e9, now test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d)
[0m15:53:21.926791 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m15:53:21.927097 [debug] [Thread-1 (]: Began compiling node test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d
[0m15:53:21.927471 [debug] [Thread-4 (]: On test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83: BEGIN
[0m15:53:21.930461 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d"
[0m15:53:21.931060 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:21.932823 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m15:53:21.933303 [debug] [Thread-2 (]: On test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7: BEGIN
[0m15:53:21.933741 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:21.934794 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m15:53:21.935231 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m15:53:21.935644 [debug] [Thread-4 (]: On test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "de_pipeline"."main_marts"."fct_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m15:53:21.936508 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:53:21.936804 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.937072 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m15:53:21.938381 [debug] [Thread-4 (]: On test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83: ROLLBACK
[0m15:53:21.938719 [debug] [Thread-2 (]: On test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "de_pipeline"."main_marts"."mart_daily_revenue"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:53:21.939455 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83'
[0m15:53:21.939760 [debug] [Thread-3 (]: Began executing node test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d
[0m15:53:21.940215 [debug] [Thread-4 (]: On test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83: Close
[0m15:53:21.943102 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d"
[0m15:53:21.943559 [debug] [Thread-1 (]: Began executing node test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d
[0m15:53:21.943951 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m15:53:21.944446 [info ] [Thread-4 (]: 90 of 99 PASS not_null_fct_trips_pickup_datetime ............................... [[32mPASS[0m in 0.06s]
[0m15:53:21.947146 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d"
[0m15:53:21.948699 [debug] [Thread-2 (]: On test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7: ROLLBACK
[0m15:53:21.949118 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83
[0m15:53:21.950192 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7'
[0m15:53:21.950526 [debug] [Thread-4 (]: Began running node test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab
[0m15:53:21.951048 [debug] [Thread-2 (]: On test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7: Close
[0m15:53:21.951598 [info ] [Thread-4 (]: 93 of 99 START test unique_fct_trips_trip_id ................................... [RUN]
[0m15:53:21.952380 [info ] [Thread-2 (]: 89 of 99 PASS unique_mart_daily_revenue_date_key ............................... [[32mPASS[0m in 0.07s]
[0m15:53:21.952725 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_fct_trips_pickup_datetime.3c78164d83, now test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab)
[0m15:53:21.953321 [debug] [Thread-2 (]: Finished running node test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m15:53:21.953702 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab
[0m15:53:21.954102 [debug] [Thread-2 (]: Began running node test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m15:53:21.957143 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab"
[0m15:53:21.957607 [info ] [Thread-2 (]: 94 of 99 START test not_null_mart_hourly_demand_is_weekend ..................... [RUN]
[0m15:53:21.958433 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.unique_mart_daily_revenue_date_key.e6ac3c00f7, now test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8)
[0m15:53:21.958868 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m15:53:21.961561 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m15:53:21.963158 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d"
[0m15:53:21.963635 [debug] [Thread-3 (]: On test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d: BEGIN
[0m15:53:21.963902 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d"
[0m15:53:21.964179 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:21.964601 [debug] [Thread-1 (]: On test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d: BEGIN
[0m15:53:21.965427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:21.966596 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:53:21.967043 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d"
[0m15:53:21.967456 [debug] [Thread-3 (]: On test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "de_pipeline"."main_marts"."fct_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m15:53:21.968256 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:53:21.968549 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.968820 [debug] [Thread-1 (]: Using duckdb connection "test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d"
[0m15:53:21.970253 [debug] [Thread-3 (]: On test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d: ROLLBACK
[0m15:53:21.970606 [debug] [Thread-1 (]: On test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "de_pipeline"."main_marts"."fct_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m15:53:21.971598 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d'
[0m15:53:21.972271 [debug] [Thread-3 (]: On test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d: Close
[0m15:53:21.972673 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:53:21.973129 [debug] [Thread-2 (]: Began executing node test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m15:53:21.973629 [info ] [Thread-3 (]: 91 of 99 PASS not_null_fct_trips_total_amount .................................. [[32mPASS[0m in 0.06s]
[0m15:53:21.973965 [debug] [Thread-4 (]: Began executing node test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab
[0m15:53:21.975066 [debug] [Thread-1 (]: On test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d: ROLLBACK
[0m15:53:21.976709 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m15:53:21.977215 [debug] [Thread-3 (]: Finished running node test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d
[0m15:53:21.978809 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab"
[0m15:53:21.979558 [debug] [Thread-1 (]: Failed to rollback 'test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d'
[0m15:53:21.980256 [debug] [Thread-3 (]: Began running node test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m15:53:21.980897 [debug] [Thread-1 (]: On test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d: Close
[0m15:53:21.982156 [info ] [Thread-3 (]: 95 of 99 START test not_null_mart_hourly_demand_pickup_hour .................... [RUN]
[0m15:53:21.984350 [info ] [Thread-1 (]: 92 of 99 PASS not_null_fct_trips_trip_id ....................................... [[32mPASS[0m in 0.06s]
[0m15:53:21.985913 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_fct_trips_total_amount.0e8ec5477d, now test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418)
[0m15:53:21.988213 [debug] [Thread-1 (]: Finished running node test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d
[0m15:53:21.989750 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m15:53:22.057371 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m15:53:22.058925 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m15:53:22.059367 [debug] [Thread-2 (]: On test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8: BEGIN
[0m15:53:22.059935 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:22.061149 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab"
[0m15:53:22.061833 [debug] [Thread-4 (]: On test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab: BEGIN
[0m15:53:22.062228 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:22.063163 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:53:22.063535 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m15:53:22.063908 [debug] [Thread-2 (]: On test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "de_pipeline"."main_marts"."mart_hourly_demand"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m15:53:22.065537 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m15:53:22.065975 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab"
[0m15:53:22.066354 [debug] [Thread-4 (]: On test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "de_pipeline"."main_marts"."fct_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:53:22.066927 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:53:22.070782 [debug] [Thread-2 (]: On test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8: ROLLBACK
[0m15:53:22.071181 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m15:53:22.073687 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8'
[0m15:53:22.076155 [debug] [Thread-4 (]: On test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab: ROLLBACK
[0m15:53:22.076440 [debug] [Thread-2 (]: On test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8: Close
[0m15:53:22.077300 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab'
[0m15:53:22.077750 [info ] [Thread-2 (]: 94 of 99 PASS not_null_mart_hourly_demand_is_weekend ........................... [[32mPASS[0m in 0.12s]
[0m15:53:22.078090 [debug] [Thread-3 (]: Began executing node test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m15:53:22.078349 [debug] [Thread-4 (]: On test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab: Close
[0m15:53:22.078966 [debug] [Thread-2 (]: Finished running node test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m15:53:22.080821 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m15:53:22.081378 [info ] [Thread-4 (]: 93 of 99 PASS unique_fct_trips_trip_id ......................................... [[32mPASS[0m in 0.13s]
[0m15:53:22.082495 [debug] [Thread-4 (]: Finished running node test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab
[0m15:53:22.083150 [debug] [Thread-1 (]: Began running node model.de_pipeline.mart_location_performance
[0m15:53:22.083751 [info ] [Thread-1 (]: 96 of 99 START sql table model main_marts.mart_location_performance ............ [RUN]
[0m15:53:22.084363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_fct_trips_trip_id.df65bf8c1d, now model.de_pipeline.mart_location_performance)
[0m15:53:22.084765 [debug] [Thread-1 (]: Began compiling node model.de_pipeline.mart_location_performance
[0m15:53:22.088319 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_pipeline.mart_location_performance"
[0m15:53:22.099785 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m15:53:22.100423 [debug] [Thread-3 (]: On test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: BEGIN
[0m15:53:22.101063 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:22.102844 [debug] [Thread-1 (]: Began executing node model.de_pipeline.mart_location_performance
[0m15:53:22.105599 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.mart_location_performance"
[0m15:53:22.106133 [debug] [Thread-1 (]: On model.de_pipeline.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_location_performance"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Location-level performance summary.
    Uses adapter-dispatched mode_compat() for cross-dialect support.
*/

with trips as (
    select * from "de_pipeline"."main_marts"."fct_trips"
),

final as (
    select
        pickup_location_id,
        pickup_borough,
        pickup_zone,

        count(*) as total_pickups,
        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue_per_trip,
        round(avg(tip_percentage), 2) as avg_tip_pct,
        round(avg(passenger_count), 2) as avg_passengers,

        -- most common dropoff destination
        
    mode() within group (order by dropoff_zone)
 as most_common_dropoff_zone,

        -- busiest hour
        
    mode() within group (order by pickup_hour)
 as peak_pickup_hour

    from trips
    where pickup_zone is not null
    group by pickup_location_id, pickup_borough, pickup_zone
)

select * from final
order by total_pickups desc
    ) as __dbt_sbq
    where false
    limit 0
)
[0m15:53:22.106643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:22.109768 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m15:53:22.110161 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m15:53:22.110527 [debug] [Thread-3 (]: On test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "de_pipeline"."main_marts"."mart_hourly_demand"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m15:53:22.111835 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:53:22.113205 [debug] [Thread-3 (]: On test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: ROLLBACK
[0m15:53:22.113543 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:53:22.114290 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418'
[0m15:53:22.115983 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.mart_location_performance"
[0m15:53:22.116310 [debug] [Thread-3 (]: On test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: Close
[0m15:53:22.116834 [debug] [Thread-1 (]: On model.de_pipeline.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_location_performance"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as varchar)
 as pickup_borough, 
      
    cast(null as varchar)
 as pickup_zone, 
      
    cast(null as bigint)
 as total_pickups, 
      
    cast(null as double)
 as avg_trip_distance, 
      
    cast(null as double)
 as avg_trip_duration_min, 
      
    cast(null as decimal(38,2))
 as total_revenue, 
      
    cast(null as double)
 as avg_revenue_per_trip, 
      
    cast(null as double)
 as avg_tip_pct, 
      
    cast(null as double)
 as avg_passengers, 
      
    cast(null as varchar)
 as most_common_dropoff_zone, 
      
    cast(null as bigint)
 as peak_pickup_hour
    ) as __dbt_sbq
    where false
    limit 0
)
[0m15:53:22.117558 [info ] [Thread-3 (]: 95 of 99 PASS not_null_mart_hourly_demand_pickup_hour .......................... [[32mPASS[0m in 0.13s]
[0m15:53:22.118369 [debug] [Thread-3 (]: Finished running node test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m15:53:22.118755 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:53:22.120577 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_pipeline.mart_location_performance"
[0m15:53:22.135651 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.mart_location_performance"
[0m15:53:22.136093 [debug] [Thread-1 (]: On model.de_pipeline.mart_location_performance: BEGIN
[0m15:53:22.136796 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:53:22.137257 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.mart_location_performance"
[0m15:53:22.137707 [debug] [Thread-1 (]: On model.de_pipeline.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_location_performance"} */

  
    
    
      
    

    create  table
      "de_pipeline"."main_marts"."mart_location_performance__dbt_tmp"
  
  (
    pickup_location_id integer,
    pickup_borough varchar,
    pickup_zone varchar,
    total_pickups bigint,
    avg_trip_distance double,
    avg_trip_duration_min double,
    total_revenue decimal(38,2),
    avg_revenue_per_trip double,
    avg_tip_pct double,
    avg_passengers double,
    most_common_dropoff_zone varchar,
    peak_pickup_hour bigint
    
    )
 ;
    insert into "de_pipeline"."main_marts"."mart_location_performance__dbt_tmp" 
  (
    
      
      pickup_location_id ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      total_pickups ,
    
      
      avg_trip_distance ,
    
      
      avg_trip_duration_min ,
    
      
      total_revenue ,
    
      
      avg_revenue_per_trip ,
    
      
      avg_tip_pct ,
    
      
      avg_passengers ,
    
      
      most_common_dropoff_zone ,
    
      
      peak_pickup_hour 
    
  )
 (
      
    select pickup_location_id, pickup_borough, pickup_zone, total_pickups, avg_trip_distance, avg_trip_duration_min, total_revenue, avg_revenue_per_trip, avg_tip_pct, avg_passengers, most_common_dropoff_zone, peak_pickup_hour
    from (
        /*
    Analytics mart: Location-level performance summary.
    Uses adapter-dispatched mode_compat() for cross-dialect support.
*/

with trips as (
    select * from "de_pipeline"."main_marts"."fct_trips"
),

final as (
    select
        pickup_location_id,
        pickup_borough,
        pickup_zone,

        count(*) as total_pickups,
        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue_per_trip,
        round(avg(tip_percentage), 2) as avg_tip_pct,
        round(avg(passenger_count), 2) as avg_passengers,

        -- most common dropoff destination
        
    mode() within group (order by dropoff_zone)
 as most_common_dropoff_zone,

        -- busiest hour
        
    mode() within group (order by pickup_hour)
 as peak_pickup_hour

    from trips
    where pickup_zone is not null
    group by pickup_location_id, pickup_borough, pickup_zone
)

select * from final
order by total_pickups desc
    ) as model_subq
    );
  
  
[0m15:53:22.145661 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:53:22.146769 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.mart_location_performance"
[0m15:53:22.147125 [debug] [Thread-1 (]: On model.de_pipeline.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_location_performance"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'mart_location_performance'
  
[0m15:53:22.148057 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:53:22.149124 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.mart_location_performance"
[0m15:53:22.149466 [debug] [Thread-1 (]: On model.de_pipeline.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_location_performance"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'mart_location_performance'
  
[0m15:53:22.150127 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:53:22.152499 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.mart_location_performance"
[0m15:53:22.152958 [debug] [Thread-1 (]: On model.de_pipeline.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_location_performance"} */
alter table "de_pipeline"."main_marts"."mart_location_performance" rename to "mart_location_performance__dbt_backup"
[0m15:53:22.155294 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:53:22.169820 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.mart_location_performance"
[0m15:53:22.171291 [debug] [Thread-1 (]: On model.de_pipeline.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_location_performance"} */
alter table "de_pipeline"."main_marts"."mart_location_performance__dbt_tmp" rename to "mart_location_performance"
[0m15:53:22.172124 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:53:22.173274 [debug] [Thread-1 (]: On model.de_pipeline.mart_location_performance: COMMIT
[0m15:53:22.173723 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.mart_location_performance"
[0m15:53:22.174038 [debug] [Thread-1 (]: On model.de_pipeline.mart_location_performance: COMMIT
[0m15:53:22.178809 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:53:22.180540 [debug] [Thread-1 (]: Using duckdb connection "model.de_pipeline.mart_location_performance"
[0m15:53:22.182080 [debug] [Thread-1 (]: On model.de_pipeline.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "model.de_pipeline.mart_location_performance"} */

      drop table if exists "de_pipeline"."main_marts"."mart_location_performance__dbt_backup" cascade
    
[0m15:53:22.189108 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:53:22.190412 [debug] [Thread-1 (]: On model.de_pipeline.mart_location_performance: Close
[0m15:53:22.191017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e112fb35-b2dd-4364-a6cd-45ba3ff28547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acaea9fec00>]}
[0m15:53:22.191718 [info ] [Thread-1 (]: 96 of 99 OK created sql table model main_marts.mart_location_performance ....... [[32mOK[0m in 0.11s]
[0m15:53:22.192422 [debug] [Thread-1 (]: Finished running node model.de_pipeline.mart_location_performance
[0m15:53:22.193834 [debug] [Thread-4 (]: Began running node test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m15:53:22.194132 [debug] [Thread-2 (]: Began running node test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m15:53:22.194467 [debug] [Thread-3 (]: Began running node test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m15:53:22.194761 [info ] [Thread-4 (]: 97 of 99 START test not_null_mart_location_performance_pickup_location_id ...... [RUN]
[0m15:53:22.195167 [info ] [Thread-2 (]: 98 of 99 START test not_null_mart_location_performance_total_pickups ........... [RUN]
[0m15:53:22.195773 [info ] [Thread-3 (]: 99 of 99 START test unique_mart_location_performance_pickup_location_id ........ [RUN]
[0m15:53:22.196562 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.de_pipeline.unique_fct_trips_trip_id.9b74cb6aab, now test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c)
[0m15:53:22.197548 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_mart_hourly_demand_is_weekend.943ef48ab8, now test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259)
[0m15:53:22.198242 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.de_pipeline.not_null_mart_hourly_demand_pickup_hour.ba5dc86418, now test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62)
[0m15:53:22.198719 [debug] [Thread-4 (]: Began compiling node test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m15:53:22.199246 [debug] [Thread-2 (]: Began compiling node test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m15:53:22.199646 [debug] [Thread-3 (]: Began compiling node test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m15:53:22.202311 [debug] [Thread-4 (]: Writing injected SQL for node "test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m15:53:22.205700 [debug] [Thread-2 (]: Writing injected SQL for node "test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m15:53:22.208022 [debug] [Thread-3 (]: Writing injected SQL for node "test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m15:53:22.219658 [debug] [Thread-4 (]: Began executing node test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m15:53:22.220097 [debug] [Thread-2 (]: Began executing node test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m15:53:22.221936 [debug] [Thread-4 (]: Writing runtime sql for node "test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m15:53:22.222256 [debug] [Thread-3 (]: Began executing node test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m15:53:22.223715 [debug] [Thread-2 (]: Writing runtime sql for node "test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m15:53:22.225546 [debug] [Thread-3 (]: Writing runtime sql for node "test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m15:53:22.235763 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m15:53:22.236172 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m15:53:22.236466 [debug] [Thread-3 (]: On test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62: BEGIN
[0m15:53:22.236855 [debug] [Thread-4 (]: On test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c: BEGIN
[0m15:53:22.237219 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:22.237636 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:22.241808 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m15:53:22.242383 [debug] [Thread-3 (]: Using duckdb connection "test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m15:53:22.243008 [debug] [Thread-3 (]: On test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pickup_location_id as unique_field,
    count(*) as n_records

from "de_pipeline"."main_marts"."mart_location_performance"
where pickup_location_id is not null
group by pickup_location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:53:22.243330 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m15:53:22.243980 [debug] [Thread-2 (]: On test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259: BEGIN
[0m15:53:22.244358 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:22.244652 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m15:53:22.244899 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:53:22.245829 [debug] [Thread-4 (]: Using duckdb connection "test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m15:53:22.247513 [debug] [Thread-3 (]: On test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62: ROLLBACK
[0m15:53:22.247765 [debug] [Thread-4 (]: On test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_location_id
from "de_pipeline"."main_marts"."mart_location_performance"
where pickup_location_id is null



  
  
      
    ) dbt_internal_test
[0m15:53:22.248281 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m15:53:22.248907 [debug] [Thread-3 (]: Failed to rollback 'test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62'
[0m15:53:22.249518 [debug] [Thread-2 (]: Using duckdb connection "test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m15:53:22.250003 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:53:22.250363 [debug] [Thread-3 (]: On test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62: Close
[0m15:53:22.250869 [debug] [Thread-2 (]: On test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "de_pipeline", "target_name": "dev", "node_id": "test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_pickups
from "de_pipeline"."main_marts"."mart_location_performance"
where total_pickups is null



  
  
      
    ) dbt_internal_test
[0m15:53:22.252252 [debug] [Thread-4 (]: On test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c: ROLLBACK
[0m15:53:22.252809 [info ] [Thread-3 (]: 99 of 99 PASS unique_mart_location_performance_pickup_location_id .............. [[32mPASS[0m in 0.05s]
[0m15:53:22.253676 [debug] [Thread-4 (]: Failed to rollback 'test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c'
[0m15:53:22.254042 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:53:22.254459 [debug] [Thread-3 (]: Finished running node test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m15:53:22.254902 [debug] [Thread-4 (]: On test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c: Close
[0m15:53:22.256105 [debug] [Thread-2 (]: On test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259: ROLLBACK
[0m15:53:22.256947 [info ] [Thread-4 (]: 97 of 99 PASS not_null_mart_location_performance_pickup_location_id ............ [[32mPASS[0m in 0.06s]
[0m15:53:22.257685 [debug] [Thread-2 (]: Failed to rollback 'test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259'
[0m15:53:22.258517 [debug] [Thread-4 (]: Finished running node test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m15:53:22.259257 [debug] [Thread-2 (]: On test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259: Close
[0m15:53:22.259978 [info ] [Thread-2 (]: 98 of 99 PASS not_null_mart_location_performance_total_pickups ................. [[32mPASS[0m in 0.06s]
[0m15:53:22.260384 [debug] [Thread-2 (]: Finished running node test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m15:53:22.261977 [debug] [MainThread]: Using duckdb connection "master"
[0m15:53:22.262308 [debug] [MainThread]: On master: BEGIN
[0m15:53:22.262692 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:53:22.264381 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m15:53:22.264780 [debug] [MainThread]: On master: COMMIT
[0m15:53:22.265156 [debug] [MainThread]: Using duckdb connection "master"
[0m15:53:22.265535 [debug] [MainThread]: On master: COMMIT
[0m15:53:22.266036 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:53:22.266388 [debug] [MainThread]: On master: Close
[0m15:53:22.266915 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:53:22.267485 [debug] [MainThread]: Connection 'model.de_pipeline.mart_location_performance' was properly closed.
[0m15:53:22.267750 [debug] [MainThread]: Connection 'test.de_pipeline.not_null_mart_location_performance_total_pickups.e9d9f3f259' was properly closed.
[0m15:53:22.268007 [debug] [MainThread]: Connection 'test.de_pipeline.not_null_mart_location_performance_pickup_location_id.16ab95486c' was properly closed.
[0m15:53:22.268356 [debug] [MainThread]: Connection 'test.de_pipeline.unique_mart_location_performance_pickup_location_id.d5833a3c62' was properly closed.
[0m15:53:22.268908 [info ] [MainThread]: 
[0m15:53:22.269413 [info ] [MainThread]: Finished running 1 incremental model, 4 seeds, 8 table models, 79 data tests, 7 view models in 0 hours 0 minutes and 6.92 seconds (6.92s).
[0m15:53:22.274754 [debug] [MainThread]: Command end result
[0m15:53:22.392107 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m15:53:22.396421 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m15:53:22.414915 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m15:53:22.415439 [info ] [MainThread]: 
[0m15:53:22.415943 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:53:22.416404 [info ] [MainThread]: 
[0m15:53:22.416814 [info ] [MainThread]: Done. PASS=99 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=99
[0m15:53:22.417935 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 8.600014, "process_in_blocks": "152", "process_kernel_time": 1.282093, "process_mem_max_rss": "279756", "process_out_blocks": "245472", "process_user_time": 6.147024}
[0m15:53:22.418400 [debug] [MainThread]: Command `dbt build` succeeded at 15:53:22.418277 after 8.60 seconds
[0m15:53:22.418795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acae8bd4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acae8bd4800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acae7cfd820>]}
[0m15:53:22.419179 [debug] [MainThread]: Flushing usage events
[0m15:53:22.657226 [debug] [MainThread]: An error was encountered while trying to flush usage events
