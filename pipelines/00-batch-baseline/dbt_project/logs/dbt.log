[0m00:26:11.779080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7a03bf5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7a0350b080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7a03bf6690>]}


============================== 00:26:11.781552 | c03916ea-a359-4dec-836f-ea2a34a1ee10 ==============================
[0m00:26:11.781552 [info ] [MainThread]: Running with dbt=1.11.4
[0m00:26:11.782125 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'empty': 'False', 'log_path': '/dbt/logs', 'log_cache_events': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'printer_width': '80', 'write_json': 'True', 'fail_fast': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'target_path': 'None', 'use_colors': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '.', 'indirect_selection': 'eager', 'introspect': 'True', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --full-refresh --profiles-dir .'}
[0m00:26:11.909366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c03916ea-a359-4dec-836f-ea2a34a1ee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7a03bf7e00>]}
[0m00:26:11.946743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c03916ea-a359-4dec-836f-ea2a34a1ee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7a038bad80>]}
[0m00:26:11.948060 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m00:26:11.978171 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m00:26:11.979015 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.24627177, "process_in_blocks": "0", "process_kernel_time": 0.164112, "process_mem_max_rss": "134884", "process_out_blocks": "24", "process_user_time": 0.976256}
[0m00:26:11.979468 [debug] [MainThread]: Command `dbt build` failed at 00:26:11.979391 after 0.25 seconds
[0m00:26:11.979861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7a03d5b980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7a0433f350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7a03bb7590>]}
[0m00:26:11.980460 [debug] [MainThread]: Flushing usage events
[0m00:26:12.275554 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:40:38.266455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa1c5c3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa1be3c320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa1b954b00>]}


============================== 00:40:38.270065 | c60b60dd-566e-4b61-a679-4061319386af ==============================
[0m00:40:38.270065 [info ] [MainThread]: Running with dbt=1.11.4
[0m00:40:38.270715 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'profiles_dir': '.', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'invocation_command': 'dbt deps --profiles-dir .', 'printer_width': '80', 'no_print': 'None', 'fail_fast': 'False', 'warn_error': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'version_check': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'partial_parse': 'True', 'empty': 'None', 'log_path': '/dbt/logs'}
[0m00:40:38.397622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c60b60dd-566e-4b61-a679-4061319386af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa1b5713a0>]}
[0m00:40:38.409617 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-f0ehra19'
[0m00:40:38.410280 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:40:38.695437 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:40:38.696845 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:40:38.793896 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:40:38.805602 [info ] [MainThread]: Updating lock file in file path: /dbt/package-lock.yml
[0m00:40:38.818920 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-md0af697'
[0m00:40:38.821099 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:40:42.590773 [info ] [MainThread]: Installed from version 1.3.3
[0m00:40:42.591380 [info ] [MainThread]: Up to date!
[0m00:40:42.591915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c60b60dd-566e-4b61-a679-4061319386af', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa1c44b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa1c1926c0>]}
[0m00:40:42.593038 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.3832073, "process_in_blocks": "0", "process_kernel_time": 0.439572, "process_mem_max_rss": "106228", "process_out_blocks": "176", "process_user_time": 1.305661}
[0m00:40:42.593590 [debug] [MainThread]: Command `dbt deps` succeeded at 00:40:42.593484 after 4.38 seconds
[0m00:40:42.594035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa1be64680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa1c2c5dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa1bd03f80>]}
[0m00:40:42.594702 [debug] [MainThread]: Flushing usage events
[0m00:40:42.883026 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:40:44.340674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfa468dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf8910dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfa469610>]}


============================== 00:40:44.345262 | ca3b38d1-1db4-4625-91e9-c25da509abd6 ==============================
[0m00:40:44.345262 [info ] [MainThread]: Running with dbt=1.11.4
[0m00:40:44.345885 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'log_format': 'default', 'use_colors': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'introspect': 'True', 'invocation_command': 'dbt build --full-refresh --profiles-dir .', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'log_path': '/dbt/logs', 'target_path': 'None', 'write_json': 'True'}
[0m00:40:44.566725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfa0441a0>]}
[0m00:40:44.618866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf81772c0>]}
[0m00:40:44.620729 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m00:40:44.686988 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m00:40:44.692891 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:40:44.693744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbe8437f50>]}
[0m00:40:46.953346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba1e5aea0>]}
[0m00:40:47.063357 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m00:40:47.068779 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m00:40:47.105666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba1d0afc0>]}
[0m00:40:47.106264 [info ] [MainThread]: Found 14 models, 74 data tests, 3 seeds, 1 source, 578 macros
[0m00:40:47.111587 [info ] [MainThread]: 
[0m00:40:47.112201 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:40:47.112627 [info ] [MainThread]: 
[0m00:40:47.113259 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:40:47.117052 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m00:40:47.144789 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m00:40:47.145525 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m00:40:47.146079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:40:47.162546 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m00:40:47.164279 [debug] [ThreadPool]: On list_dev: Close
[0m00:40:47.168076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m00:40:47.168796 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m00:40:47.174360 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m00:40:47.174964 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m00:40:47.175434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:40:47.189431 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m00:40:47.190976 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m00:40:47.191558 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m00:40:47.192131 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:40:47.192460 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m00:40:47.192908 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m00:40:47.193543 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:40:47.194276 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m00:40:47.194684 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m00:40:47.195073 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m00:40:47.195625 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:40:47.195979 [debug] [ThreadPool]: On create_dev_main: Close
[0m00:40:47.200050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m00:40:47.204071 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m00:40:47.204645 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m00:40:47.205102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:40:47.218695 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m00:40:47.219312 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m00:40:47.219646 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m00:40:47.227549 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m00:40:47.228762 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m00:40:47.229636 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m00:40:47.230076 [debug] [ThreadPool]: On list_dev_main: Close
[0m00:40:47.233488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba1e542c0>]}
[0m00:40:47.234142 [debug] [MainThread]: Using duckdb connection "master"
[0m00:40:47.234473 [debug] [MainThread]: On master: BEGIN
[0m00:40:47.234753 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:40:47.247292 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m00:40:47.247846 [debug] [MainThread]: On master: COMMIT
[0m00:40:47.248211 [debug] [MainThread]: Using duckdb connection "master"
[0m00:40:47.248827 [debug] [MainThread]: On master: COMMIT
[0m00:40:47.249434 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:40:47.249792 [debug] [MainThread]: On master: Close
[0m00:40:47.256090 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.dim_dates
[0m00:40:47.256562 [debug] [Thread-2 (]: Began running node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m00:40:47.256871 [debug] [Thread-3 (]: Began running node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m00:40:47.257356 [info ] [Thread-1 (]: 1 of 91 START sql table model main.dim_dates ................................... [RUN]
[0m00:40:47.257740 [debug] [Thread-4 (]: Began running node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m00:40:47.258118 [info ] [Thread-2 (]: 2 of 91 START sql table model main.stg_yellow_trips ............................ [RUN]
[0m00:40:47.258707 [info ] [Thread-3 (]: 3 of 91 START seed file main.payment_type_lookup ............................... [RUN]
[0m00:40:47.259620 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nyc_taxi_pipeline_00.dim_dates'
[0m00:40:47.260176 [info ] [Thread-4 (]: 4 of 91 START seed file main.rate_code_lookup .................................. [RUN]
[0m00:40:47.260868 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.nyc_taxi_pipeline_00.stg_yellow_trips'
[0m00:40:47.261337 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.nyc_taxi_pipeline_00.payment_type_lookup'
[0m00:40:47.261742 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_dates
[0m00:40:47.262218 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.nyc_taxi_pipeline_00.rate_code_lookup'
[0m00:40:47.262601 [debug] [Thread-2 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m00:40:47.262946 [debug] [Thread-3 (]: Began compiling node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m00:40:47.271376 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m00:40:47.271745 [debug] [Thread-4 (]: Began compiling node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m00:40:47.275959 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m00:40:47.276652 [debug] [Thread-3 (]: Began executing node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m00:40:47.277155 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: BEGIN
[0m00:40:47.277570 [debug] [Thread-4 (]: Began executing node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m00:40:47.286730 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:40:47.300075 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m00:40:47.301247 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m00:40:47.301724 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: BEGIN
[0m00:40:47.302336 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: BEGIN
[0m00:40:47.302994 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:40:47.303429 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:40:47.305602 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m00:40:47.306018 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m00:40:47.306481 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m00:40:47.306883 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m00:40:47.307334 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m00:40:47.307876 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */


        select 
        (date_diff('day', cast('2024-01-01' as date)::timestamp, cast('2024-02-01' as date)::timestamp ))
    
[0m00:40:47.308455 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m00:40:47.308884 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.payment_type_lookup"} */

    create table "dev"."main"."payment_type_lookup" ("payment_type_id" integer,"payment_type_name" varchar)
  
[0m00:40:47.309662 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.rate_code_lookup"} */

    create table "dev"."main"."rate_code_lookup" ("rate_code_id" integer,"rate_code_name" varchar)
  
[0m00:40:47.310307 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.310846 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.311270 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.312765 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_dates"
[0m00:40:47.318384 [debug] [Thread-2 (]: Began executing node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m00:40:47.321200 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m00:40:47.322124 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m00:40:47.340755 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m00:40:47.341099 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: 
          COPY "dev"."main"."payment_type_lookup" FROM '/dbt/seeds/payment_type_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m00:40:47.341544 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: 
          COPY "dev"."main"."rate_code_lookup" FROM '/dbt/seeds/rate_code_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m00:40:47.352669 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.dim_dates
[0m00:40:47.353053 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m00:40:47.353356 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m00:40:47.367945 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m00:40:47.371526 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m00:40:47.372465 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m00:40:47.373260 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
DESCRIBE (select * from (
        /*
    Dimension table: Calendar dates for January 2024.
    Uses adapter-dispatched macros for dayname/monthname.
*/

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 31
    order by generated_number



),

all_periods as (

    select (
        

    date_add(cast('2024-01-01' as date), interval (row_number() over (order by generated_number) - 1) day)


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-02-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week_num,
        
    dayname(date_day)
 as day_of_week_name,
        
    monthname(date_day)
 as month_name,
        extract(week from date_day) as week_of_year,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when cast(date_day as date) in (
                cast('2024-01-01' as date),
                cast('2024-01-15' as date)
            ) then true
            else false
        end as is_holiday

    from date_spine
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:40:47.373815 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m00:40:47.376613 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: BEGIN
[0m00:40:47.377075 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:40:47.377864 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.378235 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m00:40:47.378836 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:40:47.379178 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */

  
    
    

    create  table
      "dev"."main"."stg_yellow_trips__dbt_tmp"
  
    as (
      

with source as (
    select * from read_parquet('/data/yellow_tripdata_2024-01.parquet')
),

renamed as (
    select
        -- surrogate key (MD5 hash of composite key)
        md5(cast(coalesce(cast(VendorID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(PULocationID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DOLocationID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(fare_amount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(total_amount as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- identifiers
        cast("VendorID" as integer) as vendor_id,
        cast("RatecodeID" as integer) as rate_code_id,
        cast("PULocationID" as integer) as pickup_location_id,
        cast("DOLocationID" as integer) as dropoff_location_id,
        cast(payment_type as integer) as payment_type_id,

        -- timestamps
        cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
        cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as double) as trip_distance_miles,
        store_and_fwd_flag,

        -- financials
        round(cast(fare_amount as decimal(10, 2)), 2) as fare_amount,
        round(cast(extra as decimal(10, 2)), 2) as extra_amount,
        round(cast(mta_tax as decimal(10, 2)), 2) as mta_tax,
        round(cast(tip_amount as decimal(10, 2)), 2) as tip_amount,
        round(cast(tolls_amount as decimal(10, 2)), 2) as tolls_amount,
        round(cast(improvement_surcharge as decimal(10, 2)), 2) as improvement_surcharge,
        round(cast(total_amount as decimal(10, 2)), 2) as total_amount,
        round(cast(congestion_surcharge as decimal(10, 2)), 2) as congestion_surcharge,
        round(cast(Airport_fee as decimal(10, 2)), 2) as airport_fee

    from source
    where tpep_pickup_datetime is not null
      and tpep_dropoff_datetime is not null
      and trip_distance >= 0
      and fare_amount >= 0
      -- filter out-of-range dates (data quality: ~18 trips outside Jan 2024)
      and cast(tpep_pickup_datetime as date) >= date '2024-01-01'
      and cast(tpep_pickup_datetime as date) < date '2024-02-01'
)

select * from renamed
    );
  
  
[0m00:40:47.392143 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m00:40:47.397911 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as date_key, 
      
    cast(null as bigint)
 as year, 
      
    cast(null as bigint)
 as month, 
      
    cast(null as bigint)
 as day_of_month, 
      
    cast(null as bigint)
 as day_of_week_num, 
      
    cast(null as varchar)
 as day_of_week_name, 
      
    cast(null as varchar)
 as month_name, 
      
    cast(null as bigint)
 as week_of_year, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as boolean)
 as is_holiday
    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:40:47.403139 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: COMMIT
[0m00:40:47.404220 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m00:40:47.405296 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:40:47.405909 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: COMMIT
[0m00:40:47.407466 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: COMMIT
[0m00:40:47.429993 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m00:40:47.430401 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_dates"
[0m00:40:47.430812 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m00:40:47.431176 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: COMMIT
[0m00:40:47.433632 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: Close
[0m00:40:47.435846 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfadaa6c0>]}
[0m00:40:47.436712 [info ] [Thread-3 (]: 3 of 91 OK loaded seed file main.payment_type_lookup ........................... [[32mCREATE 6[0m in 0.17s]
[0m00:40:47.437425 [debug] [Thread-3 (]: Finished running node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m00:40:47.437827 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m00:40:47.438272 [debug] [Thread-3 (]: Began running node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m00:40:47.439714 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: Close
[0m00:40:47.440428 [info ] [Thread-3 (]: 5 of 91 START seed file main.taxi_zone_lookup .................................. [RUN]
[0m00:40:47.441426 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba1c6f530>]}
[0m00:40:47.442018 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.payment_type_lookup, now seed.nyc_taxi_pipeline_00.taxi_zone_lookup)
[0m00:40:47.442866 [info ] [Thread-4 (]: 4 of 91 OK loaded seed file main.rate_code_lookup .............................. [[32mCREATE 7[0m in 0.18s]
[0m00:40:47.443489 [debug] [Thread-3 (]: Began compiling node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m00:40:47.444288 [debug] [Thread-4 (]: Finished running node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m00:40:47.444853 [debug] [Thread-3 (]: Began executing node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m00:40:47.445774 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m00:40:47.448659 [info ] [Thread-4 (]: 6 of 91 START test not_null_payment_type_lookup_payment_type_id ................ [RUN]
[0m00:40:47.449318 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.rate_code_lookup, now test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521)
[0m00:40:47.450393 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m00:40:47.457552 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m00:40:47.460430 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m00:40:47.461267 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_dates__dbt_tmp"
  
  (
    date_key date,
    year bigint,
    month bigint,
    day_of_month bigint,
    day_of_week_num bigint,
    day_of_week_name varchar,
    month_name varchar,
    week_of_year bigint,
    is_weekend boolean,
    is_holiday boolean
    
    )
 ;
    insert into "dev"."main"."dim_dates__dbt_tmp" 
  (
    
      
      date_key ,
    
      
      year ,
    
      
      month ,
    
      
      day_of_month ,
    
      
      day_of_week_num ,
    
      
      day_of_week_name ,
    
      
      month_name ,
    
      
      week_of_year ,
    
      
      is_weekend ,
    
      
      is_holiday 
    
  )
 (
      
    select date_key, year, month, day_of_month, day_of_week_num, day_of_week_name, month_name, week_of_year, is_weekend, is_holiday
    from (
        /*
    Dimension table: Calendar dates for January 2024.
    Uses adapter-dispatched macros for dayname/monthname.
*/

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 31
    order by generated_number



),

all_periods as (

    select (
        

    date_add(cast('2024-01-01' as date), interval (row_number() over (order by generated_number) - 1) day)


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-02-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week_num,
        
    dayname(date_day)
 as day_of_week_name,
        
    monthname(date_day)
 as month_name,
        extract(week from date_day) as week_of_year,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when cast(date_day as date) in (
                cast('2024-01-01' as date),
                cast('2024-01-15' as date)
            ) then true
            else false
        end as is_holiday

    from date_spine
)

select * from final
    ) as model_subq
    );
  
  
[0m00:40:47.462053 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m00:40:47.463435 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: BEGIN
[0m00:40:47.463872 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:47.464739 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.465286 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m00:40:47.465804 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"} */

    create table "dev"."main"."taxi_zone_lookup" ("LocationID" integer,"Borough" varchar,"Zone" varchar,"service_zone" varchar)
  
[0m00:40:47.467038 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.468487 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m00:40:47.469015 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: 
          COPY "dev"."main"."taxi_zone_lookup" FROM '/dbt/seeds/taxi_zone_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m00:40:47.470520 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m00:40:47.477486 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m00:40:47.478203 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
alter table "dev"."main"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m00:40:47.478600 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m00:40:47.479599 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m00:40:47.479984 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.481566 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: COMMIT
[0m00:40:47.482251 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m00:40:47.482763 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: COMMIT
[0m00:40:47.483185 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m00:40:47.494773 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m00:40:47.495238 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m00:40:47.499646 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m00:40:47.501429 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: COMMIT
[0m00:40:47.501832 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
drop table if exists "dev"."main"."dim_dates__dbt_backup" cascade
[0m00:40:47.502404 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m00:40:47.503569 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: COMMIT
[0m00:40:47.504013 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.505514 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: Close
[0m00:40:47.506284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba008a330>]}
[0m00:40:47.507191 [info ] [Thread-1 (]: 1 of 91 OK created sql table model main.dim_dates .............................. [[32mOK[0m in 0.25s]
[0m00:40:47.507774 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.dim_dates
[0m00:40:47.508104 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m00:40:47.508570 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m00:40:47.509729 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: Close
[0m00:40:47.510323 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m00:40:47.510711 [info ] [Thread-1 (]: 7 of 91 START test unique_payment_type_lookup_payment_type_id .................. [RUN]
[0m00:40:47.511569 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba1183c20>]}
[0m00:40:47.511889 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: BEGIN
[0m00:40:47.512490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_dates, now test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7)
[0m00:40:47.513321 [info ] [Thread-3 (]: 5 of 91 OK loaded seed file main.taxi_zone_lookup .............................. [[32mCREATE 265[0m in 0.07s]
[0m00:40:47.513996 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:47.514583 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m00:40:47.515239 [debug] [Thread-3 (]: Finished running node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m00:40:47.516303 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m00:40:47.521544 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m00:40:47.522500 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m00:40:47.523774 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m00:40:47.524731 [info ] [Thread-3 (]: 8 of 91 START test not_null_rate_code_lookup_rate_code_id ...................... [RUN]
[0m00:40:47.525573 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."payment_type_lookup"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m00:40:47.526423 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.taxi_zone_lookup, now test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec)
[0m00:40:47.527263 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m00:40:47.530572 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m00:40:47.531075 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m00:40:47.534569 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: ROLLBACK
[0m00:40:47.535786 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521'
[0m00:40:47.536174 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m00:40:47.538306 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: Close
[0m00:40:47.540641 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m00:40:47.541088 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m00:40:47.541655 [info ] [Thread-4 (]: 6 of 91 PASS not_null_payment_type_lookup_payment_type_id ...................... [[32mPASS[0m in 0.09s]
[0m00:40:47.544172 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m00:40:47.544983 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m00:40:47.545878 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m00:40:47.546291 [info ] [Thread-4 (]: 9 of 91 START test unique_rate_code_lookup_rate_code_id ........................ [RUN]
[0m00:40:47.546843 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521, now test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d)
[0m00:40:47.547298 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m00:40:47.550677 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m00:40:47.552067 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m00:40:47.552428 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m00:40:47.552755 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: BEGIN
[0m00:40:47.553233 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: BEGIN
[0m00:40:47.553905 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:47.554533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:47.555815 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:47.556138 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:40:47.556510 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m00:40:47.557025 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m00:40:47.557654 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_id
from "dev"."main"."rate_code_lookup"
where rate_code_id is null



  
  
      
    ) dbt_internal_test
[0m00:40:47.558464 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."payment_type_lookup"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:40:47.559373 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m00:40:47.560072 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.562533 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m00:40:47.563113 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:40:47.564609 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: ROLLBACK
[0m00:40:47.566324 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: ROLLBACK
[0m00:40:47.566997 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec'
[0m00:40:47.567747 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7'
[0m00:40:47.568244 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: Close
[0m00:40:47.568835 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: Close
[0m00:40:47.569506 [info ] [Thread-3 (]: 8 of 91 PASS not_null_rate_code_lookup_rate_code_id ............................ [[32mPASS[0m in 0.04s]
[0m00:40:47.569991 [info ] [Thread-1 (]: 7 of 91 PASS unique_payment_type_lookup_payment_type_id ........................ [[32mPASS[0m in 0.06s]
[0m00:40:47.570452 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m00:40:47.571163 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m00:40:47.571884 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m00:40:47.572571 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m00:40:47.573162 [info ] [Thread-3 (]: 10 of 91 START test not_null_dim_dates_date_key ................................ [RUN]
[0m00:40:47.573833 [info ] [Thread-1 (]: 11 of 91 START test not_null_dim_dates_day_of_week_name ........................ [RUN]
[0m00:40:47.574244 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m00:40:47.574673 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec, now test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348)
[0m00:40:47.575143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7, now test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541)
[0m00:40:47.575638 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: BEGIN
[0m00:40:47.576208 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m00:40:47.576799 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m00:40:47.577332 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:47.580784 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m00:40:47.584373 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m00:40:47.585853 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m00:40:47.586689 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m00:40:47.587187 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rate_code_id as unique_field,
    count(*) as n_records

from "dev"."main"."rate_code_lookup"
where rate_code_id is not null
group by rate_code_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:40:47.589039 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.590747 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: ROLLBACK
[0m00:40:47.591547 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d'
[0m00:40:47.592239 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: Close
[0m00:40:47.592981 [info ] [Thread-4 (]: 9 of 91 PASS unique_rate_code_lookup_rate_code_id .............................. [[32mPASS[0m in 0.05s]
[0m00:40:47.593639 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m00:40:47.594224 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m00:40:47.594905 [info ] [Thread-4 (]: 12 of 91 START test not_null_dim_dates_is_holiday .............................. [RUN]
[0m00:40:47.595730 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d, now test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a)
[0m00:40:47.596453 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m00:40:47.596829 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m00:40:47.599496 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m00:40:47.600002 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m00:40:47.603601 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m00:40:47.606644 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m00:40:47.614883 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m00:40:47.615705 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: BEGIN
[0m00:40:47.616229 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:47.617221 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.617579 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m00:40:47.617942 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m00:40:47.618214 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m00:40:47.621795 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m00:40:47.622613 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: BEGIN
[0m00:40:47.623693 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "dev"."main"."dim_dates"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m00:40:47.624980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:47.626525 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:40:47.626951 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.627243 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m00:40:47.628862 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: ROLLBACK
[0m00:40:47.629205 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select day_of_week_name
from "dev"."main"."dim_dates"
where day_of_week_name is null



  
  
      
    ) dbt_internal_test
[0m00:40:47.630248 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348'
[0m00:40:47.631118 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: Close
[0m00:40:47.631656 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.632176 [info ] [Thread-3 (]: 10 of 91 PASS not_null_dim_dates_date_key ...................................... [[32mPASS[0m in 0.06s]
[0m00:40:47.633535 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: ROLLBACK
[0m00:40:47.634451 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m00:40:47.635639 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541'
[0m00:40:47.636264 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m00:40:47.636704 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m00:40:47.637433 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: Close
[0m00:40:47.638123 [info ] [Thread-3 (]: 13 of 91 START test not_null_dim_dates_is_weekend .............................. [RUN]
[0m00:40:47.638696 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: BEGIN
[0m00:40:47.639634 [info ] [Thread-1 (]: 11 of 91 PASS not_null_dim_dates_day_of_week_name .............................. [[32mPASS[0m in 0.06s]
[0m00:40:47.640043 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348, now test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0)
[0m00:40:47.640636 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:47.641384 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m00:40:47.642312 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m00:40:47.643328 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m00:40:47.643789 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m00:40:47.647249 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m00:40:47.648033 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m00:40:47.648746 [info ] [Thread-1 (]: 14 of 91 START test unique_dim_dates_date_key .................................. [RUN]
[0m00:40:47.649881 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_holiday
from "dev"."main"."dim_dates"
where is_holiday is null



  
  
      
    ) dbt_internal_test
[0m00:40:47.650602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541, now test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d)
[0m00:40:47.651540 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m00:40:47.654876 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m00:40:47.655312 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m00:40:47.657316 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: ROLLBACK
[0m00:40:47.658706 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a'
[0m00:40:47.659219 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: Close
[0m00:40:47.660076 [info ] [Thread-4 (]: 12 of 91 PASS not_null_dim_dates_is_holiday .................................... [[32mPASS[0m in 0.06s]
[0m00:40:47.660978 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m00:40:47.661487 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m00:40:47.661917 [info ] [Thread-4 (]: 15 of 91 START test not_null_taxi_zone_lookup_Borough .......................... [RUN]
[0m00:40:47.662608 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a, now test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa)
[0m00:40:47.663005 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m00:40:47.663486 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m00:40:47.666184 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m00:40:47.666680 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m00:40:47.669848 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m00:40:47.673060 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m00:40:47.677564 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m00:40:47.678152 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: BEGIN
[0m00:40:47.678539 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:47.679388 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.680046 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m00:40:47.680480 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m00:40:47.680826 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m00:40:47.681287 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: BEGIN
[0m00:40:47.681822 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."dim_dates"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m00:40:47.684567 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m00:40:47.685400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:47.686887 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.687697 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:40:47.689754 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: ROLLBACK
[0m00:40:47.690123 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m00:40:47.691476 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0'
[0m00:40:47.692126 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "dev"."main"."dim_dates"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:40:47.693267 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: Close
[0m00:40:47.695251 [info ] [Thread-3 (]: 13 of 91 PASS not_null_dim_dates_is_weekend .................................... [[32mPASS[0m in 0.06s]
[0m00:40:47.695649 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.696051 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m00:40:47.697978 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: ROLLBACK
[0m00:40:47.698348 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m00:40:47.699197 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d'
[0m00:40:47.700741 [info ] [Thread-3 (]: 16 of 91 START test not_null_taxi_zone_lookup_LocationID ....................... [RUN]
[0m00:40:47.701630 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: Close
[0m00:40:47.702307 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0, now test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a)
[0m00:40:47.702760 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m00:40:47.703388 [info ] [Thread-1 (]: 14 of 91 PASS unique_dim_dates_date_key ........................................ [[32mPASS[0m in 0.05s]
[0m00:40:47.704096 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m00:40:47.704758 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: BEGIN
[0m00:40:47.705487 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m00:40:47.708888 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m00:40:47.709544 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:47.710440 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m00:40:47.712383 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m00:40:47.712044 [info ] [Thread-1 (]: 17 of 91 START test unique_taxi_zone_lookup_LocationID ......................... [RUN]
[0m00:40:47.712796 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m00:40:47.713478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d, now test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8)
[0m00:40:47.713993 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Borough
from "dev"."main"."taxi_zone_lookup"
where Borough is null



  
  
      
    ) dbt_internal_test
[0m00:40:47.714612 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m00:40:47.718979 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m00:40:47.719722 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m00:40:47.721183 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: ROLLBACK
[0m00:40:47.722053 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa'
[0m00:40:47.722415 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m00:40:47.722724 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: Close
[0m00:40:47.726495 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m00:40:47.726930 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m00:40:47.727860 [info ] [Thread-4 (]: 15 of 91 PASS not_null_taxi_zone_lookup_Borough ................................ [[32mPASS[0m in 0.07s]
[0m00:40:47.730428 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m00:40:47.731406 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m00:40:47.732857 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.stg_payment_types
[0m00:40:47.733406 [info ] [Thread-4 (]: 18 of 91 START sql view model main.stg_payment_types ........................... [RUN]
[0m00:40:47.734038 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa, now model.nyc_taxi_pipeline_00.stg_payment_types)
[0m00:40:47.734635 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_payment_types
[0m00:40:47.737203 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m00:40:47.738366 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m00:40:47.739037 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: BEGIN
[0m00:40:47.739419 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m00:40:47.739940 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:47.740598 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: BEGIN
[0m00:40:47.741851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:47.742209 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:47.742734 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.743044 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m00:40:47.743472 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m00:40:47.744158 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select LocationID
from "dev"."main"."taxi_zone_lookup"
where LocationID is null



  
  
      
    ) dbt_internal_test
[0m00:40:47.745075 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    LocationID as unique_field,
    count(*) as n_records

from "dev"."main"."taxi_zone_lookup"
where LocationID is not null
group by LocationID
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:40:47.746764 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.747432 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.747864 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.stg_payment_types
[0m00:40:47.749324 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: ROLLBACK
[0m00:40:47.750843 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: ROLLBACK
[0m00:40:47.763454 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m00:40:47.764964 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a'
[0m00:40:47.765571 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8'
[0m00:40:47.766640 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: Close
[0m00:40:47.767341 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: Close
[0m00:40:47.768569 [info ] [Thread-3 (]: 16 of 91 PASS not_null_taxi_zone_lookup_LocationID ............................. [[32mPASS[0m in 0.07s]
[0m00:40:47.769550 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m00:40:47.770031 [info ] [Thread-1 (]: 17 of 91 PASS unique_taxi_zone_lookup_LocationID ............................... [[32mPASS[0m in 0.06s]
[0m00:40:47.770402 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m00:40:47.771421 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m00:40:47.772183 [info ] [Thread-3 (]: 19 of 91 START sql view model main.stg_rate_codes .............................. [RUN]
[0m00:40:47.773297 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m00:40:47.773767 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a, now model.nyc_taxi_pipeline_00.stg_rate_codes)
[0m00:40:47.774443 [info ] [Thread-1 (]: 20 of 91 START sql view model main.stg_taxi_zones .............................. [RUN]
[0m00:40:47.775123 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m00:40:47.775835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8, now model.nyc_taxi_pipeline_00.stg_taxi_zones)
[0m00:40:47.776351 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m00:40:47.778675 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m00:40:47.779629 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m00:40:47.780374 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: BEGIN
[0m00:40:47.783889 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m00:40:47.784637 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:47.786207 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m00:40:47.786769 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m00:40:47.787310 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */

  
  create view "dev"."main"."stg_payment_types__dbt_tmp" as (
    /*
    Staging model: Payment type lookup
    Maps payment_type_id to human-readable names.
*/

with source as (
    select * from "dev"."main"."payment_type_lookup"
),

renamed as (
    select
        payment_type_id,
        payment_type_name
    from source
)

select * from renamed
  );

[0m00:40:47.788451 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.791199 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m00:40:47.792044 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
alter view "dev"."main"."stg_payment_types__dbt_tmp" rename to "stg_payment_types"
[0m00:40:47.792539 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m00:40:47.795493 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m00:40:47.795971 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m00:40:47.796563 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m00:40:47.799549 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m00:40:47.801246 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: COMMIT
[0m00:40:47.802220 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m00:40:47.802612 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: COMMIT
[0m00:40:47.804888 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m00:40:47.805463 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: BEGIN
[0m00:40:47.806055 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:47.806903 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m00:40:47.807314 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.887525 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m00:40:47.888209 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m00:40:47.888635 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m00:40:47.889302 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: BEGIN
[0m00:40:47.890168 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
drop view if exists "dev"."main"."stg_payment_types__dbt_backup" cascade
[0m00:40:47.890834 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */

  
  create view "dev"."main"."stg_rate_codes__dbt_tmp" as (
    /*
    Staging model: Rate code lookup
    Maps rate_code_id to human-readable names.
*/

with source as (
    select * from "dev"."main"."rate_code_lookup"
),

renamed as (
    select
        rate_code_id,
        rate_code_name
    from source
)

select * from renamed
  );

[0m00:40:47.891362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:47.892888 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.893940 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:40:47.894236 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:47.895381 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: Close
[0m00:40:47.896058 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m00:40:47.899268 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m00:40:47.900353 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba00d59a0>]}
[0m00:40:47.900977 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */

  
  create view "dev"."main"."stg_taxi_zones__dbt_tmp" as (
    /*
    Staging model: Taxi zone lookup
    Maps LocationID to borough and zone name.
*/

with source as (
    select * from "dev"."main"."taxi_zone_lookup"
),

renamed as (
    select
        cast("LocationID" as integer) as location_id,
        "Borough" as borough,
        "Zone" as zone_name,
        service_zone
    from source
)

select * from renamed
  );

[0m00:40:47.901560 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
alter view "dev"."main"."stg_rate_codes__dbt_tmp" rename to "stg_rate_codes"
[0m00:40:47.902455 [info ] [Thread-4 (]: 18 of 91 OK created sql view model main.stg_payment_types ...................... [[32mOK[0m in 0.17s]
[0m00:40:47.903875 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.904472 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.stg_payment_types
[0m00:40:47.905002 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.907981 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m00:40:47.909639 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m00:40:47.910955 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: COMMIT
[0m00:40:47.911575 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
alter view "dev"."main"."stg_taxi_zones__dbt_tmp" rename to "stg_taxi_zones"
[0m00:40:47.912165 [info ] [Thread-4 (]: 21 of 91 START test not_null_stg_payment_types_payment_type_id ................. [RUN]
[0m00:40:47.912761 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m00:40:47.913967 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_payment_types, now test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78)
[0m00:40:47.914754 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.915204 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: COMMIT
[0m00:40:47.915719 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m00:40:47.917033 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: COMMIT
[0m00:40:47.920770 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m00:40:47.921386 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m00:40:47.921732 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m00:40:47.924063 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m00:40:47.925009 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: COMMIT
[0m00:40:47.925802 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
drop view if exists "dev"."main"."stg_rate_codes__dbt_backup" cascade
[0m00:40:47.927245 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m00:40:47.928678 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: Close
[0m00:40:47.929543 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb2010f3e0>]}
[0m00:40:47.930120 [info ] [Thread-3 (]: 19 of 91 OK created sql view model main.stg_rate_codes ......................... [[32mOK[0m in 0.16s]
[0m00:40:47.930638 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m00:40:47.930894 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m00:40:47.931232 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m00:40:47.933721 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m00:40:47.934302 [info ] [Thread-3 (]: 22 of 91 START test not_null_stg_payment_types_payment_type_name ............... [RUN]
[0m00:40:47.935102 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
drop view if exists "dev"."main"."stg_taxi_zones__dbt_backup" cascade
[0m00:40:47.935660 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_rate_codes, now test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39)
[0m00:40:47.936700 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m00:40:47.937166 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.941074 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m00:40:47.942934 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: Close
[0m00:40:47.944741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb20147e00>]}
[0m00:40:47.945470 [info ] [Thread-1 (]: 20 of 91 OK created sql view model main.stg_taxi_zones ......................... [[32mOK[0m in 0.17s]
[0m00:40:47.946054 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m00:40:47.946601 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m00:40:47.947326 [info ] [Thread-1 (]: 23 of 91 START test unique_stg_payment_types_payment_type_id ................... [RUN]
[0m00:40:47.948223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_taxi_zones, now test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534)
[0m00:40:47.948865 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m00:40:47.952237 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m00:40:47.953688 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m00:40:47.955944 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m00:40:47.956386 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m00:40:47.961221 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m00:40:47.963843 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m00:40:47.966776 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m00:40:47.978090 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m00:40:47.978905 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: BEGIN
[0m00:40:47.979515 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:47.980915 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m00:40:47.981340 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m00:40:47.981726 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: BEGIN
[0m00:40:47.982467 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m00:40:47.983210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:47.983828 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m00:40:47.984206 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."stg_payment_types"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m00:40:47.985445 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: BEGIN
[0m00:40:47.985915 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:40:47.986744 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:47.987507 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.987990 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m00:40:47.988950 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:47.990864 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: ROLLBACK
[0m00:40:47.991396 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_payment_types"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:40:47.992143 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m00:40:47.993152 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78'
[0m00:40:47.994088 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_name
from "dev"."main"."stg_payment_types"
where payment_type_name is null



  
  
      
    ) dbt_internal_test
[0m00:40:47.994739 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: Close
[0m00:40:47.995203 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:40:47.996193 [info ] [Thread-4 (]: 21 of 91 PASS not_null_stg_payment_types_payment_type_id ....................... [[32mPASS[0m in 0.08s]
[0m00:40:47.997296 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: ROLLBACK
[0m00:40:47.997693 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:47.998154 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m00:40:47.999149 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534'
[0m00:40:48.000899 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: ROLLBACK
[0m00:40:48.001274 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m00:40:48.001739 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: Close
[0m00:40:48.002723 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39'
[0m00:40:48.003598 [info ] [Thread-4 (]: 24 of 91 START test not_null_stg_rate_codes_rate_code_id ....................... [RUN]
[0m00:40:48.004877 [info ] [Thread-1 (]: 23 of 91 PASS unique_stg_payment_types_payment_type_id ......................... [[32mPASS[0m in 0.06s]
[0m00:40:48.005219 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: Close
[0m00:40:48.005824 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78, now test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a)
[0m00:40:48.006322 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m00:40:48.007047 [info ] [Thread-3 (]: 22 of 91 PASS not_null_stg_payment_types_payment_type_name ..................... [[32mPASS[0m in 0.07s]
[0m00:40:48.007439 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m00:40:48.007942 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m00:40:48.008765 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m00:40:48.011985 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m00:40:48.012647 [info ] [Thread-1 (]: 25 of 91 START test not_null_stg_rate_codes_rate_code_name ..................... [RUN]
[0m00:40:48.013155 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m00:40:48.014379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534, now test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f)
[0m00:40:48.014970 [info ] [Thread-3 (]: 26 of 91 START test unique_stg_rate_codes_rate_code_id ......................... [RUN]
[0m00:40:48.015504 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m00:40:48.016074 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39, now test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3)
[0m00:40:48.019319 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m00:40:48.020027 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m00:40:48.023981 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m00:40:48.025449 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m00:40:48.027594 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m00:40:48.029222 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m00:40:48.031130 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m00:40:48.031600 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m00:40:48.033947 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m00:40:48.037440 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m00:40:48.038050 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: BEGIN
[0m00:40:48.038566 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:48.039515 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m00:40:48.039908 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.040423 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: BEGIN
[0m00:40:48.040981 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m00:40:48.041480 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m00:40:48.041864 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:48.042592 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_id
from "dev"."main"."stg_rate_codes"
where rate_code_id is null



  
  
      
    ) dbt_internal_test
[0m00:40:48.043198 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: BEGIN
[0m00:40:48.044285 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.044979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:48.045571 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m00:40:48.046047 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.046735 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.047067 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rate_code_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_rate_codes"
where rate_code_id is not null
group by rate_code_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:40:48.048677 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: ROLLBACK
[0m00:40:48.049088 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m00:40:48.050474 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a'
[0m00:40:48.051060 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_name
from "dev"."main"."stg_rate_codes"
where rate_code_name is null



  
  
      
    ) dbt_internal_test
[0m00:40:48.051390 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.052024 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: Close
[0m00:40:48.053907 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: ROLLBACK
[0m00:40:48.054342 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.054984 [info ] [Thread-4 (]: 24 of 91 PASS not_null_stg_rate_codes_rate_code_id ............................. [[32mPASS[0m in 0.05s]
[0m00:40:48.055675 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3'
[0m00:40:48.057312 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: ROLLBACK
[0m00:40:48.057855 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m00:40:48.058334 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: Close
[0m00:40:48.059164 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f'
[0m00:40:48.059645 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m00:40:48.060386 [info ] [Thread-3 (]: 26 of 91 PASS unique_stg_rate_codes_rate_code_id ............................... [[32mPASS[0m in 0.04s]
[0m00:40:48.060796 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: Close
[0m00:40:48.061401 [info ] [Thread-4 (]: 27 of 91 START test not_null_stg_taxi_zones_borough ............................ [RUN]
[0m00:40:48.062008 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m00:40:48.062832 [info ] [Thread-1 (]: 25 of 91 PASS not_null_stg_rate_codes_rate_code_name ........................... [[32mPASS[0m in 0.05s]
[0m00:40:48.063195 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b)
[0m00:40:48.063750 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m00:40:48.064472 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m00:40:48.065008 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m00:40:48.065499 [info ] [Thread-3 (]: 28 of 91 START test not_null_stg_taxi_zones_location_id ........................ [RUN]
[0m00:40:48.066203 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m00:40:48.070045 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m00:40:48.070919 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf)
[0m00:40:48.071564 [info ] [Thread-1 (]: 29 of 91 START test not_null_stg_taxi_zones_zone_name .......................... [RUN]
[0m00:40:48.072541 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m00:40:48.073244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84)
[0m00:40:48.076837 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m00:40:48.077648 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m00:40:48.082393 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m00:40:48.083918 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m00:40:48.085996 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m00:40:48.087096 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m00:40:48.088992 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m00:40:48.089418 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m00:40:48.091919 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m00:40:48.094850 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m00:40:48.095617 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: BEGIN
[0m00:40:48.096197 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:48.097370 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m00:40:48.097820 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.098140 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: BEGIN
[0m00:40:48.098608 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m00:40:48.099050 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m00:40:48.099686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:48.100288 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select borough
from "dev"."main"."stg_taxi_zones"
where borough is null



  
  
      
    ) dbt_internal_test
[0m00:40:48.100933 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: BEGIN
[0m00:40:48.102257 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:40:48.102673 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:48.103048 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.103416 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m00:40:48.104447 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.106040 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: ROLLBACK
[0m00:40:48.106549 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select zone_name
from "dev"."main"."stg_taxi_zones"
where zone_name is null



  
  
      
    ) dbt_internal_test
[0m00:40:48.107130 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m00:40:48.108581 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b'
[0m00:40:48.109473 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "dev"."main"."stg_taxi_zones"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m00:40:48.109939 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.110187 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: Close
[0m00:40:48.111815 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: ROLLBACK
[0m00:40:48.112420 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.112996 [info ] [Thread-4 (]: 27 of 91 PASS not_null_stg_taxi_zones_borough .................................. [[32mPASS[0m in 0.05s]
[0m00:40:48.113937 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84'
[0m00:40:48.115260 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: ROLLBACK
[0m00:40:48.115998 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m00:40:48.116532 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: Close
[0m00:40:48.117580 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf'
[0m00:40:48.117923 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m00:40:48.118848 [info ] [Thread-1 (]: 29 of 91 PASS not_null_stg_taxi_zones_zone_name ................................ [[32mPASS[0m in 0.05s]
[0m00:40:48.119168 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: Close
[0m00:40:48.119741 [info ] [Thread-4 (]: 30 of 91 START test unique_stg_taxi_zones_location_id .......................... [RUN]
[0m00:40:48.120365 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m00:40:48.121189 [info ] [Thread-3 (]: 28 of 91 PASS not_null_stg_taxi_zones_location_id .............................. [[32mPASS[0m in 0.05s]
[0m00:40:48.121578 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b, now test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c)
[0m00:40:48.122124 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.dim_payment_types
[0m00:40:48.122789 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m00:40:48.123244 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m00:40:48.123981 [info ] [Thread-1 (]: 31 of 91 START sql table model main.dim_payment_types .......................... [RUN]
[0m00:40:48.127875 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m00:40:48.129323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84, now model.nyc_taxi_pipeline_00.dim_payment_types)
[0m00:40:48.130416 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_payment_types
[0m00:40:48.133049 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m00:40:48.138283 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m00:40:48.141055 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m00:40:48.142764 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.dim_payment_types
[0m00:40:48.146150 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m00:40:48.147245 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
DESCRIBE (select * from (
        /*
    Dimension table: Payment type descriptions.
*/

with payment_types as (
    select * from "dev"."main"."stg_payment_types"
),

final as (
    select
        payment_type_id,
        payment_type_name
    from payment_types
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:40:48.147957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:48.149920 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.151468 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m00:40:48.152238 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as payment_type_id, 
      
    cast(null as varchar)
 as payment_type_name
    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:40:48.154003 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.154935 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m00:40:48.156450 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m00:40:48.156830 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: BEGIN
[0m00:40:48.157941 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:48.159530 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.160360 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m00:40:48.161055 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_taxi_zones"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:40:48.163325 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.165821 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: ROLLBACK
[0m00:40:48.167211 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c'
[0m00:40:48.168457 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: Close
[0m00:40:48.169502 [info ] [Thread-4 (]: 30 of 91 PASS unique_stg_taxi_zones_location_id ................................ [[32mPASS[0m in 0.05s]
[0m00:40:48.172926 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m00:40:48.174767 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.dim_locations
[0m00:40:48.176039 [info ] [Thread-3 (]: 32 of 91 START sql table model main.dim_locations .............................. [RUN]
[0m00:40:48.176845 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf, now model.nyc_taxi_pipeline_00.dim_locations)
[0m00:40:48.177270 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m00:40:48.177653 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_locations
[0m00:40:48.178363 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: BEGIN
[0m00:40:48.181229 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_locations"
[0m00:40:48.182607 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:40:48.183734 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m00:40:48.184654 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_payment_types__dbt_tmp"
  
  (
    payment_type_id integer,
    payment_type_name varchar
    
    )
 ;
    insert into "dev"."main"."dim_payment_types__dbt_tmp" 
  (
    
      
      payment_type_id ,
    
      
      payment_type_name 
    
  )
 (
      
    select payment_type_id, payment_type_name
    from (
        /*
    Dimension table: Payment type descriptions.
*/

with payment_types as (
    select * from "dev"."main"."stg_payment_types"
),

final as (
    select
        payment_type_id,
        payment_type_name
    from payment_types
)

select * from final
    ) as model_subq
    );
  
  
[0m00:40:48.187269 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.192095 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m00:40:48.192679 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
alter table "dev"."main"."dim_payment_types__dbt_tmp" rename to "dim_payment_types"
[0m00:40:48.193750 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.195108 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: COMMIT
[0m00:40:48.195595 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m00:40:48.196063 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: COMMIT
[0m00:40:48.199831 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.dim_locations
[0m00:40:48.203232 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m00:40:48.204003 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m00:40:48.204430 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
DESCRIBE (select * from (
        /*
    Dimension table: TLC Taxi Zone locations.
*/

with zones as (
    select * from "dev"."main"."stg_taxi_zones"
),

final as (
    select
        location_id,
        borough,
        zone_name,
        service_zone
    from zones
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:40:48.206908 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m00:40:48.207804 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:48.208649 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
drop table if exists "dev"."main"."dim_payment_types__dbt_backup" cascade
[0m00:40:48.210610 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m00:40:48.211060 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.212188 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m00:40:48.213416 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: Close
[0m00:40:48.214183 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as location_id, 
      
    cast(null as varchar)
 as borough, 
      
    cast(null as varchar)
 as zone_name, 
      
    cast(null as varchar)
 as service_zone
    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:40:48.215232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba0089fa0>]}
[0m00:40:48.216656 [info ] [Thread-1 (]: 31 of 91 OK created sql table model main.dim_payment_types ..................... [[32mOK[0m in 0.09s]
[0m00:40:48.217086 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.217623 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.dim_payment_types
[0m00:40:48.219935 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_locations"
[0m00:40:48.221118 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m00:40:48.221481 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m00:40:48.221881 [info ] [Thread-4 (]: 33 of 91 START test not_null_dim_payment_types_payment_type_id ................. [RUN]
[0m00:40:48.222642 [info ] [Thread-1 (]: 34 of 91 START test not_null_dim_payment_types_payment_type_name ............... [RUN]
[0m00:40:48.223585 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c, now test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10)
[0m00:40:48.224206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_payment_types, now test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0)
[0m00:40:48.225250 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m00:40:48.225923 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m00:40:48.230651 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m00:40:48.234573 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m00:40:48.236572 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m00:40:48.237311 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: BEGIN
[0m00:40:48.238845 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.239401 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m00:40:48.240072 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_locations__dbt_tmp"
  
  (
    location_id integer,
    borough varchar,
    zone_name varchar,
    service_zone varchar
    
    )
 ;
    insert into "dev"."main"."dim_locations__dbt_tmp" 
  (
    
      
      location_id ,
    
      
      borough ,
    
      
      zone_name ,
    
      
      service_zone 
    
  )
 (
      
    select location_id, borough, zone_name, service_zone
    from (
        /*
    Dimension table: TLC Taxi Zone locations.
*/

with zones as (
    select * from "dev"."main"."stg_taxi_zones"
),

final as (
    select
        location_id,
        borough,
        zone_name,
        service_zone
    from zones
)

select * from final
    ) as model_subq
    );
  
  
[0m00:40:48.242886 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.246337 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m00:40:48.246853 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m00:40:48.247339 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
alter table "dev"."main"."dim_locations__dbt_tmp" rename to "dim_locations"
[0m00:40:48.249878 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m00:40:48.251493 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.253526 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: COMMIT
[0m00:40:48.254617 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m00:40:48.255315 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m00:40:48.257727 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m00:40:48.258433 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: COMMIT
[0m00:40:48.261202 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m00:40:48.261859 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: BEGIN
[0m00:40:48.262360 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:48.263269 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.263757 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m00:40:48.264163 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m00:40:48.264566 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m00:40:48.267956 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m00:40:48.268751 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: BEGIN
[0m00:40:48.269406 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."dim_payment_types"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m00:40:48.270115 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
drop table if exists "dev"."main"."dim_locations__dbt_backup" cascade
[0m00:40:48.270759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:48.272595 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.273029 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.273395 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:40:48.274879 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: ROLLBACK
[0m00:40:48.276179 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: Close
[0m00:40:48.276896 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m00:40:48.277978 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10'
[0m00:40:48.278775 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba0130dd0>]}
[0m00:40:48.279147 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_name
from "dev"."main"."dim_payment_types"
where payment_type_name is null



  
  
      
    ) dbt_internal_test
[0m00:40:48.279732 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: Close
[0m00:40:48.280583 [info ] [Thread-3 (]: 32 of 91 OK created sql table model main.dim_locations ......................... [[32mOK[0m in 0.10s]
[0m00:40:48.281885 [info ] [Thread-4 (]: 33 of 91 PASS not_null_dim_payment_types_payment_type_id ....................... [[32mPASS[0m in 0.06s]
[0m00:40:48.282415 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.dim_locations
[0m00:40:48.282806 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.283173 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m00:40:48.283739 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m00:40:48.285513 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: ROLLBACK
[0m00:40:48.285928 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m00:40:48.286499 [info ] [Thread-3 (]: 35 of 91 START test unique_dim_payment_types_payment_type_id ................... [RUN]
[0m00:40:48.287621 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0'
[0m00:40:48.288109 [info ] [Thread-4 (]: 36 of 91 START test not_null_dim_locations_borough ............................. [RUN]
[0m00:40:48.288932 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_locations, now test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62)
[0m00:40:48.289485 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: Close
[0m00:40:48.290273 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10, now test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af)
[0m00:40:48.290916 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m00:40:48.291805 [info ] [Thread-1 (]: 34 of 91 PASS not_null_dim_payment_types_payment_type_name ..................... [[32mPASS[0m in 0.07s]
[0m00:40:48.292160 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m00:40:48.295751 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m00:40:48.296731 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m00:40:48.300701 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m00:40:48.302251 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m00:40:48.303170 [info ] [Thread-1 (]: 37 of 91 START test not_null_dim_locations_location_id ......................... [RUN]
[0m00:40:48.304028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0, now test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476)
[0m00:40:48.304793 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m00:40:48.308347 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m00:40:48.309986 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m00:40:48.310405 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m00:40:48.312280 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m00:40:48.314757 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m00:40:48.317772 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m00:40:48.320159 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m00:40:48.325879 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m00:40:48.326665 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: BEGIN
[0m00:40:48.327146 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:48.327912 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m00:40:48.328418 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: BEGIN
[0m00:40:48.328745 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.329120 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:48.329654 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m00:40:48.330843 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select borough
from "dev"."main"."dim_locations"
where borough is null



  
  
      
    ) dbt_internal_test
[0m00:40:48.331301 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m00:40:48.331872 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m00:40:48.332186 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: BEGIN
[0m00:40:48.333240 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m00:40:48.333901 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.334454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:48.335396 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."dim_payment_types"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:40:48.337130 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: ROLLBACK
[0m00:40:48.338055 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:40:48.339218 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af'
[0m00:40:48.339698 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m00:40:48.340044 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.340354 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: Close
[0m00:40:48.340905 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "dev"."main"."dim_locations"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m00:40:48.342667 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: ROLLBACK
[0m00:40:48.343254 [info ] [Thread-4 (]: 36 of 91 PASS not_null_dim_locations_borough ................................... [[32mPASS[0m in 0.05s]
[0m00:40:48.344407 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62'
[0m00:40:48.344964 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.345554 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m00:40:48.346253 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: Close
[0m00:40:48.347647 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: ROLLBACK
[0m00:40:48.348057 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m00:40:48.349010 [info ] [Thread-3 (]: 35 of 91 PASS unique_dim_payment_types_payment_type_id ......................... [[32mPASS[0m in 0.06s]
[0m00:40:48.349930 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476'
[0m00:40:48.350335 [info ] [Thread-4 (]: 38 of 91 START test not_null_dim_locations_zone_name ........................... [RUN]
[0m00:40:48.351091 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m00:40:48.351797 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: Close
[0m00:40:48.352446 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af, now test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d)
[0m00:40:48.352909 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m00:40:48.353758 [info ] [Thread-1 (]: 37 of 91 PASS not_null_dim_locations_location_id ............................... [[32mPASS[0m in 0.05s]
[0m00:40:48.354130 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m00:40:48.354671 [info ] [Thread-3 (]: 39 of 91 START test unique_dim_locations_location_id ........................... [RUN]
[0m00:40:48.355275 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m00:40:48.358718 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m00:40:48.359286 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62, now test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d)
[0m00:40:48.360976 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m00:40:48.364165 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m00:40:48.369976 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m00:40:48.373834 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m00:40:48.376033 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m00:40:48.378389 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m00:40:48.384733 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m00:40:48.385375 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: BEGIN
[0m00:40:48.385912 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:48.387031 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.387514 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m00:40:48.388005 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m00:40:48.388671 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: BEGIN
[0m00:40:48.389289 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select zone_name
from "dev"."main"."dim_locations"
where zone_name is null



  
  
      
    ) dbt_internal_test
[0m00:40:48.389873 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:48.391439 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.391886 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.394057 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: ROLLBACK
[0m00:40:48.394505 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m00:40:48.395848 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d'
[0m00:40:48.396462 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "dev"."main"."dim_locations"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:40:48.397354 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: Close
[0m00:40:48.398815 [info ] [Thread-4 (]: 38 of 91 PASS not_null_dim_locations_zone_name ................................. [[32mPASS[0m in 0.05s]
[0m00:40:48.399822 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.400413 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m00:40:48.402318 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: ROLLBACK
[0m00:40:48.404130 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d'
[0m00:40:48.404849 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: Close
[0m00:40:48.405678 [info ] [Thread-3 (]: 39 of 91 PASS unique_dim_locations_location_id ................................. [[32mPASS[0m in 0.05s]
[0m00:40:48.406643 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m00:40:49.463647 [debug] [Thread-2 (]: SQL status: OK in 2.078 seconds
[0m00:40:49.466455 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m00:40:49.467057 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
alter table "dev"."main"."stg_yellow_trips__dbt_tmp" rename to "stg_yellow_trips"
[0m00:40:49.468107 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m00:40:49.469371 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: COMMIT
[0m00:40:49.469840 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m00:40:49.470238 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: COMMIT
[0m00:40:49.544930 [debug] [Thread-2 (]: SQL status: OK in 0.074 seconds
[0m00:40:49.547119 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m00:40:49.547590 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
drop table if exists "dev"."main"."stg_yellow_trips__dbt_backup" cascade
[0m00:40:49.548490 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m00:40:49.549670 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: Close
[0m00:40:49.598333 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba112d910>]}
[0m00:40:49.599307 [info ] [Thread-2 (]: 2 of 91 OK created sql table model main.stg_yellow_trips ....................... [[32mOK[0m in 2.34s]
[0m00:40:49.599886 [debug] [Thread-2 (]: Finished running node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m00:40:49.601233 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m00:40:49.601589 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m00:40:49.601865 [info ] [Thread-1 (]: 40 of 91 START test accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6  [RUN]
[0m00:40:49.602414 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m00:40:49.602710 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m00:40:49.602964 [info ] [Thread-4 (]: 41 of 91 START test accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99  [RUN]
[0m00:40:49.604063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44)
[0m00:40:49.604648 [info ] [Thread-3 (]: 42 of 91 START test accepted_values_stg_yellow_trips_vendor_id__1__2__6 ........ [RUN]
[0m00:40:49.605185 [info ] [Thread-2 (]: 43 of 91 START test assert_fare_not_exceeds_total .............................. [RUN]
[0m00:40:49.605800 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098)
[0m00:40:49.606212 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m00:40:49.606733 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27)
[0m00:40:49.607241 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_yellow_trips, now test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total)
[0m00:40:49.607714 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m00:40:49.611026 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m00:40:49.611651 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m00:40:49.612170 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m00:40:49.615390 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m00:40:49.619242 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m00:40:49.621906 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m00:40:49.623764 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m00:40:49.625634 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m00:40:49.626942 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m00:40:49.627203 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m00:40:49.628832 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m00:40:49.632441 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m00:40:49.634230 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m00:40:49.634635 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m00:40:49.634970 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: BEGIN
[0m00:40:49.637349 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m00:40:49.638317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:49.638712 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m00:40:49.639684 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: BEGIN
[0m00:40:49.640092 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m00:40:49.640430 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:49.640950 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: BEGIN
[0m00:40:49.641655 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:49.645455 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m00:40:49.646036 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: BEGIN
[0m00:40:49.646484 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:40:49.655970 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m00:40:49.656394 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m00:40:49.656691 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m00:40:49.656955 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m00:40:49.657211 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m00:40:49.657456 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m00:40:49.657855 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m00:40:49.658217 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rate_code_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by rate_code_id

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5','6','99'
)



  
  
      
    ) dbt_internal_test
[0m00:40:49.658695 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m00:40:49.659201 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        vendor_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by vendor_id

)

select *
from all_values
where value_field not in (
    '1','2','6'
)



  
  
      
    ) dbt_internal_test
[0m00:40:49.659600 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        payment_type_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by payment_type_id

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6'
)



  
  
      
    ) dbt_internal_test
[0m00:40:49.660339 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
    Singular test: fare_amount should not exceed total_amount.
*/

select
    trip_id,
    fare_amount,
    total_amount
from "dev"."main"."stg_yellow_trips"
where fare_amount > total_amount + 0.01
  and total_amount > 0
  
  
      
    ) dbt_internal_test
[0m00:40:49.680790 [debug] [Thread-4 (]: SQL status: OK in 0.021 seconds
[0m00:40:49.684082 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: ROLLBACK
[0m00:40:49.686445 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098'
[0m00:40:49.688632 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: Close
[0m00:40:49.689270 [debug] [Thread-3 (]: SQL status: OK in 0.028 seconds
[0m00:40:49.691767 [info ] [Thread-4 (]: 41 of 91 PASS accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99  [[32mPASS[0m in 0.09s]
[0m00:40:49.694202 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: ROLLBACK
[0m00:40:49.694754 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m00:40:49.696355 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27'
[0m00:40:49.696756 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m00:40:49.697689 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m00:40:49.699231 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: Close
[0m00:40:49.701818 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: ROLLBACK
[0m00:40:49.702245 [info ] [Thread-4 (]: 44 of 91 START test not_null_stg_yellow_trips_dropoff_datetime ................. [RUN]
[0m00:40:49.702684 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m00:40:49.703347 [info ] [Thread-3 (]: 42 of 91 PASS accepted_values_stg_yellow_trips_vendor_id__1__2__6 .............. [[32mPASS[0m in 0.10s]
[0m00:40:49.704228 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44'
[0m00:40:49.704655 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052)
[0m00:40:49.705992 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: ROLLBACK
[0m00:40:49.706390 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m00:40:49.706858 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: Close
[0m00:40:49.707213 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m00:40:49.707865 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total'
[0m00:40:49.708146 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m00:40:49.711974 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m00:40:49.708794 [info ] [Thread-1 (]: 40 of 91 PASS accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6  [[32mPASS[0m in 0.10s]
[0m00:40:49.712701 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: Close
[0m00:40:49.713182 [info ] [Thread-3 (]: 45 of 91 START test not_null_stg_yellow_trips_dropoff_location_id .............. [RUN]
[0m00:40:49.714266 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m00:40:49.715012 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048)
[0m00:40:49.715542 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m00:40:49.716171 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m00:40:49.716704 [info ] [Thread-1 (]: 46 of 91 START test not_null_stg_yellow_trips_fare_amount ...................... [RUN]
[0m00:40:49.720713 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m00:40:49.721405 [info ] [Thread-2 (]: 43 of 91 PASS assert_fare_not_exceeds_total .................................... [[32mPASS[0m in 0.11s]
[0m00:40:49.721847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97)
[0m00:40:49.722575 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m00:40:49.722973 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m00:40:49.723400 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m00:40:49.725723 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m00:40:49.726292 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m00:40:49.729796 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m00:40:49.730776 [info ] [Thread-2 (]: 47 of 91 START test not_null_stg_yellow_trips_pickup_datetime .................. [RUN]
[0m00:40:49.731366 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m00:40:49.731741 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed)
[0m00:40:49.734030 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m00:40:49.734792 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m00:40:49.738208 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m00:40:49.739559 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m00:40:49.739963 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m00:40:49.742307 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m00:40:49.743040 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: BEGIN
[0m00:40:49.743825 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m00:40:49.744094 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:49.744678 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: BEGIN
[0m00:40:49.745430 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m00:40:49.746117 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:49.752173 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m00:40:49.753836 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m00:40:49.754373 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: BEGIN
[0m00:40:49.754797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:49.757167 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m00:40:49.757592 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: BEGIN
[0m00:40:49.757960 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:40:49.764435 [debug] [Thread-4 (]: SQL status: OK in 0.020 seconds
[0m00:40:49.764989 [debug] [Thread-3 (]: SQL status: OK in 0.019 seconds
[0m00:40:49.765382 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m00:40:49.765688 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m00:40:49.765942 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m00:40:49.766493 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m00:40:49.766914 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m00:40:49.767318 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_datetime
from "dev"."main"."stg_yellow_trips"
where dropoff_datetime is null



  
  
      
    ) dbt_internal_test
[0m00:40:49.767793 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m00:40:49.768181 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_location_id
from "dev"."main"."stg_yellow_trips"
where dropoff_location_id is null



  
  
      
    ) dbt_internal_test
[0m00:40:49.768654 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fare_amount
from "dev"."main"."stg_yellow_trips"
where fare_amount is null



  
  
      
    ) dbt_internal_test
[0m00:40:49.769362 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "dev"."main"."stg_yellow_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m00:40:49.770136 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:49.770595 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:49.770993 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:49.772068 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: ROLLBACK
[0m00:40:49.772359 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m00:40:49.773625 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: ROLLBACK
[0m00:40:49.774600 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: ROLLBACK
[0m00:40:49.775224 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052'
[0m00:40:49.776319 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: ROLLBACK
[0m00:40:49.777087 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048'
[0m00:40:49.778030 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97'
[0m00:40:49.778682 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: Close
[0m00:40:49.779582 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed'
[0m00:40:49.780348 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: Close
[0m00:40:49.780924 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: Close
[0m00:40:49.781693 [info ] [Thread-4 (]: 44 of 91 PASS not_null_stg_yellow_trips_dropoff_datetime ....................... [[32mPASS[0m in 0.08s]
[0m00:40:49.781994 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: Close
[0m00:40:49.782634 [info ] [Thread-3 (]: 45 of 91 PASS not_null_stg_yellow_trips_dropoff_location_id .................... [[32mPASS[0m in 0.07s]
[0m00:40:49.783143 [info ] [Thread-1 (]: 46 of 91 PASS not_null_stg_yellow_trips_fare_amount ............................ [[32mPASS[0m in 0.06s]
[0m00:40:49.783597 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m00:40:49.784433 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m00:40:49.784941 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m00:40:49.785623 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m00:40:49.786313 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m00:40:49.786929 [info ] [Thread-2 (]: 47 of 91 PASS not_null_stg_yellow_trips_pickup_datetime ........................ [[32mPASS[0m in 0.06s]
[0m00:40:49.787266 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m00:40:49.787794 [info ] [Thread-4 (]: 48 of 91 START test not_null_stg_yellow_trips_pickup_location_id ............... [RUN]
[0m00:40:49.788295 [info ] [Thread-3 (]: 49 of 91 START test not_null_stg_yellow_trips_total_amount ..................... [RUN]
[0m00:40:49.788852 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m00:40:49.789226 [info ] [Thread-1 (]: 50 of 91 START test not_null_stg_yellow_trips_trip_distance_miles .............. [RUN]
[0m00:40:49.789840 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1)
[0m00:40:49.790391 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6)
[0m00:40:49.790847 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m00:40:49.791308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7)
[0m00:40:49.792253 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m00:40:49.792804 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m00:40:49.793241 [info ] [Thread-2 (]: 51 of 91 START test not_null_stg_yellow_trips_trip_id .......................... [RUN]
[0m00:40:49.793646 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m00:40:49.797669 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m00:40:49.800452 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m00:40:49.801236 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1)
[0m00:40:49.804385 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m00:40:49.805536 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m00:40:49.809492 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m00:40:49.814701 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m00:40:49.816939 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m00:40:49.818096 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m00:40:49.820145 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m00:40:49.820513 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m00:40:49.822459 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m00:40:49.822735 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m00:40:49.824726 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m00:40:49.826114 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m00:40:49.826455 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m00:40:49.826747 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: BEGIN
[0m00:40:49.827167 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: BEGIN
[0m00:40:49.827722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:49.829029 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:49.829390 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m00:40:49.830340 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: BEGIN
[0m00:40:49.830653 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:49.831195 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m00:40:49.831555 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: BEGIN
[0m00:40:49.831944 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:40:49.846144 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m00:40:49.846561 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m00:40:49.847007 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m00:40:49.847352 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m00:40:49.847680 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m00:40:49.848278 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m00:40:49.848864 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m00:40:49.849233 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_distance_miles
from "dev"."main"."stg_yellow_trips"
where trip_distance_miles is null



  
  
      
    ) dbt_internal_test
[0m00:40:49.849676 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m00:40:49.850107 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_location_id
from "dev"."main"."stg_yellow_trips"
where pickup_location_id is null



  
  
      
    ) dbt_internal_test
[0m00:40:49.850545 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."stg_yellow_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m00:40:49.851495 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."stg_yellow_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m00:40:49.852570 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:49.852999 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:49.853407 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:49.854581 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: ROLLBACK
[0m00:40:49.854859 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m00:40:49.855804 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: ROLLBACK
[0m00:40:49.856806 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: ROLLBACK
[0m00:40:49.857415 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7'
[0m00:40:49.858735 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: ROLLBACK
[0m00:40:49.859355 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1'
[0m00:40:49.860083 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6'
[0m00:40:49.860479 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: Close
[0m00:40:49.861109 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1'
[0m00:40:49.861545 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: Close
[0m00:40:49.861943 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: Close
[0m00:40:49.862544 [info ] [Thread-1 (]: 50 of 91 PASS not_null_stg_yellow_trips_trip_distance_miles .................... [[32mPASS[0m in 0.07s]
[0m00:40:49.862772 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: Close
[0m00:40:49.863290 [info ] [Thread-4 (]: 48 of 91 PASS not_null_stg_yellow_trips_pickup_location_id ..................... [[32mPASS[0m in 0.07s]
[0m00:40:49.863686 [info ] [Thread-3 (]: 49 of 91 PASS not_null_stg_yellow_trips_total_amount ........................... [[32mPASS[0m in 0.07s]
[0m00:40:49.864251 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m00:40:49.865878 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m00:40:49.866532 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m00:40:49.867234 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m00:40:49.867848 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m00:40:49.868584 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m00:40:49.868334 [info ] [Thread-2 (]: 51 of 91 PASS not_null_stg_yellow_trips_trip_id ................................ [[32mPASS[0m in 0.07s]
[0m00:40:49.868993 [info ] [Thread-1 (]: 52 of 91 START test not_null_stg_yellow_trips_vendor_id ........................ [RUN]
[0m00:40:49.869507 [info ] [Thread-4 (]: 53 of 91 START test unique_stg_yellow_trips_trip_id ............................ [RUN]
[0m00:40:49.869920 [info ] [Thread-3 (]: 54 of 91 START test relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_  [RUN]
[0m00:40:49.870500 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m00:40:49.871134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57)
[0m00:40:49.872155 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1, now test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965)
[0m00:40:49.873773 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6, now test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a)
[0m00:40:49.874566 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m00:40:49.875130 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m00:40:49.875653 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m00:40:49.876231 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m00:40:49.876760 [info ] [Thread-2 (]: 55 of 91 START test relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_  [RUN]
[0m00:40:49.881591 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m00:40:49.884675 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m00:40:49.889048 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m00:40:49.889823 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1, now test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f)
[0m00:40:49.891182 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m00:40:49.894888 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m00:40:49.899085 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m00:40:49.901067 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m00:40:49.902839 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m00:40:49.903183 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m00:40:49.905358 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m00:40:49.907715 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m00:40:49.908049 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m00:40:49.910994 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m00:40:49.912620 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m00:40:49.912989 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m00:40:49.913334 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: BEGIN
[0m00:40:49.913942 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: BEGIN
[0m00:40:49.914486 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:49.915009 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m00:40:49.915378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:49.916132 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: BEGIN
[0m00:40:49.916709 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m00:40:49.916981 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:49.917817 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: BEGIN
[0m00:40:49.918519 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:40:49.931160 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m00:40:49.931554 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m00:40:49.931823 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m00:40:49.932076 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m00:40:49.932325 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m00:40:49.932720 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m00:40:49.933336 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m00:40:49.933724 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_yellow_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:40:49.934111 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m00:40:49.934495 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "dev"."main"."stg_yellow_trips"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m00:40:49.934954 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select dropoff_location_id as from_field
    from "dev"."main"."stg_yellow_trips"
    where dropoff_location_id is not null
),

parent as (
    select location_id as to_field
    from "dev"."main"."stg_taxi_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:40:49.935786 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select pickup_location_id as from_field
    from "dev"."main"."stg_yellow_trips"
    where pickup_location_id is not null
),

parent as (
    select location_id as to_field
    from "dev"."main"."stg_taxi_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:40:49.937261 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:40:49.945029 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: ROLLBACK
[0m00:40:49.946162 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57'
[0m00:40:49.946741 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: Close
[0m00:40:49.947930 [info ] [Thread-1 (]: 52 of 91 PASS not_null_stg_yellow_trips_vendor_id .............................. [[32mPASS[0m in 0.08s]
[0m00:40:49.951330 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m00:40:50.058434 [debug] [Thread-2 (]: SQL status: OK in 0.117 seconds
[0m00:40:50.059179 [debug] [Thread-3 (]: SQL status: OK in 0.119 seconds
[0m00:40:50.060658 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: ROLLBACK
[0m00:40:50.061974 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: ROLLBACK
[0m00:40:50.062738 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f'
[0m00:40:50.063437 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a'
[0m00:40:50.063947 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: Close
[0m00:40:50.064410 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: Close
[0m00:40:50.065221 [info ] [Thread-2 (]: 55 of 91 PASS relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_  [[32mPASS[0m in 0.18s]
[0m00:40:50.069783 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m00:40:50.069245 [info ] [Thread-3 (]: 54 of 91 PASS relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_  [[32mPASS[0m in 0.20s]
[0m00:40:50.071094 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m00:40:50.135238 [debug] [Thread-4 (]: SQL status: OK in 0.200 seconds
[0m00:40:50.136883 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: ROLLBACK
[0m00:40:50.138076 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965'
[0m00:40:50.138686 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: Close
[0m00:40:50.166453 [info ] [Thread-4 (]: 53 of 91 PASS unique_stg_yellow_trips_trip_id .................................. [[32mPASS[0m in 0.29s]
[0m00:40:50.167340 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m00:40:50.169016 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m00:40:50.169729 [info ] [Thread-1 (]: 56 of 91 START sql view model main.int_trip_metrics ............................ [RUN]
[0m00:40:50.170325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57, now model.nyc_taxi_pipeline_00.int_trip_metrics)
[0m00:40:50.170831 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m00:40:50.174228 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m00:40:50.188524 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m00:40:50.191813 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m00:40:50.205871 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m00:40:50.206419 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: BEGIN
[0m00:40:50.206898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:50.223536 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m00:40:50.224142 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m00:40:50.224831 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */

  
  create view "dev"."main"."int_trip_metrics__dbt_tmp" as (
    /*
    Intermediate model: Trip-level enrichment with calculated metrics.
    Uses adapter-dispatched macros for cross-dialect compatibility.
*/

with trips as (
    select * from "dev"."main"."stg_yellow_trips"
),

enriched as (
    select
        trip_id,
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        payment_type_id,
        pickup_datetime,
        dropoff_datetime,
        passenger_count,
        trip_distance_miles,
        store_and_fwd_flag,

        -- calculated: duration in minutes
        
    datediff('minute', pickup_datetime, dropoff_datetime)
 as trip_duration_minutes,

        -- calculated: average speed (avoid division by zero)
        case
            when 
    datediff('minute', pickup_datetime, dropoff_datetime)
 > 0
            then round(
                trip_distance_miles / (
    datediff('minute', pickup_datetime, dropoff_datetime)
 / 60.0),
                2
            )
            else null
        end as avg_speed_mph,

        -- calculated: cost per mile
        case
            when trip_distance_miles > 0
            then round(fare_amount / trip_distance_miles, 2)
            else null
        end as cost_per_mile,

        -- calculated: tip percentage
        case
            when fare_amount > 0
            then round((tip_amount / fare_amount) * 100, 2)
            else null
        end as tip_percentage,

        -- time dimensions (using adapter-dispatched macros)
        date_trunc('day', pickup_datetime)::date as pickup_date,
        extract(hour from pickup_datetime) as pickup_hour,
        
    dayname(pickup_datetime)
 as pickup_day_of_week,
        case
            when extract(dow from pickup_datetime) in (0, 6) then true
            else false
        end as is_weekend,

        -- financials passthrough
        fare_amount,
        extra_amount,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount,
        congestion_surcharge,
        airport_fee

    from trips
)

select *
from enriched
where trip_duration_minutes between 1 and 720
  and (avg_speed_mph is null or avg_speed_mph < 100)
  );

[0m00:40:50.226523 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:50.230281 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m00:40:50.230802 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
alter view "dev"."main"."int_trip_metrics__dbt_tmp" rename to "int_trip_metrics"
[0m00:40:50.232311 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:50.233592 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: COMMIT
[0m00:40:50.234168 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m00:40:50.234610 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: COMMIT
[0m00:40:50.241221 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m00:40:50.243433 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m00:40:50.243958 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
drop view if exists "dev"."main"."int_trip_metrics__dbt_backup" cascade
[0m00:40:50.244996 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:50.246334 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: Close
[0m00:40:50.278593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb237131d0>]}
[0m00:40:50.279639 [info ] [Thread-1 (]: 56 of 91 OK created sql view model main.int_trip_metrics ....................... [[32mOK[0m in 0.11s]
[0m00:40:50.280337 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m00:40:50.281446 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m00:40:50.281814 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m00:40:50.282192 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m00:40:50.282588 [info ] [Thread-3 (]: 57 of 91 START test assert_trip_duration_positive .............................. [RUN]
[0m00:40:50.283033 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m00:40:50.283393 [info ] [Thread-4 (]: 58 of 91 START test dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0  [RUN]
[0m00:40:50.283982 [info ] [Thread-2 (]: 59 of 91 START test dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1  [RUN]
[0m00:40:50.284782 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a, now test.nyc_taxi_pipeline_00.assert_trip_duration_positive)
[0m00:40:50.285307 [info ] [Thread-1 (]: 60 of 91 START test not_null_int_trip_metrics_is_weekend ....................... [RUN]
[0m00:40:50.285942 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574)
[0m00:40:50.286533 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718)
[0m00:40:50.287056 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m00:40:50.288511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_trip_metrics, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed)
[0m00:40:50.289207 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m00:40:50.289682 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m00:40:50.292829 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m00:40:50.293582 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m00:40:50.297738 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m00:40:50.301672 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m00:40:50.306538 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m00:40:50.311663 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m00:40:50.314098 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m00:40:50.319394 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m00:40:50.321986 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m00:40:50.323220 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m00:40:50.323908 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: BEGIN
[0m00:40:50.324384 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m00:40:50.324883 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:50.325366 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m00:40:50.327912 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m00:40:50.332121 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m00:40:50.337821 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m00:40:50.338491 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: BEGIN
[0m00:40:50.339103 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:40:50.339858 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m00:40:50.340597 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: BEGIN
[0m00:40:50.341108 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:50.342743 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m00:40:50.343242 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: BEGIN
[0m00:40:50.343677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:50.349919 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m00:40:50.350396 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m00:40:50.350823 [debug] [Thread-3 (]: SQL status: OK in 0.026 seconds
[0m00:40:50.351106 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m00:40:50.351407 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m00:40:50.351942 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m00:40:50.352473 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m00:40:50.353026 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m00:40:50.353439 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_trip_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not trip_duration_minutes >= 1
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not trip_duration_minutes <= 720
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:40:50.353865 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_trip_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:40:50.354598 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
    Singular test: No trip should have negative duration.
*/

select
    trip_id,
    pickup_datetime,
    dropoff_datetime,
    trip_duration_minutes
from "dev"."main"."int_trip_metrics"
where trip_duration_minutes < 0
  
  
      
    ) dbt_internal_test
[0m00:40:50.355046 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."int_trip_metrics"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m00:40:50.358298 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:40:50.358790 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:50.361229 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: ROLLBACK
[0m00:40:50.362466 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: ROLLBACK
[0m00:40:50.363146 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed'
[0m00:40:50.365251 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.assert_trip_duration_positive'
[0m00:40:50.367525 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: Close
[0m00:40:50.369750 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: Close
[0m00:40:50.372747 [info ] [Thread-1 (]: 60 of 91 PASS not_null_int_trip_metrics_is_weekend ............................. [[32mPASS[0m in 0.08s]
[0m00:40:50.373788 [info ] [Thread-3 (]: 57 of 91 PASS assert_trip_duration_positive .................................... [[32mPASS[0m in 0.09s]
[0m00:40:50.375980 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m00:40:50.378580 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m00:40:50.381588 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m00:40:50.383072 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m00:40:50.384723 [info ] [Thread-1 (]: 61 of 91 START test not_null_int_trip_metrics_pickup_date ...................... [RUN]
[0m00:40:50.386929 [info ] [Thread-3 (]: 62 of 91 START test not_null_int_trip_metrics_pickup_hour ...................... [RUN]
[0m00:40:50.389541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3)
[0m00:40:50.391893 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.assert_trip_duration_positive, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082)
[0m00:40:50.393907 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m00:40:50.396052 [debug] [Thread-4 (]: SQL status: OK in 0.040 seconds
[0m00:40:50.396808 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m00:40:50.401665 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m00:40:50.404476 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: ROLLBACK
[0m00:40:50.408646 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m00:40:50.412041 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574'
[0m00:40:50.412700 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: Close
[0m00:40:50.413816 [info ] [Thread-4 (]: 58 of 91 PASS dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0 ..... [[32mPASS[0m in 0.13s]
[0m00:40:50.415227 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m00:40:50.416661 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m00:40:50.417109 [info ] [Thread-4 (]: 63 of 91 START test not_null_int_trip_metrics_trip_duration_minutes ............ [RUN]
[0m00:40:50.417655 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c)
[0m00:40:50.417931 [debug] [Thread-2 (]: SQL status: OK in 0.062 seconds
[0m00:40:50.418223 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m00:40:50.419811 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: ROLLBACK
[0m00:40:50.423253 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m00:40:50.424364 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718'
[0m00:40:50.425278 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m00:40:50.425585 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: Close
[0m00:40:50.425915 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m00:40:50.427749 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m00:40:50.430284 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m00:40:50.432640 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m00:40:50.435057 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m00:40:50.435712 [info ] [Thread-2 (]: 59 of 91 PASS dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1  [[32mPASS[0m in 0.15s]
[0m00:40:50.436429 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m00:40:50.436835 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m00:40:50.437273 [info ] [Thread-2 (]: 64 of 91 START test not_null_int_trip_metrics_trip_id .......................... [RUN]
[0m00:40:50.437721 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f)
[0m00:40:50.438247 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m00:40:50.442185 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m00:40:50.443875 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m00:40:50.444394 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m00:40:50.444707 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: BEGIN
[0m00:40:50.445025 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m00:40:50.445482 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: BEGIN
[0m00:40:50.445978 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:50.446399 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: BEGIN
[0m00:40:50.446834 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:50.447666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:50.451508 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m00:40:50.453763 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m00:40:50.462365 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m00:40:50.462859 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: BEGIN
[0m00:40:50.463266 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:40:50.465015 [debug] [Thread-3 (]: SQL status: OK in 0.019 seconds
[0m00:40:50.465347 [debug] [Thread-4 (]: SQL status: OK in 0.018 seconds
[0m00:40:50.465679 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m00:40:50.466030 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m00:40:50.466336 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m00:40:50.466571 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m00:40:50.467107 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m00:40:50.467731 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."int_trip_metrics"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m00:40:50.468347 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m00:40:50.468937 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_duration_minutes
from "dev"."main"."int_trip_metrics"
where trip_duration_minutes is null



  
  
      
    ) dbt_internal_test
[0m00:40:50.469494 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_trip_metrics"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m00:40:50.470520 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."int_trip_metrics"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m00:40:50.472144 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:50.472907 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:50.473290 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m00:40:50.475394 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: ROLLBACK
[0m00:40:50.477470 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: ROLLBACK
[0m00:40:50.479391 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: ROLLBACK
[0m00:40:50.480969 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082'
[0m00:40:50.482346 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3'
[0m00:40:50.485486 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f'
[0m00:40:50.487877 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: Close
[0m00:40:50.490171 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: Close
[0m00:40:50.492333 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: Close
[0m00:40:50.496525 [info ] [Thread-3 (]: 62 of 91 PASS not_null_int_trip_metrics_pickup_hour ............................ [[32mPASS[0m in 0.10s]
[0m00:40:50.498027 [info ] [Thread-1 (]: 61 of 91 PASS not_null_int_trip_metrics_pickup_date ............................ [[32mPASS[0m in 0.11s]
[0m00:40:50.501129 [info ] [Thread-2 (]: 64 of 91 PASS not_null_int_trip_metrics_trip_id ................................ [[32mPASS[0m in 0.06s]
[0m00:40:50.502480 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m00:40:50.505866 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m00:40:50.507784 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m00:40:50.534638 [debug] [Thread-4 (]: SQL status: OK in 0.063 seconds
[0m00:40:50.536465 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: ROLLBACK
[0m00:40:50.537249 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c'
[0m00:40:50.537843 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: Close
[0m00:40:50.544314 [info ] [Thread-4 (]: 63 of 91 PASS not_null_int_trip_metrics_trip_duration_minutes .................. [[32mPASS[0m in 0.13s]
[0m00:40:50.545752 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m00:40:50.546861 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.int_daily_summary
[0m00:40:50.547157 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m00:40:50.547448 [debug] [Thread-2 (]: Began running node model.nyc_taxi_pipeline_00.fct_trips
[0m00:40:50.547862 [info ] [Thread-3 (]: 65 of 91 START sql view model main.int_daily_summary ........................... [RUN]
[0m00:40:50.548448 [info ] [Thread-1 (]: 66 of 91 START sql view model main.int_hourly_patterns ......................... [RUN]
[0m00:40:50.549114 [info ] [Thread-2 (]: 67 of 91 START sql incremental model main.fct_trips ............................ [RUN]
[0m00:40:50.549731 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082, now model.nyc_taxi_pipeline_00.int_daily_summary)
[0m00:40:50.550219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3, now model.nyc_taxi_pipeline_00.int_hourly_patterns)
[0m00:40:50.550679 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f, now model.nyc_taxi_pipeline_00.fct_trips)
[0m00:40:50.551171 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.int_daily_summary
[0m00:40:50.551583 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m00:40:50.551949 [debug] [Thread-2 (]: Began compiling node model.nyc_taxi_pipeline_00.fct_trips
[0m00:40:50.556176 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m00:40:50.558813 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m00:40:50.562572 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.fct_trips"
[0m00:40:50.567765 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.int_daily_summary
[0m00:40:50.570980 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m00:40:50.572629 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m00:40:50.575895 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m00:40:50.576379 [debug] [Thread-2 (]: Began executing node model.nyc_taxi_pipeline_00.fct_trips
[0m00:40:50.600277 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m00:40:50.600794 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m00:40:50.601217 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
DESCRIBE (select * from (
        /*
    Fact table: Fully enriched trip records with location names.
    Incremental with delete+insert strategy.
*/



with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

pickup_locations as (
    select * from "dev"."main"."dim_locations"
),

dropoff_locations as (
    select * from "dev"."main"."dim_locations"
),

final as (
    select
        t.trip_id,
        t.vendor_id,
        t.rate_code_id,
        t.payment_type_id,
        t.pickup_location_id,
        t.dropoff_location_id,
        t.pickup_datetime,
        t.dropoff_datetime,
        t.pickup_date,
        t.pickup_hour,
        t.pickup_day_of_week,
        t.is_weekend,
        t.passenger_count,
        t.trip_distance_miles,
        t.trip_duration_minutes,
        t.avg_speed_mph,
        t.cost_per_mile,
        t.fare_amount,
        t.extra_amount,
        t.mta_tax,
        t.tip_amount,
        t.tip_percentage,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.congestion_surcharge,
        t.airport_fee,

        -- enriched from dimensions
        pu.borough as pickup_borough,
        pu.zone_name as pickup_zone,
        do_loc.borough as dropoff_borough,
        do_loc.zone_name as dropoff_zone

    from trip_metrics t
    left join pickup_locations pu
        on t.pickup_location_id = pu.location_id
    left join dropoff_locations do_loc
        on t.dropoff_location_id = do_loc.location_id

    
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:40:50.601737 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m00:40:50.602110 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: BEGIN
[0m00:40:50.602779 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:40:50.603237 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: BEGIN
[0m00:40:50.603657 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:50.604452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:50.623091 [debug] [Thread-3 (]: SQL status: OK in 0.019 seconds
[0m00:40:50.623502 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m00:40:50.623850 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m00:40:50.624231 [debug] [Thread-2 (]: SQL status: OK in 0.021 seconds
[0m00:40:50.624891 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m00:40:50.625675 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */

  
  create view "dev"."main"."int_daily_summary__dbt_tmp" as (
    /*
    Intermediate model: Daily aggregated trip and revenue metrics.
    One row per day with counts, averages, and revenue totals.
*/

with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

daily_agg as (
    select
        pickup_date,
        pickup_day_of_week,
        is_weekend,

        count(*) as total_trips,
        sum(passenger_count) as total_passengers,

        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(avg(avg_speed_mph), 2) as avg_speed_mph,

        round(sum(fare_amount), 2) as total_fare_revenue,
        round(sum(tip_amount), 2) as total_tip_revenue,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_trip_revenue,
        round(avg(tip_percentage), 2) as avg_tip_percentage,

        count(case when payment_type_id = 1 then 1 end) as credit_card_trips,
        count(case when payment_type_id = 2 then 1 end) as cash_trips

    from trip_metrics
    group by pickup_date, pickup_day_of_week, is_weekend
)

select * from daily_agg
  );

[0m00:40:50.628545 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m00:40:50.628895 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */

  
  create view "dev"."main"."int_hourly_patterns__dbt_tmp" as (
    /*
    Intermediate model: Hourly trip patterns by date.
    One row per date + hour combination.
*/

with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

hourly_agg as (
    select
        pickup_date,
        pickup_hour,
        pickup_day_of_week,
        is_weekend,

        count(*) as total_trips,
        round(avg(trip_distance_miles), 2) as avg_distance,
        round(avg(trip_duration_minutes), 2) as avg_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue

    from trip_metrics
    group by pickup_date, pickup_hour, pickup_day_of_week, is_weekend
)

select * from hourly_agg
  );

[0m00:40:50.630317 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as varchar)
 as trip_id, 
      
    cast(null as integer)
 as vendor_id, 
      
    cast(null as integer)
 as rate_code_id, 
      
    cast(null as integer)
 as payment_type_id, 
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as integer)
 as dropoff_location_id, 
      
    cast(null as timestamp)
 as pickup_datetime, 
      
    cast(null as timestamp)
 as dropoff_datetime, 
      
    cast(null as date)
 as pickup_date, 
      
    cast(null as bigint)
 as pickup_hour, 
      
    cast(null as varchar)
 as pickup_day_of_week, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as integer)
 as passenger_count, 
      
    cast(null as double)
 as trip_distance_miles, 
      
    cast(null as bigint)
 as trip_duration_minutes, 
      
    cast(null as double)
 as avg_speed_mph, 
      
    cast(null as double)
 as cost_per_mile, 
      
    cast(null as decimal(10,2))
 as fare_amount, 
      
    cast(null as decimal(10,2))
 as extra_amount, 
      
    cast(null as decimal(10,2))
 as mta_tax, 
      
    cast(null as decimal(10,2))
 as tip_amount, 
      
    cast(null as double)
 as tip_percentage, 
      
    cast(null as decimal(10,2))
 as tolls_amount, 
      
    cast(null as decimal(10,2))
 as improvement_surcharge, 
      
    cast(null as decimal(10,2))
 as total_amount, 
      
    cast(null as decimal(10,2))
 as congestion_surcharge, 
      
    cast(null as decimal(10,2))
 as airport_fee, 
      
    cast(null as varchar)
 as pickup_borough, 
      
    cast(null as varchar)
 as pickup_zone, 
      
    cast(null as varchar)
 as dropoff_borough, 
      
    cast(null as varchar)
 as dropoff_zone
    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:40:50.631940 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:50.632356 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:50.632601 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m00:40:50.635787 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m00:40:50.638134 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m00:40:50.641790 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.fct_trips"
[0m00:40:50.642201 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
alter view "dev"."main"."int_daily_summary__dbt_tmp" rename to "int_daily_summary"
[0m00:40:50.642777 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
alter view "dev"."main"."int_hourly_patterns__dbt_tmp" rename to "int_hourly_patterns"
[0m00:40:50.644562 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:50.644930 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:50.646346 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: COMMIT
[0m00:40:50.647489 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: COMMIT
[0m00:40:50.648045 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m00:40:50.648457 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m00:40:50.648998 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: COMMIT
[0m00:40:50.649549 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: COMMIT
[0m00:40:50.652008 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m00:40:50.652488 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: BEGIN
[0m00:40:50.653295 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m00:40:50.653675 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m00:40:50.654137 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */

  
    
    
      
    

    create  table
      "dev"."main"."fct_trips"
  
  (
    trip_id varchar,
    vendor_id integer,
    rate_code_id integer,
    payment_type_id integer,
    pickup_location_id integer,
    dropoff_location_id integer,
    pickup_datetime timestamp,
    dropoff_datetime timestamp,
    pickup_date date,
    pickup_hour bigint,
    pickup_day_of_week varchar,
    is_weekend boolean,
    passenger_count integer,
    trip_distance_miles double,
    trip_duration_minutes bigint,
    avg_speed_mph double,
    cost_per_mile double,
    fare_amount decimal(10,2),
    extra_amount decimal(10,2),
    mta_tax decimal(10,2),
    tip_amount decimal(10,2),
    tip_percentage double,
    tolls_amount decimal(10,2),
    improvement_surcharge decimal(10,2),
    total_amount decimal(10,2),
    congestion_surcharge decimal(10,2),
    airport_fee decimal(10,2),
    pickup_borough varchar,
    pickup_zone varchar,
    dropoff_borough varchar,
    dropoff_zone varchar
    
    )
 ;
    insert into "dev"."main"."fct_trips" 
  (
    
      
      trip_id ,
    
      
      vendor_id ,
    
      
      rate_code_id ,
    
      
      payment_type_id ,
    
      
      pickup_location_id ,
    
      
      dropoff_location_id ,
    
      
      pickup_datetime ,
    
      
      dropoff_datetime ,
    
      
      pickup_date ,
    
      
      pickup_hour ,
    
      
      pickup_day_of_week ,
    
      
      is_weekend ,
    
      
      passenger_count ,
    
      
      trip_distance_miles ,
    
      
      trip_duration_minutes ,
    
      
      avg_speed_mph ,
    
      
      cost_per_mile ,
    
      
      fare_amount ,
    
      
      extra_amount ,
    
      
      mta_tax ,
    
      
      tip_amount ,
    
      
      tip_percentage ,
    
      
      tolls_amount ,
    
      
      improvement_surcharge ,
    
      
      total_amount ,
    
      
      congestion_surcharge ,
    
      
      airport_fee ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      dropoff_borough ,
    
      
      dropoff_zone 
    
  )
 (
      
    select trip_id, vendor_id, rate_code_id, payment_type_id, pickup_location_id, dropoff_location_id, pickup_datetime, dropoff_datetime, pickup_date, pickup_hour, pickup_day_of_week, is_weekend, passenger_count, trip_distance_miles, trip_duration_minutes, avg_speed_mph, cost_per_mile, fare_amount, extra_amount, mta_tax, tip_amount, tip_percentage, tolls_amount, improvement_surcharge, total_amount, congestion_surcharge, airport_fee, pickup_borough, pickup_zone, dropoff_borough, dropoff_zone
    from (
        /*
    Fact table: Fully enriched trip records with location names.
    Incremental with delete+insert strategy.
*/



with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

pickup_locations as (
    select * from "dev"."main"."dim_locations"
),

dropoff_locations as (
    select * from "dev"."main"."dim_locations"
),

final as (
    select
        t.trip_id,
        t.vendor_id,
        t.rate_code_id,
        t.payment_type_id,
        t.pickup_location_id,
        t.dropoff_location_id,
        t.pickup_datetime,
        t.dropoff_datetime,
        t.pickup_date,
        t.pickup_hour,
        t.pickup_day_of_week,
        t.is_weekend,
        t.passenger_count,
        t.trip_distance_miles,
        t.trip_duration_minutes,
        t.avg_speed_mph,
        t.cost_per_mile,
        t.fare_amount,
        t.extra_amount,
        t.mta_tax,
        t.tip_amount,
        t.tip_percentage,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.congestion_surcharge,
        t.airport_fee,

        -- enriched from dimensions
        pu.borough as pickup_borough,
        pu.zone_name as pickup_zone,
        do_loc.borough as dropoff_borough,
        do_loc.zone_name as dropoff_zone

    from trip_metrics t
    left join pickup_locations pu
        on t.pickup_location_id = pu.location_id
    left join dropoff_locations do_loc
        on t.dropoff_location_id = do_loc.location_id

    
)

select * from final
    ) as model_subq
    );
  
  
  
[0m00:40:50.656669 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m00:40:50.658977 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m00:40:50.659341 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m00:40:50.659749 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
drop view if exists "dev"."main"."int_daily_summary__dbt_backup" cascade
[0m00:40:50.662103 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m00:40:50.664153 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:50.666246 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
drop view if exists "dev"."main"."int_hourly_patterns__dbt_backup" cascade
[0m00:40:50.670047 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: Close
[0m00:40:50.673200 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:50.674120 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb23712f60>]}
[0m00:40:50.677796 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: Close
[0m00:40:50.680559 [info ] [Thread-3 (]: 65 of 91 OK created sql view model main.int_daily_summary ...................... [[32mOK[0m in 0.12s]
[0m00:40:50.683288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb237c7f20>]}
[0m00:40:50.684973 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.int_daily_summary
[0m00:40:50.688108 [info ] [Thread-1 (]: 66 of 91 OK created sql view model main.int_hourly_patterns .................... [[32mOK[0m in 0.13s]
[0m00:40:50.691883 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m00:40:50.692338 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m00:40:50.693796 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m00:40:50.695924 [info ] [Thread-4 (]: 68 of 91 START test dbt_utils_accepted_range_int_daily_summary_total_trips__0 .. [RUN]
[0m00:40:50.699176 [info ] [Thread-3 (]: 69 of 91 START test not_null_int_daily_summary_pickup_date ..................... [RUN]
[0m00:40:50.702683 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m00:40:50.705745 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863)
[0m00:40:50.709642 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_daily_summary, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686)
[0m00:40:50.712609 [info ] [Thread-1 (]: 70 of 91 START test not_null_int_daily_summary_total_revenue ................... [RUN]
[0m00:40:50.716713 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m00:40:50.718839 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m00:40:50.721825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_hourly_patterns, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50)
[0m00:40:50.728607 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m00:40:50.734940 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m00:40:50.737965 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m00:40:50.749061 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m00:40:50.786570 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m00:40:50.790392 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m00:40:50.792575 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m00:40:50.801006 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m00:40:50.801529 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m00:40:50.809748 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m00:40:50.821063 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m00:40:50.821810 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: BEGIN
[0m00:40:50.823563 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:50.825735 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:50.826495 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m00:40:50.826950 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m00:40:50.828459 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: BEGIN
[0m00:40:50.829378 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_daily_summary"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m00:40:50.830325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:50.837068 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m00:40:50.837659 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m00:40:50.837988 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: BEGIN
[0m00:40:50.838634 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m00:40:50.839037 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m00:40:50.847786 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:50.849959 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "dev"."main"."int_daily_summary"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m00:40:50.858779 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m00:40:50.857605 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: ROLLBACK
[0m00:40:50.860153 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m00:40:50.863049 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_daily_summary"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_trips >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:40:50.862241 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686'
[0m00:40:50.868128 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: Close
[0m00:40:50.873204 [info ] [Thread-3 (]: 69 of 91 PASS not_null_int_daily_summary_pickup_date ........................... [[32mPASS[0m in 0.16s]
[0m00:40:50.883004 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m00:40:50.885406 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m00:40:50.888953 [info ] [Thread-3 (]: 71 of 91 START test not_null_int_daily_summary_total_trips ..................... [RUN]
[0m00:40:50.894101 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10)
[0m00:40:50.896156 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m00:40:50.903085 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m00:40:50.932186 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m00:40:50.936249 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m00:40:50.980304 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m00:40:50.983872 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: BEGIN
[0m00:40:50.986349 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:50.989180 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m00:40:50.991332 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m00:40:50.993431 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_trips
from "dev"."main"."int_daily_summary"
where total_trips is null



  
  
      
    ) dbt_internal_test
[0m00:40:51.315338 [debug] [Thread-3 (]: SQL status: OK in 0.314 seconds
[0m00:40:51.317902 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: ROLLBACK
[0m00:40:51.318954 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10'
[0m00:40:51.319460 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: Close
[0m00:40:51.320371 [info ] [Thread-3 (]: 71 of 91 PASS not_null_int_daily_summary_total_trips ........................... [[32mPASS[0m in 0.43s]
[0m00:40:51.321004 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m00:40:51.321700 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m00:40:51.322327 [info ] [Thread-3 (]: 72 of 91 START test unique_int_daily_summary_pickup_date ....................... [RUN]
[0m00:40:51.323010 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10, now test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e)
[0m00:40:51.323429 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m00:40:51.327347 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m00:40:51.340884 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m00:40:51.343440 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m00:40:51.357030 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m00:40:51.357798 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: BEGIN
[0m00:40:51.358481 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:51.359719 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:51.360425 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m00:40:51.360908 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pickup_date as unique_field,
    count(*) as n_records

from "dev"."main"."int_daily_summary"
where pickup_date is not null
group by pickup_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:40:51.412721 [debug] [Thread-1 (]: SQL status: OK in 0.553 seconds
[0m00:40:51.415379 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: ROLLBACK
[0m00:40:51.416567 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50'
[0m00:40:51.417192 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: Close
[0m00:40:51.418077 [info ] [Thread-1 (]: 70 of 91 PASS not_null_int_daily_summary_total_revenue ......................... [[32mPASS[0m in 0.70s]
[0m00:40:51.418919 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m00:40:51.419838 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m00:40:51.420351 [info ] [Thread-1 (]: 73 of 91 START test dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0  [RUN]
[0m00:40:51.420966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe)
[0m00:40:51.421415 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m00:40:51.425285 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m00:40:51.436425 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m00:40:51.439187 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m00:40:51.450098 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m00:40:51.450739 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: BEGIN
[0m00:40:51.451345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:51.452409 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:51.452954 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m00:40:51.453361 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_hourly_patterns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:40:51.467651 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m00:40:51.469297 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: ROLLBACK
[0m00:40:51.470312 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe'
[0m00:40:51.470988 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: Close
[0m00:40:51.471977 [info ] [Thread-1 (]: 73 of 91 PASS dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0 .. [[32mPASS[0m in 0.05s]
[0m00:40:51.472717 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m00:40:51.473284 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m00:40:51.473803 [info ] [Thread-1 (]: 74 of 91 START test not_null_int_hourly_patterns_pickup_date ................... [RUN]
[0m00:40:51.474466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2)
[0m00:40:51.474923 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m00:40:51.479538 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m00:40:51.482629 [debug] [Thread-4 (]: SQL status: OK in 0.618 seconds
[0m00:40:51.485415 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: ROLLBACK
[0m00:40:51.487762 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863'
[0m00:40:51.488642 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: Close
[0m00:40:51.489956 [info ] [Thread-4 (]: 68 of 91 PASS dbt_utils_accepted_range_int_daily_summary_total_trips__0 ........ [[32mPASS[0m in 0.78s]
[0m00:40:51.491206 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m00:40:51.491813 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m00:40:51.492407 [info ] [Thread-4 (]: 75 of 91 START test not_null_int_hourly_patterns_pickup_hour ................... [RUN]
[0m00:40:51.493205 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d)
[0m00:40:51.493746 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m00:40:51.494160 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m00:40:51.497601 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m00:40:51.502684 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m00:40:51.513601 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m00:40:51.514251 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m00:40:51.517240 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m00:40:51.517870 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: BEGIN
[0m00:40:51.518813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:51.519729 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:51.520219 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m00:40:51.520684 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_hourly_patterns"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m00:40:51.523300 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:40:51.525163 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: ROLLBACK
[0m00:40:51.526134 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2'
[0m00:40:51.526670 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: Close
[0m00:40:51.527858 [info ] [Thread-1 (]: 74 of 91 PASS not_null_int_hourly_patterns_pickup_date ......................... [[32mPASS[0m in 0.05s]
[0m00:40:51.528721 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m00:40:51.529379 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m00:40:51.529925 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: BEGIN
[0m00:40:51.530538 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m00:40:51.531098 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:51.531689 [info ] [Thread-1 (]: 76 of 91 START test not_null_int_hourly_patterns_total_trips ................... [RUN]
[0m00:40:51.532849 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m00:40:51.533338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf)
[0m00:40:51.533966 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m00:40:51.534582 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m00:40:51.535086 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."int_hourly_patterns"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m00:40:51.538665 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m00:40:51.542345 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m00:40:51.544269 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: ROLLBACK
[0m00:40:51.545199 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d'
[0m00:40:51.545783 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: Close
[0m00:40:51.546592 [info ] [Thread-4 (]: 75 of 91 PASS not_null_int_hourly_patterns_pickup_hour ......................... [[32mPASS[0m in 0.05s]
[0m00:40:51.547184 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m00:40:51.550814 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m00:40:51.553112 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m00:40:51.563099 [debug] [Thread-3 (]: SQL status: OK in 0.201 seconds
[0m00:40:51.564732 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: ROLLBACK
[0m00:40:51.565095 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m00:40:51.565992 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e'
[0m00:40:51.566692 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: BEGIN
[0m00:40:51.567162 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: Close
[0m00:40:51.567727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:51.568560 [info ] [Thread-3 (]: 72 of 91 PASS unique_int_daily_summary_pickup_date ............................. [[32mPASS[0m in 0.25s]
[0m00:40:51.569387 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:40:51.569810 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m00:40:51.570299 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m00:40:51.571134 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_trips
from "dev"."main"."int_hourly_patterns"
where total_trips is null



  
  
      
    ) dbt_internal_test
[0m00:40:51.571531 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m00:40:51.572520 [info ] [Thread-4 (]: 77 of 91 START sql table model main.mart_daily_revenue ......................... [RUN]
[0m00:40:51.573114 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d, now model.nyc_taxi_pipeline_00.mart_daily_revenue)
[0m00:40:51.573570 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m00:40:51.577274 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m00:40:51.595779 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m00:40:51.598955 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m00:40:51.599753 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Daily revenue metrics with running totals.
*/

with daily as (
    select * from "dev"."main"."int_daily_summary"
),

dates as (
    select * from "dev"."main"."dim_dates"
),

final as (
    select
        d.date_key,
        d.day_of_week_name,
        d.is_weekend,
        d.is_holiday,
        d.week_of_year,

        daily.total_trips,
        daily.total_passengers,
        daily.total_fare_revenue,
        daily.total_tip_revenue,
        daily.total_revenue,
        daily.avg_trip_revenue,
        daily.avg_tip_percentage,
        daily.credit_card_trips,
        daily.cash_trips,
        daily.avg_trip_distance,
        daily.avg_trip_duration_min,

        -- running total
        sum(daily.total_revenue) over (order by d.date_key) as cumulative_revenue,

        -- day-over-day change
        daily.total_revenue - lag(daily.total_revenue) over (order by d.date_key) as revenue_change_vs_prior_day

    from daily
    inner join dates d
        on daily.pickup_date = d.date_key
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:40:51.600471 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:51.603505 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m00:40:51.607698 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m00:40:51.608577 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as date_key, 
      
    cast(null as varchar)
 as day_of_week_name, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as boolean)
 as is_holiday, 
      
    cast(null as bigint)
 as week_of_year, 
      
    cast(null as bigint)
 as total_trips, 
      
    cast(null as hugeint)
 as total_passengers, 
      
    cast(null as decimal(38,2))
 as total_fare_revenue, 
      
    cast(null as decimal(38,2))
 as total_tip_revenue, 
      
    cast(null as decimal(38,2))
 as total_revenue, 
      
    cast(null as double)
 as avg_trip_revenue, 
      
    cast(null as double)
 as avg_tip_percentage, 
      
    cast(null as bigint)
 as credit_card_trips, 
      
    cast(null as bigint)
 as cash_trips, 
      
    cast(null as double)
 as avg_trip_distance, 
      
    cast(null as double)
 as avg_trip_duration_min, 
      
    cast(null as decimal(38,2))
 as cumulative_revenue, 
      
    cast(null as decimal(38,2))
 as revenue_change_vs_prior_day
    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:40:51.610221 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:51.613088 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m00:40:51.631488 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m00:40:51.632145 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: BEGIN
[0m00:40:51.633118 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m00:40:51.633691 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m00:40:51.634426 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_daily_revenue__dbt_tmp"
  
  (
    date_key date,
    day_of_week_name varchar,
    is_weekend boolean,
    is_holiday boolean,
    week_of_year bigint,
    total_trips bigint,
    total_passengers hugeint,
    total_fare_revenue decimal(38,2),
    total_tip_revenue decimal(38,2),
    total_revenue decimal(38,2),
    avg_trip_revenue double,
    avg_tip_percentage double,
    credit_card_trips bigint,
    cash_trips bigint,
    avg_trip_distance double,
    avg_trip_duration_min double,
    cumulative_revenue decimal(38,2),
    revenue_change_vs_prior_day decimal(38,2)
    
    )
 ;
    insert into "dev"."main"."mart_daily_revenue__dbt_tmp" 
  (
    
      
      date_key ,
    
      
      day_of_week_name ,
    
      
      is_weekend ,
    
      
      is_holiday ,
    
      
      week_of_year ,
    
      
      total_trips ,
    
      
      total_passengers ,
    
      
      total_fare_revenue ,
    
      
      total_tip_revenue ,
    
      
      total_revenue ,
    
      
      avg_trip_revenue ,
    
      
      avg_tip_percentage ,
    
      
      credit_card_trips ,
    
      
      cash_trips ,
    
      
      avg_trip_distance ,
    
      
      avg_trip_duration_min ,
    
      
      cumulative_revenue ,
    
      
      revenue_change_vs_prior_day 
    
  )
 (
      
    select date_key, day_of_week_name, is_weekend, is_holiday, week_of_year, total_trips, total_passengers, total_fare_revenue, total_tip_revenue, total_revenue, avg_trip_revenue, avg_tip_percentage, credit_card_trips, cash_trips, avg_trip_distance, avg_trip_duration_min, cumulative_revenue, revenue_change_vs_prior_day
    from (
        /*
    Analytics mart: Daily revenue metrics with running totals.
*/

with daily as (
    select * from "dev"."main"."int_daily_summary"
),

dates as (
    select * from "dev"."main"."dim_dates"
),

final as (
    select
        d.date_key,
        d.day_of_week_name,
        d.is_weekend,
        d.is_holiday,
        d.week_of_year,

        daily.total_trips,
        daily.total_passengers,
        daily.total_fare_revenue,
        daily.total_tip_revenue,
        daily.total_revenue,
        daily.avg_trip_revenue,
        daily.avg_tip_percentage,
        daily.credit_card_trips,
        daily.cash_trips,
        daily.avg_trip_distance,
        daily.avg_trip_duration_min,

        -- running total
        sum(daily.total_revenue) over (order by d.date_key) as cumulative_revenue,

        -- day-over-day change
        daily.total_revenue - lag(daily.total_revenue) over (order by d.date_key) as revenue_change_vs_prior_day

    from daily
    inner join dates d
        on daily.pickup_date = d.date_key
)

select * from final
    ) as model_subq
    );
  
  
[0m00:40:51.716046 [debug] [Thread-1 (]: SQL status: OK in 0.144 seconds
[0m00:40:51.718190 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: ROLLBACK
[0m00:40:51.719303 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf'
[0m00:40:51.719895 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: Close
[0m00:40:51.721621 [info ] [Thread-1 (]: 76 of 91 PASS not_null_int_hourly_patterns_total_trips ......................... [[32mPASS[0m in 0.19s]
[0m00:40:51.722480 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m00:40:51.723449 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m00:40:51.724146 [info ] [Thread-3 (]: 78 of 91 START sql table model main.mart_hourly_demand ......................... [RUN]
[0m00:40:51.724789 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e, now model.nyc_taxi_pipeline_00.mart_hourly_demand)
[0m00:40:51.725232 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m00:40:51.727851 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m00:40:51.738834 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m00:40:51.742717 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m00:40:51.743509 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Hourly demand patterns.
*/

with hourly as (
    select * from "dev"."main"."int_hourly_patterns"
),

final as (
    select
        pickup_hour,
        is_weekend,

        count(*) as days_observed,
        round(avg(total_trips), 0) as avg_trips_per_period,
        round(avg(avg_distance), 2) as avg_distance,
        round(avg(avg_duration_min), 2) as avg_duration_min,
        round(avg(total_revenue), 2) as avg_revenue_per_period,
        sum(total_trips) as total_trips_all_days

    from hourly
    group by pickup_hour, is_weekend
)

select * from final
order by is_weekend, pickup_hour
    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:40:51.744547 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:51.747364 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m00:40:51.750491 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m00:40:51.751150 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as bigint)
 as pickup_hour, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as bigint)
 as days_observed, 
      
    cast(null as double)
 as avg_trips_per_period, 
      
    cast(null as double)
 as avg_distance, 
      
    cast(null as double)
 as avg_duration_min, 
      
    cast(null as double)
 as avg_revenue_per_period, 
      
    cast(null as hugeint)
 as total_trips_all_days
    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:40:51.752276 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:51.754217 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m00:40:51.764294 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m00:40:51.765169 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: BEGIN
[0m00:40:51.766090 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m00:40:51.766631 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m00:40:51.767112 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_hourly_demand__dbt_tmp"
  
  (
    pickup_hour bigint,
    is_weekend boolean,
    days_observed bigint,
    avg_trips_per_period double,
    avg_distance double,
    avg_duration_min double,
    avg_revenue_per_period double,
    total_trips_all_days hugeint
    
    )
 ;
    insert into "dev"."main"."mart_hourly_demand__dbt_tmp" 
  (
    
      
      pickup_hour ,
    
      
      is_weekend ,
    
      
      days_observed ,
    
      
      avg_trips_per_period ,
    
      
      avg_distance ,
    
      
      avg_duration_min ,
    
      
      avg_revenue_per_period ,
    
      
      total_trips_all_days 
    
  )
 (
      
    select pickup_hour, is_weekend, days_observed, avg_trips_per_period, avg_distance, avg_duration_min, avg_revenue_per_period, total_trips_all_days
    from (
        /*
    Analytics mart: Hourly demand patterns.
*/

with hourly as (
    select * from "dev"."main"."int_hourly_patterns"
),

final as (
    select
        pickup_hour,
        is_weekend,

        count(*) as days_observed,
        round(avg(total_trips), 0) as avg_trips_per_period,
        round(avg(avg_distance), 2) as avg_distance,
        round(avg(avg_duration_min), 2) as avg_duration_min,
        round(avg(total_revenue), 2) as avg_revenue_per_period,
        sum(total_trips) as total_trips_all_days

    from hourly
    group by pickup_hour, is_weekend
)

select * from final
order by is_weekend, pickup_hour
    ) as model_subq
    );
  
  
[0m00:40:51.853529 [debug] [Thread-4 (]: SQL status: OK in 0.218 seconds
[0m00:40:51.856272 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m00:40:51.856802 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
alter table "dev"."main"."mart_daily_revenue__dbt_tmp" rename to "mart_daily_revenue"
[0m00:40:51.857682 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m00:40:51.858904 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: COMMIT
[0m00:40:51.859372 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m00:40:51.860058 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: COMMIT
[0m00:40:51.867475 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m00:40:51.870341 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m00:40:51.870927 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
drop table if exists "dev"."main"."mart_daily_revenue__dbt_backup" cascade
[0m00:40:51.871764 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m00:40:51.873351 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: Close
[0m00:40:51.874242 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba00d3650>]}
[0m00:40:51.874887 [info ] [Thread-4 (]: 77 of 91 OK created sql table model main.mart_daily_revenue .................... [[32mOK[0m in 0.30s]
[0m00:40:51.875497 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m00:40:51.876373 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m00:40:51.876752 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m00:40:51.877080 [info ] [Thread-1 (]: 79 of 91 START test not_null_mart_daily_revenue_date_key ....................... [RUN]
[0m00:40:51.877587 [info ] [Thread-4 (]: 80 of 91 START test not_null_mart_daily_revenue_total_revenue .................. [RUN]
[0m00:40:51.878420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf, now test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a)
[0m00:40:51.878952 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.mart_daily_revenue, now test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9)
[0m00:40:51.879622 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m00:40:51.880241 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m00:40:51.883996 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m00:40:51.887777 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m00:40:51.898356 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m00:40:51.900869 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m00:40:51.902811 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m00:40:51.905128 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m00:40:51.913496 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m00:40:51.914136 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: BEGIN
[0m00:40:51.914735 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:51.915622 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:51.916094 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m00:40:51.916455 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m00:40:51.916762 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "dev"."main"."mart_daily_revenue"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m00:40:51.917285 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: BEGIN
[0m00:40:51.918173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:51.918660 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:51.919590 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:51.921025 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: ROLLBACK
[0m00:40:51.921321 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m00:40:51.922394 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9'
[0m00:40:51.922717 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "dev"."main"."mart_daily_revenue"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m00:40:51.923231 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: Close
[0m00:40:51.924805 [info ] [Thread-4 (]: 80 of 91 PASS not_null_mart_daily_revenue_total_revenue ........................ [[32mPASS[0m in 0.05s]
[0m00:40:51.925411 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:51.925914 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m00:40:51.927554 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: ROLLBACK
[0m00:40:51.927992 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m00:40:51.928919 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a'
[0m00:40:51.929274 [info ] [Thread-4 (]: 81 of 91 START test unique_mart_daily_revenue_date_key ......................... [RUN]
[0m00:40:51.929816 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: Close
[0m00:40:51.930384 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9, now test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7)
[0m00:40:51.931279 [info ] [Thread-1 (]: 79 of 91 PASS not_null_mart_daily_revenue_date_key ............................. [[32mPASS[0m in 0.05s]
[0m00:40:51.931978 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m00:40:51.932659 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m00:40:51.936727 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m00:40:51.944915 [debug] [Thread-3 (]: SQL status: OK in 0.177 seconds
[0m00:40:51.947414 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m00:40:51.947893 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
alter table "dev"."main"."mart_hourly_demand__dbt_tmp" rename to "mart_hourly_demand"
[0m00:40:51.948832 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:51.949915 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: COMMIT
[0m00:40:51.950322 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m00:40:51.950656 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m00:40:51.953628 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m00:40:51.954184 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: COMMIT
[0m00:40:51.958664 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m00:40:51.960936 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m00:40:51.961413 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
drop table if exists "dev"."main"."mart_hourly_demand__dbt_backup" cascade
[0m00:40:51.962333 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:51.963482 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: Close
[0m00:40:51.964155 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb20881b80>]}
[0m00:40:51.964747 [info ] [Thread-3 (]: 78 of 91 OK created sql table model main.mart_hourly_demand .................... [[32mOK[0m in 0.24s]
[0m00:40:51.965072 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m00:40:51.965417 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m00:40:51.965886 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: BEGIN
[0m00:40:51.966785 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:51.967142 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m00:40:51.967456 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m00:40:51.968136 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:51.968407 [info ] [Thread-1 (]: 82 of 91 START test not_null_mart_hourly_demand_is_weekend ..................... [RUN]
[0m00:40:51.968915 [info ] [Thread-3 (]: 83 of 91 START test not_null_mart_hourly_demand_pickup_hour .................... [RUN]
[0m00:40:51.969383 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m00:40:51.969914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a, now test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8)
[0m00:40:51.970424 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.mart_hourly_demand, now test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418)
[0m00:40:51.970863 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "dev"."main"."mart_daily_revenue"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:40:51.971301 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m00:40:51.971773 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m00:40:51.975532 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m00:40:51.976007 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m00:40:51.978481 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m00:40:51.980425 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: ROLLBACK
[0m00:40:51.981419 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7'
[0m00:40:51.981838 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: Close
[0m00:40:51.982589 [info ] [Thread-4 (]: 81 of 91 PASS unique_mart_daily_revenue_date_key ............................... [[32mPASS[0m in 0.05s]
[0m00:40:51.983338 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m00:40:51.985416 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m00:40:51.987579 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m00:40:51.989645 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m00:40:51.991994 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m00:40:51.997392 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m00:40:51.998199 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: BEGIN
[0m00:40:51.998887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:52.000464 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:52.000902 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m00:40:52.001223 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m00:40:52.001865 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: BEGIN
[0m00:40:52.002387 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."mart_hourly_demand"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m00:40:52.002830 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:52.004071 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:52.004522 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:52.004834 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m00:40:52.006411 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: ROLLBACK
[0m00:40:52.006780 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."mart_hourly_demand"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m00:40:52.007944 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8'
[0m00:40:52.009189 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: Close
[0m00:40:52.009563 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:52.010108 [info ] [Thread-1 (]: 82 of 91 PASS not_null_mart_hourly_demand_is_weekend ........................... [[32mPASS[0m in 0.04s]
[0m00:40:52.011730 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: ROLLBACK
[0m00:40:52.013000 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m00:40:52.014047 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418'
[0m00:40:52.014941 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: Close
[0m00:40:52.016754 [info ] [Thread-3 (]: 83 of 91 PASS not_null_mart_hourly_demand_pickup_hour .......................... [[32mPASS[0m in 0.05s]
[0m00:40:52.017610 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m00:40:55.812097 [debug] [Thread-2 (]: SQL status: OK in 5.157 seconds
[0m00:40:55.813424 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: COMMIT
[0m00:40:55.813923 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m00:40:55.814293 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: COMMIT
[0m00:40:56.225221 [debug] [Thread-2 (]: SQL status: OK in 0.410 seconds
[0m00:40:56.226073 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: Close
[0m00:40:56.619206 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba00a7020>]}
[0m00:40:56.620167 [info ] [Thread-2 (]: 67 of 91 OK created sql incremental model main.fct_trips ....................... [[32mOK[0m in 6.07s]
[0m00:40:56.620737 [debug] [Thread-2 (]: Finished running node model.nyc_taxi_pipeline_00.fct_trips
[0m00:40:56.621672 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m00:40:56.621933 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m00:40:56.622190 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m00:40:56.622449 [info ] [Thread-4 (]: 84 of 91 START test not_null_fct_trips_pickup_datetime ......................... [RUN]
[0m00:40:56.622856 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m00:40:56.623145 [info ] [Thread-1 (]: 85 of 91 START test not_null_fct_trips_total_amount ............................ [RUN]
[0m00:40:56.623531 [info ] [Thread-3 (]: 86 of 91 START test not_null_fct_trips_trip_id ................................. [RUN]
[0m00:40:56.624105 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7, now test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83)
[0m00:40:56.624401 [info ] [Thread-2 (]: 87 of 91 START test unique_fct_trips_trip_id ................................... [RUN]
[0m00:40:56.625228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8, now test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d)
[0m00:40:56.625898 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418, now test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d)
[0m00:40:56.626337 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m00:40:56.626741 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.fct_trips, now test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab)
[0m00:40:56.627202 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m00:40:56.627578 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m00:40:56.630395 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m00:40:56.630874 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m00:40:56.633411 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m00:40:56.635803 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m00:40:56.639933 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m00:40:56.645096 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m00:40:56.647080 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m00:40:56.648115 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m00:40:56.649760 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m00:40:56.650030 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m00:40:56.651741 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m00:40:56.652994 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m00:40:56.654824 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m00:40:56.656145 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m00:40:56.656555 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m00:40:56.656827 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: BEGIN
[0m00:40:56.657390 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: BEGIN
[0m00:40:56.657953 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:56.658358 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m00:40:56.658602 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:56.659249 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: BEGIN
[0m00:40:56.659555 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m00:40:56.660102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:56.660470 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: BEGIN
[0m00:40:56.661168 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:40:56.678148 [debug] [Thread-4 (]: SQL status: OK in 0.020 seconds
[0m00:40:56.678663 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m00:40:56.678931 [debug] [Thread-3 (]: SQL status: OK in 0.020 seconds
[0m00:40:56.679184 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m00:40:56.679440 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m00:40:56.679877 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m00:40:56.680349 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m00:40:56.680827 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m00:40:56.681244 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "dev"."main"."fct_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m00:40:56.681653 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."fct_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m00:40:56.682022 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."fct_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m00:40:56.682395 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."main"."fct_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:40:56.683646 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:56.684198 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:56.684477 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:56.686139 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: ROLLBACK
[0m00:40:56.689071 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: ROLLBACK
[0m00:40:56.690731 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: ROLLBACK
[0m00:40:56.698531 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d'
[0m00:40:56.693975 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d'
[0m00:40:56.692309 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83'
[0m00:40:56.700070 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: Close
[0m00:40:56.702937 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: Close
[0m00:40:56.705471 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: Close
[0m00:40:56.710662 [info ] [Thread-4 (]: 84 of 91 PASS not_null_fct_trips_pickup_datetime ............................... [[32mPASS[0m in 0.09s]
[0m00:40:56.709547 [info ] [Thread-3 (]: 86 of 91 PASS not_null_fct_trips_trip_id ....................................... [[32mPASS[0m in 0.08s]
[0m00:40:56.707849 [info ] [Thread-1 (]: 85 of 91 PASS not_null_fct_trips_total_amount .................................. [[32mPASS[0m in 0.08s]
[0m00:40:56.714721 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m00:40:56.717681 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m00:40:56.719950 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m00:40:56.819908 [debug] [Thread-2 (]: SQL status: OK in 0.136 seconds
[0m00:40:56.821709 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: ROLLBACK
[0m00:40:56.822552 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab'
[0m00:40:56.823044 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: Close
[0m00:40:56.851651 [info ] [Thread-2 (]: 87 of 91 PASS unique_fct_trips_trip_id ......................................... [[32mPASS[0m in 0.22s]
[0m00:40:56.853319 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m00:40:56.854370 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.mart_location_performance
[0m00:40:56.854933 [info ] [Thread-4 (]: 88 of 91 START sql table model main.mart_location_performance .................. [RUN]
[0m00:40:56.855429 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83, now model.nyc_taxi_pipeline_00.mart_location_performance)
[0m00:40:56.855811 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_location_performance
[0m00:40:56.858454 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m00:40:56.866563 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.mart_location_performance
[0m00:40:56.869576 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m00:40:56.870271 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Location-level performance summary.
    Uses adapter-dispatched mode_compat() for cross-dialect support.
*/

with trips as (
    select * from "dev"."main"."fct_trips"
),

final as (
    select
        pickup_location_id,
        pickup_borough,
        pickup_zone,

        count(*) as total_pickups,
        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue_per_trip,
        round(avg(tip_percentage), 2) as avg_tip_pct,
        round(avg(passenger_count), 2) as avg_passengers,

        -- most common dropoff destination
        
    mode(dropoff_zone)
 as most_common_dropoff_zone,

        -- busiest hour
        
    mode(pickup_hour)
 as peak_pickup_hour

    from trips
    where pickup_zone is not null
    group by pickup_location_id, pickup_borough, pickup_zone
)

select * from final
order by total_pickups desc
    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:40:56.870923 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:56.890136 [debug] [Thread-4 (]: SQL status: OK in 0.019 seconds
[0m00:40:56.893161 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m00:40:56.893951 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as varchar)
 as pickup_borough, 
      
    cast(null as varchar)
 as pickup_zone, 
      
    cast(null as bigint)
 as total_pickups, 
      
    cast(null as double)
 as avg_trip_distance, 
      
    cast(null as double)
 as avg_trip_duration_min, 
      
    cast(null as decimal(38,2))
 as total_revenue, 
      
    cast(null as double)
 as avg_revenue_per_trip, 
      
    cast(null as double)
 as avg_tip_pct, 
      
    cast(null as double)
 as avg_passengers, 
      
    cast(null as varchar)
 as most_common_dropoff_zone, 
      
    cast(null as bigint)
 as peak_pickup_hour
    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:40:56.895363 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:56.897102 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m00:40:56.906656 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m00:40:56.907276 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: BEGIN
[0m00:40:56.908302 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m00:40:56.908935 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m00:40:56.909479 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_location_performance__dbt_tmp"
  
  (
    pickup_location_id integer,
    pickup_borough varchar,
    pickup_zone varchar,
    total_pickups bigint,
    avg_trip_distance double,
    avg_trip_duration_min double,
    total_revenue decimal(38,2),
    avg_revenue_per_trip double,
    avg_tip_pct double,
    avg_passengers double,
    most_common_dropoff_zone varchar,
    peak_pickup_hour bigint
    
    )
 ;
    insert into "dev"."main"."mart_location_performance__dbt_tmp" 
  (
    
      
      pickup_location_id ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      total_pickups ,
    
      
      avg_trip_distance ,
    
      
      avg_trip_duration_min ,
    
      
      total_revenue ,
    
      
      avg_revenue_per_trip ,
    
      
      avg_tip_pct ,
    
      
      avg_passengers ,
    
      
      most_common_dropoff_zone ,
    
      
      peak_pickup_hour 
    
  )
 (
      
    select pickup_location_id, pickup_borough, pickup_zone, total_pickups, avg_trip_distance, avg_trip_duration_min, total_revenue, avg_revenue_per_trip, avg_tip_pct, avg_passengers, most_common_dropoff_zone, peak_pickup_hour
    from (
        /*
    Analytics mart: Location-level performance summary.
    Uses adapter-dispatched mode_compat() for cross-dialect support.
*/

with trips as (
    select * from "dev"."main"."fct_trips"
),

final as (
    select
        pickup_location_id,
        pickup_borough,
        pickup_zone,

        count(*) as total_pickups,
        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue_per_trip,
        round(avg(tip_percentage), 2) as avg_tip_pct,
        round(avg(passenger_count), 2) as avg_passengers,

        -- most common dropoff destination
        
    mode(dropoff_zone)
 as most_common_dropoff_zone,

        -- busiest hour
        
    mode(pickup_hour)
 as peak_pickup_hour

    from trips
    where pickup_zone is not null
    group by pickup_location_id, pickup_borough, pickup_zone
)

select * from final
order by total_pickups desc
    ) as model_subq
    );
  
  
[0m00:40:57.015133 [debug] [Thread-4 (]: SQL status: OK in 0.105 seconds
[0m00:40:57.018057 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m00:40:57.018599 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
alter table "dev"."main"."mart_location_performance__dbt_tmp" rename to "mart_location_performance"
[0m00:40:57.019697 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:57.020856 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: COMMIT
[0m00:40:57.021229 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m00:40:57.021581 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: COMMIT
[0m00:40:57.028678 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m00:40:57.031852 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m00:40:57.032439 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
drop table if exists "dev"."main"."mart_location_performance__dbt_backup" cascade
[0m00:40:57.033249 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m00:40:57.034188 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: Close
[0m00:40:57.086377 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb208cd4c0>]}
[0m00:40:57.087488 [info ] [Thread-4 (]: 88 of 91 OK created sql table model main.mart_location_performance ............. [[32mOK[0m in 0.23s]
[0m00:40:57.088117 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.mart_location_performance
[0m00:40:57.088880 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m00:40:57.089145 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m00:40:57.089436 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m00:40:57.089711 [info ] [Thread-1 (]: 89 of 91 START test not_null_mart_location_performance_pickup_location_id ...... [RUN]
[0m00:40:57.090250 [info ] [Thread-2 (]: 90 of 91 START test not_null_mart_location_performance_total_pickups ........... [RUN]
[0m00:40:57.090815 [info ] [Thread-3 (]: 91 of 91 START test unique_mart_location_performance_pickup_location_id ........ [RUN]
[0m00:40:57.091372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d, now test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c)
[0m00:40:57.091881 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab, now test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259)
[0m00:40:57.092370 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d, now test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62)
[0m00:40:57.092738 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m00:40:57.093055 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m00:40:57.093410 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m00:40:57.096676 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m00:40:57.099861 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m00:40:57.102486 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m00:40:57.108246 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m00:40:57.110517 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m00:40:57.113198 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m00:40:57.115418 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m00:40:57.115715 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m00:40:57.117491 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m00:40:57.120637 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m00:40:57.121082 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: BEGIN
[0m00:40:57.121440 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:40:57.122278 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m00:40:57.122692 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: BEGIN
[0m00:40:57.123148 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:57.124688 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m00:40:57.125133 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: BEGIN
[0m00:40:57.125512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:57.143827 [debug] [Thread-2 (]: SQL status: OK in 0.022 seconds
[0m00:40:57.144243 [debug] [Thread-3 (]: SQL status: OK in 0.021 seconds
[0m00:40:57.144600 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m00:40:57.144869 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m00:40:57.145430 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m00:40:57.145939 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m00:40:57.146393 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_pickups
from "dev"."main"."mart_location_performance"
where total_pickups is null



  
  
      
    ) dbt_internal_test
[0m00:40:57.146835 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pickup_location_id as unique_field,
    count(*) as n_records

from "dev"."main"."mart_location_performance"
where pickup_location_id is not null
group by pickup_location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:40:57.147291 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_location_id
from "dev"."main"."mart_location_performance"
where pickup_location_id is null



  
  
      
    ) dbt_internal_test
[0m00:40:57.148856 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m00:40:57.149200 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:57.150272 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: ROLLBACK
[0m00:40:57.151328 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: ROLLBACK
[0m00:40:57.151615 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m00:40:57.152408 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259'
[0m00:40:57.153044 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c'
[0m00:40:57.154060 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: ROLLBACK
[0m00:40:57.154315 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: Close
[0m00:40:57.154776 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: Close
[0m00:40:57.155427 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62'
[0m00:40:57.156234 [info ] [Thread-2 (]: 90 of 91 PASS not_null_mart_location_performance_total_pickups ................. [[32mPASS[0m in 0.06s]
[0m00:40:57.156958 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: Close
[0m00:40:57.156690 [info ] [Thread-1 (]: 89 of 91 PASS not_null_mart_location_performance_pickup_location_id ............ [[32mPASS[0m in 0.07s]
[0m00:40:57.157756 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m00:40:57.158482 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m00:40:57.160971 [info ] [Thread-3 (]: 91 of 91 PASS unique_mart_location_performance_pickup_location_id .............. [[32mPASS[0m in 0.07s]
[0m00:40:57.161533 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m00:40:57.163320 [debug] [MainThread]: Using duckdb connection "master"
[0m00:40:57.163722 [debug] [MainThread]: On master: BEGIN
[0m00:40:57.164023 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:40:57.185083 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m00:40:57.185684 [debug] [MainThread]: On master: COMMIT
[0m00:40:57.186093 [debug] [MainThread]: Using duckdb connection "master"
[0m00:40:57.186409 [debug] [MainThread]: On master: COMMIT
[0m00:40:57.186942 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:40:57.187272 [debug] [MainThread]: On master: Close
[0m00:40:57.190567 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:40:57.191141 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m00:40:57.191550 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c' was properly closed.
[0m00:40:57.192033 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259' was properly closed.
[0m00:40:57.192368 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62' was properly closed.
[0m00:40:57.192667 [debug] [MainThread]: Connection 'model.nyc_taxi_pipeline_00.mart_location_performance' was properly closed.
[0m00:40:57.193124 [info ] [MainThread]: 
[0m00:40:57.193483 [info ] [MainThread]: Finished running 1 incremental model, 3 seeds, 7 table models, 74 data tests, 6 view models in 0 hours 0 minutes and 10.08 seconds (10.08s).
[0m00:40:57.199080 [debug] [MainThread]: Command end result
[0m00:40:57.330665 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m00:40:57.336050 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m00:40:57.346833 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m00:40:57.347463 [info ] [MainThread]: 
[0m00:40:57.348127 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:40:57.348753 [info ] [MainThread]: 
[0m00:40:57.349189 [info ] [MainThread]: Done. PASS=91 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=91
[0m00:40:57.350162 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 13.075353, "process_in_blocks": "0", "process_kernel_time": 7.253953, "process_mem_max_rss": "1756520", "process_out_blocks": "136", "process_user_time": 25.418917}
[0m00:40:57.350704 [debug] [MainThread]: Command `dbt build` succeeded at 00:40:57.350569 after 13.08 seconds
[0m00:40:57.351076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf8597c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf8595c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb237c6270>]}
[0m00:40:57.351392 [debug] [MainThread]: Flushing usage events
[0m00:40:57.591010 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:21:53.997342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f2e44d9a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f2e69f6720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f2e44d9940>]}


============================== 09:21:54.001114 | a7274a96-4804-4aa9-bcbe-a4e24f4bf235 ==============================
[0m09:21:54.001114 [info ] [MainThread]: Running with dbt=1.11.4
[0m09:21:54.001497 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'fail_fast': 'False', 'profiles_dir': '.', 'partial_parse': 'True', 'write_json': 'True', 'invocation_command': 'dbt deps --profiles-dir .', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'version_check': 'True', 'debug': 'False', 'target_path': 'None', 'introspect': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'no_print': 'None', 'cache_selected_only': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'log_path': '/dbt/logs', 'quiet': 'False'}
[0m09:21:54.082947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7274a96-4804-4aa9-bcbe-a4e24f4bf235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f2e69a76b0>]}
[0m09:21:54.359857 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-45ldlgmt'
[0m09:21:54.360304 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m09:21:54.706678 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m09:21:54.708215 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m09:21:54.797960 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m09:21:54.801095 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m09:21:58.471257 [info ] [MainThread]: Installed from version 1.3.3
[0m09:21:58.471694 [info ] [MainThread]: Up to date!
[0m09:21:58.472094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a7274a96-4804-4aa9-bcbe-a4e24f4bf235', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f2e3c41cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f2e3c41280>]}
[0m09:21:58.473520 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.556544, "process_in_blocks": "106016", "process_kernel_time": 0.645899, "process_mem_max_rss": "104820", "process_out_blocks": "176", "process_user_time": 1.127158}
[0m09:21:58.473979 [debug] [MainThread]: Command `dbt deps` succeeded at 09:21:58.473891 after 4.56 seconds
[0m09:21:58.474354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f2e68b60f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f2e69a76b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f2e3b2c4d0>]}
[0m09:21:58.474768 [debug] [MainThread]: Flushing usage events
[0m09:21:58.740105 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:22:02.862667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125a751cbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125a745be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125a7253c20>]}


============================== 09:22:02.865129 | b2bb59df-bf4d-475a-aa37-7eb02aaa250f ==============================
[0m09:22:02.865129 [info ] [MainThread]: Running with dbt=1.11.4
[0m09:22:02.865599 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'profiles_dir': '.', 'target_path': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'use_colors': 'True', 'write_json': 'True', 'version_check': 'True', 'log_format': 'default', 'introspect': 'True', 'log_path': '/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'static_parser': 'True', 'quiet': 'False', 'fail_fast': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt build --full-refresh --profiles-dir .', 'indirect_selection': 'eager'}
[0m09:22:03.125754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125a9a67830>]}
[0m09:22:03.165907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125a32ffe60>]}
[0m09:22:03.167912 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m09:22:03.224976 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m09:22:04.038710 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:22:04.039087 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m09:22:04.039414 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:22:04.075758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712597187110>]}
[0m09:22:04.163166 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m09:22:04.168272 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m09:22:04.209368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712537d55fa0>]}
[0m09:22:04.210000 [info ] [MainThread]: Found 14 models, 74 data tests, 3 seeds, 1 source, 578 macros
[0m09:22:04.214724 [info ] [MainThread]: 
[0m09:22:04.215299 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:22:04.215722 [info ] [MainThread]: 
[0m09:22:04.216309 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:22:04.220477 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m09:22:04.321205 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m09:22:04.321622 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m09:22:04.321910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:22:04.351088 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m09:22:04.352249 [debug] [ThreadPool]: On list_dev: Close
[0m09:22:04.355875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m09:22:04.356393 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m09:22:04.360409 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:22:04.360928 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m09:22:04.361424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:22:04.380215 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m09:22:04.381305 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:22:04.381662 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m09:22:04.382119 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:22:04.382470 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:22:04.382910 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m09:22:04.383642 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:22:04.384321 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:22:04.384691 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:22:04.385028 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:22:04.385436 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:22:04.385724 [debug] [ThreadPool]: On create_dev_main: Close
[0m09:22:04.389360 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m09:22:04.392860 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:22:04.393262 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m09:22:04.393621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:22:04.411425 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m09:22:04.411953 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:22:04.412309 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m09:22:04.420907 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m09:22:04.422403 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m09:22:04.424006 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m09:22:04.424389 [debug] [ThreadPool]: On list_dev_main: Close
[0m09:22:04.429284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71259712a660>]}
[0m09:22:04.429825 [debug] [MainThread]: Using duckdb connection "master"
[0m09:22:04.430168 [debug] [MainThread]: On master: BEGIN
[0m09:22:04.430532 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:22:04.450141 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m09:22:04.450698 [debug] [MainThread]: On master: COMMIT
[0m09:22:04.451100 [debug] [MainThread]: Using duckdb connection "master"
[0m09:22:04.451473 [debug] [MainThread]: On master: COMMIT
[0m09:22:04.452048 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:22:04.452380 [debug] [MainThread]: On master: Close
[0m09:22:04.459947 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.dim_dates
[0m09:22:04.460303 [debug] [Thread-2 (]: Began running node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m09:22:04.460611 [debug] [Thread-3 (]: Began running node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m09:22:04.461195 [debug] [Thread-4 (]: Began running node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m09:22:04.460954 [info ] [Thread-1 (]: 1 of 91 START sql table model main.dim_dates ................................... [RUN]
[0m09:22:04.461705 [info ] [Thread-2 (]: 2 of 91 START sql table model main.stg_yellow_trips ............................ [RUN]
[0m09:22:04.462222 [info ] [Thread-3 (]: 3 of 91 START seed file main.payment_type_lookup ............................... [RUN]
[0m09:22:04.462764 [info ] [Thread-4 (]: 4 of 91 START seed file main.rate_code_lookup .................................. [RUN]
[0m09:22:04.463578 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nyc_taxi_pipeline_00.dim_dates'
[0m09:22:04.464403 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.nyc_taxi_pipeline_00.stg_yellow_trips'
[0m09:22:04.464896 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.nyc_taxi_pipeline_00.payment_type_lookup'
[0m09:22:04.465353 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.nyc_taxi_pipeline_00.rate_code_lookup'
[0m09:22:04.465750 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_dates
[0m09:22:04.466155 [debug] [Thread-2 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m09:22:04.466530 [debug] [Thread-3 (]: Began compiling node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m09:22:04.466966 [debug] [Thread-4 (]: Began compiling node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m09:22:04.487406 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m09:22:04.490623 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m09:22:04.491015 [debug] [Thread-3 (]: Began executing node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m09:22:04.491672 [debug] [Thread-4 (]: Began executing node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m09:22:04.492458 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: BEGIN
[0m09:22:04.504134 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:22:04.505486 [debug] [Thread-2 (]: Began executing node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m09:22:04.526707 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m09:22:04.533550 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m09:22:04.533991 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m09:22:04.534316 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.payment_type_lookup"} */
drop table if exists "dev"."main"."payment_type_lookup" cascade
[0m09:22:04.534764 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m09:22:04.536687 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m09:22:04.537027 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:22:04.537537 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */


        select 
        (date_diff('day', cast('2024-01-01' as date)::timestamp, cast('2024-02-01' as date)::timestamp ))
    
[0m09:22:04.538052 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.rate_code_lookup"} */
drop table if exists "dev"."main"."rate_code_lookup" cascade
[0m09:22:04.538952 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m09:22:04.539491 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:22:04.539892 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: BEGIN
[0m09:22:04.540262 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.541063 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:22:04.547407 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m09:22:04.550831 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_dates"
[0m09:22:04.551106 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m09:22:04.554959 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m09:22:04.555269 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m09:22:04.555767 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m09:22:04.556133 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: BEGIN
[0m09:22:04.557019 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m09:22:04.557412 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */

  
    
    

    create  table
      "dev"."main"."stg_yellow_trips__dbt_tmp"
  
    as (
      

with source as (
    select * from read_parquet('/data/yellow_tripdata_2024-01.parquet')
),

renamed as (
    select
        -- surrogate key (MD5 hash of composite key)
        md5(cast(coalesce(cast(VendorID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(PULocationID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DOLocationID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(fare_amount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(total_amount as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- identifiers
        cast("VendorID" as integer) as vendor_id,
        cast("RatecodeID" as integer) as rate_code_id,
        cast("PULocationID" as integer) as pickup_location_id,
        cast("DOLocationID" as integer) as dropoff_location_id,
        cast(payment_type as integer) as payment_type_id,

        -- timestamps
        cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
        cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as double) as trip_distance_miles,
        store_and_fwd_flag,

        -- financials
        round(cast(fare_amount as decimal(10, 2)), 2) as fare_amount,
        round(cast(extra as decimal(10, 2)), 2) as extra_amount,
        round(cast(mta_tax as decimal(10, 2)), 2) as mta_tax,
        round(cast(tip_amount as decimal(10, 2)), 2) as tip_amount,
        round(cast(tolls_amount as decimal(10, 2)), 2) as tolls_amount,
        round(cast(improvement_surcharge as decimal(10, 2)), 2) as improvement_surcharge,
        round(cast(total_amount as decimal(10, 2)), 2) as total_amount,
        round(cast(congestion_surcharge as decimal(10, 2)), 2) as congestion_surcharge,
        round(cast(Airport_fee as decimal(10, 2)), 2) as airport_fee

    from source
    where tpep_pickup_datetime is not null
      and tpep_dropoff_datetime is not null
      and trip_distance >= 0
      and fare_amount >= 0
      -- filter out-of-range dates (data quality: ~18 trips outside Jan 2024)
      and cast(tpep_pickup_datetime as date) >= date '2024-01-01'
      and cast(tpep_pickup_datetime as date) < date '2024-02-01'
)

select * from renamed
    );
  
  
[0m09:22:04.558122 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: BEGIN
[0m09:22:04.558513 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.559685 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m09:22:04.559944 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m09:22:04.560432 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m09:22:04.560797 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.payment_type_lookup"} */

    create table "dev"."main"."payment_type_lookup" ("payment_type_id" integer,"payment_type_name" varchar)
  
[0m09:22:04.561442 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.rate_code_lookup"} */

    create table "dev"."main"."rate_code_lookup" ("rate_code_id" integer,"rate_code_name" varchar)
  
[0m09:22:04.562471 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.562843 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.569464 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m09:22:04.571121 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m09:22:04.571841 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: 
          COPY "dev"."main"."payment_type_lookup" FROM '/dbt/seeds/payment_type_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m09:22:04.572319 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: 
          COPY "dev"."main"."rate_code_lookup" FROM '/dbt/seeds/rate_code_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m09:22:04.573262 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.dim_dates
[0m09:22:04.591467 [debug] [Thread-4 (]: SQL status: OK in 0.018 seconds
[0m09:22:04.592022 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m09:22:04.594913 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m09:22:04.595533 [debug] [Thread-3 (]: SQL status: OK in 0.023 seconds
[0m09:22:04.596998 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
DESCRIBE (select * from (
        /*
    Dimension table: Calendar dates for January 2024.
    Uses adapter-dispatched macros for dayname/monthname.
*/

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 31
    order by generated_number



),

all_periods as (

    select (
        

    date_add(cast('2024-01-01' as date), interval (row_number() over (order by generated_number) - 1) day)


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-02-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week_num,
        
    dayname(date_day)
 as day_of_week_name,
        
    monthname(date_day)
 as month_name,
        extract(week from date_day) as week_of_year,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when cast(date_day as date) in (
                cast('2024-01-01' as date),
                cast('2024-01-15' as date)
            ) then true
            else false
        end as is_holiday

    from date_spine
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m09:22:04.598681 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m09:22:04.604837 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:22:04.616793 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m09:22:04.617413 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as date_key, 
      
    cast(null as bigint)
 as year, 
      
    cast(null as bigint)
 as month, 
      
    cast(null as bigint)
 as day_of_month, 
      
    cast(null as bigint)
 as day_of_week_num, 
      
    cast(null as varchar)
 as day_of_week_name, 
      
    cast(null as varchar)
 as month_name, 
      
    cast(null as bigint)
 as week_of_year, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as boolean)
 as is_holiday
    ) as __dbt_sbq
    where false
    limit 0
)
[0m09:22:04.629131 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: COMMIT
[0m09:22:04.630243 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: COMMIT
[0m09:22:04.630556 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m09:22:04.630845 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:22:04.631380 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m09:22:04.632493 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: COMMIT
[0m09:22:04.638969 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: COMMIT
[0m09:22:04.648754 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_dates"
[0m09:22:04.653543 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m09:22:04.655938 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: Close
[0m09:22:04.657953 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71259712b2f0>]}
[0m09:22:04.658404 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m09:22:04.659779 [info ] [Thread-3 (]: 3 of 91 OK loaded seed file main.payment_type_lookup ........................... [[32mCREATE 6[0m in 0.19s]
[0m09:22:04.660855 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: Close
[0m09:22:04.661658 [debug] [Thread-3 (]: Finished running node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m09:22:04.662566 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712535760aa0>]}
[0m09:22:04.663026 [debug] [Thread-3 (]: Began running node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m09:22:04.663781 [info ] [Thread-4 (]: 4 of 91 OK loaded seed file main.rate_code_lookup .............................. [[32mCREATE 7[0m in 0.20s]
[0m09:22:04.664636 [info ] [Thread-3 (]: 5 of 91 START seed file main.taxi_zone_lookup .................................. [RUN]
[0m09:22:04.665475 [debug] [Thread-4 (]: Finished running node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m09:22:04.665882 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m09:22:04.666304 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.payment_type_lookup, now seed.nyc_taxi_pipeline_00.taxi_zone_lookup)
[0m09:22:04.666827 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m09:22:04.667515 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_dates__dbt_tmp"
  
  (
    date_key date,
    year bigint,
    month bigint,
    day_of_month bigint,
    day_of_week_num bigint,
    day_of_week_name varchar,
    month_name varchar,
    week_of_year bigint,
    is_weekend boolean,
    is_holiday boolean
    
    )
 ;
    insert into "dev"."main"."dim_dates__dbt_tmp" 
  (
    
      
      date_key ,
    
      
      year ,
    
      
      month ,
    
      
      day_of_month ,
    
      
      day_of_week_num ,
    
      
      day_of_week_name ,
    
      
      month_name ,
    
      
      week_of_year ,
    
      
      is_weekend ,
    
      
      is_holiday 
    
  )
 (
      
    select date_key, year, month, day_of_month, day_of_week_num, day_of_week_name, month_name, week_of_year, is_weekend, is_holiday
    from (
        /*
    Dimension table: Calendar dates for January 2024.
    Uses adapter-dispatched macros for dayname/monthname.
*/

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 31
    order by generated_number



),

all_periods as (

    select (
        

    date_add(cast('2024-01-01' as date), interval (row_number() over (order by generated_number) - 1) day)


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-02-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week_num,
        
    dayname(date_day)
 as day_of_week_name,
        
    monthname(date_day)
 as month_name,
        extract(week from date_day) as week_of_year,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when cast(date_day as date) in (
                cast('2024-01-01' as date),
                cast('2024-01-15' as date)
            ) then true
            else false
        end as is_holiday

    from date_spine
)

select * from final
    ) as model_subq
    );
  
  
[0m09:22:04.668099 [debug] [Thread-3 (]: Began compiling node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m09:22:04.668657 [info ] [Thread-4 (]: 6 of 91 START test not_null_payment_type_lookup_payment_type_id ................ [RUN]
[0m09:22:04.670457 [debug] [Thread-3 (]: Began executing node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m09:22:04.671178 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.rate_code_lookup, now test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521)
[0m09:22:04.673645 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m09:22:04.682583 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m09:22:04.684030 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m09:22:04.688822 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m09:22:04.690396 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
alter table "dev"."main"."dim_dates" rename to "dim_dates__dbt_backup"
[0m09:22:04.693205 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m09:22:04.693631 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"} */
drop table if exists "dev"."main"."taxi_zone_lookup" cascade
[0m09:22:04.693957 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:22:04.694277 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:04.696422 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m09:22:04.697472 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
alter table "dev"."main"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m09:22:04.697789 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m09:22:04.708661 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m09:22:04.709599 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m09:22:04.710694 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m09:22:04.710961 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m09:22:04.712072 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: BEGIN
[0m09:22:04.713410 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: COMMIT
[0m09:22:04.714280 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m09:22:04.714628 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m09:22:04.715070 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m09:22:04.715662 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: COMMIT
[0m09:22:04.716298 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"} */

    create table "dev"."main"."taxi_zone_lookup" ("LocationID" integer,"Borough" varchar,"Zone" varchar,"service_zone" varchar)
  
[0m09:22:04.717601 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m09:22:04.718637 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m09:22:04.719066 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: 
          COPY "dev"."main"."taxi_zone_lookup" FROM '/dbt/seeds/taxi_zone_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m09:22:04.720190 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:22:04.720504 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m09:22:04.722205 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m09:22:04.722668 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: BEGIN
[0m09:22:04.723140 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
drop table if exists "dev"."main"."dim_dates__dbt_backup" cascade
[0m09:22:04.723589 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:04.724605 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.724998 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m09:22:04.725503 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."payment_type_lookup"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m09:22:04.726270 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m09:22:04.726563 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:22:04.727119 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m09:22:04.727388 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.728429 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: Close
[0m09:22:04.731231 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: ROLLBACK
[0m09:22:04.732121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712537113f50>]}
[0m09:22:04.732948 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521'
[0m09:22:04.733610 [info ] [Thread-1 (]: 1 of 91 OK created sql table model main.dim_dates .............................. [[32mOK[0m in 0.27s]
[0m09:22:04.734194 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: Close
[0m09:22:04.734955 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.dim_dates
[0m09:22:04.735776 [info ] [Thread-4 (]: 6 of 91 PASS not_null_payment_type_lookup_payment_type_id ...................... [[32mPASS[0m in 0.06s]
[0m09:22:04.736114 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m09:22:04.737099 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: COMMIT
[0m09:22:04.737962 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m09:22:04.738481 [info ] [Thread-1 (]: 7 of 91 START test unique_payment_type_lookup_payment_type_id .................. [RUN]
[0m09:22:04.738961 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m09:22:04.739457 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m09:22:04.740107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_dates, now test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7)
[0m09:22:04.740535 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: COMMIT
[0m09:22:04.741030 [info ] [Thread-4 (]: 8 of 91 START test not_null_rate_code_lookup_rate_code_id ...................... [RUN]
[0m09:22:04.741674 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m09:22:04.742633 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521, now test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec)
[0m09:22:04.747012 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m09:22:04.747668 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m09:22:04.748016 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m09:22:04.749363 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: Close
[0m09:22:04.752193 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m09:22:04.752832 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125357bc4a0>]}
[0m09:22:04.753371 [info ] [Thread-3 (]: 5 of 91 OK loaded seed file main.taxi_zone_lookup .............................. [[32mCREATE 265[0m in 0.09s]
[0m09:22:04.753849 [debug] [Thread-3 (]: Finished running node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m09:22:04.754370 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m09:22:04.754932 [info ] [Thread-3 (]: 9 of 91 START test unique_rate_code_lookup_rate_code_id ........................ [RUN]
[0m09:22:04.755502 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.taxi_zone_lookup, now test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d)
[0m09:22:04.755999 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m09:22:04.756325 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m09:22:04.759028 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m09:22:04.759523 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m09:22:04.761181 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m09:22:04.764075 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m09:22:04.769018 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m09:22:04.769625 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m09:22:04.771185 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m09:22:04.771749 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: BEGIN
[0m09:22:04.772403 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m09:22:04.772865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:04.773320 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: BEGIN
[0m09:22:04.774336 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.774619 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:04.775646 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m09:22:04.776421 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:04.776763 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."payment_type_lookup"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:22:04.777217 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m09:22:04.778050 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_id
from "dev"."main"."rate_code_lookup"
where rate_code_id is null



  
  
      
    ) dbt_internal_test
[0m09:22:04.779008 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m09:22:04.779513 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:22:04.781031 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: ROLLBACK
[0m09:22:04.781478 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m09:22:04.782517 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: ROLLBACK
[0m09:22:04.783013 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec'
[0m09:22:04.783430 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: BEGIN
[0m09:22:04.784102 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7'
[0m09:22:04.784472 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: Close
[0m09:22:04.784929 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:04.785469 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: Close
[0m09:22:04.786260 [info ] [Thread-4 (]: 8 of 91 PASS not_null_rate_code_lookup_rate_code_id ............................ [[32mPASS[0m in 0.04s]
[0m09:22:04.786724 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m09:22:04.787104 [info ] [Thread-1 (]: 7 of 91 PASS unique_payment_type_lookup_payment_type_id ........................ [[32mPASS[0m in 0.05s]
[0m09:22:04.787468 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m09:22:04.788107 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m09:22:04.788860 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m09:22:04.789462 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m09:22:04.789968 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rate_code_id as unique_field,
    count(*) as n_records

from "dev"."main"."rate_code_lookup"
where rate_code_id is not null
group by rate_code_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:22:04.790350 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m09:22:04.790783 [info ] [Thread-4 (]: 10 of 91 START test not_null_dim_dates_date_key ................................ [RUN]
[0m09:22:04.791660 [info ] [Thread-1 (]: 11 of 91 START test not_null_dim_dates_day_of_week_name ........................ [RUN]
[0m09:22:04.792237 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.792697 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec, now test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348)
[0m09:22:04.793300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7, now test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541)
[0m09:22:04.794670 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: ROLLBACK
[0m09:22:04.794921 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m09:22:04.795351 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m09:22:04.796220 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d'
[0m09:22:04.800061 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m09:22:04.803474 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m09:22:04.804056 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: Close
[0m09:22:04.805484 [info ] [Thread-3 (]: 9 of 91 PASS unique_rate_code_lookup_rate_code_id .............................. [[32mPASS[0m in 0.05s]
[0m09:22:04.806178 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m09:22:04.806740 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m09:22:04.807269 [info ] [Thread-3 (]: 12 of 91 START test not_null_dim_dates_is_holiday .............................. [RUN]
[0m09:22:04.807803 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d, now test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a)
[0m09:22:04.808129 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m09:22:04.810903 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m09:22:04.812066 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m09:22:04.812341 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m09:22:04.813857 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m09:22:04.815561 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m09:22:04.816837 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m09:22:04.818752 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m09:22:04.824068 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m09:22:04.824650 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m09:22:04.825026 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: BEGIN
[0m09:22:04.825567 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: BEGIN
[0m09:22:04.826117 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:04.826555 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m09:22:04.827028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:04.828053 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:04.828381 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: BEGIN
[0m09:22:04.829219 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:22:04.829580 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m09:22:04.830171 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:04.830705 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m09:22:04.831303 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "dev"."main"."dim_dates"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m09:22:04.832132 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m09:22:04.832434 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select day_of_week_name
from "dev"."main"."dim_dates"
where day_of_week_name is null



  
  
      
    ) dbt_internal_test
[0m09:22:04.833336 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m09:22:04.833761 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.834461 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_holiday
from "dev"."main"."dim_dates"
where is_holiday is null



  
  
      
    ) dbt_internal_test
[0m09:22:04.834837 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.836239 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: ROLLBACK
[0m09:22:04.838036 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: ROLLBACK
[0m09:22:04.838865 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348'
[0m09:22:04.839226 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m09:22:04.840225 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541'
[0m09:22:04.840711 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: Close
[0m09:22:04.842052 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: ROLLBACK
[0m09:22:04.842322 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: Close
[0m09:22:04.843202 [info ] [Thread-4 (]: 10 of 91 PASS not_null_dim_dates_date_key ...................................... [[32mPASS[0m in 0.05s]
[0m09:22:04.844166 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a'
[0m09:22:04.844785 [info ] [Thread-1 (]: 11 of 91 PASS not_null_dim_dates_day_of_week_name .............................. [[32mPASS[0m in 0.05s]
[0m09:22:04.845265 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m09:22:04.845800 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: Close
[0m09:22:04.846423 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m09:22:04.846955 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m09:22:04.847838 [info ] [Thread-3 (]: 12 of 91 PASS not_null_dim_dates_is_holiday .................................... [[32mPASS[0m in 0.04s]
[0m09:22:04.848195 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m09:22:04.848821 [info ] [Thread-4 (]: 13 of 91 START test not_null_dim_dates_is_weekend .............................. [RUN]
[0m09:22:04.849434 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m09:22:04.849959 [info ] [Thread-1 (]: 14 of 91 START test unique_dim_dates_date_key .................................. [RUN]
[0m09:22:04.850496 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348, now test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0)
[0m09:22:04.850925 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m09:22:04.851379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541, now test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d)
[0m09:22:04.851853 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m09:22:04.852315 [info ] [Thread-3 (]: 15 of 91 START test not_null_taxi_zone_lookup_Borough .......................... [RUN]
[0m09:22:04.852721 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m09:22:04.855826 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m09:22:04.856389 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a, now test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa)
[0m09:22:04.859463 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m09:22:04.860658 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m09:22:04.864033 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m09:22:04.869483 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m09:22:04.872955 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m09:22:04.873423 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m09:22:04.875360 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m09:22:04.875756 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m09:22:04.877620 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m09:22:04.884839 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m09:22:04.885739 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: BEGIN
[0m09:22:04.886592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:04.887315 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m09:22:04.888065 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: BEGIN
[0m09:22:04.888443 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m09:22:04.888761 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:22:04.889111 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:04.889678 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: BEGIN
[0m09:22:04.890242 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m09:22:04.891121 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:04.891402 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:04.891871 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "dev"."main"."dim_dates"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:22:04.892380 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m09:22:04.893715 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m09:22:04.894037 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."dim_dates"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m09:22:04.894461 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.894747 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m09:22:04.896324 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: ROLLBACK
[0m09:22:04.896647 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Borough
from "dev"."main"."taxi_zone_lookup"
where Borough is null



  
  
      
    ) dbt_internal_test
[0m09:22:04.897000 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:04.897848 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d'
[0m09:22:04.899352 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: ROLLBACK
[0m09:22:04.899736 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m09:22:04.900039 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: Close
[0m09:22:04.900898 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0'
[0m09:22:04.902498 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: ROLLBACK
[0m09:22:04.903092 [info ] [Thread-1 (]: 14 of 91 PASS unique_dim_dates_date_key ........................................ [[32mPASS[0m in 0.05s]
[0m09:22:04.903719 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: Close
[0m09:22:04.904606 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa'
[0m09:22:04.905269 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m09:22:04.905944 [info ] [Thread-4 (]: 13 of 91 PASS not_null_dim_dates_is_weekend .................................... [[32mPASS[0m in 0.06s]
[0m09:22:04.906427 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: Close
[0m09:22:04.907004 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m09:22:04.907666 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m09:22:04.908238 [info ] [Thread-3 (]: 15 of 91 PASS not_null_taxi_zone_lookup_Borough ................................ [[32mPASS[0m in 0.05s]
[0m09:22:04.908675 [info ] [Thread-1 (]: 16 of 91 START test not_null_taxi_zone_lookup_LocationID ....................... [RUN]
[0m09:22:04.909275 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m09:22:04.910067 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m09:22:04.910547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d, now test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a)
[0m09:22:04.910944 [info ] [Thread-4 (]: 17 of 91 START test unique_taxi_zone_lookup_LocationID ......................... [RUN]
[0m09:22:04.911779 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.stg_payment_types
[0m09:22:04.912307 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m09:22:04.913076 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0, now test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8)
[0m09:22:04.913692 [info ] [Thread-3 (]: 18 of 91 START sql view model main.stg_payment_types ........................... [RUN]
[0m09:22:04.916708 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m09:22:04.917417 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m09:22:04.918109 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa, now model.nyc_taxi_pipeline_00.stg_payment_types)
[0m09:22:04.920985 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m09:22:04.921646 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_payment_types
[0m09:22:04.924010 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m09:22:04.925444 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m09:22:04.927221 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m09:22:04.929011 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m09:22:04.930976 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m09:22:04.931429 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.stg_payment_types
[0m09:22:04.943386 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m09:22:04.944651 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m09:22:04.945104 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: BEGIN
[0m09:22:04.945484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:04.946416 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.946818 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m09:22:04.947151 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m09:22:04.947742 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: BEGIN
[0m09:22:04.948506 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select LocationID
from "dev"."main"."taxi_zone_lookup"
where LocationID is null



  
  
      
    ) dbt_internal_test
[0m09:22:04.949071 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:04.949920 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m09:22:04.950746 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.951095 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: BEGIN
[0m09:22:04.951402 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:04.952885 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: ROLLBACK
[0m09:22:04.953641 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:04.954196 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m09:22:04.955125 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a'
[0m09:22:04.955990 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    LocationID as unique_field,
    count(*) as n_records

from "dev"."main"."taxi_zone_lookup"
where LocationID is not null
group by LocationID
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:22:04.956451 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m09:22:04.956700 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: Close
[0m09:22:04.957950 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m09:22:04.958637 [info ] [Thread-1 (]: 16 of 91 PASS not_null_taxi_zone_lookup_LocationID ............................. [[32mPASS[0m in 0.05s]
[0m09:22:04.958891 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.959125 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */

  
  create view "dev"."main"."stg_payment_types__dbt_tmp" as (
    /*
    Staging model: Payment type lookup
    Maps payment_type_id to human-readable names.
*/

with source as (
    select * from "dev"."main"."payment_type_lookup"
),

renamed as (
    select
        payment_type_id,
        payment_type_name
    from source
)

select * from renamed
  );

[0m09:22:04.959839 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m09:22:04.961607 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: ROLLBACK
[0m09:22:04.962550 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m09:22:04.962971 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.963544 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8'
[0m09:22:04.964130 [info ] [Thread-1 (]: 19 of 91 START sql view model main.stg_rate_codes .............................. [RUN]
[0m09:22:04.967632 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m09:22:04.968086 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: Close
[0m09:22:04.968703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a, now model.nyc_taxi_pipeline_00.stg_rate_codes)
[0m09:22:04.969114 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
alter view "dev"."main"."stg_payment_types" rename to "stg_payment_types__dbt_backup"
[0m09:22:04.969787 [info ] [Thread-4 (]: 17 of 91 PASS unique_taxi_zone_lookup_LocationID ............................... [[32mPASS[0m in 0.06s]
[0m09:22:04.970117 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m09:22:04.970872 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m09:22:04.971361 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.973126 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m09:22:04.974035 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m09:22:04.976045 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m09:22:04.976808 [info ] [Thread-4 (]: 20 of 91 START sql view model main.stg_taxi_zones .............................. [RUN]
[0m09:22:04.977327 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
alter view "dev"."main"."stg_payment_types__dbt_tmp" rename to "stg_payment_types"
[0m09:22:04.977977 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8, now model.nyc_taxi_pipeline_00.stg_taxi_zones)
[0m09:22:04.978773 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m09:22:04.979184 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.981402 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m09:22:04.982811 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: COMMIT
[0m09:22:04.983881 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m09:22:04.984152 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m09:22:04.984417 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: COMMIT
[0m09:22:04.986854 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m09:22:04.988805 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m09:22:04.991708 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m09:22:04.996343 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m09:22:04.996917 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: BEGIN
[0m09:22:04.997316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:04.997630 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m09:22:04.998277 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.998676 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: BEGIN
[0m09:22:04.999357 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m09:22:04.999995 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:05.000470 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */

  
  create view "dev"."main"."stg_rate_codes__dbt_tmp" as (
    /*
    Staging model: Rate code lookup
    Maps rate_code_id to human-readable names.
*/

with source as (
    select * from "dev"."main"."rate_code_lookup"
),

renamed as (
    select
        rate_code_id,
        rate_code_name
    from source
)

select * from renamed
  );

[0m09:22:05.001428 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.001868 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m09:22:05.002286 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */

  
  create view "dev"."main"."stg_taxi_zones__dbt_tmp" as (
    /*
    Staging model: Taxi zone lookup
    Maps LocationID to borough and zone name.
*/

with source as (
    select * from "dev"."main"."taxi_zone_lookup"
),

renamed as (
    select
        cast("LocationID" as integer) as location_id,
        "Borough" as borough,
        "Zone" as zone_name,
        service_zone
    from source
)

select * from renamed
  );

[0m09:22:05.040158 [debug] [Thread-3 (]: SQL status: OK in 0.052 seconds
[0m09:22:05.040641 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m09:22:05.040963 [debug] [Thread-4 (]: SQL status: OK in 0.038 seconds
[0m09:22:05.042818 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m09:22:05.045411 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m09:22:05.047905 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m09:22:05.048389 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
drop view if exists "dev"."main"."stg_payment_types__dbt_backup" cascade
[0m09:22:05.048804 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
alter view "dev"."main"."stg_rate_codes" rename to "stg_rate_codes__dbt_backup"
[0m09:22:05.049315 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
alter view "dev"."main"."stg_taxi_zones" rename to "stg_taxi_zones__dbt_backup"
[0m09:22:05.050697 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.051351 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m09:22:05.054831 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m09:22:05.055294 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m09:22:05.057619 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m09:22:05.058165 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
alter view "dev"."main"."stg_rate_codes__dbt_tmp" rename to "stg_rate_codes"
[0m09:22:05.059423 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: Close
[0m09:22:05.059839 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
alter view "dev"."main"."stg_taxi_zones__dbt_tmp" rename to "stg_taxi_zones"
[0m09:22:05.060892 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:22:05.061335 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125348ba750>]}
[0m09:22:05.062708 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: COMMIT
[0m09:22:05.063032 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.063518 [info ] [Thread-3 (]: 18 of 91 OK created sql view model main.stg_payment_types ...................... [[32mOK[0m in 0.14s]
[0m09:22:05.063936 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m09:22:05.065254 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: COMMIT
[0m09:22:05.066022 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.stg_payment_types
[0m09:22:05.066512 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: COMMIT
[0m09:22:05.067009 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m09:22:05.067970 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m09:22:05.068734 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: COMMIT
[0m09:22:05.069682 [info ] [Thread-3 (]: 21 of 91 START test not_null_stg_payment_types_payment_type_id ................. [RUN]
[0m09:22:05.070802 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_payment_types, now test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78)
[0m09:22:05.071402 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m09:22:05.074669 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m09:22:05.075042 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:22:05.077734 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m09:22:05.078108 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m09:22:05.078890 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
drop view if exists "dev"."main"."stg_rate_codes__dbt_backup" cascade
[0m09:22:05.080945 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m09:22:05.082108 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
drop view if exists "dev"."main"."stg_taxi_zones__dbt_backup" cascade
[0m09:22:05.084690 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:22:05.085920 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: Close
[0m09:22:05.086776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125357be150>]}
[0m09:22:05.087400 [info ] [Thread-1 (]: 19 of 91 OK created sql view model main.stg_rate_codes ......................... [[32mOK[0m in 0.12s]
[0m09:22:05.087785 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m09:22:05.088279 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m09:22:05.089582 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: Close
[0m09:22:05.090504 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m09:22:05.091335 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125348d5190>]}
[0m09:22:05.091685 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m09:22:05.092168 [info ] [Thread-1 (]: 22 of 91 START test not_null_stg_payment_types_payment_type_name ............... [RUN]
[0m09:22:05.092731 [info ] [Thread-4 (]: 20 of 91 OK created sql view model main.stg_taxi_zones ......................... [[32mOK[0m in 0.11s]
[0m09:22:05.095104 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m09:22:05.096091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_rate_codes, now test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39)
[0m09:22:05.096944 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m09:22:05.098400 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m09:22:05.099077 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m09:22:05.102038 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m09:22:05.102469 [info ] [Thread-4 (]: 23 of 91 START test unique_stg_payment_types_payment_type_id ................... [RUN]
[0m09:22:05.103289 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_taxi_zones, now test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534)
[0m09:22:05.103920 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m09:22:05.106966 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m09:22:05.108765 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m09:22:05.109203 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: BEGIN
[0m09:22:05.109629 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:05.110505 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.110885 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m09:22:05.111206 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m09:22:05.111693 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."stg_payment_types"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m09:22:05.114123 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m09:22:05.114555 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m09:22:05.115845 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.118456 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m09:22:05.120027 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: ROLLBACK
[0m09:22:05.121097 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78'
[0m09:22:05.121540 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: Close
[0m09:22:05.122289 [info ] [Thread-3 (]: 21 of 91 PASS not_null_stg_payment_types_payment_type_id ....................... [[32mPASS[0m in 0.05s]
[0m09:22:05.122851 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m09:22:05.123395 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m09:22:05.123793 [info ] [Thread-3 (]: 24 of 91 START test not_null_stg_rate_codes_rate_code_id ....................... [RUN]
[0m09:22:05.124408 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78, now test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a)
[0m09:22:05.124845 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m09:22:05.128357 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m09:22:05.129426 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m09:22:05.129926 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: BEGIN
[0m09:22:05.130311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:05.130626 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m09:22:05.131219 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.131486 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: BEGIN
[0m09:22:05.132165 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m09:22:05.132556 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:05.132968 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_name
from "dev"."main"."stg_payment_types"
where payment_type_name is null



  
  
      
    ) dbt_internal_test
[0m09:22:05.133569 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.134203 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m09:22:05.134513 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.134770 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_payment_types"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:22:05.136164 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: ROLLBACK
[0m09:22:05.137545 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39'
[0m09:22:05.137932 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.138178 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: Close
[0m09:22:05.138493 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m09:22:05.139685 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: ROLLBACK
[0m09:22:05.140207 [info ] [Thread-1 (]: 22 of 91 PASS not_null_stg_payment_types_payment_type_name ..................... [[32mPASS[0m in 0.04s]
[0m09:22:05.142829 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m09:22:05.143895 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534'
[0m09:22:05.144298 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m09:22:05.145085 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: Close
[0m09:22:05.145638 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m09:22:05.146217 [info ] [Thread-4 (]: 23 of 91 PASS unique_stg_payment_types_payment_type_id ......................... [[32mPASS[0m in 0.04s]
[0m09:22:05.146635 [info ] [Thread-1 (]: 25 of 91 START test not_null_stg_rate_codes_rate_code_name ..................... [RUN]
[0m09:22:05.147459 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m09:22:05.148164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39, now test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f)
[0m09:22:05.148713 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m09:22:05.149277 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m09:22:05.149823 [info ] [Thread-4 (]: 26 of 91 START test unique_stg_rate_codes_rate_code_id ......................... [RUN]
[0m09:22:05.152987 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m09:22:05.153593 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534, now test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3)
[0m09:22:05.154480 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m09:22:05.157951 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m09:22:05.158459 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m09:22:05.159273 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: BEGIN
[0m09:22:05.159729 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:05.160718 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.161230 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m09:22:05.161774 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_id
from "dev"."main"."stg_rate_codes"
where rate_code_id is null



  
  
      
    ) dbt_internal_test
[0m09:22:05.162918 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.164170 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: ROLLBACK
[0m09:22:05.165269 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a'
[0m09:22:05.165615 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m09:22:05.165930 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: Close
[0m09:22:05.166339 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m09:22:05.168132 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m09:22:05.171799 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m09:22:05.168908 [info ] [Thread-3 (]: 24 of 91 PASS not_null_stg_rate_codes_rate_code_id ............................. [[32mPASS[0m in 0.04s]
[0m09:22:05.174353 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m09:22:05.175007 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m09:22:05.175443 [info ] [Thread-3 (]: 27 of 91 START test not_null_stg_taxi_zones_borough ............................ [RUN]
[0m09:22:05.175914 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b)
[0m09:22:05.176335 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m09:22:05.179125 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m09:22:05.180333 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m09:22:05.180856 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: BEGIN
[0m09:22:05.181165 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m09:22:05.181535 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:05.182145 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: BEGIN
[0m09:22:05.183188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:05.183684 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:05.184383 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.184701 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m09:22:05.185212 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m09:22:05.185730 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rate_code_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_rate_codes"
where rate_code_id is not null
group by rate_code_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:22:05.186436 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_name
from "dev"."main"."stg_rate_codes"
where rate_code_name is null



  
  
      
    ) dbt_internal_test
[0m09:22:05.188477 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.188944 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m09:22:05.189300 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:05.190629 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: ROLLBACK
[0m09:22:05.192215 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m09:22:05.193369 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: ROLLBACK
[0m09:22:05.193876 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f'
[0m09:22:05.194715 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3'
[0m09:22:05.195108 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: Close
[0m09:22:05.195541 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: Close
[0m09:22:05.196380 [info ] [Thread-1 (]: 25 of 91 PASS not_null_stg_rate_codes_rate_code_name ........................... [[32mPASS[0m in 0.05s]
[0m09:22:05.197211 [info ] [Thread-4 (]: 26 of 91 PASS unique_stg_rate_codes_rate_code_id ............................... [[32mPASS[0m in 0.04s]
[0m09:22:05.197976 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m09:22:05.198586 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m09:22:05.199140 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m09:22:05.199801 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m09:22:05.200429 [info ] [Thread-1 (]: 28 of 91 START test not_null_stg_taxi_zones_location_id ........................ [RUN]
[0m09:22:05.201004 [info ] [Thread-4 (]: 29 of 91 START test not_null_stg_taxi_zones_zone_name .......................... [RUN]
[0m09:22:05.201743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf)
[0m09:22:05.202567 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84)
[0m09:22:05.203529 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m09:22:05.204334 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m09:22:05.207874 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m09:22:05.208391 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m09:22:05.212502 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m09:22:05.213853 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: BEGIN
[0m09:22:05.214861 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:05.215953 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.216526 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m09:22:05.217106 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select borough
from "dev"."main"."stg_taxi_zones"
where borough is null



  
  
      
    ) dbt_internal_test
[0m09:22:05.218468 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.220183 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: ROLLBACK
[0m09:22:05.221187 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b'
[0m09:22:05.221570 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m09:22:05.221873 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: Close
[0m09:22:05.224159 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m09:22:05.224637 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m09:22:05.225304 [info ] [Thread-3 (]: 27 of 91 PASS not_null_stg_taxi_zones_borough .................................. [[32mPASS[0m in 0.05s]
[0m09:22:05.227294 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m09:22:05.228207 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m09:22:05.229218 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m09:22:05.229745 [info ] [Thread-3 (]: 30 of 91 START test unique_stg_taxi_zones_location_id .......................... [RUN]
[0m09:22:05.230250 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b, now test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c)
[0m09:22:05.230767 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m09:22:05.233797 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m09:22:05.235388 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m09:22:05.235977 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: BEGIN
[0m09:22:05.236442 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m09:22:05.236879 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:05.237718 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: BEGIN
[0m09:22:05.238824 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:05.239120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:05.239596 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m09:22:05.240665 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.241042 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select zone_name
from "dev"."main"."stg_taxi_zones"
where zone_name is null



  
  
      
    ) dbt_internal_test
[0m09:22:05.241678 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m09:22:05.242897 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "dev"."main"."stg_taxi_zones"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m09:22:05.243554 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.243989 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.244313 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m09:22:05.245773 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: ROLLBACK
[0m09:22:05.247014 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: ROLLBACK
[0m09:22:05.249276 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m09:22:05.250386 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84'
[0m09:22:05.251359 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf'
[0m09:22:05.252329 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: Close
[0m09:22:05.252994 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: Close
[0m09:22:05.254042 [info ] [Thread-4 (]: 29 of 91 PASS not_null_stg_taxi_zones_zone_name ................................ [[32mPASS[0m in 0.05s]
[0m09:22:05.254620 [info ] [Thread-1 (]: 28 of 91 PASS not_null_stg_taxi_zones_location_id .............................. [[32mPASS[0m in 0.05s]
[0m09:22:05.255406 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m09:22:05.256097 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m09:22:05.256775 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.dim_payment_types
[0m09:22:05.258115 [info ] [Thread-4 (]: 31 of 91 START sql table model main.dim_payment_types .......................... [RUN]
[0m09:22:05.258840 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84, now model.nyc_taxi_pipeline_00.dim_payment_types)
[0m09:22:05.259429 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_payment_types
[0m09:22:05.261883 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m09:22:05.264061 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m09:22:05.264557 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: BEGIN
[0m09:22:05.265083 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:05.266064 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.266688 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m09:22:05.267254 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_taxi_zones"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:22:05.269490 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m09:22:05.272161 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: ROLLBACK
[0m09:22:05.273541 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c'
[0m09:22:05.274073 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.dim_payment_types
[0m09:22:05.274533 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: Close
[0m09:22:05.277475 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m09:22:05.278462 [info ] [Thread-3 (]: 30 of 91 PASS unique_stg_taxi_zones_location_id ................................ [[32mPASS[0m in 0.05s]
[0m09:22:05.279111 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
DESCRIBE (select * from (
        /*
    Dimension table: Payment type descriptions.
*/

with payment_types as (
    select * from "dev"."main"."stg_payment_types"
),

final as (
    select
        payment_type_id,
        payment_type_name
    from payment_types
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m09:22:05.279796 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m09:22:05.280427 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:05.281617 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.dim_locations
[0m09:22:05.282815 [info ] [Thread-1 (]: 32 of 91 START sql table model main.dim_locations .............................. [RUN]
[0m09:22:05.283456 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m09:22:05.284043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf, now model.nyc_taxi_pipeline_00.dim_locations)
[0m09:22:05.285622 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m09:22:05.286034 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_locations
[0m09:22:05.286798 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as payment_type_id, 
      
    cast(null as varchar)
 as payment_type_name
    ) as __dbt_sbq
    where false
    limit 0
)
[0m09:22:05.289618 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_locations"
[0m09:22:05.291528 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.292978 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m09:22:05.304684 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.dim_locations
[0m09:22:05.308476 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m09:22:05.309043 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m09:22:05.309409 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
DESCRIBE (select * from (
        /*
    Dimension table: TLC Taxi Zone locations.
*/

with zones as (
    select * from "dev"."main"."stg_taxi_zones"
),

final as (
    select
        location_id,
        borough,
        zone_name,
        service_zone
    from zones
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m09:22:05.310060 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: BEGIN
[0m09:22:05.310933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:05.312035 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m09:22:05.313140 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m09:22:05.313478 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:22:05.313854 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_payment_types__dbt_tmp"
  
  (
    payment_type_id integer,
    payment_type_name varchar
    
    )
 ;
    insert into "dev"."main"."dim_payment_types__dbt_tmp" 
  (
    
      
      payment_type_id ,
    
      
      payment_type_name 
    
  )
 (
      
    select payment_type_id, payment_type_name
    from (
        /*
    Dimension table: Payment type descriptions.
*/

with payment_types as (
    select * from "dev"."main"."stg_payment_types"
),

final as (
    select
        payment_type_id,
        payment_type_name
    from payment_types
)

select * from final
    ) as model_subq
    );
  
  
[0m09:22:05.315845 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m09:22:05.316765 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as location_id, 
      
    cast(null as varchar)
 as borough, 
      
    cast(null as varchar)
 as zone_name, 
      
    cast(null as varchar)
 as service_zone
    ) as __dbt_sbq
    where false
    limit 0
)
[0m09:22:05.317872 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:05.318261 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.320286 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m09:22:05.321953 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_locations"
[0m09:22:05.322818 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
alter table "dev"."main"."dim_payment_types" rename to "dim_payment_types__dbt_backup"
[0m09:22:05.324528 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.327267 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m09:22:05.327961 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
alter table "dev"."main"."dim_payment_types__dbt_tmp" rename to "dim_payment_types"
[0m09:22:05.328866 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m09:22:05.330258 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: COMMIT
[0m09:22:05.330983 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m09:22:05.331764 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: COMMIT
[0m09:22:05.334801 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m09:22:05.335367 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_locations: BEGIN
[0m09:22:05.336540 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.337118 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m09:22:05.337480 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m09:22:05.339590 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m09:22:05.340257 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_locations__dbt_tmp"
  
  (
    location_id integer,
    borough varchar,
    zone_name varchar,
    service_zone varchar
    
    )
 ;
    insert into "dev"."main"."dim_locations__dbt_tmp" 
  (
    
      
      location_id ,
    
      
      borough ,
    
      
      zone_name ,
    
      
      service_zone 
    
  )
 (
      
    select location_id, borough, zone_name, service_zone
    from (
        /*
    Dimension table: TLC Taxi Zone locations.
*/

with zones as (
    select * from "dev"."main"."stg_taxi_zones"
),

final as (
    select
        location_id,
        borough,
        zone_name,
        service_zone
    from zones
)

select * from final
    ) as model_subq
    );
  
  
[0m09:22:05.341337 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
drop table if exists "dev"."main"."dim_payment_types__dbt_backup" cascade
[0m09:22:05.344019 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:22:05.346689 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m09:22:05.347016 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m09:22:05.347372 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
alter table "dev"."main"."dim_locations" rename to "dim_locations__dbt_backup"
[0m09:22:05.348719 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: Close
[0m09:22:05.349899 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712534167800>]}
[0m09:22:05.350271 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.351006 [info ] [Thread-4 (]: 31 of 91 OK created sql table model main.dim_payment_types ..................... [[32mOK[0m in 0.09s]
[0m09:22:05.353710 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m09:22:05.354469 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.dim_payment_types
[0m09:22:05.354919 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
alter table "dev"."main"."dim_locations__dbt_tmp" rename to "dim_locations"
[0m09:22:05.356466 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m09:22:05.356856 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m09:22:05.357225 [info ] [Thread-3 (]: 33 of 91 START test not_null_dim_payment_types_payment_type_id ................. [RUN]
[0m09:22:05.357561 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.358026 [info ] [Thread-4 (]: 34 of 91 START test not_null_dim_payment_types_payment_type_name ............... [RUN]
[0m09:22:05.358566 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c, now test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10)
[0m09:22:05.359745 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_locations: COMMIT
[0m09:22:05.360248 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_payment_types, now test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0)
[0m09:22:05.360600 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m09:22:05.361071 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m09:22:05.361471 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m09:22:05.363969 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m09:22:05.364428 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_locations: COMMIT
[0m09:22:05.366899 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m09:22:05.371831 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:22:05.373963 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m09:22:05.374461 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
drop table if exists "dev"."main"."dim_locations__dbt_backup" cascade
[0m09:22:05.375460 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m09:22:05.378356 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m09:22:05.378607 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:22:05.378846 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m09:22:05.380165 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_locations: Close
[0m09:22:05.381978 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m09:22:05.383659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125348caea0>]}
[0m09:22:05.384803 [info ] [Thread-1 (]: 32 of 91 OK created sql table model main.dim_locations ......................... [[32mOK[0m in 0.10s]
[0m09:22:05.385539 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.dim_locations
[0m09:22:05.386067 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m09:22:05.386572 [info ] [Thread-1 (]: 35 of 91 START test unique_dim_payment_types_payment_type_id ................... [RUN]
[0m09:22:05.387063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_locations, now test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62)
[0m09:22:05.387482 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m09:22:05.390241 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m09:22:05.391341 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m09:22:05.391727 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: BEGIN
[0m09:22:05.391987 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m09:22:05.392201 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:05.392590 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: BEGIN
[0m09:22:05.393333 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:05.393575 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.394212 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.394660 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m09:22:05.395713 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m09:22:05.396399 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_name
from "dev"."main"."dim_payment_types"
where payment_type_name is null



  
  
      
    ) dbt_internal_test
[0m09:22:05.396948 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."dim_payment_types"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m09:22:05.398130 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.398372 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.399729 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: ROLLBACK
[0m09:22:05.401009 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: ROLLBACK
[0m09:22:05.401412 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m09:22:05.402135 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0'
[0m09:22:05.402567 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10'
[0m09:22:05.404490 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m09:22:05.405143 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: Close
[0m09:22:05.405802 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: Close
[0m09:22:05.406903 [info ] [Thread-4 (]: 34 of 91 PASS not_null_dim_payment_types_payment_type_name ..................... [[32mPASS[0m in 0.05s]
[0m09:22:05.407329 [info ] [Thread-3 (]: 33 of 91 PASS not_null_dim_payment_types_payment_type_id ....................... [[32mPASS[0m in 0.05s]
[0m09:22:05.407701 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m09:22:05.408238 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m09:22:05.408766 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m09:22:05.409346 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m09:22:05.410141 [info ] [Thread-4 (]: 36 of 91 START test not_null_dim_locations_borough ............................. [RUN]
[0m09:22:05.410716 [info ] [Thread-3 (]: 37 of 91 START test not_null_dim_locations_location_id ......................... [RUN]
[0m09:22:05.411450 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0, now test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af)
[0m09:22:05.411892 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10, now test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476)
[0m09:22:05.412317 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m09:22:05.412765 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m09:22:05.415775 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m09:22:05.418823 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m09:22:05.421068 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m09:22:05.421520 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: BEGIN
[0m09:22:05.421883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:05.422810 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.423226 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m09:22:05.423685 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."dim_payment_types"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:22:05.425083 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.425544 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m09:22:05.426116 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m09:22:05.427508 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: ROLLBACK
[0m09:22:05.429260 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m09:22:05.431298 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m09:22:05.432264 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62'
[0m09:22:05.433511 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: Close
[0m09:22:05.434276 [info ] [Thread-1 (]: 35 of 91 PASS unique_dim_payment_types_payment_type_id ......................... [[32mPASS[0m in 0.05s]
[0m09:22:05.434794 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m09:22:05.435299 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m09:22:05.435846 [info ] [Thread-1 (]: 38 of 91 START test not_null_dim_locations_zone_name ........................... [RUN]
[0m09:22:05.436469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62, now test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d)
[0m09:22:05.436864 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m09:22:05.439869 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m09:22:05.440901 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m09:22:05.441344 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: BEGIN
[0m09:22:05.441691 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m09:22:05.441998 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:05.442520 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: BEGIN
[0m09:22:05.443594 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:05.443963 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:05.444577 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.444819 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m09:22:05.445274 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m09:22:05.445741 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select borough
from "dev"."main"."dim_locations"
where borough is null



  
  
      
    ) dbt_internal_test
[0m09:22:05.446312 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "dev"."main"."dim_locations"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m09:22:05.447857 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.448292 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.449793 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: ROLLBACK
[0m09:22:05.450798 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: ROLLBACK
[0m09:22:05.451342 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476'
[0m09:22:05.452106 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af'
[0m09:22:05.452689 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: Close
[0m09:22:05.453086 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m09:22:05.453704 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: Close
[0m09:22:05.454740 [info ] [Thread-3 (]: 37 of 91 PASS not_null_dim_locations_location_id ............................... [[32mPASS[0m in 0.04s]
[0m09:22:05.456613 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m09:22:05.457450 [info ] [Thread-4 (]: 36 of 91 PASS not_null_dim_locations_borough ................................... [[32mPASS[0m in 0.05s]
[0m09:22:05.457907 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m09:22:05.458678 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m09:22:05.459060 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m09:22:05.459909 [info ] [Thread-3 (]: 39 of 91 START test unique_dim_locations_location_id ........................... [RUN]
[0m09:22:05.460686 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476, now test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d)
[0m09:22:05.461355 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m09:22:05.466078 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m09:22:05.472353 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m09:22:05.472756 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: BEGIN
[0m09:22:05.473251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:05.474393 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.474941 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m09:22:05.475537 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select zone_name
from "dev"."main"."dim_locations"
where zone_name is null



  
  
      
    ) dbt_internal_test
[0m09:22:05.475997 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m09:22:05.478426 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m09:22:05.479092 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:22:05.480917 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: ROLLBACK
[0m09:22:05.481597 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d'
[0m09:22:05.481959 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: Close
[0m09:22:05.482748 [info ] [Thread-1 (]: 38 of 91 PASS not_null_dim_locations_zone_name ................................. [[32mPASS[0m in 0.05s]
[0m09:22:05.483851 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m09:22:05.488383 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m09:22:05.488952 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: BEGIN
[0m09:22:05.489382 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:05.490153 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.490510 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m09:22:05.490812 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "dev"."main"."dim_locations"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:22:05.492043 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.493792 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: ROLLBACK
[0m09:22:05.494560 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d'
[0m09:22:05.494927 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: Close
[0m09:22:05.495683 [info ] [Thread-3 (]: 39 of 91 PASS unique_dim_locations_location_id ................................. [[32mPASS[0m in 0.03s]
[0m09:22:05.496466 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m09:22:06.459836 [debug] [Thread-2 (]: SQL status: OK in 1.901 seconds
[0m09:22:06.462450 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m09:22:06.462859 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
alter table "dev"."main"."stg_yellow_trips" rename to "stg_yellow_trips__dbt_backup"
[0m09:22:06.463586 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m09:22:06.465262 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m09:22:06.465727 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
alter table "dev"."main"."stg_yellow_trips__dbt_tmp" rename to "stg_yellow_trips"
[0m09:22:06.466507 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m09:22:06.467565 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: COMMIT
[0m09:22:06.467959 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m09:22:06.468258 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: COMMIT
[0m09:22:06.516892 [debug] [Thread-2 (]: SQL status: OK in 0.048 seconds
[0m09:22:06.518840 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m09:22:06.519268 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
drop table if exists "dev"."main"."stg_yellow_trips__dbt_backup" cascade
[0m09:22:06.523719 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m09:22:06.524853 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: Close
[0m09:22:06.584915 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71252411d160>]}
[0m09:22:06.585693 [info ] [Thread-2 (]: 2 of 91 OK created sql table model main.stg_yellow_trips ....................... [[32mOK[0m in 2.12s]
[0m09:22:06.586317 [debug] [Thread-2 (]: Finished running node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m09:22:06.587132 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m09:22:06.587393 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m09:22:06.587627 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m09:22:06.587844 [info ] [Thread-4 (]: 40 of 91 START test accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6  [RUN]
[0m09:22:06.588095 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m09:22:06.588313 [info ] [Thread-1 (]: 41 of 91 START test accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99  [RUN]
[0m09:22:06.588695 [info ] [Thread-3 (]: 42 of 91 START test accepted_values_stg_yellow_trips_vendor_id__1__2__6 ........ [RUN]
[0m09:22:06.589122 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44)
[0m09:22:06.589510 [info ] [Thread-2 (]: 43 of 91 START test assert_fare_not_exceeds_total .............................. [RUN]
[0m09:22:06.590053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098)
[0m09:22:06.590644 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27)
[0m09:22:06.591080 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m09:22:06.591546 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_yellow_trips, now test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total)
[0m09:22:06.592009 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m09:22:06.592329 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m09:22:06.596912 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m09:22:06.597359 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m09:22:06.599737 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m09:22:06.601897 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m09:22:06.604133 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m09:22:06.607465 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m09:22:06.607862 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m09:22:06.610477 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m09:22:06.612228 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m09:22:06.612523 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m09:22:06.612811 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m09:22:06.614456 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m09:22:06.615660 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m09:22:06.620062 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m09:22:06.620449 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m09:22:06.620782 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: BEGIN
[0m09:22:06.621145 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m09:22:06.621546 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: BEGIN
[0m09:22:06.622016 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:22:06.622417 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: BEGIN
[0m09:22:06.622849 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m09:22:06.623050 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:06.623680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:06.624031 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: BEGIN
[0m09:22:06.625235 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:06.642254 [debug] [Thread-2 (]: SQL status: OK in 0.020 seconds
[0m09:22:06.642580 [debug] [Thread-4 (]: SQL status: OK in 0.020 seconds
[0m09:22:06.642795 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m09:22:06.643024 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m09:22:06.643226 [debug] [Thread-3 (]: SQL status: OK in 0.018 seconds
[0m09:22:06.643616 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m09:22:06.644018 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m09:22:06.644369 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
    Singular test: fare_amount should not exceed total_amount.
*/

select
    trip_id,
    fare_amount,
    total_amount
from "dev"."main"."stg_yellow_trips"
where fare_amount > total_amount + 0.01
  and total_amount > 0
  
  
      
    ) dbt_internal_test
[0m09:22:06.644693 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m09:22:06.645025 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        payment_type_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by payment_type_id

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6'
)



  
  
      
    ) dbt_internal_test
[0m09:22:06.645470 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rate_code_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by rate_code_id

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5','6','99'
)



  
  
      
    ) dbt_internal_test
[0m09:22:06.646036 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        vendor_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by vendor_id

)

select *
from all_values
where value_field not in (
    '1','2','6'
)



  
  
      
    ) dbt_internal_test
[0m09:22:06.678894 [debug] [Thread-2 (]: SQL status: OK in 0.033 seconds
[0m09:22:06.681594 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: ROLLBACK
[0m09:22:06.683127 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total'
[0m09:22:06.683492 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: Close
[0m09:22:06.683742 [debug] [Thread-3 (]: SQL status: OK in 0.034 seconds
[0m09:22:06.683975 [debug] [Thread-4 (]: SQL status: OK in 0.037 seconds
[0m09:22:06.684362 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m09:22:06.684915 [info ] [Thread-2 (]: 43 of 91 PASS assert_fare_not_exceeds_total .................................... [[32mPASS[0m in 0.09s]
[0m09:22:06.686338 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: ROLLBACK
[0m09:22:06.687310 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: ROLLBACK
[0m09:22:06.688165 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: ROLLBACK
[0m09:22:06.688465 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m09:22:06.689076 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27'
[0m09:22:06.689628 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44'
[0m09:22:06.690126 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098'
[0m09:22:06.690676 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m09:22:06.691041 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: Close
[0m09:22:06.691377 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: Close
[0m09:22:06.691711 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: Close
[0m09:22:06.692073 [info ] [Thread-2 (]: 44 of 91 START test not_null_stg_yellow_trips_dropoff_datetime ................. [RUN]
[0m09:22:06.692653 [info ] [Thread-3 (]: 42 of 91 PASS accepted_values_stg_yellow_trips_vendor_id__1__2__6 .............. [[32mPASS[0m in 0.10s]
[0m09:22:06.693061 [info ] [Thread-4 (]: 40 of 91 PASS accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6  [[32mPASS[0m in 0.10s]
[0m09:22:06.693571 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052)
[0m09:22:06.694077 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m09:22:06.694697 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m09:22:06.695489 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m09:22:06.696178 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m09:22:06.696740 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m09:22:06.699697 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m09:22:06.700137 [info ] [Thread-1 (]: 41 of 91 PASS accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99  [[32mPASS[0m in 0.11s]
[0m09:22:06.700423 [info ] [Thread-3 (]: 45 of 91 START test not_null_stg_yellow_trips_dropoff_location_id .............. [RUN]
[0m09:22:06.700889 [info ] [Thread-4 (]: 46 of 91 START test not_null_stg_yellow_trips_fare_amount ...................... [RUN]
[0m09:22:06.701571 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m09:22:06.701895 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048)
[0m09:22:06.702234 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97)
[0m09:22:06.702635 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m09:22:06.703071 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m09:22:06.703622 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m09:22:06.704119 [info ] [Thread-1 (]: 47 of 91 START test not_null_stg_yellow_trips_pickup_datetime .................. [RUN]
[0m09:22:06.706763 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m09:22:06.708897 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m09:22:06.709472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed)
[0m09:22:06.710153 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m09:22:06.710498 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m09:22:06.711927 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m09:22:06.714331 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m09:22:06.715454 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m09:22:06.715777 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m09:22:06.718845 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m09:22:06.720273 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m09:22:06.723110 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m09:22:06.723520 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: BEGIN
[0m09:22:06.723805 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m09:22:06.724033 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m09:22:06.724216 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:22:06.724569 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: BEGIN
[0m09:22:06.726302 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m09:22:06.726725 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m09:22:06.727271 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:06.727916 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: BEGIN
[0m09:22:06.728452 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:06.733837 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m09:22:06.734196 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: BEGIN
[0m09:22:06.734557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:06.744281 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m09:22:06.744697 [debug] [Thread-2 (]: SQL status: OK in 0.020 seconds
[0m09:22:06.745004 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m09:22:06.745281 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m09:22:06.745535 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m09:22:06.746000 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m09:22:06.746332 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m09:22:06.746657 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fare_amount
from "dev"."main"."stg_yellow_trips"
where fare_amount is null



  
  
      
    ) dbt_internal_test
[0m09:22:06.747145 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m09:22:06.747505 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_datetime
from "dev"."main"."stg_yellow_trips"
where dropoff_datetime is null



  
  
      
    ) dbt_internal_test
[0m09:22:06.747894 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_location_id
from "dev"."main"."stg_yellow_trips"
where dropoff_location_id is null



  
  
      
    ) dbt_internal_test
[0m09:22:06.748646 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "dev"."main"."stg_yellow_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m09:22:06.749109 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:06.749922 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m09:22:06.751161 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: ROLLBACK
[0m09:22:06.751548 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m09:22:06.751816 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:22:06.752819 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: ROLLBACK
[0m09:22:06.753256 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97'
[0m09:22:06.753972 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: ROLLBACK
[0m09:22:06.754716 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: ROLLBACK
[0m09:22:06.755197 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052'
[0m09:22:06.755627 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: Close
[0m09:22:06.756263 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048'
[0m09:22:06.756844 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed'
[0m09:22:06.757126 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: Close
[0m09:22:06.757570 [info ] [Thread-4 (]: 46 of 91 PASS not_null_stg_yellow_trips_fare_amount ............................ [[32mPASS[0m in 0.06s]
[0m09:22:06.757780 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: Close
[0m09:22:06.758104 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: Close
[0m09:22:06.758570 [info ] [Thread-2 (]: 44 of 91 PASS not_null_stg_yellow_trips_dropoff_datetime ....................... [[32mPASS[0m in 0.07s]
[0m09:22:06.759054 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m09:22:06.759623 [info ] [Thread-3 (]: 45 of 91 PASS not_null_stg_yellow_trips_dropoff_location_id .................... [[32mPASS[0m in 0.06s]
[0m09:22:06.760316 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m09:22:06.760741 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m09:22:06.761187 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m09:22:06.761676 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m09:22:06.762040 [info ] [Thread-1 (]: 47 of 91 PASS not_null_stg_yellow_trips_pickup_datetime ........................ [[32mPASS[0m in 0.05s]
[0m09:22:06.762404 [info ] [Thread-4 (]: 48 of 91 START test not_null_stg_yellow_trips_pickup_location_id ............... [RUN]
[0m09:22:06.762777 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m09:22:06.763108 [info ] [Thread-2 (]: 49 of 91 START test not_null_stg_yellow_trips_total_amount ..................... [RUN]
[0m09:22:06.763603 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m09:22:06.764038 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1)
[0m09:22:06.764493 [info ] [Thread-3 (]: 50 of 91 START test not_null_stg_yellow_trips_trip_distance_miles .............. [RUN]
[0m09:22:06.765040 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6)
[0m09:22:06.765448 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m09:22:06.765762 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m09:22:06.766082 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7)
[0m09:22:06.766354 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m09:22:06.766710 [info ] [Thread-1 (]: 51 of 91 START test not_null_stg_yellow_trips_trip_id .......................... [RUN]
[0m09:22:06.769549 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m09:22:06.769961 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m09:22:06.772154 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m09:22:06.772568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1)
[0m09:22:06.774637 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m09:22:06.775160 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m09:22:06.777842 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m09:22:06.778794 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m09:22:06.780480 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m09:22:06.781834 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m09:22:06.782117 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m09:22:06.783670 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m09:22:06.783947 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m09:22:06.785565 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m09:22:06.788157 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m09:22:06.789308 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m09:22:06.789583 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: BEGIN
[0m09:22:06.789868 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:06.791028 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m09:22:06.791397 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m09:22:06.791733 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: BEGIN
[0m09:22:06.792116 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m09:22:06.792524 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: BEGIN
[0m09:22:06.792922 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:22:06.793415 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: BEGIN
[0m09:22:06.793883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:06.794453 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:06.810313 [debug] [Thread-4 (]: SQL status: OK in 0.020 seconds
[0m09:22:06.810661 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m09:22:06.810943 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m09:22:06.811174 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m09:22:06.811389 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m09:22:06.811883 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m09:22:06.812226 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m09:22:06.812572 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_location_id
from "dev"."main"."stg_yellow_trips"
where pickup_location_id is null



  
  
      
    ) dbt_internal_test
[0m09:22:06.812911 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m09:22:06.813205 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."stg_yellow_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m09:22:06.813538 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_distance_miles
from "dev"."main"."stg_yellow_trips"
where trip_distance_miles is null



  
  
      
    ) dbt_internal_test
[0m09:22:06.814370 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."stg_yellow_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m09:22:06.814694 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:06.815304 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m09:22:06.815668 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:06.816586 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: ROLLBACK
[0m09:22:06.816810 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:06.817611 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: ROLLBACK
[0m09:22:06.818352 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: ROLLBACK
[0m09:22:06.818950 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1'
[0m09:22:06.819710 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: ROLLBACK
[0m09:22:06.820159 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6'
[0m09:22:06.820816 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7'
[0m09:22:06.821193 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: Close
[0m09:22:06.821770 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1'
[0m09:22:06.822118 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: Close
[0m09:22:06.822476 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: Close
[0m09:22:06.823058 [info ] [Thread-4 (]: 48 of 91 PASS not_null_stg_yellow_trips_pickup_location_id ..................... [[32mPASS[0m in 0.06s]
[0m09:22:06.823320 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: Close
[0m09:22:06.823854 [info ] [Thread-2 (]: 49 of 91 PASS not_null_stg_yellow_trips_total_amount ........................... [[32mPASS[0m in 0.06s]
[0m09:22:06.824297 [info ] [Thread-3 (]: 50 of 91 PASS not_null_stg_yellow_trips_trip_distance_miles .................... [[32mPASS[0m in 0.06s]
[0m09:22:06.824741 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m09:22:06.825329 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m09:22:06.825706 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m09:22:06.826425 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m09:22:06.827142 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m09:22:06.827819 [info ] [Thread-1 (]: 51 of 91 PASS not_null_stg_yellow_trips_trip_id ................................ [[32mPASS[0m in 0.06s]
[0m09:22:06.828090 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m09:22:06.828492 [info ] [Thread-4 (]: 52 of 91 START test not_null_stg_yellow_trips_vendor_id ........................ [RUN]
[0m09:22:06.828896 [info ] [Thread-2 (]: 53 of 91 START test unique_stg_yellow_trips_trip_id ............................ [RUN]
[0m09:22:06.829317 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m09:22:06.829612 [info ] [Thread-3 (]: 54 of 91 START test relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_  [RUN]
[0m09:22:06.829981 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57)
[0m09:22:06.830317 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6, now test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965)
[0m09:22:06.830688 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m09:22:06.831108 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7, now test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a)
[0m09:22:06.831543 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m09:22:06.831993 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m09:22:06.832402 [info ] [Thread-1 (]: 55 of 91 START test relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_  [RUN]
[0m09:22:06.832775 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m09:22:06.835256 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m09:22:06.837865 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m09:22:06.838296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1, now test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f)
[0m09:22:06.842639 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m09:22:06.843706 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m09:22:06.846606 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m09:22:06.850849 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m09:22:06.851230 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m09:22:06.852851 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m09:22:06.854341 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m09:22:06.854641 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m09:22:06.856246 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m09:22:06.856527 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m09:22:06.858482 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m09:22:06.860057 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m09:22:06.860406 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m09:22:06.860724 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: BEGIN
[0m09:22:06.861361 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: BEGIN
[0m09:22:06.861806 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m09:22:06.862112 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:22:06.862755 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:06.863474 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: BEGIN
[0m09:22:06.864016 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m09:22:06.864731 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:06.865061 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: BEGIN
[0m09:22:06.865505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:06.881917 [debug] [Thread-2 (]: SQL status: OK in 0.020 seconds
[0m09:22:06.882238 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m09:22:06.882461 [debug] [Thread-4 (]: SQL status: OK in 0.020 seconds
[0m09:22:06.882667 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m09:22:06.882859 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m09:22:06.883250 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m09:22:06.883669 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m09:22:06.884012 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_yellow_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:22:06.884364 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m09:22:06.884701 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select dropoff_location_id as from_field
    from "dev"."main"."stg_yellow_trips"
    where dropoff_location_id is not null
),

parent as (
    select location_id as to_field
    from "dev"."main"."stg_taxi_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m09:22:06.885048 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "dev"."main"."stg_yellow_trips"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m09:22:06.885633 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select pickup_location_id as from_field
    from "dev"."main"."stg_yellow_trips"
    where pickup_location_id is not null
),

parent as (
    select location_id as to_field
    from "dev"."main"."stg_taxi_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m09:22:06.889667 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m09:22:06.894151 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: ROLLBACK
[0m09:22:06.895313 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57'
[0m09:22:06.895793 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: Close
[0m09:22:06.898390 [info ] [Thread-4 (]: 52 of 91 PASS not_null_stg_yellow_trips_vendor_id .............................. [[32mPASS[0m in 0.07s]
[0m09:22:06.901610 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m09:22:06.993166 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m09:22:06.994625 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: ROLLBACK
[0m09:22:06.994964 [debug] [Thread-3 (]: SQL status: OK in 0.108 seconds
[0m09:22:06.995716 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f'
[0m09:22:06.996535 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: ROLLBACK
[0m09:22:06.996732 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: Close
[0m09:22:06.997260 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a'
[0m09:22:06.998286 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: Close
[0m09:22:06.997782 [info ] [Thread-1 (]: 55 of 91 PASS relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_  [[32mPASS[0m in 0.16s]
[0m09:22:06.998897 [info ] [Thread-3 (]: 54 of 91 PASS relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_  [[32mPASS[0m in 0.17s]
[0m09:22:06.999556 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m09:22:07.000211 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m09:22:07.038019 [debug] [Thread-2 (]: SQL status: OK in 0.153 seconds
[0m09:22:07.039350 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: ROLLBACK
[0m09:22:07.040049 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965'
[0m09:22:07.040407 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: Close
[0m09:22:07.058220 [info ] [Thread-2 (]: 53 of 91 PASS unique_stg_yellow_trips_trip_id .................................. [[32mPASS[0m in 0.23s]
[0m09:22:07.058915 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m09:22:07.059775 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m09:22:07.060266 [info ] [Thread-4 (]: 56 of 91 START sql view model main.int_trip_metrics ............................ [RUN]
[0m09:22:07.060714 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57, now model.nyc_taxi_pipeline_00.int_trip_metrics)
[0m09:22:07.061046 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m09:22:07.064856 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m09:22:07.071831 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m09:22:07.126389 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m09:22:07.135375 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m09:22:07.135815 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: BEGIN
[0m09:22:07.136150 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:07.155172 [debug] [Thread-4 (]: SQL status: OK in 0.019 seconds
[0m09:22:07.155735 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m09:22:07.156229 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */

  
  create view "dev"."main"."int_trip_metrics__dbt_tmp" as (
    /*
    Intermediate model: Trip-level enrichment with calculated metrics.
    Uses adapter-dispatched macros for cross-dialect compatibility.
*/

with trips as (
    select * from "dev"."main"."stg_yellow_trips"
),

enriched as (
    select
        trip_id,
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        payment_type_id,
        pickup_datetime,
        dropoff_datetime,
        passenger_count,
        trip_distance_miles,
        store_and_fwd_flag,

        -- calculated: duration in minutes
        
    datediff('minute', pickup_datetime, dropoff_datetime)
 as trip_duration_minutes,

        -- calculated: average speed (avoid division by zero)
        case
            when 
    datediff('minute', pickup_datetime, dropoff_datetime)
 > 0
            then round(
                trip_distance_miles / (
    datediff('minute', pickup_datetime, dropoff_datetime)
 / 60.0),
                2
            )
            else null
        end as avg_speed_mph,

        -- calculated: cost per mile
        case
            when trip_distance_miles > 0
            then round(fare_amount / trip_distance_miles, 2)
            else null
        end as cost_per_mile,

        -- calculated: tip percentage
        case
            when fare_amount > 0
            then round((tip_amount / fare_amount) * 100, 2)
            else null
        end as tip_percentage,

        -- time dimensions (using adapter-dispatched macros)
        date_trunc('day', pickup_datetime)::date as pickup_date,
        extract(hour from pickup_datetime) as pickup_hour,
        
    dayname(pickup_datetime)
 as pickup_day_of_week,
        case
            when extract(dow from pickup_datetime) in (0, 6) then true
            else false
        end as is_weekend,

        -- financials passthrough
        fare_amount,
        extra_amount,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount,
        congestion_surcharge,
        airport_fee

    from trips
)

select *
from enriched
where trip_duration_minutes between 1 and 720
  and (avg_speed_mph is null or avg_speed_mph < 100)
  );

[0m09:22:07.157962 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:07.160148 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m09:22:07.160617 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
alter view "dev"."main"."int_trip_metrics" rename to "int_trip_metrics__dbt_backup"
[0m09:22:07.161248 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m09:22:07.162744 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m09:22:07.163077 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
alter view "dev"."main"."int_trip_metrics__dbt_tmp" rename to "int_trip_metrics"
[0m09:22:07.163662 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m09:22:07.164438 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: COMMIT
[0m09:22:07.164750 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m09:22:07.165040 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: COMMIT
[0m09:22:07.170175 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m09:22:07.171890 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m09:22:07.172307 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
drop view if exists "dev"."main"."int_trip_metrics__dbt_backup" cascade
[0m09:22:07.175927 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m09:22:07.176999 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: Close
[0m09:22:07.212552 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71253560f230>]}
[0m09:22:07.213382 [info ] [Thread-4 (]: 56 of 91 OK created sql view model main.int_trip_metrics ....................... [[32mOK[0m in 0.15s]
[0m09:22:07.213979 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m09:22:07.214995 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m09:22:07.215202 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m09:22:07.215429 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m09:22:07.215671 [info ] [Thread-3 (]: 57 of 91 START test assert_trip_duration_positive .............................. [RUN]
[0m09:22:07.215872 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m09:22:07.216285 [info ] [Thread-2 (]: 58 of 91 START test dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0  [RUN]
[0m09:22:07.216749 [info ] [Thread-1 (]: 59 of 91 START test dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1  [RUN]
[0m09:22:07.217437 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a, now test.nyc_taxi_pipeline_00.assert_trip_duration_positive)
[0m09:22:07.218034 [info ] [Thread-4 (]: 60 of 91 START test not_null_int_trip_metrics_is_weekend ....................... [RUN]
[0m09:22:07.218625 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574)
[0m09:22:07.219014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718)
[0m09:22:07.219400 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m09:22:07.219806 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_trip_metrics, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed)
[0m09:22:07.220287 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m09:22:07.220616 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m09:22:07.222676 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m09:22:07.223077 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m09:22:07.227384 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m09:22:07.229908 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m09:22:07.232411 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m09:22:07.235879 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m09:22:07.238552 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m09:22:07.238875 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m09:22:07.240385 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m09:22:07.241066 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m09:22:07.242558 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m09:22:07.242821 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m09:22:07.244429 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m09:22:07.246660 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m09:22:07.247154 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: BEGIN
[0m09:22:07.247499 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:07.247800 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m09:22:07.248231 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m09:22:07.248498 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: BEGIN
[0m09:22:07.248862 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: BEGIN
[0m09:22:07.249334 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m09:22:07.249584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:07.249978 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:07.250376 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: BEGIN
[0m09:22:07.251063 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:22:07.266998 [debug] [Thread-3 (]: SQL status: OK in 0.019 seconds
[0m09:22:07.267493 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m09:22:07.267787 [debug] [Thread-4 (]: SQL status: OK in 0.018 seconds
[0m09:22:07.268080 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m09:22:07.268319 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m09:22:07.268771 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m09:22:07.269211 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m09:22:07.269634 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
    Singular test: No trip should have negative duration.
*/

select
    trip_id,
    pickup_datetime,
    dropoff_datetime,
    trip_duration_minutes
from "dev"."main"."int_trip_metrics"
where trip_duration_minutes < 0
  
  
      
    ) dbt_internal_test
[0m09:22:07.270032 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m09:22:07.270409 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_trip_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not trip_duration_minutes >= 1
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not trip_duration_minutes <= 720
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m09:22:07.270712 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."int_trip_metrics"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m09:22:07.271285 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_trip_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m09:22:07.272090 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:07.273705 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: ROLLBACK
[0m09:22:07.274032 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:07.276289 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.assert_trip_duration_positive'
[0m09:22:07.278054 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: ROLLBACK
[0m09:22:07.279222 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: Close
[0m09:22:07.281193 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed'
[0m09:22:07.283077 [info ] [Thread-3 (]: 57 of 91 PASS assert_trip_duration_positive .................................... [[32mPASS[0m in 0.07s]
[0m09:22:07.284763 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: Close
[0m09:22:07.286549 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m09:22:07.288774 [info ] [Thread-4 (]: 60 of 91 PASS not_null_int_trip_metrics_is_weekend ............................. [[32mPASS[0m in 0.07s]
[0m09:22:07.289531 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m09:22:07.292217 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m09:22:07.294477 [info ] [Thread-3 (]: 61 of 91 START test not_null_int_trip_metrics_pickup_date ...................... [RUN]
[0m09:22:07.296564 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m09:22:07.297944 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.assert_trip_duration_positive, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3)
[0m09:22:07.300513 [info ] [Thread-4 (]: 62 of 91 START test not_null_int_trip_metrics_pickup_hour ...................... [RUN]
[0m09:22:07.303002 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m09:22:07.304704 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082)
[0m09:22:07.309519 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m09:22:07.311523 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m09:22:07.318289 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m09:22:07.324440 [debug] [Thread-2 (]: SQL status: OK in 0.052 seconds
[0m09:22:07.326329 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: ROLLBACK
[0m09:22:07.327111 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574'
[0m09:22:07.327403 [debug] [Thread-1 (]: SQL status: OK in 0.056 seconds
[0m09:22:07.327635 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: Close
[0m09:22:07.329504 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: ROLLBACK
[0m09:22:07.329974 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m09:22:07.330506 [info ] [Thread-2 (]: 58 of 91 PASS dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0 ..... [[32mPASS[0m in 0.11s]
[0m09:22:07.331241 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718'
[0m09:22:07.332813 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m09:22:07.333031 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m09:22:07.333515 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m09:22:07.333885 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: Close
[0m09:22:07.335763 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m09:22:07.336237 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m09:22:07.337137 [info ] [Thread-2 (]: 63 of 91 START test not_null_int_trip_metrics_trip_duration_minutes ............ [RUN]
[0m09:22:07.337509 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c)
[0m09:22:07.337855 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m09:22:07.340377 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m09:22:07.340937 [info ] [Thread-1 (]: 59 of 91 PASS dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1  [[32mPASS[0m in 0.12s]
[0m09:22:07.342054 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m09:22:07.342562 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m09:22:07.342931 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m09:22:07.343513 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: BEGIN
[0m09:22:07.344153 [info ] [Thread-1 (]: 64 of 91 START test not_null_int_trip_metrics_trip_id .......................... [RUN]
[0m09:22:07.344587 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:07.344945 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m09:22:07.345232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f)
[0m09:22:07.345795 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: BEGIN
[0m09:22:07.346122 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m09:22:07.346440 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:07.350874 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m09:22:07.352274 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m09:22:07.353799 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m09:22:07.355470 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m09:22:07.357789 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m09:22:07.362596 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m09:22:07.363155 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: BEGIN
[0m09:22:07.363529 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m09:22:07.363892 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:22:07.364279 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: BEGIN
[0m09:22:07.365084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:07.365382 [debug] [Thread-3 (]: SQL status: OK in 0.021 seconds
[0m09:22:07.365625 [debug] [Thread-4 (]: SQL status: OK in 0.019 seconds
[0m09:22:07.365848 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m09:22:07.366273 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:07.366499 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m09:22:07.366864 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m09:22:07.367201 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m09:22:07.367645 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m09:22:07.368066 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_trip_metrics"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m09:22:07.368511 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."int_trip_metrics"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m09:22:07.368943 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_duration_minutes
from "dev"."main"."int_trip_metrics"
where trip_duration_minutes is null



  
  
      
    ) dbt_internal_test
[0m09:22:07.369350 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."int_trip_metrics"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m09:22:07.371371 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:07.371809 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m09:22:07.372861 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: ROLLBACK
[0m09:22:07.373157 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:22:07.376708 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: ROLLBACK
[0m09:22:07.377837 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082'
[0m09:22:07.379665 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: ROLLBACK
[0m09:22:07.381261 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3'
[0m09:22:07.383462 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: Close
[0m09:22:07.385917 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f'
[0m09:22:07.387719 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: Close
[0m09:22:07.388892 [info ] [Thread-4 (]: 62 of 91 PASS not_null_int_trip_metrics_pickup_hour ............................ [[32mPASS[0m in 0.08s]
[0m09:22:07.391222 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: Close
[0m09:22:07.392867 [info ] [Thread-3 (]: 61 of 91 PASS not_null_int_trip_metrics_pickup_date ............................ [[32mPASS[0m in 0.10s]
[0m09:22:07.395062 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m09:22:07.396935 [info ] [Thread-1 (]: 64 of 91 PASS not_null_int_trip_metrics_trip_id ................................ [[32mPASS[0m in 0.05s]
[0m09:22:07.398855 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m09:22:07.402101 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m09:22:07.423987 [debug] [Thread-2 (]: SQL status: OK in 0.054 seconds
[0m09:22:07.425321 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: ROLLBACK
[0m09:22:07.425919 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c'
[0m09:22:07.426219 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: Close
[0m09:22:07.431249 [info ] [Thread-2 (]: 63 of 91 PASS not_null_int_trip_metrics_trip_duration_minutes .................. [[32mPASS[0m in 0.09s]
[0m09:22:07.431836 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m09:22:07.432550 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.int_daily_summary
[0m09:22:07.432862 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m09:22:07.433138 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.fct_trips
[0m09:22:07.433511 [info ] [Thread-4 (]: 65 of 91 START sql view model main.int_daily_summary ........................... [RUN]
[0m09:22:07.434011 [info ] [Thread-3 (]: 66 of 91 START sql view model main.int_hourly_patterns ......................... [RUN]
[0m09:22:07.434500 [info ] [Thread-1 (]: 67 of 91 START sql incremental model main.fct_trips ............................ [RUN]
[0m09:22:07.434965 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082, now model.nyc_taxi_pipeline_00.int_daily_summary)
[0m09:22:07.435350 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3, now model.nyc_taxi_pipeline_00.int_hourly_patterns)
[0m09:22:07.435713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f, now model.nyc_taxi_pipeline_00.fct_trips)
[0m09:22:07.436027 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.int_daily_summary
[0m09:22:07.436403 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m09:22:07.436850 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.fct_trips
[0m09:22:07.439073 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m09:22:07.440670 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m09:22:07.444479 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.fct_trips"
[0m09:22:07.448913 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.int_daily_summary
[0m09:22:07.449345 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m09:22:07.451756 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m09:22:07.454150 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m09:22:07.455381 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.fct_trips
[0m09:22:07.473187 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m09:22:07.473784 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
DESCRIBE (select * from (
        /*
    Fact table: Fully enriched trip records with location names.
    Incremental with delete+insert strategy.
*/



with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

pickup_locations as (
    select * from "dev"."main"."dim_locations"
),

dropoff_locations as (
    select * from "dev"."main"."dim_locations"
),

final as (
    select
        t.trip_id,
        t.vendor_id,
        t.rate_code_id,
        t.payment_type_id,
        t.pickup_location_id,
        t.dropoff_location_id,
        t.pickup_datetime,
        t.dropoff_datetime,
        t.pickup_date,
        t.pickup_hour,
        t.pickup_day_of_week,
        t.is_weekend,
        t.passenger_count,
        t.trip_distance_miles,
        t.trip_duration_minutes,
        t.avg_speed_mph,
        t.cost_per_mile,
        t.fare_amount,
        t.extra_amount,
        t.mta_tax,
        t.tip_amount,
        t.tip_percentage,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.congestion_surcharge,
        t.airport_fee,

        -- enriched from dimensions
        pu.borough as pickup_borough,
        pu.zone_name as pickup_zone,
        do_loc.borough as dropoff_borough,
        do_loc.zone_name as dropoff_zone

    from trip_metrics t
    left join pickup_locations pu
        on t.pickup_location_id = pu.location_id
    left join dropoff_locations do_loc
        on t.dropoff_location_id = do_loc.location_id

    
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m09:22:07.474269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:07.474527 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m09:22:07.474994 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: BEGIN
[0m09:22:07.475292 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:07.475527 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m09:22:07.475919 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: BEGIN
[0m09:22:07.476243 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:07.490541 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m09:22:07.490842 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m09:22:07.491063 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m09:22:07.491388 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m09:22:07.491612 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m09:22:07.491940 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */

  
  create view "dev"."main"."int_hourly_patterns__dbt_tmp" as (
    /*
    Intermediate model: Hourly trip patterns by date.
    One row per date + hour combination.
*/

with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

hourly_agg as (
    select
        pickup_date,
        pickup_hour,
        pickup_day_of_week,
        is_weekend,

        count(*) as total_trips,
        round(avg(trip_distance_miles), 2) as avg_distance,
        round(avg(trip_duration_minutes), 2) as avg_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue

    from trip_metrics
    group by pickup_date, pickup_hour, pickup_day_of_week, is_weekend
)

select * from hourly_agg
  );

[0m09:22:07.493675 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m09:22:07.493911 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */

  
  create view "dev"."main"."int_daily_summary__dbt_tmp" as (
    /*
    Intermediate model: Daily aggregated trip and revenue metrics.
    One row per day with counts, averages, and revenue totals.
*/

with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

daily_agg as (
    select
        pickup_date,
        pickup_day_of_week,
        is_weekend,

        count(*) as total_trips,
        sum(passenger_count) as total_passengers,

        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(avg(avg_speed_mph), 2) as avg_speed_mph,

        round(sum(fare_amount), 2) as total_fare_revenue,
        round(sum(tip_amount), 2) as total_tip_revenue,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_trip_revenue,
        round(avg(tip_percentage), 2) as avg_tip_percentage,

        count(case when payment_type_id = 1 then 1 end) as credit_card_trips,
        count(case when payment_type_id = 2 then 1 end) as cash_trips

    from trip_metrics
    group by pickup_date, pickup_day_of_week, is_weekend
)

select * from daily_agg
  );

[0m09:22:07.494577 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as varchar)
 as trip_id, 
      
    cast(null as integer)
 as vendor_id, 
      
    cast(null as integer)
 as rate_code_id, 
      
    cast(null as integer)
 as payment_type_id, 
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as integer)
 as dropoff_location_id, 
      
    cast(null as timestamp)
 as pickup_datetime, 
      
    cast(null as timestamp)
 as dropoff_datetime, 
      
    cast(null as date)
 as pickup_date, 
      
    cast(null as bigint)
 as pickup_hour, 
      
    cast(null as varchar)
 as pickup_day_of_week, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as integer)
 as passenger_count, 
      
    cast(null as double)
 as trip_distance_miles, 
      
    cast(null as bigint)
 as trip_duration_minutes, 
      
    cast(null as double)
 as avg_speed_mph, 
      
    cast(null as double)
 as cost_per_mile, 
      
    cast(null as decimal(10,2))
 as fare_amount, 
      
    cast(null as decimal(10,2))
 as extra_amount, 
      
    cast(null as decimal(10,2))
 as mta_tax, 
      
    cast(null as decimal(10,2))
 as tip_amount, 
      
    cast(null as double)
 as tip_percentage, 
      
    cast(null as decimal(10,2))
 as tolls_amount, 
      
    cast(null as decimal(10,2))
 as improvement_surcharge, 
      
    cast(null as decimal(10,2))
 as total_amount, 
      
    cast(null as decimal(10,2))
 as congestion_surcharge, 
      
    cast(null as decimal(10,2))
 as airport_fee, 
      
    cast(null as varchar)
 as pickup_borough, 
      
    cast(null as varchar)
 as pickup_zone, 
      
    cast(null as varchar)
 as dropoff_borough, 
      
    cast(null as varchar)
 as dropoff_zone
    ) as __dbt_sbq
    where false
    limit 0
)
[0m09:22:07.495272 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:07.497499 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m09:22:07.497753 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:22:07.497948 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m09:22:07.498140 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
alter view "dev"."main"."int_hourly_patterns" rename to "int_hourly_patterns__dbt_backup"
[0m09:22:07.500607 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.fct_trips"
[0m09:22:07.502218 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m09:22:07.503003 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m09:22:07.503189 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
alter view "dev"."main"."int_daily_summary" rename to "int_daily_summary__dbt_backup"
[0m09:22:07.504765 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m09:22:07.505389 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
alter view "dev"."main"."int_hourly_patterns__dbt_tmp" rename to "int_hourly_patterns"
[0m09:22:07.505655 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:07.507158 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m09:22:07.507342 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:07.507556 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
alter view "dev"."main"."int_daily_summary__dbt_tmp" rename to "int_daily_summary"
[0m09:22:07.508486 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: COMMIT
[0m09:22:07.509250 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m09:22:07.509652 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:07.509998 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: COMMIT
[0m09:22:07.510322 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m09:22:07.511060 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: COMMIT
[0m09:22:07.511634 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.fct_trips: BEGIN
[0m09:22:07.511977 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m09:22:07.512494 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:22:07.512692 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: COMMIT
[0m09:22:07.513038 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m09:22:07.513563 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */

  
    
    
      
    

    create  table
      "dev"."main"."fct_trips__dbt_tmp"
  
  (
    trip_id varchar,
    vendor_id integer,
    rate_code_id integer,
    payment_type_id integer,
    pickup_location_id integer,
    dropoff_location_id integer,
    pickup_datetime timestamp,
    dropoff_datetime timestamp,
    pickup_date date,
    pickup_hour bigint,
    pickup_day_of_week varchar,
    is_weekend boolean,
    passenger_count integer,
    trip_distance_miles double,
    trip_duration_minutes bigint,
    avg_speed_mph double,
    cost_per_mile double,
    fare_amount decimal(10,2),
    extra_amount decimal(10,2),
    mta_tax decimal(10,2),
    tip_amount decimal(10,2),
    tip_percentage double,
    tolls_amount decimal(10,2),
    improvement_surcharge decimal(10,2),
    total_amount decimal(10,2),
    congestion_surcharge decimal(10,2),
    airport_fee decimal(10,2),
    pickup_borough varchar,
    pickup_zone varchar,
    dropoff_borough varchar,
    dropoff_zone varchar
    
    )
 ;
    insert into "dev"."main"."fct_trips__dbt_tmp" 
  (
    
      
      trip_id ,
    
      
      vendor_id ,
    
      
      rate_code_id ,
    
      
      payment_type_id ,
    
      
      pickup_location_id ,
    
      
      dropoff_location_id ,
    
      
      pickup_datetime ,
    
      
      dropoff_datetime ,
    
      
      pickup_date ,
    
      
      pickup_hour ,
    
      
      pickup_day_of_week ,
    
      
      is_weekend ,
    
      
      passenger_count ,
    
      
      trip_distance_miles ,
    
      
      trip_duration_minutes ,
    
      
      avg_speed_mph ,
    
      
      cost_per_mile ,
    
      
      fare_amount ,
    
      
      extra_amount ,
    
      
      mta_tax ,
    
      
      tip_amount ,
    
      
      tip_percentage ,
    
      
      tolls_amount ,
    
      
      improvement_surcharge ,
    
      
      total_amount ,
    
      
      congestion_surcharge ,
    
      
      airport_fee ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      dropoff_borough ,
    
      
      dropoff_zone 
    
  )
 (
      
    select trip_id, vendor_id, rate_code_id, payment_type_id, pickup_location_id, dropoff_location_id, pickup_datetime, dropoff_datetime, pickup_date, pickup_hour, pickup_day_of_week, is_weekend, passenger_count, trip_distance_miles, trip_duration_minutes, avg_speed_mph, cost_per_mile, fare_amount, extra_amount, mta_tax, tip_amount, tip_percentage, tolls_amount, improvement_surcharge, total_amount, congestion_surcharge, airport_fee, pickup_borough, pickup_zone, dropoff_borough, dropoff_zone
    from (
        /*
    Fact table: Fully enriched trip records with location names.
    Incremental with delete+insert strategy.
*/



with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

pickup_locations as (
    select * from "dev"."main"."dim_locations"
),

dropoff_locations as (
    select * from "dev"."main"."dim_locations"
),

final as (
    select
        t.trip_id,
        t.vendor_id,
        t.rate_code_id,
        t.payment_type_id,
        t.pickup_location_id,
        t.dropoff_location_id,
        t.pickup_datetime,
        t.dropoff_datetime,
        t.pickup_date,
        t.pickup_hour,
        t.pickup_day_of_week,
        t.is_weekend,
        t.passenger_count,
        t.trip_distance_miles,
        t.trip_duration_minutes,
        t.avg_speed_mph,
        t.cost_per_mile,
        t.fare_amount,
        t.extra_amount,
        t.mta_tax,
        t.tip_amount,
        t.tip_percentage,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.congestion_surcharge,
        t.airport_fee,

        -- enriched from dimensions
        pu.borough as pickup_borough,
        pu.zone_name as pickup_zone,
        do_loc.borough as dropoff_borough,
        do_loc.zone_name as dropoff_zone

    from trip_metrics t
    left join pickup_locations pu
        on t.pickup_location_id = pu.location_id
    left join dropoff_locations do_loc
        on t.dropoff_location_id = do_loc.location_id

    
)

select * from final
    ) as model_subq
    );
  
  
  
[0m09:22:07.516817 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m09:22:07.518289 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m09:22:07.518598 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
drop view if exists "dev"."main"."int_hourly_patterns__dbt_backup" cascade
[0m09:22:07.518982 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m09:22:07.520695 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m09:22:07.523322 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
drop view if exists "dev"."main"."int_daily_summary__dbt_backup" cascade
[0m09:22:07.523891 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m09:22:07.527017 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: Close
[0m09:22:07.529357 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125348eaea0>]}
[0m09:22:07.530417 [info ] [Thread-3 (]: 66 of 91 OK created sql view model main.int_hourly_patterns .................... [[32mOK[0m in 0.09s]
[0m09:22:07.532991 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m09:22:07.533311 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m09:22:07.535093 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m09:22:07.535364 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m09:22:07.537337 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: Close
[0m09:22:07.539068 [info ] [Thread-2 (]: 68 of 91 START test dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0  [RUN]
[0m09:22:07.541277 [info ] [Thread-3 (]: 69 of 91 START test not_null_int_hourly_patterns_pickup_date ................... [RUN]
[0m09:22:07.543632 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71253712b8f0>]}
[0m09:22:07.544655 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe)
[0m09:22:07.548131 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_hourly_patterns, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2)
[0m09:22:07.550488 [info ] [Thread-4 (]: 65 of 91 OK created sql view model main.int_daily_summary ...................... [[32mOK[0m in 0.11s]
[0m09:22:07.552449 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m09:22:07.553379 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m09:22:07.556002 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.int_daily_summary
[0m09:22:07.560709 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m09:22:07.565843 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m09:22:07.567598 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m09:22:07.573478 [info ] [Thread-4 (]: 70 of 91 START test not_null_int_hourly_patterns_pickup_hour ................... [RUN]
[0m09:22:07.575506 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_daily_summary, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d)
[0m09:22:07.577998 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m09:22:07.582693 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m09:22:07.604395 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m09:22:07.607808 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m09:22:07.610620 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m09:22:07.614224 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m09:22:07.614834 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m09:22:07.620510 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m09:22:07.633374 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m09:22:07.634420 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: BEGIN
[0m09:22:07.634847 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m09:22:07.635500 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:07.636209 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: BEGIN
[0m09:22:07.637113 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:07.637568 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:22:07.638229 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m09:22:07.638568 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m09:22:07.639424 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m09:22:07.640241 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: BEGIN
[0m09:22:07.641084 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."int_hourly_patterns"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m09:22:07.641932 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m09:22:07.642547 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:07.643860 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_hourly_patterns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m09:22:07.644865 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m09:22:07.645875 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:07.647386 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m09:22:07.651512 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: ROLLBACK
[0m09:22:07.654055 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d'
[0m09:22:07.654609 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: Close
[0m09:22:07.652087 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_hourly_patterns"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m09:22:07.655665 [info ] [Thread-4 (]: 70 of 91 PASS not_null_int_hourly_patterns_pickup_hour ......................... [[32mPASS[0m in 0.08s]
[0m09:22:07.656997 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m09:22:07.658223 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m09:22:07.660283 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m09:22:07.663871 [info ] [Thread-4 (]: 71 of 91 START test not_null_int_hourly_patterns_total_trips ................... [RUN]
[0m09:22:07.663128 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: ROLLBACK
[0m09:22:07.665054 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf)
[0m09:22:07.674590 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m09:22:07.672331 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2'
[0m09:22:07.679769 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m09:22:07.681061 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: Close
[0m09:22:07.683719 [info ] [Thread-3 (]: 69 of 91 PASS not_null_int_hourly_patterns_pickup_date ......................... [[32mPASS[0m in 0.14s]
[0m09:22:07.686090 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m09:22:07.688417 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m09:22:07.690163 [info ] [Thread-3 (]: 72 of 91 START test dbt_utils_accepted_range_int_daily_summary_total_trips__0 .. [RUN]
[0m09:22:07.691082 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863)
[0m09:22:07.692620 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m09:22:07.699926 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m09:22:07.725295 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m09:22:07.729386 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m09:22:07.737813 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m09:22:07.744068 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m09:22:07.774479 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m09:22:07.778501 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: BEGIN
[0m09:22:07.780492 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:07.787019 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m09:22:07.789592 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m09:22:07.790259 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_trips
from "dev"."main"."int_hourly_patterns"
where total_trips is null



  
  
      
    ) dbt_internal_test
[0m09:22:07.790707 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m09:22:07.791530 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: BEGIN
[0m09:22:07.792566 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:07.793340 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:07.793909 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m09:22:07.794426 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_daily_summary"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_trips >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m09:22:07.980248 [debug] [Thread-2 (]: SQL status: OK in 0.335 seconds
[0m09:22:07.983284 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: ROLLBACK
[0m09:22:07.984973 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe'
[0m09:22:07.987523 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: Close
[0m09:22:07.989422 [info ] [Thread-2 (]: 68 of 91 PASS dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0 .. [[32mPASS[0m in 0.44s]
[0m09:22:07.991910 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m09:22:07.993111 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m09:22:07.996149 [info ] [Thread-2 (]: 73 of 91 START test not_null_int_daily_summary_pickup_date ..................... [RUN]
[0m09:22:08.003211 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686)
[0m09:22:08.005672 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m09:22:08.014204 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m09:22:08.028055 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m09:22:08.031965 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m09:22:08.041861 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m09:22:08.042758 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: BEGIN
[0m09:22:08.043211 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:22:08.044117 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m09:22:08.044660 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m09:22:08.045131 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_daily_summary"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m09:22:08.047514 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m09:22:08.049282 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: ROLLBACK
[0m09:22:08.050112 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686'
[0m09:22:08.050521 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: Close
[0m09:22:08.051200 [info ] [Thread-2 (]: 73 of 91 PASS not_null_int_daily_summary_pickup_date ........................... [[32mPASS[0m in 0.05s]
[0m09:22:08.051753 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m09:22:08.052173 [debug] [Thread-3 (]: SQL status: OK in 0.257 seconds
[0m09:22:08.052496 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m09:22:08.054010 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: ROLLBACK
[0m09:22:08.054323 [info ] [Thread-2 (]: 74 of 91 START test not_null_int_daily_summary_total_revenue ................... [RUN]
[0m09:22:08.055102 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863'
[0m09:22:08.055556 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50)
[0m09:22:08.055951 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: Close
[0m09:22:08.056533 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m09:22:08.057406 [info ] [Thread-3 (]: 72 of 91 PASS dbt_utils_accepted_range_int_daily_summary_total_trips__0 ........ [[32mPASS[0m in 0.37s]
[0m09:22:08.060787 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m09:22:08.061730 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m09:22:08.062590 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m09:22:08.063032 [info ] [Thread-3 (]: 75 of 91 START test not_null_int_daily_summary_total_trips ..................... [RUN]
[0m09:22:08.063507 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10)
[0m09:22:08.063905 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m09:22:08.066922 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m09:22:08.072043 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m09:22:08.074067 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m09:22:08.074397 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m09:22:08.076319 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m09:22:08.081656 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m09:22:08.082406 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: BEGIN
[0m09:22:08.082874 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:22:08.083589 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m09:22:08.084153 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m09:22:08.084562 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m09:22:08.084876 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "dev"."main"."int_daily_summary"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m09:22:08.085399 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: BEGIN
[0m09:22:08.086199 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:08.087061 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:08.087485 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m09:22:08.088223 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_trips
from "dev"."main"."int_daily_summary"
where total_trips is null



  
  
      
    ) dbt_internal_test
[0m09:22:08.126405 [debug] [Thread-4 (]: SQL status: OK in 0.335 seconds
[0m09:22:08.127846 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: ROLLBACK
[0m09:22:08.129008 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf'
[0m09:22:08.129727 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: Close
[0m09:22:08.130516 [info ] [Thread-4 (]: 71 of 91 PASS not_null_int_hourly_patterns_total_trips ......................... [[32mPASS[0m in 0.47s]
[0m09:22:08.131159 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m09:22:08.131615 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m09:22:08.132061 [info ] [Thread-4 (]: 76 of 91 START test unique_int_daily_summary_pickup_date ....................... [RUN]
[0m09:22:08.132660 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf, now test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e)
[0m09:22:08.133105 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m09:22:08.137334 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m09:22:08.149806 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m09:22:08.152127 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m09:22:08.163753 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m09:22:08.164446 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: BEGIN
[0m09:22:08.164912 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:08.165870 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:08.166215 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m09:22:08.166544 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pickup_date as unique_field,
    count(*) as n_records

from "dev"."main"."int_daily_summary"
where pickup_date is not null
group by pickup_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:22:08.273600 [debug] [Thread-2 (]: SQL status: OK in 0.188 seconds
[0m09:22:08.275051 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: ROLLBACK
[0m09:22:08.275803 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50'
[0m09:22:08.276236 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: Close
[0m09:22:08.276796 [info ] [Thread-2 (]: 74 of 91 PASS not_null_int_daily_summary_total_revenue ......................... [[32mPASS[0m in 0.22s]
[0m09:22:08.277365 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m09:22:08.277935 [debug] [Thread-2 (]: Began running node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m09:22:08.278402 [info ] [Thread-2 (]: 77 of 91 START sql table model main.mart_hourly_demand ......................... [RUN]
[0m09:22:08.278827 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50, now model.nyc_taxi_pipeline_00.mart_hourly_demand)
[0m09:22:08.279182 [debug] [Thread-2 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m09:22:08.281226 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m09:22:08.290403 [debug] [Thread-2 (]: Began executing node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m09:22:08.294193 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m09:22:08.294806 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Hourly demand patterns.
*/

with hourly as (
    select * from "dev"."main"."int_hourly_patterns"
),

final as (
    select
        pickup_hour,
        is_weekend,

        count(*) as days_observed,
        round(avg(total_trips), 0) as avg_trips_per_period,
        round(avg(avg_distance), 2) as avg_distance,
        round(avg(avg_duration_min), 2) as avg_duration_min,
        round(avg(total_revenue), 2) as avg_revenue_per_period,
        sum(total_trips) as total_trips_all_days

    from hourly
    group by pickup_hour, is_weekend
)

select * from final
order by is_weekend, pickup_hour
    ) as __dbt_sbq
    where false
    limit 0
)
[0m09:22:08.295401 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:22:08.297813 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m09:22:08.299856 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m09:22:08.300376 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as bigint)
 as pickup_hour, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as bigint)
 as days_observed, 
      
    cast(null as double)
 as avg_trips_per_period, 
      
    cast(null as double)
 as avg_distance, 
      
    cast(null as double)
 as avg_duration_min, 
      
    cast(null as double)
 as avg_revenue_per_period, 
      
    cast(null as hugeint)
 as total_trips_all_days
    ) as __dbt_sbq
    where false
    limit 0
)
[0m09:22:08.301309 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m09:22:08.303738 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m09:22:08.311989 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m09:22:08.312533 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: BEGIN
[0m09:22:08.313203 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m09:22:08.313648 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m09:22:08.314067 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_hourly_demand__dbt_tmp"
  
  (
    pickup_hour bigint,
    is_weekend boolean,
    days_observed bigint,
    avg_trips_per_period double,
    avg_distance double,
    avg_duration_min double,
    avg_revenue_per_period double,
    total_trips_all_days hugeint
    
    )
 ;
    insert into "dev"."main"."mart_hourly_demand__dbt_tmp" 
  (
    
      
      pickup_hour ,
    
      
      is_weekend ,
    
      
      days_observed ,
    
      
      avg_trips_per_period ,
    
      
      avg_distance ,
    
      
      avg_duration_min ,
    
      
      avg_revenue_per_period ,
    
      
      total_trips_all_days 
    
  )
 (
      
    select pickup_hour, is_weekend, days_observed, avg_trips_per_period, avg_distance, avg_duration_min, avg_revenue_per_period, total_trips_all_days
    from (
        /*
    Analytics mart: Hourly demand patterns.
*/

with hourly as (
    select * from "dev"."main"."int_hourly_patterns"
),

final as (
    select
        pickup_hour,
        is_weekend,

        count(*) as days_observed,
        round(avg(total_trips), 0) as avg_trips_per_period,
        round(avg(avg_distance), 2) as avg_distance,
        round(avg(avg_duration_min), 2) as avg_duration_min,
        round(avg(total_revenue), 2) as avg_revenue_per_period,
        sum(total_trips) as total_trips_all_days

    from hourly
    group by pickup_hour, is_weekend
)

select * from final
order by is_weekend, pickup_hour
    ) as model_subq
    );
  
  
[0m09:22:08.337320 [debug] [Thread-3 (]: SQL status: OK in 0.249 seconds
[0m09:22:08.339127 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: ROLLBACK
[0m09:22:08.340071 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10'
[0m09:22:08.340720 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: Close
[0m09:22:08.341486 [info ] [Thread-3 (]: 75 of 91 PASS not_null_int_daily_summary_total_trips ........................... [[32mPASS[0m in 0.28s]
[0m09:22:08.342217 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m09:22:08.367009 [debug] [Thread-4 (]: SQL status: OK in 0.200 seconds
[0m09:22:08.368522 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: ROLLBACK
[0m09:22:08.369528 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e'
[0m09:22:08.369974 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: Close
[0m09:22:08.370683 [info ] [Thread-4 (]: 76 of 91 PASS unique_int_daily_summary_pickup_date ............................. [[32mPASS[0m in 0.24s]
[0m09:22:08.371230 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m09:22:08.371968 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m09:22:08.372485 [info ] [Thread-3 (]: 78 of 91 START sql table model main.mart_daily_revenue ......................... [RUN]
[0m09:22:08.373002 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10, now model.nyc_taxi_pipeline_00.mart_daily_revenue)
[0m09:22:08.373451 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m09:22:08.375962 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m09:22:08.384623 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m09:22:08.387198 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m09:22:08.387714 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Daily revenue metrics with running totals.
*/

with daily as (
    select * from "dev"."main"."int_daily_summary"
),

dates as (
    select * from "dev"."main"."dim_dates"
),

final as (
    select
        d.date_key,
        d.day_of_week_name,
        d.is_weekend,
        d.is_holiday,
        d.week_of_year,

        daily.total_trips,
        daily.total_passengers,
        daily.total_fare_revenue,
        daily.total_tip_revenue,
        daily.total_revenue,
        daily.avg_trip_revenue,
        daily.avg_tip_percentage,
        daily.credit_card_trips,
        daily.cash_trips,
        daily.avg_trip_distance,
        daily.avg_trip_duration_min,

        -- running total
        sum(daily.total_revenue) over (order by d.date_key) as cumulative_revenue,

        -- day-over-day change
        daily.total_revenue - lag(daily.total_revenue) over (order by d.date_key) as revenue_change_vs_prior_day

    from daily
    inner join dates d
        on daily.pickup_date = d.date_key
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m09:22:08.388225 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:08.390487 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m09:22:08.393239 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m09:22:08.393789 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as date_key, 
      
    cast(null as varchar)
 as day_of_week_name, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as boolean)
 as is_holiday, 
      
    cast(null as bigint)
 as week_of_year, 
      
    cast(null as bigint)
 as total_trips, 
      
    cast(null as hugeint)
 as total_passengers, 
      
    cast(null as decimal(38,2))
 as total_fare_revenue, 
      
    cast(null as decimal(38,2))
 as total_tip_revenue, 
      
    cast(null as decimal(38,2))
 as total_revenue, 
      
    cast(null as double)
 as avg_trip_revenue, 
      
    cast(null as double)
 as avg_tip_percentage, 
      
    cast(null as bigint)
 as credit_card_trips, 
      
    cast(null as bigint)
 as cash_trips, 
      
    cast(null as double)
 as avg_trip_distance, 
      
    cast(null as double)
 as avg_trip_duration_min, 
      
    cast(null as decimal(38,2))
 as cumulative_revenue, 
      
    cast(null as decimal(38,2))
 as revenue_change_vs_prior_day
    ) as __dbt_sbq
    where false
    limit 0
)
[0m09:22:08.394946 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:08.397507 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m09:22:08.406684 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m09:22:08.407053 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: BEGIN
[0m09:22:08.407529 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m09:22:08.407811 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m09:22:08.408060 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_daily_revenue__dbt_tmp"
  
  (
    date_key date,
    day_of_week_name varchar,
    is_weekend boolean,
    is_holiday boolean,
    week_of_year bigint,
    total_trips bigint,
    total_passengers hugeint,
    total_fare_revenue decimal(38,2),
    total_tip_revenue decimal(38,2),
    total_revenue decimal(38,2),
    avg_trip_revenue double,
    avg_tip_percentage double,
    credit_card_trips bigint,
    cash_trips bigint,
    avg_trip_distance double,
    avg_trip_duration_min double,
    cumulative_revenue decimal(38,2),
    revenue_change_vs_prior_day decimal(38,2)
    
    )
 ;
    insert into "dev"."main"."mart_daily_revenue__dbt_tmp" 
  (
    
      
      date_key ,
    
      
      day_of_week_name ,
    
      
      is_weekend ,
    
      
      is_holiday ,
    
      
      week_of_year ,
    
      
      total_trips ,
    
      
      total_passengers ,
    
      
      total_fare_revenue ,
    
      
      total_tip_revenue ,
    
      
      total_revenue ,
    
      
      avg_trip_revenue ,
    
      
      avg_tip_percentage ,
    
      
      credit_card_trips ,
    
      
      cash_trips ,
    
      
      avg_trip_distance ,
    
      
      avg_trip_duration_min ,
    
      
      cumulative_revenue ,
    
      
      revenue_change_vs_prior_day 
    
  )
 (
      
    select date_key, day_of_week_name, is_weekend, is_holiday, week_of_year, total_trips, total_passengers, total_fare_revenue, total_tip_revenue, total_revenue, avg_trip_revenue, avg_tip_percentage, credit_card_trips, cash_trips, avg_trip_distance, avg_trip_duration_min, cumulative_revenue, revenue_change_vs_prior_day
    from (
        /*
    Analytics mart: Daily revenue metrics with running totals.
*/

with daily as (
    select * from "dev"."main"."int_daily_summary"
),

dates as (
    select * from "dev"."main"."dim_dates"
),

final as (
    select
        d.date_key,
        d.day_of_week_name,
        d.is_weekend,
        d.is_holiday,
        d.week_of_year,

        daily.total_trips,
        daily.total_passengers,
        daily.total_fare_revenue,
        daily.total_tip_revenue,
        daily.total_revenue,
        daily.avg_trip_revenue,
        daily.avg_tip_percentage,
        daily.credit_card_trips,
        daily.cash_trips,
        daily.avg_trip_distance,
        daily.avg_trip_duration_min,

        -- running total
        sum(daily.total_revenue) over (order by d.date_key) as cumulative_revenue,

        -- day-over-day change
        daily.total_revenue - lag(daily.total_revenue) over (order by d.date_key) as revenue_change_vs_prior_day

    from daily
    inner join dates d
        on daily.pickup_date = d.date_key
)

select * from final
    ) as model_subq
    );
  
  
[0m09:22:08.467423 [debug] [Thread-2 (]: SQL status: OK in 0.153 seconds
[0m09:22:08.469832 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m09:22:08.470283 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
alter table "dev"."main"."mart_hourly_demand" rename to "mart_hourly_demand__dbt_backup"
[0m09:22:08.470969 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m09:22:08.472773 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m09:22:08.473111 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
alter table "dev"."main"."mart_hourly_demand__dbt_tmp" rename to "mart_hourly_demand"
[0m09:22:08.473646 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m09:22:08.474648 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: COMMIT
[0m09:22:08.475093 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m09:22:08.475486 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: COMMIT
[0m09:22:08.479571 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m09:22:08.481955 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m09:22:08.482396 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
drop table if exists "dev"."main"."mart_hourly_demand__dbt_backup" cascade
[0m09:22:08.486058 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m09:22:08.487190 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: Close
[0m09:22:08.487750 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125341be3f0>]}
[0m09:22:08.488277 [info ] [Thread-2 (]: 77 of 91 OK created sql table model main.mart_hourly_demand .................... [[32mOK[0m in 0.21s]
[0m09:22:08.488745 [debug] [Thread-2 (]: Finished running node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m09:22:08.489433 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m09:22:08.489681 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m09:22:08.489955 [info ] [Thread-4 (]: 79 of 91 START test not_null_mart_hourly_demand_is_weekend ..................... [RUN]
[0m09:22:08.490467 [info ] [Thread-2 (]: 80 of 91 START test not_null_mart_hourly_demand_pickup_hour .................... [RUN]
[0m09:22:08.491065 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e, now test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8)
[0m09:22:08.491642 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.mart_hourly_demand, now test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418)
[0m09:22:08.492109 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m09:22:08.492573 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m09:22:08.497636 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m09:22:08.501084 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m09:22:08.506501 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m09:22:08.508627 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m09:22:08.509020 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m09:22:08.511096 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m09:22:08.516116 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m09:22:08.516826 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: BEGIN
[0m09:22:08.517259 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m09:22:08.517686 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:22:08.518200 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: BEGIN
[0m09:22:08.519002 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m09:22:08.519298 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:08.519761 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m09:22:08.520460 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:08.520764 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."mart_hourly_demand"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m09:22:08.521325 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m09:22:08.522146 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."mart_hourly_demand"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m09:22:08.522665 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m09:22:08.524749 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: ROLLBACK
[0m09:22:08.525252 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:08.526049 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418'
[0m09:22:08.527468 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: ROLLBACK
[0m09:22:08.527872 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: Close
[0m09:22:08.528754 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8'
[0m09:22:08.529517 [info ] [Thread-2 (]: 80 of 91 PASS not_null_mart_hourly_demand_pickup_hour .......................... [[32mPASS[0m in 0.04s]
[0m09:22:08.529876 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: Close
[0m09:22:08.530510 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m09:22:08.531167 [info ] [Thread-4 (]: 79 of 91 PASS not_null_mart_hourly_demand_is_weekend ........................... [[32mPASS[0m in 0.04s]
[0m09:22:08.532144 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m09:22:08.588218 [debug] [Thread-3 (]: SQL status: OK in 0.180 seconds
[0m09:22:08.590579 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m09:22:08.590938 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
alter table "dev"."main"."mart_daily_revenue" rename to "mart_daily_revenue__dbt_backup"
[0m09:22:08.591709 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m09:22:08.593885 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m09:22:08.594268 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
alter table "dev"."main"."mart_daily_revenue__dbt_tmp" rename to "mart_daily_revenue"
[0m09:22:08.594950 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m09:22:08.595996 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: COMMIT
[0m09:22:08.596430 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m09:22:08.596694 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: COMMIT
[0m09:22:08.599952 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m09:22:08.601439 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m09:22:08.601962 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
drop table if exists "dev"."main"."mart_daily_revenue__dbt_backup" cascade
[0m09:22:08.604626 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m09:22:08.606087 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: Close
[0m09:22:08.606706 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712537134260>]}
[0m09:22:08.607338 [info ] [Thread-3 (]: 78 of 91 OK created sql table model main.mart_daily_revenue .................... [[32mOK[0m in 0.23s]
[0m09:22:08.607932 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m09:22:08.608651 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m09:22:08.609135 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m09:22:08.609444 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m09:22:08.609769 [info ] [Thread-2 (]: 81 of 91 START test not_null_mart_daily_revenue_date_key ....................... [RUN]
[0m09:22:08.610262 [info ] [Thread-4 (]: 82 of 91 START test not_null_mart_daily_revenue_total_revenue .................. [RUN]
[0m09:22:08.610767 [info ] [Thread-3 (]: 83 of 91 START test unique_mart_daily_revenue_date_key ......................... [RUN]
[0m09:22:08.611335 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418, now test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a)
[0m09:22:08.611848 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8, now test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9)
[0m09:22:08.612373 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.mart_daily_revenue, now test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7)
[0m09:22:08.612829 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m09:22:08.613218 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m09:22:08.613572 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m09:22:08.616549 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m09:22:08.619503 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m09:22:08.622910 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m09:22:08.627656 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m09:22:08.631220 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m09:22:08.631639 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m09:22:08.631890 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m09:22:08.633690 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m09:22:08.636358 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m09:22:08.641136 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m09:22:08.641492 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m09:22:08.641772 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: BEGIN
[0m09:22:08.642493 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: BEGIN
[0m09:22:08.643037 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:08.643651 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m09:22:08.644106 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:08.644900 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: BEGIN
[0m09:22:08.645173 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m09:22:08.645740 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:08.645934 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:22:08.646293 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m09:22:08.646653 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m09:22:08.647933 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "dev"."main"."mart_daily_revenue"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:22:08.648459 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m09:22:08.648830 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "dev"."main"."mart_daily_revenue"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m09:22:08.649706 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m09:22:08.650348 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "dev"."main"."mart_daily_revenue"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m09:22:08.650624 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:08.651034 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:08.651399 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m09:22:08.652486 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: ROLLBACK
[0m09:22:08.654165 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: ROLLBACK
[0m09:22:08.655172 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: ROLLBACK
[0m09:22:08.655761 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7'
[0m09:22:08.656265 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9'
[0m09:22:08.657026 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a'
[0m09:22:08.657494 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: Close
[0m09:22:08.657908 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: Close
[0m09:22:08.658356 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: Close
[0m09:22:08.658988 [info ] [Thread-3 (]: 83 of 91 PASS unique_mart_daily_revenue_date_key ............................... [[32mPASS[0m in 0.05s]
[0m09:22:08.659404 [info ] [Thread-4 (]: 82 of 91 PASS not_null_mart_daily_revenue_total_revenue ........................ [[32mPASS[0m in 0.05s]
[0m09:22:08.659815 [info ] [Thread-2 (]: 81 of 91 PASS not_null_mart_daily_revenue_date_key ............................. [[32mPASS[0m in 0.05s]
[0m09:22:08.660198 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m09:22:08.660744 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m09:22:08.661305 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m09:22:12.090093 [debug] [Thread-1 (]: SQL status: OK in 4.576 seconds
[0m09:22:12.096617 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m09:22:12.097153 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
alter table "dev"."main"."fct_trips" rename to "fct_trips__dbt_backup"
[0m09:22:12.098376 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:12.100572 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m09:22:12.101034 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
alter table "dev"."main"."fct_trips__dbt_tmp" rename to "fct_trips"
[0m09:22:12.101798 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:22:12.103144 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.fct_trips: COMMIT
[0m09:22:12.103602 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m09:22:12.104027 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.fct_trips: COMMIT
[0m09:22:12.500918 [debug] [Thread-1 (]: SQL status: OK in 0.396 seconds
[0m09:22:12.502790 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m09:22:12.503220 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
drop table if exists "dev"."main"."fct_trips__dbt_backup" cascade
[0m09:22:12.792061 [debug] [Thread-1 (]: SQL status: OK in 0.288 seconds
[0m09:22:12.793708 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.fct_trips: Close
[0m09:22:12.857497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712537134ec0>]}
[0m09:22:12.858858 [info ] [Thread-1 (]: 67 of 91 OK created sql incremental model main.fct_trips ....................... [[32mOK[0m in 5.42s]
[0m09:22:12.859778 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.fct_trips
[0m09:22:12.861790 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m09:22:12.862303 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m09:22:12.862612 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m09:22:12.862857 [info ] [Thread-3 (]: 84 of 91 START test not_null_fct_trips_pickup_datetime ......................... [RUN]
[0m09:22:12.863095 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m09:22:12.863501 [info ] [Thread-4 (]: 85 of 91 START test not_null_fct_trips_total_amount ............................ [RUN]
[0m09:22:12.864042 [info ] [Thread-2 (]: 86 of 91 START test not_null_fct_trips_trip_id ................................. [RUN]
[0m09:22:12.864642 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7, now test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83)
[0m09:22:12.865001 [info ] [Thread-1 (]: 87 of 91 START test unique_fct_trips_trip_id ................................... [RUN]
[0m09:22:12.865513 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9, now test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d)
[0m09:22:12.866086 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a, now test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d)
[0m09:22:12.866661 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m09:22:12.867218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.fct_trips, now test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab)
[0m09:22:12.867711 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m09:22:12.868101 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m09:22:12.871512 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m09:22:12.872109 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m09:22:12.875191 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m09:22:12.877703 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m09:22:12.881164 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m09:22:12.885673 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m09:22:12.887497 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m09:22:12.887882 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m09:22:12.890392 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m09:22:12.890712 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m09:22:12.890985 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m09:22:12.892635 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m09:22:12.894381 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m09:22:12.896064 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m09:22:12.896390 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m09:22:12.896620 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: BEGIN
[0m09:22:12.896937 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: BEGIN
[0m09:22:12.897481 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:12.898176 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:12.898714 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m09:22:12.899859 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: BEGIN
[0m09:22:12.900201 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m09:22:12.900504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:12.900982 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: BEGIN
[0m09:22:12.901734 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:22:12.919066 [debug] [Thread-3 (]: SQL status: OK in 0.022 seconds
[0m09:22:12.919460 [debug] [Thread-4 (]: SQL status: OK in 0.021 seconds
[0m09:22:12.919803 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m09:22:12.920061 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m09:22:12.920299 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m09:22:12.920695 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m09:22:12.921059 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m09:22:12.921442 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m09:22:12.921787 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "dev"."main"."fct_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m09:22:12.922122 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."fct_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m09:22:12.922468 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."main"."fct_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:22:12.922841 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."fct_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m09:22:12.924093 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:12.924336 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:12.924609 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m09:22:12.928433 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: ROLLBACK
[0m09:22:12.929480 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: ROLLBACK
[0m09:22:12.931292 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: ROLLBACK
[0m09:22:12.932708 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83'
[0m09:22:12.933973 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d'
[0m09:22:12.936233 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d'
[0m09:22:12.938192 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: Close
[0m09:22:12.940132 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: Close
[0m09:22:12.942096 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: Close
[0m09:22:12.944201 [info ] [Thread-3 (]: 84 of 91 PASS not_null_fct_trips_pickup_datetime ............................... [[32mPASS[0m in 0.08s]
[0m09:22:12.947780 [info ] [Thread-4 (]: 85 of 91 PASS not_null_fct_trips_total_amount .................................. [[32mPASS[0m in 0.08s]
[0m09:22:12.948614 [info ] [Thread-2 (]: 86 of 91 PASS not_null_fct_trips_trip_id ....................................... [[32mPASS[0m in 0.08s]
[0m09:22:12.951141 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m09:22:12.953921 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m09:22:12.955913 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m09:22:13.055708 [debug] [Thread-1 (]: SQL status: OK in 0.132 seconds
[0m09:22:13.057462 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: ROLLBACK
[0m09:22:13.058484 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab'
[0m09:22:13.059022 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: Close
[0m09:22:13.084267 [info ] [Thread-1 (]: 87 of 91 PASS unique_fct_trips_trip_id ......................................... [[32mPASS[0m in 0.22s]
[0m09:22:13.084948 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m09:22:13.086291 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.mart_location_performance
[0m09:22:13.086901 [info ] [Thread-3 (]: 88 of 91 START sql table model main.mart_location_performance .................. [RUN]
[0m09:22:13.087486 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83, now model.nyc_taxi_pipeline_00.mart_location_performance)
[0m09:22:13.087866 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_location_performance
[0m09:22:13.090441 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m09:22:13.098328 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.mart_location_performance
[0m09:22:13.101024 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m09:22:13.101780 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Location-level performance summary.
    Uses adapter-dispatched mode_compat() for cross-dialect support.
*/

with trips as (
    select * from "dev"."main"."fct_trips"
),

final as (
    select
        pickup_location_id,
        pickup_borough,
        pickup_zone,

        count(*) as total_pickups,
        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue_per_trip,
        round(avg(tip_percentage), 2) as avg_tip_pct,
        round(avg(passenger_count), 2) as avg_passengers,

        -- most common dropoff destination
        
    mode(dropoff_zone)
 as most_common_dropoff_zone,

        -- busiest hour
        
    mode(pickup_hour)
 as peak_pickup_hour

    from trips
    where pickup_zone is not null
    group by pickup_location_id, pickup_borough, pickup_zone
)

select * from final
order by total_pickups desc
    ) as __dbt_sbq
    where false
    limit 0
)
[0m09:22:13.102217 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:13.120069 [debug] [Thread-3 (]: SQL status: OK in 0.018 seconds
[0m09:22:13.122098 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m09:22:13.122651 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as varchar)
 as pickup_borough, 
      
    cast(null as varchar)
 as pickup_zone, 
      
    cast(null as bigint)
 as total_pickups, 
      
    cast(null as double)
 as avg_trip_distance, 
      
    cast(null as double)
 as avg_trip_duration_min, 
      
    cast(null as decimal(38,2))
 as total_revenue, 
      
    cast(null as double)
 as avg_revenue_per_trip, 
      
    cast(null as double)
 as avg_tip_pct, 
      
    cast(null as double)
 as avg_passengers, 
      
    cast(null as varchar)
 as most_common_dropoff_zone, 
      
    cast(null as bigint)
 as peak_pickup_hour
    ) as __dbt_sbq
    where false
    limit 0
)
[0m09:22:13.123560 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m09:22:13.125036 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m09:22:13.132513 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m09:22:13.132926 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: BEGIN
[0m09:22:13.133576 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m09:22:13.134009 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m09:22:13.134497 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_location_performance__dbt_tmp"
  
  (
    pickup_location_id integer,
    pickup_borough varchar,
    pickup_zone varchar,
    total_pickups bigint,
    avg_trip_distance double,
    avg_trip_duration_min double,
    total_revenue decimal(38,2),
    avg_revenue_per_trip double,
    avg_tip_pct double,
    avg_passengers double,
    most_common_dropoff_zone varchar,
    peak_pickup_hour bigint
    
    )
 ;
    insert into "dev"."main"."mart_location_performance__dbt_tmp" 
  (
    
      
      pickup_location_id ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      total_pickups ,
    
      
      avg_trip_distance ,
    
      
      avg_trip_duration_min ,
    
      
      total_revenue ,
    
      
      avg_revenue_per_trip ,
    
      
      avg_tip_pct ,
    
      
      avg_passengers ,
    
      
      most_common_dropoff_zone ,
    
      
      peak_pickup_hour 
    
  )
 (
      
    select pickup_location_id, pickup_borough, pickup_zone, total_pickups, avg_trip_distance, avg_trip_duration_min, total_revenue, avg_revenue_per_trip, avg_tip_pct, avg_passengers, most_common_dropoff_zone, peak_pickup_hour
    from (
        /*
    Analytics mart: Location-level performance summary.
    Uses adapter-dispatched mode_compat() for cross-dialect support.
*/

with trips as (
    select * from "dev"."main"."fct_trips"
),

final as (
    select
        pickup_location_id,
        pickup_borough,
        pickup_zone,

        count(*) as total_pickups,
        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue_per_trip,
        round(avg(tip_percentage), 2) as avg_tip_pct,
        round(avg(passenger_count), 2) as avg_passengers,

        -- most common dropoff destination
        
    mode(dropoff_zone)
 as most_common_dropoff_zone,

        -- busiest hour
        
    mode(pickup_hour)
 as peak_pickup_hour

    from trips
    where pickup_zone is not null
    group by pickup_location_id, pickup_borough, pickup_zone
)

select * from final
order by total_pickups desc
    ) as model_subq
    );
  
  
[0m09:22:13.240983 [debug] [Thread-3 (]: SQL status: OK in 0.106 seconds
[0m09:22:13.243583 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m09:22:13.243950 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
alter table "dev"."main"."mart_location_performance" rename to "mart_location_performance__dbt_backup"
[0m09:22:13.244637 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m09:22:13.246332 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m09:22:13.247786 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
alter table "dev"."main"."mart_location_performance__dbt_tmp" rename to "mart_location_performance"
[0m09:22:13.248393 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m09:22:13.249221 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: COMMIT
[0m09:22:13.249632 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m09:22:13.250038 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: COMMIT
[0m09:22:13.255668 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m09:22:13.257428 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m09:22:13.257746 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
drop table if exists "dev"."main"."mart_location_performance__dbt_backup" cascade
[0m09:22:13.260915 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m09:22:13.261867 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: Close
[0m09:22:13.308535 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71253486d5b0>]}
[0m09:22:13.309247 [info ] [Thread-3 (]: 88 of 91 OK created sql table model main.mart_location_performance ............. [[32mOK[0m in 0.22s]
[0m09:22:13.309779 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.mart_location_performance
[0m09:22:13.311396 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m09:22:13.311753 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m09:22:13.312072 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m09:22:13.312454 [info ] [Thread-2 (]: 89 of 91 START test not_null_mart_location_performance_pickup_location_id ...... [RUN]
[0m09:22:13.312982 [info ] [Thread-1 (]: 90 of 91 START test not_null_mart_location_performance_total_pickups ........... [RUN]
[0m09:22:13.313464 [info ] [Thread-4 (]: 91 of 91 START test unique_mart_location_performance_pickup_location_id ........ [RUN]
[0m09:22:13.313891 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d, now test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c)
[0m09:22:13.314275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab, now test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259)
[0m09:22:13.314617 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d, now test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62)
[0m09:22:13.314963 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m09:22:13.315269 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m09:22:13.315668 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m09:22:13.318212 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m09:22:13.320344 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m09:22:13.322487 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m09:22:13.327981 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m09:22:13.329881 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m09:22:13.330564 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m09:22:13.331890 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m09:22:13.332110 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m09:22:13.333482 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m09:22:13.336782 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m09:22:13.337161 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m09:22:13.337440 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: BEGIN
[0m09:22:13.337802 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: BEGIN
[0m09:22:13.338166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:13.338524 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:13.338893 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m09:22:13.339656 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: BEGIN
[0m09:22:13.340084 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:22:13.359629 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m09:22:13.360042 [debug] [Thread-4 (]: SQL status: OK in 0.021 seconds
[0m09:22:13.360360 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m09:22:13.360677 [debug] [Thread-2 (]: SQL status: OK in 0.021 seconds
[0m09:22:13.360977 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m09:22:13.361458 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_pickups
from "dev"."main"."mart_location_performance"
where total_pickups is null



  
  
      
    ) dbt_internal_test
[0m09:22:13.361931 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m09:22:13.362461 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pickup_location_id as unique_field,
    count(*) as n_records

from "dev"."main"."mart_location_performance"
where pickup_location_id is not null
group by pickup_location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:22:13.363391 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_location_id
from "dev"."main"."mart_location_performance"
where pickup_location_id is null



  
  
      
    ) dbt_internal_test
[0m09:22:13.363809 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:13.365550 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: ROLLBACK
[0m09:22:13.365878 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m09:22:13.366271 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:13.366827 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259'
[0m09:22:13.367946 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: ROLLBACK
[0m09:22:13.368930 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: ROLLBACK
[0m09:22:13.369222 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: Close
[0m09:22:13.370039 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c'
[0m09:22:13.370540 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62'
[0m09:22:13.371215 [info ] [Thread-1 (]: 90 of 91 PASS not_null_mart_location_performance_total_pickups ................. [[32mPASS[0m in 0.06s]
[0m09:22:13.371473 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: Close
[0m09:22:13.371863 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: Close
[0m09:22:13.372409 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m09:22:13.373008 [info ] [Thread-2 (]: 89 of 91 PASS not_null_mart_location_performance_pickup_location_id ............ [[32mPASS[0m in 0.06s]
[0m09:22:13.373787 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m09:22:13.376012 [info ] [Thread-4 (]: 91 of 91 PASS unique_mart_location_performance_pickup_location_id .............. [[32mPASS[0m in 0.06s]
[0m09:22:13.376689 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m09:22:13.378478 [debug] [MainThread]: Using duckdb connection "master"
[0m09:22:13.378815 [debug] [MainThread]: On master: BEGIN
[0m09:22:13.379209 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:22:13.399869 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m09:22:13.400464 [debug] [MainThread]: On master: COMMIT
[0m09:22:13.400858 [debug] [MainThread]: Using duckdb connection "master"
[0m09:22:13.401201 [debug] [MainThread]: On master: COMMIT
[0m09:22:13.402005 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:22:13.402456 [debug] [MainThread]: On master: Close
[0m09:22:13.407180 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:22:13.407811 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m09:22:13.408225 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259' was properly closed.
[0m09:22:13.408614 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c' was properly closed.
[0m09:22:13.408976 [debug] [MainThread]: Connection 'model.nyc_taxi_pipeline_00.mart_location_performance' was properly closed.
[0m09:22:13.409304 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62' was properly closed.
[0m09:22:13.409815 [info ] [MainThread]: 
[0m09:22:13.410183 [info ] [MainThread]: Finished running 1 incremental model, 3 seeds, 7 table models, 74 data tests, 6 view models in 0 hours 0 minutes and 9.19 seconds (9.19s).
[0m09:22:13.417016 [debug] [MainThread]: Command end result
[0m09:22:13.461672 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m09:22:13.467384 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m09:22:13.478538 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m09:22:13.478965 [info ] [MainThread]: 
[0m09:22:13.479381 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:22:13.479724 [info ] [MainThread]: 
[0m09:22:13.480101 [info ] [MainThread]: Done. PASS=91 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=91
[0m09:22:13.481245 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 10.662166, "process_in_blocks": "86840", "process_kernel_time": 7.670602, "process_mem_max_rss": "1738816", "process_out_blocks": "136", "process_user_time": 20.987982}
[0m09:22:13.481745 [debug] [MainThread]: Command `dbt build` succeeded at 09:22:13.481656 after 10.66 seconds
[0m09:22:13.482288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125a7d60800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125241239e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712596f15cd0>]}
[0m09:22:13.482698 [debug] [MainThread]: Flushing usage events
[0m09:22:13.732730 [debug] [MainThread]: An error was encountered while trying to flush usage events
