[0m00:26:11.779080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7a03bf5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7a0350b080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7a03bf6690>]}


============================== 00:26:11.781552 | c03916ea-a359-4dec-836f-ea2a34a1ee10 ==============================
[0m00:26:11.781552 [info ] [MainThread]: Running with dbt=1.11.4
[0m00:26:11.782125 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'empty': 'False', 'log_path': '/dbt/logs', 'log_cache_events': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'printer_width': '80', 'write_json': 'True', 'fail_fast': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'target_path': 'None', 'use_colors': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '.', 'indirect_selection': 'eager', 'introspect': 'True', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --full-refresh --profiles-dir .'}
[0m00:26:11.909366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c03916ea-a359-4dec-836f-ea2a34a1ee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7a03bf7e00>]}
[0m00:26:11.946743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c03916ea-a359-4dec-836f-ea2a34a1ee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7a038bad80>]}
[0m00:26:11.948060 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m00:26:11.978171 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m00:26:11.979015 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.24627177, "process_in_blocks": "0", "process_kernel_time": 0.164112, "process_mem_max_rss": "134884", "process_out_blocks": "24", "process_user_time": 0.976256}
[0m00:26:11.979468 [debug] [MainThread]: Command `dbt build` failed at 00:26:11.979391 after 0.25 seconds
[0m00:26:11.979861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7a03d5b980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7a0433f350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7a03bb7590>]}
[0m00:26:11.980460 [debug] [MainThread]: Flushing usage events
[0m00:26:12.275554 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:40:38.266455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa1c5c3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa1be3c320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa1b954b00>]}


============================== 00:40:38.270065 | c60b60dd-566e-4b61-a679-4061319386af ==============================
[0m00:40:38.270065 [info ] [MainThread]: Running with dbt=1.11.4
[0m00:40:38.270715 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'profiles_dir': '.', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'invocation_command': 'dbt deps --profiles-dir .', 'printer_width': '80', 'no_print': 'None', 'fail_fast': 'False', 'warn_error': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'version_check': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'partial_parse': 'True', 'empty': 'None', 'log_path': '/dbt/logs'}
[0m00:40:38.397622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c60b60dd-566e-4b61-a679-4061319386af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa1b5713a0>]}
[0m00:40:38.409617 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-f0ehra19'
[0m00:40:38.410280 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:40:38.695437 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:40:38.696845 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:40:38.793896 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:40:38.805602 [info ] [MainThread]: Updating lock file in file path: /dbt/package-lock.yml
[0m00:40:38.818920 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-md0af697'
[0m00:40:38.821099 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:40:42.590773 [info ] [MainThread]: Installed from version 1.3.3
[0m00:40:42.591380 [info ] [MainThread]: Up to date!
[0m00:40:42.591915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c60b60dd-566e-4b61-a679-4061319386af', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa1c44b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa1c1926c0>]}
[0m00:40:42.593038 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.3832073, "process_in_blocks": "0", "process_kernel_time": 0.439572, "process_mem_max_rss": "106228", "process_out_blocks": "176", "process_user_time": 1.305661}
[0m00:40:42.593590 [debug] [MainThread]: Command `dbt deps` succeeded at 00:40:42.593484 after 4.38 seconds
[0m00:40:42.594035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa1be64680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa1c2c5dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa1bd03f80>]}
[0m00:40:42.594702 [debug] [MainThread]: Flushing usage events
[0m00:40:42.883026 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:40:44.340674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfa468dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf8910dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfa469610>]}


============================== 00:40:44.345262 | ca3b38d1-1db4-4625-91e9-c25da509abd6 ==============================
[0m00:40:44.345262 [info ] [MainThread]: Running with dbt=1.11.4
[0m00:40:44.345885 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'log_format': 'default', 'use_colors': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'introspect': 'True', 'invocation_command': 'dbt build --full-refresh --profiles-dir .', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'log_path': '/dbt/logs', 'target_path': 'None', 'write_json': 'True'}
[0m00:40:44.566725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfa0441a0>]}
[0m00:40:44.618866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf81772c0>]}
[0m00:40:44.620729 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m00:40:44.686988 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m00:40:44.692891 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:40:44.693744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbe8437f50>]}
[0m00:40:46.953346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba1e5aea0>]}
[0m00:40:47.063357 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m00:40:47.068779 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m00:40:47.105666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba1d0afc0>]}
[0m00:40:47.106264 [info ] [MainThread]: Found 14 models, 74 data tests, 3 seeds, 1 source, 578 macros
[0m00:40:47.111587 [info ] [MainThread]: 
[0m00:40:47.112201 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:40:47.112627 [info ] [MainThread]: 
[0m00:40:47.113259 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:40:47.117052 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m00:40:47.144789 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m00:40:47.145525 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m00:40:47.146079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:40:47.162546 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m00:40:47.164279 [debug] [ThreadPool]: On list_dev: Close
[0m00:40:47.168076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m00:40:47.168796 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m00:40:47.174360 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m00:40:47.174964 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m00:40:47.175434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:40:47.189431 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m00:40:47.190976 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m00:40:47.191558 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m00:40:47.192131 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:40:47.192460 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m00:40:47.192908 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m00:40:47.193543 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:40:47.194276 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m00:40:47.194684 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m00:40:47.195073 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m00:40:47.195625 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:40:47.195979 [debug] [ThreadPool]: On create_dev_main: Close
[0m00:40:47.200050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m00:40:47.204071 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m00:40:47.204645 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m00:40:47.205102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:40:47.218695 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m00:40:47.219312 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m00:40:47.219646 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m00:40:47.227549 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m00:40:47.228762 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m00:40:47.229636 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m00:40:47.230076 [debug] [ThreadPool]: On list_dev_main: Close
[0m00:40:47.233488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba1e542c0>]}
[0m00:40:47.234142 [debug] [MainThread]: Using duckdb connection "master"
[0m00:40:47.234473 [debug] [MainThread]: On master: BEGIN
[0m00:40:47.234753 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:40:47.247292 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m00:40:47.247846 [debug] [MainThread]: On master: COMMIT
[0m00:40:47.248211 [debug] [MainThread]: Using duckdb connection "master"
[0m00:40:47.248827 [debug] [MainThread]: On master: COMMIT
[0m00:40:47.249434 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:40:47.249792 [debug] [MainThread]: On master: Close
[0m00:40:47.256090 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.dim_dates
[0m00:40:47.256562 [debug] [Thread-2 (]: Began running node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m00:40:47.256871 [debug] [Thread-3 (]: Began running node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m00:40:47.257356 [info ] [Thread-1 (]: 1 of 91 START sql table model main.dim_dates ................................... [RUN]
[0m00:40:47.257740 [debug] [Thread-4 (]: Began running node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m00:40:47.258118 [info ] [Thread-2 (]: 2 of 91 START sql table model main.stg_yellow_trips ............................ [RUN]
[0m00:40:47.258707 [info ] [Thread-3 (]: 3 of 91 START seed file main.payment_type_lookup ............................... [RUN]
[0m00:40:47.259620 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nyc_taxi_pipeline_00.dim_dates'
[0m00:40:47.260176 [info ] [Thread-4 (]: 4 of 91 START seed file main.rate_code_lookup .................................. [RUN]
[0m00:40:47.260868 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.nyc_taxi_pipeline_00.stg_yellow_trips'
[0m00:40:47.261337 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.nyc_taxi_pipeline_00.payment_type_lookup'
[0m00:40:47.261742 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_dates
[0m00:40:47.262218 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.nyc_taxi_pipeline_00.rate_code_lookup'
[0m00:40:47.262601 [debug] [Thread-2 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m00:40:47.262946 [debug] [Thread-3 (]: Began compiling node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m00:40:47.271376 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m00:40:47.271745 [debug] [Thread-4 (]: Began compiling node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m00:40:47.275959 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m00:40:47.276652 [debug] [Thread-3 (]: Began executing node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m00:40:47.277155 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: BEGIN
[0m00:40:47.277570 [debug] [Thread-4 (]: Began executing node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m00:40:47.286730 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:40:47.300075 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m00:40:47.301247 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m00:40:47.301724 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: BEGIN
[0m00:40:47.302336 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: BEGIN
[0m00:40:47.302994 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:40:47.303429 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:40:47.305602 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m00:40:47.306018 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m00:40:47.306481 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m00:40:47.306883 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m00:40:47.307334 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m00:40:47.307876 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */


        select 
        (date_diff('day', cast('2024-01-01' as date)::timestamp, cast('2024-02-01' as date)::timestamp ))
    
[0m00:40:47.308455 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m00:40:47.308884 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.payment_type_lookup"} */

    create table "dev"."main"."payment_type_lookup" ("payment_type_id" integer,"payment_type_name" varchar)
  
[0m00:40:47.309662 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.rate_code_lookup"} */

    create table "dev"."main"."rate_code_lookup" ("rate_code_id" integer,"rate_code_name" varchar)
  
[0m00:40:47.310307 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.310846 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.311270 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.312765 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_dates"
[0m00:40:47.318384 [debug] [Thread-2 (]: Began executing node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m00:40:47.321200 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m00:40:47.322124 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m00:40:47.340755 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m00:40:47.341099 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: 
          COPY "dev"."main"."payment_type_lookup" FROM '/dbt/seeds/payment_type_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m00:40:47.341544 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: 
          COPY "dev"."main"."rate_code_lookup" FROM '/dbt/seeds/rate_code_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m00:40:47.352669 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.dim_dates
[0m00:40:47.353053 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m00:40:47.353356 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m00:40:47.367945 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m00:40:47.371526 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m00:40:47.372465 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m00:40:47.373260 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
DESCRIBE (select * from (
        /*
    Dimension table: Calendar dates for January 2024.
    Uses adapter-dispatched macros for dayname/monthname.
*/

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 31
    order by generated_number



),

all_periods as (

    select (
        

    date_add(cast('2024-01-01' as date), interval (row_number() over (order by generated_number) - 1) day)


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-02-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week_num,
        
    dayname(date_day)
 as day_of_week_name,
        
    monthname(date_day)
 as month_name,
        extract(week from date_day) as week_of_year,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when cast(date_day as date) in (
                cast('2024-01-01' as date),
                cast('2024-01-15' as date)
            ) then true
            else false
        end as is_holiday

    from date_spine
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:40:47.373815 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m00:40:47.376613 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: BEGIN
[0m00:40:47.377075 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:40:47.377864 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.378235 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m00:40:47.378836 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:40:47.379178 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */

  
    
    

    create  table
      "dev"."main"."stg_yellow_trips__dbt_tmp"
  
    as (
      

with source as (
    select * from read_parquet('/data/yellow_tripdata_2024-01.parquet')
),

renamed as (
    select
        -- surrogate key (MD5 hash of composite key)
        md5(cast(coalesce(cast(VendorID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(PULocationID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DOLocationID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(fare_amount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(total_amount as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- identifiers
        cast("VendorID" as integer) as vendor_id,
        cast("RatecodeID" as integer) as rate_code_id,
        cast("PULocationID" as integer) as pickup_location_id,
        cast("DOLocationID" as integer) as dropoff_location_id,
        cast(payment_type as integer) as payment_type_id,

        -- timestamps
        cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
        cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as double) as trip_distance_miles,
        store_and_fwd_flag,

        -- financials
        round(cast(fare_amount as decimal(10, 2)), 2) as fare_amount,
        round(cast(extra as decimal(10, 2)), 2) as extra_amount,
        round(cast(mta_tax as decimal(10, 2)), 2) as mta_tax,
        round(cast(tip_amount as decimal(10, 2)), 2) as tip_amount,
        round(cast(tolls_amount as decimal(10, 2)), 2) as tolls_amount,
        round(cast(improvement_surcharge as decimal(10, 2)), 2) as improvement_surcharge,
        round(cast(total_amount as decimal(10, 2)), 2) as total_amount,
        round(cast(congestion_surcharge as decimal(10, 2)), 2) as congestion_surcharge,
        round(cast(Airport_fee as decimal(10, 2)), 2) as airport_fee

    from source
    where tpep_pickup_datetime is not null
      and tpep_dropoff_datetime is not null
      and trip_distance >= 0
      and fare_amount >= 0
      -- filter out-of-range dates (data quality: ~18 trips outside Jan 2024)
      and cast(tpep_pickup_datetime as date) >= date '2024-01-01'
      and cast(tpep_pickup_datetime as date) < date '2024-02-01'
)

select * from renamed
    );
  
  
[0m00:40:47.392143 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m00:40:47.397911 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as date_key, 
      
    cast(null as bigint)
 as year, 
      
    cast(null as bigint)
 as month, 
      
    cast(null as bigint)
 as day_of_month, 
      
    cast(null as bigint)
 as day_of_week_num, 
      
    cast(null as varchar)
 as day_of_week_name, 
      
    cast(null as varchar)
 as month_name, 
      
    cast(null as bigint)
 as week_of_year, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as boolean)
 as is_holiday
    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:40:47.403139 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: COMMIT
[0m00:40:47.404220 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m00:40:47.405296 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:40:47.405909 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: COMMIT
[0m00:40:47.407466 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: COMMIT
[0m00:40:47.429993 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m00:40:47.430401 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_dates"
[0m00:40:47.430812 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m00:40:47.431176 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: COMMIT
[0m00:40:47.433632 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: Close
[0m00:40:47.435846 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfadaa6c0>]}
[0m00:40:47.436712 [info ] [Thread-3 (]: 3 of 91 OK loaded seed file main.payment_type_lookup ........................... [[32mCREATE 6[0m in 0.17s]
[0m00:40:47.437425 [debug] [Thread-3 (]: Finished running node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m00:40:47.437827 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m00:40:47.438272 [debug] [Thread-3 (]: Began running node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m00:40:47.439714 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: Close
[0m00:40:47.440428 [info ] [Thread-3 (]: 5 of 91 START seed file main.taxi_zone_lookup .................................. [RUN]
[0m00:40:47.441426 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba1c6f530>]}
[0m00:40:47.442018 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.payment_type_lookup, now seed.nyc_taxi_pipeline_00.taxi_zone_lookup)
[0m00:40:47.442866 [info ] [Thread-4 (]: 4 of 91 OK loaded seed file main.rate_code_lookup .............................. [[32mCREATE 7[0m in 0.18s]
[0m00:40:47.443489 [debug] [Thread-3 (]: Began compiling node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m00:40:47.444288 [debug] [Thread-4 (]: Finished running node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m00:40:47.444853 [debug] [Thread-3 (]: Began executing node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m00:40:47.445774 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m00:40:47.448659 [info ] [Thread-4 (]: 6 of 91 START test not_null_payment_type_lookup_payment_type_id ................ [RUN]
[0m00:40:47.449318 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.rate_code_lookup, now test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521)
[0m00:40:47.450393 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m00:40:47.457552 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m00:40:47.460430 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m00:40:47.461267 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_dates__dbt_tmp"
  
  (
    date_key date,
    year bigint,
    month bigint,
    day_of_month bigint,
    day_of_week_num bigint,
    day_of_week_name varchar,
    month_name varchar,
    week_of_year bigint,
    is_weekend boolean,
    is_holiday boolean
    
    )
 ;
    insert into "dev"."main"."dim_dates__dbt_tmp" 
  (
    
      
      date_key ,
    
      
      year ,
    
      
      month ,
    
      
      day_of_month ,
    
      
      day_of_week_num ,
    
      
      day_of_week_name ,
    
      
      month_name ,
    
      
      week_of_year ,
    
      
      is_weekend ,
    
      
      is_holiday 
    
  )
 (
      
    select date_key, year, month, day_of_month, day_of_week_num, day_of_week_name, month_name, week_of_year, is_weekend, is_holiday
    from (
        /*
    Dimension table: Calendar dates for January 2024.
    Uses adapter-dispatched macros for dayname/monthname.
*/

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 31
    order by generated_number



),

all_periods as (

    select (
        

    date_add(cast('2024-01-01' as date), interval (row_number() over (order by generated_number) - 1) day)


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-02-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week_num,
        
    dayname(date_day)
 as day_of_week_name,
        
    monthname(date_day)
 as month_name,
        extract(week from date_day) as week_of_year,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when cast(date_day as date) in (
                cast('2024-01-01' as date),
                cast('2024-01-15' as date)
            ) then true
            else false
        end as is_holiday

    from date_spine
)

select * from final
    ) as model_subq
    );
  
  
[0m00:40:47.462053 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m00:40:47.463435 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: BEGIN
[0m00:40:47.463872 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:47.464739 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.465286 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m00:40:47.465804 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"} */

    create table "dev"."main"."taxi_zone_lookup" ("LocationID" integer,"Borough" varchar,"Zone" varchar,"service_zone" varchar)
  
[0m00:40:47.467038 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.468487 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m00:40:47.469015 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: 
          COPY "dev"."main"."taxi_zone_lookup" FROM '/dbt/seeds/taxi_zone_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m00:40:47.470520 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m00:40:47.477486 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m00:40:47.478203 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
alter table "dev"."main"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m00:40:47.478600 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m00:40:47.479599 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m00:40:47.479984 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.481566 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: COMMIT
[0m00:40:47.482251 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m00:40:47.482763 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: COMMIT
[0m00:40:47.483185 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m00:40:47.494773 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m00:40:47.495238 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m00:40:47.499646 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m00:40:47.501429 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: COMMIT
[0m00:40:47.501832 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
drop table if exists "dev"."main"."dim_dates__dbt_backup" cascade
[0m00:40:47.502404 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m00:40:47.503569 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: COMMIT
[0m00:40:47.504013 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.505514 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: Close
[0m00:40:47.506284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba008a330>]}
[0m00:40:47.507191 [info ] [Thread-1 (]: 1 of 91 OK created sql table model main.dim_dates .............................. [[32mOK[0m in 0.25s]
[0m00:40:47.507774 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.dim_dates
[0m00:40:47.508104 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m00:40:47.508570 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m00:40:47.509729 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: Close
[0m00:40:47.510323 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m00:40:47.510711 [info ] [Thread-1 (]: 7 of 91 START test unique_payment_type_lookup_payment_type_id .................. [RUN]
[0m00:40:47.511569 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba1183c20>]}
[0m00:40:47.511889 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: BEGIN
[0m00:40:47.512490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_dates, now test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7)
[0m00:40:47.513321 [info ] [Thread-3 (]: 5 of 91 OK loaded seed file main.taxi_zone_lookup .............................. [[32mCREATE 265[0m in 0.07s]
[0m00:40:47.513996 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:47.514583 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m00:40:47.515239 [debug] [Thread-3 (]: Finished running node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m00:40:47.516303 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m00:40:47.521544 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m00:40:47.522500 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m00:40:47.523774 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m00:40:47.524731 [info ] [Thread-3 (]: 8 of 91 START test not_null_rate_code_lookup_rate_code_id ...................... [RUN]
[0m00:40:47.525573 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."payment_type_lookup"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m00:40:47.526423 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.taxi_zone_lookup, now test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec)
[0m00:40:47.527263 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m00:40:47.530572 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m00:40:47.531075 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m00:40:47.534569 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: ROLLBACK
[0m00:40:47.535786 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521'
[0m00:40:47.536174 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m00:40:47.538306 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: Close
[0m00:40:47.540641 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m00:40:47.541088 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m00:40:47.541655 [info ] [Thread-4 (]: 6 of 91 PASS not_null_payment_type_lookup_payment_type_id ...................... [[32mPASS[0m in 0.09s]
[0m00:40:47.544172 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m00:40:47.544983 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m00:40:47.545878 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m00:40:47.546291 [info ] [Thread-4 (]: 9 of 91 START test unique_rate_code_lookup_rate_code_id ........................ [RUN]
[0m00:40:47.546843 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521, now test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d)
[0m00:40:47.547298 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m00:40:47.550677 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m00:40:47.552067 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m00:40:47.552428 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m00:40:47.552755 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: BEGIN
[0m00:40:47.553233 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: BEGIN
[0m00:40:47.553905 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:47.554533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:47.555815 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:47.556138 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:40:47.556510 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m00:40:47.557025 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m00:40:47.557654 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_id
from "dev"."main"."rate_code_lookup"
where rate_code_id is null



  
  
      
    ) dbt_internal_test
[0m00:40:47.558464 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."payment_type_lookup"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:40:47.559373 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m00:40:47.560072 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.562533 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m00:40:47.563113 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:40:47.564609 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: ROLLBACK
[0m00:40:47.566324 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: ROLLBACK
[0m00:40:47.566997 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec'
[0m00:40:47.567747 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7'
[0m00:40:47.568244 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: Close
[0m00:40:47.568835 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: Close
[0m00:40:47.569506 [info ] [Thread-3 (]: 8 of 91 PASS not_null_rate_code_lookup_rate_code_id ............................ [[32mPASS[0m in 0.04s]
[0m00:40:47.569991 [info ] [Thread-1 (]: 7 of 91 PASS unique_payment_type_lookup_payment_type_id ........................ [[32mPASS[0m in 0.06s]
[0m00:40:47.570452 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m00:40:47.571163 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m00:40:47.571884 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m00:40:47.572571 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m00:40:47.573162 [info ] [Thread-3 (]: 10 of 91 START test not_null_dim_dates_date_key ................................ [RUN]
[0m00:40:47.573833 [info ] [Thread-1 (]: 11 of 91 START test not_null_dim_dates_day_of_week_name ........................ [RUN]
[0m00:40:47.574244 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m00:40:47.574673 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec, now test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348)
[0m00:40:47.575143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7, now test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541)
[0m00:40:47.575638 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: BEGIN
[0m00:40:47.576208 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m00:40:47.576799 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m00:40:47.577332 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:47.580784 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m00:40:47.584373 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m00:40:47.585853 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m00:40:47.586689 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m00:40:47.587187 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rate_code_id as unique_field,
    count(*) as n_records

from "dev"."main"."rate_code_lookup"
where rate_code_id is not null
group by rate_code_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:40:47.589039 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.590747 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: ROLLBACK
[0m00:40:47.591547 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d'
[0m00:40:47.592239 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: Close
[0m00:40:47.592981 [info ] [Thread-4 (]: 9 of 91 PASS unique_rate_code_lookup_rate_code_id .............................. [[32mPASS[0m in 0.05s]
[0m00:40:47.593639 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m00:40:47.594224 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m00:40:47.594905 [info ] [Thread-4 (]: 12 of 91 START test not_null_dim_dates_is_holiday .............................. [RUN]
[0m00:40:47.595730 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d, now test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a)
[0m00:40:47.596453 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m00:40:47.596829 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m00:40:47.599496 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m00:40:47.600002 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m00:40:47.603601 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m00:40:47.606644 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m00:40:47.614883 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m00:40:47.615705 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: BEGIN
[0m00:40:47.616229 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:47.617221 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.617579 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m00:40:47.617942 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m00:40:47.618214 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m00:40:47.621795 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m00:40:47.622613 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: BEGIN
[0m00:40:47.623693 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "dev"."main"."dim_dates"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m00:40:47.624980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:47.626525 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:40:47.626951 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.627243 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m00:40:47.628862 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: ROLLBACK
[0m00:40:47.629205 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select day_of_week_name
from "dev"."main"."dim_dates"
where day_of_week_name is null



  
  
      
    ) dbt_internal_test
[0m00:40:47.630248 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348'
[0m00:40:47.631118 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: Close
[0m00:40:47.631656 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.632176 [info ] [Thread-3 (]: 10 of 91 PASS not_null_dim_dates_date_key ...................................... [[32mPASS[0m in 0.06s]
[0m00:40:47.633535 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: ROLLBACK
[0m00:40:47.634451 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m00:40:47.635639 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541'
[0m00:40:47.636264 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m00:40:47.636704 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m00:40:47.637433 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: Close
[0m00:40:47.638123 [info ] [Thread-3 (]: 13 of 91 START test not_null_dim_dates_is_weekend .............................. [RUN]
[0m00:40:47.638696 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: BEGIN
[0m00:40:47.639634 [info ] [Thread-1 (]: 11 of 91 PASS not_null_dim_dates_day_of_week_name .............................. [[32mPASS[0m in 0.06s]
[0m00:40:47.640043 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348, now test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0)
[0m00:40:47.640636 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:47.641384 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m00:40:47.642312 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m00:40:47.643328 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m00:40:47.643789 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m00:40:47.647249 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m00:40:47.648033 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m00:40:47.648746 [info ] [Thread-1 (]: 14 of 91 START test unique_dim_dates_date_key .................................. [RUN]
[0m00:40:47.649881 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_holiday
from "dev"."main"."dim_dates"
where is_holiday is null



  
  
      
    ) dbt_internal_test
[0m00:40:47.650602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541, now test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d)
[0m00:40:47.651540 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m00:40:47.654876 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m00:40:47.655312 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m00:40:47.657316 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: ROLLBACK
[0m00:40:47.658706 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a'
[0m00:40:47.659219 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: Close
[0m00:40:47.660076 [info ] [Thread-4 (]: 12 of 91 PASS not_null_dim_dates_is_holiday .................................... [[32mPASS[0m in 0.06s]
[0m00:40:47.660978 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m00:40:47.661487 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m00:40:47.661917 [info ] [Thread-4 (]: 15 of 91 START test not_null_taxi_zone_lookup_Borough .......................... [RUN]
[0m00:40:47.662608 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a, now test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa)
[0m00:40:47.663005 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m00:40:47.663486 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m00:40:47.666184 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m00:40:47.666680 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m00:40:47.669848 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m00:40:47.673060 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m00:40:47.677564 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m00:40:47.678152 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: BEGIN
[0m00:40:47.678539 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:47.679388 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.680046 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m00:40:47.680480 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m00:40:47.680826 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m00:40:47.681287 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: BEGIN
[0m00:40:47.681822 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."dim_dates"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m00:40:47.684567 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m00:40:47.685400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:47.686887 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.687697 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:40:47.689754 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: ROLLBACK
[0m00:40:47.690123 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m00:40:47.691476 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0'
[0m00:40:47.692126 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "dev"."main"."dim_dates"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:40:47.693267 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: Close
[0m00:40:47.695251 [info ] [Thread-3 (]: 13 of 91 PASS not_null_dim_dates_is_weekend .................................... [[32mPASS[0m in 0.06s]
[0m00:40:47.695649 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.696051 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m00:40:47.697978 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: ROLLBACK
[0m00:40:47.698348 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m00:40:47.699197 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d'
[0m00:40:47.700741 [info ] [Thread-3 (]: 16 of 91 START test not_null_taxi_zone_lookup_LocationID ....................... [RUN]
[0m00:40:47.701630 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: Close
[0m00:40:47.702307 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0, now test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a)
[0m00:40:47.702760 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m00:40:47.703388 [info ] [Thread-1 (]: 14 of 91 PASS unique_dim_dates_date_key ........................................ [[32mPASS[0m in 0.05s]
[0m00:40:47.704096 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m00:40:47.704758 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: BEGIN
[0m00:40:47.705487 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m00:40:47.708888 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m00:40:47.709544 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:47.710440 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m00:40:47.712383 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m00:40:47.712044 [info ] [Thread-1 (]: 17 of 91 START test unique_taxi_zone_lookup_LocationID ......................... [RUN]
[0m00:40:47.712796 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m00:40:47.713478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d, now test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8)
[0m00:40:47.713993 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Borough
from "dev"."main"."taxi_zone_lookup"
where Borough is null



  
  
      
    ) dbt_internal_test
[0m00:40:47.714612 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m00:40:47.718979 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m00:40:47.719722 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m00:40:47.721183 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: ROLLBACK
[0m00:40:47.722053 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa'
[0m00:40:47.722415 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m00:40:47.722724 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: Close
[0m00:40:47.726495 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m00:40:47.726930 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m00:40:47.727860 [info ] [Thread-4 (]: 15 of 91 PASS not_null_taxi_zone_lookup_Borough ................................ [[32mPASS[0m in 0.07s]
[0m00:40:47.730428 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m00:40:47.731406 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m00:40:47.732857 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.stg_payment_types
[0m00:40:47.733406 [info ] [Thread-4 (]: 18 of 91 START sql view model main.stg_payment_types ........................... [RUN]
[0m00:40:47.734038 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa, now model.nyc_taxi_pipeline_00.stg_payment_types)
[0m00:40:47.734635 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_payment_types
[0m00:40:47.737203 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m00:40:47.738366 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m00:40:47.739037 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: BEGIN
[0m00:40:47.739419 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m00:40:47.739940 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:47.740598 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: BEGIN
[0m00:40:47.741851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:47.742209 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:47.742734 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.743044 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m00:40:47.743472 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m00:40:47.744158 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select LocationID
from "dev"."main"."taxi_zone_lookup"
where LocationID is null



  
  
      
    ) dbt_internal_test
[0m00:40:47.745075 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    LocationID as unique_field,
    count(*) as n_records

from "dev"."main"."taxi_zone_lookup"
where LocationID is not null
group by LocationID
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:40:47.746764 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.747432 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.747864 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.stg_payment_types
[0m00:40:47.749324 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: ROLLBACK
[0m00:40:47.750843 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: ROLLBACK
[0m00:40:47.763454 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m00:40:47.764964 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a'
[0m00:40:47.765571 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8'
[0m00:40:47.766640 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: Close
[0m00:40:47.767341 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: Close
[0m00:40:47.768569 [info ] [Thread-3 (]: 16 of 91 PASS not_null_taxi_zone_lookup_LocationID ............................. [[32mPASS[0m in 0.07s]
[0m00:40:47.769550 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m00:40:47.770031 [info ] [Thread-1 (]: 17 of 91 PASS unique_taxi_zone_lookup_LocationID ............................... [[32mPASS[0m in 0.06s]
[0m00:40:47.770402 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m00:40:47.771421 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m00:40:47.772183 [info ] [Thread-3 (]: 19 of 91 START sql view model main.stg_rate_codes .............................. [RUN]
[0m00:40:47.773297 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m00:40:47.773767 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a, now model.nyc_taxi_pipeline_00.stg_rate_codes)
[0m00:40:47.774443 [info ] [Thread-1 (]: 20 of 91 START sql view model main.stg_taxi_zones .............................. [RUN]
[0m00:40:47.775123 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m00:40:47.775835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8, now model.nyc_taxi_pipeline_00.stg_taxi_zones)
[0m00:40:47.776351 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m00:40:47.778675 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m00:40:47.779629 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m00:40:47.780374 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: BEGIN
[0m00:40:47.783889 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m00:40:47.784637 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:47.786207 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m00:40:47.786769 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m00:40:47.787310 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */

  
  create view "dev"."main"."stg_payment_types__dbt_tmp" as (
    /*
    Staging model: Payment type lookup
    Maps payment_type_id to human-readable names.
*/

with source as (
    select * from "dev"."main"."payment_type_lookup"
),

renamed as (
    select
        payment_type_id,
        payment_type_name
    from source
)

select * from renamed
  );

[0m00:40:47.788451 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.791199 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m00:40:47.792044 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
alter view "dev"."main"."stg_payment_types__dbt_tmp" rename to "stg_payment_types"
[0m00:40:47.792539 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m00:40:47.795493 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m00:40:47.795971 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m00:40:47.796563 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m00:40:47.799549 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m00:40:47.801246 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: COMMIT
[0m00:40:47.802220 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m00:40:47.802612 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: COMMIT
[0m00:40:47.804888 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m00:40:47.805463 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: BEGIN
[0m00:40:47.806055 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:47.806903 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m00:40:47.807314 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.887525 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m00:40:47.888209 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m00:40:47.888635 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m00:40:47.889302 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: BEGIN
[0m00:40:47.890168 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
drop view if exists "dev"."main"."stg_payment_types__dbt_backup" cascade
[0m00:40:47.890834 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */

  
  create view "dev"."main"."stg_rate_codes__dbt_tmp" as (
    /*
    Staging model: Rate code lookup
    Maps rate_code_id to human-readable names.
*/

with source as (
    select * from "dev"."main"."rate_code_lookup"
),

renamed as (
    select
        rate_code_id,
        rate_code_name
    from source
)

select * from renamed
  );

[0m00:40:47.891362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:47.892888 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.893940 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:40:47.894236 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:47.895381 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: Close
[0m00:40:47.896058 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m00:40:47.899268 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m00:40:47.900353 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba00d59a0>]}
[0m00:40:47.900977 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */

  
  create view "dev"."main"."stg_taxi_zones__dbt_tmp" as (
    /*
    Staging model: Taxi zone lookup
    Maps LocationID to borough and zone name.
*/

with source as (
    select * from "dev"."main"."taxi_zone_lookup"
),

renamed as (
    select
        cast("LocationID" as integer) as location_id,
        "Borough" as borough,
        "Zone" as zone_name,
        service_zone
    from source
)

select * from renamed
  );

[0m00:40:47.901560 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
alter view "dev"."main"."stg_rate_codes__dbt_tmp" rename to "stg_rate_codes"
[0m00:40:47.902455 [info ] [Thread-4 (]: 18 of 91 OK created sql view model main.stg_payment_types ...................... [[32mOK[0m in 0.17s]
[0m00:40:47.903875 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.904472 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.stg_payment_types
[0m00:40:47.905002 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.907981 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m00:40:47.909639 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m00:40:47.910955 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: COMMIT
[0m00:40:47.911575 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
alter view "dev"."main"."stg_taxi_zones__dbt_tmp" rename to "stg_taxi_zones"
[0m00:40:47.912165 [info ] [Thread-4 (]: 21 of 91 START test not_null_stg_payment_types_payment_type_id ................. [RUN]
[0m00:40:47.912761 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m00:40:47.913967 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_payment_types, now test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78)
[0m00:40:47.914754 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.915204 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: COMMIT
[0m00:40:47.915719 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m00:40:47.917033 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: COMMIT
[0m00:40:47.920770 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m00:40:47.921386 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m00:40:47.921732 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m00:40:47.924063 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m00:40:47.925009 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: COMMIT
[0m00:40:47.925802 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
drop view if exists "dev"."main"."stg_rate_codes__dbt_backup" cascade
[0m00:40:47.927245 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m00:40:47.928678 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: Close
[0m00:40:47.929543 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb2010f3e0>]}
[0m00:40:47.930120 [info ] [Thread-3 (]: 19 of 91 OK created sql view model main.stg_rate_codes ......................... [[32mOK[0m in 0.16s]
[0m00:40:47.930638 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m00:40:47.930894 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m00:40:47.931232 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m00:40:47.933721 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m00:40:47.934302 [info ] [Thread-3 (]: 22 of 91 START test not_null_stg_payment_types_payment_type_name ............... [RUN]
[0m00:40:47.935102 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
drop view if exists "dev"."main"."stg_taxi_zones__dbt_backup" cascade
[0m00:40:47.935660 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_rate_codes, now test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39)
[0m00:40:47.936700 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m00:40:47.937166 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.941074 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m00:40:47.942934 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: Close
[0m00:40:47.944741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb20147e00>]}
[0m00:40:47.945470 [info ] [Thread-1 (]: 20 of 91 OK created sql view model main.stg_taxi_zones ......................... [[32mOK[0m in 0.17s]
[0m00:40:47.946054 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m00:40:47.946601 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m00:40:47.947326 [info ] [Thread-1 (]: 23 of 91 START test unique_stg_payment_types_payment_type_id ................... [RUN]
[0m00:40:47.948223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_taxi_zones, now test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534)
[0m00:40:47.948865 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m00:40:47.952237 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m00:40:47.953688 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m00:40:47.955944 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m00:40:47.956386 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m00:40:47.961221 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m00:40:47.963843 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m00:40:47.966776 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m00:40:47.978090 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m00:40:47.978905 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: BEGIN
[0m00:40:47.979515 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:47.980915 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m00:40:47.981340 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m00:40:47.981726 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: BEGIN
[0m00:40:47.982467 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m00:40:47.983210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:47.983828 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m00:40:47.984206 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."stg_payment_types"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m00:40:47.985445 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: BEGIN
[0m00:40:47.985915 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:40:47.986744 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:47.987507 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:47.987990 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m00:40:47.988950 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:47.990864 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: ROLLBACK
[0m00:40:47.991396 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_payment_types"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:40:47.992143 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m00:40:47.993152 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78'
[0m00:40:47.994088 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_name
from "dev"."main"."stg_payment_types"
where payment_type_name is null



  
  
      
    ) dbt_internal_test
[0m00:40:47.994739 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: Close
[0m00:40:47.995203 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:40:47.996193 [info ] [Thread-4 (]: 21 of 91 PASS not_null_stg_payment_types_payment_type_id ....................... [[32mPASS[0m in 0.08s]
[0m00:40:47.997296 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: ROLLBACK
[0m00:40:47.997693 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:47.998154 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m00:40:47.999149 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534'
[0m00:40:48.000899 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: ROLLBACK
[0m00:40:48.001274 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m00:40:48.001739 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: Close
[0m00:40:48.002723 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39'
[0m00:40:48.003598 [info ] [Thread-4 (]: 24 of 91 START test not_null_stg_rate_codes_rate_code_id ....................... [RUN]
[0m00:40:48.004877 [info ] [Thread-1 (]: 23 of 91 PASS unique_stg_payment_types_payment_type_id ......................... [[32mPASS[0m in 0.06s]
[0m00:40:48.005219 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: Close
[0m00:40:48.005824 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78, now test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a)
[0m00:40:48.006322 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m00:40:48.007047 [info ] [Thread-3 (]: 22 of 91 PASS not_null_stg_payment_types_payment_type_name ..................... [[32mPASS[0m in 0.07s]
[0m00:40:48.007439 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m00:40:48.007942 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m00:40:48.008765 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m00:40:48.011985 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m00:40:48.012647 [info ] [Thread-1 (]: 25 of 91 START test not_null_stg_rate_codes_rate_code_name ..................... [RUN]
[0m00:40:48.013155 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m00:40:48.014379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534, now test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f)
[0m00:40:48.014970 [info ] [Thread-3 (]: 26 of 91 START test unique_stg_rate_codes_rate_code_id ......................... [RUN]
[0m00:40:48.015504 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m00:40:48.016074 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39, now test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3)
[0m00:40:48.019319 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m00:40:48.020027 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m00:40:48.023981 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m00:40:48.025449 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m00:40:48.027594 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m00:40:48.029222 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m00:40:48.031130 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m00:40:48.031600 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m00:40:48.033947 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m00:40:48.037440 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m00:40:48.038050 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: BEGIN
[0m00:40:48.038566 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:48.039515 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m00:40:48.039908 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.040423 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: BEGIN
[0m00:40:48.040981 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m00:40:48.041480 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m00:40:48.041864 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:48.042592 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_id
from "dev"."main"."stg_rate_codes"
where rate_code_id is null



  
  
      
    ) dbt_internal_test
[0m00:40:48.043198 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: BEGIN
[0m00:40:48.044285 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.044979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:48.045571 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m00:40:48.046047 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.046735 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.047067 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rate_code_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_rate_codes"
where rate_code_id is not null
group by rate_code_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:40:48.048677 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: ROLLBACK
[0m00:40:48.049088 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m00:40:48.050474 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a'
[0m00:40:48.051060 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_name
from "dev"."main"."stg_rate_codes"
where rate_code_name is null



  
  
      
    ) dbt_internal_test
[0m00:40:48.051390 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.052024 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: Close
[0m00:40:48.053907 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: ROLLBACK
[0m00:40:48.054342 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.054984 [info ] [Thread-4 (]: 24 of 91 PASS not_null_stg_rate_codes_rate_code_id ............................. [[32mPASS[0m in 0.05s]
[0m00:40:48.055675 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3'
[0m00:40:48.057312 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: ROLLBACK
[0m00:40:48.057855 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m00:40:48.058334 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: Close
[0m00:40:48.059164 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f'
[0m00:40:48.059645 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m00:40:48.060386 [info ] [Thread-3 (]: 26 of 91 PASS unique_stg_rate_codes_rate_code_id ............................... [[32mPASS[0m in 0.04s]
[0m00:40:48.060796 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: Close
[0m00:40:48.061401 [info ] [Thread-4 (]: 27 of 91 START test not_null_stg_taxi_zones_borough ............................ [RUN]
[0m00:40:48.062008 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m00:40:48.062832 [info ] [Thread-1 (]: 25 of 91 PASS not_null_stg_rate_codes_rate_code_name ........................... [[32mPASS[0m in 0.05s]
[0m00:40:48.063195 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b)
[0m00:40:48.063750 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m00:40:48.064472 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m00:40:48.065008 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m00:40:48.065499 [info ] [Thread-3 (]: 28 of 91 START test not_null_stg_taxi_zones_location_id ........................ [RUN]
[0m00:40:48.066203 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m00:40:48.070045 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m00:40:48.070919 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf)
[0m00:40:48.071564 [info ] [Thread-1 (]: 29 of 91 START test not_null_stg_taxi_zones_zone_name .......................... [RUN]
[0m00:40:48.072541 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m00:40:48.073244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84)
[0m00:40:48.076837 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m00:40:48.077648 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m00:40:48.082393 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m00:40:48.083918 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m00:40:48.085996 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m00:40:48.087096 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m00:40:48.088992 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m00:40:48.089418 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m00:40:48.091919 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m00:40:48.094850 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m00:40:48.095617 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: BEGIN
[0m00:40:48.096197 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:48.097370 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m00:40:48.097820 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.098140 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: BEGIN
[0m00:40:48.098608 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m00:40:48.099050 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m00:40:48.099686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:48.100288 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select borough
from "dev"."main"."stg_taxi_zones"
where borough is null



  
  
      
    ) dbt_internal_test
[0m00:40:48.100933 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: BEGIN
[0m00:40:48.102257 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:40:48.102673 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:48.103048 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.103416 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m00:40:48.104447 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.106040 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: ROLLBACK
[0m00:40:48.106549 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select zone_name
from "dev"."main"."stg_taxi_zones"
where zone_name is null



  
  
      
    ) dbt_internal_test
[0m00:40:48.107130 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m00:40:48.108581 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b'
[0m00:40:48.109473 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "dev"."main"."stg_taxi_zones"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m00:40:48.109939 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.110187 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: Close
[0m00:40:48.111815 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: ROLLBACK
[0m00:40:48.112420 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.112996 [info ] [Thread-4 (]: 27 of 91 PASS not_null_stg_taxi_zones_borough .................................. [[32mPASS[0m in 0.05s]
[0m00:40:48.113937 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84'
[0m00:40:48.115260 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: ROLLBACK
[0m00:40:48.115998 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m00:40:48.116532 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: Close
[0m00:40:48.117580 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf'
[0m00:40:48.117923 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m00:40:48.118848 [info ] [Thread-1 (]: 29 of 91 PASS not_null_stg_taxi_zones_zone_name ................................ [[32mPASS[0m in 0.05s]
[0m00:40:48.119168 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: Close
[0m00:40:48.119741 [info ] [Thread-4 (]: 30 of 91 START test unique_stg_taxi_zones_location_id .......................... [RUN]
[0m00:40:48.120365 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m00:40:48.121189 [info ] [Thread-3 (]: 28 of 91 PASS not_null_stg_taxi_zones_location_id .............................. [[32mPASS[0m in 0.05s]
[0m00:40:48.121578 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b, now test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c)
[0m00:40:48.122124 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.dim_payment_types
[0m00:40:48.122789 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m00:40:48.123244 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m00:40:48.123981 [info ] [Thread-1 (]: 31 of 91 START sql table model main.dim_payment_types .......................... [RUN]
[0m00:40:48.127875 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m00:40:48.129323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84, now model.nyc_taxi_pipeline_00.dim_payment_types)
[0m00:40:48.130416 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_payment_types
[0m00:40:48.133049 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m00:40:48.138283 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m00:40:48.141055 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m00:40:48.142764 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.dim_payment_types
[0m00:40:48.146150 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m00:40:48.147245 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
DESCRIBE (select * from (
        /*
    Dimension table: Payment type descriptions.
*/

with payment_types as (
    select * from "dev"."main"."stg_payment_types"
),

final as (
    select
        payment_type_id,
        payment_type_name
    from payment_types
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:40:48.147957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:48.149920 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.151468 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m00:40:48.152238 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as payment_type_id, 
      
    cast(null as varchar)
 as payment_type_name
    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:40:48.154003 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.154935 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m00:40:48.156450 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m00:40:48.156830 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: BEGIN
[0m00:40:48.157941 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:48.159530 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.160360 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m00:40:48.161055 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_taxi_zones"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:40:48.163325 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.165821 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: ROLLBACK
[0m00:40:48.167211 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c'
[0m00:40:48.168457 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: Close
[0m00:40:48.169502 [info ] [Thread-4 (]: 30 of 91 PASS unique_stg_taxi_zones_location_id ................................ [[32mPASS[0m in 0.05s]
[0m00:40:48.172926 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m00:40:48.174767 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.dim_locations
[0m00:40:48.176039 [info ] [Thread-3 (]: 32 of 91 START sql table model main.dim_locations .............................. [RUN]
[0m00:40:48.176845 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf, now model.nyc_taxi_pipeline_00.dim_locations)
[0m00:40:48.177270 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m00:40:48.177653 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_locations
[0m00:40:48.178363 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: BEGIN
[0m00:40:48.181229 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_locations"
[0m00:40:48.182607 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:40:48.183734 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m00:40:48.184654 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_payment_types__dbt_tmp"
  
  (
    payment_type_id integer,
    payment_type_name varchar
    
    )
 ;
    insert into "dev"."main"."dim_payment_types__dbt_tmp" 
  (
    
      
      payment_type_id ,
    
      
      payment_type_name 
    
  )
 (
      
    select payment_type_id, payment_type_name
    from (
        /*
    Dimension table: Payment type descriptions.
*/

with payment_types as (
    select * from "dev"."main"."stg_payment_types"
),

final as (
    select
        payment_type_id,
        payment_type_name
    from payment_types
)

select * from final
    ) as model_subq
    );
  
  
[0m00:40:48.187269 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.192095 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m00:40:48.192679 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
alter table "dev"."main"."dim_payment_types__dbt_tmp" rename to "dim_payment_types"
[0m00:40:48.193750 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.195108 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: COMMIT
[0m00:40:48.195595 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m00:40:48.196063 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: COMMIT
[0m00:40:48.199831 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.dim_locations
[0m00:40:48.203232 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m00:40:48.204003 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m00:40:48.204430 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
DESCRIBE (select * from (
        /*
    Dimension table: TLC Taxi Zone locations.
*/

with zones as (
    select * from "dev"."main"."stg_taxi_zones"
),

final as (
    select
        location_id,
        borough,
        zone_name,
        service_zone
    from zones
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:40:48.206908 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m00:40:48.207804 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:48.208649 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
drop table if exists "dev"."main"."dim_payment_types__dbt_backup" cascade
[0m00:40:48.210610 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m00:40:48.211060 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.212188 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m00:40:48.213416 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: Close
[0m00:40:48.214183 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as location_id, 
      
    cast(null as varchar)
 as borough, 
      
    cast(null as varchar)
 as zone_name, 
      
    cast(null as varchar)
 as service_zone
    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:40:48.215232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba0089fa0>]}
[0m00:40:48.216656 [info ] [Thread-1 (]: 31 of 91 OK created sql table model main.dim_payment_types ..................... [[32mOK[0m in 0.09s]
[0m00:40:48.217086 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.217623 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.dim_payment_types
[0m00:40:48.219935 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_locations"
[0m00:40:48.221118 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m00:40:48.221481 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m00:40:48.221881 [info ] [Thread-4 (]: 33 of 91 START test not_null_dim_payment_types_payment_type_id ................. [RUN]
[0m00:40:48.222642 [info ] [Thread-1 (]: 34 of 91 START test not_null_dim_payment_types_payment_type_name ............... [RUN]
[0m00:40:48.223585 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c, now test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10)
[0m00:40:48.224206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_payment_types, now test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0)
[0m00:40:48.225250 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m00:40:48.225923 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m00:40:48.230651 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m00:40:48.234573 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m00:40:48.236572 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m00:40:48.237311 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: BEGIN
[0m00:40:48.238845 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.239401 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m00:40:48.240072 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_locations__dbt_tmp"
  
  (
    location_id integer,
    borough varchar,
    zone_name varchar,
    service_zone varchar
    
    )
 ;
    insert into "dev"."main"."dim_locations__dbt_tmp" 
  (
    
      
      location_id ,
    
      
      borough ,
    
      
      zone_name ,
    
      
      service_zone 
    
  )
 (
      
    select location_id, borough, zone_name, service_zone
    from (
        /*
    Dimension table: TLC Taxi Zone locations.
*/

with zones as (
    select * from "dev"."main"."stg_taxi_zones"
),

final as (
    select
        location_id,
        borough,
        zone_name,
        service_zone
    from zones
)

select * from final
    ) as model_subq
    );
  
  
[0m00:40:48.242886 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.246337 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m00:40:48.246853 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m00:40:48.247339 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
alter table "dev"."main"."dim_locations__dbt_tmp" rename to "dim_locations"
[0m00:40:48.249878 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m00:40:48.251493 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.253526 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: COMMIT
[0m00:40:48.254617 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m00:40:48.255315 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m00:40:48.257727 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m00:40:48.258433 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: COMMIT
[0m00:40:48.261202 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m00:40:48.261859 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: BEGIN
[0m00:40:48.262360 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:48.263269 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.263757 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m00:40:48.264163 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m00:40:48.264566 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m00:40:48.267956 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m00:40:48.268751 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: BEGIN
[0m00:40:48.269406 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."dim_payment_types"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m00:40:48.270115 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
drop table if exists "dev"."main"."dim_locations__dbt_backup" cascade
[0m00:40:48.270759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:48.272595 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.273029 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.273395 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:40:48.274879 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: ROLLBACK
[0m00:40:48.276179 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: Close
[0m00:40:48.276896 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m00:40:48.277978 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10'
[0m00:40:48.278775 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba0130dd0>]}
[0m00:40:48.279147 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_name
from "dev"."main"."dim_payment_types"
where payment_type_name is null



  
  
      
    ) dbt_internal_test
[0m00:40:48.279732 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: Close
[0m00:40:48.280583 [info ] [Thread-3 (]: 32 of 91 OK created sql table model main.dim_locations ......................... [[32mOK[0m in 0.10s]
[0m00:40:48.281885 [info ] [Thread-4 (]: 33 of 91 PASS not_null_dim_payment_types_payment_type_id ....................... [[32mPASS[0m in 0.06s]
[0m00:40:48.282415 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.dim_locations
[0m00:40:48.282806 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.283173 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m00:40:48.283739 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m00:40:48.285513 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: ROLLBACK
[0m00:40:48.285928 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m00:40:48.286499 [info ] [Thread-3 (]: 35 of 91 START test unique_dim_payment_types_payment_type_id ................... [RUN]
[0m00:40:48.287621 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0'
[0m00:40:48.288109 [info ] [Thread-4 (]: 36 of 91 START test not_null_dim_locations_borough ............................. [RUN]
[0m00:40:48.288932 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_locations, now test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62)
[0m00:40:48.289485 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: Close
[0m00:40:48.290273 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10, now test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af)
[0m00:40:48.290916 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m00:40:48.291805 [info ] [Thread-1 (]: 34 of 91 PASS not_null_dim_payment_types_payment_type_name ..................... [[32mPASS[0m in 0.07s]
[0m00:40:48.292160 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m00:40:48.295751 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m00:40:48.296731 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m00:40:48.300701 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m00:40:48.302251 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m00:40:48.303170 [info ] [Thread-1 (]: 37 of 91 START test not_null_dim_locations_location_id ......................... [RUN]
[0m00:40:48.304028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0, now test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476)
[0m00:40:48.304793 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m00:40:48.308347 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m00:40:48.309986 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m00:40:48.310405 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m00:40:48.312280 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m00:40:48.314757 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m00:40:48.317772 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m00:40:48.320159 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m00:40:48.325879 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m00:40:48.326665 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: BEGIN
[0m00:40:48.327146 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:48.327912 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m00:40:48.328418 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: BEGIN
[0m00:40:48.328745 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.329120 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:48.329654 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m00:40:48.330843 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select borough
from "dev"."main"."dim_locations"
where borough is null



  
  
      
    ) dbt_internal_test
[0m00:40:48.331301 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m00:40:48.331872 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m00:40:48.332186 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: BEGIN
[0m00:40:48.333240 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m00:40:48.333901 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.334454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:48.335396 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."dim_payment_types"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:40:48.337130 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: ROLLBACK
[0m00:40:48.338055 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:40:48.339218 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af'
[0m00:40:48.339698 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m00:40:48.340044 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.340354 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: Close
[0m00:40:48.340905 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "dev"."main"."dim_locations"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m00:40:48.342667 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: ROLLBACK
[0m00:40:48.343254 [info ] [Thread-4 (]: 36 of 91 PASS not_null_dim_locations_borough ................................... [[32mPASS[0m in 0.05s]
[0m00:40:48.344407 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62'
[0m00:40:48.344964 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.345554 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m00:40:48.346253 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: Close
[0m00:40:48.347647 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: ROLLBACK
[0m00:40:48.348057 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m00:40:48.349010 [info ] [Thread-3 (]: 35 of 91 PASS unique_dim_payment_types_payment_type_id ......................... [[32mPASS[0m in 0.06s]
[0m00:40:48.349930 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476'
[0m00:40:48.350335 [info ] [Thread-4 (]: 38 of 91 START test not_null_dim_locations_zone_name ........................... [RUN]
[0m00:40:48.351091 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m00:40:48.351797 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: Close
[0m00:40:48.352446 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af, now test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d)
[0m00:40:48.352909 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m00:40:48.353758 [info ] [Thread-1 (]: 37 of 91 PASS not_null_dim_locations_location_id ............................... [[32mPASS[0m in 0.05s]
[0m00:40:48.354130 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m00:40:48.354671 [info ] [Thread-3 (]: 39 of 91 START test unique_dim_locations_location_id ........................... [RUN]
[0m00:40:48.355275 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m00:40:48.358718 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m00:40:48.359286 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62, now test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d)
[0m00:40:48.360976 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m00:40:48.364165 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m00:40:48.369976 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m00:40:48.373834 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m00:40:48.376033 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m00:40:48.378389 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m00:40:48.384733 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m00:40:48.385375 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: BEGIN
[0m00:40:48.385912 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:48.387031 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.387514 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m00:40:48.388005 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m00:40:48.388671 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: BEGIN
[0m00:40:48.389289 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select zone_name
from "dev"."main"."dim_locations"
where zone_name is null



  
  
      
    ) dbt_internal_test
[0m00:40:48.389873 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:48.391439 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:48.391886 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.394057 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: ROLLBACK
[0m00:40:48.394505 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m00:40:48.395848 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d'
[0m00:40:48.396462 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "dev"."main"."dim_locations"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:40:48.397354 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: Close
[0m00:40:48.398815 [info ] [Thread-4 (]: 38 of 91 PASS not_null_dim_locations_zone_name ................................. [[32mPASS[0m in 0.05s]
[0m00:40:48.399822 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:48.400413 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m00:40:48.402318 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: ROLLBACK
[0m00:40:48.404130 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d'
[0m00:40:48.404849 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: Close
[0m00:40:48.405678 [info ] [Thread-3 (]: 39 of 91 PASS unique_dim_locations_location_id ................................. [[32mPASS[0m in 0.05s]
[0m00:40:48.406643 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m00:40:49.463647 [debug] [Thread-2 (]: SQL status: OK in 2.078 seconds
[0m00:40:49.466455 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m00:40:49.467057 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
alter table "dev"."main"."stg_yellow_trips__dbt_tmp" rename to "stg_yellow_trips"
[0m00:40:49.468107 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m00:40:49.469371 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: COMMIT
[0m00:40:49.469840 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m00:40:49.470238 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: COMMIT
[0m00:40:49.544930 [debug] [Thread-2 (]: SQL status: OK in 0.074 seconds
[0m00:40:49.547119 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m00:40:49.547590 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
drop table if exists "dev"."main"."stg_yellow_trips__dbt_backup" cascade
[0m00:40:49.548490 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m00:40:49.549670 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: Close
[0m00:40:49.598333 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba112d910>]}
[0m00:40:49.599307 [info ] [Thread-2 (]: 2 of 91 OK created sql table model main.stg_yellow_trips ....................... [[32mOK[0m in 2.34s]
[0m00:40:49.599886 [debug] [Thread-2 (]: Finished running node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m00:40:49.601233 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m00:40:49.601589 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m00:40:49.601865 [info ] [Thread-1 (]: 40 of 91 START test accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6  [RUN]
[0m00:40:49.602414 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m00:40:49.602710 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m00:40:49.602964 [info ] [Thread-4 (]: 41 of 91 START test accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99  [RUN]
[0m00:40:49.604063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44)
[0m00:40:49.604648 [info ] [Thread-3 (]: 42 of 91 START test accepted_values_stg_yellow_trips_vendor_id__1__2__6 ........ [RUN]
[0m00:40:49.605185 [info ] [Thread-2 (]: 43 of 91 START test assert_fare_not_exceeds_total .............................. [RUN]
[0m00:40:49.605800 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098)
[0m00:40:49.606212 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m00:40:49.606733 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27)
[0m00:40:49.607241 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_yellow_trips, now test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total)
[0m00:40:49.607714 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m00:40:49.611026 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m00:40:49.611651 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m00:40:49.612170 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m00:40:49.615390 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m00:40:49.619242 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m00:40:49.621906 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m00:40:49.623764 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m00:40:49.625634 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m00:40:49.626942 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m00:40:49.627203 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m00:40:49.628832 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m00:40:49.632441 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m00:40:49.634230 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m00:40:49.634635 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m00:40:49.634970 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: BEGIN
[0m00:40:49.637349 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m00:40:49.638317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:49.638712 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m00:40:49.639684 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: BEGIN
[0m00:40:49.640092 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m00:40:49.640430 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:49.640950 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: BEGIN
[0m00:40:49.641655 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:49.645455 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m00:40:49.646036 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: BEGIN
[0m00:40:49.646484 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:40:49.655970 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m00:40:49.656394 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m00:40:49.656691 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m00:40:49.656955 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m00:40:49.657211 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m00:40:49.657456 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m00:40:49.657855 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m00:40:49.658217 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rate_code_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by rate_code_id

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5','6','99'
)



  
  
      
    ) dbt_internal_test
[0m00:40:49.658695 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m00:40:49.659201 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        vendor_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by vendor_id

)

select *
from all_values
where value_field not in (
    '1','2','6'
)



  
  
      
    ) dbt_internal_test
[0m00:40:49.659600 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        payment_type_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by payment_type_id

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6'
)



  
  
      
    ) dbt_internal_test
[0m00:40:49.660339 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
    Singular test: fare_amount should not exceed total_amount.
*/

select
    trip_id,
    fare_amount,
    total_amount
from "dev"."main"."stg_yellow_trips"
where fare_amount > total_amount + 0.01
  and total_amount > 0
  
  
      
    ) dbt_internal_test
[0m00:40:49.680790 [debug] [Thread-4 (]: SQL status: OK in 0.021 seconds
[0m00:40:49.684082 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: ROLLBACK
[0m00:40:49.686445 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098'
[0m00:40:49.688632 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: Close
[0m00:40:49.689270 [debug] [Thread-3 (]: SQL status: OK in 0.028 seconds
[0m00:40:49.691767 [info ] [Thread-4 (]: 41 of 91 PASS accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99  [[32mPASS[0m in 0.09s]
[0m00:40:49.694202 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: ROLLBACK
[0m00:40:49.694754 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m00:40:49.696355 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27'
[0m00:40:49.696756 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m00:40:49.697689 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m00:40:49.699231 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: Close
[0m00:40:49.701818 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: ROLLBACK
[0m00:40:49.702245 [info ] [Thread-4 (]: 44 of 91 START test not_null_stg_yellow_trips_dropoff_datetime ................. [RUN]
[0m00:40:49.702684 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m00:40:49.703347 [info ] [Thread-3 (]: 42 of 91 PASS accepted_values_stg_yellow_trips_vendor_id__1__2__6 .............. [[32mPASS[0m in 0.10s]
[0m00:40:49.704228 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44'
[0m00:40:49.704655 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052)
[0m00:40:49.705992 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: ROLLBACK
[0m00:40:49.706390 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m00:40:49.706858 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: Close
[0m00:40:49.707213 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m00:40:49.707865 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total'
[0m00:40:49.708146 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m00:40:49.711974 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m00:40:49.708794 [info ] [Thread-1 (]: 40 of 91 PASS accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6  [[32mPASS[0m in 0.10s]
[0m00:40:49.712701 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: Close
[0m00:40:49.713182 [info ] [Thread-3 (]: 45 of 91 START test not_null_stg_yellow_trips_dropoff_location_id .............. [RUN]
[0m00:40:49.714266 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m00:40:49.715012 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048)
[0m00:40:49.715542 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m00:40:49.716171 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m00:40:49.716704 [info ] [Thread-1 (]: 46 of 91 START test not_null_stg_yellow_trips_fare_amount ...................... [RUN]
[0m00:40:49.720713 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m00:40:49.721405 [info ] [Thread-2 (]: 43 of 91 PASS assert_fare_not_exceeds_total .................................... [[32mPASS[0m in 0.11s]
[0m00:40:49.721847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97)
[0m00:40:49.722575 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m00:40:49.722973 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m00:40:49.723400 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m00:40:49.725723 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m00:40:49.726292 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m00:40:49.729796 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m00:40:49.730776 [info ] [Thread-2 (]: 47 of 91 START test not_null_stg_yellow_trips_pickup_datetime .................. [RUN]
[0m00:40:49.731366 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m00:40:49.731741 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed)
[0m00:40:49.734030 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m00:40:49.734792 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m00:40:49.738208 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m00:40:49.739559 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m00:40:49.739963 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m00:40:49.742307 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m00:40:49.743040 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: BEGIN
[0m00:40:49.743825 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m00:40:49.744094 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:49.744678 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: BEGIN
[0m00:40:49.745430 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m00:40:49.746117 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:49.752173 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m00:40:49.753836 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m00:40:49.754373 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: BEGIN
[0m00:40:49.754797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:49.757167 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m00:40:49.757592 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: BEGIN
[0m00:40:49.757960 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:40:49.764435 [debug] [Thread-4 (]: SQL status: OK in 0.020 seconds
[0m00:40:49.764989 [debug] [Thread-3 (]: SQL status: OK in 0.019 seconds
[0m00:40:49.765382 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m00:40:49.765688 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m00:40:49.765942 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m00:40:49.766493 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m00:40:49.766914 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m00:40:49.767318 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_datetime
from "dev"."main"."stg_yellow_trips"
where dropoff_datetime is null



  
  
      
    ) dbt_internal_test
[0m00:40:49.767793 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m00:40:49.768181 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_location_id
from "dev"."main"."stg_yellow_trips"
where dropoff_location_id is null



  
  
      
    ) dbt_internal_test
[0m00:40:49.768654 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fare_amount
from "dev"."main"."stg_yellow_trips"
where fare_amount is null



  
  
      
    ) dbt_internal_test
[0m00:40:49.769362 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "dev"."main"."stg_yellow_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m00:40:49.770136 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:49.770595 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:49.770993 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:49.772068 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: ROLLBACK
[0m00:40:49.772359 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m00:40:49.773625 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: ROLLBACK
[0m00:40:49.774600 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: ROLLBACK
[0m00:40:49.775224 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052'
[0m00:40:49.776319 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: ROLLBACK
[0m00:40:49.777087 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048'
[0m00:40:49.778030 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97'
[0m00:40:49.778682 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: Close
[0m00:40:49.779582 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed'
[0m00:40:49.780348 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: Close
[0m00:40:49.780924 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: Close
[0m00:40:49.781693 [info ] [Thread-4 (]: 44 of 91 PASS not_null_stg_yellow_trips_dropoff_datetime ....................... [[32mPASS[0m in 0.08s]
[0m00:40:49.781994 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: Close
[0m00:40:49.782634 [info ] [Thread-3 (]: 45 of 91 PASS not_null_stg_yellow_trips_dropoff_location_id .................... [[32mPASS[0m in 0.07s]
[0m00:40:49.783143 [info ] [Thread-1 (]: 46 of 91 PASS not_null_stg_yellow_trips_fare_amount ............................ [[32mPASS[0m in 0.06s]
[0m00:40:49.783597 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m00:40:49.784433 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m00:40:49.784941 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m00:40:49.785623 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m00:40:49.786313 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m00:40:49.786929 [info ] [Thread-2 (]: 47 of 91 PASS not_null_stg_yellow_trips_pickup_datetime ........................ [[32mPASS[0m in 0.06s]
[0m00:40:49.787266 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m00:40:49.787794 [info ] [Thread-4 (]: 48 of 91 START test not_null_stg_yellow_trips_pickup_location_id ............... [RUN]
[0m00:40:49.788295 [info ] [Thread-3 (]: 49 of 91 START test not_null_stg_yellow_trips_total_amount ..................... [RUN]
[0m00:40:49.788852 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m00:40:49.789226 [info ] [Thread-1 (]: 50 of 91 START test not_null_stg_yellow_trips_trip_distance_miles .............. [RUN]
[0m00:40:49.789840 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1)
[0m00:40:49.790391 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6)
[0m00:40:49.790847 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m00:40:49.791308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7)
[0m00:40:49.792253 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m00:40:49.792804 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m00:40:49.793241 [info ] [Thread-2 (]: 51 of 91 START test not_null_stg_yellow_trips_trip_id .......................... [RUN]
[0m00:40:49.793646 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m00:40:49.797669 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m00:40:49.800452 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m00:40:49.801236 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1)
[0m00:40:49.804385 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m00:40:49.805536 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m00:40:49.809492 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m00:40:49.814701 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m00:40:49.816939 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m00:40:49.818096 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m00:40:49.820145 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m00:40:49.820513 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m00:40:49.822459 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m00:40:49.822735 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m00:40:49.824726 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m00:40:49.826114 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m00:40:49.826455 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m00:40:49.826747 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: BEGIN
[0m00:40:49.827167 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: BEGIN
[0m00:40:49.827722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:49.829029 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:49.829390 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m00:40:49.830340 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: BEGIN
[0m00:40:49.830653 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:49.831195 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m00:40:49.831555 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: BEGIN
[0m00:40:49.831944 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:40:49.846144 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m00:40:49.846561 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m00:40:49.847007 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m00:40:49.847352 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m00:40:49.847680 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m00:40:49.848278 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m00:40:49.848864 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m00:40:49.849233 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_distance_miles
from "dev"."main"."stg_yellow_trips"
where trip_distance_miles is null



  
  
      
    ) dbt_internal_test
[0m00:40:49.849676 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m00:40:49.850107 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_location_id
from "dev"."main"."stg_yellow_trips"
where pickup_location_id is null



  
  
      
    ) dbt_internal_test
[0m00:40:49.850545 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."stg_yellow_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m00:40:49.851495 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."stg_yellow_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m00:40:49.852570 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:49.852999 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:49.853407 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:49.854581 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: ROLLBACK
[0m00:40:49.854859 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m00:40:49.855804 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: ROLLBACK
[0m00:40:49.856806 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: ROLLBACK
[0m00:40:49.857415 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7'
[0m00:40:49.858735 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: ROLLBACK
[0m00:40:49.859355 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1'
[0m00:40:49.860083 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6'
[0m00:40:49.860479 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: Close
[0m00:40:49.861109 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1'
[0m00:40:49.861545 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: Close
[0m00:40:49.861943 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: Close
[0m00:40:49.862544 [info ] [Thread-1 (]: 50 of 91 PASS not_null_stg_yellow_trips_trip_distance_miles .................... [[32mPASS[0m in 0.07s]
[0m00:40:49.862772 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: Close
[0m00:40:49.863290 [info ] [Thread-4 (]: 48 of 91 PASS not_null_stg_yellow_trips_pickup_location_id ..................... [[32mPASS[0m in 0.07s]
[0m00:40:49.863686 [info ] [Thread-3 (]: 49 of 91 PASS not_null_stg_yellow_trips_total_amount ........................... [[32mPASS[0m in 0.07s]
[0m00:40:49.864251 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m00:40:49.865878 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m00:40:49.866532 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m00:40:49.867234 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m00:40:49.867848 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m00:40:49.868584 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m00:40:49.868334 [info ] [Thread-2 (]: 51 of 91 PASS not_null_stg_yellow_trips_trip_id ................................ [[32mPASS[0m in 0.07s]
[0m00:40:49.868993 [info ] [Thread-1 (]: 52 of 91 START test not_null_stg_yellow_trips_vendor_id ........................ [RUN]
[0m00:40:49.869507 [info ] [Thread-4 (]: 53 of 91 START test unique_stg_yellow_trips_trip_id ............................ [RUN]
[0m00:40:49.869920 [info ] [Thread-3 (]: 54 of 91 START test relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_  [RUN]
[0m00:40:49.870500 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m00:40:49.871134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57)
[0m00:40:49.872155 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1, now test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965)
[0m00:40:49.873773 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6, now test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a)
[0m00:40:49.874566 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m00:40:49.875130 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m00:40:49.875653 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m00:40:49.876231 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m00:40:49.876760 [info ] [Thread-2 (]: 55 of 91 START test relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_  [RUN]
[0m00:40:49.881591 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m00:40:49.884675 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m00:40:49.889048 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m00:40:49.889823 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1, now test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f)
[0m00:40:49.891182 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m00:40:49.894888 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m00:40:49.899085 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m00:40:49.901067 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m00:40:49.902839 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m00:40:49.903183 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m00:40:49.905358 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m00:40:49.907715 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m00:40:49.908049 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m00:40:49.910994 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m00:40:49.912620 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m00:40:49.912989 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m00:40:49.913334 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: BEGIN
[0m00:40:49.913942 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: BEGIN
[0m00:40:49.914486 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:49.915009 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m00:40:49.915378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:49.916132 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: BEGIN
[0m00:40:49.916709 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m00:40:49.916981 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:49.917817 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: BEGIN
[0m00:40:49.918519 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:40:49.931160 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m00:40:49.931554 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m00:40:49.931823 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m00:40:49.932076 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m00:40:49.932325 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m00:40:49.932720 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m00:40:49.933336 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m00:40:49.933724 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_yellow_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:40:49.934111 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m00:40:49.934495 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "dev"."main"."stg_yellow_trips"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m00:40:49.934954 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select dropoff_location_id as from_field
    from "dev"."main"."stg_yellow_trips"
    where dropoff_location_id is not null
),

parent as (
    select location_id as to_field
    from "dev"."main"."stg_taxi_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:40:49.935786 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select pickup_location_id as from_field
    from "dev"."main"."stg_yellow_trips"
    where pickup_location_id is not null
),

parent as (
    select location_id as to_field
    from "dev"."main"."stg_taxi_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:40:49.937261 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:40:49.945029 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: ROLLBACK
[0m00:40:49.946162 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57'
[0m00:40:49.946741 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: Close
[0m00:40:49.947930 [info ] [Thread-1 (]: 52 of 91 PASS not_null_stg_yellow_trips_vendor_id .............................. [[32mPASS[0m in 0.08s]
[0m00:40:49.951330 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m00:40:50.058434 [debug] [Thread-2 (]: SQL status: OK in 0.117 seconds
[0m00:40:50.059179 [debug] [Thread-3 (]: SQL status: OK in 0.119 seconds
[0m00:40:50.060658 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: ROLLBACK
[0m00:40:50.061974 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: ROLLBACK
[0m00:40:50.062738 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f'
[0m00:40:50.063437 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a'
[0m00:40:50.063947 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: Close
[0m00:40:50.064410 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: Close
[0m00:40:50.065221 [info ] [Thread-2 (]: 55 of 91 PASS relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_  [[32mPASS[0m in 0.18s]
[0m00:40:50.069783 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m00:40:50.069245 [info ] [Thread-3 (]: 54 of 91 PASS relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_  [[32mPASS[0m in 0.20s]
[0m00:40:50.071094 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m00:40:50.135238 [debug] [Thread-4 (]: SQL status: OK in 0.200 seconds
[0m00:40:50.136883 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: ROLLBACK
[0m00:40:50.138076 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965'
[0m00:40:50.138686 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: Close
[0m00:40:50.166453 [info ] [Thread-4 (]: 53 of 91 PASS unique_stg_yellow_trips_trip_id .................................. [[32mPASS[0m in 0.29s]
[0m00:40:50.167340 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m00:40:50.169016 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m00:40:50.169729 [info ] [Thread-1 (]: 56 of 91 START sql view model main.int_trip_metrics ............................ [RUN]
[0m00:40:50.170325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57, now model.nyc_taxi_pipeline_00.int_trip_metrics)
[0m00:40:50.170831 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m00:40:50.174228 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m00:40:50.188524 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m00:40:50.191813 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m00:40:50.205871 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m00:40:50.206419 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: BEGIN
[0m00:40:50.206898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:50.223536 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m00:40:50.224142 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m00:40:50.224831 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */

  
  create view "dev"."main"."int_trip_metrics__dbt_tmp" as (
    /*
    Intermediate model: Trip-level enrichment with calculated metrics.
    Uses adapter-dispatched macros for cross-dialect compatibility.
*/

with trips as (
    select * from "dev"."main"."stg_yellow_trips"
),

enriched as (
    select
        trip_id,
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        payment_type_id,
        pickup_datetime,
        dropoff_datetime,
        passenger_count,
        trip_distance_miles,
        store_and_fwd_flag,

        -- calculated: duration in minutes
        
    datediff('minute', pickup_datetime, dropoff_datetime)
 as trip_duration_minutes,

        -- calculated: average speed (avoid division by zero)
        case
            when 
    datediff('minute', pickup_datetime, dropoff_datetime)
 > 0
            then round(
                trip_distance_miles / (
    datediff('minute', pickup_datetime, dropoff_datetime)
 / 60.0),
                2
            )
            else null
        end as avg_speed_mph,

        -- calculated: cost per mile
        case
            when trip_distance_miles > 0
            then round(fare_amount / trip_distance_miles, 2)
            else null
        end as cost_per_mile,

        -- calculated: tip percentage
        case
            when fare_amount > 0
            then round((tip_amount / fare_amount) * 100, 2)
            else null
        end as tip_percentage,

        -- time dimensions (using adapter-dispatched macros)
        date_trunc('day', pickup_datetime)::date as pickup_date,
        extract(hour from pickup_datetime) as pickup_hour,
        
    dayname(pickup_datetime)
 as pickup_day_of_week,
        case
            when extract(dow from pickup_datetime) in (0, 6) then true
            else false
        end as is_weekend,

        -- financials passthrough
        fare_amount,
        extra_amount,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount,
        congestion_surcharge,
        airport_fee

    from trips
)

select *
from enriched
where trip_duration_minutes between 1 and 720
  and (avg_speed_mph is null or avg_speed_mph < 100)
  );

[0m00:40:50.226523 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:50.230281 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m00:40:50.230802 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
alter view "dev"."main"."int_trip_metrics__dbt_tmp" rename to "int_trip_metrics"
[0m00:40:50.232311 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:50.233592 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: COMMIT
[0m00:40:50.234168 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m00:40:50.234610 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: COMMIT
[0m00:40:50.241221 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m00:40:50.243433 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m00:40:50.243958 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
drop view if exists "dev"."main"."int_trip_metrics__dbt_backup" cascade
[0m00:40:50.244996 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:50.246334 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: Close
[0m00:40:50.278593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb237131d0>]}
[0m00:40:50.279639 [info ] [Thread-1 (]: 56 of 91 OK created sql view model main.int_trip_metrics ....................... [[32mOK[0m in 0.11s]
[0m00:40:50.280337 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m00:40:50.281446 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m00:40:50.281814 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m00:40:50.282192 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m00:40:50.282588 [info ] [Thread-3 (]: 57 of 91 START test assert_trip_duration_positive .............................. [RUN]
[0m00:40:50.283033 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m00:40:50.283393 [info ] [Thread-4 (]: 58 of 91 START test dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0  [RUN]
[0m00:40:50.283982 [info ] [Thread-2 (]: 59 of 91 START test dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1  [RUN]
[0m00:40:50.284782 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a, now test.nyc_taxi_pipeline_00.assert_trip_duration_positive)
[0m00:40:50.285307 [info ] [Thread-1 (]: 60 of 91 START test not_null_int_trip_metrics_is_weekend ....................... [RUN]
[0m00:40:50.285942 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574)
[0m00:40:50.286533 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718)
[0m00:40:50.287056 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m00:40:50.288511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_trip_metrics, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed)
[0m00:40:50.289207 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m00:40:50.289682 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m00:40:50.292829 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m00:40:50.293582 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m00:40:50.297738 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m00:40:50.301672 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m00:40:50.306538 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m00:40:50.311663 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m00:40:50.314098 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m00:40:50.319394 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m00:40:50.321986 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m00:40:50.323220 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m00:40:50.323908 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: BEGIN
[0m00:40:50.324384 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m00:40:50.324883 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:50.325366 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m00:40:50.327912 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m00:40:50.332121 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m00:40:50.337821 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m00:40:50.338491 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: BEGIN
[0m00:40:50.339103 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:40:50.339858 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m00:40:50.340597 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: BEGIN
[0m00:40:50.341108 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:50.342743 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m00:40:50.343242 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: BEGIN
[0m00:40:50.343677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:50.349919 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m00:40:50.350396 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m00:40:50.350823 [debug] [Thread-3 (]: SQL status: OK in 0.026 seconds
[0m00:40:50.351106 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m00:40:50.351407 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m00:40:50.351942 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m00:40:50.352473 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m00:40:50.353026 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m00:40:50.353439 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_trip_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not trip_duration_minutes >= 1
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not trip_duration_minutes <= 720
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:40:50.353865 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_trip_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:40:50.354598 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
    Singular test: No trip should have negative duration.
*/

select
    trip_id,
    pickup_datetime,
    dropoff_datetime,
    trip_duration_minutes
from "dev"."main"."int_trip_metrics"
where trip_duration_minutes < 0
  
  
      
    ) dbt_internal_test
[0m00:40:50.355046 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."int_trip_metrics"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m00:40:50.358298 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:40:50.358790 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:50.361229 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: ROLLBACK
[0m00:40:50.362466 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: ROLLBACK
[0m00:40:50.363146 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed'
[0m00:40:50.365251 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.assert_trip_duration_positive'
[0m00:40:50.367525 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: Close
[0m00:40:50.369750 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: Close
[0m00:40:50.372747 [info ] [Thread-1 (]: 60 of 91 PASS not_null_int_trip_metrics_is_weekend ............................. [[32mPASS[0m in 0.08s]
[0m00:40:50.373788 [info ] [Thread-3 (]: 57 of 91 PASS assert_trip_duration_positive .................................... [[32mPASS[0m in 0.09s]
[0m00:40:50.375980 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m00:40:50.378580 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m00:40:50.381588 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m00:40:50.383072 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m00:40:50.384723 [info ] [Thread-1 (]: 61 of 91 START test not_null_int_trip_metrics_pickup_date ...................... [RUN]
[0m00:40:50.386929 [info ] [Thread-3 (]: 62 of 91 START test not_null_int_trip_metrics_pickup_hour ...................... [RUN]
[0m00:40:50.389541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3)
[0m00:40:50.391893 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.assert_trip_duration_positive, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082)
[0m00:40:50.393907 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m00:40:50.396052 [debug] [Thread-4 (]: SQL status: OK in 0.040 seconds
[0m00:40:50.396808 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m00:40:50.401665 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m00:40:50.404476 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: ROLLBACK
[0m00:40:50.408646 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m00:40:50.412041 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574'
[0m00:40:50.412700 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: Close
[0m00:40:50.413816 [info ] [Thread-4 (]: 58 of 91 PASS dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0 ..... [[32mPASS[0m in 0.13s]
[0m00:40:50.415227 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m00:40:50.416661 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m00:40:50.417109 [info ] [Thread-4 (]: 63 of 91 START test not_null_int_trip_metrics_trip_duration_minutes ............ [RUN]
[0m00:40:50.417655 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c)
[0m00:40:50.417931 [debug] [Thread-2 (]: SQL status: OK in 0.062 seconds
[0m00:40:50.418223 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m00:40:50.419811 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: ROLLBACK
[0m00:40:50.423253 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m00:40:50.424364 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718'
[0m00:40:50.425278 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m00:40:50.425585 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: Close
[0m00:40:50.425915 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m00:40:50.427749 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m00:40:50.430284 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m00:40:50.432640 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m00:40:50.435057 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m00:40:50.435712 [info ] [Thread-2 (]: 59 of 91 PASS dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1  [[32mPASS[0m in 0.15s]
[0m00:40:50.436429 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m00:40:50.436835 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m00:40:50.437273 [info ] [Thread-2 (]: 64 of 91 START test not_null_int_trip_metrics_trip_id .......................... [RUN]
[0m00:40:50.437721 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f)
[0m00:40:50.438247 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m00:40:50.442185 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m00:40:50.443875 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m00:40:50.444394 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m00:40:50.444707 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: BEGIN
[0m00:40:50.445025 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m00:40:50.445482 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: BEGIN
[0m00:40:50.445978 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:50.446399 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: BEGIN
[0m00:40:50.446834 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:50.447666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:50.451508 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m00:40:50.453763 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m00:40:50.462365 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m00:40:50.462859 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: BEGIN
[0m00:40:50.463266 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:40:50.465015 [debug] [Thread-3 (]: SQL status: OK in 0.019 seconds
[0m00:40:50.465347 [debug] [Thread-4 (]: SQL status: OK in 0.018 seconds
[0m00:40:50.465679 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m00:40:50.466030 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m00:40:50.466336 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m00:40:50.466571 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m00:40:50.467107 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m00:40:50.467731 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."int_trip_metrics"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m00:40:50.468347 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m00:40:50.468937 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_duration_minutes
from "dev"."main"."int_trip_metrics"
where trip_duration_minutes is null



  
  
      
    ) dbt_internal_test
[0m00:40:50.469494 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_trip_metrics"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m00:40:50.470520 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."int_trip_metrics"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m00:40:50.472144 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:50.472907 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:50.473290 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m00:40:50.475394 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: ROLLBACK
[0m00:40:50.477470 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: ROLLBACK
[0m00:40:50.479391 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: ROLLBACK
[0m00:40:50.480969 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082'
[0m00:40:50.482346 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3'
[0m00:40:50.485486 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f'
[0m00:40:50.487877 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: Close
[0m00:40:50.490171 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: Close
[0m00:40:50.492333 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: Close
[0m00:40:50.496525 [info ] [Thread-3 (]: 62 of 91 PASS not_null_int_trip_metrics_pickup_hour ............................ [[32mPASS[0m in 0.10s]
[0m00:40:50.498027 [info ] [Thread-1 (]: 61 of 91 PASS not_null_int_trip_metrics_pickup_date ............................ [[32mPASS[0m in 0.11s]
[0m00:40:50.501129 [info ] [Thread-2 (]: 64 of 91 PASS not_null_int_trip_metrics_trip_id ................................ [[32mPASS[0m in 0.06s]
[0m00:40:50.502480 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m00:40:50.505866 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m00:40:50.507784 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m00:40:50.534638 [debug] [Thread-4 (]: SQL status: OK in 0.063 seconds
[0m00:40:50.536465 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: ROLLBACK
[0m00:40:50.537249 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c'
[0m00:40:50.537843 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: Close
[0m00:40:50.544314 [info ] [Thread-4 (]: 63 of 91 PASS not_null_int_trip_metrics_trip_duration_minutes .................. [[32mPASS[0m in 0.13s]
[0m00:40:50.545752 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m00:40:50.546861 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.int_daily_summary
[0m00:40:50.547157 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m00:40:50.547448 [debug] [Thread-2 (]: Began running node model.nyc_taxi_pipeline_00.fct_trips
[0m00:40:50.547862 [info ] [Thread-3 (]: 65 of 91 START sql view model main.int_daily_summary ........................... [RUN]
[0m00:40:50.548448 [info ] [Thread-1 (]: 66 of 91 START sql view model main.int_hourly_patterns ......................... [RUN]
[0m00:40:50.549114 [info ] [Thread-2 (]: 67 of 91 START sql incremental model main.fct_trips ............................ [RUN]
[0m00:40:50.549731 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082, now model.nyc_taxi_pipeline_00.int_daily_summary)
[0m00:40:50.550219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3, now model.nyc_taxi_pipeline_00.int_hourly_patterns)
[0m00:40:50.550679 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f, now model.nyc_taxi_pipeline_00.fct_trips)
[0m00:40:50.551171 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.int_daily_summary
[0m00:40:50.551583 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m00:40:50.551949 [debug] [Thread-2 (]: Began compiling node model.nyc_taxi_pipeline_00.fct_trips
[0m00:40:50.556176 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m00:40:50.558813 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m00:40:50.562572 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.fct_trips"
[0m00:40:50.567765 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.int_daily_summary
[0m00:40:50.570980 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m00:40:50.572629 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m00:40:50.575895 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m00:40:50.576379 [debug] [Thread-2 (]: Began executing node model.nyc_taxi_pipeline_00.fct_trips
[0m00:40:50.600277 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m00:40:50.600794 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m00:40:50.601217 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
DESCRIBE (select * from (
        /*
    Fact table: Fully enriched trip records with location names.
    Incremental with delete+insert strategy.
*/



with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

pickup_locations as (
    select * from "dev"."main"."dim_locations"
),

dropoff_locations as (
    select * from "dev"."main"."dim_locations"
),

final as (
    select
        t.trip_id,
        t.vendor_id,
        t.rate_code_id,
        t.payment_type_id,
        t.pickup_location_id,
        t.dropoff_location_id,
        t.pickup_datetime,
        t.dropoff_datetime,
        t.pickup_date,
        t.pickup_hour,
        t.pickup_day_of_week,
        t.is_weekend,
        t.passenger_count,
        t.trip_distance_miles,
        t.trip_duration_minutes,
        t.avg_speed_mph,
        t.cost_per_mile,
        t.fare_amount,
        t.extra_amount,
        t.mta_tax,
        t.tip_amount,
        t.tip_percentage,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.congestion_surcharge,
        t.airport_fee,

        -- enriched from dimensions
        pu.borough as pickup_borough,
        pu.zone_name as pickup_zone,
        do_loc.borough as dropoff_borough,
        do_loc.zone_name as dropoff_zone

    from trip_metrics t
    left join pickup_locations pu
        on t.pickup_location_id = pu.location_id
    left join dropoff_locations do_loc
        on t.dropoff_location_id = do_loc.location_id

    
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:40:50.601737 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m00:40:50.602110 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: BEGIN
[0m00:40:50.602779 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:40:50.603237 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: BEGIN
[0m00:40:50.603657 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:50.604452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:50.623091 [debug] [Thread-3 (]: SQL status: OK in 0.019 seconds
[0m00:40:50.623502 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m00:40:50.623850 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m00:40:50.624231 [debug] [Thread-2 (]: SQL status: OK in 0.021 seconds
[0m00:40:50.624891 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m00:40:50.625675 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */

  
  create view "dev"."main"."int_daily_summary__dbt_tmp" as (
    /*
    Intermediate model: Daily aggregated trip and revenue metrics.
    One row per day with counts, averages, and revenue totals.
*/

with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

daily_agg as (
    select
        pickup_date,
        pickup_day_of_week,
        is_weekend,

        count(*) as total_trips,
        sum(passenger_count) as total_passengers,

        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(avg(avg_speed_mph), 2) as avg_speed_mph,

        round(sum(fare_amount), 2) as total_fare_revenue,
        round(sum(tip_amount), 2) as total_tip_revenue,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_trip_revenue,
        round(avg(tip_percentage), 2) as avg_tip_percentage,

        count(case when payment_type_id = 1 then 1 end) as credit_card_trips,
        count(case when payment_type_id = 2 then 1 end) as cash_trips

    from trip_metrics
    group by pickup_date, pickup_day_of_week, is_weekend
)

select * from daily_agg
  );

[0m00:40:50.628545 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m00:40:50.628895 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */

  
  create view "dev"."main"."int_hourly_patterns__dbt_tmp" as (
    /*
    Intermediate model: Hourly trip patterns by date.
    One row per date + hour combination.
*/

with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

hourly_agg as (
    select
        pickup_date,
        pickup_hour,
        pickup_day_of_week,
        is_weekend,

        count(*) as total_trips,
        round(avg(trip_distance_miles), 2) as avg_distance,
        round(avg(trip_duration_minutes), 2) as avg_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue

    from trip_metrics
    group by pickup_date, pickup_hour, pickup_day_of_week, is_weekend
)

select * from hourly_agg
  );

[0m00:40:50.630317 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as varchar)
 as trip_id, 
      
    cast(null as integer)
 as vendor_id, 
      
    cast(null as integer)
 as rate_code_id, 
      
    cast(null as integer)
 as payment_type_id, 
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as integer)
 as dropoff_location_id, 
      
    cast(null as timestamp)
 as pickup_datetime, 
      
    cast(null as timestamp)
 as dropoff_datetime, 
      
    cast(null as date)
 as pickup_date, 
      
    cast(null as bigint)
 as pickup_hour, 
      
    cast(null as varchar)
 as pickup_day_of_week, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as integer)
 as passenger_count, 
      
    cast(null as double)
 as trip_distance_miles, 
      
    cast(null as bigint)
 as trip_duration_minutes, 
      
    cast(null as double)
 as avg_speed_mph, 
      
    cast(null as double)
 as cost_per_mile, 
      
    cast(null as decimal(10,2))
 as fare_amount, 
      
    cast(null as decimal(10,2))
 as extra_amount, 
      
    cast(null as decimal(10,2))
 as mta_tax, 
      
    cast(null as decimal(10,2))
 as tip_amount, 
      
    cast(null as double)
 as tip_percentage, 
      
    cast(null as decimal(10,2))
 as tolls_amount, 
      
    cast(null as decimal(10,2))
 as improvement_surcharge, 
      
    cast(null as decimal(10,2))
 as total_amount, 
      
    cast(null as decimal(10,2))
 as congestion_surcharge, 
      
    cast(null as decimal(10,2))
 as airport_fee, 
      
    cast(null as varchar)
 as pickup_borough, 
      
    cast(null as varchar)
 as pickup_zone, 
      
    cast(null as varchar)
 as dropoff_borough, 
      
    cast(null as varchar)
 as dropoff_zone
    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:40:50.631940 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:50.632356 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:50.632601 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m00:40:50.635787 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m00:40:50.638134 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m00:40:50.641790 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.fct_trips"
[0m00:40:50.642201 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
alter view "dev"."main"."int_daily_summary__dbt_tmp" rename to "int_daily_summary"
[0m00:40:50.642777 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
alter view "dev"."main"."int_hourly_patterns__dbt_tmp" rename to "int_hourly_patterns"
[0m00:40:50.644562 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:50.644930 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:50.646346 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: COMMIT
[0m00:40:50.647489 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: COMMIT
[0m00:40:50.648045 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m00:40:50.648457 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m00:40:50.648998 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: COMMIT
[0m00:40:50.649549 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: COMMIT
[0m00:40:50.652008 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m00:40:50.652488 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: BEGIN
[0m00:40:50.653295 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m00:40:50.653675 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m00:40:50.654137 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */

  
    
    
      
    

    create  table
      "dev"."main"."fct_trips"
  
  (
    trip_id varchar,
    vendor_id integer,
    rate_code_id integer,
    payment_type_id integer,
    pickup_location_id integer,
    dropoff_location_id integer,
    pickup_datetime timestamp,
    dropoff_datetime timestamp,
    pickup_date date,
    pickup_hour bigint,
    pickup_day_of_week varchar,
    is_weekend boolean,
    passenger_count integer,
    trip_distance_miles double,
    trip_duration_minutes bigint,
    avg_speed_mph double,
    cost_per_mile double,
    fare_amount decimal(10,2),
    extra_amount decimal(10,2),
    mta_tax decimal(10,2),
    tip_amount decimal(10,2),
    tip_percentage double,
    tolls_amount decimal(10,2),
    improvement_surcharge decimal(10,2),
    total_amount decimal(10,2),
    congestion_surcharge decimal(10,2),
    airport_fee decimal(10,2),
    pickup_borough varchar,
    pickup_zone varchar,
    dropoff_borough varchar,
    dropoff_zone varchar
    
    )
 ;
    insert into "dev"."main"."fct_trips" 
  (
    
      
      trip_id ,
    
      
      vendor_id ,
    
      
      rate_code_id ,
    
      
      payment_type_id ,
    
      
      pickup_location_id ,
    
      
      dropoff_location_id ,
    
      
      pickup_datetime ,
    
      
      dropoff_datetime ,
    
      
      pickup_date ,
    
      
      pickup_hour ,
    
      
      pickup_day_of_week ,
    
      
      is_weekend ,
    
      
      passenger_count ,
    
      
      trip_distance_miles ,
    
      
      trip_duration_minutes ,
    
      
      avg_speed_mph ,
    
      
      cost_per_mile ,
    
      
      fare_amount ,
    
      
      extra_amount ,
    
      
      mta_tax ,
    
      
      tip_amount ,
    
      
      tip_percentage ,
    
      
      tolls_amount ,
    
      
      improvement_surcharge ,
    
      
      total_amount ,
    
      
      congestion_surcharge ,
    
      
      airport_fee ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      dropoff_borough ,
    
      
      dropoff_zone 
    
  )
 (
      
    select trip_id, vendor_id, rate_code_id, payment_type_id, pickup_location_id, dropoff_location_id, pickup_datetime, dropoff_datetime, pickup_date, pickup_hour, pickup_day_of_week, is_weekend, passenger_count, trip_distance_miles, trip_duration_minutes, avg_speed_mph, cost_per_mile, fare_amount, extra_amount, mta_tax, tip_amount, tip_percentage, tolls_amount, improvement_surcharge, total_amount, congestion_surcharge, airport_fee, pickup_borough, pickup_zone, dropoff_borough, dropoff_zone
    from (
        /*
    Fact table: Fully enriched trip records with location names.
    Incremental with delete+insert strategy.
*/



with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

pickup_locations as (
    select * from "dev"."main"."dim_locations"
),

dropoff_locations as (
    select * from "dev"."main"."dim_locations"
),

final as (
    select
        t.trip_id,
        t.vendor_id,
        t.rate_code_id,
        t.payment_type_id,
        t.pickup_location_id,
        t.dropoff_location_id,
        t.pickup_datetime,
        t.dropoff_datetime,
        t.pickup_date,
        t.pickup_hour,
        t.pickup_day_of_week,
        t.is_weekend,
        t.passenger_count,
        t.trip_distance_miles,
        t.trip_duration_minutes,
        t.avg_speed_mph,
        t.cost_per_mile,
        t.fare_amount,
        t.extra_amount,
        t.mta_tax,
        t.tip_amount,
        t.tip_percentage,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.congestion_surcharge,
        t.airport_fee,

        -- enriched from dimensions
        pu.borough as pickup_borough,
        pu.zone_name as pickup_zone,
        do_loc.borough as dropoff_borough,
        do_loc.zone_name as dropoff_zone

    from trip_metrics t
    left join pickup_locations pu
        on t.pickup_location_id = pu.location_id
    left join dropoff_locations do_loc
        on t.dropoff_location_id = do_loc.location_id

    
)

select * from final
    ) as model_subq
    );
  
  
  
[0m00:40:50.656669 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m00:40:50.658977 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m00:40:50.659341 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m00:40:50.659749 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
drop view if exists "dev"."main"."int_daily_summary__dbt_backup" cascade
[0m00:40:50.662103 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m00:40:50.664153 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:50.666246 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
drop view if exists "dev"."main"."int_hourly_patterns__dbt_backup" cascade
[0m00:40:50.670047 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: Close
[0m00:40:50.673200 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:50.674120 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb23712f60>]}
[0m00:40:50.677796 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: Close
[0m00:40:50.680559 [info ] [Thread-3 (]: 65 of 91 OK created sql view model main.int_daily_summary ...................... [[32mOK[0m in 0.12s]
[0m00:40:50.683288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb237c7f20>]}
[0m00:40:50.684973 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.int_daily_summary
[0m00:40:50.688108 [info ] [Thread-1 (]: 66 of 91 OK created sql view model main.int_hourly_patterns .................... [[32mOK[0m in 0.13s]
[0m00:40:50.691883 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m00:40:50.692338 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m00:40:50.693796 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m00:40:50.695924 [info ] [Thread-4 (]: 68 of 91 START test dbt_utils_accepted_range_int_daily_summary_total_trips__0 .. [RUN]
[0m00:40:50.699176 [info ] [Thread-3 (]: 69 of 91 START test not_null_int_daily_summary_pickup_date ..................... [RUN]
[0m00:40:50.702683 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m00:40:50.705745 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863)
[0m00:40:50.709642 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_daily_summary, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686)
[0m00:40:50.712609 [info ] [Thread-1 (]: 70 of 91 START test not_null_int_daily_summary_total_revenue ................... [RUN]
[0m00:40:50.716713 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m00:40:50.718839 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m00:40:50.721825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_hourly_patterns, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50)
[0m00:40:50.728607 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m00:40:50.734940 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m00:40:50.737965 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m00:40:50.749061 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m00:40:50.786570 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m00:40:50.790392 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m00:40:50.792575 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m00:40:50.801006 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m00:40:50.801529 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m00:40:50.809748 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m00:40:50.821063 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m00:40:50.821810 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: BEGIN
[0m00:40:50.823563 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:50.825735 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:40:50.826495 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m00:40:50.826950 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m00:40:50.828459 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: BEGIN
[0m00:40:50.829378 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_daily_summary"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m00:40:50.830325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:50.837068 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m00:40:50.837659 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m00:40:50.837988 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: BEGIN
[0m00:40:50.838634 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m00:40:50.839037 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m00:40:50.847786 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:50.849959 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "dev"."main"."int_daily_summary"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m00:40:50.858779 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m00:40:50.857605 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: ROLLBACK
[0m00:40:50.860153 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m00:40:50.863049 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_daily_summary"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_trips >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:40:50.862241 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686'
[0m00:40:50.868128 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: Close
[0m00:40:50.873204 [info ] [Thread-3 (]: 69 of 91 PASS not_null_int_daily_summary_pickup_date ........................... [[32mPASS[0m in 0.16s]
[0m00:40:50.883004 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m00:40:50.885406 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m00:40:50.888953 [info ] [Thread-3 (]: 71 of 91 START test not_null_int_daily_summary_total_trips ..................... [RUN]
[0m00:40:50.894101 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10)
[0m00:40:50.896156 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m00:40:50.903085 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m00:40:50.932186 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m00:40:50.936249 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m00:40:50.980304 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m00:40:50.983872 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: BEGIN
[0m00:40:50.986349 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:50.989180 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m00:40:50.991332 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m00:40:50.993431 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_trips
from "dev"."main"."int_daily_summary"
where total_trips is null



  
  
      
    ) dbt_internal_test
[0m00:40:51.315338 [debug] [Thread-3 (]: SQL status: OK in 0.314 seconds
[0m00:40:51.317902 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: ROLLBACK
[0m00:40:51.318954 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10'
[0m00:40:51.319460 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: Close
[0m00:40:51.320371 [info ] [Thread-3 (]: 71 of 91 PASS not_null_int_daily_summary_total_trips ........................... [[32mPASS[0m in 0.43s]
[0m00:40:51.321004 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m00:40:51.321700 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m00:40:51.322327 [info ] [Thread-3 (]: 72 of 91 START test unique_int_daily_summary_pickup_date ....................... [RUN]
[0m00:40:51.323010 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10, now test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e)
[0m00:40:51.323429 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m00:40:51.327347 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m00:40:51.340884 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m00:40:51.343440 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m00:40:51.357030 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m00:40:51.357798 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: BEGIN
[0m00:40:51.358481 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:51.359719 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:51.360425 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m00:40:51.360908 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pickup_date as unique_field,
    count(*) as n_records

from "dev"."main"."int_daily_summary"
where pickup_date is not null
group by pickup_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:40:51.412721 [debug] [Thread-1 (]: SQL status: OK in 0.553 seconds
[0m00:40:51.415379 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: ROLLBACK
[0m00:40:51.416567 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50'
[0m00:40:51.417192 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: Close
[0m00:40:51.418077 [info ] [Thread-1 (]: 70 of 91 PASS not_null_int_daily_summary_total_revenue ......................... [[32mPASS[0m in 0.70s]
[0m00:40:51.418919 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m00:40:51.419838 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m00:40:51.420351 [info ] [Thread-1 (]: 73 of 91 START test dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0  [RUN]
[0m00:40:51.420966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe)
[0m00:40:51.421415 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m00:40:51.425285 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m00:40:51.436425 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m00:40:51.439187 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m00:40:51.450098 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m00:40:51.450739 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: BEGIN
[0m00:40:51.451345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:51.452409 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:51.452954 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m00:40:51.453361 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_hourly_patterns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:40:51.467651 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m00:40:51.469297 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: ROLLBACK
[0m00:40:51.470312 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe'
[0m00:40:51.470988 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: Close
[0m00:40:51.471977 [info ] [Thread-1 (]: 73 of 91 PASS dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0 .. [[32mPASS[0m in 0.05s]
[0m00:40:51.472717 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m00:40:51.473284 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m00:40:51.473803 [info ] [Thread-1 (]: 74 of 91 START test not_null_int_hourly_patterns_pickup_date ................... [RUN]
[0m00:40:51.474466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2)
[0m00:40:51.474923 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m00:40:51.479538 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m00:40:51.482629 [debug] [Thread-4 (]: SQL status: OK in 0.618 seconds
[0m00:40:51.485415 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: ROLLBACK
[0m00:40:51.487762 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863'
[0m00:40:51.488642 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: Close
[0m00:40:51.489956 [info ] [Thread-4 (]: 68 of 91 PASS dbt_utils_accepted_range_int_daily_summary_total_trips__0 ........ [[32mPASS[0m in 0.78s]
[0m00:40:51.491206 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m00:40:51.491813 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m00:40:51.492407 [info ] [Thread-4 (]: 75 of 91 START test not_null_int_hourly_patterns_pickup_hour ................... [RUN]
[0m00:40:51.493205 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d)
[0m00:40:51.493746 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m00:40:51.494160 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m00:40:51.497601 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m00:40:51.502684 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m00:40:51.513601 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m00:40:51.514251 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m00:40:51.517240 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m00:40:51.517870 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: BEGIN
[0m00:40:51.518813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:51.519729 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:51.520219 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m00:40:51.520684 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_hourly_patterns"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m00:40:51.523300 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:40:51.525163 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: ROLLBACK
[0m00:40:51.526134 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2'
[0m00:40:51.526670 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: Close
[0m00:40:51.527858 [info ] [Thread-1 (]: 74 of 91 PASS not_null_int_hourly_patterns_pickup_date ......................... [[32mPASS[0m in 0.05s]
[0m00:40:51.528721 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m00:40:51.529379 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m00:40:51.529925 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: BEGIN
[0m00:40:51.530538 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m00:40:51.531098 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:51.531689 [info ] [Thread-1 (]: 76 of 91 START test not_null_int_hourly_patterns_total_trips ................... [RUN]
[0m00:40:51.532849 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m00:40:51.533338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf)
[0m00:40:51.533966 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m00:40:51.534582 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m00:40:51.535086 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."int_hourly_patterns"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m00:40:51.538665 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m00:40:51.542345 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m00:40:51.544269 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: ROLLBACK
[0m00:40:51.545199 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d'
[0m00:40:51.545783 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: Close
[0m00:40:51.546592 [info ] [Thread-4 (]: 75 of 91 PASS not_null_int_hourly_patterns_pickup_hour ......................... [[32mPASS[0m in 0.05s]
[0m00:40:51.547184 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m00:40:51.550814 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m00:40:51.553112 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m00:40:51.563099 [debug] [Thread-3 (]: SQL status: OK in 0.201 seconds
[0m00:40:51.564732 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: ROLLBACK
[0m00:40:51.565095 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m00:40:51.565992 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e'
[0m00:40:51.566692 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: BEGIN
[0m00:40:51.567162 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: Close
[0m00:40:51.567727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:51.568560 [info ] [Thread-3 (]: 72 of 91 PASS unique_int_daily_summary_pickup_date ............................. [[32mPASS[0m in 0.25s]
[0m00:40:51.569387 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:40:51.569810 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m00:40:51.570299 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m00:40:51.571134 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_trips
from "dev"."main"."int_hourly_patterns"
where total_trips is null



  
  
      
    ) dbt_internal_test
[0m00:40:51.571531 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m00:40:51.572520 [info ] [Thread-4 (]: 77 of 91 START sql table model main.mart_daily_revenue ......................... [RUN]
[0m00:40:51.573114 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d, now model.nyc_taxi_pipeline_00.mart_daily_revenue)
[0m00:40:51.573570 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m00:40:51.577274 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m00:40:51.595779 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m00:40:51.598955 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m00:40:51.599753 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Daily revenue metrics with running totals.
*/

with daily as (
    select * from "dev"."main"."int_daily_summary"
),

dates as (
    select * from "dev"."main"."dim_dates"
),

final as (
    select
        d.date_key,
        d.day_of_week_name,
        d.is_weekend,
        d.is_holiday,
        d.week_of_year,

        daily.total_trips,
        daily.total_passengers,
        daily.total_fare_revenue,
        daily.total_tip_revenue,
        daily.total_revenue,
        daily.avg_trip_revenue,
        daily.avg_tip_percentage,
        daily.credit_card_trips,
        daily.cash_trips,
        daily.avg_trip_distance,
        daily.avg_trip_duration_min,

        -- running total
        sum(daily.total_revenue) over (order by d.date_key) as cumulative_revenue,

        -- day-over-day change
        daily.total_revenue - lag(daily.total_revenue) over (order by d.date_key) as revenue_change_vs_prior_day

    from daily
    inner join dates d
        on daily.pickup_date = d.date_key
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:40:51.600471 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:51.603505 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m00:40:51.607698 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m00:40:51.608577 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as date_key, 
      
    cast(null as varchar)
 as day_of_week_name, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as boolean)
 as is_holiday, 
      
    cast(null as bigint)
 as week_of_year, 
      
    cast(null as bigint)
 as total_trips, 
      
    cast(null as hugeint)
 as total_passengers, 
      
    cast(null as decimal(38,2))
 as total_fare_revenue, 
      
    cast(null as decimal(38,2))
 as total_tip_revenue, 
      
    cast(null as decimal(38,2))
 as total_revenue, 
      
    cast(null as double)
 as avg_trip_revenue, 
      
    cast(null as double)
 as avg_tip_percentage, 
      
    cast(null as bigint)
 as credit_card_trips, 
      
    cast(null as bigint)
 as cash_trips, 
      
    cast(null as double)
 as avg_trip_distance, 
      
    cast(null as double)
 as avg_trip_duration_min, 
      
    cast(null as decimal(38,2))
 as cumulative_revenue, 
      
    cast(null as decimal(38,2))
 as revenue_change_vs_prior_day
    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:40:51.610221 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:51.613088 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m00:40:51.631488 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m00:40:51.632145 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: BEGIN
[0m00:40:51.633118 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m00:40:51.633691 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m00:40:51.634426 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_daily_revenue__dbt_tmp"
  
  (
    date_key date,
    day_of_week_name varchar,
    is_weekend boolean,
    is_holiday boolean,
    week_of_year bigint,
    total_trips bigint,
    total_passengers hugeint,
    total_fare_revenue decimal(38,2),
    total_tip_revenue decimal(38,2),
    total_revenue decimal(38,2),
    avg_trip_revenue double,
    avg_tip_percentage double,
    credit_card_trips bigint,
    cash_trips bigint,
    avg_trip_distance double,
    avg_trip_duration_min double,
    cumulative_revenue decimal(38,2),
    revenue_change_vs_prior_day decimal(38,2)
    
    )
 ;
    insert into "dev"."main"."mart_daily_revenue__dbt_tmp" 
  (
    
      
      date_key ,
    
      
      day_of_week_name ,
    
      
      is_weekend ,
    
      
      is_holiday ,
    
      
      week_of_year ,
    
      
      total_trips ,
    
      
      total_passengers ,
    
      
      total_fare_revenue ,
    
      
      total_tip_revenue ,
    
      
      total_revenue ,
    
      
      avg_trip_revenue ,
    
      
      avg_tip_percentage ,
    
      
      credit_card_trips ,
    
      
      cash_trips ,
    
      
      avg_trip_distance ,
    
      
      avg_trip_duration_min ,
    
      
      cumulative_revenue ,
    
      
      revenue_change_vs_prior_day 
    
  )
 (
      
    select date_key, day_of_week_name, is_weekend, is_holiday, week_of_year, total_trips, total_passengers, total_fare_revenue, total_tip_revenue, total_revenue, avg_trip_revenue, avg_tip_percentage, credit_card_trips, cash_trips, avg_trip_distance, avg_trip_duration_min, cumulative_revenue, revenue_change_vs_prior_day
    from (
        /*
    Analytics mart: Daily revenue metrics with running totals.
*/

with daily as (
    select * from "dev"."main"."int_daily_summary"
),

dates as (
    select * from "dev"."main"."dim_dates"
),

final as (
    select
        d.date_key,
        d.day_of_week_name,
        d.is_weekend,
        d.is_holiday,
        d.week_of_year,

        daily.total_trips,
        daily.total_passengers,
        daily.total_fare_revenue,
        daily.total_tip_revenue,
        daily.total_revenue,
        daily.avg_trip_revenue,
        daily.avg_tip_percentage,
        daily.credit_card_trips,
        daily.cash_trips,
        daily.avg_trip_distance,
        daily.avg_trip_duration_min,

        -- running total
        sum(daily.total_revenue) over (order by d.date_key) as cumulative_revenue,

        -- day-over-day change
        daily.total_revenue - lag(daily.total_revenue) over (order by d.date_key) as revenue_change_vs_prior_day

    from daily
    inner join dates d
        on daily.pickup_date = d.date_key
)

select * from final
    ) as model_subq
    );
  
  
[0m00:40:51.716046 [debug] [Thread-1 (]: SQL status: OK in 0.144 seconds
[0m00:40:51.718190 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: ROLLBACK
[0m00:40:51.719303 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf'
[0m00:40:51.719895 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: Close
[0m00:40:51.721621 [info ] [Thread-1 (]: 76 of 91 PASS not_null_int_hourly_patterns_total_trips ......................... [[32mPASS[0m in 0.19s]
[0m00:40:51.722480 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m00:40:51.723449 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m00:40:51.724146 [info ] [Thread-3 (]: 78 of 91 START sql table model main.mart_hourly_demand ......................... [RUN]
[0m00:40:51.724789 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e, now model.nyc_taxi_pipeline_00.mart_hourly_demand)
[0m00:40:51.725232 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m00:40:51.727851 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m00:40:51.738834 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m00:40:51.742717 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m00:40:51.743509 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Hourly demand patterns.
*/

with hourly as (
    select * from "dev"."main"."int_hourly_patterns"
),

final as (
    select
        pickup_hour,
        is_weekend,

        count(*) as days_observed,
        round(avg(total_trips), 0) as avg_trips_per_period,
        round(avg(avg_distance), 2) as avg_distance,
        round(avg(avg_duration_min), 2) as avg_duration_min,
        round(avg(total_revenue), 2) as avg_revenue_per_period,
        sum(total_trips) as total_trips_all_days

    from hourly
    group by pickup_hour, is_weekend
)

select * from final
order by is_weekend, pickup_hour
    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:40:51.744547 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:51.747364 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m00:40:51.750491 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m00:40:51.751150 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as bigint)
 as pickup_hour, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as bigint)
 as days_observed, 
      
    cast(null as double)
 as avg_trips_per_period, 
      
    cast(null as double)
 as avg_distance, 
      
    cast(null as double)
 as avg_duration_min, 
      
    cast(null as double)
 as avg_revenue_per_period, 
      
    cast(null as hugeint)
 as total_trips_all_days
    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:40:51.752276 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:51.754217 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m00:40:51.764294 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m00:40:51.765169 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: BEGIN
[0m00:40:51.766090 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m00:40:51.766631 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m00:40:51.767112 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_hourly_demand__dbt_tmp"
  
  (
    pickup_hour bigint,
    is_weekend boolean,
    days_observed bigint,
    avg_trips_per_period double,
    avg_distance double,
    avg_duration_min double,
    avg_revenue_per_period double,
    total_trips_all_days hugeint
    
    )
 ;
    insert into "dev"."main"."mart_hourly_demand__dbt_tmp" 
  (
    
      
      pickup_hour ,
    
      
      is_weekend ,
    
      
      days_observed ,
    
      
      avg_trips_per_period ,
    
      
      avg_distance ,
    
      
      avg_duration_min ,
    
      
      avg_revenue_per_period ,
    
      
      total_trips_all_days 
    
  )
 (
      
    select pickup_hour, is_weekend, days_observed, avg_trips_per_period, avg_distance, avg_duration_min, avg_revenue_per_period, total_trips_all_days
    from (
        /*
    Analytics mart: Hourly demand patterns.
*/

with hourly as (
    select * from "dev"."main"."int_hourly_patterns"
),

final as (
    select
        pickup_hour,
        is_weekend,

        count(*) as days_observed,
        round(avg(total_trips), 0) as avg_trips_per_period,
        round(avg(avg_distance), 2) as avg_distance,
        round(avg(avg_duration_min), 2) as avg_duration_min,
        round(avg(total_revenue), 2) as avg_revenue_per_period,
        sum(total_trips) as total_trips_all_days

    from hourly
    group by pickup_hour, is_weekend
)

select * from final
order by is_weekend, pickup_hour
    ) as model_subq
    );
  
  
[0m00:40:51.853529 [debug] [Thread-4 (]: SQL status: OK in 0.218 seconds
[0m00:40:51.856272 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m00:40:51.856802 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
alter table "dev"."main"."mart_daily_revenue__dbt_tmp" rename to "mart_daily_revenue"
[0m00:40:51.857682 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m00:40:51.858904 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: COMMIT
[0m00:40:51.859372 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m00:40:51.860058 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: COMMIT
[0m00:40:51.867475 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m00:40:51.870341 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m00:40:51.870927 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
drop table if exists "dev"."main"."mart_daily_revenue__dbt_backup" cascade
[0m00:40:51.871764 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m00:40:51.873351 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: Close
[0m00:40:51.874242 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba00d3650>]}
[0m00:40:51.874887 [info ] [Thread-4 (]: 77 of 91 OK created sql table model main.mart_daily_revenue .................... [[32mOK[0m in 0.30s]
[0m00:40:51.875497 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m00:40:51.876373 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m00:40:51.876752 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m00:40:51.877080 [info ] [Thread-1 (]: 79 of 91 START test not_null_mart_daily_revenue_date_key ....................... [RUN]
[0m00:40:51.877587 [info ] [Thread-4 (]: 80 of 91 START test not_null_mart_daily_revenue_total_revenue .................. [RUN]
[0m00:40:51.878420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf, now test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a)
[0m00:40:51.878952 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.mart_daily_revenue, now test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9)
[0m00:40:51.879622 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m00:40:51.880241 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m00:40:51.883996 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m00:40:51.887777 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m00:40:51.898356 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m00:40:51.900869 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m00:40:51.902811 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m00:40:51.905128 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m00:40:51.913496 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m00:40:51.914136 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: BEGIN
[0m00:40:51.914735 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:51.915622 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:51.916094 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m00:40:51.916455 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m00:40:51.916762 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "dev"."main"."mart_daily_revenue"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m00:40:51.917285 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: BEGIN
[0m00:40:51.918173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:51.918660 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:51.919590 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:51.921025 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: ROLLBACK
[0m00:40:51.921321 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m00:40:51.922394 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9'
[0m00:40:51.922717 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "dev"."main"."mart_daily_revenue"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m00:40:51.923231 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: Close
[0m00:40:51.924805 [info ] [Thread-4 (]: 80 of 91 PASS not_null_mart_daily_revenue_total_revenue ........................ [[32mPASS[0m in 0.05s]
[0m00:40:51.925411 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:51.925914 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m00:40:51.927554 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: ROLLBACK
[0m00:40:51.927992 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m00:40:51.928919 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a'
[0m00:40:51.929274 [info ] [Thread-4 (]: 81 of 91 START test unique_mart_daily_revenue_date_key ......................... [RUN]
[0m00:40:51.929816 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: Close
[0m00:40:51.930384 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9, now test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7)
[0m00:40:51.931279 [info ] [Thread-1 (]: 79 of 91 PASS not_null_mart_daily_revenue_date_key ............................. [[32mPASS[0m in 0.05s]
[0m00:40:51.931978 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m00:40:51.932659 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m00:40:51.936727 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m00:40:51.944915 [debug] [Thread-3 (]: SQL status: OK in 0.177 seconds
[0m00:40:51.947414 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m00:40:51.947893 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
alter table "dev"."main"."mart_hourly_demand__dbt_tmp" rename to "mart_hourly_demand"
[0m00:40:51.948832 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:51.949915 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: COMMIT
[0m00:40:51.950322 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m00:40:51.950656 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m00:40:51.953628 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m00:40:51.954184 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: COMMIT
[0m00:40:51.958664 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m00:40:51.960936 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m00:40:51.961413 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
drop table if exists "dev"."main"."mart_hourly_demand__dbt_backup" cascade
[0m00:40:51.962333 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:51.963482 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: Close
[0m00:40:51.964155 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb20881b80>]}
[0m00:40:51.964747 [info ] [Thread-3 (]: 78 of 91 OK created sql table model main.mart_hourly_demand .................... [[32mOK[0m in 0.24s]
[0m00:40:51.965072 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m00:40:51.965417 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m00:40:51.965886 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: BEGIN
[0m00:40:51.966785 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:51.967142 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m00:40:51.967456 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m00:40:51.968136 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:51.968407 [info ] [Thread-1 (]: 82 of 91 START test not_null_mart_hourly_demand_is_weekend ..................... [RUN]
[0m00:40:51.968915 [info ] [Thread-3 (]: 83 of 91 START test not_null_mart_hourly_demand_pickup_hour .................... [RUN]
[0m00:40:51.969383 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m00:40:51.969914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a, now test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8)
[0m00:40:51.970424 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.mart_hourly_demand, now test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418)
[0m00:40:51.970863 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "dev"."main"."mart_daily_revenue"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:40:51.971301 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m00:40:51.971773 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m00:40:51.975532 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m00:40:51.976007 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m00:40:51.978481 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m00:40:51.980425 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: ROLLBACK
[0m00:40:51.981419 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7'
[0m00:40:51.981838 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: Close
[0m00:40:51.982589 [info ] [Thread-4 (]: 81 of 91 PASS unique_mart_daily_revenue_date_key ............................... [[32mPASS[0m in 0.05s]
[0m00:40:51.983338 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m00:40:51.985416 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m00:40:51.987579 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m00:40:51.989645 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m00:40:51.991994 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m00:40:51.997392 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m00:40:51.998199 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: BEGIN
[0m00:40:51.998887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:52.000464 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:52.000902 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m00:40:52.001223 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m00:40:52.001865 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: BEGIN
[0m00:40:52.002387 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."mart_hourly_demand"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m00:40:52.002830 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:52.004071 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:52.004522 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:52.004834 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m00:40:52.006411 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: ROLLBACK
[0m00:40:52.006780 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."mart_hourly_demand"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m00:40:52.007944 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8'
[0m00:40:52.009189 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: Close
[0m00:40:52.009563 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:52.010108 [info ] [Thread-1 (]: 82 of 91 PASS not_null_mart_hourly_demand_is_weekend ........................... [[32mPASS[0m in 0.04s]
[0m00:40:52.011730 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: ROLLBACK
[0m00:40:52.013000 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m00:40:52.014047 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418'
[0m00:40:52.014941 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: Close
[0m00:40:52.016754 [info ] [Thread-3 (]: 83 of 91 PASS not_null_mart_hourly_demand_pickup_hour .......................... [[32mPASS[0m in 0.05s]
[0m00:40:52.017610 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m00:40:55.812097 [debug] [Thread-2 (]: SQL status: OK in 5.157 seconds
[0m00:40:55.813424 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: COMMIT
[0m00:40:55.813923 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m00:40:55.814293 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: COMMIT
[0m00:40:56.225221 [debug] [Thread-2 (]: SQL status: OK in 0.410 seconds
[0m00:40:56.226073 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: Close
[0m00:40:56.619206 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba00a7020>]}
[0m00:40:56.620167 [info ] [Thread-2 (]: 67 of 91 OK created sql incremental model main.fct_trips ....................... [[32mOK[0m in 6.07s]
[0m00:40:56.620737 [debug] [Thread-2 (]: Finished running node model.nyc_taxi_pipeline_00.fct_trips
[0m00:40:56.621672 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m00:40:56.621933 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m00:40:56.622190 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m00:40:56.622449 [info ] [Thread-4 (]: 84 of 91 START test not_null_fct_trips_pickup_datetime ......................... [RUN]
[0m00:40:56.622856 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m00:40:56.623145 [info ] [Thread-1 (]: 85 of 91 START test not_null_fct_trips_total_amount ............................ [RUN]
[0m00:40:56.623531 [info ] [Thread-3 (]: 86 of 91 START test not_null_fct_trips_trip_id ................................. [RUN]
[0m00:40:56.624105 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7, now test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83)
[0m00:40:56.624401 [info ] [Thread-2 (]: 87 of 91 START test unique_fct_trips_trip_id ................................... [RUN]
[0m00:40:56.625228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8, now test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d)
[0m00:40:56.625898 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418, now test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d)
[0m00:40:56.626337 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m00:40:56.626741 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.fct_trips, now test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab)
[0m00:40:56.627202 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m00:40:56.627578 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m00:40:56.630395 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m00:40:56.630874 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m00:40:56.633411 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m00:40:56.635803 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m00:40:56.639933 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m00:40:56.645096 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m00:40:56.647080 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m00:40:56.648115 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m00:40:56.649760 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m00:40:56.650030 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m00:40:56.651741 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m00:40:56.652994 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m00:40:56.654824 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m00:40:56.656145 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m00:40:56.656555 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m00:40:56.656827 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: BEGIN
[0m00:40:56.657390 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: BEGIN
[0m00:40:56.657953 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:56.658358 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m00:40:56.658602 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:56.659249 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: BEGIN
[0m00:40:56.659555 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m00:40:56.660102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:56.660470 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: BEGIN
[0m00:40:56.661168 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:40:56.678148 [debug] [Thread-4 (]: SQL status: OK in 0.020 seconds
[0m00:40:56.678663 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m00:40:56.678931 [debug] [Thread-3 (]: SQL status: OK in 0.020 seconds
[0m00:40:56.679184 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m00:40:56.679440 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m00:40:56.679877 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m00:40:56.680349 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m00:40:56.680827 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m00:40:56.681244 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "dev"."main"."fct_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m00:40:56.681653 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."fct_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m00:40:56.682022 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."fct_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m00:40:56.682395 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."main"."fct_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:40:56.683646 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:56.684198 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:40:56.684477 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:56.686139 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: ROLLBACK
[0m00:40:56.689071 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: ROLLBACK
[0m00:40:56.690731 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: ROLLBACK
[0m00:40:56.698531 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d'
[0m00:40:56.693975 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d'
[0m00:40:56.692309 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83'
[0m00:40:56.700070 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: Close
[0m00:40:56.702937 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: Close
[0m00:40:56.705471 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: Close
[0m00:40:56.710662 [info ] [Thread-4 (]: 84 of 91 PASS not_null_fct_trips_pickup_datetime ............................... [[32mPASS[0m in 0.09s]
[0m00:40:56.709547 [info ] [Thread-3 (]: 86 of 91 PASS not_null_fct_trips_trip_id ....................................... [[32mPASS[0m in 0.08s]
[0m00:40:56.707849 [info ] [Thread-1 (]: 85 of 91 PASS not_null_fct_trips_total_amount .................................. [[32mPASS[0m in 0.08s]
[0m00:40:56.714721 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m00:40:56.717681 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m00:40:56.719950 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m00:40:56.819908 [debug] [Thread-2 (]: SQL status: OK in 0.136 seconds
[0m00:40:56.821709 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: ROLLBACK
[0m00:40:56.822552 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab'
[0m00:40:56.823044 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: Close
[0m00:40:56.851651 [info ] [Thread-2 (]: 87 of 91 PASS unique_fct_trips_trip_id ......................................... [[32mPASS[0m in 0.22s]
[0m00:40:56.853319 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m00:40:56.854370 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.mart_location_performance
[0m00:40:56.854933 [info ] [Thread-4 (]: 88 of 91 START sql table model main.mart_location_performance .................. [RUN]
[0m00:40:56.855429 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83, now model.nyc_taxi_pipeline_00.mart_location_performance)
[0m00:40:56.855811 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_location_performance
[0m00:40:56.858454 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m00:40:56.866563 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.mart_location_performance
[0m00:40:56.869576 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m00:40:56.870271 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Location-level performance summary.
    Uses adapter-dispatched mode_compat() for cross-dialect support.
*/

with trips as (
    select * from "dev"."main"."fct_trips"
),

final as (
    select
        pickup_location_id,
        pickup_borough,
        pickup_zone,

        count(*) as total_pickups,
        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue_per_trip,
        round(avg(tip_percentage), 2) as avg_tip_pct,
        round(avg(passenger_count), 2) as avg_passengers,

        -- most common dropoff destination
        
    mode(dropoff_zone)
 as most_common_dropoff_zone,

        -- busiest hour
        
    mode(pickup_hour)
 as peak_pickup_hour

    from trips
    where pickup_zone is not null
    group by pickup_location_id, pickup_borough, pickup_zone
)

select * from final
order by total_pickups desc
    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:40:56.870923 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:56.890136 [debug] [Thread-4 (]: SQL status: OK in 0.019 seconds
[0m00:40:56.893161 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m00:40:56.893951 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as varchar)
 as pickup_borough, 
      
    cast(null as varchar)
 as pickup_zone, 
      
    cast(null as bigint)
 as total_pickups, 
      
    cast(null as double)
 as avg_trip_distance, 
      
    cast(null as double)
 as avg_trip_duration_min, 
      
    cast(null as decimal(38,2))
 as total_revenue, 
      
    cast(null as double)
 as avg_revenue_per_trip, 
      
    cast(null as double)
 as avg_tip_pct, 
      
    cast(null as double)
 as avg_passengers, 
      
    cast(null as varchar)
 as most_common_dropoff_zone, 
      
    cast(null as bigint)
 as peak_pickup_hour
    ) as __dbt_sbq
    where false
    limit 0
)
[0m00:40:56.895363 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:56.897102 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m00:40:56.906656 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m00:40:56.907276 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: BEGIN
[0m00:40:56.908302 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m00:40:56.908935 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m00:40:56.909479 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_location_performance__dbt_tmp"
  
  (
    pickup_location_id integer,
    pickup_borough varchar,
    pickup_zone varchar,
    total_pickups bigint,
    avg_trip_distance double,
    avg_trip_duration_min double,
    total_revenue decimal(38,2),
    avg_revenue_per_trip double,
    avg_tip_pct double,
    avg_passengers double,
    most_common_dropoff_zone varchar,
    peak_pickup_hour bigint
    
    )
 ;
    insert into "dev"."main"."mart_location_performance__dbt_tmp" 
  (
    
      
      pickup_location_id ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      total_pickups ,
    
      
      avg_trip_distance ,
    
      
      avg_trip_duration_min ,
    
      
      total_revenue ,
    
      
      avg_revenue_per_trip ,
    
      
      avg_tip_pct ,
    
      
      avg_passengers ,
    
      
      most_common_dropoff_zone ,
    
      
      peak_pickup_hour 
    
  )
 (
      
    select pickup_location_id, pickup_borough, pickup_zone, total_pickups, avg_trip_distance, avg_trip_duration_min, total_revenue, avg_revenue_per_trip, avg_tip_pct, avg_passengers, most_common_dropoff_zone, peak_pickup_hour
    from (
        /*
    Analytics mart: Location-level performance summary.
    Uses adapter-dispatched mode_compat() for cross-dialect support.
*/

with trips as (
    select * from "dev"."main"."fct_trips"
),

final as (
    select
        pickup_location_id,
        pickup_borough,
        pickup_zone,

        count(*) as total_pickups,
        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue_per_trip,
        round(avg(tip_percentage), 2) as avg_tip_pct,
        round(avg(passenger_count), 2) as avg_passengers,

        -- most common dropoff destination
        
    mode(dropoff_zone)
 as most_common_dropoff_zone,

        -- busiest hour
        
    mode(pickup_hour)
 as peak_pickup_hour

    from trips
    where pickup_zone is not null
    group by pickup_location_id, pickup_borough, pickup_zone
)

select * from final
order by total_pickups desc
    ) as model_subq
    );
  
  
[0m00:40:57.015133 [debug] [Thread-4 (]: SQL status: OK in 0.105 seconds
[0m00:40:57.018057 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m00:40:57.018599 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
alter table "dev"."main"."mart_location_performance__dbt_tmp" rename to "mart_location_performance"
[0m00:40:57.019697 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:40:57.020856 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: COMMIT
[0m00:40:57.021229 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m00:40:57.021581 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: COMMIT
[0m00:40:57.028678 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m00:40:57.031852 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m00:40:57.032439 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
drop table if exists "dev"."main"."mart_location_performance__dbt_backup" cascade
[0m00:40:57.033249 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m00:40:57.034188 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: Close
[0m00:40:57.086377 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3b38d1-1db4-4625-91e9-c25da509abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb208cd4c0>]}
[0m00:40:57.087488 [info ] [Thread-4 (]: 88 of 91 OK created sql table model main.mart_location_performance ............. [[32mOK[0m in 0.23s]
[0m00:40:57.088117 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.mart_location_performance
[0m00:40:57.088880 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m00:40:57.089145 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m00:40:57.089436 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m00:40:57.089711 [info ] [Thread-1 (]: 89 of 91 START test not_null_mart_location_performance_pickup_location_id ...... [RUN]
[0m00:40:57.090250 [info ] [Thread-2 (]: 90 of 91 START test not_null_mart_location_performance_total_pickups ........... [RUN]
[0m00:40:57.090815 [info ] [Thread-3 (]: 91 of 91 START test unique_mart_location_performance_pickup_location_id ........ [RUN]
[0m00:40:57.091372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d, now test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c)
[0m00:40:57.091881 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab, now test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259)
[0m00:40:57.092370 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d, now test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62)
[0m00:40:57.092738 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m00:40:57.093055 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m00:40:57.093410 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m00:40:57.096676 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m00:40:57.099861 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m00:40:57.102486 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m00:40:57.108246 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m00:40:57.110517 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m00:40:57.113198 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m00:40:57.115418 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m00:40:57.115715 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m00:40:57.117491 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m00:40:57.120637 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m00:40:57.121082 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: BEGIN
[0m00:40:57.121440 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:40:57.122278 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m00:40:57.122692 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: BEGIN
[0m00:40:57.123148 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:57.124688 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m00:40:57.125133 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: BEGIN
[0m00:40:57.125512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:57.143827 [debug] [Thread-2 (]: SQL status: OK in 0.022 seconds
[0m00:40:57.144243 [debug] [Thread-3 (]: SQL status: OK in 0.021 seconds
[0m00:40:57.144600 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m00:40:57.144869 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m00:40:57.145430 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m00:40:57.145939 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m00:40:57.146393 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_pickups
from "dev"."main"."mart_location_performance"
where total_pickups is null



  
  
      
    ) dbt_internal_test
[0m00:40:57.146835 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pickup_location_id as unique_field,
    count(*) as n_records

from "dev"."main"."mart_location_performance"
where pickup_location_id is not null
group by pickup_location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:40:57.147291 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_location_id
from "dev"."main"."mart_location_performance"
where pickup_location_id is null



  
  
      
    ) dbt_internal_test
[0m00:40:57.148856 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m00:40:57.149200 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:40:57.150272 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: ROLLBACK
[0m00:40:57.151328 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: ROLLBACK
[0m00:40:57.151615 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m00:40:57.152408 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259'
[0m00:40:57.153044 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c'
[0m00:40:57.154060 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: ROLLBACK
[0m00:40:57.154315 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: Close
[0m00:40:57.154776 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: Close
[0m00:40:57.155427 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62'
[0m00:40:57.156234 [info ] [Thread-2 (]: 90 of 91 PASS not_null_mart_location_performance_total_pickups ................. [[32mPASS[0m in 0.06s]
[0m00:40:57.156958 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: Close
[0m00:40:57.156690 [info ] [Thread-1 (]: 89 of 91 PASS not_null_mart_location_performance_pickup_location_id ............ [[32mPASS[0m in 0.07s]
[0m00:40:57.157756 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m00:40:57.158482 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m00:40:57.160971 [info ] [Thread-3 (]: 91 of 91 PASS unique_mart_location_performance_pickup_location_id .............. [[32mPASS[0m in 0.07s]
[0m00:40:57.161533 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m00:40:57.163320 [debug] [MainThread]: Using duckdb connection "master"
[0m00:40:57.163722 [debug] [MainThread]: On master: BEGIN
[0m00:40:57.164023 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:40:57.185083 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m00:40:57.185684 [debug] [MainThread]: On master: COMMIT
[0m00:40:57.186093 [debug] [MainThread]: Using duckdb connection "master"
[0m00:40:57.186409 [debug] [MainThread]: On master: COMMIT
[0m00:40:57.186942 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:40:57.187272 [debug] [MainThread]: On master: Close
[0m00:40:57.190567 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:40:57.191141 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m00:40:57.191550 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c' was properly closed.
[0m00:40:57.192033 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259' was properly closed.
[0m00:40:57.192368 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62' was properly closed.
[0m00:40:57.192667 [debug] [MainThread]: Connection 'model.nyc_taxi_pipeline_00.mart_location_performance' was properly closed.
[0m00:40:57.193124 [info ] [MainThread]: 
[0m00:40:57.193483 [info ] [MainThread]: Finished running 1 incremental model, 3 seeds, 7 table models, 74 data tests, 6 view models in 0 hours 0 minutes and 10.08 seconds (10.08s).
[0m00:40:57.199080 [debug] [MainThread]: Command end result
[0m00:40:57.330665 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m00:40:57.336050 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m00:40:57.346833 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m00:40:57.347463 [info ] [MainThread]: 
[0m00:40:57.348127 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:40:57.348753 [info ] [MainThread]: 
[0m00:40:57.349189 [info ] [MainThread]: Done. PASS=91 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=91
[0m00:40:57.350162 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 13.075353, "process_in_blocks": "0", "process_kernel_time": 7.253953, "process_mem_max_rss": "1756520", "process_out_blocks": "136", "process_user_time": 25.418917}
[0m00:40:57.350704 [debug] [MainThread]: Command `dbt build` succeeded at 00:40:57.350569 after 13.08 seconds
[0m00:40:57.351076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf8597c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf8595c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb237c6270>]}
[0m00:40:57.351392 [debug] [MainThread]: Flushing usage events
[0m00:40:57.591010 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:21:53.997342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f2e44d9a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f2e69f6720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f2e44d9940>]}


============================== 09:21:54.001114 | a7274a96-4804-4aa9-bcbe-a4e24f4bf235 ==============================
[0m09:21:54.001114 [info ] [MainThread]: Running with dbt=1.11.4
[0m09:21:54.001497 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'fail_fast': 'False', 'profiles_dir': '.', 'partial_parse': 'True', 'write_json': 'True', 'invocation_command': 'dbt deps --profiles-dir .', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'version_check': 'True', 'debug': 'False', 'target_path': 'None', 'introspect': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'no_print': 'None', 'cache_selected_only': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'log_path': '/dbt/logs', 'quiet': 'False'}
[0m09:21:54.082947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7274a96-4804-4aa9-bcbe-a4e24f4bf235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f2e69a76b0>]}
[0m09:21:54.359857 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-45ldlgmt'
[0m09:21:54.360304 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m09:21:54.706678 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m09:21:54.708215 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m09:21:54.797960 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m09:21:54.801095 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m09:21:58.471257 [info ] [MainThread]: Installed from version 1.3.3
[0m09:21:58.471694 [info ] [MainThread]: Up to date!
[0m09:21:58.472094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a7274a96-4804-4aa9-bcbe-a4e24f4bf235', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f2e3c41cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f2e3c41280>]}
[0m09:21:58.473520 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.556544, "process_in_blocks": "106016", "process_kernel_time": 0.645899, "process_mem_max_rss": "104820", "process_out_blocks": "176", "process_user_time": 1.127158}
[0m09:21:58.473979 [debug] [MainThread]: Command `dbt deps` succeeded at 09:21:58.473891 after 4.56 seconds
[0m09:21:58.474354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f2e68b60f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f2e69a76b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f2e3b2c4d0>]}
[0m09:21:58.474768 [debug] [MainThread]: Flushing usage events
[0m09:21:58.740105 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:22:02.862667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125a751cbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125a745be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125a7253c20>]}


============================== 09:22:02.865129 | b2bb59df-bf4d-475a-aa37-7eb02aaa250f ==============================
[0m09:22:02.865129 [info ] [MainThread]: Running with dbt=1.11.4
[0m09:22:02.865599 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'profiles_dir': '.', 'target_path': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'use_colors': 'True', 'write_json': 'True', 'version_check': 'True', 'log_format': 'default', 'introspect': 'True', 'log_path': '/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'static_parser': 'True', 'quiet': 'False', 'fail_fast': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt build --full-refresh --profiles-dir .', 'indirect_selection': 'eager'}
[0m09:22:03.125754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125a9a67830>]}
[0m09:22:03.165907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125a32ffe60>]}
[0m09:22:03.167912 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m09:22:03.224976 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m09:22:04.038710 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:22:04.039087 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m09:22:04.039414 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:22:04.075758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712597187110>]}
[0m09:22:04.163166 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m09:22:04.168272 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m09:22:04.209368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712537d55fa0>]}
[0m09:22:04.210000 [info ] [MainThread]: Found 14 models, 74 data tests, 3 seeds, 1 source, 578 macros
[0m09:22:04.214724 [info ] [MainThread]: 
[0m09:22:04.215299 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:22:04.215722 [info ] [MainThread]: 
[0m09:22:04.216309 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:22:04.220477 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m09:22:04.321205 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m09:22:04.321622 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m09:22:04.321910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:22:04.351088 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m09:22:04.352249 [debug] [ThreadPool]: On list_dev: Close
[0m09:22:04.355875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m09:22:04.356393 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m09:22:04.360409 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:22:04.360928 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m09:22:04.361424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:22:04.380215 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m09:22:04.381305 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:22:04.381662 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m09:22:04.382119 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:22:04.382470 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:22:04.382910 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m09:22:04.383642 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:22:04.384321 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:22:04.384691 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:22:04.385028 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:22:04.385436 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:22:04.385724 [debug] [ThreadPool]: On create_dev_main: Close
[0m09:22:04.389360 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m09:22:04.392860 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:22:04.393262 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m09:22:04.393621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:22:04.411425 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m09:22:04.411953 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:22:04.412309 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m09:22:04.420907 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m09:22:04.422403 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m09:22:04.424006 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m09:22:04.424389 [debug] [ThreadPool]: On list_dev_main: Close
[0m09:22:04.429284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71259712a660>]}
[0m09:22:04.429825 [debug] [MainThread]: Using duckdb connection "master"
[0m09:22:04.430168 [debug] [MainThread]: On master: BEGIN
[0m09:22:04.430532 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:22:04.450141 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m09:22:04.450698 [debug] [MainThread]: On master: COMMIT
[0m09:22:04.451100 [debug] [MainThread]: Using duckdb connection "master"
[0m09:22:04.451473 [debug] [MainThread]: On master: COMMIT
[0m09:22:04.452048 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:22:04.452380 [debug] [MainThread]: On master: Close
[0m09:22:04.459947 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.dim_dates
[0m09:22:04.460303 [debug] [Thread-2 (]: Began running node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m09:22:04.460611 [debug] [Thread-3 (]: Began running node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m09:22:04.461195 [debug] [Thread-4 (]: Began running node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m09:22:04.460954 [info ] [Thread-1 (]: 1 of 91 START sql table model main.dim_dates ................................... [RUN]
[0m09:22:04.461705 [info ] [Thread-2 (]: 2 of 91 START sql table model main.stg_yellow_trips ............................ [RUN]
[0m09:22:04.462222 [info ] [Thread-3 (]: 3 of 91 START seed file main.payment_type_lookup ............................... [RUN]
[0m09:22:04.462764 [info ] [Thread-4 (]: 4 of 91 START seed file main.rate_code_lookup .................................. [RUN]
[0m09:22:04.463578 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nyc_taxi_pipeline_00.dim_dates'
[0m09:22:04.464403 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.nyc_taxi_pipeline_00.stg_yellow_trips'
[0m09:22:04.464896 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.nyc_taxi_pipeline_00.payment_type_lookup'
[0m09:22:04.465353 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.nyc_taxi_pipeline_00.rate_code_lookup'
[0m09:22:04.465750 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_dates
[0m09:22:04.466155 [debug] [Thread-2 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m09:22:04.466530 [debug] [Thread-3 (]: Began compiling node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m09:22:04.466966 [debug] [Thread-4 (]: Began compiling node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m09:22:04.487406 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m09:22:04.490623 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m09:22:04.491015 [debug] [Thread-3 (]: Began executing node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m09:22:04.491672 [debug] [Thread-4 (]: Began executing node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m09:22:04.492458 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: BEGIN
[0m09:22:04.504134 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:22:04.505486 [debug] [Thread-2 (]: Began executing node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m09:22:04.526707 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m09:22:04.533550 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m09:22:04.533991 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m09:22:04.534316 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.payment_type_lookup"} */
drop table if exists "dev"."main"."payment_type_lookup" cascade
[0m09:22:04.534764 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m09:22:04.536687 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m09:22:04.537027 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:22:04.537537 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */


        select 
        (date_diff('day', cast('2024-01-01' as date)::timestamp, cast('2024-02-01' as date)::timestamp ))
    
[0m09:22:04.538052 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.rate_code_lookup"} */
drop table if exists "dev"."main"."rate_code_lookup" cascade
[0m09:22:04.538952 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m09:22:04.539491 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:22:04.539892 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: BEGIN
[0m09:22:04.540262 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.541063 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:22:04.547407 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m09:22:04.550831 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_dates"
[0m09:22:04.551106 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m09:22:04.554959 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m09:22:04.555269 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m09:22:04.555767 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m09:22:04.556133 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: BEGIN
[0m09:22:04.557019 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m09:22:04.557412 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */

  
    
    

    create  table
      "dev"."main"."stg_yellow_trips__dbt_tmp"
  
    as (
      

with source as (
    select * from read_parquet('/data/yellow_tripdata_2024-01.parquet')
),

renamed as (
    select
        -- surrogate key (MD5 hash of composite key)
        md5(cast(coalesce(cast(VendorID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(PULocationID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DOLocationID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(fare_amount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(total_amount as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- identifiers
        cast("VendorID" as integer) as vendor_id,
        cast("RatecodeID" as integer) as rate_code_id,
        cast("PULocationID" as integer) as pickup_location_id,
        cast("DOLocationID" as integer) as dropoff_location_id,
        cast(payment_type as integer) as payment_type_id,

        -- timestamps
        cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
        cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as double) as trip_distance_miles,
        store_and_fwd_flag,

        -- financials
        round(cast(fare_amount as decimal(10, 2)), 2) as fare_amount,
        round(cast(extra as decimal(10, 2)), 2) as extra_amount,
        round(cast(mta_tax as decimal(10, 2)), 2) as mta_tax,
        round(cast(tip_amount as decimal(10, 2)), 2) as tip_amount,
        round(cast(tolls_amount as decimal(10, 2)), 2) as tolls_amount,
        round(cast(improvement_surcharge as decimal(10, 2)), 2) as improvement_surcharge,
        round(cast(total_amount as decimal(10, 2)), 2) as total_amount,
        round(cast(congestion_surcharge as decimal(10, 2)), 2) as congestion_surcharge,
        round(cast(Airport_fee as decimal(10, 2)), 2) as airport_fee

    from source
    where tpep_pickup_datetime is not null
      and tpep_dropoff_datetime is not null
      and trip_distance >= 0
      and fare_amount >= 0
      -- filter out-of-range dates (data quality: ~18 trips outside Jan 2024)
      and cast(tpep_pickup_datetime as date) >= date '2024-01-01'
      and cast(tpep_pickup_datetime as date) < date '2024-02-01'
)

select * from renamed
    );
  
  
[0m09:22:04.558122 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: BEGIN
[0m09:22:04.558513 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.559685 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m09:22:04.559944 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m09:22:04.560432 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m09:22:04.560797 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.payment_type_lookup"} */

    create table "dev"."main"."payment_type_lookup" ("payment_type_id" integer,"payment_type_name" varchar)
  
[0m09:22:04.561442 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.rate_code_lookup"} */

    create table "dev"."main"."rate_code_lookup" ("rate_code_id" integer,"rate_code_name" varchar)
  
[0m09:22:04.562471 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.562843 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.569464 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m09:22:04.571121 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m09:22:04.571841 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: 
          COPY "dev"."main"."payment_type_lookup" FROM '/dbt/seeds/payment_type_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m09:22:04.572319 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: 
          COPY "dev"."main"."rate_code_lookup" FROM '/dbt/seeds/rate_code_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m09:22:04.573262 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.dim_dates
[0m09:22:04.591467 [debug] [Thread-4 (]: SQL status: OK in 0.018 seconds
[0m09:22:04.592022 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m09:22:04.594913 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m09:22:04.595533 [debug] [Thread-3 (]: SQL status: OK in 0.023 seconds
[0m09:22:04.596998 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
DESCRIBE (select * from (
        /*
    Dimension table: Calendar dates for January 2024.
    Uses adapter-dispatched macros for dayname/monthname.
*/

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 31
    order by generated_number



),

all_periods as (

    select (
        

    date_add(cast('2024-01-01' as date), interval (row_number() over (order by generated_number) - 1) day)


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-02-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week_num,
        
    dayname(date_day)
 as day_of_week_name,
        
    monthname(date_day)
 as month_name,
        extract(week from date_day) as week_of_year,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when cast(date_day as date) in (
                cast('2024-01-01' as date),
                cast('2024-01-15' as date)
            ) then true
            else false
        end as is_holiday

    from date_spine
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m09:22:04.598681 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m09:22:04.604837 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:22:04.616793 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m09:22:04.617413 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as date_key, 
      
    cast(null as bigint)
 as year, 
      
    cast(null as bigint)
 as month, 
      
    cast(null as bigint)
 as day_of_month, 
      
    cast(null as bigint)
 as day_of_week_num, 
      
    cast(null as varchar)
 as day_of_week_name, 
      
    cast(null as varchar)
 as month_name, 
      
    cast(null as bigint)
 as week_of_year, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as boolean)
 as is_holiday
    ) as __dbt_sbq
    where false
    limit 0
)
[0m09:22:04.629131 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: COMMIT
[0m09:22:04.630243 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: COMMIT
[0m09:22:04.630556 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m09:22:04.630845 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:22:04.631380 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m09:22:04.632493 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: COMMIT
[0m09:22:04.638969 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: COMMIT
[0m09:22:04.648754 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_dates"
[0m09:22:04.653543 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m09:22:04.655938 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: Close
[0m09:22:04.657953 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71259712b2f0>]}
[0m09:22:04.658404 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m09:22:04.659779 [info ] [Thread-3 (]: 3 of 91 OK loaded seed file main.payment_type_lookup ........................... [[32mCREATE 6[0m in 0.19s]
[0m09:22:04.660855 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: Close
[0m09:22:04.661658 [debug] [Thread-3 (]: Finished running node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m09:22:04.662566 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712535760aa0>]}
[0m09:22:04.663026 [debug] [Thread-3 (]: Began running node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m09:22:04.663781 [info ] [Thread-4 (]: 4 of 91 OK loaded seed file main.rate_code_lookup .............................. [[32mCREATE 7[0m in 0.20s]
[0m09:22:04.664636 [info ] [Thread-3 (]: 5 of 91 START seed file main.taxi_zone_lookup .................................. [RUN]
[0m09:22:04.665475 [debug] [Thread-4 (]: Finished running node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m09:22:04.665882 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m09:22:04.666304 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.payment_type_lookup, now seed.nyc_taxi_pipeline_00.taxi_zone_lookup)
[0m09:22:04.666827 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m09:22:04.667515 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_dates__dbt_tmp"
  
  (
    date_key date,
    year bigint,
    month bigint,
    day_of_month bigint,
    day_of_week_num bigint,
    day_of_week_name varchar,
    month_name varchar,
    week_of_year bigint,
    is_weekend boolean,
    is_holiday boolean
    
    )
 ;
    insert into "dev"."main"."dim_dates__dbt_tmp" 
  (
    
      
      date_key ,
    
      
      year ,
    
      
      month ,
    
      
      day_of_month ,
    
      
      day_of_week_num ,
    
      
      day_of_week_name ,
    
      
      month_name ,
    
      
      week_of_year ,
    
      
      is_weekend ,
    
      
      is_holiday 
    
  )
 (
      
    select date_key, year, month, day_of_month, day_of_week_num, day_of_week_name, month_name, week_of_year, is_weekend, is_holiday
    from (
        /*
    Dimension table: Calendar dates for January 2024.
    Uses adapter-dispatched macros for dayname/monthname.
*/

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 31
    order by generated_number



),

all_periods as (

    select (
        

    date_add(cast('2024-01-01' as date), interval (row_number() over (order by generated_number) - 1) day)


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-02-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week_num,
        
    dayname(date_day)
 as day_of_week_name,
        
    monthname(date_day)
 as month_name,
        extract(week from date_day) as week_of_year,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when cast(date_day as date) in (
                cast('2024-01-01' as date),
                cast('2024-01-15' as date)
            ) then true
            else false
        end as is_holiday

    from date_spine
)

select * from final
    ) as model_subq
    );
  
  
[0m09:22:04.668099 [debug] [Thread-3 (]: Began compiling node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m09:22:04.668657 [info ] [Thread-4 (]: 6 of 91 START test not_null_payment_type_lookup_payment_type_id ................ [RUN]
[0m09:22:04.670457 [debug] [Thread-3 (]: Began executing node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m09:22:04.671178 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.rate_code_lookup, now test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521)
[0m09:22:04.673645 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m09:22:04.682583 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m09:22:04.684030 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m09:22:04.688822 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m09:22:04.690396 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
alter table "dev"."main"."dim_dates" rename to "dim_dates__dbt_backup"
[0m09:22:04.693205 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m09:22:04.693631 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"} */
drop table if exists "dev"."main"."taxi_zone_lookup" cascade
[0m09:22:04.693957 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:22:04.694277 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:04.696422 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m09:22:04.697472 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
alter table "dev"."main"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m09:22:04.697789 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m09:22:04.708661 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m09:22:04.709599 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m09:22:04.710694 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m09:22:04.710961 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m09:22:04.712072 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: BEGIN
[0m09:22:04.713410 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: COMMIT
[0m09:22:04.714280 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m09:22:04.714628 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m09:22:04.715070 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m09:22:04.715662 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: COMMIT
[0m09:22:04.716298 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"} */

    create table "dev"."main"."taxi_zone_lookup" ("LocationID" integer,"Borough" varchar,"Zone" varchar,"service_zone" varchar)
  
[0m09:22:04.717601 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m09:22:04.718637 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m09:22:04.719066 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: 
          COPY "dev"."main"."taxi_zone_lookup" FROM '/dbt/seeds/taxi_zone_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m09:22:04.720190 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:22:04.720504 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m09:22:04.722205 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m09:22:04.722668 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: BEGIN
[0m09:22:04.723140 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
drop table if exists "dev"."main"."dim_dates__dbt_backup" cascade
[0m09:22:04.723589 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:04.724605 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.724998 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m09:22:04.725503 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."payment_type_lookup"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m09:22:04.726270 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m09:22:04.726563 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:22:04.727119 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m09:22:04.727388 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.728429 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: Close
[0m09:22:04.731231 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: ROLLBACK
[0m09:22:04.732121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712537113f50>]}
[0m09:22:04.732948 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521'
[0m09:22:04.733610 [info ] [Thread-1 (]: 1 of 91 OK created sql table model main.dim_dates .............................. [[32mOK[0m in 0.27s]
[0m09:22:04.734194 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: Close
[0m09:22:04.734955 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.dim_dates
[0m09:22:04.735776 [info ] [Thread-4 (]: 6 of 91 PASS not_null_payment_type_lookup_payment_type_id ...................... [[32mPASS[0m in 0.06s]
[0m09:22:04.736114 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m09:22:04.737099 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: COMMIT
[0m09:22:04.737962 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m09:22:04.738481 [info ] [Thread-1 (]: 7 of 91 START test unique_payment_type_lookup_payment_type_id .................. [RUN]
[0m09:22:04.738961 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m09:22:04.739457 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m09:22:04.740107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_dates, now test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7)
[0m09:22:04.740535 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: COMMIT
[0m09:22:04.741030 [info ] [Thread-4 (]: 8 of 91 START test not_null_rate_code_lookup_rate_code_id ...................... [RUN]
[0m09:22:04.741674 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m09:22:04.742633 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521, now test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec)
[0m09:22:04.747012 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m09:22:04.747668 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m09:22:04.748016 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m09:22:04.749363 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: Close
[0m09:22:04.752193 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m09:22:04.752832 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125357bc4a0>]}
[0m09:22:04.753371 [info ] [Thread-3 (]: 5 of 91 OK loaded seed file main.taxi_zone_lookup .............................. [[32mCREATE 265[0m in 0.09s]
[0m09:22:04.753849 [debug] [Thread-3 (]: Finished running node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m09:22:04.754370 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m09:22:04.754932 [info ] [Thread-3 (]: 9 of 91 START test unique_rate_code_lookup_rate_code_id ........................ [RUN]
[0m09:22:04.755502 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.taxi_zone_lookup, now test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d)
[0m09:22:04.755999 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m09:22:04.756325 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m09:22:04.759028 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m09:22:04.759523 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m09:22:04.761181 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m09:22:04.764075 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m09:22:04.769018 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m09:22:04.769625 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m09:22:04.771185 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m09:22:04.771749 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: BEGIN
[0m09:22:04.772403 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m09:22:04.772865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:04.773320 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: BEGIN
[0m09:22:04.774336 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.774619 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:04.775646 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m09:22:04.776421 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:04.776763 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."payment_type_lookup"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:22:04.777217 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m09:22:04.778050 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_id
from "dev"."main"."rate_code_lookup"
where rate_code_id is null



  
  
      
    ) dbt_internal_test
[0m09:22:04.779008 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m09:22:04.779513 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:22:04.781031 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: ROLLBACK
[0m09:22:04.781478 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m09:22:04.782517 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: ROLLBACK
[0m09:22:04.783013 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec'
[0m09:22:04.783430 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: BEGIN
[0m09:22:04.784102 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7'
[0m09:22:04.784472 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: Close
[0m09:22:04.784929 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:04.785469 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: Close
[0m09:22:04.786260 [info ] [Thread-4 (]: 8 of 91 PASS not_null_rate_code_lookup_rate_code_id ............................ [[32mPASS[0m in 0.04s]
[0m09:22:04.786724 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m09:22:04.787104 [info ] [Thread-1 (]: 7 of 91 PASS unique_payment_type_lookup_payment_type_id ........................ [[32mPASS[0m in 0.05s]
[0m09:22:04.787468 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m09:22:04.788107 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m09:22:04.788860 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m09:22:04.789462 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m09:22:04.789968 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rate_code_id as unique_field,
    count(*) as n_records

from "dev"."main"."rate_code_lookup"
where rate_code_id is not null
group by rate_code_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:22:04.790350 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m09:22:04.790783 [info ] [Thread-4 (]: 10 of 91 START test not_null_dim_dates_date_key ................................ [RUN]
[0m09:22:04.791660 [info ] [Thread-1 (]: 11 of 91 START test not_null_dim_dates_day_of_week_name ........................ [RUN]
[0m09:22:04.792237 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.792697 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec, now test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348)
[0m09:22:04.793300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7, now test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541)
[0m09:22:04.794670 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: ROLLBACK
[0m09:22:04.794921 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m09:22:04.795351 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m09:22:04.796220 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d'
[0m09:22:04.800061 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m09:22:04.803474 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m09:22:04.804056 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: Close
[0m09:22:04.805484 [info ] [Thread-3 (]: 9 of 91 PASS unique_rate_code_lookup_rate_code_id .............................. [[32mPASS[0m in 0.05s]
[0m09:22:04.806178 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m09:22:04.806740 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m09:22:04.807269 [info ] [Thread-3 (]: 12 of 91 START test not_null_dim_dates_is_holiday .............................. [RUN]
[0m09:22:04.807803 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d, now test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a)
[0m09:22:04.808129 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m09:22:04.810903 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m09:22:04.812066 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m09:22:04.812341 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m09:22:04.813857 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m09:22:04.815561 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m09:22:04.816837 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m09:22:04.818752 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m09:22:04.824068 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m09:22:04.824650 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m09:22:04.825026 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: BEGIN
[0m09:22:04.825567 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: BEGIN
[0m09:22:04.826117 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:04.826555 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m09:22:04.827028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:04.828053 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:04.828381 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: BEGIN
[0m09:22:04.829219 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:22:04.829580 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m09:22:04.830171 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:04.830705 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m09:22:04.831303 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "dev"."main"."dim_dates"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m09:22:04.832132 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m09:22:04.832434 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select day_of_week_name
from "dev"."main"."dim_dates"
where day_of_week_name is null



  
  
      
    ) dbt_internal_test
[0m09:22:04.833336 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m09:22:04.833761 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.834461 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_holiday
from "dev"."main"."dim_dates"
where is_holiday is null



  
  
      
    ) dbt_internal_test
[0m09:22:04.834837 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.836239 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: ROLLBACK
[0m09:22:04.838036 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: ROLLBACK
[0m09:22:04.838865 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348'
[0m09:22:04.839226 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m09:22:04.840225 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541'
[0m09:22:04.840711 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: Close
[0m09:22:04.842052 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: ROLLBACK
[0m09:22:04.842322 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: Close
[0m09:22:04.843202 [info ] [Thread-4 (]: 10 of 91 PASS not_null_dim_dates_date_key ...................................... [[32mPASS[0m in 0.05s]
[0m09:22:04.844166 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a'
[0m09:22:04.844785 [info ] [Thread-1 (]: 11 of 91 PASS not_null_dim_dates_day_of_week_name .............................. [[32mPASS[0m in 0.05s]
[0m09:22:04.845265 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m09:22:04.845800 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: Close
[0m09:22:04.846423 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m09:22:04.846955 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m09:22:04.847838 [info ] [Thread-3 (]: 12 of 91 PASS not_null_dim_dates_is_holiday .................................... [[32mPASS[0m in 0.04s]
[0m09:22:04.848195 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m09:22:04.848821 [info ] [Thread-4 (]: 13 of 91 START test not_null_dim_dates_is_weekend .............................. [RUN]
[0m09:22:04.849434 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m09:22:04.849959 [info ] [Thread-1 (]: 14 of 91 START test unique_dim_dates_date_key .................................. [RUN]
[0m09:22:04.850496 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348, now test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0)
[0m09:22:04.850925 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m09:22:04.851379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541, now test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d)
[0m09:22:04.851853 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m09:22:04.852315 [info ] [Thread-3 (]: 15 of 91 START test not_null_taxi_zone_lookup_Borough .......................... [RUN]
[0m09:22:04.852721 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m09:22:04.855826 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m09:22:04.856389 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a, now test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa)
[0m09:22:04.859463 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m09:22:04.860658 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m09:22:04.864033 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m09:22:04.869483 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m09:22:04.872955 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m09:22:04.873423 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m09:22:04.875360 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m09:22:04.875756 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m09:22:04.877620 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m09:22:04.884839 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m09:22:04.885739 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: BEGIN
[0m09:22:04.886592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:04.887315 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m09:22:04.888065 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: BEGIN
[0m09:22:04.888443 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m09:22:04.888761 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:22:04.889111 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:04.889678 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: BEGIN
[0m09:22:04.890242 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m09:22:04.891121 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:04.891402 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:04.891871 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "dev"."main"."dim_dates"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:22:04.892380 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m09:22:04.893715 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m09:22:04.894037 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."dim_dates"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m09:22:04.894461 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.894747 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m09:22:04.896324 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: ROLLBACK
[0m09:22:04.896647 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Borough
from "dev"."main"."taxi_zone_lookup"
where Borough is null



  
  
      
    ) dbt_internal_test
[0m09:22:04.897000 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:04.897848 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d'
[0m09:22:04.899352 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: ROLLBACK
[0m09:22:04.899736 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m09:22:04.900039 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: Close
[0m09:22:04.900898 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0'
[0m09:22:04.902498 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: ROLLBACK
[0m09:22:04.903092 [info ] [Thread-1 (]: 14 of 91 PASS unique_dim_dates_date_key ........................................ [[32mPASS[0m in 0.05s]
[0m09:22:04.903719 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: Close
[0m09:22:04.904606 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa'
[0m09:22:04.905269 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m09:22:04.905944 [info ] [Thread-4 (]: 13 of 91 PASS not_null_dim_dates_is_weekend .................................... [[32mPASS[0m in 0.06s]
[0m09:22:04.906427 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: Close
[0m09:22:04.907004 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m09:22:04.907666 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m09:22:04.908238 [info ] [Thread-3 (]: 15 of 91 PASS not_null_taxi_zone_lookup_Borough ................................ [[32mPASS[0m in 0.05s]
[0m09:22:04.908675 [info ] [Thread-1 (]: 16 of 91 START test not_null_taxi_zone_lookup_LocationID ....................... [RUN]
[0m09:22:04.909275 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m09:22:04.910067 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m09:22:04.910547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d, now test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a)
[0m09:22:04.910944 [info ] [Thread-4 (]: 17 of 91 START test unique_taxi_zone_lookup_LocationID ......................... [RUN]
[0m09:22:04.911779 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.stg_payment_types
[0m09:22:04.912307 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m09:22:04.913076 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0, now test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8)
[0m09:22:04.913692 [info ] [Thread-3 (]: 18 of 91 START sql view model main.stg_payment_types ........................... [RUN]
[0m09:22:04.916708 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m09:22:04.917417 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m09:22:04.918109 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa, now model.nyc_taxi_pipeline_00.stg_payment_types)
[0m09:22:04.920985 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m09:22:04.921646 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_payment_types
[0m09:22:04.924010 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m09:22:04.925444 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m09:22:04.927221 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m09:22:04.929011 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m09:22:04.930976 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m09:22:04.931429 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.stg_payment_types
[0m09:22:04.943386 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m09:22:04.944651 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m09:22:04.945104 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: BEGIN
[0m09:22:04.945484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:04.946416 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.946818 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m09:22:04.947151 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m09:22:04.947742 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: BEGIN
[0m09:22:04.948506 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select LocationID
from "dev"."main"."taxi_zone_lookup"
where LocationID is null



  
  
      
    ) dbt_internal_test
[0m09:22:04.949071 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:04.949920 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m09:22:04.950746 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.951095 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: BEGIN
[0m09:22:04.951402 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:04.952885 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: ROLLBACK
[0m09:22:04.953641 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:04.954196 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m09:22:04.955125 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a'
[0m09:22:04.955990 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    LocationID as unique_field,
    count(*) as n_records

from "dev"."main"."taxi_zone_lookup"
where LocationID is not null
group by LocationID
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:22:04.956451 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m09:22:04.956700 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: Close
[0m09:22:04.957950 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m09:22:04.958637 [info ] [Thread-1 (]: 16 of 91 PASS not_null_taxi_zone_lookup_LocationID ............................. [[32mPASS[0m in 0.05s]
[0m09:22:04.958891 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.959125 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */

  
  create view "dev"."main"."stg_payment_types__dbt_tmp" as (
    /*
    Staging model: Payment type lookup
    Maps payment_type_id to human-readable names.
*/

with source as (
    select * from "dev"."main"."payment_type_lookup"
),

renamed as (
    select
        payment_type_id,
        payment_type_name
    from source
)

select * from renamed
  );

[0m09:22:04.959839 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m09:22:04.961607 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: ROLLBACK
[0m09:22:04.962550 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m09:22:04.962971 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.963544 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8'
[0m09:22:04.964130 [info ] [Thread-1 (]: 19 of 91 START sql view model main.stg_rate_codes .............................. [RUN]
[0m09:22:04.967632 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m09:22:04.968086 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: Close
[0m09:22:04.968703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a, now model.nyc_taxi_pipeline_00.stg_rate_codes)
[0m09:22:04.969114 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
alter view "dev"."main"."stg_payment_types" rename to "stg_payment_types__dbt_backup"
[0m09:22:04.969787 [info ] [Thread-4 (]: 17 of 91 PASS unique_taxi_zone_lookup_LocationID ............................... [[32mPASS[0m in 0.06s]
[0m09:22:04.970117 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m09:22:04.970872 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m09:22:04.971361 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.973126 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m09:22:04.974035 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m09:22:04.976045 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m09:22:04.976808 [info ] [Thread-4 (]: 20 of 91 START sql view model main.stg_taxi_zones .............................. [RUN]
[0m09:22:04.977327 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
alter view "dev"."main"."stg_payment_types__dbt_tmp" rename to "stg_payment_types"
[0m09:22:04.977977 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8, now model.nyc_taxi_pipeline_00.stg_taxi_zones)
[0m09:22:04.978773 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m09:22:04.979184 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.981402 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m09:22:04.982811 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: COMMIT
[0m09:22:04.983881 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m09:22:04.984152 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m09:22:04.984417 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: COMMIT
[0m09:22:04.986854 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m09:22:04.988805 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m09:22:04.991708 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m09:22:04.996343 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m09:22:04.996917 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: BEGIN
[0m09:22:04.997316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:04.997630 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m09:22:04.998277 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:04.998676 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: BEGIN
[0m09:22:04.999357 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m09:22:04.999995 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:05.000470 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */

  
  create view "dev"."main"."stg_rate_codes__dbt_tmp" as (
    /*
    Staging model: Rate code lookup
    Maps rate_code_id to human-readable names.
*/

with source as (
    select * from "dev"."main"."rate_code_lookup"
),

renamed as (
    select
        rate_code_id,
        rate_code_name
    from source
)

select * from renamed
  );

[0m09:22:05.001428 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.001868 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m09:22:05.002286 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */

  
  create view "dev"."main"."stg_taxi_zones__dbt_tmp" as (
    /*
    Staging model: Taxi zone lookup
    Maps LocationID to borough and zone name.
*/

with source as (
    select * from "dev"."main"."taxi_zone_lookup"
),

renamed as (
    select
        cast("LocationID" as integer) as location_id,
        "Borough" as borough,
        "Zone" as zone_name,
        service_zone
    from source
)

select * from renamed
  );

[0m09:22:05.040158 [debug] [Thread-3 (]: SQL status: OK in 0.052 seconds
[0m09:22:05.040641 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m09:22:05.040963 [debug] [Thread-4 (]: SQL status: OK in 0.038 seconds
[0m09:22:05.042818 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m09:22:05.045411 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m09:22:05.047905 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m09:22:05.048389 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
drop view if exists "dev"."main"."stg_payment_types__dbt_backup" cascade
[0m09:22:05.048804 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
alter view "dev"."main"."stg_rate_codes" rename to "stg_rate_codes__dbt_backup"
[0m09:22:05.049315 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
alter view "dev"."main"."stg_taxi_zones" rename to "stg_taxi_zones__dbt_backup"
[0m09:22:05.050697 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.051351 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m09:22:05.054831 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m09:22:05.055294 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m09:22:05.057619 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m09:22:05.058165 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
alter view "dev"."main"."stg_rate_codes__dbt_tmp" rename to "stg_rate_codes"
[0m09:22:05.059423 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: Close
[0m09:22:05.059839 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
alter view "dev"."main"."stg_taxi_zones__dbt_tmp" rename to "stg_taxi_zones"
[0m09:22:05.060892 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:22:05.061335 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125348ba750>]}
[0m09:22:05.062708 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: COMMIT
[0m09:22:05.063032 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.063518 [info ] [Thread-3 (]: 18 of 91 OK created sql view model main.stg_payment_types ...................... [[32mOK[0m in 0.14s]
[0m09:22:05.063936 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m09:22:05.065254 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: COMMIT
[0m09:22:05.066022 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.stg_payment_types
[0m09:22:05.066512 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: COMMIT
[0m09:22:05.067009 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m09:22:05.067970 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m09:22:05.068734 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: COMMIT
[0m09:22:05.069682 [info ] [Thread-3 (]: 21 of 91 START test not_null_stg_payment_types_payment_type_id ................. [RUN]
[0m09:22:05.070802 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_payment_types, now test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78)
[0m09:22:05.071402 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m09:22:05.074669 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m09:22:05.075042 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:22:05.077734 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m09:22:05.078108 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m09:22:05.078890 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
drop view if exists "dev"."main"."stg_rate_codes__dbt_backup" cascade
[0m09:22:05.080945 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m09:22:05.082108 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
drop view if exists "dev"."main"."stg_taxi_zones__dbt_backup" cascade
[0m09:22:05.084690 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:22:05.085920 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: Close
[0m09:22:05.086776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125357be150>]}
[0m09:22:05.087400 [info ] [Thread-1 (]: 19 of 91 OK created sql view model main.stg_rate_codes ......................... [[32mOK[0m in 0.12s]
[0m09:22:05.087785 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m09:22:05.088279 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m09:22:05.089582 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: Close
[0m09:22:05.090504 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m09:22:05.091335 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125348d5190>]}
[0m09:22:05.091685 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m09:22:05.092168 [info ] [Thread-1 (]: 22 of 91 START test not_null_stg_payment_types_payment_type_name ............... [RUN]
[0m09:22:05.092731 [info ] [Thread-4 (]: 20 of 91 OK created sql view model main.stg_taxi_zones ......................... [[32mOK[0m in 0.11s]
[0m09:22:05.095104 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m09:22:05.096091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_rate_codes, now test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39)
[0m09:22:05.096944 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m09:22:05.098400 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m09:22:05.099077 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m09:22:05.102038 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m09:22:05.102469 [info ] [Thread-4 (]: 23 of 91 START test unique_stg_payment_types_payment_type_id ................... [RUN]
[0m09:22:05.103289 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_taxi_zones, now test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534)
[0m09:22:05.103920 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m09:22:05.106966 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m09:22:05.108765 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m09:22:05.109203 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: BEGIN
[0m09:22:05.109629 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:05.110505 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.110885 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m09:22:05.111206 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m09:22:05.111693 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."stg_payment_types"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m09:22:05.114123 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m09:22:05.114555 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m09:22:05.115845 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.118456 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m09:22:05.120027 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: ROLLBACK
[0m09:22:05.121097 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78'
[0m09:22:05.121540 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: Close
[0m09:22:05.122289 [info ] [Thread-3 (]: 21 of 91 PASS not_null_stg_payment_types_payment_type_id ....................... [[32mPASS[0m in 0.05s]
[0m09:22:05.122851 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m09:22:05.123395 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m09:22:05.123793 [info ] [Thread-3 (]: 24 of 91 START test not_null_stg_rate_codes_rate_code_id ....................... [RUN]
[0m09:22:05.124408 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78, now test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a)
[0m09:22:05.124845 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m09:22:05.128357 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m09:22:05.129426 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m09:22:05.129926 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: BEGIN
[0m09:22:05.130311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:05.130626 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m09:22:05.131219 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.131486 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: BEGIN
[0m09:22:05.132165 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m09:22:05.132556 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:05.132968 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_name
from "dev"."main"."stg_payment_types"
where payment_type_name is null



  
  
      
    ) dbt_internal_test
[0m09:22:05.133569 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.134203 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m09:22:05.134513 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.134770 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_payment_types"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:22:05.136164 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: ROLLBACK
[0m09:22:05.137545 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39'
[0m09:22:05.137932 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.138178 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: Close
[0m09:22:05.138493 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m09:22:05.139685 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: ROLLBACK
[0m09:22:05.140207 [info ] [Thread-1 (]: 22 of 91 PASS not_null_stg_payment_types_payment_type_name ..................... [[32mPASS[0m in 0.04s]
[0m09:22:05.142829 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m09:22:05.143895 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534'
[0m09:22:05.144298 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m09:22:05.145085 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: Close
[0m09:22:05.145638 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m09:22:05.146217 [info ] [Thread-4 (]: 23 of 91 PASS unique_stg_payment_types_payment_type_id ......................... [[32mPASS[0m in 0.04s]
[0m09:22:05.146635 [info ] [Thread-1 (]: 25 of 91 START test not_null_stg_rate_codes_rate_code_name ..................... [RUN]
[0m09:22:05.147459 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m09:22:05.148164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39, now test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f)
[0m09:22:05.148713 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m09:22:05.149277 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m09:22:05.149823 [info ] [Thread-4 (]: 26 of 91 START test unique_stg_rate_codes_rate_code_id ......................... [RUN]
[0m09:22:05.152987 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m09:22:05.153593 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534, now test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3)
[0m09:22:05.154480 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m09:22:05.157951 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m09:22:05.158459 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m09:22:05.159273 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: BEGIN
[0m09:22:05.159729 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:05.160718 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.161230 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m09:22:05.161774 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_id
from "dev"."main"."stg_rate_codes"
where rate_code_id is null



  
  
      
    ) dbt_internal_test
[0m09:22:05.162918 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.164170 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: ROLLBACK
[0m09:22:05.165269 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a'
[0m09:22:05.165615 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m09:22:05.165930 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: Close
[0m09:22:05.166339 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m09:22:05.168132 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m09:22:05.171799 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m09:22:05.168908 [info ] [Thread-3 (]: 24 of 91 PASS not_null_stg_rate_codes_rate_code_id ............................. [[32mPASS[0m in 0.04s]
[0m09:22:05.174353 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m09:22:05.175007 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m09:22:05.175443 [info ] [Thread-3 (]: 27 of 91 START test not_null_stg_taxi_zones_borough ............................ [RUN]
[0m09:22:05.175914 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b)
[0m09:22:05.176335 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m09:22:05.179125 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m09:22:05.180333 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m09:22:05.180856 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: BEGIN
[0m09:22:05.181165 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m09:22:05.181535 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:05.182145 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: BEGIN
[0m09:22:05.183188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:05.183684 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:05.184383 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.184701 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m09:22:05.185212 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m09:22:05.185730 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rate_code_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_rate_codes"
where rate_code_id is not null
group by rate_code_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:22:05.186436 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_name
from "dev"."main"."stg_rate_codes"
where rate_code_name is null



  
  
      
    ) dbt_internal_test
[0m09:22:05.188477 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.188944 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m09:22:05.189300 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:05.190629 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: ROLLBACK
[0m09:22:05.192215 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m09:22:05.193369 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: ROLLBACK
[0m09:22:05.193876 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f'
[0m09:22:05.194715 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3'
[0m09:22:05.195108 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: Close
[0m09:22:05.195541 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: Close
[0m09:22:05.196380 [info ] [Thread-1 (]: 25 of 91 PASS not_null_stg_rate_codes_rate_code_name ........................... [[32mPASS[0m in 0.05s]
[0m09:22:05.197211 [info ] [Thread-4 (]: 26 of 91 PASS unique_stg_rate_codes_rate_code_id ............................... [[32mPASS[0m in 0.04s]
[0m09:22:05.197976 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m09:22:05.198586 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m09:22:05.199140 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m09:22:05.199801 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m09:22:05.200429 [info ] [Thread-1 (]: 28 of 91 START test not_null_stg_taxi_zones_location_id ........................ [RUN]
[0m09:22:05.201004 [info ] [Thread-4 (]: 29 of 91 START test not_null_stg_taxi_zones_zone_name .......................... [RUN]
[0m09:22:05.201743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf)
[0m09:22:05.202567 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84)
[0m09:22:05.203529 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m09:22:05.204334 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m09:22:05.207874 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m09:22:05.208391 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m09:22:05.212502 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m09:22:05.213853 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: BEGIN
[0m09:22:05.214861 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:05.215953 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.216526 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m09:22:05.217106 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select borough
from "dev"."main"."stg_taxi_zones"
where borough is null



  
  
      
    ) dbt_internal_test
[0m09:22:05.218468 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.220183 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: ROLLBACK
[0m09:22:05.221187 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b'
[0m09:22:05.221570 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m09:22:05.221873 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: Close
[0m09:22:05.224159 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m09:22:05.224637 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m09:22:05.225304 [info ] [Thread-3 (]: 27 of 91 PASS not_null_stg_taxi_zones_borough .................................. [[32mPASS[0m in 0.05s]
[0m09:22:05.227294 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m09:22:05.228207 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m09:22:05.229218 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m09:22:05.229745 [info ] [Thread-3 (]: 30 of 91 START test unique_stg_taxi_zones_location_id .......................... [RUN]
[0m09:22:05.230250 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b, now test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c)
[0m09:22:05.230767 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m09:22:05.233797 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m09:22:05.235388 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m09:22:05.235977 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: BEGIN
[0m09:22:05.236442 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m09:22:05.236879 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:05.237718 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: BEGIN
[0m09:22:05.238824 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:05.239120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:05.239596 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m09:22:05.240665 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.241042 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select zone_name
from "dev"."main"."stg_taxi_zones"
where zone_name is null



  
  
      
    ) dbt_internal_test
[0m09:22:05.241678 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m09:22:05.242897 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "dev"."main"."stg_taxi_zones"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m09:22:05.243554 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.243989 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.244313 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m09:22:05.245773 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: ROLLBACK
[0m09:22:05.247014 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: ROLLBACK
[0m09:22:05.249276 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m09:22:05.250386 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84'
[0m09:22:05.251359 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf'
[0m09:22:05.252329 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: Close
[0m09:22:05.252994 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: Close
[0m09:22:05.254042 [info ] [Thread-4 (]: 29 of 91 PASS not_null_stg_taxi_zones_zone_name ................................ [[32mPASS[0m in 0.05s]
[0m09:22:05.254620 [info ] [Thread-1 (]: 28 of 91 PASS not_null_stg_taxi_zones_location_id .............................. [[32mPASS[0m in 0.05s]
[0m09:22:05.255406 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m09:22:05.256097 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m09:22:05.256775 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.dim_payment_types
[0m09:22:05.258115 [info ] [Thread-4 (]: 31 of 91 START sql table model main.dim_payment_types .......................... [RUN]
[0m09:22:05.258840 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84, now model.nyc_taxi_pipeline_00.dim_payment_types)
[0m09:22:05.259429 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_payment_types
[0m09:22:05.261883 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m09:22:05.264061 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m09:22:05.264557 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: BEGIN
[0m09:22:05.265083 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:05.266064 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.266688 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m09:22:05.267254 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_taxi_zones"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:22:05.269490 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m09:22:05.272161 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: ROLLBACK
[0m09:22:05.273541 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c'
[0m09:22:05.274073 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.dim_payment_types
[0m09:22:05.274533 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: Close
[0m09:22:05.277475 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m09:22:05.278462 [info ] [Thread-3 (]: 30 of 91 PASS unique_stg_taxi_zones_location_id ................................ [[32mPASS[0m in 0.05s]
[0m09:22:05.279111 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
DESCRIBE (select * from (
        /*
    Dimension table: Payment type descriptions.
*/

with payment_types as (
    select * from "dev"."main"."stg_payment_types"
),

final as (
    select
        payment_type_id,
        payment_type_name
    from payment_types
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m09:22:05.279796 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m09:22:05.280427 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:05.281617 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.dim_locations
[0m09:22:05.282815 [info ] [Thread-1 (]: 32 of 91 START sql table model main.dim_locations .............................. [RUN]
[0m09:22:05.283456 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m09:22:05.284043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf, now model.nyc_taxi_pipeline_00.dim_locations)
[0m09:22:05.285622 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m09:22:05.286034 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_locations
[0m09:22:05.286798 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as payment_type_id, 
      
    cast(null as varchar)
 as payment_type_name
    ) as __dbt_sbq
    where false
    limit 0
)
[0m09:22:05.289618 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_locations"
[0m09:22:05.291528 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.292978 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m09:22:05.304684 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.dim_locations
[0m09:22:05.308476 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m09:22:05.309043 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m09:22:05.309409 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
DESCRIBE (select * from (
        /*
    Dimension table: TLC Taxi Zone locations.
*/

with zones as (
    select * from "dev"."main"."stg_taxi_zones"
),

final as (
    select
        location_id,
        borough,
        zone_name,
        service_zone
    from zones
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m09:22:05.310060 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: BEGIN
[0m09:22:05.310933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:05.312035 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m09:22:05.313140 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m09:22:05.313478 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:22:05.313854 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_payment_types__dbt_tmp"
  
  (
    payment_type_id integer,
    payment_type_name varchar
    
    )
 ;
    insert into "dev"."main"."dim_payment_types__dbt_tmp" 
  (
    
      
      payment_type_id ,
    
      
      payment_type_name 
    
  )
 (
      
    select payment_type_id, payment_type_name
    from (
        /*
    Dimension table: Payment type descriptions.
*/

with payment_types as (
    select * from "dev"."main"."stg_payment_types"
),

final as (
    select
        payment_type_id,
        payment_type_name
    from payment_types
)

select * from final
    ) as model_subq
    );
  
  
[0m09:22:05.315845 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m09:22:05.316765 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as location_id, 
      
    cast(null as varchar)
 as borough, 
      
    cast(null as varchar)
 as zone_name, 
      
    cast(null as varchar)
 as service_zone
    ) as __dbt_sbq
    where false
    limit 0
)
[0m09:22:05.317872 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:05.318261 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.320286 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m09:22:05.321953 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_locations"
[0m09:22:05.322818 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
alter table "dev"."main"."dim_payment_types" rename to "dim_payment_types__dbt_backup"
[0m09:22:05.324528 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.327267 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m09:22:05.327961 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
alter table "dev"."main"."dim_payment_types__dbt_tmp" rename to "dim_payment_types"
[0m09:22:05.328866 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m09:22:05.330258 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: COMMIT
[0m09:22:05.330983 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m09:22:05.331764 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: COMMIT
[0m09:22:05.334801 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m09:22:05.335367 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_locations: BEGIN
[0m09:22:05.336540 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.337118 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m09:22:05.337480 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m09:22:05.339590 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m09:22:05.340257 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_locations__dbt_tmp"
  
  (
    location_id integer,
    borough varchar,
    zone_name varchar,
    service_zone varchar
    
    )
 ;
    insert into "dev"."main"."dim_locations__dbt_tmp" 
  (
    
      
      location_id ,
    
      
      borough ,
    
      
      zone_name ,
    
      
      service_zone 
    
  )
 (
      
    select location_id, borough, zone_name, service_zone
    from (
        /*
    Dimension table: TLC Taxi Zone locations.
*/

with zones as (
    select * from "dev"."main"."stg_taxi_zones"
),

final as (
    select
        location_id,
        borough,
        zone_name,
        service_zone
    from zones
)

select * from final
    ) as model_subq
    );
  
  
[0m09:22:05.341337 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
drop table if exists "dev"."main"."dim_payment_types__dbt_backup" cascade
[0m09:22:05.344019 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:22:05.346689 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m09:22:05.347016 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m09:22:05.347372 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
alter table "dev"."main"."dim_locations" rename to "dim_locations__dbt_backup"
[0m09:22:05.348719 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: Close
[0m09:22:05.349899 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712534167800>]}
[0m09:22:05.350271 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.351006 [info ] [Thread-4 (]: 31 of 91 OK created sql table model main.dim_payment_types ..................... [[32mOK[0m in 0.09s]
[0m09:22:05.353710 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m09:22:05.354469 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.dim_payment_types
[0m09:22:05.354919 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
alter table "dev"."main"."dim_locations__dbt_tmp" rename to "dim_locations"
[0m09:22:05.356466 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m09:22:05.356856 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m09:22:05.357225 [info ] [Thread-3 (]: 33 of 91 START test not_null_dim_payment_types_payment_type_id ................. [RUN]
[0m09:22:05.357561 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.358026 [info ] [Thread-4 (]: 34 of 91 START test not_null_dim_payment_types_payment_type_name ............... [RUN]
[0m09:22:05.358566 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c, now test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10)
[0m09:22:05.359745 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_locations: COMMIT
[0m09:22:05.360248 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_payment_types, now test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0)
[0m09:22:05.360600 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m09:22:05.361071 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m09:22:05.361471 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m09:22:05.363969 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m09:22:05.364428 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_locations: COMMIT
[0m09:22:05.366899 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m09:22:05.371831 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:22:05.373963 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m09:22:05.374461 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
drop table if exists "dev"."main"."dim_locations__dbt_backup" cascade
[0m09:22:05.375460 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m09:22:05.378356 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m09:22:05.378607 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:22:05.378846 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m09:22:05.380165 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_locations: Close
[0m09:22:05.381978 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m09:22:05.383659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125348caea0>]}
[0m09:22:05.384803 [info ] [Thread-1 (]: 32 of 91 OK created sql table model main.dim_locations ......................... [[32mOK[0m in 0.10s]
[0m09:22:05.385539 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.dim_locations
[0m09:22:05.386067 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m09:22:05.386572 [info ] [Thread-1 (]: 35 of 91 START test unique_dim_payment_types_payment_type_id ................... [RUN]
[0m09:22:05.387063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_locations, now test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62)
[0m09:22:05.387482 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m09:22:05.390241 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m09:22:05.391341 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m09:22:05.391727 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: BEGIN
[0m09:22:05.391987 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m09:22:05.392201 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:05.392590 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: BEGIN
[0m09:22:05.393333 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:05.393575 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.394212 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.394660 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m09:22:05.395713 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m09:22:05.396399 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_name
from "dev"."main"."dim_payment_types"
where payment_type_name is null



  
  
      
    ) dbt_internal_test
[0m09:22:05.396948 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."dim_payment_types"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m09:22:05.398130 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.398372 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.399729 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: ROLLBACK
[0m09:22:05.401009 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: ROLLBACK
[0m09:22:05.401412 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m09:22:05.402135 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0'
[0m09:22:05.402567 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10'
[0m09:22:05.404490 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m09:22:05.405143 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: Close
[0m09:22:05.405802 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: Close
[0m09:22:05.406903 [info ] [Thread-4 (]: 34 of 91 PASS not_null_dim_payment_types_payment_type_name ..................... [[32mPASS[0m in 0.05s]
[0m09:22:05.407329 [info ] [Thread-3 (]: 33 of 91 PASS not_null_dim_payment_types_payment_type_id ....................... [[32mPASS[0m in 0.05s]
[0m09:22:05.407701 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m09:22:05.408238 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m09:22:05.408766 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m09:22:05.409346 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m09:22:05.410141 [info ] [Thread-4 (]: 36 of 91 START test not_null_dim_locations_borough ............................. [RUN]
[0m09:22:05.410716 [info ] [Thread-3 (]: 37 of 91 START test not_null_dim_locations_location_id ......................... [RUN]
[0m09:22:05.411450 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0, now test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af)
[0m09:22:05.411892 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10, now test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476)
[0m09:22:05.412317 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m09:22:05.412765 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m09:22:05.415775 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m09:22:05.418823 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m09:22:05.421068 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m09:22:05.421520 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: BEGIN
[0m09:22:05.421883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:05.422810 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.423226 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m09:22:05.423685 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."dim_payment_types"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:22:05.425083 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.425544 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m09:22:05.426116 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m09:22:05.427508 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: ROLLBACK
[0m09:22:05.429260 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m09:22:05.431298 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m09:22:05.432264 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62'
[0m09:22:05.433511 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: Close
[0m09:22:05.434276 [info ] [Thread-1 (]: 35 of 91 PASS unique_dim_payment_types_payment_type_id ......................... [[32mPASS[0m in 0.05s]
[0m09:22:05.434794 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m09:22:05.435299 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m09:22:05.435846 [info ] [Thread-1 (]: 38 of 91 START test not_null_dim_locations_zone_name ........................... [RUN]
[0m09:22:05.436469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62, now test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d)
[0m09:22:05.436864 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m09:22:05.439869 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m09:22:05.440901 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m09:22:05.441344 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: BEGIN
[0m09:22:05.441691 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m09:22:05.441998 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:05.442520 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: BEGIN
[0m09:22:05.443594 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:05.443963 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:05.444577 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.444819 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m09:22:05.445274 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m09:22:05.445741 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select borough
from "dev"."main"."dim_locations"
where borough is null



  
  
      
    ) dbt_internal_test
[0m09:22:05.446312 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "dev"."main"."dim_locations"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m09:22:05.447857 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.448292 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.449793 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: ROLLBACK
[0m09:22:05.450798 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: ROLLBACK
[0m09:22:05.451342 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476'
[0m09:22:05.452106 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af'
[0m09:22:05.452689 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: Close
[0m09:22:05.453086 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m09:22:05.453704 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: Close
[0m09:22:05.454740 [info ] [Thread-3 (]: 37 of 91 PASS not_null_dim_locations_location_id ............................... [[32mPASS[0m in 0.04s]
[0m09:22:05.456613 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m09:22:05.457450 [info ] [Thread-4 (]: 36 of 91 PASS not_null_dim_locations_borough ................................... [[32mPASS[0m in 0.05s]
[0m09:22:05.457907 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m09:22:05.458678 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m09:22:05.459060 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m09:22:05.459909 [info ] [Thread-3 (]: 39 of 91 START test unique_dim_locations_location_id ........................... [RUN]
[0m09:22:05.460686 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476, now test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d)
[0m09:22:05.461355 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m09:22:05.466078 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m09:22:05.472353 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m09:22:05.472756 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: BEGIN
[0m09:22:05.473251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:05.474393 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.474941 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m09:22:05.475537 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select zone_name
from "dev"."main"."dim_locations"
where zone_name is null



  
  
      
    ) dbt_internal_test
[0m09:22:05.475997 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m09:22:05.478426 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m09:22:05.479092 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:22:05.480917 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: ROLLBACK
[0m09:22:05.481597 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d'
[0m09:22:05.481959 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: Close
[0m09:22:05.482748 [info ] [Thread-1 (]: 38 of 91 PASS not_null_dim_locations_zone_name ................................. [[32mPASS[0m in 0.05s]
[0m09:22:05.483851 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m09:22:05.488383 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m09:22:05.488952 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: BEGIN
[0m09:22:05.489382 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:05.490153 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.490510 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m09:22:05.490812 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "dev"."main"."dim_locations"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:22:05.492043 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:05.493792 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: ROLLBACK
[0m09:22:05.494560 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d'
[0m09:22:05.494927 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: Close
[0m09:22:05.495683 [info ] [Thread-3 (]: 39 of 91 PASS unique_dim_locations_location_id ................................. [[32mPASS[0m in 0.03s]
[0m09:22:05.496466 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m09:22:06.459836 [debug] [Thread-2 (]: SQL status: OK in 1.901 seconds
[0m09:22:06.462450 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m09:22:06.462859 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
alter table "dev"."main"."stg_yellow_trips" rename to "stg_yellow_trips__dbt_backup"
[0m09:22:06.463586 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m09:22:06.465262 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m09:22:06.465727 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
alter table "dev"."main"."stg_yellow_trips__dbt_tmp" rename to "stg_yellow_trips"
[0m09:22:06.466507 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m09:22:06.467565 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: COMMIT
[0m09:22:06.467959 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m09:22:06.468258 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: COMMIT
[0m09:22:06.516892 [debug] [Thread-2 (]: SQL status: OK in 0.048 seconds
[0m09:22:06.518840 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m09:22:06.519268 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
drop table if exists "dev"."main"."stg_yellow_trips__dbt_backup" cascade
[0m09:22:06.523719 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m09:22:06.524853 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: Close
[0m09:22:06.584915 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71252411d160>]}
[0m09:22:06.585693 [info ] [Thread-2 (]: 2 of 91 OK created sql table model main.stg_yellow_trips ....................... [[32mOK[0m in 2.12s]
[0m09:22:06.586317 [debug] [Thread-2 (]: Finished running node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m09:22:06.587132 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m09:22:06.587393 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m09:22:06.587627 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m09:22:06.587844 [info ] [Thread-4 (]: 40 of 91 START test accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6  [RUN]
[0m09:22:06.588095 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m09:22:06.588313 [info ] [Thread-1 (]: 41 of 91 START test accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99  [RUN]
[0m09:22:06.588695 [info ] [Thread-3 (]: 42 of 91 START test accepted_values_stg_yellow_trips_vendor_id__1__2__6 ........ [RUN]
[0m09:22:06.589122 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44)
[0m09:22:06.589510 [info ] [Thread-2 (]: 43 of 91 START test assert_fare_not_exceeds_total .............................. [RUN]
[0m09:22:06.590053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098)
[0m09:22:06.590644 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27)
[0m09:22:06.591080 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m09:22:06.591546 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_yellow_trips, now test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total)
[0m09:22:06.592009 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m09:22:06.592329 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m09:22:06.596912 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m09:22:06.597359 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m09:22:06.599737 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m09:22:06.601897 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m09:22:06.604133 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m09:22:06.607465 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m09:22:06.607862 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m09:22:06.610477 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m09:22:06.612228 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m09:22:06.612523 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m09:22:06.612811 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m09:22:06.614456 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m09:22:06.615660 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m09:22:06.620062 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m09:22:06.620449 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m09:22:06.620782 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: BEGIN
[0m09:22:06.621145 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m09:22:06.621546 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: BEGIN
[0m09:22:06.622016 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:22:06.622417 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: BEGIN
[0m09:22:06.622849 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m09:22:06.623050 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:06.623680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:06.624031 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: BEGIN
[0m09:22:06.625235 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:06.642254 [debug] [Thread-2 (]: SQL status: OK in 0.020 seconds
[0m09:22:06.642580 [debug] [Thread-4 (]: SQL status: OK in 0.020 seconds
[0m09:22:06.642795 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m09:22:06.643024 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m09:22:06.643226 [debug] [Thread-3 (]: SQL status: OK in 0.018 seconds
[0m09:22:06.643616 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m09:22:06.644018 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m09:22:06.644369 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
    Singular test: fare_amount should not exceed total_amount.
*/

select
    trip_id,
    fare_amount,
    total_amount
from "dev"."main"."stg_yellow_trips"
where fare_amount > total_amount + 0.01
  and total_amount > 0
  
  
      
    ) dbt_internal_test
[0m09:22:06.644693 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m09:22:06.645025 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        payment_type_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by payment_type_id

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6'
)



  
  
      
    ) dbt_internal_test
[0m09:22:06.645470 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rate_code_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by rate_code_id

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5','6','99'
)



  
  
      
    ) dbt_internal_test
[0m09:22:06.646036 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        vendor_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by vendor_id

)

select *
from all_values
where value_field not in (
    '1','2','6'
)



  
  
      
    ) dbt_internal_test
[0m09:22:06.678894 [debug] [Thread-2 (]: SQL status: OK in 0.033 seconds
[0m09:22:06.681594 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: ROLLBACK
[0m09:22:06.683127 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total'
[0m09:22:06.683492 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: Close
[0m09:22:06.683742 [debug] [Thread-3 (]: SQL status: OK in 0.034 seconds
[0m09:22:06.683975 [debug] [Thread-4 (]: SQL status: OK in 0.037 seconds
[0m09:22:06.684362 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m09:22:06.684915 [info ] [Thread-2 (]: 43 of 91 PASS assert_fare_not_exceeds_total .................................... [[32mPASS[0m in 0.09s]
[0m09:22:06.686338 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: ROLLBACK
[0m09:22:06.687310 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: ROLLBACK
[0m09:22:06.688165 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: ROLLBACK
[0m09:22:06.688465 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m09:22:06.689076 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27'
[0m09:22:06.689628 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44'
[0m09:22:06.690126 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098'
[0m09:22:06.690676 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m09:22:06.691041 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: Close
[0m09:22:06.691377 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: Close
[0m09:22:06.691711 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: Close
[0m09:22:06.692073 [info ] [Thread-2 (]: 44 of 91 START test not_null_stg_yellow_trips_dropoff_datetime ................. [RUN]
[0m09:22:06.692653 [info ] [Thread-3 (]: 42 of 91 PASS accepted_values_stg_yellow_trips_vendor_id__1__2__6 .............. [[32mPASS[0m in 0.10s]
[0m09:22:06.693061 [info ] [Thread-4 (]: 40 of 91 PASS accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6  [[32mPASS[0m in 0.10s]
[0m09:22:06.693571 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052)
[0m09:22:06.694077 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m09:22:06.694697 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m09:22:06.695489 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m09:22:06.696178 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m09:22:06.696740 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m09:22:06.699697 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m09:22:06.700137 [info ] [Thread-1 (]: 41 of 91 PASS accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99  [[32mPASS[0m in 0.11s]
[0m09:22:06.700423 [info ] [Thread-3 (]: 45 of 91 START test not_null_stg_yellow_trips_dropoff_location_id .............. [RUN]
[0m09:22:06.700889 [info ] [Thread-4 (]: 46 of 91 START test not_null_stg_yellow_trips_fare_amount ...................... [RUN]
[0m09:22:06.701571 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m09:22:06.701895 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048)
[0m09:22:06.702234 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97)
[0m09:22:06.702635 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m09:22:06.703071 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m09:22:06.703622 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m09:22:06.704119 [info ] [Thread-1 (]: 47 of 91 START test not_null_stg_yellow_trips_pickup_datetime .................. [RUN]
[0m09:22:06.706763 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m09:22:06.708897 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m09:22:06.709472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed)
[0m09:22:06.710153 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m09:22:06.710498 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m09:22:06.711927 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m09:22:06.714331 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m09:22:06.715454 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m09:22:06.715777 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m09:22:06.718845 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m09:22:06.720273 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m09:22:06.723110 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m09:22:06.723520 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: BEGIN
[0m09:22:06.723805 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m09:22:06.724033 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m09:22:06.724216 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:22:06.724569 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: BEGIN
[0m09:22:06.726302 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m09:22:06.726725 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m09:22:06.727271 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:06.727916 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: BEGIN
[0m09:22:06.728452 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:06.733837 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m09:22:06.734196 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: BEGIN
[0m09:22:06.734557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:06.744281 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m09:22:06.744697 [debug] [Thread-2 (]: SQL status: OK in 0.020 seconds
[0m09:22:06.745004 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m09:22:06.745281 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m09:22:06.745535 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m09:22:06.746000 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m09:22:06.746332 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m09:22:06.746657 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fare_amount
from "dev"."main"."stg_yellow_trips"
where fare_amount is null



  
  
      
    ) dbt_internal_test
[0m09:22:06.747145 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m09:22:06.747505 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_datetime
from "dev"."main"."stg_yellow_trips"
where dropoff_datetime is null



  
  
      
    ) dbt_internal_test
[0m09:22:06.747894 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_location_id
from "dev"."main"."stg_yellow_trips"
where dropoff_location_id is null



  
  
      
    ) dbt_internal_test
[0m09:22:06.748646 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "dev"."main"."stg_yellow_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m09:22:06.749109 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:06.749922 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m09:22:06.751161 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: ROLLBACK
[0m09:22:06.751548 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m09:22:06.751816 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:22:06.752819 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: ROLLBACK
[0m09:22:06.753256 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97'
[0m09:22:06.753972 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: ROLLBACK
[0m09:22:06.754716 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: ROLLBACK
[0m09:22:06.755197 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052'
[0m09:22:06.755627 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: Close
[0m09:22:06.756263 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048'
[0m09:22:06.756844 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed'
[0m09:22:06.757126 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: Close
[0m09:22:06.757570 [info ] [Thread-4 (]: 46 of 91 PASS not_null_stg_yellow_trips_fare_amount ............................ [[32mPASS[0m in 0.06s]
[0m09:22:06.757780 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: Close
[0m09:22:06.758104 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: Close
[0m09:22:06.758570 [info ] [Thread-2 (]: 44 of 91 PASS not_null_stg_yellow_trips_dropoff_datetime ....................... [[32mPASS[0m in 0.07s]
[0m09:22:06.759054 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m09:22:06.759623 [info ] [Thread-3 (]: 45 of 91 PASS not_null_stg_yellow_trips_dropoff_location_id .................... [[32mPASS[0m in 0.06s]
[0m09:22:06.760316 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m09:22:06.760741 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m09:22:06.761187 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m09:22:06.761676 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m09:22:06.762040 [info ] [Thread-1 (]: 47 of 91 PASS not_null_stg_yellow_trips_pickup_datetime ........................ [[32mPASS[0m in 0.05s]
[0m09:22:06.762404 [info ] [Thread-4 (]: 48 of 91 START test not_null_stg_yellow_trips_pickup_location_id ............... [RUN]
[0m09:22:06.762777 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m09:22:06.763108 [info ] [Thread-2 (]: 49 of 91 START test not_null_stg_yellow_trips_total_amount ..................... [RUN]
[0m09:22:06.763603 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m09:22:06.764038 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1)
[0m09:22:06.764493 [info ] [Thread-3 (]: 50 of 91 START test not_null_stg_yellow_trips_trip_distance_miles .............. [RUN]
[0m09:22:06.765040 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6)
[0m09:22:06.765448 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m09:22:06.765762 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m09:22:06.766082 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7)
[0m09:22:06.766354 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m09:22:06.766710 [info ] [Thread-1 (]: 51 of 91 START test not_null_stg_yellow_trips_trip_id .......................... [RUN]
[0m09:22:06.769549 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m09:22:06.769961 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m09:22:06.772154 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m09:22:06.772568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1)
[0m09:22:06.774637 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m09:22:06.775160 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m09:22:06.777842 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m09:22:06.778794 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m09:22:06.780480 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m09:22:06.781834 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m09:22:06.782117 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m09:22:06.783670 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m09:22:06.783947 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m09:22:06.785565 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m09:22:06.788157 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m09:22:06.789308 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m09:22:06.789583 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: BEGIN
[0m09:22:06.789868 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:06.791028 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m09:22:06.791397 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m09:22:06.791733 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: BEGIN
[0m09:22:06.792116 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m09:22:06.792524 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: BEGIN
[0m09:22:06.792922 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:22:06.793415 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: BEGIN
[0m09:22:06.793883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:06.794453 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:06.810313 [debug] [Thread-4 (]: SQL status: OK in 0.020 seconds
[0m09:22:06.810661 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m09:22:06.810943 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m09:22:06.811174 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m09:22:06.811389 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m09:22:06.811883 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m09:22:06.812226 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m09:22:06.812572 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_location_id
from "dev"."main"."stg_yellow_trips"
where pickup_location_id is null



  
  
      
    ) dbt_internal_test
[0m09:22:06.812911 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m09:22:06.813205 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."stg_yellow_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m09:22:06.813538 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_distance_miles
from "dev"."main"."stg_yellow_trips"
where trip_distance_miles is null



  
  
      
    ) dbt_internal_test
[0m09:22:06.814370 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."stg_yellow_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m09:22:06.814694 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:06.815304 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m09:22:06.815668 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:06.816586 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: ROLLBACK
[0m09:22:06.816810 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:06.817611 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: ROLLBACK
[0m09:22:06.818352 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: ROLLBACK
[0m09:22:06.818950 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1'
[0m09:22:06.819710 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: ROLLBACK
[0m09:22:06.820159 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6'
[0m09:22:06.820816 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7'
[0m09:22:06.821193 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: Close
[0m09:22:06.821770 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1'
[0m09:22:06.822118 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: Close
[0m09:22:06.822476 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: Close
[0m09:22:06.823058 [info ] [Thread-4 (]: 48 of 91 PASS not_null_stg_yellow_trips_pickup_location_id ..................... [[32mPASS[0m in 0.06s]
[0m09:22:06.823320 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: Close
[0m09:22:06.823854 [info ] [Thread-2 (]: 49 of 91 PASS not_null_stg_yellow_trips_total_amount ........................... [[32mPASS[0m in 0.06s]
[0m09:22:06.824297 [info ] [Thread-3 (]: 50 of 91 PASS not_null_stg_yellow_trips_trip_distance_miles .................... [[32mPASS[0m in 0.06s]
[0m09:22:06.824741 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m09:22:06.825329 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m09:22:06.825706 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m09:22:06.826425 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m09:22:06.827142 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m09:22:06.827819 [info ] [Thread-1 (]: 51 of 91 PASS not_null_stg_yellow_trips_trip_id ................................ [[32mPASS[0m in 0.06s]
[0m09:22:06.828090 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m09:22:06.828492 [info ] [Thread-4 (]: 52 of 91 START test not_null_stg_yellow_trips_vendor_id ........................ [RUN]
[0m09:22:06.828896 [info ] [Thread-2 (]: 53 of 91 START test unique_stg_yellow_trips_trip_id ............................ [RUN]
[0m09:22:06.829317 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m09:22:06.829612 [info ] [Thread-3 (]: 54 of 91 START test relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_  [RUN]
[0m09:22:06.829981 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57)
[0m09:22:06.830317 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6, now test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965)
[0m09:22:06.830688 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m09:22:06.831108 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7, now test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a)
[0m09:22:06.831543 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m09:22:06.831993 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m09:22:06.832402 [info ] [Thread-1 (]: 55 of 91 START test relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_  [RUN]
[0m09:22:06.832775 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m09:22:06.835256 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m09:22:06.837865 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m09:22:06.838296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1, now test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f)
[0m09:22:06.842639 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m09:22:06.843706 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m09:22:06.846606 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m09:22:06.850849 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m09:22:06.851230 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m09:22:06.852851 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m09:22:06.854341 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m09:22:06.854641 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m09:22:06.856246 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m09:22:06.856527 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m09:22:06.858482 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m09:22:06.860057 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m09:22:06.860406 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m09:22:06.860724 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: BEGIN
[0m09:22:06.861361 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: BEGIN
[0m09:22:06.861806 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m09:22:06.862112 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:22:06.862755 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:06.863474 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: BEGIN
[0m09:22:06.864016 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m09:22:06.864731 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:06.865061 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: BEGIN
[0m09:22:06.865505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:06.881917 [debug] [Thread-2 (]: SQL status: OK in 0.020 seconds
[0m09:22:06.882238 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m09:22:06.882461 [debug] [Thread-4 (]: SQL status: OK in 0.020 seconds
[0m09:22:06.882667 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m09:22:06.882859 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m09:22:06.883250 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m09:22:06.883669 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m09:22:06.884012 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_yellow_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:22:06.884364 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m09:22:06.884701 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select dropoff_location_id as from_field
    from "dev"."main"."stg_yellow_trips"
    where dropoff_location_id is not null
),

parent as (
    select location_id as to_field
    from "dev"."main"."stg_taxi_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m09:22:06.885048 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "dev"."main"."stg_yellow_trips"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m09:22:06.885633 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select pickup_location_id as from_field
    from "dev"."main"."stg_yellow_trips"
    where pickup_location_id is not null
),

parent as (
    select location_id as to_field
    from "dev"."main"."stg_taxi_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m09:22:06.889667 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m09:22:06.894151 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: ROLLBACK
[0m09:22:06.895313 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57'
[0m09:22:06.895793 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: Close
[0m09:22:06.898390 [info ] [Thread-4 (]: 52 of 91 PASS not_null_stg_yellow_trips_vendor_id .............................. [[32mPASS[0m in 0.07s]
[0m09:22:06.901610 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m09:22:06.993166 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m09:22:06.994625 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: ROLLBACK
[0m09:22:06.994964 [debug] [Thread-3 (]: SQL status: OK in 0.108 seconds
[0m09:22:06.995716 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f'
[0m09:22:06.996535 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: ROLLBACK
[0m09:22:06.996732 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: Close
[0m09:22:06.997260 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a'
[0m09:22:06.998286 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: Close
[0m09:22:06.997782 [info ] [Thread-1 (]: 55 of 91 PASS relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_  [[32mPASS[0m in 0.16s]
[0m09:22:06.998897 [info ] [Thread-3 (]: 54 of 91 PASS relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_  [[32mPASS[0m in 0.17s]
[0m09:22:06.999556 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m09:22:07.000211 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m09:22:07.038019 [debug] [Thread-2 (]: SQL status: OK in 0.153 seconds
[0m09:22:07.039350 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: ROLLBACK
[0m09:22:07.040049 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965'
[0m09:22:07.040407 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: Close
[0m09:22:07.058220 [info ] [Thread-2 (]: 53 of 91 PASS unique_stg_yellow_trips_trip_id .................................. [[32mPASS[0m in 0.23s]
[0m09:22:07.058915 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m09:22:07.059775 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m09:22:07.060266 [info ] [Thread-4 (]: 56 of 91 START sql view model main.int_trip_metrics ............................ [RUN]
[0m09:22:07.060714 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57, now model.nyc_taxi_pipeline_00.int_trip_metrics)
[0m09:22:07.061046 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m09:22:07.064856 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m09:22:07.071831 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m09:22:07.126389 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m09:22:07.135375 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m09:22:07.135815 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: BEGIN
[0m09:22:07.136150 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:07.155172 [debug] [Thread-4 (]: SQL status: OK in 0.019 seconds
[0m09:22:07.155735 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m09:22:07.156229 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */

  
  create view "dev"."main"."int_trip_metrics__dbt_tmp" as (
    /*
    Intermediate model: Trip-level enrichment with calculated metrics.
    Uses adapter-dispatched macros for cross-dialect compatibility.
*/

with trips as (
    select * from "dev"."main"."stg_yellow_trips"
),

enriched as (
    select
        trip_id,
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        payment_type_id,
        pickup_datetime,
        dropoff_datetime,
        passenger_count,
        trip_distance_miles,
        store_and_fwd_flag,

        -- calculated: duration in minutes
        
    datediff('minute', pickup_datetime, dropoff_datetime)
 as trip_duration_minutes,

        -- calculated: average speed (avoid division by zero)
        case
            when 
    datediff('minute', pickup_datetime, dropoff_datetime)
 > 0
            then round(
                trip_distance_miles / (
    datediff('minute', pickup_datetime, dropoff_datetime)
 / 60.0),
                2
            )
            else null
        end as avg_speed_mph,

        -- calculated: cost per mile
        case
            when trip_distance_miles > 0
            then round(fare_amount / trip_distance_miles, 2)
            else null
        end as cost_per_mile,

        -- calculated: tip percentage
        case
            when fare_amount > 0
            then round((tip_amount / fare_amount) * 100, 2)
            else null
        end as tip_percentage,

        -- time dimensions (using adapter-dispatched macros)
        date_trunc('day', pickup_datetime)::date as pickup_date,
        extract(hour from pickup_datetime) as pickup_hour,
        
    dayname(pickup_datetime)
 as pickup_day_of_week,
        case
            when extract(dow from pickup_datetime) in (0, 6) then true
            else false
        end as is_weekend,

        -- financials passthrough
        fare_amount,
        extra_amount,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount,
        congestion_surcharge,
        airport_fee

    from trips
)

select *
from enriched
where trip_duration_minutes between 1 and 720
  and (avg_speed_mph is null or avg_speed_mph < 100)
  );

[0m09:22:07.157962 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:07.160148 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m09:22:07.160617 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
alter view "dev"."main"."int_trip_metrics" rename to "int_trip_metrics__dbt_backup"
[0m09:22:07.161248 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m09:22:07.162744 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m09:22:07.163077 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
alter view "dev"."main"."int_trip_metrics__dbt_tmp" rename to "int_trip_metrics"
[0m09:22:07.163662 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m09:22:07.164438 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: COMMIT
[0m09:22:07.164750 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m09:22:07.165040 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: COMMIT
[0m09:22:07.170175 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m09:22:07.171890 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m09:22:07.172307 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
drop view if exists "dev"."main"."int_trip_metrics__dbt_backup" cascade
[0m09:22:07.175927 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m09:22:07.176999 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: Close
[0m09:22:07.212552 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71253560f230>]}
[0m09:22:07.213382 [info ] [Thread-4 (]: 56 of 91 OK created sql view model main.int_trip_metrics ....................... [[32mOK[0m in 0.15s]
[0m09:22:07.213979 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m09:22:07.214995 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m09:22:07.215202 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m09:22:07.215429 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m09:22:07.215671 [info ] [Thread-3 (]: 57 of 91 START test assert_trip_duration_positive .............................. [RUN]
[0m09:22:07.215872 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m09:22:07.216285 [info ] [Thread-2 (]: 58 of 91 START test dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0  [RUN]
[0m09:22:07.216749 [info ] [Thread-1 (]: 59 of 91 START test dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1  [RUN]
[0m09:22:07.217437 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a, now test.nyc_taxi_pipeline_00.assert_trip_duration_positive)
[0m09:22:07.218034 [info ] [Thread-4 (]: 60 of 91 START test not_null_int_trip_metrics_is_weekend ....................... [RUN]
[0m09:22:07.218625 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574)
[0m09:22:07.219014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718)
[0m09:22:07.219400 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m09:22:07.219806 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_trip_metrics, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed)
[0m09:22:07.220287 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m09:22:07.220616 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m09:22:07.222676 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m09:22:07.223077 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m09:22:07.227384 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m09:22:07.229908 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m09:22:07.232411 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m09:22:07.235879 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m09:22:07.238552 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m09:22:07.238875 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m09:22:07.240385 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m09:22:07.241066 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m09:22:07.242558 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m09:22:07.242821 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m09:22:07.244429 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m09:22:07.246660 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m09:22:07.247154 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: BEGIN
[0m09:22:07.247499 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:07.247800 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m09:22:07.248231 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m09:22:07.248498 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: BEGIN
[0m09:22:07.248862 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: BEGIN
[0m09:22:07.249334 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m09:22:07.249584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:07.249978 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:07.250376 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: BEGIN
[0m09:22:07.251063 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:22:07.266998 [debug] [Thread-3 (]: SQL status: OK in 0.019 seconds
[0m09:22:07.267493 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m09:22:07.267787 [debug] [Thread-4 (]: SQL status: OK in 0.018 seconds
[0m09:22:07.268080 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m09:22:07.268319 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m09:22:07.268771 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m09:22:07.269211 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m09:22:07.269634 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
    Singular test: No trip should have negative duration.
*/

select
    trip_id,
    pickup_datetime,
    dropoff_datetime,
    trip_duration_minutes
from "dev"."main"."int_trip_metrics"
where trip_duration_minutes < 0
  
  
      
    ) dbt_internal_test
[0m09:22:07.270032 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m09:22:07.270409 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_trip_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not trip_duration_minutes >= 1
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not trip_duration_minutes <= 720
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m09:22:07.270712 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."int_trip_metrics"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m09:22:07.271285 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_trip_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m09:22:07.272090 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:07.273705 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: ROLLBACK
[0m09:22:07.274032 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:07.276289 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.assert_trip_duration_positive'
[0m09:22:07.278054 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: ROLLBACK
[0m09:22:07.279222 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: Close
[0m09:22:07.281193 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed'
[0m09:22:07.283077 [info ] [Thread-3 (]: 57 of 91 PASS assert_trip_duration_positive .................................... [[32mPASS[0m in 0.07s]
[0m09:22:07.284763 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: Close
[0m09:22:07.286549 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m09:22:07.288774 [info ] [Thread-4 (]: 60 of 91 PASS not_null_int_trip_metrics_is_weekend ............................. [[32mPASS[0m in 0.07s]
[0m09:22:07.289531 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m09:22:07.292217 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m09:22:07.294477 [info ] [Thread-3 (]: 61 of 91 START test not_null_int_trip_metrics_pickup_date ...................... [RUN]
[0m09:22:07.296564 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m09:22:07.297944 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.assert_trip_duration_positive, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3)
[0m09:22:07.300513 [info ] [Thread-4 (]: 62 of 91 START test not_null_int_trip_metrics_pickup_hour ...................... [RUN]
[0m09:22:07.303002 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m09:22:07.304704 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082)
[0m09:22:07.309519 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m09:22:07.311523 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m09:22:07.318289 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m09:22:07.324440 [debug] [Thread-2 (]: SQL status: OK in 0.052 seconds
[0m09:22:07.326329 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: ROLLBACK
[0m09:22:07.327111 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574'
[0m09:22:07.327403 [debug] [Thread-1 (]: SQL status: OK in 0.056 seconds
[0m09:22:07.327635 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: Close
[0m09:22:07.329504 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: ROLLBACK
[0m09:22:07.329974 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m09:22:07.330506 [info ] [Thread-2 (]: 58 of 91 PASS dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0 ..... [[32mPASS[0m in 0.11s]
[0m09:22:07.331241 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718'
[0m09:22:07.332813 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m09:22:07.333031 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m09:22:07.333515 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m09:22:07.333885 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: Close
[0m09:22:07.335763 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m09:22:07.336237 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m09:22:07.337137 [info ] [Thread-2 (]: 63 of 91 START test not_null_int_trip_metrics_trip_duration_minutes ............ [RUN]
[0m09:22:07.337509 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c)
[0m09:22:07.337855 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m09:22:07.340377 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m09:22:07.340937 [info ] [Thread-1 (]: 59 of 91 PASS dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1  [[32mPASS[0m in 0.12s]
[0m09:22:07.342054 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m09:22:07.342562 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m09:22:07.342931 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m09:22:07.343513 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: BEGIN
[0m09:22:07.344153 [info ] [Thread-1 (]: 64 of 91 START test not_null_int_trip_metrics_trip_id .......................... [RUN]
[0m09:22:07.344587 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:07.344945 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m09:22:07.345232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f)
[0m09:22:07.345795 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: BEGIN
[0m09:22:07.346122 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m09:22:07.346440 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:07.350874 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m09:22:07.352274 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m09:22:07.353799 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m09:22:07.355470 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m09:22:07.357789 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m09:22:07.362596 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m09:22:07.363155 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: BEGIN
[0m09:22:07.363529 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m09:22:07.363892 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:22:07.364279 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: BEGIN
[0m09:22:07.365084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:07.365382 [debug] [Thread-3 (]: SQL status: OK in 0.021 seconds
[0m09:22:07.365625 [debug] [Thread-4 (]: SQL status: OK in 0.019 seconds
[0m09:22:07.365848 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m09:22:07.366273 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:07.366499 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m09:22:07.366864 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m09:22:07.367201 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m09:22:07.367645 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m09:22:07.368066 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_trip_metrics"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m09:22:07.368511 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."int_trip_metrics"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m09:22:07.368943 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_duration_minutes
from "dev"."main"."int_trip_metrics"
where trip_duration_minutes is null



  
  
      
    ) dbt_internal_test
[0m09:22:07.369350 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."int_trip_metrics"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m09:22:07.371371 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:07.371809 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m09:22:07.372861 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: ROLLBACK
[0m09:22:07.373157 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:22:07.376708 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: ROLLBACK
[0m09:22:07.377837 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082'
[0m09:22:07.379665 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: ROLLBACK
[0m09:22:07.381261 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3'
[0m09:22:07.383462 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: Close
[0m09:22:07.385917 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f'
[0m09:22:07.387719 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: Close
[0m09:22:07.388892 [info ] [Thread-4 (]: 62 of 91 PASS not_null_int_trip_metrics_pickup_hour ............................ [[32mPASS[0m in 0.08s]
[0m09:22:07.391222 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: Close
[0m09:22:07.392867 [info ] [Thread-3 (]: 61 of 91 PASS not_null_int_trip_metrics_pickup_date ............................ [[32mPASS[0m in 0.10s]
[0m09:22:07.395062 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m09:22:07.396935 [info ] [Thread-1 (]: 64 of 91 PASS not_null_int_trip_metrics_trip_id ................................ [[32mPASS[0m in 0.05s]
[0m09:22:07.398855 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m09:22:07.402101 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m09:22:07.423987 [debug] [Thread-2 (]: SQL status: OK in 0.054 seconds
[0m09:22:07.425321 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: ROLLBACK
[0m09:22:07.425919 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c'
[0m09:22:07.426219 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: Close
[0m09:22:07.431249 [info ] [Thread-2 (]: 63 of 91 PASS not_null_int_trip_metrics_trip_duration_minutes .................. [[32mPASS[0m in 0.09s]
[0m09:22:07.431836 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m09:22:07.432550 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.int_daily_summary
[0m09:22:07.432862 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m09:22:07.433138 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.fct_trips
[0m09:22:07.433511 [info ] [Thread-4 (]: 65 of 91 START sql view model main.int_daily_summary ........................... [RUN]
[0m09:22:07.434011 [info ] [Thread-3 (]: 66 of 91 START sql view model main.int_hourly_patterns ......................... [RUN]
[0m09:22:07.434500 [info ] [Thread-1 (]: 67 of 91 START sql incremental model main.fct_trips ............................ [RUN]
[0m09:22:07.434965 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082, now model.nyc_taxi_pipeline_00.int_daily_summary)
[0m09:22:07.435350 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3, now model.nyc_taxi_pipeline_00.int_hourly_patterns)
[0m09:22:07.435713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f, now model.nyc_taxi_pipeline_00.fct_trips)
[0m09:22:07.436027 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.int_daily_summary
[0m09:22:07.436403 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m09:22:07.436850 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.fct_trips
[0m09:22:07.439073 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m09:22:07.440670 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m09:22:07.444479 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.fct_trips"
[0m09:22:07.448913 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.int_daily_summary
[0m09:22:07.449345 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m09:22:07.451756 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m09:22:07.454150 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m09:22:07.455381 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.fct_trips
[0m09:22:07.473187 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m09:22:07.473784 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
DESCRIBE (select * from (
        /*
    Fact table: Fully enriched trip records with location names.
    Incremental with delete+insert strategy.
*/



with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

pickup_locations as (
    select * from "dev"."main"."dim_locations"
),

dropoff_locations as (
    select * from "dev"."main"."dim_locations"
),

final as (
    select
        t.trip_id,
        t.vendor_id,
        t.rate_code_id,
        t.payment_type_id,
        t.pickup_location_id,
        t.dropoff_location_id,
        t.pickup_datetime,
        t.dropoff_datetime,
        t.pickup_date,
        t.pickup_hour,
        t.pickup_day_of_week,
        t.is_weekend,
        t.passenger_count,
        t.trip_distance_miles,
        t.trip_duration_minutes,
        t.avg_speed_mph,
        t.cost_per_mile,
        t.fare_amount,
        t.extra_amount,
        t.mta_tax,
        t.tip_amount,
        t.tip_percentage,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.congestion_surcharge,
        t.airport_fee,

        -- enriched from dimensions
        pu.borough as pickup_borough,
        pu.zone_name as pickup_zone,
        do_loc.borough as dropoff_borough,
        do_loc.zone_name as dropoff_zone

    from trip_metrics t
    left join pickup_locations pu
        on t.pickup_location_id = pu.location_id
    left join dropoff_locations do_loc
        on t.dropoff_location_id = do_loc.location_id

    
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m09:22:07.474269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:07.474527 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m09:22:07.474994 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: BEGIN
[0m09:22:07.475292 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:07.475527 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m09:22:07.475919 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: BEGIN
[0m09:22:07.476243 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:07.490541 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m09:22:07.490842 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m09:22:07.491063 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m09:22:07.491388 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m09:22:07.491612 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m09:22:07.491940 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */

  
  create view "dev"."main"."int_hourly_patterns__dbt_tmp" as (
    /*
    Intermediate model: Hourly trip patterns by date.
    One row per date + hour combination.
*/

with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

hourly_agg as (
    select
        pickup_date,
        pickup_hour,
        pickup_day_of_week,
        is_weekend,

        count(*) as total_trips,
        round(avg(trip_distance_miles), 2) as avg_distance,
        round(avg(trip_duration_minutes), 2) as avg_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue

    from trip_metrics
    group by pickup_date, pickup_hour, pickup_day_of_week, is_weekend
)

select * from hourly_agg
  );

[0m09:22:07.493675 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m09:22:07.493911 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */

  
  create view "dev"."main"."int_daily_summary__dbt_tmp" as (
    /*
    Intermediate model: Daily aggregated trip and revenue metrics.
    One row per day with counts, averages, and revenue totals.
*/

with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

daily_agg as (
    select
        pickup_date,
        pickup_day_of_week,
        is_weekend,

        count(*) as total_trips,
        sum(passenger_count) as total_passengers,

        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(avg(avg_speed_mph), 2) as avg_speed_mph,

        round(sum(fare_amount), 2) as total_fare_revenue,
        round(sum(tip_amount), 2) as total_tip_revenue,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_trip_revenue,
        round(avg(tip_percentage), 2) as avg_tip_percentage,

        count(case when payment_type_id = 1 then 1 end) as credit_card_trips,
        count(case when payment_type_id = 2 then 1 end) as cash_trips

    from trip_metrics
    group by pickup_date, pickup_day_of_week, is_weekend
)

select * from daily_agg
  );

[0m09:22:07.494577 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as varchar)
 as trip_id, 
      
    cast(null as integer)
 as vendor_id, 
      
    cast(null as integer)
 as rate_code_id, 
      
    cast(null as integer)
 as payment_type_id, 
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as integer)
 as dropoff_location_id, 
      
    cast(null as timestamp)
 as pickup_datetime, 
      
    cast(null as timestamp)
 as dropoff_datetime, 
      
    cast(null as date)
 as pickup_date, 
      
    cast(null as bigint)
 as pickup_hour, 
      
    cast(null as varchar)
 as pickup_day_of_week, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as integer)
 as passenger_count, 
      
    cast(null as double)
 as trip_distance_miles, 
      
    cast(null as bigint)
 as trip_duration_minutes, 
      
    cast(null as double)
 as avg_speed_mph, 
      
    cast(null as double)
 as cost_per_mile, 
      
    cast(null as decimal(10,2))
 as fare_amount, 
      
    cast(null as decimal(10,2))
 as extra_amount, 
      
    cast(null as decimal(10,2))
 as mta_tax, 
      
    cast(null as decimal(10,2))
 as tip_amount, 
      
    cast(null as double)
 as tip_percentage, 
      
    cast(null as decimal(10,2))
 as tolls_amount, 
      
    cast(null as decimal(10,2))
 as improvement_surcharge, 
      
    cast(null as decimal(10,2))
 as total_amount, 
      
    cast(null as decimal(10,2))
 as congestion_surcharge, 
      
    cast(null as decimal(10,2))
 as airport_fee, 
      
    cast(null as varchar)
 as pickup_borough, 
      
    cast(null as varchar)
 as pickup_zone, 
      
    cast(null as varchar)
 as dropoff_borough, 
      
    cast(null as varchar)
 as dropoff_zone
    ) as __dbt_sbq
    where false
    limit 0
)
[0m09:22:07.495272 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:07.497499 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m09:22:07.497753 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:22:07.497948 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m09:22:07.498140 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
alter view "dev"."main"."int_hourly_patterns" rename to "int_hourly_patterns__dbt_backup"
[0m09:22:07.500607 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.fct_trips"
[0m09:22:07.502218 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m09:22:07.503003 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m09:22:07.503189 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
alter view "dev"."main"."int_daily_summary" rename to "int_daily_summary__dbt_backup"
[0m09:22:07.504765 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m09:22:07.505389 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
alter view "dev"."main"."int_hourly_patterns__dbt_tmp" rename to "int_hourly_patterns"
[0m09:22:07.505655 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:07.507158 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m09:22:07.507342 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:07.507556 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
alter view "dev"."main"."int_daily_summary__dbt_tmp" rename to "int_daily_summary"
[0m09:22:07.508486 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: COMMIT
[0m09:22:07.509250 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m09:22:07.509652 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:07.509998 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: COMMIT
[0m09:22:07.510322 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m09:22:07.511060 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: COMMIT
[0m09:22:07.511634 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.fct_trips: BEGIN
[0m09:22:07.511977 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m09:22:07.512494 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:22:07.512692 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: COMMIT
[0m09:22:07.513038 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m09:22:07.513563 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */

  
    
    
      
    

    create  table
      "dev"."main"."fct_trips__dbt_tmp"
  
  (
    trip_id varchar,
    vendor_id integer,
    rate_code_id integer,
    payment_type_id integer,
    pickup_location_id integer,
    dropoff_location_id integer,
    pickup_datetime timestamp,
    dropoff_datetime timestamp,
    pickup_date date,
    pickup_hour bigint,
    pickup_day_of_week varchar,
    is_weekend boolean,
    passenger_count integer,
    trip_distance_miles double,
    trip_duration_minutes bigint,
    avg_speed_mph double,
    cost_per_mile double,
    fare_amount decimal(10,2),
    extra_amount decimal(10,2),
    mta_tax decimal(10,2),
    tip_amount decimal(10,2),
    tip_percentage double,
    tolls_amount decimal(10,2),
    improvement_surcharge decimal(10,2),
    total_amount decimal(10,2),
    congestion_surcharge decimal(10,2),
    airport_fee decimal(10,2),
    pickup_borough varchar,
    pickup_zone varchar,
    dropoff_borough varchar,
    dropoff_zone varchar
    
    )
 ;
    insert into "dev"."main"."fct_trips__dbt_tmp" 
  (
    
      
      trip_id ,
    
      
      vendor_id ,
    
      
      rate_code_id ,
    
      
      payment_type_id ,
    
      
      pickup_location_id ,
    
      
      dropoff_location_id ,
    
      
      pickup_datetime ,
    
      
      dropoff_datetime ,
    
      
      pickup_date ,
    
      
      pickup_hour ,
    
      
      pickup_day_of_week ,
    
      
      is_weekend ,
    
      
      passenger_count ,
    
      
      trip_distance_miles ,
    
      
      trip_duration_minutes ,
    
      
      avg_speed_mph ,
    
      
      cost_per_mile ,
    
      
      fare_amount ,
    
      
      extra_amount ,
    
      
      mta_tax ,
    
      
      tip_amount ,
    
      
      tip_percentage ,
    
      
      tolls_amount ,
    
      
      improvement_surcharge ,
    
      
      total_amount ,
    
      
      congestion_surcharge ,
    
      
      airport_fee ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      dropoff_borough ,
    
      
      dropoff_zone 
    
  )
 (
      
    select trip_id, vendor_id, rate_code_id, payment_type_id, pickup_location_id, dropoff_location_id, pickup_datetime, dropoff_datetime, pickup_date, pickup_hour, pickup_day_of_week, is_weekend, passenger_count, trip_distance_miles, trip_duration_minutes, avg_speed_mph, cost_per_mile, fare_amount, extra_amount, mta_tax, tip_amount, tip_percentage, tolls_amount, improvement_surcharge, total_amount, congestion_surcharge, airport_fee, pickup_borough, pickup_zone, dropoff_borough, dropoff_zone
    from (
        /*
    Fact table: Fully enriched trip records with location names.
    Incremental with delete+insert strategy.
*/



with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

pickup_locations as (
    select * from "dev"."main"."dim_locations"
),

dropoff_locations as (
    select * from "dev"."main"."dim_locations"
),

final as (
    select
        t.trip_id,
        t.vendor_id,
        t.rate_code_id,
        t.payment_type_id,
        t.pickup_location_id,
        t.dropoff_location_id,
        t.pickup_datetime,
        t.dropoff_datetime,
        t.pickup_date,
        t.pickup_hour,
        t.pickup_day_of_week,
        t.is_weekend,
        t.passenger_count,
        t.trip_distance_miles,
        t.trip_duration_minutes,
        t.avg_speed_mph,
        t.cost_per_mile,
        t.fare_amount,
        t.extra_amount,
        t.mta_tax,
        t.tip_amount,
        t.tip_percentage,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.congestion_surcharge,
        t.airport_fee,

        -- enriched from dimensions
        pu.borough as pickup_borough,
        pu.zone_name as pickup_zone,
        do_loc.borough as dropoff_borough,
        do_loc.zone_name as dropoff_zone

    from trip_metrics t
    left join pickup_locations pu
        on t.pickup_location_id = pu.location_id
    left join dropoff_locations do_loc
        on t.dropoff_location_id = do_loc.location_id

    
)

select * from final
    ) as model_subq
    );
  
  
  
[0m09:22:07.516817 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m09:22:07.518289 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m09:22:07.518598 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
drop view if exists "dev"."main"."int_hourly_patterns__dbt_backup" cascade
[0m09:22:07.518982 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m09:22:07.520695 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m09:22:07.523322 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
drop view if exists "dev"."main"."int_daily_summary__dbt_backup" cascade
[0m09:22:07.523891 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m09:22:07.527017 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: Close
[0m09:22:07.529357 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125348eaea0>]}
[0m09:22:07.530417 [info ] [Thread-3 (]: 66 of 91 OK created sql view model main.int_hourly_patterns .................... [[32mOK[0m in 0.09s]
[0m09:22:07.532991 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m09:22:07.533311 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m09:22:07.535093 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m09:22:07.535364 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m09:22:07.537337 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: Close
[0m09:22:07.539068 [info ] [Thread-2 (]: 68 of 91 START test dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0  [RUN]
[0m09:22:07.541277 [info ] [Thread-3 (]: 69 of 91 START test not_null_int_hourly_patterns_pickup_date ................... [RUN]
[0m09:22:07.543632 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71253712b8f0>]}
[0m09:22:07.544655 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe)
[0m09:22:07.548131 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_hourly_patterns, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2)
[0m09:22:07.550488 [info ] [Thread-4 (]: 65 of 91 OK created sql view model main.int_daily_summary ...................... [[32mOK[0m in 0.11s]
[0m09:22:07.552449 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m09:22:07.553379 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m09:22:07.556002 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.int_daily_summary
[0m09:22:07.560709 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m09:22:07.565843 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m09:22:07.567598 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m09:22:07.573478 [info ] [Thread-4 (]: 70 of 91 START test not_null_int_hourly_patterns_pickup_hour ................... [RUN]
[0m09:22:07.575506 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_daily_summary, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d)
[0m09:22:07.577998 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m09:22:07.582693 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m09:22:07.604395 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m09:22:07.607808 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m09:22:07.610620 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m09:22:07.614224 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m09:22:07.614834 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m09:22:07.620510 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m09:22:07.633374 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m09:22:07.634420 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: BEGIN
[0m09:22:07.634847 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m09:22:07.635500 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:07.636209 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: BEGIN
[0m09:22:07.637113 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:07.637568 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:22:07.638229 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m09:22:07.638568 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m09:22:07.639424 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m09:22:07.640241 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: BEGIN
[0m09:22:07.641084 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."int_hourly_patterns"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m09:22:07.641932 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m09:22:07.642547 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:07.643860 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_hourly_patterns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m09:22:07.644865 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m09:22:07.645875 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:07.647386 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m09:22:07.651512 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: ROLLBACK
[0m09:22:07.654055 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d'
[0m09:22:07.654609 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: Close
[0m09:22:07.652087 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_hourly_patterns"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m09:22:07.655665 [info ] [Thread-4 (]: 70 of 91 PASS not_null_int_hourly_patterns_pickup_hour ......................... [[32mPASS[0m in 0.08s]
[0m09:22:07.656997 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m09:22:07.658223 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m09:22:07.660283 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m09:22:07.663871 [info ] [Thread-4 (]: 71 of 91 START test not_null_int_hourly_patterns_total_trips ................... [RUN]
[0m09:22:07.663128 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: ROLLBACK
[0m09:22:07.665054 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf)
[0m09:22:07.674590 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m09:22:07.672331 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2'
[0m09:22:07.679769 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m09:22:07.681061 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: Close
[0m09:22:07.683719 [info ] [Thread-3 (]: 69 of 91 PASS not_null_int_hourly_patterns_pickup_date ......................... [[32mPASS[0m in 0.14s]
[0m09:22:07.686090 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m09:22:07.688417 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m09:22:07.690163 [info ] [Thread-3 (]: 72 of 91 START test dbt_utils_accepted_range_int_daily_summary_total_trips__0 .. [RUN]
[0m09:22:07.691082 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863)
[0m09:22:07.692620 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m09:22:07.699926 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m09:22:07.725295 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m09:22:07.729386 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m09:22:07.737813 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m09:22:07.744068 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m09:22:07.774479 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m09:22:07.778501 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: BEGIN
[0m09:22:07.780492 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:07.787019 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m09:22:07.789592 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m09:22:07.790259 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_trips
from "dev"."main"."int_hourly_patterns"
where total_trips is null



  
  
      
    ) dbt_internal_test
[0m09:22:07.790707 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m09:22:07.791530 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: BEGIN
[0m09:22:07.792566 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:07.793340 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:07.793909 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m09:22:07.794426 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_daily_summary"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_trips >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m09:22:07.980248 [debug] [Thread-2 (]: SQL status: OK in 0.335 seconds
[0m09:22:07.983284 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: ROLLBACK
[0m09:22:07.984973 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe'
[0m09:22:07.987523 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: Close
[0m09:22:07.989422 [info ] [Thread-2 (]: 68 of 91 PASS dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0 .. [[32mPASS[0m in 0.44s]
[0m09:22:07.991910 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m09:22:07.993111 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m09:22:07.996149 [info ] [Thread-2 (]: 73 of 91 START test not_null_int_daily_summary_pickup_date ..................... [RUN]
[0m09:22:08.003211 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686)
[0m09:22:08.005672 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m09:22:08.014204 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m09:22:08.028055 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m09:22:08.031965 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m09:22:08.041861 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m09:22:08.042758 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: BEGIN
[0m09:22:08.043211 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:22:08.044117 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m09:22:08.044660 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m09:22:08.045131 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_daily_summary"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m09:22:08.047514 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m09:22:08.049282 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: ROLLBACK
[0m09:22:08.050112 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686'
[0m09:22:08.050521 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: Close
[0m09:22:08.051200 [info ] [Thread-2 (]: 73 of 91 PASS not_null_int_daily_summary_pickup_date ........................... [[32mPASS[0m in 0.05s]
[0m09:22:08.051753 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m09:22:08.052173 [debug] [Thread-3 (]: SQL status: OK in 0.257 seconds
[0m09:22:08.052496 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m09:22:08.054010 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: ROLLBACK
[0m09:22:08.054323 [info ] [Thread-2 (]: 74 of 91 START test not_null_int_daily_summary_total_revenue ................... [RUN]
[0m09:22:08.055102 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863'
[0m09:22:08.055556 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50)
[0m09:22:08.055951 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: Close
[0m09:22:08.056533 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m09:22:08.057406 [info ] [Thread-3 (]: 72 of 91 PASS dbt_utils_accepted_range_int_daily_summary_total_trips__0 ........ [[32mPASS[0m in 0.37s]
[0m09:22:08.060787 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m09:22:08.061730 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m09:22:08.062590 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m09:22:08.063032 [info ] [Thread-3 (]: 75 of 91 START test not_null_int_daily_summary_total_trips ..................... [RUN]
[0m09:22:08.063507 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10)
[0m09:22:08.063905 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m09:22:08.066922 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m09:22:08.072043 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m09:22:08.074067 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m09:22:08.074397 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m09:22:08.076319 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m09:22:08.081656 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m09:22:08.082406 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: BEGIN
[0m09:22:08.082874 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:22:08.083589 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m09:22:08.084153 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m09:22:08.084562 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m09:22:08.084876 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "dev"."main"."int_daily_summary"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m09:22:08.085399 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: BEGIN
[0m09:22:08.086199 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:08.087061 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:08.087485 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m09:22:08.088223 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_trips
from "dev"."main"."int_daily_summary"
where total_trips is null



  
  
      
    ) dbt_internal_test
[0m09:22:08.126405 [debug] [Thread-4 (]: SQL status: OK in 0.335 seconds
[0m09:22:08.127846 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: ROLLBACK
[0m09:22:08.129008 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf'
[0m09:22:08.129727 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: Close
[0m09:22:08.130516 [info ] [Thread-4 (]: 71 of 91 PASS not_null_int_hourly_patterns_total_trips ......................... [[32mPASS[0m in 0.47s]
[0m09:22:08.131159 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m09:22:08.131615 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m09:22:08.132061 [info ] [Thread-4 (]: 76 of 91 START test unique_int_daily_summary_pickup_date ....................... [RUN]
[0m09:22:08.132660 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf, now test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e)
[0m09:22:08.133105 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m09:22:08.137334 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m09:22:08.149806 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m09:22:08.152127 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m09:22:08.163753 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m09:22:08.164446 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: BEGIN
[0m09:22:08.164912 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:08.165870 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:08.166215 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m09:22:08.166544 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pickup_date as unique_field,
    count(*) as n_records

from "dev"."main"."int_daily_summary"
where pickup_date is not null
group by pickup_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:22:08.273600 [debug] [Thread-2 (]: SQL status: OK in 0.188 seconds
[0m09:22:08.275051 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: ROLLBACK
[0m09:22:08.275803 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50'
[0m09:22:08.276236 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: Close
[0m09:22:08.276796 [info ] [Thread-2 (]: 74 of 91 PASS not_null_int_daily_summary_total_revenue ......................... [[32mPASS[0m in 0.22s]
[0m09:22:08.277365 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m09:22:08.277935 [debug] [Thread-2 (]: Began running node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m09:22:08.278402 [info ] [Thread-2 (]: 77 of 91 START sql table model main.mart_hourly_demand ......................... [RUN]
[0m09:22:08.278827 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50, now model.nyc_taxi_pipeline_00.mart_hourly_demand)
[0m09:22:08.279182 [debug] [Thread-2 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m09:22:08.281226 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m09:22:08.290403 [debug] [Thread-2 (]: Began executing node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m09:22:08.294193 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m09:22:08.294806 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Hourly demand patterns.
*/

with hourly as (
    select * from "dev"."main"."int_hourly_patterns"
),

final as (
    select
        pickup_hour,
        is_weekend,

        count(*) as days_observed,
        round(avg(total_trips), 0) as avg_trips_per_period,
        round(avg(avg_distance), 2) as avg_distance,
        round(avg(avg_duration_min), 2) as avg_duration_min,
        round(avg(total_revenue), 2) as avg_revenue_per_period,
        sum(total_trips) as total_trips_all_days

    from hourly
    group by pickup_hour, is_weekend
)

select * from final
order by is_weekend, pickup_hour
    ) as __dbt_sbq
    where false
    limit 0
)
[0m09:22:08.295401 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:22:08.297813 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m09:22:08.299856 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m09:22:08.300376 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as bigint)
 as pickup_hour, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as bigint)
 as days_observed, 
      
    cast(null as double)
 as avg_trips_per_period, 
      
    cast(null as double)
 as avg_distance, 
      
    cast(null as double)
 as avg_duration_min, 
      
    cast(null as double)
 as avg_revenue_per_period, 
      
    cast(null as hugeint)
 as total_trips_all_days
    ) as __dbt_sbq
    where false
    limit 0
)
[0m09:22:08.301309 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m09:22:08.303738 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m09:22:08.311989 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m09:22:08.312533 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: BEGIN
[0m09:22:08.313203 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m09:22:08.313648 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m09:22:08.314067 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_hourly_demand__dbt_tmp"
  
  (
    pickup_hour bigint,
    is_weekend boolean,
    days_observed bigint,
    avg_trips_per_period double,
    avg_distance double,
    avg_duration_min double,
    avg_revenue_per_period double,
    total_trips_all_days hugeint
    
    )
 ;
    insert into "dev"."main"."mart_hourly_demand__dbt_tmp" 
  (
    
      
      pickup_hour ,
    
      
      is_weekend ,
    
      
      days_observed ,
    
      
      avg_trips_per_period ,
    
      
      avg_distance ,
    
      
      avg_duration_min ,
    
      
      avg_revenue_per_period ,
    
      
      total_trips_all_days 
    
  )
 (
      
    select pickup_hour, is_weekend, days_observed, avg_trips_per_period, avg_distance, avg_duration_min, avg_revenue_per_period, total_trips_all_days
    from (
        /*
    Analytics mart: Hourly demand patterns.
*/

with hourly as (
    select * from "dev"."main"."int_hourly_patterns"
),

final as (
    select
        pickup_hour,
        is_weekend,

        count(*) as days_observed,
        round(avg(total_trips), 0) as avg_trips_per_period,
        round(avg(avg_distance), 2) as avg_distance,
        round(avg(avg_duration_min), 2) as avg_duration_min,
        round(avg(total_revenue), 2) as avg_revenue_per_period,
        sum(total_trips) as total_trips_all_days

    from hourly
    group by pickup_hour, is_weekend
)

select * from final
order by is_weekend, pickup_hour
    ) as model_subq
    );
  
  
[0m09:22:08.337320 [debug] [Thread-3 (]: SQL status: OK in 0.249 seconds
[0m09:22:08.339127 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: ROLLBACK
[0m09:22:08.340071 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10'
[0m09:22:08.340720 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: Close
[0m09:22:08.341486 [info ] [Thread-3 (]: 75 of 91 PASS not_null_int_daily_summary_total_trips ........................... [[32mPASS[0m in 0.28s]
[0m09:22:08.342217 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m09:22:08.367009 [debug] [Thread-4 (]: SQL status: OK in 0.200 seconds
[0m09:22:08.368522 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: ROLLBACK
[0m09:22:08.369528 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e'
[0m09:22:08.369974 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: Close
[0m09:22:08.370683 [info ] [Thread-4 (]: 76 of 91 PASS unique_int_daily_summary_pickup_date ............................. [[32mPASS[0m in 0.24s]
[0m09:22:08.371230 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m09:22:08.371968 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m09:22:08.372485 [info ] [Thread-3 (]: 78 of 91 START sql table model main.mart_daily_revenue ......................... [RUN]
[0m09:22:08.373002 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10, now model.nyc_taxi_pipeline_00.mart_daily_revenue)
[0m09:22:08.373451 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m09:22:08.375962 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m09:22:08.384623 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m09:22:08.387198 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m09:22:08.387714 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Daily revenue metrics with running totals.
*/

with daily as (
    select * from "dev"."main"."int_daily_summary"
),

dates as (
    select * from "dev"."main"."dim_dates"
),

final as (
    select
        d.date_key,
        d.day_of_week_name,
        d.is_weekend,
        d.is_holiday,
        d.week_of_year,

        daily.total_trips,
        daily.total_passengers,
        daily.total_fare_revenue,
        daily.total_tip_revenue,
        daily.total_revenue,
        daily.avg_trip_revenue,
        daily.avg_tip_percentage,
        daily.credit_card_trips,
        daily.cash_trips,
        daily.avg_trip_distance,
        daily.avg_trip_duration_min,

        -- running total
        sum(daily.total_revenue) over (order by d.date_key) as cumulative_revenue,

        -- day-over-day change
        daily.total_revenue - lag(daily.total_revenue) over (order by d.date_key) as revenue_change_vs_prior_day

    from daily
    inner join dates d
        on daily.pickup_date = d.date_key
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m09:22:08.388225 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:08.390487 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m09:22:08.393239 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m09:22:08.393789 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as date_key, 
      
    cast(null as varchar)
 as day_of_week_name, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as boolean)
 as is_holiday, 
      
    cast(null as bigint)
 as week_of_year, 
      
    cast(null as bigint)
 as total_trips, 
      
    cast(null as hugeint)
 as total_passengers, 
      
    cast(null as decimal(38,2))
 as total_fare_revenue, 
      
    cast(null as decimal(38,2))
 as total_tip_revenue, 
      
    cast(null as decimal(38,2))
 as total_revenue, 
      
    cast(null as double)
 as avg_trip_revenue, 
      
    cast(null as double)
 as avg_tip_percentage, 
      
    cast(null as bigint)
 as credit_card_trips, 
      
    cast(null as bigint)
 as cash_trips, 
      
    cast(null as double)
 as avg_trip_distance, 
      
    cast(null as double)
 as avg_trip_duration_min, 
      
    cast(null as decimal(38,2))
 as cumulative_revenue, 
      
    cast(null as decimal(38,2))
 as revenue_change_vs_prior_day
    ) as __dbt_sbq
    where false
    limit 0
)
[0m09:22:08.394946 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:08.397507 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m09:22:08.406684 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m09:22:08.407053 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: BEGIN
[0m09:22:08.407529 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m09:22:08.407811 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m09:22:08.408060 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_daily_revenue__dbt_tmp"
  
  (
    date_key date,
    day_of_week_name varchar,
    is_weekend boolean,
    is_holiday boolean,
    week_of_year bigint,
    total_trips bigint,
    total_passengers hugeint,
    total_fare_revenue decimal(38,2),
    total_tip_revenue decimal(38,2),
    total_revenue decimal(38,2),
    avg_trip_revenue double,
    avg_tip_percentage double,
    credit_card_trips bigint,
    cash_trips bigint,
    avg_trip_distance double,
    avg_trip_duration_min double,
    cumulative_revenue decimal(38,2),
    revenue_change_vs_prior_day decimal(38,2)
    
    )
 ;
    insert into "dev"."main"."mart_daily_revenue__dbt_tmp" 
  (
    
      
      date_key ,
    
      
      day_of_week_name ,
    
      
      is_weekend ,
    
      
      is_holiday ,
    
      
      week_of_year ,
    
      
      total_trips ,
    
      
      total_passengers ,
    
      
      total_fare_revenue ,
    
      
      total_tip_revenue ,
    
      
      total_revenue ,
    
      
      avg_trip_revenue ,
    
      
      avg_tip_percentage ,
    
      
      credit_card_trips ,
    
      
      cash_trips ,
    
      
      avg_trip_distance ,
    
      
      avg_trip_duration_min ,
    
      
      cumulative_revenue ,
    
      
      revenue_change_vs_prior_day 
    
  )
 (
      
    select date_key, day_of_week_name, is_weekend, is_holiday, week_of_year, total_trips, total_passengers, total_fare_revenue, total_tip_revenue, total_revenue, avg_trip_revenue, avg_tip_percentage, credit_card_trips, cash_trips, avg_trip_distance, avg_trip_duration_min, cumulative_revenue, revenue_change_vs_prior_day
    from (
        /*
    Analytics mart: Daily revenue metrics with running totals.
*/

with daily as (
    select * from "dev"."main"."int_daily_summary"
),

dates as (
    select * from "dev"."main"."dim_dates"
),

final as (
    select
        d.date_key,
        d.day_of_week_name,
        d.is_weekend,
        d.is_holiday,
        d.week_of_year,

        daily.total_trips,
        daily.total_passengers,
        daily.total_fare_revenue,
        daily.total_tip_revenue,
        daily.total_revenue,
        daily.avg_trip_revenue,
        daily.avg_tip_percentage,
        daily.credit_card_trips,
        daily.cash_trips,
        daily.avg_trip_distance,
        daily.avg_trip_duration_min,

        -- running total
        sum(daily.total_revenue) over (order by d.date_key) as cumulative_revenue,

        -- day-over-day change
        daily.total_revenue - lag(daily.total_revenue) over (order by d.date_key) as revenue_change_vs_prior_day

    from daily
    inner join dates d
        on daily.pickup_date = d.date_key
)

select * from final
    ) as model_subq
    );
  
  
[0m09:22:08.467423 [debug] [Thread-2 (]: SQL status: OK in 0.153 seconds
[0m09:22:08.469832 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m09:22:08.470283 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
alter table "dev"."main"."mart_hourly_demand" rename to "mart_hourly_demand__dbt_backup"
[0m09:22:08.470969 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m09:22:08.472773 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m09:22:08.473111 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
alter table "dev"."main"."mart_hourly_demand__dbt_tmp" rename to "mart_hourly_demand"
[0m09:22:08.473646 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m09:22:08.474648 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: COMMIT
[0m09:22:08.475093 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m09:22:08.475486 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: COMMIT
[0m09:22:08.479571 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m09:22:08.481955 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m09:22:08.482396 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
drop table if exists "dev"."main"."mart_hourly_demand__dbt_backup" cascade
[0m09:22:08.486058 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m09:22:08.487190 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: Close
[0m09:22:08.487750 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125341be3f0>]}
[0m09:22:08.488277 [info ] [Thread-2 (]: 77 of 91 OK created sql table model main.mart_hourly_demand .................... [[32mOK[0m in 0.21s]
[0m09:22:08.488745 [debug] [Thread-2 (]: Finished running node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m09:22:08.489433 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m09:22:08.489681 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m09:22:08.489955 [info ] [Thread-4 (]: 79 of 91 START test not_null_mart_hourly_demand_is_weekend ..................... [RUN]
[0m09:22:08.490467 [info ] [Thread-2 (]: 80 of 91 START test not_null_mart_hourly_demand_pickup_hour .................... [RUN]
[0m09:22:08.491065 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e, now test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8)
[0m09:22:08.491642 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.mart_hourly_demand, now test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418)
[0m09:22:08.492109 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m09:22:08.492573 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m09:22:08.497636 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m09:22:08.501084 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m09:22:08.506501 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m09:22:08.508627 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m09:22:08.509020 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m09:22:08.511096 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m09:22:08.516116 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m09:22:08.516826 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: BEGIN
[0m09:22:08.517259 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m09:22:08.517686 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:22:08.518200 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: BEGIN
[0m09:22:08.519002 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m09:22:08.519298 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:08.519761 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m09:22:08.520460 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:08.520764 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."mart_hourly_demand"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m09:22:08.521325 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m09:22:08.522146 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."mart_hourly_demand"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m09:22:08.522665 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m09:22:08.524749 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: ROLLBACK
[0m09:22:08.525252 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:08.526049 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418'
[0m09:22:08.527468 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: ROLLBACK
[0m09:22:08.527872 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: Close
[0m09:22:08.528754 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8'
[0m09:22:08.529517 [info ] [Thread-2 (]: 80 of 91 PASS not_null_mart_hourly_demand_pickup_hour .......................... [[32mPASS[0m in 0.04s]
[0m09:22:08.529876 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: Close
[0m09:22:08.530510 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m09:22:08.531167 [info ] [Thread-4 (]: 79 of 91 PASS not_null_mart_hourly_demand_is_weekend ........................... [[32mPASS[0m in 0.04s]
[0m09:22:08.532144 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m09:22:08.588218 [debug] [Thread-3 (]: SQL status: OK in 0.180 seconds
[0m09:22:08.590579 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m09:22:08.590938 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
alter table "dev"."main"."mart_daily_revenue" rename to "mart_daily_revenue__dbt_backup"
[0m09:22:08.591709 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m09:22:08.593885 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m09:22:08.594268 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
alter table "dev"."main"."mart_daily_revenue__dbt_tmp" rename to "mart_daily_revenue"
[0m09:22:08.594950 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m09:22:08.595996 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: COMMIT
[0m09:22:08.596430 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m09:22:08.596694 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: COMMIT
[0m09:22:08.599952 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m09:22:08.601439 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m09:22:08.601962 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
drop table if exists "dev"."main"."mart_daily_revenue__dbt_backup" cascade
[0m09:22:08.604626 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m09:22:08.606087 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: Close
[0m09:22:08.606706 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712537134260>]}
[0m09:22:08.607338 [info ] [Thread-3 (]: 78 of 91 OK created sql table model main.mart_daily_revenue .................... [[32mOK[0m in 0.23s]
[0m09:22:08.607932 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m09:22:08.608651 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m09:22:08.609135 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m09:22:08.609444 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m09:22:08.609769 [info ] [Thread-2 (]: 81 of 91 START test not_null_mart_daily_revenue_date_key ....................... [RUN]
[0m09:22:08.610262 [info ] [Thread-4 (]: 82 of 91 START test not_null_mart_daily_revenue_total_revenue .................. [RUN]
[0m09:22:08.610767 [info ] [Thread-3 (]: 83 of 91 START test unique_mart_daily_revenue_date_key ......................... [RUN]
[0m09:22:08.611335 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418, now test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a)
[0m09:22:08.611848 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8, now test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9)
[0m09:22:08.612373 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.mart_daily_revenue, now test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7)
[0m09:22:08.612829 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m09:22:08.613218 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m09:22:08.613572 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m09:22:08.616549 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m09:22:08.619503 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m09:22:08.622910 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m09:22:08.627656 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m09:22:08.631220 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m09:22:08.631639 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m09:22:08.631890 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m09:22:08.633690 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m09:22:08.636358 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m09:22:08.641136 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m09:22:08.641492 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m09:22:08.641772 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: BEGIN
[0m09:22:08.642493 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: BEGIN
[0m09:22:08.643037 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:08.643651 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m09:22:08.644106 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:08.644900 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: BEGIN
[0m09:22:08.645173 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m09:22:08.645740 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:08.645934 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:22:08.646293 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m09:22:08.646653 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m09:22:08.647933 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "dev"."main"."mart_daily_revenue"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:22:08.648459 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m09:22:08.648830 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "dev"."main"."mart_daily_revenue"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m09:22:08.649706 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m09:22:08.650348 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "dev"."main"."mart_daily_revenue"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m09:22:08.650624 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:08.651034 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:08.651399 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m09:22:08.652486 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: ROLLBACK
[0m09:22:08.654165 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: ROLLBACK
[0m09:22:08.655172 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: ROLLBACK
[0m09:22:08.655761 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7'
[0m09:22:08.656265 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9'
[0m09:22:08.657026 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a'
[0m09:22:08.657494 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: Close
[0m09:22:08.657908 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: Close
[0m09:22:08.658356 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: Close
[0m09:22:08.658988 [info ] [Thread-3 (]: 83 of 91 PASS unique_mart_daily_revenue_date_key ............................... [[32mPASS[0m in 0.05s]
[0m09:22:08.659404 [info ] [Thread-4 (]: 82 of 91 PASS not_null_mart_daily_revenue_total_revenue ........................ [[32mPASS[0m in 0.05s]
[0m09:22:08.659815 [info ] [Thread-2 (]: 81 of 91 PASS not_null_mart_daily_revenue_date_key ............................. [[32mPASS[0m in 0.05s]
[0m09:22:08.660198 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m09:22:08.660744 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m09:22:08.661305 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m09:22:12.090093 [debug] [Thread-1 (]: SQL status: OK in 4.576 seconds
[0m09:22:12.096617 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m09:22:12.097153 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
alter table "dev"."main"."fct_trips" rename to "fct_trips__dbt_backup"
[0m09:22:12.098376 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:12.100572 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m09:22:12.101034 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
alter table "dev"."main"."fct_trips__dbt_tmp" rename to "fct_trips"
[0m09:22:12.101798 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:22:12.103144 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.fct_trips: COMMIT
[0m09:22:12.103602 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m09:22:12.104027 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.fct_trips: COMMIT
[0m09:22:12.500918 [debug] [Thread-1 (]: SQL status: OK in 0.396 seconds
[0m09:22:12.502790 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m09:22:12.503220 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
drop table if exists "dev"."main"."fct_trips__dbt_backup" cascade
[0m09:22:12.792061 [debug] [Thread-1 (]: SQL status: OK in 0.288 seconds
[0m09:22:12.793708 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.fct_trips: Close
[0m09:22:12.857497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712537134ec0>]}
[0m09:22:12.858858 [info ] [Thread-1 (]: 67 of 91 OK created sql incremental model main.fct_trips ....................... [[32mOK[0m in 5.42s]
[0m09:22:12.859778 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.fct_trips
[0m09:22:12.861790 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m09:22:12.862303 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m09:22:12.862612 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m09:22:12.862857 [info ] [Thread-3 (]: 84 of 91 START test not_null_fct_trips_pickup_datetime ......................... [RUN]
[0m09:22:12.863095 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m09:22:12.863501 [info ] [Thread-4 (]: 85 of 91 START test not_null_fct_trips_total_amount ............................ [RUN]
[0m09:22:12.864042 [info ] [Thread-2 (]: 86 of 91 START test not_null_fct_trips_trip_id ................................. [RUN]
[0m09:22:12.864642 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7, now test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83)
[0m09:22:12.865001 [info ] [Thread-1 (]: 87 of 91 START test unique_fct_trips_trip_id ................................... [RUN]
[0m09:22:12.865513 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9, now test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d)
[0m09:22:12.866086 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a, now test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d)
[0m09:22:12.866661 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m09:22:12.867218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.fct_trips, now test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab)
[0m09:22:12.867711 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m09:22:12.868101 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m09:22:12.871512 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m09:22:12.872109 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m09:22:12.875191 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m09:22:12.877703 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m09:22:12.881164 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m09:22:12.885673 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m09:22:12.887497 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m09:22:12.887882 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m09:22:12.890392 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m09:22:12.890712 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m09:22:12.890985 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m09:22:12.892635 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m09:22:12.894381 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m09:22:12.896064 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m09:22:12.896390 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m09:22:12.896620 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: BEGIN
[0m09:22:12.896937 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: BEGIN
[0m09:22:12.897481 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:12.898176 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:12.898714 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m09:22:12.899859 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: BEGIN
[0m09:22:12.900201 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m09:22:12.900504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:12.900982 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: BEGIN
[0m09:22:12.901734 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:22:12.919066 [debug] [Thread-3 (]: SQL status: OK in 0.022 seconds
[0m09:22:12.919460 [debug] [Thread-4 (]: SQL status: OK in 0.021 seconds
[0m09:22:12.919803 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m09:22:12.920061 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m09:22:12.920299 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m09:22:12.920695 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m09:22:12.921059 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m09:22:12.921442 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m09:22:12.921787 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "dev"."main"."fct_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m09:22:12.922122 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."fct_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m09:22:12.922468 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."main"."fct_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:22:12.922841 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."fct_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m09:22:12.924093 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:22:12.924336 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:22:12.924609 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m09:22:12.928433 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: ROLLBACK
[0m09:22:12.929480 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: ROLLBACK
[0m09:22:12.931292 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: ROLLBACK
[0m09:22:12.932708 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83'
[0m09:22:12.933973 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d'
[0m09:22:12.936233 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d'
[0m09:22:12.938192 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: Close
[0m09:22:12.940132 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: Close
[0m09:22:12.942096 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: Close
[0m09:22:12.944201 [info ] [Thread-3 (]: 84 of 91 PASS not_null_fct_trips_pickup_datetime ............................... [[32mPASS[0m in 0.08s]
[0m09:22:12.947780 [info ] [Thread-4 (]: 85 of 91 PASS not_null_fct_trips_total_amount .................................. [[32mPASS[0m in 0.08s]
[0m09:22:12.948614 [info ] [Thread-2 (]: 86 of 91 PASS not_null_fct_trips_trip_id ....................................... [[32mPASS[0m in 0.08s]
[0m09:22:12.951141 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m09:22:12.953921 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m09:22:12.955913 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m09:22:13.055708 [debug] [Thread-1 (]: SQL status: OK in 0.132 seconds
[0m09:22:13.057462 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: ROLLBACK
[0m09:22:13.058484 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab'
[0m09:22:13.059022 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: Close
[0m09:22:13.084267 [info ] [Thread-1 (]: 87 of 91 PASS unique_fct_trips_trip_id ......................................... [[32mPASS[0m in 0.22s]
[0m09:22:13.084948 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m09:22:13.086291 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.mart_location_performance
[0m09:22:13.086901 [info ] [Thread-3 (]: 88 of 91 START sql table model main.mart_location_performance .................. [RUN]
[0m09:22:13.087486 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83, now model.nyc_taxi_pipeline_00.mart_location_performance)
[0m09:22:13.087866 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_location_performance
[0m09:22:13.090441 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m09:22:13.098328 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.mart_location_performance
[0m09:22:13.101024 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m09:22:13.101780 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Location-level performance summary.
    Uses adapter-dispatched mode_compat() for cross-dialect support.
*/

with trips as (
    select * from "dev"."main"."fct_trips"
),

final as (
    select
        pickup_location_id,
        pickup_borough,
        pickup_zone,

        count(*) as total_pickups,
        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue_per_trip,
        round(avg(tip_percentage), 2) as avg_tip_pct,
        round(avg(passenger_count), 2) as avg_passengers,

        -- most common dropoff destination
        
    mode(dropoff_zone)
 as most_common_dropoff_zone,

        -- busiest hour
        
    mode(pickup_hour)
 as peak_pickup_hour

    from trips
    where pickup_zone is not null
    group by pickup_location_id, pickup_borough, pickup_zone
)

select * from final
order by total_pickups desc
    ) as __dbt_sbq
    where false
    limit 0
)
[0m09:22:13.102217 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:22:13.120069 [debug] [Thread-3 (]: SQL status: OK in 0.018 seconds
[0m09:22:13.122098 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m09:22:13.122651 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as varchar)
 as pickup_borough, 
      
    cast(null as varchar)
 as pickup_zone, 
      
    cast(null as bigint)
 as total_pickups, 
      
    cast(null as double)
 as avg_trip_distance, 
      
    cast(null as double)
 as avg_trip_duration_min, 
      
    cast(null as decimal(38,2))
 as total_revenue, 
      
    cast(null as double)
 as avg_revenue_per_trip, 
      
    cast(null as double)
 as avg_tip_pct, 
      
    cast(null as double)
 as avg_passengers, 
      
    cast(null as varchar)
 as most_common_dropoff_zone, 
      
    cast(null as bigint)
 as peak_pickup_hour
    ) as __dbt_sbq
    where false
    limit 0
)
[0m09:22:13.123560 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m09:22:13.125036 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m09:22:13.132513 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m09:22:13.132926 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: BEGIN
[0m09:22:13.133576 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m09:22:13.134009 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m09:22:13.134497 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_location_performance__dbt_tmp"
  
  (
    pickup_location_id integer,
    pickup_borough varchar,
    pickup_zone varchar,
    total_pickups bigint,
    avg_trip_distance double,
    avg_trip_duration_min double,
    total_revenue decimal(38,2),
    avg_revenue_per_trip double,
    avg_tip_pct double,
    avg_passengers double,
    most_common_dropoff_zone varchar,
    peak_pickup_hour bigint
    
    )
 ;
    insert into "dev"."main"."mart_location_performance__dbt_tmp" 
  (
    
      
      pickup_location_id ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      total_pickups ,
    
      
      avg_trip_distance ,
    
      
      avg_trip_duration_min ,
    
      
      total_revenue ,
    
      
      avg_revenue_per_trip ,
    
      
      avg_tip_pct ,
    
      
      avg_passengers ,
    
      
      most_common_dropoff_zone ,
    
      
      peak_pickup_hour 
    
  )
 (
      
    select pickup_location_id, pickup_borough, pickup_zone, total_pickups, avg_trip_distance, avg_trip_duration_min, total_revenue, avg_revenue_per_trip, avg_tip_pct, avg_passengers, most_common_dropoff_zone, peak_pickup_hour
    from (
        /*
    Analytics mart: Location-level performance summary.
    Uses adapter-dispatched mode_compat() for cross-dialect support.
*/

with trips as (
    select * from "dev"."main"."fct_trips"
),

final as (
    select
        pickup_location_id,
        pickup_borough,
        pickup_zone,

        count(*) as total_pickups,
        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue_per_trip,
        round(avg(tip_percentage), 2) as avg_tip_pct,
        round(avg(passenger_count), 2) as avg_passengers,

        -- most common dropoff destination
        
    mode(dropoff_zone)
 as most_common_dropoff_zone,

        -- busiest hour
        
    mode(pickup_hour)
 as peak_pickup_hour

    from trips
    where pickup_zone is not null
    group by pickup_location_id, pickup_borough, pickup_zone
)

select * from final
order by total_pickups desc
    ) as model_subq
    );
  
  
[0m09:22:13.240983 [debug] [Thread-3 (]: SQL status: OK in 0.106 seconds
[0m09:22:13.243583 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m09:22:13.243950 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
alter table "dev"."main"."mart_location_performance" rename to "mart_location_performance__dbt_backup"
[0m09:22:13.244637 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m09:22:13.246332 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m09:22:13.247786 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
alter table "dev"."main"."mart_location_performance__dbt_tmp" rename to "mart_location_performance"
[0m09:22:13.248393 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m09:22:13.249221 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: COMMIT
[0m09:22:13.249632 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m09:22:13.250038 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: COMMIT
[0m09:22:13.255668 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m09:22:13.257428 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m09:22:13.257746 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
drop table if exists "dev"."main"."mart_location_performance__dbt_backup" cascade
[0m09:22:13.260915 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m09:22:13.261867 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: Close
[0m09:22:13.308535 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bb59df-bf4d-475a-aa37-7eb02aaa250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71253486d5b0>]}
[0m09:22:13.309247 [info ] [Thread-3 (]: 88 of 91 OK created sql table model main.mart_location_performance ............. [[32mOK[0m in 0.22s]
[0m09:22:13.309779 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.mart_location_performance
[0m09:22:13.311396 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m09:22:13.311753 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m09:22:13.312072 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m09:22:13.312454 [info ] [Thread-2 (]: 89 of 91 START test not_null_mart_location_performance_pickup_location_id ...... [RUN]
[0m09:22:13.312982 [info ] [Thread-1 (]: 90 of 91 START test not_null_mart_location_performance_total_pickups ........... [RUN]
[0m09:22:13.313464 [info ] [Thread-4 (]: 91 of 91 START test unique_mart_location_performance_pickup_location_id ........ [RUN]
[0m09:22:13.313891 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d, now test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c)
[0m09:22:13.314275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab, now test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259)
[0m09:22:13.314617 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d, now test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62)
[0m09:22:13.314963 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m09:22:13.315269 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m09:22:13.315668 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m09:22:13.318212 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m09:22:13.320344 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m09:22:13.322487 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m09:22:13.327981 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m09:22:13.329881 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m09:22:13.330564 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m09:22:13.331890 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m09:22:13.332110 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m09:22:13.333482 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m09:22:13.336782 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m09:22:13.337161 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m09:22:13.337440 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: BEGIN
[0m09:22:13.337802 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: BEGIN
[0m09:22:13.338166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:13.338524 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:22:13.338893 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m09:22:13.339656 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: BEGIN
[0m09:22:13.340084 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:22:13.359629 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m09:22:13.360042 [debug] [Thread-4 (]: SQL status: OK in 0.021 seconds
[0m09:22:13.360360 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m09:22:13.360677 [debug] [Thread-2 (]: SQL status: OK in 0.021 seconds
[0m09:22:13.360977 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m09:22:13.361458 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_pickups
from "dev"."main"."mart_location_performance"
where total_pickups is null



  
  
      
    ) dbt_internal_test
[0m09:22:13.361931 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m09:22:13.362461 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pickup_location_id as unique_field,
    count(*) as n_records

from "dev"."main"."mart_location_performance"
where pickup_location_id is not null
group by pickup_location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:22:13.363391 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_location_id
from "dev"."main"."mart_location_performance"
where pickup_location_id is null



  
  
      
    ) dbt_internal_test
[0m09:22:13.363809 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:13.365550 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: ROLLBACK
[0m09:22:13.365878 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m09:22:13.366271 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m09:22:13.366827 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259'
[0m09:22:13.367946 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: ROLLBACK
[0m09:22:13.368930 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: ROLLBACK
[0m09:22:13.369222 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: Close
[0m09:22:13.370039 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c'
[0m09:22:13.370540 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62'
[0m09:22:13.371215 [info ] [Thread-1 (]: 90 of 91 PASS not_null_mart_location_performance_total_pickups ................. [[32mPASS[0m in 0.06s]
[0m09:22:13.371473 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: Close
[0m09:22:13.371863 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: Close
[0m09:22:13.372409 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m09:22:13.373008 [info ] [Thread-2 (]: 89 of 91 PASS not_null_mart_location_performance_pickup_location_id ............ [[32mPASS[0m in 0.06s]
[0m09:22:13.373787 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m09:22:13.376012 [info ] [Thread-4 (]: 91 of 91 PASS unique_mart_location_performance_pickup_location_id .............. [[32mPASS[0m in 0.06s]
[0m09:22:13.376689 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m09:22:13.378478 [debug] [MainThread]: Using duckdb connection "master"
[0m09:22:13.378815 [debug] [MainThread]: On master: BEGIN
[0m09:22:13.379209 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:22:13.399869 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m09:22:13.400464 [debug] [MainThread]: On master: COMMIT
[0m09:22:13.400858 [debug] [MainThread]: Using duckdb connection "master"
[0m09:22:13.401201 [debug] [MainThread]: On master: COMMIT
[0m09:22:13.402005 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:22:13.402456 [debug] [MainThread]: On master: Close
[0m09:22:13.407180 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:22:13.407811 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m09:22:13.408225 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259' was properly closed.
[0m09:22:13.408614 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c' was properly closed.
[0m09:22:13.408976 [debug] [MainThread]: Connection 'model.nyc_taxi_pipeline_00.mart_location_performance' was properly closed.
[0m09:22:13.409304 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62' was properly closed.
[0m09:22:13.409815 [info ] [MainThread]: 
[0m09:22:13.410183 [info ] [MainThread]: Finished running 1 incremental model, 3 seeds, 7 table models, 74 data tests, 6 view models in 0 hours 0 minutes and 9.19 seconds (9.19s).
[0m09:22:13.417016 [debug] [MainThread]: Command end result
[0m09:22:13.461672 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m09:22:13.467384 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m09:22:13.478538 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m09:22:13.478965 [info ] [MainThread]: 
[0m09:22:13.479381 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:22:13.479724 [info ] [MainThread]: 
[0m09:22:13.480101 [info ] [MainThread]: Done. PASS=91 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=91
[0m09:22:13.481245 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 10.662166, "process_in_blocks": "86840", "process_kernel_time": 7.670602, "process_mem_max_rss": "1738816", "process_out_blocks": "136", "process_user_time": 20.987982}
[0m09:22:13.481745 [debug] [MainThread]: Command `dbt build` succeeded at 09:22:13.481656 after 10.66 seconds
[0m09:22:13.482288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125a7d60800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125241239e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712596f15cd0>]}
[0m09:22:13.482698 [debug] [MainThread]: Flushing usage events
[0m09:22:13.732730 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:12:40.587077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b383d81ce60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b383cd2a570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b383d81e360>]}


============================== 18:12:40.590842 | faad3900-3a9f-406b-8192-d341aed75d56 ==============================
[0m18:12:40.590842 [info ] [MainThread]: Running with dbt=1.11.4
[0m18:12:40.591517 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'printer_width': '80', 'log_format': 'default', 'target_path': 'None', 'debug': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt deps --profiles-dir .', 'profiles_dir': '.', 'static_parser': 'True', 'log_path': '/dbt/logs', 'empty': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'write_json': 'True', 'quiet': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager'}
[0m18:12:40.690242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'faad3900-3a9f-406b-8192-d341aed75d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b383c8662d0>]}
[0m18:12:41.070543 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-4b3c3_e4'
[0m18:12:41.071081 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:12:41.395007 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:12:41.396488 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:12:41.487176 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:12:41.491602 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:12:45.739430 [info ] [MainThread]: Installed from version 1.3.3
[0m18:12:45.739985 [info ] [MainThread]: Up to date!
[0m18:12:45.740437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'faad3900-3a9f-406b-8192-d341aed75d56', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b383d4efbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b383c7c9970>]}
[0m18:12:45.742577 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 5.2727113, "process_in_blocks": "103208", "process_kernel_time": 0.852225, "process_mem_max_rss": "104960", "process_out_blocks": "176", "process_user_time": 1.418933}
[0m18:12:45.743182 [debug] [MainThread]: Command `dbt deps` succeeded at 18:12:45.743068 after 5.27 seconds
[0m18:12:45.743823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b383d448da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b383cecc9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b383c709dc0>]}
[0m18:12:45.744412 [debug] [MainThread]: Flushing usage events
[0m18:12:45.962229 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:12:47.386472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e42e551dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e42d8f3d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e42dc6e1b0>]}


============================== 18:12:47.389809 | 3b1175b3-4e94-4b95-97e9-9c6dd8e8b5f7 ==============================
[0m18:12:47.389809 [info ] [MainThread]: Running with dbt=1.11.4
[0m18:12:47.390493 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'debug': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'partial_parse': 'True', 'target_path': 'None', 'quiet': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt build --full-refresh --profiles-dir .', 'profiles_dir': '.', 'printer_width': '80', 'warn_error': 'None', 'no_print': 'None', 'log_path': '/dbt/logs', 'version_check': 'True', 'log_format': 'default'}
[0m18:12:47.621960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b1175b3-4e94-4b95-97e9-9c6dd8e8b5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e43023b890>]}
[0m18:12:47.672276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b1175b3-4e94-4b95-97e9-9c6dd8e8b5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e429cc8d40>]}
[0m18:12:47.674516 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m18:12:47.747857 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m18:12:48.765912 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:12:48.766535 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:12:48.766975 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:12:48.809751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b1175b3-4e94-4b95-97e9-9c6dd8e8b5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e42d6bafc0>]}
[0m18:12:48.911820 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m18:12:48.924908 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m18:12:48.983435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b1175b3-4e94-4b95-97e9-9c6dd8e8b5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e41d6579e0>]}
[0m18:12:48.984142 [info ] [MainThread]: Found 14 models, 74 data tests, 3 seeds, 1 source, 578 macros
[0m18:12:48.988910 [info ] [MainThread]: 
[0m18:12:48.989506 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:12:48.989893 [info ] [MainThread]: 
[0m18:12:48.990557 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:12:48.995597 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m18:12:49.094253 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m18:12:49.094801 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m18:12:49.095220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:49.137679 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m18:12:49.139086 [debug] [ThreadPool]: On list_dev: Close
[0m18:12:49.143850 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m18:12:49.144642 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m18:12:49.149575 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:12:49.150161 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m18:12:49.150737 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:49.171071 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m18:12:49.172546 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:12:49.173114 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m18:12:49.173916 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:12:49.174454 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:12:49.174915 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m18:12:49.175749 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:12:49.176902 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:12:49.179010 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:12:49.180547 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:12:49.181688 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:12:49.182251 [debug] [ThreadPool]: On create_dev_main: Close
[0m18:12:49.187594 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m18:12:49.191652 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:12:49.192133 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m18:12:49.192531 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:49.215414 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m18:12:49.216000 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:12:49.216450 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m18:12:49.228695 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m18:12:49.230306 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m18:12:49.231891 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m18:12:49.232305 [debug] [ThreadPool]: On list_dev_main: Close
[0m18:12:49.237591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b1175b3-4e94-4b95-97e9-9c6dd8e8b5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e41db65dc0>]}
[0m18:12:49.238315 [debug] [MainThread]: Using duckdb connection "master"
[0m18:12:49.238783 [debug] [MainThread]: On master: BEGIN
[0m18:12:49.239217 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:12:49.260232 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m18:12:49.260942 [debug] [MainThread]: On master: COMMIT
[0m18:12:49.261328 [debug] [MainThread]: Using duckdb connection "master"
[0m18:12:49.261617 [debug] [MainThread]: On master: COMMIT
[0m18:12:49.262280 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:12:49.262724 [debug] [MainThread]: On master: Close
[0m18:12:49.271917 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.dim_dates
[0m18:12:49.272407 [debug] [Thread-2 (]: Began running node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m18:12:49.272860 [debug] [Thread-3 (]: Began running node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m18:12:49.273317 [info ] [Thread-1 (]: 1 of 91 START sql table model main.dim_dates ................................... [RUN]
[0m18:12:49.273765 [debug] [Thread-4 (]: Began running node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m18:12:49.274167 [info ] [Thread-2 (]: 2 of 91 START sql table model main.stg_yellow_trips ............................ [RUN]
[0m18:12:49.274739 [info ] [Thread-3 (]: 3 of 91 START seed file main.payment_type_lookup ............................... [RUN]
[0m18:12:49.275366 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nyc_taxi_pipeline_00.dim_dates'
[0m18:12:49.275936 [info ] [Thread-4 (]: 4 of 91 START seed file main.rate_code_lookup .................................. [RUN]
[0m18:12:49.276602 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.nyc_taxi_pipeline_00.stg_yellow_trips'
[0m18:12:49.277210 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.nyc_taxi_pipeline_00.payment_type_lookup'
[0m18:12:49.277769 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_dates
[0m18:12:49.278414 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.nyc_taxi_pipeline_00.rate_code_lookup'
[0m18:12:49.278946 [debug] [Thread-2 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m18:12:49.279451 [debug] [Thread-3 (]: Began compiling node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m18:12:49.290617 [debug] [Thread-4 (]: Began compiling node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m18:12:49.294790 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:12:49.306194 [debug] [Thread-3 (]: Began executing node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m18:12:49.306650 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m18:12:49.306902 [debug] [Thread-4 (]: Began executing node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m18:12:49.307371 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: BEGIN
[0m18:12:49.320361 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:12:49.333290 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m18:12:49.334726 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m18:12:49.335024 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.rate_code_lookup"} */
drop table if exists "dev"."main"."rate_code_lookup" cascade
[0m18:12:49.335709 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.payment_type_lookup"} */
drop table if exists "dev"."main"."payment_type_lookup" cascade
[0m18:12:49.336331 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:12:49.336732 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:12:49.337024 [debug] [Thread-2 (]: Began executing node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m18:12:49.356876 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m18:12:49.357612 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m18:12:49.358171 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:12:49.359038 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */


        select 
        (date_diff('day', cast('2024-01-01' as date)::timestamp, cast('2024-02-01' as date)::timestamp ))
    
[0m18:12:49.360614 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:12:49.367238 [debug] [Thread-4 (]: SQL status: OK in 0.031 seconds
[0m18:12:49.369867 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:12:49.375073 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m18:12:49.375617 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m18:12:49.376172 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: BEGIN
[0m18:12:49.377240 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m18:12:49.378036 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: BEGIN
[0m18:12:49.378465 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:12:49.379109 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:12:49.379410 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m18:12:49.380065 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m18:12:49.380661 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.rate_code_lookup"} */

    create table "dev"."main"."rate_code_lookup" ("rate_code_id" integer,"rate_code_name" varchar)
  
[0m18:12:49.381062 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m18:12:49.381522 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.payment_type_lookup"} */

    create table "dev"."main"."payment_type_lookup" ("payment_type_id" integer,"payment_type_name" varchar)
  
[0m18:12:49.382347 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: BEGIN
[0m18:12:49.382761 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:12:49.383235 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:12:49.383551 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:12:49.391440 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m18:12:49.392426 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m18:12:49.393287 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m18:12:49.393791 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: 
          COPY "dev"."main"."rate_code_lookup" FROM '/dbt/seeds/rate_code_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:12:49.394262 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m18:12:49.394721 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: 
          COPY "dev"."main"."payment_type_lookup" FROM '/dbt/seeds/payment_type_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:12:49.395025 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.dim_dates
[0m18:12:49.395589 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */

  
    
    

    create  table
      "dev"."main"."stg_yellow_trips__dbt_tmp"
  
    as (
      

with source as (
    select * from read_parquet('/data/yellow_tripdata_2024-01.parquet')
),

renamed as (
    select
        -- surrogate key (MD5 hash of composite key)
        md5(cast(coalesce(cast(VendorID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(PULocationID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DOLocationID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(fare_amount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(total_amount as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- identifiers
        cast("VendorID" as integer) as vendor_id,
        cast("RatecodeID" as integer) as rate_code_id,
        cast("PULocationID" as integer) as pickup_location_id,
        cast("DOLocationID" as integer) as dropoff_location_id,
        cast(payment_type as integer) as payment_type_id,

        -- timestamps
        cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
        cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as double) as trip_distance_miles,
        store_and_fwd_flag,

        -- financials
        round(cast(fare_amount as decimal(10, 2)), 2) as fare_amount,
        round(cast(extra as decimal(10, 2)), 2) as extra_amount,
        round(cast(mta_tax as decimal(10, 2)), 2) as mta_tax,
        round(cast(tip_amount as decimal(10, 2)), 2) as tip_amount,
        round(cast(tolls_amount as decimal(10, 2)), 2) as tolls_amount,
        round(cast(improvement_surcharge as decimal(10, 2)), 2) as improvement_surcharge,
        round(cast(total_amount as decimal(10, 2)), 2) as total_amount,
        round(cast(congestion_surcharge as decimal(10, 2)), 2) as congestion_surcharge,
        round(cast(Airport_fee as decimal(10, 2)), 2) as airport_fee

    from source
    where tpep_pickup_datetime is not null
      and tpep_dropoff_datetime is not null
      and trip_distance >= 0
      and fare_amount >= 0
      -- filter out-of-range dates (data quality: ~18 trips outside Jan 2024)
      and cast(tpep_pickup_datetime as date) >= date '2024-01-01'
      and cast(tpep_pickup_datetime as date) < date '2024-02-01'
)

select * from renamed
    );
  
  
[0m18:12:49.410331 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:12:49.411047 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
DESCRIBE (select * from (
        /*
    Dimension table: Calendar dates for January 2024.
    Uses adapter-dispatched macros for dayname/monthname.
*/

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 31
    order by generated_number



),

all_periods as (

    select (
        

    date_add(cast('2024-01-01' as date), interval (row_number() over (order by generated_number) - 1) day)


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-02-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week_num,
        
    dayname(date_day)
 as day_of_week_name,
        
    monthname(date_day)
 as month_name,
        extract(week from date_day) as week_of_year,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when cast(date_day as date) in (
                cast('2024-01-01' as date),
                cast('2024-01-15' as date)
            ) then true
            else false
        end as is_holiday

    from date_spine
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:12:49.411480 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m18:12:49.411727 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m18:12:49.416442 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m18:12:49.417298 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:12:49.417816 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m18:12:49.431242 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:12:49.432307 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as date_key, 
      
    cast(null as bigint)
 as year, 
      
    cast(null as bigint)
 as month, 
      
    cast(null as bigint)
 as day_of_month, 
      
    cast(null as bigint)
 as day_of_week_num, 
      
    cast(null as varchar)
 as day_of_week_name, 
      
    cast(null as varchar)
 as month_name, 
      
    cast(null as bigint)
 as week_of_year, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as boolean)
 as is_holiday
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:12:49.434075 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:12:49.452901 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:12:49.465534 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: COMMIT
[0m18:12:49.466928 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: COMMIT
[0m18:12:49.467270 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m18:12:49.467852 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m18:12:49.468395 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: COMMIT
[0m18:12:49.469142 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: COMMIT
[0m18:12:49.473241 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:12:49.474948 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: Close
[0m18:12:49.477010 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m18:12:49.477401 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1175b3-4e94-4b95-97e9-9c6dd8e8b5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e3c1a75190>]}
[0m18:12:49.478191 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: Close
[0m18:12:49.479016 [info ] [Thread-4 (]: 4 of 91 OK loaded seed file main.rate_code_lookup .............................. [[32mCREATE 7[0m in 0.20s]
[0m18:12:49.479892 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1175b3-4e94-4b95-97e9-9c6dd8e8b5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e3c1b777d0>]}
[0m18:12:49.480803 [debug] [Thread-4 (]: Finished running node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m18:12:49.481586 [info ] [Thread-3 (]: 3 of 91 OK loaded seed file main.payment_type_lookup ........................... [[32mCREATE 6[0m in 0.20s]
[0m18:12:49.482338 [debug] [Thread-4 (]: Began running node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m18:12:49.482889 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:12:49.483756 [debug] [Thread-3 (]: Finished running node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m18:12:49.484593 [info ] [Thread-4 (]: 5 of 91 START seed file main.taxi_zone_lookup .................................. [RUN]
[0m18:12:49.485360 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_dates__dbt_tmp"
  
  (
    date_key date,
    year bigint,
    month bigint,
    day_of_month bigint,
    day_of_week_num bigint,
    day_of_week_name varchar,
    month_name varchar,
    week_of_year bigint,
    is_weekend boolean,
    is_holiday boolean
    
    )
 ;
    insert into "dev"."main"."dim_dates__dbt_tmp" 
  (
    
      
      date_key ,
    
      
      year ,
    
      
      month ,
    
      
      day_of_month ,
    
      
      day_of_week_num ,
    
      
      day_of_week_name ,
    
      
      month_name ,
    
      
      week_of_year ,
    
      
      is_weekend ,
    
      
      is_holiday 
    
  )
 (
      
    select date_key, year, month, day_of_month, day_of_week_num, day_of_week_name, month_name, week_of_year, is_weekend, is_holiday
    from (
        /*
    Dimension table: Calendar dates for January 2024.
    Uses adapter-dispatched macros for dayname/monthname.
*/

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 31
    order by generated_number



),

all_periods as (

    select (
        

    date_add(cast('2024-01-01' as date), interval (row_number() over (order by generated_number) - 1) day)


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-02-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week_num,
        
    dayname(date_day)
 as day_of_week_name,
        
    monthname(date_day)
 as month_name,
        extract(week from date_day) as week_of_year,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when cast(date_day as date) in (
                cast('2024-01-01' as date),
                cast('2024-01-15' as date)
            ) then true
            else false
        end as is_holiday

    from date_spine
)

select * from final
    ) as model_subq
    );
  
  
[0m18:12:49.486092 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m18:12:49.487012 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.rate_code_lookup, now seed.nyc_taxi_pipeline_00.taxi_zone_lookup)
[0m18:12:49.489514 [info ] [Thread-3 (]: 6 of 91 START test not_null_rate_code_lookup_rate_code_id ...................... [RUN]
[0m18:12:49.490181 [debug] [Thread-4 (]: Began compiling node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m18:12:49.491116 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.payment_type_lookup, now test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec)
[0m18:12:49.491803 [debug] [Thread-4 (]: Began executing node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m18:12:49.492422 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m18:12:49.504692 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m18:12:49.505506 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m18:12:49.511659 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:12:49.512198 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
alter table "dev"."main"."dim_dates" rename to "dim_dates__dbt_backup"
[0m18:12:49.514351 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:12:49.516562 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m18:12:49.519504 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:12:49.520456 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"} */
drop table if exists "dev"."main"."taxi_zone_lookup" cascade
[0m18:12:49.521046 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
alter table "dev"."main"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m18:12:49.521574 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:49.522575 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:12:49.524609 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: COMMIT
[0m18:12:49.525187 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:12:49.525547 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: COMMIT
[0m18:12:49.525839 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m18:12:49.528597 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m18:12:49.529099 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m18:12:49.529545 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: BEGIN
[0m18:12:49.529951 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:12:49.540479 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m18:12:49.542894 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:12:49.543284 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:12:49.544102 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
drop table if exists "dev"."main"."dim_dates__dbt_backup" cascade
[0m18:12:49.544642 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m18:12:49.545616 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"} */

    create table "dev"."main"."taxi_zone_lookup" ("LocationID" integer,"Borough" varchar,"Zone" varchar,"service_zone" varchar)
  
[0m18:12:49.546738 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:12:49.548154 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m18:12:49.548497 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:12:49.548921 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: 
          COPY "dev"."main"."taxi_zone_lookup" FROM '/dbt/seeds/taxi_zone_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:12:49.550317 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: Close
[0m18:12:49.551791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1175b3-4e94-4b95-97e9-9c6dd8e8b5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e3c1adbe30>]}
[0m18:12:49.552486 [info ] [Thread-1 (]: 1 of 91 OK created sql table model main.dim_dates .............................. [[32mOK[0m in 0.28s]
[0m18:12:49.553085 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.dim_dates
[0m18:12:49.554028 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m18:12:49.554719 [info ] [Thread-1 (]: 7 of 91 START test unique_rate_code_lookup_rate_code_id ........................ [RUN]
[0m18:12:49.555349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_dates, now test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d)
[0m18:12:49.556047 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m18:12:49.562676 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m18:12:49.563178 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m18:12:49.564229 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m18:12:49.564951 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m18:12:49.565465 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: BEGIN
[0m18:12:49.565970 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:49.566896 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:12:49.567552 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m18:12:49.568089 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_id
from "dev"."main"."rate_code_lookup"
where rate_code_id is null



  
  
      
    ) dbt_internal_test
[0m18:12:49.570251 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:12:49.573879 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: ROLLBACK
[0m18:12:49.575253 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec'
[0m18:12:49.575931 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: Close
[0m18:12:49.576889 [info ] [Thread-3 (]: 6 of 91 PASS not_null_rate_code_lookup_rate_code_id ............................ [[32mPASS[0m in 0.09s]
[0m18:12:49.577663 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m18:12:49.578230 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m18:12:49.578869 [info ] [Thread-3 (]: 8 of 91 START test not_null_payment_type_lookup_payment_type_id ................ [RUN]
[0m18:12:49.579630 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec, now test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521)
[0m18:12:49.579998 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m18:12:49.580459 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m18:12:49.581875 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: COMMIT
[0m18:12:49.584618 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m18:12:49.588687 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m18:12:49.589504 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m18:12:49.591160 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: COMMIT
[0m18:12:49.596846 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m18:12:49.598064 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: Close
[0m18:12:49.598745 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1175b3-4e94-4b95-97e9-9c6dd8e8b5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e3c16fa390>]}
[0m18:12:49.599413 [info ] [Thread-4 (]: 5 of 91 OK loaded seed file main.taxi_zone_lookup .............................. [[32mCREATE 265[0m in 0.11s]
[0m18:12:49.600067 [debug] [Thread-4 (]: Finished running node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m18:12:49.600614 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m18:12:49.601350 [info ] [Thread-4 (]: 9 of 91 START test unique_payment_type_lookup_payment_type_id .................. [RUN]
[0m18:12:49.601984 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.taxi_zone_lookup, now test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7)
[0m18:12:49.602437 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m18:12:49.606658 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m18:12:49.608243 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m18:12:49.608905 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m18:12:49.611610 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m18:12:49.612419 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: BEGIN
[0m18:12:49.613444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:49.614411 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:12:49.615106 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m18:12:49.615658 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rate_code_id as unique_field,
    count(*) as n_records

from "dev"."main"."rate_code_lookup"
where rate_code_id is not null
group by rate_code_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:12:49.618211 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m18:12:49.618679 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:12:49.620691 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m18:12:49.622434 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: ROLLBACK
[0m18:12:49.623569 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d'
[0m18:12:49.624138 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: Close
[0m18:12:49.625326 [info ] [Thread-1 (]: 7 of 91 PASS unique_rate_code_lookup_rate_code_id .............................. [[32mPASS[0m in 0.07s]
[0m18:12:49.626182 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m18:12:49.626814 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m18:12:49.627778 [info ] [Thread-1 (]: 10 of 91 START test not_null_dim_dates_date_key ................................ [RUN]
[0m18:12:49.628658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d, now test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348)
[0m18:12:49.629138 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m18:12:49.629618 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m18:12:49.630350 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: BEGIN
[0m18:12:49.634900 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m18:12:49.635689 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:49.637479 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m18:12:49.638032 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:12:49.638433 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: BEGIN
[0m18:12:49.639064 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m18:12:49.639658 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:49.640221 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."payment_type_lookup"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m18:12:49.641662 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:12:49.642097 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m18:12:49.642397 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:12:49.642753 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."payment_type_lookup"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:12:49.644390 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: ROLLBACK
[0m18:12:49.645948 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521'
[0m18:12:49.646496 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: Close
[0m18:12:49.646854 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:12:49.647521 [info ] [Thread-3 (]: 8 of 91 PASS not_null_payment_type_lookup_payment_type_id ...................... [[32mPASS[0m in 0.07s]
[0m18:12:49.649198 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: ROLLBACK
[0m18:12:49.649803 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m18:12:49.651176 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7'
[0m18:12:49.651638 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m18:12:49.652267 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: Close
[0m18:12:49.652944 [info ] [Thread-3 (]: 11 of 91 START test not_null_dim_dates_day_of_week_name ........................ [RUN]
[0m18:12:49.653971 [info ] [Thread-4 (]: 9 of 91 PASS unique_payment_type_lookup_payment_type_id ........................ [[32mPASS[0m in 0.05s]
[0m18:12:49.654900 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521, now test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541)
[0m18:12:49.655835 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m18:12:49.656175 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m18:12:49.656798 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m18:12:49.657574 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m18:12:49.659907 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m18:12:49.663030 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m18:12:49.663687 [info ] [Thread-4 (]: 12 of 91 START test not_null_dim_dates_is_holiday .............................. [RUN]
[0m18:12:49.665046 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7, now test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a)
[0m18:12:49.665590 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m18:12:49.668679 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m18:12:49.682766 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m18:12:49.683811 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m18:12:49.685994 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m18:12:49.686371 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m18:12:49.687022 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: BEGIN
[0m18:12:49.690094 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m18:12:49.690805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:49.692619 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:12:49.693225 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m18:12:49.693841 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "dev"."main"."dim_dates"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m18:12:49.695284 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:12:49.696785 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: ROLLBACK
[0m18:12:49.697835 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348'
[0m18:12:49.698501 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: Close
[0m18:12:49.699263 [info ] [Thread-1 (]: 10 of 91 PASS not_null_dim_dates_date_key ...................................... [[32mPASS[0m in 0.07s]
[0m18:12:49.699894 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m18:12:49.700400 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m18:12:49.700894 [info ] [Thread-1 (]: 13 of 91 START test not_null_dim_dates_is_weekend .............................. [RUN]
[0m18:12:49.701579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348, now test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0)
[0m18:12:49.702225 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m18:12:49.706701 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m18:12:49.707808 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m18:12:49.708384 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: BEGIN
[0m18:12:49.708924 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m18:12:49.709243 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:49.709849 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: BEGIN
[0m18:12:49.710880 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:49.711315 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:12:49.712201 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m18:12:49.712588 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:12:49.713155 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_holiday
from "dev"."main"."dim_dates"
where is_holiday is null



  
  
      
    ) dbt_internal_test
[0m18:12:49.713767 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m18:12:49.714990 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select day_of_week_name
from "dev"."main"."dim_dates"
where day_of_week_name is null



  
  
      
    ) dbt_internal_test
[0m18:12:49.715432 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:12:49.717439 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: ROLLBACK
[0m18:12:49.717896 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:12:49.718758 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a'
[0m18:12:49.720271 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: ROLLBACK
[0m18:12:49.720645 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: Close
[0m18:12:49.721646 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541'
[0m18:12:49.722596 [info ] [Thread-4 (]: 12 of 91 PASS not_null_dim_dates_is_holiday .................................... [[32mPASS[0m in 0.06s]
[0m18:12:49.722940 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: Close
[0m18:12:49.723942 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m18:12:49.726253 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m18:12:49.725260 [info ] [Thread-3 (]: 11 of 91 PASS not_null_dim_dates_day_of_week_name .............................. [[32mPASS[0m in 0.07s]
[0m18:12:49.726903 [info ] [Thread-4 (]: 14 of 91 START test unique_dim_dates_date_key .................................. [RUN]
[0m18:12:49.727389 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m18:12:49.728213 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m18:12:49.728971 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a, now test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d)
[0m18:12:49.731948 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m18:12:49.732955 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m18:12:49.734237 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m18:12:49.735360 [info ] [Thread-3 (]: 15 of 91 START test not_null_taxi_zone_lookup_Borough .......................... [RUN]
[0m18:12:49.739663 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m18:12:49.740561 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541, now test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa)
[0m18:12:49.741576 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m18:12:49.746083 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m18:12:49.755431 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m18:12:49.756567 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: BEGIN
[0m18:12:49.757155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:49.758299 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:12:49.758954 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m18:12:49.759633 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."dim_dates"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m18:12:49.760661 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m18:12:49.762875 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m18:12:49.763379 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:12:49.763765 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m18:12:49.765659 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: ROLLBACK
[0m18:12:49.767596 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m18:12:49.768799 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0'
[0m18:12:49.769882 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: Close
[0m18:12:49.770653 [info ] [Thread-1 (]: 13 of 91 PASS not_null_dim_dates_is_weekend .................................... [[32mPASS[0m in 0.07s]
[0m18:12:49.771349 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m18:12:49.772194 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m18:12:49.772840 [info ] [Thread-1 (]: 16 of 91 START test not_null_taxi_zone_lookup_LocationID ....................... [RUN]
[0m18:12:49.773650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0, now test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a)
[0m18:12:49.774233 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m18:12:49.777665 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m18:12:49.784786 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m18:12:49.785775 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m18:12:49.786206 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: BEGIN
[0m18:12:49.786793 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: BEGIN
[0m18:12:49.787744 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:49.788541 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:49.790159 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:12:49.790772 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:12:49.791078 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m18:12:49.791607 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m18:12:49.792287 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Borough
from "dev"."main"."taxi_zone_lookup"
where Borough is null



  
  
      
    ) dbt_internal_test
[0m18:12:49.792994 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "dev"."main"."dim_dates"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:12:49.794967 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:12:49.796889 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: ROLLBACK
[0m18:12:49.797369 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m18:12:49.797695 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:12:49.798538 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa'
[0m18:12:49.800401 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m18:12:49.801665 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: ROLLBACK
[0m18:12:49.801918 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: Close
[0m18:12:49.803066 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d'
[0m18:12:49.803716 [info ] [Thread-3 (]: 15 of 91 PASS not_null_taxi_zone_lookup_Borough ................................ [[32mPASS[0m in 0.06s]
[0m18:12:49.804014 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: Close
[0m18:12:49.804834 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m18:12:49.805637 [info ] [Thread-4 (]: 14 of 91 PASS unique_dim_dates_date_key ........................................ [[32mPASS[0m in 0.08s]
[0m18:12:49.806040 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m18:12:49.806987 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m18:12:49.807618 [info ] [Thread-3 (]: 17 of 91 START test unique_taxi_zone_lookup_LocationID ......................... [RUN]
[0m18:12:49.808273 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m18:12:49.809230 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa, now test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8)
[0m18:12:49.809955 [info ] [Thread-4 (]: 18 of 91 START sql view model main.stg_rate_codes .............................. [RUN]
[0m18:12:49.810574 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m18:12:49.811312 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d, now model.nyc_taxi_pipeline_00.stg_rate_codes)
[0m18:12:49.814915 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m18:12:49.815691 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m18:12:49.818555 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m18:12:49.820694 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m18:12:49.821825 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: BEGIN
[0m18:12:49.822652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:49.823979 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:12:49.824747 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m18:12:49.825326 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select LocationID
from "dev"."main"."taxi_zone_lookup"
where LocationID is null



  
  
      
    ) dbt_internal_test
[0m18:12:49.826822 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:12:49.828560 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: ROLLBACK
[0m18:12:49.829713 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a'
[0m18:12:49.830450 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: Close
[0m18:12:49.831575 [info ] [Thread-1 (]: 16 of 91 PASS not_null_taxi_zone_lookup_LocationID ............................. [[32mPASS[0m in 0.06s]
[0m18:12:49.832375 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m18:12:49.833044 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.stg_payment_types
[0m18:12:49.833694 [info ] [Thread-1 (]: 19 of 91 START sql view model main.stg_payment_types ........................... [RUN]
[0m18:12:49.834481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a, now model.nyc_taxi_pipeline_00.stg_payment_types)
[0m18:12:49.835023 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m18:12:49.835419 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m18:12:49.835787 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_payment_types
[0m18:12:49.838426 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m18:12:49.852939 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m18:12:49.859899 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m18:12:49.875259 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m18:12:49.875808 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.stg_payment_types
[0m18:12:49.876278 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: BEGIN
[0m18:12:49.876937 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m18:12:49.879793 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m18:12:49.880657 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:49.881288 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: BEGIN
[0m18:12:49.882868 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:12:49.883248 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:49.883825 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m18:12:49.884773 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */

  
  create view "dev"."main"."stg_rate_codes__dbt_tmp" as (
    /*
    Staging model: Rate code lookup
    Maps rate_code_id to human-readable names.
*/

with source as (
    select * from "dev"."main"."rate_code_lookup"
),

renamed as (
    select
        rate_code_id,
        rate_code_name
    from source
)

select * from renamed
  );

[0m18:12:49.885108 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:12:49.885781 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m18:12:49.886119 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:12:49.886407 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    LocationID as unique_field,
    count(*) as n_records

from "dev"."main"."taxi_zone_lookup"
where LocationID is not null
group by LocationID
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:12:49.889404 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m18:12:49.890469 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
alter view "dev"."main"."stg_rate_codes" rename to "stg_rate_codes__dbt_backup"
[0m18:12:49.891733 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:12:49.892134 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:12:49.894685 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m18:12:49.896461 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: ROLLBACK
[0m18:12:49.896850 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
alter view "dev"."main"."stg_rate_codes__dbt_tmp" rename to "stg_rate_codes"
[0m18:12:49.897700 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8'
[0m18:12:49.898820 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: Close
[0m18:12:49.899242 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:12:49.899700 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m18:12:49.900371 [info ] [Thread-3 (]: 17 of 91 PASS unique_taxi_zone_lookup_LocationID ............................... [[32mPASS[0m in 0.09s]
[0m18:12:49.901603 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: COMMIT
[0m18:12:49.902227 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: BEGIN
[0m18:12:49.902935 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m18:12:49.903474 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m18:12:49.903957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:49.905043 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m18:12:49.905320 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: COMMIT
[0m18:12:49.906388 [info ] [Thread-3 (]: 20 of 91 START sql view model main.stg_taxi_zones .............................. [RUN]
[0m18:12:49.906832 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:12:49.907706 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8, now model.nyc_taxi_pipeline_00.stg_taxi_zones)
[0m18:12:49.908252 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m18:12:49.908830 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m18:12:49.909430 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */

  
  create view "dev"."main"."stg_payment_types__dbt_tmp" as (
    /*
    Staging model: Payment type lookup
    Maps payment_type_id to human-readable names.
*/

with source as (
    select * from "dev"."main"."payment_type_lookup"
),

renamed as (
    select
        payment_type_id,
        payment_type_name
    from source
)

select * from renamed
  );

[0m18:12:49.912359 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m18:12:49.912877 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m18:12:49.915837 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m18:12:49.916145 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:12:49.916505 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
drop view if exists "dev"."main"."stg_rate_codes__dbt_backup" cascade
[0m18:12:49.919324 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m18:12:49.920184 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
alter view "dev"."main"."stg_payment_types" rename to "stg_payment_types__dbt_backup"
[0m18:12:49.921386 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:12:49.923705 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m18:12:49.924023 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m18:12:49.924301 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
alter view "dev"."main"."stg_payment_types__dbt_tmp" rename to "stg_payment_types"
[0m18:12:49.925546 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: Close
[0m18:12:49.926462 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1175b3-4e94-4b95-97e9-9c6dd8e8b5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e3c0124a70>]}
[0m18:12:49.926820 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:12:49.927291 [info ] [Thread-4 (]: 18 of 91 OK created sql view model main.stg_rate_codes ......................... [[32mOK[0m in 0.12s]
[0m18:12:49.928537 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: COMMIT
[0m18:12:49.929293 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m18:12:49.929993 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m18:12:49.930372 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m18:12:49.931760 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m18:12:49.932066 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: COMMIT
[0m18:12:49.935989 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m18:12:49.936733 [info ] [Thread-4 (]: 21 of 91 START test not_null_stg_rate_codes_rate_code_id ....................... [RUN]
[0m18:12:49.938709 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_rate_codes, now test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a)
[0m18:12:49.939417 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m18:12:49.945453 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m18:12:49.946181 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:12:49.949277 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m18:12:49.949799 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
drop view if exists "dev"."main"."stg_payment_types__dbt_backup" cascade
[0m18:12:49.954308 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:12:49.955739 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: Close
[0m18:12:49.956572 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1175b3-4e94-4b95-97e9-9c6dd8e8b5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e3c177a630>]}
[0m18:12:49.957405 [info ] [Thread-1 (]: 19 of 91 OK created sql view model main.stg_payment_types ...................... [[32mOK[0m in 0.12s]
[0m18:12:49.958365 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.stg_payment_types
[0m18:12:49.959376 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m18:12:49.961246 [info ] [Thread-1 (]: 22 of 91 START test not_null_stg_rate_codes_rate_code_name ..................... [RUN]
[0m18:12:49.962194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_payment_types, now test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f)
[0m18:12:49.962755 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m18:12:49.963153 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m18:12:49.966548 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m18:12:49.967305 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: BEGIN
[0m18:12:49.968078 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m18:12:49.968612 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:49.970900 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m18:12:49.972246 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m18:12:49.972872 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m18:12:49.973911 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */

  
  create view "dev"."main"."stg_taxi_zones__dbt_tmp" as (
    /*
    Staging model: Taxi zone lookup
    Maps LocationID to borough and zone name.
*/

with source as (
    select * from "dev"."main"."taxi_zone_lookup"
),

renamed as (
    select
        cast("LocationID" as integer) as location_id,
        "Borough" as borough,
        "Zone" as zone_name,
        service_zone
    from source
)

select * from renamed
  );

[0m18:12:49.975300 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:12:49.978473 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m18:12:49.979068 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
alter view "dev"."main"."stg_taxi_zones" rename to "stg_taxi_zones__dbt_backup"
[0m18:12:49.980297 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:12:49.982939 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m18:12:49.983457 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
alter view "dev"."main"."stg_taxi_zones__dbt_tmp" rename to "stg_taxi_zones"
[0m18:12:49.984541 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:12:49.984996 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m18:12:49.986670 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: COMMIT
[0m18:12:49.989585 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m18:12:49.990381 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m18:12:49.991776 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m18:12:49.992293 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: COMMIT
[0m18:12:49.992970 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: BEGIN
[0m18:12:49.994025 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:49.995042 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:12:49.995704 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m18:12:49.996255 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_id
from "dev"."main"."stg_rate_codes"
where rate_code_id is null



  
  
      
    ) dbt_internal_test
[0m18:12:49.997247 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m18:12:50.000820 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m18:12:50.001346 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m18:12:50.001687 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
drop view if exists "dev"."main"."stg_taxi_zones__dbt_backup" cascade
[0m18:12:50.003659 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: ROLLBACK
[0m18:12:50.004795 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a'
[0m18:12:50.005248 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: Close
[0m18:12:50.006909 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:12:50.007598 [info ] [Thread-4 (]: 21 of 91 PASS not_null_stg_rate_codes_rate_code_id ............................. [[32mPASS[0m in 0.07s]
[0m18:12:50.008827 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: Close
[0m18:12:50.009596 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m18:12:50.010532 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1175b3-4e94-4b95-97e9-9c6dd8e8b5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e3c016cfb0>]}
[0m18:12:50.011030 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m18:12:50.011686 [info ] [Thread-3 (]: 20 of 91 OK created sql view model main.stg_taxi_zones ......................... [[32mOK[0m in 0.10s]
[0m18:12:50.012076 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m18:12:50.012769 [info ] [Thread-4 (]: 23 of 91 START test unique_stg_rate_codes_rate_code_id ......................... [RUN]
[0m18:12:50.013584 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m18:12:50.014254 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: BEGIN
[0m18:12:50.015039 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a, now test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3)
[0m18:12:50.015637 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m18:12:50.016537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:50.017559 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m18:12:50.018200 [info ] [Thread-3 (]: 24 of 91 START test not_null_stg_payment_types_payment_type_id ................. [RUN]
[0m18:12:50.023287 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m18:12:50.023784 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m18:12:50.024558 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_taxi_zones, now test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78)
[0m18:12:50.025726 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m18:12:50.026374 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m18:12:50.027757 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_name
from "dev"."main"."stg_rate_codes"
where rate_code_name is null



  
  
      
    ) dbt_internal_test
[0m18:12:50.032480 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m18:12:50.034609 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:12:50.036398 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: ROLLBACK
[0m18:12:50.037219 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f'
[0m18:12:50.037634 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: Close
[0m18:12:50.038298 [info ] [Thread-1 (]: 22 of 91 PASS not_null_stg_rate_codes_rate_code_name ........................... [[32mPASS[0m in 0.08s]
[0m18:12:50.038932 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m18:12:50.039561 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m18:12:50.040134 [info ] [Thread-1 (]: 25 of 91 START test not_null_stg_payment_types_payment_type_name ............... [RUN]
[0m18:12:50.040858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f, now test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39)
[0m18:12:50.041640 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m18:12:50.046644 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m18:12:50.049187 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m18:12:50.049772 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m18:12:50.051597 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m18:12:50.053567 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m18:12:50.058594 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m18:12:50.060969 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m18:12:50.067556 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m18:12:50.068073 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m18:12:50.068461 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: BEGIN
[0m18:12:50.069120 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: BEGIN
[0m18:12:50.069657 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:50.070130 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:50.071473 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:12:50.071932 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:12:50.072349 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m18:12:50.073104 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m18:12:50.073884 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."stg_payment_types"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m18:12:50.074643 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rate_code_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_rate_codes"
where rate_code_id is not null
group by rate_code_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:12:50.075731 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m18:12:50.076452 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:12:50.077019 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: BEGIN
[0m18:12:50.077503 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:12:50.078960 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: ROLLBACK
[0m18:12:50.079628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:50.081189 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: ROLLBACK
[0m18:12:50.082075 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78'
[0m18:12:50.083288 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3'
[0m18:12:50.083602 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:12:50.084120 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: Close
[0m18:12:50.084797 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: Close
[0m18:12:50.085426 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m18:12:50.086307 [info ] [Thread-3 (]: 24 of 91 PASS not_null_stg_payment_types_payment_type_id ....................... [[32mPASS[0m in 0.06s]
[0m18:12:50.087082 [info ] [Thread-4 (]: 23 of 91 PASS unique_stg_rate_codes_rate_code_id ............................... [[32mPASS[0m in 0.07s]
[0m18:12:50.087431 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_name
from "dev"."main"."stg_payment_types"
where payment_type_name is null



  
  
      
    ) dbt_internal_test
[0m18:12:50.088114 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m18:12:50.088683 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m18:12:50.089534 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m18:12:50.090206 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:12:50.090593 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m18:12:50.091295 [info ] [Thread-3 (]: 26 of 91 START test unique_stg_payment_types_payment_type_id ................... [RUN]
[0m18:12:50.092897 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: ROLLBACK
[0m18:12:50.093533 [info ] [Thread-4 (]: 27 of 91 START test not_null_stg_taxi_zones_borough ............................ [RUN]
[0m18:12:50.094171 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78, now test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534)
[0m18:12:50.095048 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39'
[0m18:12:50.095629 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b)
[0m18:12:50.096074 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m18:12:50.096655 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: Close
[0m18:12:50.097291 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m18:12:50.100686 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m18:12:50.101797 [info ] [Thread-1 (]: 25 of 91 PASS not_null_stg_payment_types_payment_type_name ..................... [[32mPASS[0m in 0.06s]
[0m18:12:50.105487 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m18:12:50.106900 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m18:12:50.108081 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m18:12:50.108535 [info ] [Thread-1 (]: 28 of 91 START test not_null_stg_taxi_zones_location_id ........................ [RUN]
[0m18:12:50.109135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf)
[0m18:12:50.109623 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m18:12:50.113044 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m18:12:50.121812 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m18:12:50.122269 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m18:12:50.124646 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m18:12:50.127177 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m18:12:50.129188 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m18:12:50.132493 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m18:12:50.145716 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m18:12:50.146248 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m18:12:50.146669 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m18:12:50.146986 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: BEGIN
[0m18:12:50.147581 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: BEGIN
[0m18:12:50.148258 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: BEGIN
[0m18:12:50.148854 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:50.149455 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:50.149926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:50.151110 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:12:50.151647 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:12:50.152012 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m18:12:50.152375 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:12:50.153070 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m18:12:50.153814 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select borough
from "dev"."main"."stg_taxi_zones"
where borough is null



  
  
      
    ) dbt_internal_test
[0m18:12:50.154445 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m18:12:50.155059 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_payment_types"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:12:50.156224 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "dev"."main"."stg_taxi_zones"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m18:12:50.156787 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:12:50.158760 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: ROLLBACK
[0m18:12:50.159192 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:12:50.159491 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:12:50.160076 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b'
[0m18:12:50.161760 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: ROLLBACK
[0m18:12:50.163160 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: ROLLBACK
[0m18:12:50.163528 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: Close
[0m18:12:50.164505 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf'
[0m18:12:50.165432 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534'
[0m18:12:50.166588 [info ] [Thread-4 (]: 27 of 91 PASS not_null_stg_taxi_zones_borough .................................. [[32mPASS[0m in 0.07s]
[0m18:12:50.167041 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: Close
[0m18:12:50.167678 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: Close
[0m18:12:50.168320 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m18:12:50.169221 [info ] [Thread-1 (]: 28 of 91 PASS not_null_stg_taxi_zones_location_id .............................. [[32mPASS[0m in 0.06s]
[0m18:12:50.169780 [info ] [Thread-3 (]: 26 of 91 PASS unique_stg_payment_types_payment_type_id ......................... [[32mPASS[0m in 0.08s]
[0m18:12:50.170153 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m18:12:50.170984 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m18:12:50.171742 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m18:12:50.172373 [info ] [Thread-4 (]: 29 of 91 START test not_null_stg_taxi_zones_zone_name .......................... [RUN]
[0m18:12:50.173079 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m18:12:50.174189 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.dim_payment_types
[0m18:12:50.174852 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84)
[0m18:12:50.175410 [info ] [Thread-1 (]: 30 of 91 START test unique_stg_taxi_zones_location_id .......................... [RUN]
[0m18:12:50.176071 [info ] [Thread-3 (]: 31 of 91 START sql table model main.dim_payment_types .......................... [RUN]
[0m18:12:50.176638 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m18:12:50.177299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf, now test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c)
[0m18:12:50.177859 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534, now model.nyc_taxi_pipeline_00.dim_payment_types)
[0m18:12:50.181163 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m18:12:50.182157 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m18:12:50.182936 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_payment_types
[0m18:12:50.187861 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m18:12:50.190816 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m18:12:50.201444 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m18:12:50.203671 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m18:12:50.205239 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m18:12:50.205651 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.dim_payment_types
[0m18:12:50.207378 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m18:12:50.211499 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m18:12:50.213236 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
DESCRIBE (select * from (
        /*
    Dimension table: Payment type descriptions.
*/

with payment_types as (
    select * from "dev"."main"."stg_payment_types"
),

final as (
    select
        payment_type_id,
        payment_type_name
    from payment_types
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:12:50.214057 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:50.216152 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:12:50.217938 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m18:12:50.218641 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as payment_type_id, 
      
    cast(null as varchar)
 as payment_type_name
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:12:50.219935 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:12:50.221923 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m18:12:50.224510 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m18:12:50.225154 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m18:12:50.225784 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: BEGIN
[0m18:12:50.226387 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: BEGIN
[0m18:12:50.226957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:50.227597 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:50.229072 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:12:50.229798 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:12:50.230148 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m18:12:50.230726 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m18:12:50.231313 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_taxi_zones"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:12:50.231919 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select zone_name
from "dev"."main"."stg_taxi_zones"
where zone_name is null



  
  
      
    ) dbt_internal_test
[0m18:12:50.233891 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:12:50.234307 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:12:50.235883 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: ROLLBACK
[0m18:12:50.237442 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: ROLLBACK
[0m18:12:50.238621 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84'
[0m18:12:50.239775 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c'
[0m18:12:50.240503 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: Close
[0m18:12:50.241131 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: Close
[0m18:12:50.241619 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m18:12:50.242261 [info ] [Thread-4 (]: 29 of 91 PASS not_null_stg_taxi_zones_zone_name ................................ [[32mPASS[0m in 0.07s]
[0m18:12:50.243177 [info ] [Thread-1 (]: 30 of 91 PASS unique_stg_taxi_zones_location_id ................................ [[32mPASS[0m in 0.07s]
[0m18:12:50.244097 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: BEGIN
[0m18:12:50.244993 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m18:12:50.245710 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m18:12:50.247382 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:12:50.248160 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.dim_locations
[0m18:12:50.248828 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m18:12:50.249633 [info ] [Thread-4 (]: 32 of 91 START sql table model main.dim_locations .............................. [RUN]
[0m18:12:50.250322 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_payment_types__dbt_tmp"
  
  (
    payment_type_id integer,
    payment_type_name varchar
    
    )
 ;
    insert into "dev"."main"."dim_payment_types__dbt_tmp" 
  (
    
      
      payment_type_id ,
    
      
      payment_type_name 
    
  )
 (
      
    select payment_type_id, payment_type_name
    from (
        /*
    Dimension table: Payment type descriptions.
*/

with payment_types as (
    select * from "dev"."main"."stg_payment_types"
),

final as (
    select
        payment_type_id,
        payment_type_name
    from payment_types
)

select * from final
    ) as model_subq
    );
  
  
[0m18:12:50.251151 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84, now model.nyc_taxi_pipeline_00.dim_locations)
[0m18:12:50.252218 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_locations
[0m18:12:50.255841 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_locations"
[0m18:12:50.256352 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m18:12:50.260051 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m18:12:50.260623 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
alter table "dev"."main"."dim_payment_types" rename to "dim_payment_types__dbt_backup"
[0m18:12:50.261818 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:12:50.266096 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m18:12:50.266820 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
alter table "dev"."main"."dim_payment_types__dbt_tmp" rename to "dim_payment_types"
[0m18:12:50.267888 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:12:50.269291 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: COMMIT
[0m18:12:50.269771 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m18:12:50.270267 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: COMMIT
[0m18:12:50.274978 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m18:12:50.275523 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.dim_locations
[0m18:12:50.278606 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m18:12:50.282200 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m18:12:50.283184 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
drop table if exists "dev"."main"."dim_payment_types__dbt_backup" cascade
[0m18:12:50.283826 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
DESCRIBE (select * from (
        /*
    Dimension table: TLC Taxi Zone locations.
*/

with zones as (
    select * from "dev"."main"."stg_taxi_zones"
),

final as (
    select
        location_id,
        borough,
        zone_name,
        service_zone
    from zones
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:12:50.284889 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:50.286923 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:12:50.289421 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m18:12:50.290843 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m18:12:50.292114 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: Close
[0m18:12:50.292812 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as location_id, 
      
    cast(null as varchar)
 as borough, 
      
    cast(null as varchar)
 as zone_name, 
      
    cast(null as varchar)
 as service_zone
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:12:50.293719 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1175b3-4e94-4b95-97e9-9c6dd8e8b5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e3c1b74c20>]}
[0m18:12:50.294763 [info ] [Thread-3 (]: 31 of 91 OK created sql table model main.dim_payment_types ..................... [[32mOK[0m in 0.12s]
[0m18:12:50.295269 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:12:50.295808 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.dim_payment_types
[0m18:12:50.297504 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_locations"
[0m18:12:50.298498 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m18:12:50.298834 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m18:12:50.299229 [info ] [Thread-1 (]: 33 of 91 START test not_null_dim_payment_types_payment_type_id ................. [RUN]
[0m18:12:50.299774 [info ] [Thread-3 (]: 34 of 91 START test not_null_dim_payment_types_payment_type_name ............... [RUN]
[0m18:12:50.300419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c, now test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10)
[0m18:12:50.300935 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_payment_types, now test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0)
[0m18:12:50.301425 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m18:12:50.302008 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m18:12:50.305861 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m18:12:50.309455 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m18:12:50.317025 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m18:12:50.317607 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: BEGIN
[0m18:12:50.318731 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:12:50.319241 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m18:12:50.319690 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_locations__dbt_tmp"
  
  (
    location_id integer,
    borough varchar,
    zone_name varchar,
    service_zone varchar
    
    )
 ;
    insert into "dev"."main"."dim_locations__dbt_tmp" 
  (
    
      
      location_id ,
    
      
      borough ,
    
      
      zone_name ,
    
      
      service_zone 
    
  )
 (
      
    select location_id, borough, zone_name, service_zone
    from (
        /*
    Dimension table: TLC Taxi Zone locations.
*/

with zones as (
    select * from "dev"."main"."stg_taxi_zones"
),

final as (
    select
        location_id,
        borough,
        zone_name,
        service_zone
    from zones
)

select * from final
    ) as model_subq
    );
  
  
[0m18:12:50.325330 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m18:12:50.325828 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m18:12:50.328401 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m18:12:50.328989 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m18:12:50.330875 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m18:12:50.331705 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
alter table "dev"."main"."dim_locations" rename to "dim_locations__dbt_backup"
[0m18:12:50.334092 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m18:12:50.335925 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:12:50.339325 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m18:12:50.339873 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
alter table "dev"."main"."dim_locations__dbt_tmp" rename to "dim_locations"
[0m18:12:50.340954 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:12:50.343518 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: COMMIT
[0m18:12:50.344090 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m18:12:50.344540 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: COMMIT
[0m18:12:50.349600 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m18:12:50.352213 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m18:12:50.352781 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
drop table if exists "dev"."main"."dim_locations__dbt_backup" cascade
[0m18:12:50.354221 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m18:12:50.354652 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: BEGIN
[0m18:12:50.355434 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:50.355939 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m18:12:50.356664 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:12:50.357042 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: BEGIN
[0m18:12:50.357362 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m18:12:50.357853 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m18:12:50.358488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:50.360124 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: Close
[0m18:12:50.360826 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_name
from "dev"."main"."dim_payment_types"
where payment_type_name is null



  
  
      
    ) dbt_internal_test
[0m18:12:50.362174 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1175b3-4e94-4b95-97e9-9c6dd8e8b5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e3ac1179e0>]}
[0m18:12:50.362658 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:12:50.363670 [info ] [Thread-4 (]: 32 of 91 OK created sql table model main.dim_locations ......................... [[32mOK[0m in 0.11s]
[0m18:12:50.364419 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:12:50.364976 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m18:12:50.365743 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.dim_locations
[0m18:12:50.367731 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: ROLLBACK
[0m18:12:50.368417 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."dim_payment_types"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m18:12:50.369103 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m18:12:50.370292 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0'
[0m18:12:50.371262 [info ] [Thread-4 (]: 35 of 91 START test unique_dim_payment_types_payment_type_id ................... [RUN]
[0m18:12:50.371720 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:12:50.372064 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: Close
[0m18:12:50.372852 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_locations, now test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62)
[0m18:12:50.374533 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: ROLLBACK
[0m18:12:50.375252 [info ] [Thread-3 (]: 34 of 91 PASS not_null_dim_payment_types_payment_type_name ..................... [[32mPASS[0m in 0.07s]
[0m18:12:50.375622 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m18:12:50.376594 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10'
[0m18:12:50.377490 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m18:12:50.382339 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m18:12:50.383142 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: Close
[0m18:12:50.383779 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m18:12:50.385021 [info ] [Thread-1 (]: 33 of 91 PASS not_null_dim_payment_types_payment_type_id ....................... [[32mPASS[0m in 0.08s]
[0m18:12:50.385553 [info ] [Thread-3 (]: 36 of 91 START test not_null_dim_locations_borough ............................. [RUN]
[0m18:12:50.386245 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m18:12:50.386790 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0, now test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af)
[0m18:12:50.387338 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m18:12:50.387903 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m18:12:50.388430 [info ] [Thread-1 (]: 37 of 91 START test not_null_dim_locations_location_id ......................... [RUN]
[0m18:12:50.392787 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m18:12:50.394360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10, now test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476)
[0m18:12:50.395373 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m18:12:50.399733 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m18:12:50.402750 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m18:12:50.405198 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m18:12:50.406931 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m18:12:50.409283 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m18:12:50.411965 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m18:12:50.415582 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m18:12:50.422704 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m18:12:50.423345 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m18:12:50.423765 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: BEGIN
[0m18:12:50.424405 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: BEGIN
[0m18:12:50.425027 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:50.425660 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:50.427344 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:12:50.427892 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:12:50.428287 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m18:12:50.428768 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m18:12:50.429129 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m18:12:50.429821 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select borough
from "dev"."main"."dim_locations"
where borough is null



  
  
      
    ) dbt_internal_test
[0m18:12:50.430383 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: BEGIN
[0m18:12:50.430933 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."dim_payment_types"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:12:50.432033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:50.432596 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:12:50.433695 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:12:50.434052 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:12:50.435615 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: ROLLBACK
[0m18:12:50.436167 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m18:12:50.437650 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: ROLLBACK
[0m18:12:50.438565 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af'
[0m18:12:50.439150 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "dev"."main"."dim_locations"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m18:12:50.440121 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62'
[0m18:12:50.440676 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: Close
[0m18:12:50.441579 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: Close
[0m18:12:50.442104 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:12:50.442756 [info ] [Thread-3 (]: 36 of 91 PASS not_null_dim_locations_borough ................................... [[32mPASS[0m in 0.06s]
[0m18:12:50.443556 [info ] [Thread-4 (]: 35 of 91 PASS unique_dim_payment_types_payment_type_id ......................... [[32mPASS[0m in 0.07s]
[0m18:12:50.445165 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: ROLLBACK
[0m18:12:50.445773 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m18:12:50.446550 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m18:12:50.447603 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476'
[0m18:12:50.448182 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m18:12:50.448855 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m18:12:50.449451 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: Close
[0m18:12:50.450075 [info ] [Thread-3 (]: 38 of 91 START test not_null_dim_locations_zone_name ........................... [RUN]
[0m18:12:50.450806 [info ] [Thread-4 (]: 39 of 91 START test unique_dim_locations_location_id ........................... [RUN]
[0m18:12:50.451701 [info ] [Thread-1 (]: 37 of 91 PASS not_null_dim_locations_location_id ............................... [[32mPASS[0m in 0.06s]
[0m18:12:50.452352 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af, now test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d)
[0m18:12:50.453009 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62, now test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d)
[0m18:12:50.453735 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m18:12:50.454342 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m18:12:50.454845 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m18:12:50.459571 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m18:12:50.464016 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m18:12:50.480355 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m18:12:50.484798 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m18:12:50.485281 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m18:12:50.487372 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m18:12:50.500374 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m18:12:50.501323 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m18:12:50.501788 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: BEGIN
[0m18:12:50.502412 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: BEGIN
[0m18:12:50.503017 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:50.503736 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:50.504726 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:12:50.505367 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:12:50.505691 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m18:12:50.506178 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m18:12:50.506732 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select zone_name
from "dev"."main"."dim_locations"
where zone_name is null



  
  
      
    ) dbt_internal_test
[0m18:12:50.507292 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "dev"."main"."dim_locations"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:12:50.509161 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:12:50.509636 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:12:50.511086 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: ROLLBACK
[0m18:12:50.512428 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: ROLLBACK
[0m18:12:50.513221 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d'
[0m18:12:50.514410 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d'
[0m18:12:50.515104 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: Close
[0m18:12:50.515678 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: Close
[0m18:12:50.516645 [info ] [Thread-3 (]: 38 of 91 PASS not_null_dim_locations_zone_name ................................. [[32mPASS[0m in 0.06s]
[0m18:12:50.517320 [info ] [Thread-4 (]: 39 of 91 PASS unique_dim_locations_location_id ................................. [[32mPASS[0m in 0.06s]
[0m18:12:50.517822 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m18:12:50.518407 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m18:12:52.050314 [debug] [Thread-2 (]: SQL status: OK in 2.644 seconds
[0m18:12:52.052911 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m18:12:52.053431 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
alter table "dev"."main"."stg_yellow_trips" rename to "stg_yellow_trips__dbt_backup"
[0m18:12:52.054334 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:12:52.056239 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m18:12:52.056753 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
alter table "dev"."main"."stg_yellow_trips__dbt_tmp" rename to "stg_yellow_trips"
[0m18:12:52.057523 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:12:52.058645 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: COMMIT
[0m18:12:52.059033 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m18:12:52.059346 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: COMMIT
[0m18:12:52.107708 [debug] [Thread-2 (]: SQL status: OK in 0.048 seconds
[0m18:12:52.109786 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m18:12:52.110168 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
drop table if exists "dev"."main"."stg_yellow_trips__dbt_backup" cascade
[0m18:12:52.114742 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m18:12:52.116069 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: Close
[0m18:12:52.188895 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1175b3-4e94-4b95-97e9-9c6dd8e8b5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e3c1b747d0>]}
[0m18:12:52.189806 [info ] [Thread-2 (]: 2 of 91 OK created sql table model main.stg_yellow_trips ....................... [[32mOK[0m in 2.91s]
[0m18:12:52.190561 [debug] [Thread-2 (]: Finished running node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m18:12:52.191954 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m18:12:52.192349 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m18:12:52.192575 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m18:12:52.193001 [info ] [Thread-1 (]: 40 of 91 START test accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6  [RUN]
[0m18:12:52.193395 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m18:12:52.193987 [info ] [Thread-3 (]: 41 of 91 START test accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99  [RUN]
[0m18:12:52.194518 [info ] [Thread-4 (]: 42 of 91 START test accepted_values_stg_yellow_trips_vendor_id__1__2__6 ........ [RUN]
[0m18:12:52.195117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44)
[0m18:12:52.195781 [info ] [Thread-2 (]: 43 of 91 START test assert_fare_not_exceeds_total .............................. [RUN]
[0m18:12:52.196434 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098)
[0m18:12:52.197012 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27)
[0m18:12:52.197478 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m18:12:52.197950 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_yellow_trips, now test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total)
[0m18:12:52.200628 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m18:12:52.201171 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m18:12:52.206583 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m18:12:52.207200 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m18:12:52.210020 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m18:12:52.213380 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m18:12:52.215608 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m18:12:52.226687 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m18:12:52.230003 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m18:12:52.231220 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m18:12:52.231470 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m18:12:52.233032 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m18:12:52.233432 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m18:12:52.235155 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m18:12:52.237427 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m18:12:52.245775 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m18:12:52.246419 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: BEGIN
[0m18:12:52.246928 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:12:52.251329 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m18:12:52.251867 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m18:12:52.252309 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: BEGIN
[0m18:12:52.252816 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m18:12:52.253331 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: BEGIN
[0m18:12:52.253879 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:52.254382 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: BEGIN
[0m18:12:52.254843 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:52.255925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:52.267586 [debug] [Thread-2 (]: SQL status: OK in 0.021 seconds
[0m18:12:52.267969 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m18:12:52.268325 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m18:12:52.268569 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:12:52.268868 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m18:12:52.269314 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m18:12:52.269702 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
    Singular test: fare_amount should not exceed total_amount.
*/

select
    trip_id,
    fare_amount,
    total_amount
from "dev"."main"."stg_yellow_trips"
where fare_amount > total_amount + 0.01
  and total_amount > 0
  
  
      
    ) dbt_internal_test
[0m18:12:52.270058 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m18:12:52.270501 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m18:12:52.270936 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        vendor_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by vendor_id

)

select *
from all_values
where value_field not in (
    '1','2','6'
)



  
  
      
    ) dbt_internal_test
[0m18:12:52.272350 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        payment_type_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by payment_type_id

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6'
)



  
  
      
    ) dbt_internal_test
[0m18:12:52.279374 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rate_code_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by rate_code_id

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5','6','99'
)



  
  
      
    ) dbt_internal_test
[0m18:12:52.310639 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m18:12:52.314079 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: ROLLBACK
[0m18:12:52.315829 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total'
[0m18:12:52.316357 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m18:12:52.316667 [debug] [Thread-4 (]: SQL status: OK in 0.035 seconds
[0m18:12:52.316984 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: Close
[0m18:12:52.317286 [debug] [Thread-3 (]: SQL status: OK in 0.032 seconds
[0m18:12:52.318726 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: ROLLBACK
[0m18:12:52.319703 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: ROLLBACK
[0m18:12:52.320184 [info ] [Thread-2 (]: 43 of 91 PASS assert_fare_not_exceeds_total .................................... [[32mPASS[0m in 0.12s]
[0m18:12:52.321390 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: ROLLBACK
[0m18:12:52.322037 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44'
[0m18:12:52.323148 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27'
[0m18:12:52.323727 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m18:12:52.324385 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098'
[0m18:12:52.324779 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: Close
[0m18:12:52.325144 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: Close
[0m18:12:52.325582 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m18:12:52.325946 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: Close
[0m18:12:52.326531 [info ] [Thread-1 (]: 40 of 91 PASS accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6  [[32mPASS[0m in 0.13s]
[0m18:12:52.327091 [info ] [Thread-4 (]: 42 of 91 PASS accepted_values_stg_yellow_trips_vendor_id__1__2__6 .............. [[32mPASS[0m in 0.13s]
[0m18:12:52.327384 [info ] [Thread-2 (]: 44 of 91 START test not_null_stg_yellow_trips_dropoff_datetime ................. [RUN]
[0m18:12:52.328170 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m18:12:52.328811 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m18:12:52.329565 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052)
[0m18:12:52.330395 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m18:12:52.331141 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m18:12:52.331922 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m18:12:52.332529 [info ] [Thread-1 (]: 45 of 91 START test not_null_stg_yellow_trips_dropoff_location_id .............. [RUN]
[0m18:12:52.333098 [info ] [Thread-4 (]: 46 of 91 START test not_null_stg_yellow_trips_fare_amount ...................... [RUN]
[0m18:12:52.333612 [info ] [Thread-3 (]: 41 of 91 PASS accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99  [[32mPASS[0m in 0.14s]
[0m18:12:52.337029 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m18:12:52.337654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048)
[0m18:12:52.338143 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97)
[0m18:12:52.338761 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m18:12:52.339541 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m18:12:52.339945 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m18:12:52.340388 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m18:12:52.343235 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m18:12:52.346037 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m18:12:52.346733 [info ] [Thread-3 (]: 47 of 91 START test not_null_stg_yellow_trips_pickup_datetime .................. [RUN]
[0m18:12:52.348085 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed)
[0m18:12:52.348545 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m18:12:52.351421 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m18:12:52.355456 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m18:12:52.357633 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m18:12:52.358742 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m18:12:52.359087 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m18:12:52.360783 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m18:12:52.364039 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m18:12:52.365790 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m18:12:52.367745 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m18:12:52.372815 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m18:12:52.373450 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: BEGIN
[0m18:12:52.373940 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:12:52.374689 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m18:12:52.375014 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m18:12:52.375293 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: BEGIN
[0m18:12:52.375693 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: BEGIN
[0m18:12:52.376092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:52.376503 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:52.378481 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m18:12:52.379021 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: BEGIN
[0m18:12:52.379468 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:52.395131 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m18:12:52.395521 [debug] [Thread-2 (]: SQL status: OK in 0.022 seconds
[0m18:12:52.395811 [debug] [Thread-4 (]: SQL status: OK in 0.019 seconds
[0m18:12:52.396081 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m18:12:52.396332 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m18:12:52.396791 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m18:12:52.397213 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m18:12:52.397580 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m18:12:52.397941 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_location_id
from "dev"."main"."stg_yellow_trips"
where dropoff_location_id is null



  
  
      
    ) dbt_internal_test
[0m18:12:52.398331 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_datetime
from "dev"."main"."stg_yellow_trips"
where dropoff_datetime is null



  
  
      
    ) dbt_internal_test
[0m18:12:52.398728 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fare_amount
from "dev"."main"."stg_yellow_trips"
where fare_amount is null



  
  
      
    ) dbt_internal_test
[0m18:12:52.399141 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "dev"."main"."stg_yellow_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m18:12:52.400729 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:12:52.401129 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:12:52.401595 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:12:52.403029 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: ROLLBACK
[0m18:12:52.403313 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:12:52.404524 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: ROLLBACK
[0m18:12:52.405664 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: ROLLBACK
[0m18:12:52.406366 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052'
[0m18:12:52.407362 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: ROLLBACK
[0m18:12:52.408044 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048'
[0m18:12:52.408795 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97'
[0m18:12:52.409222 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: Close
[0m18:12:52.409860 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed'
[0m18:12:52.410264 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: Close
[0m18:12:52.410637 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: Close
[0m18:12:52.411291 [info ] [Thread-2 (]: 44 of 91 PASS not_null_stg_yellow_trips_dropoff_datetime ....................... [[32mPASS[0m in 0.08s]
[0m18:12:52.411564 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: Close
[0m18:12:52.412108 [info ] [Thread-1 (]: 45 of 91 PASS not_null_stg_yellow_trips_dropoff_location_id .................... [[32mPASS[0m in 0.07s]
[0m18:12:52.412575 [info ] [Thread-4 (]: 46 of 91 PASS not_null_stg_yellow_trips_fare_amount ............................ [[32mPASS[0m in 0.07s]
[0m18:12:52.412972 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m18:12:52.413640 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m18:12:52.414193 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m18:12:52.415175 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m18:12:52.415876 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m18:12:52.416435 [info ] [Thread-3 (]: 47 of 91 PASS not_null_stg_yellow_trips_pickup_datetime ........................ [[32mPASS[0m in 0.07s]
[0m18:12:52.416825 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m18:12:52.417324 [info ] [Thread-2 (]: 48 of 91 START test not_null_stg_yellow_trips_pickup_location_id ............... [RUN]
[0m18:12:52.417775 [info ] [Thread-1 (]: 49 of 91 START test not_null_stg_yellow_trips_total_amount ..................... [RUN]
[0m18:12:52.418369 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m18:12:52.418826 [info ] [Thread-4 (]: 50 of 91 START test not_null_stg_yellow_trips_trip_distance_miles .............. [RUN]
[0m18:12:52.419374 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1)
[0m18:12:52.419855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6)
[0m18:12:52.420404 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m18:12:52.421004 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7)
[0m18:12:52.421487 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m18:12:52.421936 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m18:12:52.422390 [info ] [Thread-3 (]: 51 of 91 START test not_null_stg_yellow_trips_trip_id .......................... [RUN]
[0m18:12:52.422835 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m18:12:52.425838 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m18:12:52.428997 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m18:12:52.429617 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1)
[0m18:12:52.432183 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m18:12:52.433265 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m18:12:52.436152 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m18:12:52.449857 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m18:12:52.450389 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m18:12:52.450778 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m18:12:52.452970 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m18:12:52.453339 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m18:12:52.455846 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m18:12:52.458245 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m18:12:52.461410 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m18:12:52.474118 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m18:12:52.474577 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m18:12:52.474951 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m18:12:52.475329 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m18:12:52.475662 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: BEGIN
[0m18:12:52.476151 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: BEGIN
[0m18:12:52.476657 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: BEGIN
[0m18:12:52.477121 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: BEGIN
[0m18:12:52.477542 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:52.477965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:52.478382 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:52.478750 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:12:52.499187 [debug] [Thread-3 (]: SQL status: OK in 0.022 seconds
[0m18:12:52.499631 [debug] [Thread-4 (]: SQL status: OK in 0.021 seconds
[0m18:12:52.499904 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m18:12:52.500171 [debug] [Thread-2 (]: SQL status: OK in 0.021 seconds
[0m18:12:52.500424 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m18:12:52.500880 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m18:12:52.501302 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m18:12:52.501723 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m18:12:52.502111 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."stg_yellow_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m18:12:52.502600 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_distance_miles
from "dev"."main"."stg_yellow_trips"
where trip_distance_miles is null



  
  
      
    ) dbt_internal_test
[0m18:12:52.503050 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."stg_yellow_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m18:12:52.503493 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_location_id
from "dev"."main"."stg_yellow_trips"
where pickup_location_id is null



  
  
      
    ) dbt_internal_test
[0m18:12:52.504937 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:12:52.505432 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:12:52.505710 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:12:52.506794 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: ROLLBACK
[0m18:12:52.507059 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:12:52.508037 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: ROLLBACK
[0m18:12:52.509060 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: ROLLBACK
[0m18:12:52.509658 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1'
[0m18:12:52.510548 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: ROLLBACK
[0m18:12:52.511061 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7'
[0m18:12:52.511830 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6'
[0m18:12:52.512290 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: Close
[0m18:12:52.513103 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1'
[0m18:12:52.513525 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: Close
[0m18:12:52.513911 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: Close
[0m18:12:52.514556 [info ] [Thread-3 (]: 51 of 91 PASS not_null_stg_yellow_trips_trip_id ................................ [[32mPASS[0m in 0.08s]
[0m18:12:52.514852 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: Close
[0m18:12:52.515418 [info ] [Thread-4 (]: 50 of 91 PASS not_null_stg_yellow_trips_trip_distance_miles .................... [[32mPASS[0m in 0.09s]
[0m18:12:52.515856 [info ] [Thread-1 (]: 49 of 91 PASS not_null_stg_yellow_trips_total_amount ........................... [[32mPASS[0m in 0.10s]
[0m18:12:52.516265 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m18:12:52.517001 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m18:12:52.517454 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m18:12:52.518200 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m18:12:52.518891 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m18:12:52.519345 [info ] [Thread-2 (]: 48 of 91 PASS not_null_stg_yellow_trips_pickup_location_id ..................... [[32mPASS[0m in 0.10s]
[0m18:12:52.519652 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m18:12:52.520126 [info ] [Thread-3 (]: 52 of 91 START test not_null_stg_yellow_trips_vendor_id ........................ [RUN]
[0m18:12:52.520716 [info ] [Thread-4 (]: 53 of 91 START test unique_stg_yellow_trips_trip_id ............................ [RUN]
[0m18:12:52.521491 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m18:12:52.522077 [info ] [Thread-1 (]: 54 of 91 START test relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_  [RUN]
[0m18:12:52.522778 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57)
[0m18:12:52.523344 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7, now test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965)
[0m18:12:52.523975 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m18:12:52.524495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6, now test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a)
[0m18:12:52.524984 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m18:12:52.525423 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m18:12:52.525915 [info ] [Thread-2 (]: 55 of 91 START test relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_  [RUN]
[0m18:12:52.526350 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m18:12:52.529458 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m18:12:52.532375 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m18:12:52.533127 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1, now test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f)
[0m18:12:52.538421 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m18:12:52.539666 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m18:12:52.543500 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m18:12:52.556245 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m18:12:52.556771 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m18:12:52.557122 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m18:12:52.559039 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m18:12:52.559356 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m18:12:52.561251 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m18:12:52.562991 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m18:12:52.564735 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m18:12:52.574847 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m18:12:52.575314 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m18:12:52.575664 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m18:12:52.576041 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: BEGIN
[0m18:12:52.576330 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m18:12:52.576788 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: BEGIN
[0m18:12:52.577221 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: BEGIN
[0m18:12:52.577670 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:52.578111 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: BEGIN
[0m18:12:52.578648 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:12:52.579074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:52.579753 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:52.597571 [debug] [Thread-4 (]: SQL status: OK in 0.020 seconds
[0m18:12:52.598002 [debug] [Thread-2 (]: SQL status: OK in 0.019 seconds
[0m18:12:52.598351 [debug] [Thread-3 (]: SQL status: OK in 0.019 seconds
[0m18:12:52.598630 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m18:12:52.598890 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m18:12:52.599400 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m18:12:52.599914 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m18:12:52.600420 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_yellow_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:12:52.600883 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m18:12:52.601342 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select pickup_location_id as from_field
    from "dev"."main"."stg_yellow_trips"
    where pickup_location_id is not null
),

parent as (
    select location_id as to_field
    from "dev"."main"."stg_taxi_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m18:12:52.601760 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "dev"."main"."stg_yellow_trips"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m18:12:52.602406 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select dropoff_location_id as from_field
    from "dev"."main"."stg_yellow_trips"
    where dropoff_location_id is not null
),

parent as (
    select location_id as to_field
    from "dev"."main"."stg_taxi_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m18:12:52.605275 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:12:52.611030 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: ROLLBACK
[0m18:12:52.613284 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57'
[0m18:12:52.614188 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: Close
[0m18:12:52.616748 [info ] [Thread-3 (]: 52 of 91 PASS not_null_stg_yellow_trips_vendor_id .............................. [[32mPASS[0m in 0.09s]
[0m18:12:52.619904 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m18:12:52.724200 [debug] [Thread-1 (]: SQL status: OK in 0.116 seconds
[0m18:12:52.724824 [debug] [Thread-2 (]: SQL status: OK in 0.122 seconds
[0m18:12:52.726183 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: ROLLBACK
[0m18:12:52.727169 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: ROLLBACK
[0m18:12:52.727766 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a'
[0m18:12:52.728301 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f'
[0m18:12:52.728827 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: Close
[0m18:12:52.729247 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: Close
[0m18:12:52.729937 [info ] [Thread-1 (]: 54 of 91 PASS relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_  [[32mPASS[0m in 0.21s]
[0m18:12:52.730408 [info ] [Thread-2 (]: 55 of 91 PASS relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_  [[32mPASS[0m in 0.20s]
[0m18:12:52.730859 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m18:12:52.731451 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m18:12:52.780729 [debug] [Thread-4 (]: SQL status: OK in 0.178 seconds
[0m18:12:52.782415 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: ROLLBACK
[0m18:12:52.783560 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965'
[0m18:12:52.784079 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: Close
[0m18:12:52.813969 [info ] [Thread-4 (]: 53 of 91 PASS unique_stg_yellow_trips_trip_id .................................. [[32mPASS[0m in 0.29s]
[0m18:12:52.814881 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m18:12:52.816069 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m18:12:52.816767 [info ] [Thread-3 (]: 56 of 91 START sql view model main.int_trip_metrics ............................ [RUN]
[0m18:12:52.817575 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57, now model.nyc_taxi_pipeline_00.int_trip_metrics)
[0m18:12:52.818158 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m18:12:52.823540 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m18:12:52.841237 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m18:12:52.844242 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m18:12:52.863585 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m18:12:52.864231 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: BEGIN
[0m18:12:52.864750 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:52.884902 [debug] [Thread-3 (]: SQL status: OK in 0.020 seconds
[0m18:12:52.885581 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m18:12:52.886039 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */

  
  create view "dev"."main"."int_trip_metrics__dbt_tmp" as (
    /*
    Intermediate model: Trip-level enrichment with calculated metrics.
    Uses adapter-dispatched macros for cross-dialect compatibility.
*/

with trips as (
    select * from "dev"."main"."stg_yellow_trips"
),

enriched as (
    select
        trip_id,
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        payment_type_id,
        pickup_datetime,
        dropoff_datetime,
        passenger_count,
        trip_distance_miles,
        store_and_fwd_flag,

        -- calculated: duration in minutes
        
    datediff('minute', pickup_datetime, dropoff_datetime)
 as trip_duration_minutes,

        -- calculated: average speed (avoid division by zero)
        case
            when 
    datediff('minute', pickup_datetime, dropoff_datetime)
 > 0
            then round(
                trip_distance_miles / (
    datediff('minute', pickup_datetime, dropoff_datetime)
 / 60.0),
                2
            )
            else null
        end as avg_speed_mph,

        -- calculated: cost per mile
        case
            when trip_distance_miles > 0
            then round(fare_amount / trip_distance_miles, 2)
            else null
        end as cost_per_mile,

        -- calculated: tip percentage
        case
            when fare_amount > 0
            then round((tip_amount / fare_amount) * 100, 2)
            else null
        end as tip_percentage,

        -- time dimensions (using adapter-dispatched macros)
        date_trunc('day', pickup_datetime)::date as pickup_date,
        extract(hour from pickup_datetime) as pickup_hour,
        
    dayname(pickup_datetime)
 as pickup_day_of_week,
        case
            when extract(dow from pickup_datetime) in (0, 6) then true
            else false
        end as is_weekend,

        -- financials passthrough
        fare_amount,
        extra_amount,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount,
        congestion_surcharge,
        airport_fee

    from trips
)

select *
from enriched
where trip_duration_minutes between 1 and 720
  and (avg_speed_mph is null or avg_speed_mph < 100)
  );

[0m18:12:52.888193 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:12:52.890884 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m18:12:52.891369 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
alter view "dev"."main"."int_trip_metrics" rename to "int_trip_metrics__dbt_backup"
[0m18:12:52.892192 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:12:52.894220 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m18:12:52.894583 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
alter view "dev"."main"."int_trip_metrics__dbt_tmp" rename to "int_trip_metrics"
[0m18:12:52.895247 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:12:52.896172 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: COMMIT
[0m18:12:52.896636 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m18:12:52.897074 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: COMMIT
[0m18:12:52.903225 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m18:12:52.905446 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m18:12:52.905896 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
drop view if exists "dev"."main"."int_trip_metrics__dbt_backup" cascade
[0m18:12:52.908552 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:12:52.909791 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: Close
[0m18:12:52.951985 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1175b3-4e94-4b95-97e9-9c6dd8e8b5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e3ac1cebd0>]}
[0m18:12:52.952874 [info ] [Thread-3 (]: 56 of 91 OK created sql view model main.int_trip_metrics ....................... [[32mOK[0m in 0.13s]
[0m18:12:52.953530 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m18:12:52.954609 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m18:12:52.955043 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m18:12:52.955474 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m18:12:52.955803 [info ] [Thread-2 (]: 57 of 91 START test assert_trip_duration_positive .............................. [RUN]
[0m18:12:52.956180 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m18:12:52.956528 [info ] [Thread-4 (]: 58 of 91 START test dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0  [RUN]
[0m18:12:52.957103 [info ] [Thread-1 (]: 59 of 91 START test dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1  [RUN]
[0m18:12:52.957720 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f, now test.nyc_taxi_pipeline_00.assert_trip_duration_positive)
[0m18:12:52.958233 [info ] [Thread-3 (]: 60 of 91 START test not_null_int_trip_metrics_is_weekend ....................... [RUN]
[0m18:12:52.958844 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574)
[0m18:12:52.959350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718)
[0m18:12:52.959810 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m18:12:52.960270 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_trip_metrics, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed)
[0m18:12:52.961017 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m18:12:52.961489 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m18:12:52.963604 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m18:12:52.964199 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m18:12:52.969837 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m18:12:52.972866 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m18:12:52.976972 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m18:12:52.987995 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m18:12:52.988420 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m18:12:52.988821 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m18:12:52.992636 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m18:12:52.993106 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m18:12:53.062302 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m18:12:53.063831 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m18:12:53.065702 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m18:12:53.076957 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m18:12:53.077519 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m18:12:53.077956 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m18:12:53.078312 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m18:12:53.078610 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: BEGIN
[0m18:12:53.079205 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: BEGIN
[0m18:12:53.079808 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: BEGIN
[0m18:12:53.080329 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: BEGIN
[0m18:12:53.080884 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:53.081415 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:53.081911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:53.082403 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:12:53.104289 [debug] [Thread-3 (]: SQL status: OK in 0.023 seconds
[0m18:12:53.104722 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m18:12:53.105011 [debug] [Thread-4 (]: SQL status: OK in 0.024 seconds
[0m18:12:53.105272 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m18:12:53.105578 [debug] [Thread-2 (]: SQL status: OK in 0.023 seconds
[0m18:12:53.106099 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m18:12:53.106599 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m18:12:53.107050 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."int_trip_metrics"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m18:12:53.107474 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m18:12:53.107904 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_trip_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not trip_duration_minutes >= 1
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not trip_duration_minutes <= 720
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m18:12:53.108439 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_trip_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m18:12:53.109354 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
    Singular test: No trip should have negative duration.
*/

select
    trip_id,
    pickup_datetime,
    dropoff_datetime,
    trip_duration_minutes
from "dev"."main"."int_trip_metrics"
where trip_duration_minutes < 0
  
  
      
    ) dbt_internal_test
[0m18:12:53.111404 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:12:53.111971 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:12:53.113474 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: ROLLBACK
[0m18:12:53.114991 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: ROLLBACK
[0m18:12:53.116526 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed'
[0m18:12:53.119326 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.assert_trip_duration_positive'
[0m18:12:53.121587 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: Close
[0m18:12:53.123705 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: Close
[0m18:12:53.126911 [info ] [Thread-3 (]: 60 of 91 PASS not_null_int_trip_metrics_is_weekend ............................. [[32mPASS[0m in 0.17s]
[0m18:12:53.128952 [info ] [Thread-2 (]: 57 of 91 PASS assert_trip_duration_positive .................................... [[32mPASS[0m in 0.17s]
[0m18:12:53.131166 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m18:12:53.132202 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m18:12:53.135341 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m18:12:53.138087 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m18:12:53.140381 [info ] [Thread-3 (]: 61 of 91 START test not_null_int_trip_metrics_pickup_date ...................... [RUN]
[0m18:12:53.141582 [info ] [Thread-2 (]: 62 of 91 START test not_null_int_trip_metrics_pickup_hour ...................... [RUN]
[0m18:12:53.143807 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3)
[0m18:12:53.146462 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.assert_trip_duration_positive, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082)
[0m18:12:53.148510 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m18:12:53.150764 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m18:12:53.155963 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m18:12:53.160687 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m18:12:53.171088 [debug] [Thread-4 (]: SQL status: OK in 0.061 seconds
[0m18:12:53.173227 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: ROLLBACK
[0m18:12:53.173637 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m18:12:53.174460 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574'
[0m18:12:53.175784 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: ROLLBACK
[0m18:12:53.176149 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: Close
[0m18:12:53.177168 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718'
[0m18:12:53.178460 [info ] [Thread-4 (]: 58 of 91 PASS dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0 ..... [[32mPASS[0m in 0.22s]
[0m18:12:53.178861 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: Close
[0m18:12:53.179735 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m18:12:53.180836 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m18:12:53.181407 [info ] [Thread-4 (]: 63 of 91 START test not_null_int_trip_metrics_trip_duration_minutes ............ [RUN]
[0m18:12:53.182097 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c)
[0m18:12:53.182729 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m18:12:53.186527 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m18:12:53.187099 [info ] [Thread-1 (]: 59 of 91 PASS dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1  [[32mPASS[0m in 0.23s]
[0m18:12:53.187834 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m18:12:53.188284 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m18:12:53.188767 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m18:12:53.189137 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m18:12:53.189516 [info ] [Thread-1 (]: 64 of 91 START test not_null_int_trip_metrics_trip_id .......................... [RUN]
[0m18:12:53.191520 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m18:12:53.193689 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m18:12:53.194409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f)
[0m18:12:53.195574 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m18:12:53.198736 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m18:12:53.199899 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m18:12:53.202896 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m18:12:53.210108 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m18:12:53.210625 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m18:12:53.211014 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m18:12:53.213164 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m18:12:53.213945 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: BEGIN
[0m18:12:53.214564 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: BEGIN
[0m18:12:53.215348 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m18:12:53.215672 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:12:53.216133 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:53.216623 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: BEGIN
[0m18:12:53.217568 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:53.228515 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m18:12:53.229195 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: BEGIN
[0m18:12:53.229651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:53.238133 [debug] [Thread-2 (]: SQL status: OK in 0.022 seconds
[0m18:12:53.238561 [debug] [Thread-3 (]: SQL status: OK in 0.022 seconds
[0m18:12:53.239069 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:12:53.239340 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m18:12:53.239596 [debug] [Thread-4 (]: SQL status: OK in 0.022 seconds
[0m18:12:53.240070 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m18:12:53.240491 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m18:12:53.240868 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."int_trip_metrics"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m18:12:53.241244 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m18:12:53.241628 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_trip_metrics"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m18:12:53.242090 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."int_trip_metrics"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m18:12:53.242895 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_duration_minutes
from "dev"."main"."int_trip_metrics"
where trip_duration_minutes is null



  
  
      
    ) dbt_internal_test
[0m18:12:53.244212 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:12:53.245237 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:12:53.246809 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: ROLLBACK
[0m18:12:53.248230 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: ROLLBACK
[0m18:12:53.248765 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:12:53.251374 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082'
[0m18:12:53.253138 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3'
[0m18:12:53.256245 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: ROLLBACK
[0m18:12:53.256841 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: Close
[0m18:12:53.258741 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: Close
[0m18:12:53.261328 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f'
[0m18:12:53.263325 [info ] [Thread-2 (]: 62 of 91 PASS not_null_int_trip_metrics_pickup_hour ............................ [[32mPASS[0m in 0.12s]
[0m18:12:53.264507 [info ] [Thread-3 (]: 61 of 91 PASS not_null_int_trip_metrics_pickup_date ............................ [[32mPASS[0m in 0.12s]
[0m18:12:53.266351 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: Close
[0m18:12:53.268591 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m18:12:53.270886 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m18:12:53.273022 [info ] [Thread-1 (]: 64 of 91 PASS not_null_int_trip_metrics_trip_id ................................ [[32mPASS[0m in 0.08s]
[0m18:12:53.278908 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m18:12:53.303608 [debug] [Thread-4 (]: SQL status: OK in 0.059 seconds
[0m18:12:53.305234 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: ROLLBACK
[0m18:12:53.306079 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c'
[0m18:12:53.306503 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: Close
[0m18:12:53.311548 [info ] [Thread-4 (]: 63 of 91 PASS not_null_int_trip_metrics_trip_duration_minutes .................. [[32mPASS[0m in 0.13s]
[0m18:12:53.312223 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m18:12:53.313104 [debug] [Thread-2 (]: Began running node model.nyc_taxi_pipeline_00.int_daily_summary
[0m18:12:53.313389 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m18:12:53.313807 [info ] [Thread-2 (]: 65 of 91 START sql view model main.int_daily_summary ........................... [RUN]
[0m18:12:53.314169 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.fct_trips
[0m18:12:53.314611 [info ] [Thread-3 (]: 66 of 91 START sql view model main.int_hourly_patterns ......................... [RUN]
[0m18:12:53.315282 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082, now model.nyc_taxi_pipeline_00.int_daily_summary)
[0m18:12:53.315888 [info ] [Thread-1 (]: 67 of 91 START sql incremental model main.fct_trips ............................ [RUN]
[0m18:12:53.316563 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3, now model.nyc_taxi_pipeline_00.int_hourly_patterns)
[0m18:12:53.317159 [debug] [Thread-2 (]: Began compiling node model.nyc_taxi_pipeline_00.int_daily_summary
[0m18:12:53.317625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f, now model.nyc_taxi_pipeline_00.fct_trips)
[0m18:12:53.318019 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m18:12:53.320220 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m18:12:53.320752 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.fct_trips
[0m18:12:53.322856 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m18:12:53.328322 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.fct_trips"
[0m18:12:53.341569 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m18:12:53.341996 [debug] [Thread-2 (]: Began executing node model.nyc_taxi_pipeline_00.int_daily_summary
[0m18:12:53.344435 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m18:12:53.344830 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.fct_trips
[0m18:12:53.347983 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m18:12:53.371221 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m18:12:53.371742 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
DESCRIBE (select * from (
        /*
    Fact table: Fully enriched trip records with location names.
    Incremental with delete+insert strategy.
*/



with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

pickup_locations as (
    select * from "dev"."main"."dim_locations"
),

dropoff_locations as (
    select * from "dev"."main"."dim_locations"
),

final as (
    select
        t.trip_id,
        t.vendor_id,
        t.rate_code_id,
        t.payment_type_id,
        t.pickup_location_id,
        t.dropoff_location_id,
        t.pickup_datetime,
        t.dropoff_datetime,
        t.pickup_date,
        t.pickup_hour,
        t.pickup_day_of_week,
        t.is_weekend,
        t.passenger_count,
        t.trip_distance_miles,
        t.trip_duration_minutes,
        t.avg_speed_mph,
        t.cost_per_mile,
        t.fare_amount,
        t.extra_amount,
        t.mta_tax,
        t.tip_amount,
        t.tip_percentage,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.congestion_surcharge,
        t.airport_fee,

        -- enriched from dimensions
        pu.borough as pickup_borough,
        pu.zone_name as pickup_zone,
        do_loc.borough as dropoff_borough,
        do_loc.zone_name as dropoff_zone

    from trip_metrics t
    left join pickup_locations pu
        on t.pickup_location_id = pu.location_id
    left join dropoff_locations do_loc
        on t.dropoff_location_id = do_loc.location_id

    
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:12:53.372257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:53.373030 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m18:12:53.373458 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: BEGIN
[0m18:12:53.373828 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:53.383306 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m18:12:53.383922 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: BEGIN
[0m18:12:53.384477 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:12:53.393454 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m18:12:53.393903 [debug] [Thread-3 (]: SQL status: OK in 0.020 seconds
[0m18:12:53.394337 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m18:12:53.394858 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m18:12:53.395154 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m18:12:53.395666 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */

  
  create view "dev"."main"."int_daily_summary__dbt_tmp" as (
    /*
    Intermediate model: Daily aggregated trip and revenue metrics.
    One row per day with counts, averages, and revenue totals.
*/

with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

daily_agg as (
    select
        pickup_date,
        pickup_day_of_week,
        is_weekend,

        count(*) as total_trips,
        sum(passenger_count) as total_passengers,

        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(avg(avg_speed_mph), 2) as avg_speed_mph,

        round(sum(fare_amount), 2) as total_fare_revenue,
        round(sum(tip_amount), 2) as total_tip_revenue,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_trip_revenue,
        round(avg(tip_percentage), 2) as avg_tip_percentage,

        count(case when payment_type_id = 1 then 1 end) as credit_card_trips,
        count(case when payment_type_id = 2 then 1 end) as cash_trips

    from trip_metrics
    group by pickup_date, pickup_day_of_week, is_weekend
)

select * from daily_agg
  );

[0m18:12:53.397951 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m18:12:53.398288 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */

  
  create view "dev"."main"."int_hourly_patterns__dbt_tmp" as (
    /*
    Intermediate model: Hourly trip patterns by date.
    One row per date + hour combination.
*/

with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

hourly_agg as (
    select
        pickup_date,
        pickup_hour,
        pickup_day_of_week,
        is_weekend,

        count(*) as total_trips,
        round(avg(trip_distance_miles), 2) as avg_distance,
        round(avg(trip_duration_minutes), 2) as avg_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue

    from trip_metrics
    group by pickup_date, pickup_hour, pickup_day_of_week, is_weekend
)

select * from hourly_agg
  );

[0m18:12:53.399530 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as varchar)
 as trip_id, 
      
    cast(null as integer)
 as vendor_id, 
      
    cast(null as integer)
 as rate_code_id, 
      
    cast(null as integer)
 as payment_type_id, 
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as integer)
 as dropoff_location_id, 
      
    cast(null as timestamp)
 as pickup_datetime, 
      
    cast(null as timestamp)
 as dropoff_datetime, 
      
    cast(null as date)
 as pickup_date, 
      
    cast(null as bigint)
 as pickup_hour, 
      
    cast(null as varchar)
 as pickup_day_of_week, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as integer)
 as passenger_count, 
      
    cast(null as double)
 as trip_distance_miles, 
      
    cast(null as bigint)
 as trip_duration_minutes, 
      
    cast(null as double)
 as avg_speed_mph, 
      
    cast(null as double)
 as cost_per_mile, 
      
    cast(null as decimal(10,2))
 as fare_amount, 
      
    cast(null as decimal(10,2))
 as extra_amount, 
      
    cast(null as decimal(10,2))
 as mta_tax, 
      
    cast(null as decimal(10,2))
 as tip_amount, 
      
    cast(null as double)
 as tip_percentage, 
      
    cast(null as decimal(10,2))
 as tolls_amount, 
      
    cast(null as decimal(10,2))
 as improvement_surcharge, 
      
    cast(null as decimal(10,2))
 as total_amount, 
      
    cast(null as decimal(10,2))
 as congestion_surcharge, 
      
    cast(null as decimal(10,2))
 as airport_fee, 
      
    cast(null as varchar)
 as pickup_borough, 
      
    cast(null as varchar)
 as pickup_zone, 
      
    cast(null as varchar)
 as dropoff_borough, 
      
    cast(null as varchar)
 as dropoff_zone
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:12:53.400767 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:12:53.401112 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:12:53.403808 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m18:12:53.404116 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m18:12:53.407447 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.fct_trips"
[0m18:12:53.407781 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
alter view "dev"."main"."int_daily_summary" rename to "int_daily_summary__dbt_backup"
[0m18:12:53.410299 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m18:12:53.411526 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
alter view "dev"."main"."int_hourly_patterns" rename to "int_hourly_patterns__dbt_backup"
[0m18:12:53.411983 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:12:53.412547 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:12:53.414572 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m18:12:53.416544 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m18:12:53.417000 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
alter view "dev"."main"."int_daily_summary__dbt_tmp" rename to "int_daily_summary"
[0m18:12:53.417507 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
alter view "dev"."main"."int_hourly_patterns__dbt_tmp" rename to "int_hourly_patterns"
[0m18:12:53.418806 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:12:53.419110 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:12:53.420085 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: COMMIT
[0m18:12:53.421218 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: COMMIT
[0m18:12:53.421755 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m18:12:53.422424 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m18:12:53.422935 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: COMMIT
[0m18:12:53.423532 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: COMMIT
[0m18:12:53.430931 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m18:12:53.431490 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m18:12:53.431921 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.fct_trips: BEGIN
[0m18:12:53.434624 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m18:12:53.435678 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
drop view if exists "dev"."main"."int_hourly_patterns__dbt_backup" cascade
[0m18:12:53.436304 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:12:53.436788 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m18:12:53.437667 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m18:12:53.440422 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m18:12:53.441052 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m18:12:53.441631 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */

  
    
    
      
    

    create  table
      "dev"."main"."fct_trips__dbt_tmp"
  
  (
    trip_id varchar,
    vendor_id integer,
    rate_code_id integer,
    payment_type_id integer,
    pickup_location_id integer,
    dropoff_location_id integer,
    pickup_datetime timestamp,
    dropoff_datetime timestamp,
    pickup_date date,
    pickup_hour bigint,
    pickup_day_of_week varchar,
    is_weekend boolean,
    passenger_count integer,
    trip_distance_miles double,
    trip_duration_minutes bigint,
    avg_speed_mph double,
    cost_per_mile double,
    fare_amount decimal(10,2),
    extra_amount decimal(10,2),
    mta_tax decimal(10,2),
    tip_amount decimal(10,2),
    tip_percentage double,
    tolls_amount decimal(10,2),
    improvement_surcharge decimal(10,2),
    total_amount decimal(10,2),
    congestion_surcharge decimal(10,2),
    airport_fee decimal(10,2),
    pickup_borough varchar,
    pickup_zone varchar,
    dropoff_borough varchar,
    dropoff_zone varchar
    
    )
 ;
    insert into "dev"."main"."fct_trips__dbt_tmp" 
  (
    
      
      trip_id ,
    
      
      vendor_id ,
    
      
      rate_code_id ,
    
      
      payment_type_id ,
    
      
      pickup_location_id ,
    
      
      dropoff_location_id ,
    
      
      pickup_datetime ,
    
      
      dropoff_datetime ,
    
      
      pickup_date ,
    
      
      pickup_hour ,
    
      
      pickup_day_of_week ,
    
      
      is_weekend ,
    
      
      passenger_count ,
    
      
      trip_distance_miles ,
    
      
      trip_duration_minutes ,
    
      
      avg_speed_mph ,
    
      
      cost_per_mile ,
    
      
      fare_amount ,
    
      
      extra_amount ,
    
      
      mta_tax ,
    
      
      tip_amount ,
    
      
      tip_percentage ,
    
      
      tolls_amount ,
    
      
      improvement_surcharge ,
    
      
      total_amount ,
    
      
      congestion_surcharge ,
    
      
      airport_fee ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      dropoff_borough ,
    
      
      dropoff_zone 
    
  )
 (
      
    select trip_id, vendor_id, rate_code_id, payment_type_id, pickup_location_id, dropoff_location_id, pickup_datetime, dropoff_datetime, pickup_date, pickup_hour, pickup_day_of_week, is_weekend, passenger_count, trip_distance_miles, trip_duration_minutes, avg_speed_mph, cost_per_mile, fare_amount, extra_amount, mta_tax, tip_amount, tip_percentage, tolls_amount, improvement_surcharge, total_amount, congestion_surcharge, airport_fee, pickup_borough, pickup_zone, dropoff_borough, dropoff_zone
    from (
        /*
    Fact table: Fully enriched trip records with location names.
    Incremental with delete+insert strategy.
*/



with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

pickup_locations as (
    select * from "dev"."main"."dim_locations"
),

dropoff_locations as (
    select * from "dev"."main"."dim_locations"
),

final as (
    select
        t.trip_id,
        t.vendor_id,
        t.rate_code_id,
        t.payment_type_id,
        t.pickup_location_id,
        t.dropoff_location_id,
        t.pickup_datetime,
        t.dropoff_datetime,
        t.pickup_date,
        t.pickup_hour,
        t.pickup_day_of_week,
        t.is_weekend,
        t.passenger_count,
        t.trip_distance_miles,
        t.trip_duration_minutes,
        t.avg_speed_mph,
        t.cost_per_mile,
        t.fare_amount,
        t.extra_amount,
        t.mta_tax,
        t.tip_amount,
        t.tip_percentage,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.congestion_surcharge,
        t.airport_fee,

        -- enriched from dimensions
        pu.borough as pickup_borough,
        pu.zone_name as pickup_zone,
        do_loc.borough as dropoff_borough,
        do_loc.zone_name as dropoff_zone

    from trip_metrics t
    left join pickup_locations pu
        on t.pickup_location_id = pu.location_id
    left join dropoff_locations do_loc
        on t.dropoff_location_id = do_loc.location_id

    
)

select * from final
    ) as model_subq
    );
  
  
  
[0m18:12:53.442370 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
drop view if exists "dev"."main"."int_daily_summary__dbt_backup" cascade
[0m18:12:53.443882 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: Close
[0m18:12:53.446245 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1175b3-4e94-4b95-97e9-9c6dd8e8b5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e3c1756720>]}
[0m18:12:53.447243 [info ] [Thread-3 (]: 66 of 91 OK created sql view model main.int_hourly_patterns .................... [[32mOK[0m in 0.13s]
[0m18:12:53.448106 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m18:12:53.448564 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:12:53.449587 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m18:12:53.451051 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: Close
[0m18:12:53.451314 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m18:12:53.451849 [info ] [Thread-4 (]: 68 of 91 START test dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0  [RUN]
[0m18:12:53.455208 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1175b3-4e94-4b95-97e9-9c6dd8e8b5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e3ac1abe30>]}
[0m18:12:53.457453 [info ] [Thread-3 (]: 69 of 91 START test not_null_int_hourly_patterns_pickup_date ................... [RUN]
[0m18:12:53.460430 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe)
[0m18:12:53.463042 [info ] [Thread-2 (]: 65 of 91 OK created sql view model main.int_daily_summary ...................... [[32mOK[0m in 0.14s]
[0m18:12:53.465115 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_hourly_patterns, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2)
[0m18:12:53.469353 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m18:12:53.471885 [debug] [Thread-2 (]: Finished running node model.nyc_taxi_pipeline_00.int_daily_summary
[0m18:12:53.474496 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m18:12:53.480801 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m18:12:53.483343 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m18:12:53.487664 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m18:12:53.491850 [info ] [Thread-2 (]: 70 of 91 START test not_null_int_hourly_patterns_pickup_hour ................... [RUN]
[0m18:12:53.495501 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_daily_summary, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d)
[0m18:12:53.498257 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m18:12:53.504157 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m18:12:53.534392 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m18:12:53.536894 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m18:12:53.541802 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m18:12:53.546686 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m18:12:53.554311 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m18:12:53.558717 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m18:12:53.578962 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m18:12:53.580820 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: BEGIN
[0m18:12:53.582911 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m18:12:53.583422 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:12:53.586302 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: BEGIN
[0m18:12:53.590854 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m18:12:53.593073 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:53.594766 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m18:12:53.597569 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m18:12:53.600399 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m18:12:53.599922 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m18:12:53.598173 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."int_hourly_patterns"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m18:12:53.601067 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_hourly_patterns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m18:12:53.603703 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: BEGIN
[0m18:12:53.611917 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:12:53.616186 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:53.623824 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: ROLLBACK
[0m18:12:53.627417 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m18:12:53.629153 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d'
[0m18:12:53.629546 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m18:12:53.630734 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: Close
[0m18:12:53.633441 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_hourly_patterns"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m18:12:53.634783 [info ] [Thread-2 (]: 70 of 91 PASS not_null_int_hourly_patterns_pickup_hour ......................... [[32mPASS[0m in 0.14s]
[0m18:12:53.637225 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:12:53.638033 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m18:12:53.640461 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: ROLLBACK
[0m18:12:53.641847 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m18:12:53.648575 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2'
[0m18:12:53.649780 [info ] [Thread-2 (]: 71 of 91 START test not_null_int_hourly_patterns_total_trips ................... [RUN]
[0m18:12:53.652653 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: Close
[0m18:12:53.655093 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf)
[0m18:12:53.661009 [info ] [Thread-3 (]: 69 of 91 PASS not_null_int_hourly_patterns_pickup_date ......................... [[32mPASS[0m in 0.20s]
[0m18:12:53.665570 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m18:12:53.668689 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m18:12:53.676855 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m18:12:53.674799 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m18:12:53.677682 [info ] [Thread-3 (]: 72 of 91 START test dbt_utils_accepted_range_int_daily_summary_total_trips__0 .. [RUN]
[0m18:12:53.679936 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863)
[0m18:12:53.681118 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m18:12:53.690452 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m18:12:53.725239 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m18:12:53.729025 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m18:12:53.739426 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m18:12:53.743340 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m18:12:53.774617 [debug] [Thread-4 (]: SQL status: OK in 0.162 seconds
[0m18:12:53.777580 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m18:12:53.784813 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: ROLLBACK
[0m18:12:53.785292 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: BEGIN
[0m18:12:53.789192 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe'
[0m18:12:53.791940 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: Close
[0m18:12:53.791478 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m18:12:53.790090 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:53.793183 [info ] [Thread-4 (]: 68 of 91 PASS dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0 .. [[32mPASS[0m in 0.33s]
[0m18:12:53.796179 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m18:12:53.795709 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m18:12:53.793885 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: BEGIN
[0m18:12:53.798234 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m18:12:53.804924 [info ] [Thread-4 (]: 73 of 91 START test not_null_int_daily_summary_pickup_date ..................... [RUN]
[0m18:12:53.803861 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:12:53.800415 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m18:12:53.806398 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686)
[0m18:12:53.811341 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m18:12:53.810208 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_daily_summary"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_trips >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m18:12:53.808863 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m18:12:53.821338 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m18:12:53.819235 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m18:12:53.823282 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_trips
from "dev"."main"."int_hourly_patterns"
where total_trips is null



  
  
      
    ) dbt_internal_test
[0m18:12:53.894016 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m18:12:53.898616 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m18:12:53.925691 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m18:12:53.926663 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: BEGIN
[0m18:12:53.927433 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:53.928623 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:12:53.929404 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m18:12:53.930057 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_daily_summary"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m18:12:53.933469 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:12:53.935208 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: ROLLBACK
[0m18:12:53.936140 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686'
[0m18:12:53.936652 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: Close
[0m18:12:53.937425 [info ] [Thread-4 (]: 73 of 91 PASS not_null_int_daily_summary_pickup_date ........................... [[32mPASS[0m in 0.13s]
[0m18:12:53.938102 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m18:12:53.938628 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m18:12:53.939143 [info ] [Thread-4 (]: 74 of 91 START test not_null_int_daily_summary_total_revenue ................... [RUN]
[0m18:12:53.939790 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50)
[0m18:12:53.940420 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m18:12:53.945399 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m18:12:53.963925 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m18:12:53.966514 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m18:12:53.985622 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m18:12:53.986293 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: BEGIN
[0m18:12:53.986908 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:53.987797 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:12:53.988326 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m18:12:53.988993 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "dev"."main"."int_daily_summary"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m18:12:54.032407 [debug] [Thread-3 (]: SQL status: OK in 0.212 seconds
[0m18:12:54.033991 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: ROLLBACK
[0m18:12:54.035197 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863'
[0m18:12:54.035649 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: Close
[0m18:12:54.036428 [info ] [Thread-3 (]: 72 of 91 PASS dbt_utils_accepted_range_int_daily_summary_total_trips__0 ........ [[32mPASS[0m in 0.36s]
[0m18:12:54.037088 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m18:12:54.037616 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m18:12:54.038187 [info ] [Thread-3 (]: 75 of 91 START test not_null_int_daily_summary_total_trips ..................... [RUN]
[0m18:12:54.039304 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10)
[0m18:12:54.039943 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m18:12:54.044334 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m18:12:54.063629 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m18:12:54.065663 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m18:12:54.085473 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m18:12:54.086223 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: BEGIN
[0m18:12:54.086903 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:54.087701 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:12:54.088414 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m18:12:54.088970 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_trips
from "dev"."main"."int_daily_summary"
where total_trips is null



  
  
      
    ) dbt_internal_test
[0m18:12:54.195186 [debug] [Thread-4 (]: SQL status: OK in 0.206 seconds
[0m18:12:54.197091 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: ROLLBACK
[0m18:12:54.197976 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50'
[0m18:12:54.198464 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: Close
[0m18:12:54.199232 [info ] [Thread-4 (]: 74 of 91 PASS not_null_int_daily_summary_total_revenue ......................... [[32mPASS[0m in 0.26s]
[0m18:12:54.199832 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m18:12:54.200276 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m18:12:54.200864 [info ] [Thread-4 (]: 76 of 91 START test unique_int_daily_summary_pickup_date ....................... [RUN]
[0m18:12:54.201836 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50, now test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e)
[0m18:12:54.202457 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m18:12:54.206999 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m18:12:54.208115 [debug] [Thread-2 (]: SQL status: OK in 0.377 seconds
[0m18:12:54.209708 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: ROLLBACK
[0m18:12:54.210492 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf'
[0m18:12:54.210920 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: Close
[0m18:12:54.211551 [info ] [Thread-2 (]: 71 of 91 PASS not_null_int_hourly_patterns_total_trips ......................... [[32mPASS[0m in 0.56s]
[0m18:12:54.212174 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m18:12:54.213020 [debug] [Thread-2 (]: Began running node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m18:12:54.213604 [info ] [Thread-2 (]: 77 of 91 START sql table model main.mart_hourly_demand ......................... [RUN]
[0m18:12:54.214213 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf, now model.nyc_taxi_pipeline_00.mart_hourly_demand)
[0m18:12:54.214675 [debug] [Thread-2 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m18:12:54.217819 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m18:12:54.224576 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m18:12:54.226954 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m18:12:54.231997 [debug] [Thread-2 (]: Began executing node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m18:12:54.236554 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m18:12:54.237387 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Hourly demand patterns.
*/

with hourly as (
    select * from "dev"."main"."int_hourly_patterns"
),

final as (
    select
        pickup_hour,
        is_weekend,

        count(*) as days_observed,
        round(avg(total_trips), 0) as avg_trips_per_period,
        round(avg(avg_distance), 2) as avg_distance,
        round(avg(avg_duration_min), 2) as avg_duration_min,
        round(avg(total_revenue), 2) as avg_revenue_per_period,
        sum(total_trips) as total_trips_all_days

    from hourly
    group by pickup_hour, is_weekend
)

select * from final
order by is_weekend, pickup_hour
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:12:54.238004 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:12:54.241064 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:12:54.243496 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m18:12:54.244153 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as bigint)
 as pickup_hour, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as bigint)
 as days_observed, 
      
    cast(null as double)
 as avg_trips_per_period, 
      
    cast(null as double)
 as avg_distance, 
      
    cast(null as double)
 as avg_duration_min, 
      
    cast(null as double)
 as avg_revenue_per_period, 
      
    cast(null as hugeint)
 as total_trips_all_days
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:12:54.245182 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m18:12:54.245605 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:12:54.245981 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: BEGIN
[0m18:12:54.247730 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m18:12:54.248222 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:54.249434 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:12:54.249880 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m18:12:54.250325 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pickup_date as unique_field,
    count(*) as n_records

from "dev"."main"."int_daily_summary"
where pickup_date is not null
group by pickup_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:12:54.267958 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m18:12:54.268485 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: BEGIN
[0m18:12:54.269442 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:12:54.269901 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m18:12:54.270508 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_hourly_demand__dbt_tmp"
  
  (
    pickup_hour bigint,
    is_weekend boolean,
    days_observed bigint,
    avg_trips_per_period double,
    avg_distance double,
    avg_duration_min double,
    avg_revenue_per_period double,
    total_trips_all_days hugeint
    
    )
 ;
    insert into "dev"."main"."mart_hourly_demand__dbt_tmp" 
  (
    
      
      pickup_hour ,
    
      
      is_weekend ,
    
      
      days_observed ,
    
      
      avg_trips_per_period ,
    
      
      avg_distance ,
    
      
      avg_duration_min ,
    
      
      avg_revenue_per_period ,
    
      
      total_trips_all_days 
    
  )
 (
      
    select pickup_hour, is_weekend, days_observed, avg_trips_per_period, avg_distance, avg_duration_min, avg_revenue_per_period, total_trips_all_days
    from (
        /*
    Analytics mart: Hourly demand patterns.
*/

with hourly as (
    select * from "dev"."main"."int_hourly_patterns"
),

final as (
    select
        pickup_hour,
        is_weekend,

        count(*) as days_observed,
        round(avg(total_trips), 0) as avg_trips_per_period,
        round(avg(avg_distance), 2) as avg_distance,
        round(avg(avg_duration_min), 2) as avg_duration_min,
        round(avg(total_revenue), 2) as avg_revenue_per_period,
        sum(total_trips) as total_trips_all_days

    from hourly
    group by pickup_hour, is_weekend
)

select * from final
order by is_weekend, pickup_hour
    ) as model_subq
    );
  
  
[0m18:12:54.280932 [debug] [Thread-3 (]: SQL status: OK in 0.191 seconds
[0m18:12:54.282839 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: ROLLBACK
[0m18:12:54.283718 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10'
[0m18:12:54.284191 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: Close
[0m18:12:54.285006 [info ] [Thread-3 (]: 75 of 91 PASS not_null_int_daily_summary_total_trips ........................... [[32mPASS[0m in 0.25s]
[0m18:12:54.285788 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m18:12:54.396961 [debug] [Thread-4 (]: SQL status: OK in 0.146 seconds
[0m18:12:54.398649 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: ROLLBACK
[0m18:12:54.399571 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e'
[0m18:12:54.399995 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: Close
[0m18:12:54.400651 [info ] [Thread-4 (]: 76 of 91 PASS unique_int_daily_summary_pickup_date ............................. [[32mPASS[0m in 0.20s]
[0m18:12:54.401406 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m18:12:54.402222 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m18:12:54.402952 [info ] [Thread-3 (]: 78 of 91 START sql table model main.mart_daily_revenue ......................... [RUN]
[0m18:12:54.403627 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10, now model.nyc_taxi_pipeline_00.mart_daily_revenue)
[0m18:12:54.404227 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m18:12:54.407659 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m18:12:54.426558 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m18:12:54.430596 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m18:12:54.431588 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Daily revenue metrics with running totals.
*/

with daily as (
    select * from "dev"."main"."int_daily_summary"
),

dates as (
    select * from "dev"."main"."dim_dates"
),

final as (
    select
        d.date_key,
        d.day_of_week_name,
        d.is_weekend,
        d.is_holiday,
        d.week_of_year,

        daily.total_trips,
        daily.total_passengers,
        daily.total_fare_revenue,
        daily.total_tip_revenue,
        daily.total_revenue,
        daily.avg_trip_revenue,
        daily.avg_tip_percentage,
        daily.credit_card_trips,
        daily.cash_trips,
        daily.avg_trip_distance,
        daily.avg_trip_duration_min,

        -- running total
        sum(daily.total_revenue) over (order by d.date_key) as cumulative_revenue,

        -- day-over-day change
        daily.total_revenue - lag(daily.total_revenue) over (order by d.date_key) as revenue_change_vs_prior_day

    from daily
    inner join dates d
        on daily.pickup_date = d.date_key
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:12:54.432444 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:54.435214 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:12:54.439993 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m18:12:54.440791 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as date_key, 
      
    cast(null as varchar)
 as day_of_week_name, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as boolean)
 as is_holiday, 
      
    cast(null as bigint)
 as week_of_year, 
      
    cast(null as bigint)
 as total_trips, 
      
    cast(null as hugeint)
 as total_passengers, 
      
    cast(null as decimal(38,2))
 as total_fare_revenue, 
      
    cast(null as decimal(38,2))
 as total_tip_revenue, 
      
    cast(null as decimal(38,2))
 as total_revenue, 
      
    cast(null as double)
 as avg_trip_revenue, 
      
    cast(null as double)
 as avg_tip_percentage, 
      
    cast(null as bigint)
 as credit_card_trips, 
      
    cast(null as bigint)
 as cash_trips, 
      
    cast(null as double)
 as avg_trip_distance, 
      
    cast(null as double)
 as avg_trip_duration_min, 
      
    cast(null as decimal(38,2))
 as cumulative_revenue, 
      
    cast(null as decimal(38,2))
 as revenue_change_vs_prior_day
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:12:54.442154 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:12:54.445142 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m18:12:54.466860 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m18:12:54.467502 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: BEGIN
[0m18:12:54.468324 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:12:54.468880 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m18:12:54.469486 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_daily_revenue__dbt_tmp"
  
  (
    date_key date,
    day_of_week_name varchar,
    is_weekend boolean,
    is_holiday boolean,
    week_of_year bigint,
    total_trips bigint,
    total_passengers hugeint,
    total_fare_revenue decimal(38,2),
    total_tip_revenue decimal(38,2),
    total_revenue decimal(38,2),
    avg_trip_revenue double,
    avg_tip_percentage double,
    credit_card_trips bigint,
    cash_trips bigint,
    avg_trip_distance double,
    avg_trip_duration_min double,
    cumulative_revenue decimal(38,2),
    revenue_change_vs_prior_day decimal(38,2)
    
    )
 ;
    insert into "dev"."main"."mart_daily_revenue__dbt_tmp" 
  (
    
      
      date_key ,
    
      
      day_of_week_name ,
    
      
      is_weekend ,
    
      
      is_holiday ,
    
      
      week_of_year ,
    
      
      total_trips ,
    
      
      total_passengers ,
    
      
      total_fare_revenue ,
    
      
      total_tip_revenue ,
    
      
      total_revenue ,
    
      
      avg_trip_revenue ,
    
      
      avg_tip_percentage ,
    
      
      credit_card_trips ,
    
      
      cash_trips ,
    
      
      avg_trip_distance ,
    
      
      avg_trip_duration_min ,
    
      
      cumulative_revenue ,
    
      
      revenue_change_vs_prior_day 
    
  )
 (
      
    select date_key, day_of_week_name, is_weekend, is_holiday, week_of_year, total_trips, total_passengers, total_fare_revenue, total_tip_revenue, total_revenue, avg_trip_revenue, avg_tip_percentage, credit_card_trips, cash_trips, avg_trip_distance, avg_trip_duration_min, cumulative_revenue, revenue_change_vs_prior_day
    from (
        /*
    Analytics mart: Daily revenue metrics with running totals.
*/

with daily as (
    select * from "dev"."main"."int_daily_summary"
),

dates as (
    select * from "dev"."main"."dim_dates"
),

final as (
    select
        d.date_key,
        d.day_of_week_name,
        d.is_weekend,
        d.is_holiday,
        d.week_of_year,

        daily.total_trips,
        daily.total_passengers,
        daily.total_fare_revenue,
        daily.total_tip_revenue,
        daily.total_revenue,
        daily.avg_trip_revenue,
        daily.avg_tip_percentage,
        daily.credit_card_trips,
        daily.cash_trips,
        daily.avg_trip_distance,
        daily.avg_trip_duration_min,

        -- running total
        sum(daily.total_revenue) over (order by d.date_key) as cumulative_revenue,

        -- day-over-day change
        daily.total_revenue - lag(daily.total_revenue) over (order by d.date_key) as revenue_change_vs_prior_day

    from daily
    inner join dates d
        on daily.pickup_date = d.date_key
)

select * from final
    ) as model_subq
    );
  
  
[0m18:12:54.498268 [debug] [Thread-2 (]: SQL status: OK in 0.227 seconds
[0m18:12:54.501334 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m18:12:54.501994 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
alter table "dev"."main"."mart_hourly_demand" rename to "mart_hourly_demand__dbt_backup"
[0m18:12:54.503214 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:12:54.506461 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m18:12:54.507093 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
alter table "dev"."main"."mart_hourly_demand__dbt_tmp" rename to "mart_hourly_demand"
[0m18:12:54.508040 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:12:54.509716 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: COMMIT
[0m18:12:54.510378 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m18:12:54.510911 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: COMMIT
[0m18:12:54.517117 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m18:12:54.519904 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m18:12:54.520423 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
drop table if exists "dev"."main"."mart_hourly_demand__dbt_backup" cascade
[0m18:12:54.523556 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:12:54.524912 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: Close
[0m18:12:54.525492 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1175b3-4e94-4b95-97e9-9c6dd8e8b5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e3ac14f770>]}
[0m18:12:54.526153 [info ] [Thread-2 (]: 77 of 91 OK created sql table model main.mart_hourly_demand .................... [[32mOK[0m in 0.31s]
[0m18:12:54.526837 [debug] [Thread-2 (]: Finished running node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m18:12:54.527643 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m18:12:54.528006 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m18:12:54.528366 [info ] [Thread-4 (]: 79 of 91 START test not_null_mart_hourly_demand_is_weekend ..................... [RUN]
[0m18:12:54.528960 [info ] [Thread-2 (]: 80 of 91 START test not_null_mart_hourly_demand_pickup_hour .................... [RUN]
[0m18:12:54.529677 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e, now test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8)
[0m18:12:54.530447 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.mart_hourly_demand, now test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418)
[0m18:12:54.530998 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m18:12:54.531539 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m18:12:54.535196 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m18:12:54.539557 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m18:12:54.555838 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m18:12:54.558575 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m18:12:54.559015 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m18:12:54.561445 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m18:12:54.575580 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m18:12:54.576435 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: BEGIN
[0m18:12:54.577166 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m18:12:54.577555 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:54.578105 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: BEGIN
[0m18:12:54.578987 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:12:54.579293 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:12:54.579878 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m18:12:54.580935 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:12:54.581276 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."mart_hourly_demand"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m18:12:54.581809 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m18:12:54.582823 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."mart_hourly_demand"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m18:12:54.583272 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:12:54.585274 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: ROLLBACK
[0m18:12:54.585854 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:12:54.586817 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8'
[0m18:12:54.588443 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: ROLLBACK
[0m18:12:54.588928 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: Close
[0m18:12:54.589908 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418'
[0m18:12:54.590539 [info ] [Thread-4 (]: 79 of 91 PASS not_null_mart_hourly_demand_is_weekend ........................... [[32mPASS[0m in 0.06s]
[0m18:12:54.590922 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: Close
[0m18:12:54.591637 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m18:12:54.592519 [info ] [Thread-2 (]: 80 of 91 PASS not_null_mart_hourly_demand_pickup_hour .......................... [[32mPASS[0m in 0.06s]
[0m18:12:54.593967 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m18:12:54.647186 [debug] [Thread-3 (]: SQL status: OK in 0.177 seconds
[0m18:12:54.651740 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m18:12:54.652414 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
alter table "dev"."main"."mart_daily_revenue" rename to "mart_daily_revenue__dbt_backup"
[0m18:12:54.653592 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:12:54.656255 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m18:12:54.656770 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
alter table "dev"."main"."mart_daily_revenue__dbt_tmp" rename to "mart_daily_revenue"
[0m18:12:54.657913 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:12:54.659468 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: COMMIT
[0m18:12:54.659958 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m18:12:54.660396 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: COMMIT
[0m18:12:54.665441 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m18:12:54.668394 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m18:12:54.668989 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
drop table if exists "dev"."main"."mart_daily_revenue__dbt_backup" cascade
[0m18:12:54.672173 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:12:54.673702 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: Close
[0m18:12:54.674317 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1175b3-4e94-4b95-97e9-9c6dd8e8b5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e3c1b751c0>]}
[0m18:12:54.674924 [info ] [Thread-3 (]: 78 of 91 OK created sql table model main.mart_daily_revenue .................... [[32mOK[0m in 0.27s]
[0m18:12:54.675425 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m18:12:54.676248 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m18:12:54.676553 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m18:12:54.676931 [info ] [Thread-4 (]: 81 of 91 START test not_null_mart_daily_revenue_date_key ....................... [RUN]
[0m18:12:54.677335 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m18:12:54.677637 [info ] [Thread-2 (]: 82 of 91 START test not_null_mart_daily_revenue_total_revenue .................. [RUN]
[0m18:12:54.678239 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8, now test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a)
[0m18:12:54.678824 [info ] [Thread-3 (]: 83 of 91 START test unique_mart_daily_revenue_date_key ......................... [RUN]
[0m18:12:54.679642 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418, now test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9)
[0m18:12:54.680331 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m18:12:54.680940 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.mart_daily_revenue, now test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7)
[0m18:12:54.681614 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m18:12:54.684686 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m18:12:54.685304 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m18:12:54.688133 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m18:12:54.691825 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m18:12:54.705063 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m18:12:54.705712 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m18:12:54.709102 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m18:12:54.709505 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m18:12:54.712030 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m18:12:54.714451 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m18:12:54.726554 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m18:12:54.727087 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m18:12:54.727426 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: BEGIN
[0m18:12:54.727834 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m18:12:54.728314 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: BEGIN
[0m18:12:54.728849 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:54.729301 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: BEGIN
[0m18:12:54.729651 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:54.730465 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:12:54.730838 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:12:54.731358 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:12:54.731922 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:12:54.732246 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m18:12:54.732877 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m18:12:54.733443 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m18:12:54.734040 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "dev"."main"."mart_daily_revenue"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:12:54.734588 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "dev"."main"."mart_daily_revenue"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m18:12:54.735115 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "dev"."main"."mart_daily_revenue"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m18:12:54.736592 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:12:54.736937 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:12:54.737231 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:12:54.738551 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: ROLLBACK
[0m18:12:54.739686 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: ROLLBACK
[0m18:12:54.740991 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: ROLLBACK
[0m18:12:54.741770 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a'
[0m18:12:54.742440 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7'
[0m18:12:54.743193 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9'
[0m18:12:54.743643 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: Close
[0m18:12:54.744103 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: Close
[0m18:12:54.744534 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: Close
[0m18:12:54.745237 [info ] [Thread-4 (]: 81 of 91 PASS not_null_mart_daily_revenue_date_key ............................. [[32mPASS[0m in 0.07s]
[0m18:12:54.745762 [info ] [Thread-3 (]: 83 of 91 PASS unique_mart_daily_revenue_date_key ............................... [[32mPASS[0m in 0.06s]
[0m18:12:54.746246 [info ] [Thread-2 (]: 82 of 91 PASS not_null_mart_daily_revenue_total_revenue ........................ [[32mPASS[0m in 0.07s]
[0m18:12:54.746664 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m18:12:54.747234 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m18:12:54.747795 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m18:12:58.825678 [debug] [Thread-1 (]: SQL status: OK in 5.381 seconds
[0m18:12:58.828421 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m18:12:58.828944 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
alter table "dev"."main"."fct_trips" rename to "fct_trips__dbt_backup"
[0m18:12:58.829858 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:12:58.832003 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m18:12:58.832479 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
alter table "dev"."main"."fct_trips__dbt_tmp" rename to "fct_trips"
[0m18:12:58.833625 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:12:58.835229 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.fct_trips: COMMIT
[0m18:12:58.835688 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m18:12:58.836122 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.fct_trips: COMMIT
[0m18:12:59.257839 [debug] [Thread-1 (]: SQL status: OK in 0.421 seconds
[0m18:12:59.260020 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m18:12:59.260464 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
drop table if exists "dev"."main"."fct_trips__dbt_backup" cascade
[0m18:12:59.630350 [debug] [Thread-1 (]: SQL status: OK in 0.369 seconds
[0m18:12:59.631862 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.fct_trips: Close
[0m18:12:59.696914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1175b3-4e94-4b95-97e9-9c6dd8e8b5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e3c1751550>]}
[0m18:12:59.697810 [info ] [Thread-1 (]: 67 of 91 OK created sql incremental model main.fct_trips ....................... [[32mOK[0m in 6.38s]
[0m18:12:59.698387 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.fct_trips
[0m18:12:59.699346 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m18:12:59.699647 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m18:12:59.699949 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m18:12:59.700215 [info ] [Thread-4 (]: 84 of 91 START test not_null_fct_trips_pickup_datetime ......................... [RUN]
[0m18:12:59.700558 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m18:12:59.700875 [info ] [Thread-3 (]: 85 of 91 START test not_null_fct_trips_total_amount ............................ [RUN]
[0m18:12:59.701376 [info ] [Thread-2 (]: 86 of 91 START test not_null_fct_trips_trip_id ................................. [RUN]
[0m18:12:59.702115 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a, now test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83)
[0m18:12:59.702592 [info ] [Thread-1 (]: 87 of 91 START test unique_fct_trips_trip_id ................................... [RUN]
[0m18:12:59.703172 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7, now test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d)
[0m18:12:59.703661 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9, now test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d)
[0m18:12:59.704150 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m18:12:59.704651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.fct_trips, now test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab)
[0m18:12:59.705110 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m18:12:59.705508 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m18:12:59.708569 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m18:12:59.709154 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m18:12:59.712216 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m18:12:59.715081 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m18:12:59.720445 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m18:12:59.734451 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m18:12:59.734926 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m18:12:59.735281 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m18:12:59.737546 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m18:12:59.738001 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m18:12:59.739950 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m18:12:59.741901 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m18:12:59.743817 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m18:12:59.755138 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m18:12:59.755704 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m18:12:59.756089 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m18:12:59.756486 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m18:12:59.756867 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: BEGIN
[0m18:12:59.757336 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: BEGIN
[0m18:12:59.757889 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: BEGIN
[0m18:12:59.758415 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: BEGIN
[0m18:12:59.758939 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:59.759376 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:12:59.759812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:59.760363 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:59.780686 [debug] [Thread-2 (]: SQL status: OK in 0.021 seconds
[0m18:12:59.781076 [debug] [Thread-4 (]: SQL status: OK in 0.022 seconds
[0m18:12:59.781389 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m18:12:59.781631 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m18:12:59.781870 [debug] [Thread-3 (]: SQL status: OK in 0.022 seconds
[0m18:12:59.782275 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m18:12:59.782622 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m18:12:59.783137 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."fct_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m18:12:59.783545 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m18:12:59.783947 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "dev"."main"."fct_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m18:12:59.784363 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."main"."fct_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:12:59.784985 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."fct_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m18:12:59.785620 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:12:59.786068 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:12:59.787615 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: ROLLBACK
[0m18:12:59.788004 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:12:59.789517 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: ROLLBACK
[0m18:12:59.790987 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d'
[0m18:12:59.793577 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: ROLLBACK
[0m18:12:59.795203 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83'
[0m18:12:59.795647 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: Close
[0m18:12:59.799664 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d'
[0m18:12:59.802160 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: Close
[0m18:12:59.804856 [info ] [Thread-2 (]: 86 of 91 PASS not_null_fct_trips_trip_id ....................................... [[32mPASS[0m in 0.10s]
[0m18:12:59.806565 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: Close
[0m18:12:59.809162 [info ] [Thread-4 (]: 84 of 91 PASS not_null_fct_trips_pickup_datetime ............................... [[32mPASS[0m in 0.11s]
[0m18:12:59.811936 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m18:12:59.814775 [info ] [Thread-3 (]: 85 of 91 PASS not_null_fct_trips_total_amount .................................. [[32mPASS[0m in 0.11s]
[0m18:12:59.816812 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m18:12:59.821530 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m18:12:59.913970 [debug] [Thread-1 (]: SQL status: OK in 0.128 seconds
[0m18:12:59.915782 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: ROLLBACK
[0m18:12:59.916853 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab'
[0m18:12:59.917386 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: Close
[0m18:12:59.944782 [info ] [Thread-1 (]: 87 of 91 PASS unique_fct_trips_trip_id ......................................... [[32mPASS[0m in 0.24s]
[0m18:12:59.945490 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m18:12:59.946405 [debug] [Thread-2 (]: Began running node model.nyc_taxi_pipeline_00.mart_location_performance
[0m18:12:59.946960 [info ] [Thread-2 (]: 88 of 91 START sql table model main.mart_location_performance .................. [RUN]
[0m18:12:59.947901 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d, now model.nyc_taxi_pipeline_00.mart_location_performance)
[0m18:12:59.948499 [debug] [Thread-2 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_location_performance
[0m18:12:59.952537 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m18:12:59.970165 [debug] [Thread-2 (]: Began executing node model.nyc_taxi_pipeline_00.mart_location_performance
[0m18:12:59.973244 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m18:12:59.973876 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Location-level performance summary.
    Uses adapter-dispatched mode_compat() for cross-dialect support.
*/

with trips as (
    select * from "dev"."main"."fct_trips"
),

final as (
    select
        pickup_location_id,
        pickup_borough,
        pickup_zone,

        count(*) as total_pickups,
        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue_per_trip,
        round(avg(tip_percentage), 2) as avg_tip_pct,
        round(avg(passenger_count), 2) as avg_passengers,

        -- most common dropoff destination
        
    mode(dropoff_zone)
 as most_common_dropoff_zone,

        -- busiest hour
        
    mode(pickup_hour)
 as peak_pickup_hour

    from trips
    where pickup_zone is not null
    group by pickup_location_id, pickup_borough, pickup_zone
)

select * from final
order by total_pickups desc
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:12:59.974427 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:12:59.997847 [debug] [Thread-2 (]: SQL status: OK in 0.023 seconds
[0m18:13:00.001494 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m18:13:00.002595 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as varchar)
 as pickup_borough, 
      
    cast(null as varchar)
 as pickup_zone, 
      
    cast(null as bigint)
 as total_pickups, 
      
    cast(null as double)
 as avg_trip_distance, 
      
    cast(null as double)
 as avg_trip_duration_min, 
      
    cast(null as decimal(38,2))
 as total_revenue, 
      
    cast(null as double)
 as avg_revenue_per_trip, 
      
    cast(null as double)
 as avg_tip_pct, 
      
    cast(null as double)
 as avg_passengers, 
      
    cast(null as varchar)
 as most_common_dropoff_zone, 
      
    cast(null as bigint)
 as peak_pickup_hour
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:13:00.004879 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:13:00.008424 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m18:13:00.028442 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m18:13:00.029067 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: BEGIN
[0m18:13:00.029994 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:13:00.030544 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m18:13:00.031050 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_location_performance__dbt_tmp"
  
  (
    pickup_location_id integer,
    pickup_borough varchar,
    pickup_zone varchar,
    total_pickups bigint,
    avg_trip_distance double,
    avg_trip_duration_min double,
    total_revenue decimal(38,2),
    avg_revenue_per_trip double,
    avg_tip_pct double,
    avg_passengers double,
    most_common_dropoff_zone varchar,
    peak_pickup_hour bigint
    
    )
 ;
    insert into "dev"."main"."mart_location_performance__dbt_tmp" 
  (
    
      
      pickup_location_id ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      total_pickups ,
    
      
      avg_trip_distance ,
    
      
      avg_trip_duration_min ,
    
      
      total_revenue ,
    
      
      avg_revenue_per_trip ,
    
      
      avg_tip_pct ,
    
      
      avg_passengers ,
    
      
      most_common_dropoff_zone ,
    
      
      peak_pickup_hour 
    
  )
 (
      
    select pickup_location_id, pickup_borough, pickup_zone, total_pickups, avg_trip_distance, avg_trip_duration_min, total_revenue, avg_revenue_per_trip, avg_tip_pct, avg_passengers, most_common_dropoff_zone, peak_pickup_hour
    from (
        /*
    Analytics mart: Location-level performance summary.
    Uses adapter-dispatched mode_compat() for cross-dialect support.
*/

with trips as (
    select * from "dev"."main"."fct_trips"
),

final as (
    select
        pickup_location_id,
        pickup_borough,
        pickup_zone,

        count(*) as total_pickups,
        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue_per_trip,
        round(avg(tip_percentage), 2) as avg_tip_pct,
        round(avg(passenger_count), 2) as avg_passengers,

        -- most common dropoff destination
        
    mode(dropoff_zone)
 as most_common_dropoff_zone,

        -- busiest hour
        
    mode(pickup_hour)
 as peak_pickup_hour

    from trips
    where pickup_zone is not null
    group by pickup_location_id, pickup_borough, pickup_zone
)

select * from final
order by total_pickups desc
    ) as model_subq
    );
  
  
[0m18:13:00.143202 [debug] [Thread-2 (]: SQL status: OK in 0.112 seconds
[0m18:13:00.145786 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m18:13:00.146334 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
alter table "dev"."main"."mart_location_performance" rename to "mart_location_performance__dbt_backup"
[0m18:13:00.147387 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:13:00.149462 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m18:13:00.149853 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
alter table "dev"."main"."mart_location_performance__dbt_tmp" rename to "mart_location_performance"
[0m18:13:00.150490 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:13:00.151647 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: COMMIT
[0m18:13:00.152102 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m18:13:00.152540 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: COMMIT
[0m18:13:00.159689 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m18:13:00.162873 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m18:13:00.163380 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
drop table if exists "dev"."main"."mart_location_performance__dbt_backup" cascade
[0m18:13:00.166301 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:13:00.167366 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: Close
[0m18:13:00.220961 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1175b3-4e94-4b95-97e9-9c6dd8e8b5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e3ac13cc50>]}
[0m18:13:00.221822 [info ] [Thread-2 (]: 88 of 91 OK created sql table model main.mart_location_performance ............. [[32mOK[0m in 0.27s]
[0m18:13:00.222404 [debug] [Thread-2 (]: Finished running node model.nyc_taxi_pipeline_00.mart_location_performance
[0m18:13:00.223378 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m18:13:00.223691 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m18:13:00.224564 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m18:13:00.225191 [info ] [Thread-3 (]: 89 of 91 START test not_null_mart_location_performance_pickup_location_id ...... [RUN]
[0m18:13:00.226054 [info ] [Thread-1 (]: 90 of 91 START test not_null_mart_location_performance_total_pickups ........... [RUN]
[0m18:13:00.226593 [info ] [Thread-4 (]: 91 of 91 START test unique_mart_location_performance_pickup_location_id ........ [RUN]
[0m18:13:00.227224 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d, now test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c)
[0m18:13:00.227785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab, now test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259)
[0m18:13:00.228334 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83, now test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62)
[0m18:13:00.228871 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m18:13:00.229377 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m18:13:00.229812 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m18:13:00.232748 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m18:13:00.235842 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m18:13:00.238676 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m18:13:00.252117 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m18:13:00.252649 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m18:13:00.253020 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m18:13:00.255251 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m18:13:00.257131 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m18:13:00.258812 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m18:13:00.273244 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m18:13:00.273730 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m18:13:00.274136 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m18:13:00.274423 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: BEGIN
[0m18:13:00.274869 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: BEGIN
[0m18:13:00.275297 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: BEGIN
[0m18:13:00.275730 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:13:00.276172 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:13:00.276687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:00.297820 [debug] [Thread-4 (]: SQL status: OK in 0.022 seconds
[0m18:13:00.298227 [debug] [Thread-3 (]: SQL status: OK in 0.022 seconds
[0m18:13:00.298494 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m18:13:00.298762 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m18:13:00.299218 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m18:13:00.299644 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m18:13:00.300070 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pickup_location_id as unique_field,
    count(*) as n_records

from "dev"."main"."mart_location_performance"
where pickup_location_id is not null
group by pickup_location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:13:00.300488 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_location_id
from "dev"."main"."mart_location_performance"
where pickup_location_id is null



  
  
      
    ) dbt_internal_test
[0m18:13:00.300946 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_pickups
from "dev"."main"."mart_location_performance"
where total_pickups is null



  
  
      
    ) dbt_internal_test
[0m18:13:00.302367 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:13:00.302738 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:00.304165 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: ROLLBACK
[0m18:13:00.304603 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:13:00.305482 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: ROLLBACK
[0m18:13:00.306130 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c'
[0m18:13:00.307127 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: ROLLBACK
[0m18:13:00.307846 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259'
[0m18:13:00.308139 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: Close
[0m18:13:00.309035 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62'
[0m18:13:00.309308 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: Close
[0m18:13:00.310076 [info ] [Thread-3 (]: 89 of 91 PASS not_null_mart_location_performance_pickup_location_id ............ [[32mPASS[0m in 0.08s]
[0m18:13:00.310408 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: Close
[0m18:13:00.311036 [info ] [Thread-1 (]: 90 of 91 PASS not_null_mart_location_performance_total_pickups ................. [[32mPASS[0m in 0.08s]
[0m18:13:00.311458 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m18:13:00.312114 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m18:13:00.315657 [info ] [Thread-4 (]: 91 of 91 PASS unique_mart_location_performance_pickup_location_id .............. [[32mPASS[0m in 0.09s]
[0m18:13:00.316267 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m18:13:00.317877 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:00.318263 [debug] [MainThread]: On master: BEGIN
[0m18:13:00.318593 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:13:00.340179 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m18:13:00.340872 [debug] [MainThread]: On master: COMMIT
[0m18:13:00.341346 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:00.341712 [debug] [MainThread]: On master: COMMIT
[0m18:13:00.342320 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:13:00.342798 [debug] [MainThread]: On master: Close
[0m18:13:00.345694 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:00.346219 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m18:13:00.346619 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259' was properly closed.
[0m18:13:00.346949 [debug] [MainThread]: Connection 'model.nyc_taxi_pipeline_00.mart_location_performance' was properly closed.
[0m18:13:00.347280 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c' was properly closed.
[0m18:13:00.347636 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62' was properly closed.
[0m18:13:00.348142 [info ] [MainThread]: 
[0m18:13:00.348543 [info ] [MainThread]: Finished running 1 incremental model, 3 seeds, 7 table models, 74 data tests, 6 view models in 0 hours 0 minutes and 11.36 seconds (11.36s).
[0m18:13:00.354333 [debug] [MainThread]: Command end result
[0m18:13:00.401629 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m18:13:00.407578 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m18:13:00.429678 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m18:13:00.430218 [info ] [MainThread]: 
[0m18:13:00.430697 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:13:00.431089 [info ] [MainThread]: 
[0m18:13:00.431484 [info ] [MainThread]: Done. PASS=91 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=91
[0m18:13:00.432638 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 13.108792, "process_in_blocks": "86568", "process_kernel_time": 8.769138, "process_mem_max_rss": "1780056", "process_out_blocks": "136", "process_user_time": 25.54565}
[0m18:13:00.433284 [debug] [MainThread]: Command `dbt build` succeeded at 18:13:00.433178 after 13.11 seconds
[0m18:13:00.433855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e42dda8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e429cea150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e42e6cc140>]}
[0m18:13:00.434406 [debug] [MainThread]: Flushing usage events
[0m18:13:00.731681 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:26:50.211438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735c8323bce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735c8268b8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735c82c7d730>]}


============================== 18:26:50.214392 | 65b6df30-3ac6-4461-94ee-cf2e4ebdbdbe ==============================
[0m18:26:50.214392 [info ] [MainThread]: Running with dbt=1.11.4
[0m18:26:50.214788 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'write_json': 'True', 'use_colors': 'True', 'quiet': 'False', 'invocation_command': 'dbt deps --profiles-dir .', 'indirect_selection': 'eager', 'static_parser': 'True', 'log_path': '/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'empty': 'None', 'printer_width': '80', 'target_path': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'profiles_dir': '.', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m18:26:50.285210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65b6df30-3ac6-4461-94ee-cf2e4ebdbdbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735c826c3650>]}
[0m18:26:50.541323 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7rmwao1s'
[0m18:26:50.541965 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:26:50.914070 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:26:50.915429 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:26:51.112120 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:26:51.115580 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:26:54.489495 [info ] [MainThread]: Installed from version 1.3.3
[0m18:26:54.490063 [info ] [MainThread]: Up to date!
[0m18:26:54.490563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '65b6df30-3ac6-4461-94ee-cf2e4ebdbdbe', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735c820013d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735c8222a3c0>]}
[0m18:26:54.491548 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.330664, "process_in_blocks": "0", "process_kernel_time": 0.432841, "process_mem_max_rss": "105972", "process_out_blocks": "176", "process_user_time": 1.012849}
[0m18:26:54.492089 [debug] [MainThread]: Command `dbt deps` succeeded at 18:26:54.491972 after 4.33 seconds
[0m18:26:54.492468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735c84a0c0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735c830abcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735c82f2cf20>]}
[0m18:26:54.492817 [debug] [MainThread]: Flushing usage events
[0m18:26:55.401488 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:26:59.040888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6b5f2b9e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6b5f5615e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6b5f5293a0>]}


============================== 18:26:59.043277 | b9349b72-bc74-4683-b4a2-2948217f647e ==============================
[0m18:26:59.043277 [info ] [MainThread]: Running with dbt=1.11.4
[0m18:26:59.043751 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'printer_width': '80', 'no_print': 'None', 'introspect': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'use_colors': 'True', 'log_format': 'default', 'profiles_dir': '.', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --full-refresh --profiles-dir .', 'log_path': '/dbt/logs', 'log_cache_events': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'target_path': 'None', 'debug': 'False'}
[0m18:26:59.169302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9349b72-bc74-4683-b4a2-2948217f647e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6b5b333ec0>]}
[0m18:26:59.202928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9349b72-bc74-4683-b4a2-2948217f647e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6b5ed60bf0>]}
[0m18:26:59.205228 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m18:26:59.252787 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m18:26:59.840148 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:26:59.840705 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:26:59.841030 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:26:59.872288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9349b72-bc74-4683-b4a2-2948217f647e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6b5ed2eae0>]}
[0m18:26:59.946262 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m18:26:59.953146 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m18:26:59.981446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9349b72-bc74-4683-b4a2-2948217f647e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6aefd23a40>]}
[0m18:26:59.981944 [info ] [MainThread]: Found 14 models, 74 data tests, 3 seeds, 1 source, 578 macros
[0m18:26:59.986009 [info ] [MainThread]: 
[0m18:26:59.986536 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:26:59.986862 [info ] [MainThread]: 
[0m18:26:59.987317 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:26:59.991574 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m18:27:00.078391 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m18:27:00.078886 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m18:27:00.079255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:00.107096 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m18:27:00.108327 [debug] [ThreadPool]: On list_dev: Close
[0m18:27:00.114093 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m18:27:00.114759 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m18:27:00.118809 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:27:00.119246 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m18:27:00.119686 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:00.137263 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m18:27:00.138538 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:27:00.138890 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m18:27:00.139483 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:27:00.139791 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:27:00.140205 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m18:27:00.140763 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:27:00.141470 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:27:00.141852 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:27:00.142241 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:27:00.142736 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:27:00.143024 [debug] [ThreadPool]: On create_dev_main: Close
[0m18:27:00.146477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m18:27:00.149690 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:27:00.150046 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m18:27:00.150445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:00.166587 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m18:27:00.167034 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:27:00.167382 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m18:27:00.173519 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m18:27:00.175134 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m18:27:00.176362 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m18:27:00.176733 [debug] [ThreadPool]: On list_dev_main: Close
[0m18:27:00.180326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9349b72-bc74-4683-b4a2-2948217f647e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6b4f1351c0>]}
[0m18:27:00.180791 [debug] [MainThread]: Using duckdb connection "master"
[0m18:27:00.181168 [debug] [MainThread]: On master: BEGIN
[0m18:27:00.181559 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:27:00.199974 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m18:27:00.200696 [debug] [MainThread]: On master: COMMIT
[0m18:27:00.201183 [debug] [MainThread]: Using duckdb connection "master"
[0m18:27:00.201578 [debug] [MainThread]: On master: COMMIT
[0m18:27:00.202279 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:27:00.202572 [debug] [MainThread]: On master: Close
[0m18:27:00.208887 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.dim_dates
[0m18:27:00.209181 [debug] [Thread-2 (]: Began running node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m18:27:00.209446 [debug] [Thread-3 (]: Began running node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m18:27:00.209828 [info ] [Thread-1 (]: 1 of 91 START sql table model main.dim_dates ................................... [RUN]
[0m18:27:00.210227 [debug] [Thread-4 (]: Began running node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m18:27:00.210661 [info ] [Thread-2 (]: 2 of 91 START sql table model main.stg_yellow_trips ............................ [RUN]
[0m18:27:00.211265 [info ] [Thread-3 (]: 3 of 91 START seed file main.payment_type_lookup ............................... [RUN]
[0m18:27:00.211849 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nyc_taxi_pipeline_00.dim_dates'
[0m18:27:00.212275 [info ] [Thread-4 (]: 4 of 91 START seed file main.rate_code_lookup .................................. [RUN]
[0m18:27:00.212679 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.nyc_taxi_pipeline_00.stg_yellow_trips'
[0m18:27:00.213042 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.nyc_taxi_pipeline_00.payment_type_lookup'
[0m18:27:00.213398 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_dates
[0m18:27:00.213857 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.nyc_taxi_pipeline_00.rate_code_lookup'
[0m18:27:00.214226 [debug] [Thread-2 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m18:27:00.214596 [debug] [Thread-3 (]: Began compiling node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m18:27:00.225393 [debug] [Thread-4 (]: Began compiling node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m18:27:00.227704 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:27:00.238414 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m18:27:00.238816 [debug] [Thread-3 (]: Began executing node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m18:27:00.239312 [debug] [Thread-4 (]: Began executing node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m18:27:00.239706 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: BEGIN
[0m18:27:00.250347 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:27:00.253443 [debug] [Thread-2 (]: Began executing node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m18:27:00.261395 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m18:27:00.268847 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m18:27:00.274688 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.payment_type_lookup"} */
drop table if exists "dev"."main"."payment_type_lookup" cascade
[0m18:27:00.279622 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m18:27:00.279954 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m18:27:00.280174 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.rate_code_lookup"} */
drop table if exists "dev"."main"."rate_code_lookup" cascade
[0m18:27:00.280505 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:27:00.281070 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:27:00.281366 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:27:00.282023 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */


        select 
        (date_diff('day', cast('2024-01-01' as date)::timestamp, cast('2024-02-01' as date)::timestamp ))
    
[0m18:27:00.283289 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:27:00.290940 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:27:00.291229 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m18:27:00.291452 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m18:27:00.295477 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m18:27:00.296461 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m18:27:00.296803 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m18:27:00.297075 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: BEGIN
[0m18:27:00.297734 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: BEGIN
[0m18:27:00.298151 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: BEGIN
[0m18:27:00.298995 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:27:00.299227 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:27:00.299450 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:27:00.299870 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:27:00.300094 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m18:27:00.300381 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.dim_dates
[0m18:27:00.300600 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m18:27:00.300900 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m18:27:00.301238 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.payment_type_lookup"} */

    create table "dev"."main"."payment_type_lookup" ("payment_type_id" integer,"payment_type_name" varchar)
  
[0m18:27:00.312108 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.rate_code_lookup"} */

    create table "dev"."main"."rate_code_lookup" ("rate_code_id" integer,"rate_code_name" varchar)
  
[0m18:27:00.313981 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:27:00.314488 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */

  
    
    

    create  table
      "dev"."main"."stg_yellow_trips__dbt_tmp"
  
    as (
      

with source as (
    select * from read_parquet('/data/yellow_tripdata_2024-01.parquet')
),

renamed as (
    select
        -- surrogate key (MD5 hash of composite key)
        md5(cast(coalesce(cast(VendorID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(PULocationID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DOLocationID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(fare_amount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(total_amount as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- identifiers
        cast("VendorID" as integer) as vendor_id,
        cast("RatecodeID" as integer) as rate_code_id,
        cast("PULocationID" as integer) as pickup_location_id,
        cast("DOLocationID" as integer) as dropoff_location_id,
        cast(payment_type as integer) as payment_type_id,

        -- timestamps
        cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
        cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as double) as trip_distance_miles,
        store_and_fwd_flag,

        -- financials
        round(cast(fare_amount as decimal(10, 2)), 2) as fare_amount,
        round(cast(extra as decimal(10, 2)), 2) as extra_amount,
        round(cast(mta_tax as decimal(10, 2)), 2) as mta_tax,
        round(cast(tip_amount as decimal(10, 2)), 2) as tip_amount,
        round(cast(tolls_amount as decimal(10, 2)), 2) as tolls_amount,
        round(cast(improvement_surcharge as decimal(10, 2)), 2) as improvement_surcharge,
        round(cast(total_amount as decimal(10, 2)), 2) as total_amount,
        round(cast(congestion_surcharge as decimal(10, 2)), 2) as congestion_surcharge,
        round(cast(Airport_fee as decimal(10, 2)), 2) as airport_fee

    from source
    where tpep_pickup_datetime is not null
      and tpep_dropoff_datetime is not null
      and trip_distance >= 0
      and fare_amount >= 0
      -- filter out-of-range dates (data quality: ~18 trips outside Jan 2024)
      and cast(tpep_pickup_datetime as date) >= date '2024-01-01'
      and cast(tpep_pickup_datetime as date) < date '2024-02-01'
)

select * from renamed
    );
  
  
[0m18:27:00.315553 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:27:00.315879 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:27:00.316281 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
DESCRIBE (select * from (
        /*
    Dimension table: Calendar dates for January 2024.
    Uses adapter-dispatched macros for dayname/monthname.
*/

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 31
    order by generated_number



),

all_periods as (

    select (
        

    date_add(cast('2024-01-01' as date), interval (row_number() over (order by generated_number) - 1) day)


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-02-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week_num,
        
    dayname(date_day)
 as day_of_week_name,
        
    monthname(date_day)
 as month_name,
        extract(week from date_day) as week_of_year,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when cast(date_day as date) in (
                cast('2024-01-01' as date),
                cast('2024-01-15' as date)
            ) then true
            else false
        end as is_holiday

    from date_spine
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:27:00.324231 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m18:27:00.325220 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m18:27:00.326980 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: 
          COPY "dev"."main"."rate_code_lookup" FROM '/dbt/seeds/rate_code_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:27:00.327500 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: 
          COPY "dev"."main"."payment_type_lookup" FROM '/dbt/seeds/payment_type_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:27:00.328628 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:27:00.338368 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:27:00.340027 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as date_key, 
      
    cast(null as bigint)
 as year, 
      
    cast(null as bigint)
 as month, 
      
    cast(null as bigint)
 as day_of_month, 
      
    cast(null as bigint)
 as day_of_week_num, 
      
    cast(null as varchar)
 as day_of_week_name, 
      
    cast(null as varchar)
 as month_name, 
      
    cast(null as bigint)
 as week_of_year, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as boolean)
 as is_holiday
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:27:00.340724 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m18:27:00.341095 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m18:27:00.346421 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m18:27:00.347012 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m18:27:00.347545 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m18:27:00.362947 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:27:00.373410 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: COMMIT
[0m18:27:00.374039 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m18:27:00.374546 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: COMMIT
[0m18:27:00.375512 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: COMMIT
[0m18:27:00.376002 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:27:00.376598 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m18:27:00.377183 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_dates__dbt_tmp"
  
  (
    date_key date,
    year bigint,
    month bigint,
    day_of_month bigint,
    day_of_week_num bigint,
    day_of_week_name varchar,
    month_name varchar,
    week_of_year bigint,
    is_weekend boolean,
    is_holiday boolean
    
    )
 ;
    insert into "dev"."main"."dim_dates__dbt_tmp" 
  (
    
      
      date_key ,
    
      
      year ,
    
      
      month ,
    
      
      day_of_month ,
    
      
      day_of_week_num ,
    
      
      day_of_week_name ,
    
      
      month_name ,
    
      
      week_of_year ,
    
      
      is_weekend ,
    
      
      is_holiday 
    
  )
 (
      
    select date_key, year, month, day_of_month, day_of_week_num, day_of_week_name, month_name, week_of_year, is_weekend, is_holiday
    from (
        /*
    Dimension table: Calendar dates for January 2024.
    Uses adapter-dispatched macros for dayname/monthname.
*/

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 31
    order by generated_number



),

all_periods as (

    select (
        

    date_add(cast('2024-01-01' as date), interval (row_number() over (order by generated_number) - 1) day)


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-02-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week_num,
        
    dayname(date_day)
 as day_of_week_name,
        
    monthname(date_day)
 as month_name,
        extract(week from date_day) as week_of_year,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when cast(date_day as date) in (
                cast('2024-01-01' as date),
                cast('2024-01-15' as date)
            ) then true
            else false
        end as is_holiday

    from date_spine
)

select * from final
    ) as model_subq
    );
  
  
[0m18:27:00.377718 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: COMMIT
[0m18:27:00.379448 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m18:27:00.381742 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: Close
[0m18:27:00.383509 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9349b72-bc74-4683-b4a2-2948217f647e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6b4f1377a0>]}
[0m18:27:00.384258 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m18:27:00.384858 [info ] [Thread-4 (]: 4 of 91 OK loaded seed file main.rate_code_lookup .............................. [[32mCREATE 7[0m in 0.17s]
[0m18:27:00.386195 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: Close
[0m18:27:00.386939 [debug] [Thread-4 (]: Finished running node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m18:27:00.387901 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:27:00.388536 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9349b72-bc74-4683-b4a2-2948217f647e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6aed732ba0>]}
[0m18:27:00.389316 [debug] [Thread-4 (]: Began running node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m18:27:00.394682 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:27:00.395928 [info ] [Thread-3 (]: 3 of 91 OK loaded seed file main.payment_type_lookup ........................... [[32mCREATE 6[0m in 0.18s]
[0m18:27:00.396805 [info ] [Thread-4 (]: 5 of 91 START seed file main.taxi_zone_lookup .................................. [RUN]
[0m18:27:00.397335 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
alter table "dev"."main"."dim_dates" rename to "dim_dates__dbt_backup"
[0m18:27:00.397980 [debug] [Thread-3 (]: Finished running node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m18:27:00.398483 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.rate_code_lookup, now seed.nyc_taxi_pipeline_00.taxi_zone_lookup)
[0m18:27:00.399287 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m18:27:00.399813 [debug] [Thread-4 (]: Began compiling node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m18:27:00.400129 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:27:00.400577 [info ] [Thread-3 (]: 6 of 91 START test not_null_rate_code_lookup_rate_code_id ...................... [RUN]
[0m18:27:00.401556 [debug] [Thread-4 (]: Began executing node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m18:27:00.404289 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:27:00.404831 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.payment_type_lookup, now test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec)
[0m18:27:00.406520 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
alter table "dev"."main"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m18:27:00.407080 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m18:27:00.409659 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:27:00.420484 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m18:27:00.421955 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: COMMIT
[0m18:27:00.423253 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:27:00.424400 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: COMMIT
[0m18:27:00.426956 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m18:27:00.427694 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"} */
drop table if exists "dev"."main"."taxi_zone_lookup" cascade
[0m18:27:00.428153 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:27:00.430703 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:27:00.432570 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:27:00.433092 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
drop table if exists "dev"."main"."dim_dates__dbt_backup" cascade
[0m18:27:00.433423 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m18:27:00.434214 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m18:27:00.435466 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m18:27:00.445484 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m18:27:00.445844 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m18:27:00.446217 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: BEGIN
[0m18:27:00.447863 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: Close
[0m18:27:00.448695 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:27:00.449269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9349b72-bc74-4683-b4a2-2948217f647e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6aef11b8c0>]}
[0m18:27:00.449571 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m18:27:00.450298 [info ] [Thread-1 (]: 1 of 91 OK created sql table model main.dim_dates .............................. [[32mOK[0m in 0.24s]
[0m18:27:00.450911 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"} */

    create table "dev"."main"."taxi_zone_lookup" ("LocationID" integer,"Borough" varchar,"Zone" varchar,"service_zone" varchar)
  
[0m18:27:00.451514 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.dim_dates
[0m18:27:00.452499 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m18:27:00.453043 [info ] [Thread-1 (]: 7 of 91 START test unique_rate_code_lookup_rate_code_id ........................ [RUN]
[0m18:27:00.453336 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:27:00.453739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_dates, now test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d)
[0m18:27:00.455299 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m18:27:00.455687 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m18:27:00.456018 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m18:27:00.456572 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: 
          COPY "dev"."main"."taxi_zone_lookup" FROM '/dbt/seeds/taxi_zone_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:27:00.457201 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: BEGIN
[0m18:27:00.461700 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m18:27:00.462986 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:27:00.464250 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:27:00.464668 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m18:27:00.465018 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_id
from "dev"."main"."rate_code_lookup"
where rate_code_id is null



  
  
      
    ) dbt_internal_test
[0m18:27:00.466130 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:27:00.468426 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: ROLLBACK
[0m18:27:00.469200 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec'
[0m18:27:00.469575 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: Close
[0m18:27:00.469965 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m18:27:00.470609 [info ] [Thread-3 (]: 6 of 91 PASS not_null_rate_code_lookup_rate_code_id ............................ [[32mPASS[0m in 0.07s]
[0m18:27:00.471052 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m18:27:00.471302 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m18:27:00.472021 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m18:27:00.474472 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m18:27:00.475151 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m18:27:00.476135 [info ] [Thread-3 (]: 8 of 91 START test not_null_payment_type_lookup_payment_type_id ................ [RUN]
[0m18:27:00.476740 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec, now test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521)
[0m18:27:00.477146 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m18:27:00.479926 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m18:27:00.482163 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: COMMIT
[0m18:27:00.482818 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m18:27:00.483422 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: COMMIT
[0m18:27:00.484208 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m18:27:00.485062 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: BEGIN
[0m18:27:00.485492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:00.486180 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:27:00.486558 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m18:27:00.486949 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rate_code_id as unique_field,
    count(*) as n_records

from "dev"."main"."rate_code_lookup"
where rate_code_id is not null
group by rate_code_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:27:00.488285 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m18:27:00.488772 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m18:27:00.489672 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: Close
[0m18:27:00.490300 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:27:00.492667 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m18:27:00.493671 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9349b72-bc74-4683-b4a2-2948217f647e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6aed769ee0>]}
[0m18:27:00.495282 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: ROLLBACK
[0m18:27:00.496135 [info ] [Thread-4 (]: 5 of 91 OK loaded seed file main.taxi_zone_lookup .............................. [[32mCREATE 265[0m in 0.10s]
[0m18:27:00.497145 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d'
[0m18:27:00.498005 [debug] [Thread-4 (]: Finished running node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m18:27:00.498517 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: Close
[0m18:27:00.499098 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m18:27:00.500060 [info ] [Thread-1 (]: 7 of 91 PASS unique_rate_code_lookup_rate_code_id .............................. [[32mPASS[0m in 0.05s]
[0m18:27:00.500352 [info ] [Thread-4 (]: 9 of 91 START test unique_payment_type_lookup_payment_type_id .................. [RUN]
[0m18:27:00.500982 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m18:27:00.501677 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.taxi_zone_lookup, now test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7)
[0m18:27:00.502339 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m18:27:00.503052 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m18:27:00.503554 [info ] [Thread-1 (]: 10 of 91 START test not_null_dim_dates_date_key ................................ [RUN]
[0m18:27:00.505993 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m18:27:00.506403 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m18:27:00.506979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d, now test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348)
[0m18:27:00.507709 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: BEGIN
[0m18:27:00.508691 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m18:27:00.509936 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:27:00.513393 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m18:27:00.514365 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m18:27:00.515002 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m18:27:00.515552 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."payment_type_lookup"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m18:27:00.516708 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:27:00.518168 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: ROLLBACK
[0m18:27:00.519128 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521'
[0m18:27:00.519687 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: Close
[0m18:27:00.520038 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m18:27:00.520617 [info ] [Thread-3 (]: 8 of 91 PASS not_null_payment_type_lookup_payment_type_id ...................... [[32mPASS[0m in 0.04s]
[0m18:27:00.523579 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m18:27:00.524502 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m18:27:00.525645 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m18:27:00.526133 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m18:27:00.526439 [info ] [Thread-3 (]: 11 of 91 START test not_null_dim_dates_day_of_week_name ........................ [RUN]
[0m18:27:00.528632 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m18:27:00.529255 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521, now test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541)
[0m18:27:00.530254 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m18:27:00.533200 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m18:27:00.535053 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m18:27:00.535614 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: BEGIN
[0m18:27:00.536063 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:27:00.536976 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:27:00.537461 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m18:27:00.537857 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."payment_type_lookup"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:27:00.539282 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m18:27:00.539786 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: BEGIN
[0m18:27:00.540106 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:27:00.540465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:00.542039 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: ROLLBACK
[0m18:27:00.542756 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:27:00.543465 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7'
[0m18:27:00.543888 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m18:27:00.544287 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m18:27:00.544887 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: Close
[0m18:27:00.546958 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m18:27:00.547477 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "dev"."main"."dim_dates"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m18:27:00.548734 [info ] [Thread-4 (]: 9 of 91 PASS unique_payment_type_lookup_payment_type_id ........................ [[32mPASS[0m in 0.05s]
[0m18:27:00.549989 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m18:27:00.550459 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m18:27:00.550745 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:27:00.551283 [info ] [Thread-4 (]: 12 of 91 START test not_null_dim_dates_is_holiday .............................. [RUN]
[0m18:27:00.553076 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: ROLLBACK
[0m18:27:00.553509 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7, now test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a)
[0m18:27:00.554530 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348'
[0m18:27:00.555072 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m18:27:00.555547 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: Close
[0m18:27:00.558823 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m18:27:00.559924 [info ] [Thread-1 (]: 10 of 91 PASS not_null_dim_dates_date_key ...................................... [[32mPASS[0m in 0.05s]
[0m18:27:00.560750 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m18:27:00.561130 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m18:27:00.561569 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m18:27:00.561931 [info ] [Thread-1 (]: 13 of 91 START test not_null_dim_dates_is_weekend .............................. [RUN]
[0m18:27:00.562638 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: BEGIN
[0m18:27:00.563359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348, now test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0)
[0m18:27:00.563905 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:27:00.564491 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m18:27:00.568112 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m18:27:00.568530 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m18:27:00.569382 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m18:27:00.569785 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m18:27:00.570063 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select day_of_week_name
from "dev"."main"."dim_dates"
where day_of_week_name is null



  
  
      
    ) dbt_internal_test
[0m18:27:00.572347 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m18:27:00.574685 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:27:00.575261 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m18:27:00.576878 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: ROLLBACK
[0m18:27:00.579176 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m18:27:00.580576 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541'
[0m18:27:00.581619 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: Close
[0m18:27:00.582612 [info ] [Thread-3 (]: 11 of 91 PASS not_null_dim_dates_day_of_week_name .............................. [[32mPASS[0m in 0.05s]
[0m18:27:00.583391 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m18:27:00.583903 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m18:27:00.584448 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m18:27:00.585313 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: BEGIN
[0m18:27:00.586506 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m18:27:00.586011 [info ] [Thread-3 (]: 14 of 91 START test unique_dim_dates_date_key .................................. [RUN]
[0m18:27:00.587058 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:27:00.587651 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: BEGIN
[0m18:27:00.588432 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541, now test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d)
[0m18:27:00.589599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:00.590196 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:27:00.590550 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m18:27:00.591693 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:27:00.592125 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m18:27:00.595705 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m18:27:00.596443 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m18:27:00.596996 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_holiday
from "dev"."main"."dim_dates"
where is_holiday is null



  
  
      
    ) dbt_internal_test
[0m18:27:00.598198 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."dim_dates"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m18:27:00.599957 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:27:00.600362 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:27:00.602177 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: ROLLBACK
[0m18:27:00.603708 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: ROLLBACK
[0m18:27:00.604480 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a'
[0m18:27:00.605589 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0'
[0m18:27:00.606208 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: Close
[0m18:27:00.606711 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: Close
[0m18:27:00.607485 [info ] [Thread-4 (]: 12 of 91 PASS not_null_dim_dates_is_holiday .................................... [[32mPASS[0m in 0.05s]
[0m18:27:00.608129 [info ] [Thread-1 (]: 13 of 91 PASS not_null_dim_dates_is_weekend .................................... [[32mPASS[0m in 0.04s]
[0m18:27:00.608609 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m18:27:00.609387 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m18:27:00.610216 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m18:27:00.610952 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m18:27:00.611515 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m18:27:00.611837 [info ] [Thread-4 (]: 15 of 91 START test not_null_taxi_zone_lookup_Borough .......................... [RUN]
[0m18:27:00.612555 [info ] [Thread-1 (]: 16 of 91 START test not_null_taxi_zone_lookup_LocationID ....................... [RUN]
[0m18:27:00.615691 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m18:27:00.616500 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a, now test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa)
[0m18:27:00.617022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0, now test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a)
[0m18:27:00.618307 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m18:27:00.619029 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m18:27:00.622038 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m18:27:00.625010 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m18:27:00.629708 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m18:27:00.630412 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: BEGIN
[0m18:27:00.631041 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:27:00.631892 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:27:00.632493 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m18:27:00.632803 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m18:27:00.633147 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "dev"."main"."dim_dates"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:27:00.633413 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m18:27:00.635194 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m18:27:00.637487 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m18:27:00.637904 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:27:00.640151 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: ROLLBACK
[0m18:27:00.641220 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d'
[0m18:27:00.641703 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: Close
[0m18:27:00.642637 [info ] [Thread-3 (]: 14 of 91 PASS unique_dim_dates_date_key ........................................ [[32mPASS[0m in 0.05s]
[0m18:27:00.643644 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m18:27:00.644454 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m18:27:00.644968 [info ] [Thread-3 (]: 17 of 91 START test unique_taxi_zone_lookup_LocationID ......................... [RUN]
[0m18:27:00.645617 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d, now test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8)
[0m18:27:00.646070 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m18:27:00.649476 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m18:27:00.650011 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m18:27:00.651001 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: BEGIN
[0m18:27:00.651535 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m18:27:00.651872 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:27:00.652386 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: BEGIN
[0m18:27:00.653504 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:27:00.653860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:00.655276 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m18:27:00.656376 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:27:00.656844 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Borough
from "dev"."main"."taxi_zone_lookup"
where Borough is null



  
  
      
    ) dbt_internal_test
[0m18:27:00.657470 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m18:27:00.658488 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select LocationID
from "dev"."main"."taxi_zone_lookup"
where LocationID is null



  
  
      
    ) dbt_internal_test
[0m18:27:00.659004 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:27:00.659597 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m18:27:00.660288 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:27:00.661567 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: ROLLBACK
[0m18:27:00.663411 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m18:27:00.664756 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: ROLLBACK
[0m18:27:00.665428 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa'
[0m18:27:00.666875 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a'
[0m18:27:00.667392 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: Close
[0m18:27:00.667967 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: Close
[0m18:27:00.668840 [info ] [Thread-4 (]: 15 of 91 PASS not_null_taxi_zone_lookup_Borough ................................ [[32mPASS[0m in 0.05s]
[0m18:27:00.669515 [info ] [Thread-1 (]: 16 of 91 PASS not_null_taxi_zone_lookup_LocationID ............................. [[32mPASS[0m in 0.05s]
[0m18:27:00.670258 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m18:27:00.670974 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m18:27:00.671461 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m18:27:00.672097 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.stg_payment_types
[0m18:27:00.672743 [info ] [Thread-4 (]: 18 of 91 START sql view model main.stg_rate_codes .............................. [RUN]
[0m18:27:00.673424 [info ] [Thread-1 (]: 19 of 91 START sql view model main.stg_payment_types ........................... [RUN]
[0m18:27:00.674261 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa, now model.nyc_taxi_pipeline_00.stg_rate_codes)
[0m18:27:00.674844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a, now model.nyc_taxi_pipeline_00.stg_payment_types)
[0m18:27:00.675462 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m18:27:00.676032 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_payment_types
[0m18:27:00.676456 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m18:27:00.678912 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m18:27:00.681126 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m18:27:00.681818 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: BEGIN
[0m18:27:00.683283 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:27:00.684284 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:27:00.684645 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m18:27:00.685005 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    LocationID as unique_field,
    count(*) as n_records

from "dev"."main"."taxi_zone_lookup"
where LocationID is not null
group by LocationID
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:27:00.686790 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:27:00.688192 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: ROLLBACK
[0m18:27:00.688967 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8'
[0m18:27:00.689555 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: Close
[0m18:27:00.689942 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m18:27:00.690665 [info ] [Thread-3 (]: 17 of 91 PASS unique_taxi_zone_lookup_LocationID ............................... [[32mPASS[0m in 0.05s]
[0m18:27:00.691024 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.stg_payment_types
[0m18:27:00.702121 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m18:27:00.704800 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m18:27:00.707524 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m18:27:00.708513 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m18:27:00.710159 [info ] [Thread-3 (]: 20 of 91 START sql view model main.stg_taxi_zones .............................. [RUN]
[0m18:27:00.710933 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8, now model.nyc_taxi_pipeline_00.stg_taxi_zones)
[0m18:27:00.711472 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m18:27:00.713925 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m18:27:00.716244 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m18:27:00.716884 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: BEGIN
[0m18:27:00.717295 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:27:00.717658 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m18:27:00.718553 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: BEGIN
[0m18:27:00.718916 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:27:00.719402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:00.719928 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m18:27:00.720877 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:27:00.721217 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */

  
  create view "dev"."main"."stg_rate_codes__dbt_tmp" as (
    /*
    Staging model: Rate code lookup
    Maps rate_code_id to human-readable names.
*/

with source as (
    select * from "dev"."main"."rate_code_lookup"
),

renamed as (
    select
        rate_code_id,
        rate_code_name
    from source
)

select * from renamed
  );

[0m18:27:00.721684 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m18:27:00.722562 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m18:27:00.722959 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */

  
  create view "dev"."main"."stg_payment_types__dbt_tmp" as (
    /*
    Staging model: Payment type lookup
    Maps payment_type_id to human-readable names.
*/

with source as (
    select * from "dev"."main"."payment_type_lookup"
),

renamed as (
    select
        payment_type_id,
        payment_type_name
    from source
)

select * from renamed
  );

[0m18:27:00.723547 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:27:00.726371 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m18:27:00.729933 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m18:27:00.730367 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:27:00.731211 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
alter view "dev"."main"."stg_rate_codes" rename to "stg_rate_codes__dbt_backup"
[0m18:27:00.734513 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m18:27:00.736044 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
alter view "dev"."main"."stg_payment_types" rename to "stg_payment_types__dbt_backup"
[0m18:27:00.736528 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:27:00.737249 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:27:00.739718 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m18:27:00.742028 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m18:27:00.742568 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
alter view "dev"."main"."stg_rate_codes__dbt_tmp" rename to "stg_rate_codes"
[0m18:27:00.743088 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
alter view "dev"."main"."stg_payment_types__dbt_tmp" rename to "stg_payment_types"
[0m18:27:00.743807 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m18:27:00.744379 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:27:00.744738 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: BEGIN
[0m18:27:00.745216 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:27:00.746394 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: COMMIT
[0m18:27:00.746928 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:27:00.748226 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: COMMIT
[0m18:27:00.748916 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m18:27:00.750145 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m18:27:00.750460 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m18:27:00.751045 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: COMMIT
[0m18:27:00.751624 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: COMMIT
[0m18:27:00.752156 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m18:27:00.753328 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */

  
  create view "dev"."main"."stg_taxi_zones__dbt_tmp" as (
    /*
    Staging model: Taxi zone lookup
    Maps LocationID to borough and zone name.
*/

with source as (
    select * from "dev"."main"."taxi_zone_lookup"
),

renamed as (
    select
        cast("LocationID" as integer) as location_id,
        "Borough" as borough,
        "Zone" as zone_name,
        service_zone
    from source
)

select * from renamed
  );

[0m18:27:00.755488 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:27:00.755865 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:27:00.757578 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m18:27:00.758018 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:27:00.761565 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m18:27:00.762372 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
drop view if exists "dev"."main"."stg_rate_codes__dbt_backup" cascade
[0m18:27:00.764406 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m18:27:00.765012 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
alter view "dev"."main"."stg_taxi_zones" rename to "stg_taxi_zones__dbt_backup"
[0m18:27:00.765943 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
drop view if exists "dev"."main"."stg_payment_types__dbt_backup" cascade
[0m18:27:00.767197 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:27:00.770009 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m18:27:00.770496 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m18:27:00.770915 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
alter view "dev"."main"."stg_taxi_zones__dbt_tmp" rename to "stg_taxi_zones"
[0m18:27:00.772287 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: Close
[0m18:27:00.773166 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m18:27:00.773711 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:27:00.774641 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9349b72-bc74-4683-b4a2-2948217f647e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6adc1dd7f0>]}
[0m18:27:00.776123 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: Close
[0m18:27:00.777609 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: COMMIT
[0m18:27:00.778958 [info ] [Thread-4 (]: 18 of 91 OK created sql view model main.stg_rate_codes ......................... [[32mOK[0m in 0.10s]
[0m18:27:00.780039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9349b72-bc74-4683-b4a2-2948217f647e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6aed74cc20>]}
[0m18:27:00.780733 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m18:27:00.781576 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m18:27:00.782541 [info ] [Thread-1 (]: 19 of 91 OK created sql view model main.stg_payment_types ...................... [[32mOK[0m in 0.11s]
[0m18:27:00.783376 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: COMMIT
[0m18:27:00.784532 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m18:27:00.785074 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.stg_payment_types
[0m18:27:00.786512 [info ] [Thread-4 (]: 21 of 91 START test not_null_stg_rate_codes_rate_code_id ....................... [RUN]
[0m18:27:00.787747 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m18:27:00.789107 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_rate_codes, now test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a)
[0m18:27:00.789765 [info ] [Thread-1 (]: 22 of 91 START test not_null_stg_rate_codes_rate_code_name ..................... [RUN]
[0m18:27:00.790539 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m18:27:00.791202 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m18:27:00.791793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_payment_types, now test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f)
[0m18:27:00.795764 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m18:27:00.798310 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m18:27:00.799095 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m18:27:00.800144 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
drop view if exists "dev"."main"."stg_taxi_zones__dbt_backup" cascade
[0m18:27:00.804176 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m18:27:00.807987 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:27:00.809683 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: Close
[0m18:27:00.810626 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9349b72-bc74-4683-b4a2-2948217f647e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6adc113da0>]}
[0m18:27:00.811674 [info ] [Thread-3 (]: 20 of 91 OK created sql view model main.stg_taxi_zones ......................... [[32mOK[0m in 0.10s]
[0m18:27:00.812177 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m18:27:00.812803 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m18:27:00.813209 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m18:27:00.815888 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m18:27:00.817064 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m18:27:00.819914 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m18:27:00.821505 [info ] [Thread-3 (]: 23 of 91 START test unique_stg_rate_codes_rate_code_id ......................... [RUN]
[0m18:27:00.822767 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_taxi_zones, now test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3)
[0m18:27:00.823377 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m18:27:00.827218 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m18:27:00.829013 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m18:27:00.829587 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m18:27:00.830028 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: BEGIN
[0m18:27:00.830568 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: BEGIN
[0m18:27:00.831203 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:27:00.831879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:00.833474 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:27:00.834014 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:27:00.834408 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m18:27:00.835104 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m18:27:00.835832 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_id
from "dev"."main"."stg_rate_codes"
where rate_code_id is null



  
  
      
    ) dbt_internal_test
[0m18:27:00.836524 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_name
from "dev"."main"."stg_rate_codes"
where rate_code_name is null



  
  
      
    ) dbt_internal_test
[0m18:27:00.838721 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m18:27:00.839245 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:27:00.842401 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m18:27:00.842831 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:27:00.844567 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: ROLLBACK
[0m18:27:00.846546 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: ROLLBACK
[0m18:27:00.847364 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a'
[0m18:27:00.848509 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f'
[0m18:27:00.849262 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: Close
[0m18:27:00.850194 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: Close
[0m18:27:00.851173 [info ] [Thread-4 (]: 21 of 91 PASS not_null_stg_rate_codes_rate_code_id ............................. [[32mPASS[0m in 0.06s]
[0m18:27:00.851896 [info ] [Thread-1 (]: 22 of 91 PASS not_null_stg_rate_codes_rate_code_name ........................... [[32mPASS[0m in 0.06s]
[0m18:27:00.852588 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m18:27:00.853598 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m18:27:00.854507 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m18:27:00.855327 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m18:27:00.855995 [info ] [Thread-4 (]: 24 of 91 START test not_null_stg_payment_types_payment_type_id ................. [RUN]
[0m18:27:00.857278 [info ] [Thread-1 (]: 25 of 91 START test not_null_stg_payment_types_payment_type_name ............... [RUN]
[0m18:27:00.858516 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a, now test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78)
[0m18:27:00.859173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f, now test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39)
[0m18:27:00.859726 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m18:27:00.860124 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m18:27:00.860833 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m18:27:00.861369 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: BEGIN
[0m18:27:00.865163 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m18:27:00.869321 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m18:27:00.870340 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:27:00.872894 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:27:00.873515 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m18:27:00.874194 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rate_code_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_rate_codes"
where rate_code_id is not null
group by rate_code_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:27:00.875831 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:27:00.878254 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: ROLLBACK
[0m18:27:00.879720 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3'
[0m18:27:00.880612 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: Close
[0m18:27:00.881856 [info ] [Thread-3 (]: 23 of 91 PASS unique_stg_rate_codes_rate_code_id ............................... [[32mPASS[0m in 0.06s]
[0m18:27:00.883007 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m18:27:00.883667 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m18:27:00.884089 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m18:27:00.886538 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m18:27:00.887396 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m18:27:00.889948 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m18:27:00.891110 [info ] [Thread-3 (]: 26 of 91 START test unique_stg_payment_types_payment_type_id ................... [RUN]
[0m18:27:00.892276 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3, now test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534)
[0m18:27:00.892795 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m18:27:00.896091 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m18:27:00.903140 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m18:27:00.904120 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: BEGIN
[0m18:27:00.904678 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m18:27:00.905391 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:27:00.906027 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: BEGIN
[0m18:27:00.907323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:00.908147 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:27:00.908568 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m18:27:00.908980 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m18:27:00.909408 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:27:00.911745 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m18:27:00.912512 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."stg_payment_types"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m18:27:00.913181 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m18:27:00.915026 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_name
from "dev"."main"."stg_payment_types"
where payment_type_name is null



  
  
      
    ) dbt_internal_test
[0m18:27:00.915568 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:27:00.917079 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: ROLLBACK
[0m18:27:00.917560 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:27:00.918658 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78'
[0m18:27:00.920193 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: ROLLBACK
[0m18:27:00.920837 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: Close
[0m18:27:00.921765 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39'
[0m18:27:00.922779 [info ] [Thread-4 (]: 24 of 91 PASS not_null_stg_payment_types_payment_type_id ....................... [[32mPASS[0m in 0.06s]
[0m18:27:00.923108 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: Close
[0m18:27:00.923893 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m18:27:00.926205 [info ] [Thread-1 (]: 25 of 91 PASS not_null_stg_payment_types_payment_type_name ..................... [[32mPASS[0m in 0.07s]
[0m18:27:00.926748 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m18:27:00.927391 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m18:27:00.927890 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m18:27:00.928483 [info ] [Thread-4 (]: 27 of 91 START test not_null_stg_taxi_zones_borough ............................ [RUN]
[0m18:27:00.929290 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: BEGIN
[0m18:27:00.929966 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m18:27:00.930798 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b)
[0m18:27:00.931430 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:27:00.932129 [info ] [Thread-1 (]: 28 of 91 START test not_null_stg_taxi_zones_location_id ........................ [RUN]
[0m18:27:00.932866 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m18:27:00.934354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf)
[0m18:27:00.934763 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:27:00.939025 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m18:27:00.940540 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m18:27:00.941211 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m18:27:00.945099 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m18:27:00.945798 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_payment_types"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:27:00.948491 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:27:00.950038 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: ROLLBACK
[0m18:27:00.951184 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534'
[0m18:27:00.951728 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: Close
[0m18:27:00.952236 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m18:27:00.953033 [info ] [Thread-3 (]: 26 of 91 PASS unique_stg_payment_types_payment_type_id ......................... [[32mPASS[0m in 0.06s]
[0m18:27:00.955264 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m18:27:00.955691 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m18:27:00.956630 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m18:27:00.961305 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m18:27:00.962251 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m18:27:00.963991 [info ] [Thread-3 (]: 29 of 91 START test not_null_stg_taxi_zones_zone_name .......................... [RUN]
[0m18:27:00.964872 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84)
[0m18:27:00.965606 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m18:27:00.968749 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m18:27:00.970610 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m18:27:00.971237 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m18:27:00.971703 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: BEGIN
[0m18:27:00.972557 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: BEGIN
[0m18:27:00.973398 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:27:00.974242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:00.975629 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:27:00.976126 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:27:00.976588 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m18:27:00.977362 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m18:27:00.978210 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select borough
from "dev"."main"."stg_taxi_zones"
where borough is null



  
  
      
    ) dbt_internal_test
[0m18:27:00.978905 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "dev"."main"."stg_taxi_zones"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m18:27:00.980786 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m18:27:00.981277 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:27:00.983069 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m18:27:00.983408 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:27:00.985431 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: ROLLBACK
[0m18:27:00.987237 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: ROLLBACK
[0m18:27:00.988167 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b'
[0m18:27:00.989279 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf'
[0m18:27:00.989893 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: Close
[0m18:27:00.990509 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: Close
[0m18:27:00.991330 [info ] [Thread-4 (]: 27 of 91 PASS not_null_stg_taxi_zones_borough .................................. [[32mPASS[0m in 0.06s]
[0m18:27:00.991947 [info ] [Thread-1 (]: 28 of 91 PASS not_null_stg_taxi_zones_location_id .............................. [[32mPASS[0m in 0.06s]
[0m18:27:00.994300 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m18:27:00.993127 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m18:27:00.995001 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m18:27:00.995746 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.dim_payment_types
[0m18:27:00.996891 [info ] [Thread-1 (]: 30 of 91 START test unique_stg_taxi_zones_location_id .......................... [RUN]
[0m18:27:00.997897 [info ] [Thread-4 (]: 31 of 91 START sql table model main.dim_payment_types .......................... [RUN]
[0m18:27:00.998757 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m18:27:00.999282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf, now test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c)
[0m18:27:01.000168 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b, now model.nyc_taxi_pipeline_00.dim_payment_types)
[0m18:27:01.000760 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: BEGIN
[0m18:27:01.002598 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m18:27:01.003747 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_payment_types
[0m18:27:01.006039 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:27:01.010220 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m18:27:01.013018 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m18:27:01.014430 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m18:27:01.015828 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m18:27:01.016293 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select zone_name
from "dev"."main"."stg_taxi_zones"
where zone_name is null



  
  
      
    ) dbt_internal_test
[0m18:27:01.017766 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:27:01.019761 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: ROLLBACK
[0m18:27:01.021029 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84'
[0m18:27:01.021605 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: Close
[0m18:27:01.022318 [info ] [Thread-3 (]: 29 of 91 PASS not_null_stg_taxi_zones_zone_name ................................ [[32mPASS[0m in 0.06s]
[0m18:27:01.022982 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m18:27:01.023670 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m18:27:01.024490 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.dim_payment_types
[0m18:27:01.026731 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m18:27:01.032537 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m18:27:01.033804 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
DESCRIBE (select * from (
        /*
    Dimension table: Payment type descriptions.
*/

with payment_types as (
    select * from "dev"."main"."stg_payment_types"
),

final as (
    select
        payment_type_id,
        payment_type_name
    from payment_types
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:27:01.038508 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:27:01.043577 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m18:27:01.046054 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m18:27:01.046667 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as payment_type_id, 
      
    cast(null as varchar)
 as payment_type_name
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:27:01.047891 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:27:01.049321 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m18:27:01.051031 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m18:27:01.051914 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: BEGIN
[0m18:27:01.052506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:01.053467 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:27:01.053994 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m18:27:01.058525 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_taxi_zones"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:27:01.063793 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:27:01.065596 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: ROLLBACK
[0m18:27:01.066492 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c'
[0m18:27:01.067027 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m18:27:01.067347 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: Close
[0m18:27:01.067961 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: BEGIN
[0m18:27:01.068991 [info ] [Thread-1 (]: 30 of 91 PASS unique_stg_taxi_zones_location_id ................................ [[32mPASS[0m in 0.07s]
[0m18:27:01.069694 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:27:01.070320 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m18:27:01.070892 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m18:27:01.071774 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.dim_locations
[0m18:27:01.072347 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_payment_types__dbt_tmp"
  
  (
    payment_type_id integer,
    payment_type_name varchar
    
    )
 ;
    insert into "dev"."main"."dim_payment_types__dbt_tmp" 
  (
    
      
      payment_type_id ,
    
      
      payment_type_name 
    
  )
 (
      
    select payment_type_id, payment_type_name
    from (
        /*
    Dimension table: Payment type descriptions.
*/

with payment_types as (
    select * from "dev"."main"."stg_payment_types"
),

final as (
    select
        payment_type_id,
        payment_type_name
    from payment_types
)

select * from final
    ) as model_subq
    );
  
  
[0m18:27:01.073090 [info ] [Thread-3 (]: 32 of 91 START sql table model main.dim_locations .............................. [RUN]
[0m18:27:01.074496 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84, now model.nyc_taxi_pipeline_00.dim_locations)
[0m18:27:01.075269 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_locations
[0m18:27:01.077978 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_locations"
[0m18:27:01.078548 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m18:27:01.082063 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m18:27:01.082727 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
alter table "dev"."main"."dim_payment_types" rename to "dim_payment_types__dbt_backup"
[0m18:27:01.083955 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:27:01.088098 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m18:27:01.088966 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
alter table "dev"."main"."dim_payment_types__dbt_tmp" rename to "dim_payment_types"
[0m18:27:01.090574 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:27:01.090921 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.dim_locations
[0m18:27:01.092025 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: COMMIT
[0m18:27:01.095187 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m18:27:01.095824 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m18:27:01.096409 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
DESCRIBE (select * from (
        /*
    Dimension table: TLC Taxi Zone locations.
*/

with zones as (
    select * from "dev"."main"."stg_taxi_zones"
),

final as (
    select
        location_id,
        borough,
        zone_name,
        service_zone
    from zones
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:27:01.097066 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: COMMIT
[0m18:27:01.097654 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:27:01.100323 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:27:01.102374 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m18:27:01.103629 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m18:27:01.105410 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m18:27:01.106308 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as location_id, 
      
    cast(null as varchar)
 as borough, 
      
    cast(null as varchar)
 as zone_name, 
      
    cast(null as varchar)
 as service_zone
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:27:01.107054 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
drop table if exists "dev"."main"."dim_payment_types__dbt_backup" cascade
[0m18:27:01.108511 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:27:01.110298 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_locations"
[0m18:27:01.112849 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m18:27:01.114224 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: Close
[0m18:27:01.115012 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9349b72-bc74-4683-b4a2-2948217f647e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6acc16f0e0>]}
[0m18:27:01.115693 [info ] [Thread-4 (]: 31 of 91 OK created sql table model main.dim_payment_types ..................... [[32mOK[0m in 0.11s]
[0m18:27:01.116364 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.dim_payment_types
[0m18:27:01.117223 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m18:27:01.117658 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m18:27:01.118244 [info ] [Thread-1 (]: 33 of 91 START test not_null_dim_payment_types_payment_type_id ................. [RUN]
[0m18:27:01.119004 [info ] [Thread-4 (]: 34 of 91 START test not_null_dim_payment_types_payment_type_name ............... [RUN]
[0m18:27:01.120217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c, now test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10)
[0m18:27:01.120954 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_payment_types, now test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0)
[0m18:27:01.121698 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m18:27:01.122499 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m18:27:01.126044 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m18:27:01.126806 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m18:27:01.130260 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m18:27:01.131700 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: BEGIN
[0m18:27:01.133472 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:27:01.134062 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m18:27:01.135285 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_locations__dbt_tmp"
  
  (
    location_id integer,
    borough varchar,
    zone_name varchar,
    service_zone varchar
    
    )
 ;
    insert into "dev"."main"."dim_locations__dbt_tmp" 
  (
    
      
      location_id ,
    
      
      borough ,
    
      
      zone_name ,
    
      
      service_zone 
    
  )
 (
      
    select location_id, borough, zone_name, service_zone
    from (
        /*
    Dimension table: TLC Taxi Zone locations.
*/

with zones as (
    select * from "dev"."main"."stg_taxi_zones"
),

final as (
    select
        location_id,
        borough,
        zone_name,
        service_zone
    from zones
)

select * from final
    ) as model_subq
    );
  
  
[0m18:27:01.137951 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:27:01.140899 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m18:27:01.141486 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
alter table "dev"."main"."dim_locations" rename to "dim_locations__dbt_backup"
[0m18:27:01.142919 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:27:01.143337 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m18:27:01.146169 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m18:27:01.146692 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m18:27:01.150243 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m18:27:01.150920 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
alter table "dev"."main"."dim_locations__dbt_tmp" rename to "dim_locations"
[0m18:27:01.154606 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m18:27:01.156742 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:27:01.158777 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: COMMIT
[0m18:27:01.159281 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m18:27:01.159675 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: COMMIT
[0m18:27:01.164461 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m18:27:01.165227 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m18:27:01.165795 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: BEGIN
[0m18:27:01.166317 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m18:27:01.168505 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m18:27:01.169128 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:27:01.169645 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: BEGIN
[0m18:27:01.170314 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
drop table if exists "dev"."main"."dim_locations__dbt_backup" cascade
[0m18:27:01.171316 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:27:01.171669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:01.172796 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m18:27:01.173709 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:27:01.174059 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_name
from "dev"."main"."dim_payment_types"
where payment_type_name is null



  
  
      
    ) dbt_internal_test
[0m18:27:01.174595 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m18:27:01.175110 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:27:01.175830 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."dim_payment_types"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m18:27:01.176481 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:27:01.177679 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: Close
[0m18:27:01.179562 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: ROLLBACK
[0m18:27:01.180018 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:27:01.180679 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9349b72-bc74-4683-b4a2-2948217f647e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6acc1d44d0>]}
[0m18:27:01.181561 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0'
[0m18:27:01.183006 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: ROLLBACK
[0m18:27:01.183591 [info ] [Thread-3 (]: 32 of 91 OK created sql table model main.dim_locations ......................... [[32mOK[0m in 0.11s]
[0m18:27:01.184282 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: Close
[0m18:27:01.185225 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10'
[0m18:27:01.185954 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.dim_locations
[0m18:27:01.186835 [info ] [Thread-4 (]: 34 of 91 PASS not_null_dim_payment_types_payment_type_name ..................... [[32mPASS[0m in 0.07s]
[0m18:27:01.187135 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: Close
[0m18:27:01.187738 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m18:27:01.188423 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m18:27:01.189163 [info ] [Thread-1 (]: 33 of 91 PASS not_null_dim_payment_types_payment_type_id ....................... [[32mPASS[0m in 0.07s]
[0m18:27:01.189543 [info ] [Thread-3 (]: 35 of 91 START test unique_dim_payment_types_payment_type_id ................... [RUN]
[0m18:27:01.190297 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m18:27:01.190927 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m18:27:01.191700 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_locations, now test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62)
[0m18:27:01.192266 [info ] [Thread-4 (]: 36 of 91 START test not_null_dim_locations_borough ............................. [RUN]
[0m18:27:01.192838 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m18:27:01.193549 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m18:27:01.194189 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0, now test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af)
[0m18:27:01.194716 [info ] [Thread-1 (]: 37 of 91 START test not_null_dim_locations_location_id ......................... [RUN]
[0m18:27:01.198286 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m18:27:01.199018 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m18:27:01.199784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10, now test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476)
[0m18:27:01.203257 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m18:27:01.203882 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m18:27:01.207578 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m18:27:01.209460 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m18:27:01.211766 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m18:27:01.213043 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m18:27:01.215046 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m18:27:01.215434 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m18:27:01.217266 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m18:27:01.220526 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m18:27:01.221200 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m18:27:01.221822 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: BEGIN
[0m18:27:01.222503 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: BEGIN
[0m18:27:01.223068 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:27:01.223650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:01.224067 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m18:27:01.225601 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:27:01.226437 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:27:01.226818 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: BEGIN
[0m18:27:01.227342 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m18:27:01.227794 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m18:27:01.228521 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:27:01.229067 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."dim_payment_types"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:27:01.229612 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "dev"."main"."dim_locations"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m18:27:01.230592 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:27:01.231868 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m18:27:01.232238 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:27:01.232529 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select borough
from "dev"."main"."dim_locations"
where borough is null



  
  
      
    ) dbt_internal_test
[0m18:27:01.232854 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:27:01.234509 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: ROLLBACK
[0m18:27:01.236189 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: ROLLBACK
[0m18:27:01.236547 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:27:01.237521 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476'
[0m18:27:01.238446 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62'
[0m18:27:01.239861 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: ROLLBACK
[0m18:27:01.240177 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: Close
[0m18:27:01.246433 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: Close
[0m18:27:01.247607 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af'
[0m18:27:01.248318 [info ] [Thread-1 (]: 37 of 91 PASS not_null_dim_locations_location_id ............................... [[32mPASS[0m in 0.05s]
[0m18:27:01.249025 [info ] [Thread-3 (]: 35 of 91 PASS unique_dim_payment_types_payment_type_id ......................... [[32mPASS[0m in 0.06s]
[0m18:27:01.249670 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: Close
[0m18:27:01.250574 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m18:27:01.251342 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m18:27:01.252741 [info ] [Thread-4 (]: 36 of 91 PASS not_null_dim_locations_borough ................................... [[32mPASS[0m in 0.06s]
[0m18:27:01.253729 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m18:27:01.254549 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m18:27:01.255160 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m18:27:01.255784 [info ] [Thread-1 (]: 38 of 91 START test not_null_dim_locations_zone_name ........................... [RUN]
[0m18:27:01.256366 [info ] [Thread-3 (]: 39 of 91 START test unique_dim_locations_location_id ........................... [RUN]
[0m18:27:01.257862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476, now test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d)
[0m18:27:01.258647 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62, now test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d)
[0m18:27:01.259152 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m18:27:01.259698 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m18:27:01.263269 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m18:27:01.267628 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m18:27:01.274163 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m18:27:01.276118 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m18:27:01.276519 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m18:27:01.278273 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m18:27:01.283455 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m18:27:01.284585 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: BEGIN
[0m18:27:01.285278 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m18:27:01.285773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:01.286367 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: BEGIN
[0m18:27:01.287520 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:27:01.287894 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:27:01.288554 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m18:27:01.289765 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select zone_name
from "dev"."main"."dim_locations"
where zone_name is null



  
  
      
    ) dbt_internal_test
[0m18:27:01.290168 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:27:01.290875 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m18:27:01.291333 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "dev"."main"."dim_locations"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:27:01.291710 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:27:01.293066 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: ROLLBACK
[0m18:27:01.293377 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:27:01.294198 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d'
[0m18:27:01.296093 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: ROLLBACK
[0m18:27:01.296550 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: Close
[0m18:27:01.297704 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d'
[0m18:27:01.298307 [info ] [Thread-1 (]: 38 of 91 PASS not_null_dim_locations_zone_name ................................. [[32mPASS[0m in 0.04s]
[0m18:27:01.298610 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: Close
[0m18:27:01.299234 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m18:27:01.300095 [info ] [Thread-3 (]: 39 of 91 PASS unique_dim_locations_location_id ................................. [[32mPASS[0m in 0.04s]
[0m18:27:01.301104 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m18:27:02.395758 [debug] [Thread-2 (]: SQL status: OK in 2.079 seconds
[0m18:27:02.398350 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m18:27:02.398871 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
alter table "dev"."main"."stg_yellow_trips" rename to "stg_yellow_trips__dbt_backup"
[0m18:27:02.399835 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:27:02.401820 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m18:27:02.402495 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
alter table "dev"."main"."stg_yellow_trips__dbt_tmp" rename to "stg_yellow_trips"
[0m18:27:02.403339 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:27:02.404425 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: COMMIT
[0m18:27:02.404808 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m18:27:02.405174 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: COMMIT
[0m18:27:02.447410 [debug] [Thread-2 (]: SQL status: OK in 0.042 seconds
[0m18:27:02.449408 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m18:27:02.449782 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
drop table if exists "dev"."main"."stg_yellow_trips__dbt_backup" cascade
[0m18:27:02.454628 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m18:27:02.455948 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: Close
[0m18:27:02.524837 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9349b72-bc74-4683-b4a2-2948217f647e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6aef13f4d0>]}
[0m18:27:02.525769 [info ] [Thread-2 (]: 2 of 91 OK created sql table model main.stg_yellow_trips ....................... [[32mOK[0m in 2.31s]
[0m18:27:02.526421 [debug] [Thread-2 (]: Finished running node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m18:27:02.527504 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m18:27:02.527849 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m18:27:02.528292 [info ] [Thread-4 (]: 40 of 91 START test accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6  [RUN]
[0m18:27:02.528808 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m18:27:02.529447 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m18:27:02.529794 [info ] [Thread-1 (]: 41 of 91 START test accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99  [RUN]
[0m18:27:02.530397 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44)
[0m18:27:02.531095 [info ] [Thread-3 (]: 42 of 91 START test accepted_values_stg_yellow_trips_vendor_id__1__2__6 ........ [RUN]
[0m18:27:02.531657 [info ] [Thread-2 (]: 43 of 91 START test assert_fare_not_exceeds_total .............................. [RUN]
[0m18:27:02.532289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098)
[0m18:27:02.532837 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m18:27:02.533409 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27)
[0m18:27:02.533872 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_yellow_trips, now test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total)
[0m18:27:02.534347 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m18:27:02.539519 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m18:27:02.540235 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m18:27:02.540978 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m18:27:02.544321 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m18:27:02.547668 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m18:27:02.549566 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m18:27:02.552093 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m18:27:02.555122 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m18:27:02.556283 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m18:27:02.556605 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m18:27:02.558077 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m18:27:02.558426 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m18:27:02.560306 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m18:27:02.562570 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m18:27:02.563786 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m18:27:02.564250 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: BEGIN
[0m18:27:02.564702 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:27:02.565914 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m18:27:02.566462 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m18:27:02.566727 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: BEGIN
[0m18:27:02.567245 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: BEGIN
[0m18:27:02.567722 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:27:02.568077 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m18:27:02.568335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:02.568913 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: BEGIN
[0m18:27:02.569636 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:27:02.585114 [debug] [Thread-4 (]: SQL status: OK in 0.020 seconds
[0m18:27:02.585521 [debug] [Thread-3 (]: SQL status: OK in 0.018 seconds
[0m18:27:02.585827 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m18:27:02.586132 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m18:27:02.586325 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m18:27:02.586695 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m18:27:02.587051 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m18:27:02.587407 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        payment_type_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by payment_type_id

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6'
)



  
  
      
    ) dbt_internal_test
[0m18:27:02.587781 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m18:27:02.588216 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        vendor_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by vendor_id

)

select *
from all_values
where value_field not in (
    '1','2','6'
)



  
  
      
    ) dbt_internal_test
[0m18:27:02.588644 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rate_code_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by rate_code_id

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5','6','99'
)



  
  
      
    ) dbt_internal_test
[0m18:27:02.589292 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
    Singular test: fare_amount should not exceed total_amount.
*/

select
    trip_id,
    fare_amount,
    total_amount
from "dev"."main"."stg_yellow_trips"
where fare_amount > total_amount + 0.01
  and total_amount > 0
  
  
      
    ) dbt_internal_test
[0m18:27:02.606495 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m18:27:02.610307 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: ROLLBACK
[0m18:27:02.613216 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44'
[0m18:27:02.614902 [debug] [Thread-3 (]: SQL status: OK in 0.025 seconds
[0m18:27:02.615218 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: Close
[0m18:27:02.618397 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: ROLLBACK
[0m18:27:02.619764 [info ] [Thread-4 (]: 40 of 91 PASS accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6  [[32mPASS[0m in 0.09s]
[0m18:27:02.621912 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27'
[0m18:27:02.624213 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m18:27:02.625857 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: Close
[0m18:27:02.626648 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m18:27:02.627262 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m18:27:02.628091 [info ] [Thread-3 (]: 42 of 91 PASS accepted_values_stg_yellow_trips_vendor_id__1__2__6 .............. [[32mPASS[0m in 0.09s]
[0m18:27:02.628467 [debug] [Thread-2 (]: SQL status: OK in 0.036 seconds
[0m18:27:02.629617 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: ROLLBACK
[0m18:27:02.629916 [info ] [Thread-4 (]: 44 of 91 START test not_null_stg_yellow_trips_dropoff_datetime ................. [RUN]
[0m18:27:02.630546 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m18:27:02.631737 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: ROLLBACK
[0m18:27:02.632326 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098'
[0m18:27:02.632646 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052)
[0m18:27:02.633136 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m18:27:02.633862 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total'
[0m18:27:02.634098 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: Close
[0m18:27:02.634527 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m18:27:02.634923 [info ] [Thread-3 (]: 45 of 91 START test not_null_stg_yellow_trips_dropoff_location_id .............. [RUN]
[0m18:27:02.635344 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: Close
[0m18:27:02.635962 [info ] [Thread-1 (]: 41 of 91 PASS accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99  [[32mPASS[0m in 0.10s]
[0m18:27:02.638730 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m18:27:02.639343 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048)
[0m18:27:02.640188 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m18:27:02.640788 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m18:27:02.641268 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m18:27:02.645354 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m18:27:02.645948 [info ] [Thread-2 (]: 43 of 91 PASS assert_fare_not_exceeds_total .................................... [[32mPASS[0m in 0.11s]
[0m18:27:02.646307 [info ] [Thread-1 (]: 46 of 91 START test not_null_stg_yellow_trips_fare_amount ...................... [RUN]
[0m18:27:02.646996 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m18:27:02.647374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97)
[0m18:27:02.647810 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m18:27:02.648192 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m18:27:02.648518 [info ] [Thread-2 (]: 47 of 91 START test not_null_stg_yellow_trips_pickup_datetime .................. [RUN]
[0m18:27:02.652018 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m18:27:02.652766 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed)
[0m18:27:02.653129 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m18:27:02.653749 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m18:27:02.653995 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m18:27:02.655859 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m18:27:02.658448 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m18:27:02.662032 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m18:27:02.663289 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m18:27:02.664903 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m18:27:02.668829 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m18:27:02.669269 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m18:27:02.669581 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m18:27:02.669862 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: BEGIN
[0m18:27:02.670378 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: BEGIN
[0m18:27:02.672359 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m18:27:02.672687 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m18:27:02.672911 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:27:02.673198 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:27:02.673658 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: BEGIN
[0m18:27:02.674512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:02.680120 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m18:27:02.680635 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: BEGIN
[0m18:27:02.681088 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:27:02.690011 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m18:27:02.690388 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m18:27:02.690621 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m18:27:02.690839 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m18:27:02.691054 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m18:27:02.691470 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m18:27:02.691890 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m18:27:02.692412 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m18:27:02.692896 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_datetime
from "dev"."main"."stg_yellow_trips"
where dropoff_datetime is null



  
  
      
    ) dbt_internal_test
[0m18:27:02.693302 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_location_id
from "dev"."main"."stg_yellow_trips"
where dropoff_location_id is null



  
  
      
    ) dbt_internal_test
[0m18:27:02.693667 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "dev"."main"."stg_yellow_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m18:27:02.694043 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fare_amount
from "dev"."main"."stg_yellow_trips"
where fare_amount is null



  
  
      
    ) dbt_internal_test
[0m18:27:02.695798 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:27:02.696371 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:27:02.696766 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:27:02.698046 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: ROLLBACK
[0m18:27:02.699351 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: ROLLBACK
[0m18:27:02.699583 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:27:02.700322 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: ROLLBACK
[0m18:27:02.700801 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052'
[0m18:27:02.701257 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048'
[0m18:27:02.702760 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: ROLLBACK
[0m18:27:02.703417 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed'
[0m18:27:02.703832 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: Close
[0m18:27:02.704182 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: Close
[0m18:27:02.704751 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97'
[0m18:27:02.705142 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: Close
[0m18:27:02.705665 [info ] [Thread-4 (]: 44 of 91 PASS not_null_stg_yellow_trips_dropoff_datetime ....................... [[32mPASS[0m in 0.07s]
[0m18:27:02.706064 [info ] [Thread-3 (]: 45 of 91 PASS not_null_stg_yellow_trips_dropoff_location_id .................... [[32mPASS[0m in 0.07s]
[0m18:27:02.706346 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: Close
[0m18:27:02.706950 [info ] [Thread-2 (]: 47 of 91 PASS not_null_stg_yellow_trips_pickup_datetime ........................ [[32mPASS[0m in 0.05s]
[0m18:27:02.707437 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m18:27:02.708003 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m18:27:02.708788 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m18:27:02.709197 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m18:27:02.709589 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m18:27:02.709939 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m18:27:02.710452 [info ] [Thread-4 (]: 48 of 91 START test not_null_stg_yellow_trips_pickup_location_id ............... [RUN]
[0m18:27:02.710876 [info ] [Thread-1 (]: 46 of 91 PASS not_null_stg_yellow_trips_fare_amount ............................ [[32mPASS[0m in 0.06s]
[0m18:27:02.711127 [info ] [Thread-3 (]: 49 of 91 START test not_null_stg_yellow_trips_total_amount ..................... [RUN]
[0m18:27:02.711500 [info ] [Thread-2 (]: 50 of 91 START test not_null_stg_yellow_trips_trip_distance_miles .............. [RUN]
[0m18:27:02.711989 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1)
[0m18:27:02.712612 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m18:27:02.713133 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6)
[0m18:27:02.713654 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7)
[0m18:27:02.714186 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m18:27:02.714635 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m18:27:02.714958 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m18:27:02.715258 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m18:27:02.717991 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m18:27:02.718463 [info ] [Thread-1 (]: 51 of 91 START test not_null_stg_yellow_trips_trip_id .......................... [RUN]
[0m18:27:02.720812 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m18:27:02.723504 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m18:27:02.724248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1)
[0m18:27:02.725304 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m18:27:02.727811 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m18:27:02.731501 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m18:27:02.731796 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m18:27:02.733106 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m18:27:02.734781 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m18:27:02.735175 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m18:27:02.735440 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m18:27:02.737956 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m18:27:02.739552 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m18:27:02.742406 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m18:27:02.742893 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: BEGIN
[0m18:27:02.743205 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m18:27:02.743490 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:27:02.743715 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m18:27:02.744047 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: BEGIN
[0m18:27:02.744298 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m18:27:02.744719 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: BEGIN
[0m18:27:02.745091 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:27:02.745567 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: BEGIN
[0m18:27:02.746178 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:27:02.746918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:02.761008 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m18:27:02.761352 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m18:27:02.761573 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m18:27:02.761788 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m18:27:02.761984 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m18:27:02.762323 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m18:27:02.762683 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m18:27:02.762988 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m18:27:02.763353 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_location_id
from "dev"."main"."stg_yellow_trips"
where pickup_location_id is null



  
  
      
    ) dbt_internal_test
[0m18:27:02.763696 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."stg_yellow_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m18:27:02.764050 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_distance_miles
from "dev"."main"."stg_yellow_trips"
where trip_distance_miles is null



  
  
      
    ) dbt_internal_test
[0m18:27:02.764418 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."stg_yellow_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m18:27:02.765353 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:27:02.765561 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:27:02.765757 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:27:02.765977 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:27:02.766877 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: ROLLBACK
[0m18:27:02.767871 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: ROLLBACK
[0m18:27:02.768760 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: ROLLBACK
[0m18:27:02.769515 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: ROLLBACK
[0m18:27:02.770023 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6'
[0m18:27:02.770499 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1'
[0m18:27:02.771040 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7'
[0m18:27:02.771718 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1'
[0m18:27:02.772068 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: Close
[0m18:27:02.772406 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: Close
[0m18:27:02.772755 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: Close
[0m18:27:02.773104 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: Close
[0m18:27:02.773556 [info ] [Thread-3 (]: 49 of 91 PASS not_null_stg_yellow_trips_total_amount ........................... [[32mPASS[0m in 0.06s]
[0m18:27:02.773936 [info ] [Thread-4 (]: 48 of 91 PASS not_null_stg_yellow_trips_pickup_location_id ..................... [[32mPASS[0m in 0.06s]
[0m18:27:02.774262 [info ] [Thread-2 (]: 50 of 91 PASS not_null_stg_yellow_trips_trip_distance_miles .................... [[32mPASS[0m in 0.06s]
[0m18:27:02.774765 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m18:27:02.775460 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m18:27:02.776003 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m18:27:02.776776 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m18:27:02.777403 [info ] [Thread-1 (]: 51 of 91 PASS not_null_stg_yellow_trips_trip_id ................................ [[32mPASS[0m in 0.05s]
[0m18:27:02.777745 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m18:27:02.778303 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m18:27:02.778682 [info ] [Thread-3 (]: 52 of 91 START test not_null_stg_yellow_trips_vendor_id ........................ [RUN]
[0m18:27:02.779098 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m18:27:02.779459 [info ] [Thread-4 (]: 53 of 91 START test unique_stg_yellow_trips_trip_id ............................ [RUN]
[0m18:27:02.779876 [info ] [Thread-2 (]: 54 of 91 START test relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_  [RUN]
[0m18:27:02.780456 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57)
[0m18:27:02.780982 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m18:27:02.781426 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1, now test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965)
[0m18:27:02.781885 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7, now test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a)
[0m18:27:02.782303 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m18:27:02.782600 [info ] [Thread-1 (]: 55 of 91 START test relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_  [RUN]
[0m18:27:02.782946 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m18:27:02.783343 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m18:27:02.786263 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m18:27:02.786683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1, now test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f)
[0m18:27:02.788806 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m18:27:02.793820 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m18:27:02.794741 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m18:27:02.797905 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m18:27:02.801955 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m18:27:02.802314 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m18:27:02.803693 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m18:27:02.805339 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m18:27:02.805656 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m18:27:02.805923 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m18:27:02.807426 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m18:27:02.809137 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m18:27:02.810389 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m18:27:02.810631 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m18:27:02.810838 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: BEGIN
[0m18:27:02.811180 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: BEGIN
[0m18:27:02.811536 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:27:02.811947 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:27:02.812241 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m18:27:02.812650 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m18:27:02.812955 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: BEGIN
[0m18:27:02.813258 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: BEGIN
[0m18:27:02.813571 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:27:02.813877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:02.828411 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m18:27:02.828787 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m18:27:02.829063 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m18:27:02.829285 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m18:27:02.829468 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m18:27:02.830185 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m18:27:02.830527 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m18:27:02.830838 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m18:27:02.831165 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "dev"."main"."stg_yellow_trips"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m18:27:02.831494 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_yellow_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:27:02.831864 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select dropoff_location_id as from_field
    from "dev"."main"."stg_yellow_trips"
    where dropoff_location_id is not null
),

parent as (
    select location_id as to_field
    from "dev"."main"."stg_taxi_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m18:27:02.832278 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select pickup_location_id as from_field
    from "dev"."main"."stg_yellow_trips"
    where pickup_location_id is not null
),

parent as (
    select location_id as to_field
    from "dev"."main"."stg_taxi_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m18:27:02.833453 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:27:02.838274 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: ROLLBACK
[0m18:27:02.840362 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57'
[0m18:27:02.841031 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: Close
[0m18:27:02.843849 [info ] [Thread-3 (]: 52 of 91 PASS not_null_stg_yellow_trips_vendor_id .............................. [[32mPASS[0m in 0.06s]
[0m18:27:02.847167 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m18:27:02.937867 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m18:27:02.940182 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: ROLLBACK
[0m18:27:02.940616 [debug] [Thread-2 (]: SQL status: OK in 0.107 seconds
[0m18:27:02.941181 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f'
[0m18:27:02.942342 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: ROLLBACK
[0m18:27:02.942569 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: Close
[0m18:27:02.943320 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a'
[0m18:27:02.944140 [info ] [Thread-1 (]: 55 of 91 PASS relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_  [[32mPASS[0m in 0.16s]
[0m18:27:02.944474 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: Close
[0m18:27:02.945439 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m18:27:02.947114 [info ] [Thread-2 (]: 54 of 91 PASS relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_  [[32mPASS[0m in 0.16s]
[0m18:27:02.948307 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m18:27:02.983582 [debug] [Thread-4 (]: SQL status: OK in 0.151 seconds
[0m18:27:02.984892 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: ROLLBACK
[0m18:27:02.985578 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965'
[0m18:27:02.986038 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: Close
[0m18:27:03.005487 [info ] [Thread-4 (]: 53 of 91 PASS unique_stg_yellow_trips_trip_id .................................. [[32mPASS[0m in 0.22s]
[0m18:27:03.006331 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m18:27:03.007115 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m18:27:03.007618 [info ] [Thread-3 (]: 56 of 91 START sql view model main.int_trip_metrics ............................ [RUN]
[0m18:27:03.008077 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57, now model.nyc_taxi_pipeline_00.int_trip_metrics)
[0m18:27:03.008435 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m18:27:03.071264 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m18:27:03.079415 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m18:27:03.081903 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m18:27:03.089407 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m18:27:03.089939 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: BEGIN
[0m18:27:03.090499 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:27:03.107658 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m18:27:03.108135 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m18:27:03.108539 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */

  
  create view "dev"."main"."int_trip_metrics__dbt_tmp" as (
    /*
    Intermediate model: Trip-level enrichment with calculated metrics.
    Uses adapter-dispatched macros for cross-dialect compatibility.
*/

with trips as (
    select * from "dev"."main"."stg_yellow_trips"
),

enriched as (
    select
        trip_id,
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        payment_type_id,
        pickup_datetime,
        dropoff_datetime,
        passenger_count,
        trip_distance_miles,
        store_and_fwd_flag,

        -- calculated: duration in minutes
        
    datediff('minute', pickup_datetime, dropoff_datetime)
 as trip_duration_minutes,

        -- calculated: average speed (avoid division by zero)
        case
            when 
    datediff('minute', pickup_datetime, dropoff_datetime)
 > 0
            then round(
                trip_distance_miles / (
    datediff('minute', pickup_datetime, dropoff_datetime)
 / 60.0),
                2
            )
            else null
        end as avg_speed_mph,

        -- calculated: cost per mile
        case
            when trip_distance_miles > 0
            then round(fare_amount / trip_distance_miles, 2)
            else null
        end as cost_per_mile,

        -- calculated: tip percentage
        case
            when fare_amount > 0
            then round((tip_amount / fare_amount) * 100, 2)
            else null
        end as tip_percentage,

        -- time dimensions (using adapter-dispatched macros)
        date_trunc('day', pickup_datetime)::date as pickup_date,
        extract(hour from pickup_datetime) as pickup_hour,
        
    dayname(pickup_datetime)
 as pickup_day_of_week,
        case
            when extract(dow from pickup_datetime) in (0, 6) then true
            else false
        end as is_weekend,

        -- financials passthrough
        fare_amount,
        extra_amount,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount,
        congestion_surcharge,
        airport_fee

    from trips
)

select *
from enriched
where trip_duration_minutes between 1 and 720
  and (avg_speed_mph is null or avg_speed_mph < 100)
  );

[0m18:27:03.110270 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:27:03.112541 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m18:27:03.112892 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
alter view "dev"."main"."int_trip_metrics" rename to "int_trip_metrics__dbt_backup"
[0m18:27:03.113618 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:27:03.115539 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m18:27:03.116242 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
alter view "dev"."main"."int_trip_metrics__dbt_tmp" rename to "int_trip_metrics"
[0m18:27:03.116834 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:27:03.117881 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: COMMIT
[0m18:27:03.118341 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m18:27:03.118807 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: COMMIT
[0m18:27:03.124360 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m18:27:03.125892 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m18:27:03.126395 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
drop view if exists "dev"."main"."int_trip_metrics__dbt_backup" cascade
[0m18:27:03.129279 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:27:03.130462 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: Close
[0m18:27:03.165975 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9349b72-bc74-4683-b4a2-2948217f647e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6acc1fe1b0>]}
[0m18:27:03.166954 [info ] [Thread-3 (]: 56 of 91 OK created sql view model main.int_trip_metrics ....................... [[32mOK[0m in 0.16s]
[0m18:27:03.167594 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m18:27:03.170062 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m18:27:03.170343 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m18:27:03.170584 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m18:27:03.170790 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m18:27:03.171134 [info ] [Thread-2 (]: 57 of 91 START test assert_trip_duration_positive .............................. [RUN]
[0m18:27:03.171616 [info ] [Thread-4 (]: 58 of 91 START test dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0  [RUN]
[0m18:27:03.172274 [info ] [Thread-1 (]: 59 of 91 START test dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1  [RUN]
[0m18:27:03.172831 [info ] [Thread-3 (]: 60 of 91 START test not_null_int_trip_metrics_is_weekend ....................... [RUN]
[0m18:27:03.173400 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a, now test.nyc_taxi_pipeline_00.assert_trip_duration_positive)
[0m18:27:03.173891 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574)
[0m18:27:03.174656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718)
[0m18:27:03.175675 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_trip_metrics, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed)
[0m18:27:03.176024 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m18:27:03.176338 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m18:27:03.176690 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m18:27:03.177020 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m18:27:03.179460 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m18:27:03.184750 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m18:27:03.187738 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m18:27:03.189851 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m18:27:03.194057 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m18:27:03.196393 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m18:27:03.196738 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m18:27:03.198992 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m18:27:03.199262 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m18:27:03.200836 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m18:27:03.201128 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m18:27:03.202624 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m18:27:03.203467 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m18:27:03.203852 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: BEGIN
[0m18:27:03.204220 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:27:03.204508 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m18:27:03.205080 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: BEGIN
[0m18:27:03.205402 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m18:27:03.205679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:03.206090 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m18:27:03.206407 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: BEGIN
[0m18:27:03.207088 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: BEGIN
[0m18:27:03.207604 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:27:03.207992 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:27:03.222123 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m18:27:03.222549 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m18:27:03.222961 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m18:27:03.223220 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m18:27:03.223448 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m18:27:03.223868 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m18:27:03.224282 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_trip_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not trip_duration_minutes >= 1
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not trip_duration_minutes <= 720
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m18:27:03.224712 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m18:27:03.225135 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m18:27:03.225518 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
    Singular test: No trip should have negative duration.
*/

select
    trip_id,
    pickup_datetime,
    dropoff_datetime,
    trip_duration_minutes
from "dev"."main"."int_trip_metrics"
where trip_duration_minutes < 0
  
  
      
    ) dbt_internal_test
[0m18:27:03.226306 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_trip_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m18:27:03.226757 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."int_trip_metrics"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m18:27:03.228890 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:27:03.229239 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:27:03.231630 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: ROLLBACK
[0m18:27:03.233132 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: ROLLBACK
[0m18:27:03.234088 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed'
[0m18:27:03.235827 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.assert_trip_duration_positive'
[0m18:27:03.238349 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: Close
[0m18:27:03.239722 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: Close
[0m18:27:03.242056 [info ] [Thread-3 (]: 60 of 91 PASS not_null_int_trip_metrics_is_weekend ............................. [[32mPASS[0m in 0.07s]
[0m18:27:03.243223 [info ] [Thread-2 (]: 57 of 91 PASS assert_trip_duration_positive .................................... [[32mPASS[0m in 0.07s]
[0m18:27:03.244517 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m18:27:03.247447 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m18:27:03.250089 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m18:27:03.251464 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m18:27:03.252640 [info ] [Thread-3 (]: 61 of 91 START test not_null_int_trip_metrics_pickup_date ...................... [RUN]
[0m18:27:03.255495 [info ] [Thread-2 (]: 62 of 91 START test not_null_int_trip_metrics_pickup_hour ...................... [RUN]
[0m18:27:03.257786 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3)
[0m18:27:03.260250 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.assert_trip_duration_positive, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082)
[0m18:27:03.261201 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m18:27:03.263488 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m18:27:03.268674 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m18:27:03.273493 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m18:27:03.278159 [debug] [Thread-4 (]: SQL status: OK in 0.051 seconds
[0m18:27:03.280393 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: ROLLBACK
[0m18:27:03.280785 [debug] [Thread-1 (]: SQL status: OK in 0.055 seconds
[0m18:27:03.281436 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574'
[0m18:27:03.282378 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: ROLLBACK
[0m18:27:03.282579 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: Close
[0m18:27:03.283187 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718'
[0m18:27:03.283788 [info ] [Thread-4 (]: 58 of 91 PASS dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0 ..... [[32mPASS[0m in 0.11s]
[0m18:27:03.284040 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: Close
[0m18:27:03.284742 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m18:27:03.285096 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m18:27:03.285938 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m18:27:03.287812 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m18:27:03.288161 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m18:27:03.288434 [info ] [Thread-4 (]: 63 of 91 START test not_null_int_trip_metrics_trip_duration_minutes ............ [RUN]
[0m18:27:03.290763 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m18:27:03.291242 [info ] [Thread-1 (]: 59 of 91 PASS dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1  [[32mPASS[0m in 0.12s]
[0m18:27:03.291588 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c)
[0m18:27:03.292460 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m18:27:03.292843 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m18:27:03.293308 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m18:27:03.296487 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m18:27:03.297038 [info ] [Thread-1 (]: 64 of 91 START test not_null_int_trip_metrics_trip_id .......................... [RUN]
[0m18:27:03.297938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f)
[0m18:27:03.298326 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m18:27:03.298574 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m18:27:03.299025 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: BEGIN
[0m18:27:03.302903 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m18:27:03.303457 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m18:27:03.303815 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:27:03.304487 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: BEGIN
[0m18:27:03.305196 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:27:03.307408 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m18:27:03.309644 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m18:27:03.309963 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m18:27:03.311616 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m18:27:03.314421 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m18:27:03.314765 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: BEGIN
[0m18:27:03.315017 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m18:27:03.315238 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:27:03.315595 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: BEGIN
[0m18:27:03.316072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:03.326290 [debug] [Thread-2 (]: SQL status: OK in 0.021 seconds
[0m18:27:03.326607 [debug] [Thread-3 (]: SQL status: OK in 0.023 seconds
[0m18:27:03.326899 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m18:27:03.327114 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m18:27:03.327350 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m18:27:03.327842 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m18:27:03.328351 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."int_trip_metrics"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m18:27:03.328749 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m18:27:03.329138 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m18:27:03.329464 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_trip_metrics"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m18:27:03.330015 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."int_trip_metrics"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m18:27:03.330351 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_duration_minutes
from "dev"."main"."int_trip_metrics"
where trip_duration_minutes is null



  
  
      
    ) dbt_internal_test
[0m18:27:03.331323 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:27:03.332815 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: ROLLBACK
[0m18:27:03.333482 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:27:03.333846 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:27:03.335298 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082'
[0m18:27:03.337535 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: ROLLBACK
[0m18:27:03.339163 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: ROLLBACK
[0m18:27:03.339826 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: Close
[0m18:27:03.340868 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f'
[0m18:27:03.342928 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3'
[0m18:27:03.345202 [info ] [Thread-2 (]: 62 of 91 PASS not_null_int_trip_metrics_pickup_hour ............................ [[32mPASS[0m in 0.09s]
[0m18:27:03.346467 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: Close
[0m18:27:03.347999 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: Close
[0m18:27:03.351589 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m18:27:03.353525 [info ] [Thread-1 (]: 64 of 91 PASS not_null_int_trip_metrics_trip_id ................................ [[32mPASS[0m in 0.06s]
[0m18:27:03.355837 [info ] [Thread-3 (]: 61 of 91 PASS not_null_int_trip_metrics_pickup_date ............................ [[32mPASS[0m in 0.10s]
[0m18:27:03.358858 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m18:27:03.361664 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m18:27:03.383737 [debug] [Thread-4 (]: SQL status: OK in 0.052 seconds
[0m18:27:03.385162 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: ROLLBACK
[0m18:27:03.385851 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c'
[0m18:27:03.386187 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: Close
[0m18:27:03.390542 [info ] [Thread-4 (]: 63 of 91 PASS not_null_int_trip_metrics_trip_duration_minutes .................. [[32mPASS[0m in 0.10s]
[0m18:27:03.391210 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m18:27:03.392293 [debug] [Thread-2 (]: Began running node model.nyc_taxi_pipeline_00.int_daily_summary
[0m18:27:03.392566 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m18:27:03.392822 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.fct_trips
[0m18:27:03.393111 [info ] [Thread-2 (]: 65 of 91 START sql view model main.int_daily_summary ........................... [RUN]
[0m18:27:03.393540 [info ] [Thread-1 (]: 66 of 91 START sql view model main.int_hourly_patterns ......................... [RUN]
[0m18:27:03.393976 [info ] [Thread-3 (]: 67 of 91 START sql incremental model main.fct_trips ............................ [RUN]
[0m18:27:03.394456 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082, now model.nyc_taxi_pipeline_00.int_daily_summary)
[0m18:27:03.394847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f, now model.nyc_taxi_pipeline_00.int_hourly_patterns)
[0m18:27:03.395208 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3, now model.nyc_taxi_pipeline_00.fct_trips)
[0m18:27:03.395604 [debug] [Thread-2 (]: Began compiling node model.nyc_taxi_pipeline_00.int_daily_summary
[0m18:27:03.396192 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m18:27:03.396876 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.fct_trips
[0m18:27:03.399385 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m18:27:03.401175 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m18:27:03.406001 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.fct_trips"
[0m18:27:03.410726 [debug] [Thread-2 (]: Began executing node model.nyc_taxi_pipeline_00.int_daily_summary
[0m18:27:03.411019 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m18:27:03.413565 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m18:27:03.415818 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m18:27:03.416854 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.fct_trips
[0m18:27:03.437092 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m18:27:03.437734 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
DESCRIBE (select * from (
        /*
    Fact table: Fully enriched trip records with location names.
    Incremental with delete+insert strategy.
*/



with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

pickup_locations as (
    select * from "dev"."main"."dim_locations"
),

dropoff_locations as (
    select * from "dev"."main"."dim_locations"
),

final as (
    select
        t.trip_id,
        t.vendor_id,
        t.rate_code_id,
        t.payment_type_id,
        t.pickup_location_id,
        t.dropoff_location_id,
        t.pickup_datetime,
        t.dropoff_datetime,
        t.pickup_date,
        t.pickup_hour,
        t.pickup_day_of_week,
        t.is_weekend,
        t.passenger_count,
        t.trip_distance_miles,
        t.trip_duration_minutes,
        t.avg_speed_mph,
        t.cost_per_mile,
        t.fare_amount,
        t.extra_amount,
        t.mta_tax,
        t.tip_amount,
        t.tip_percentage,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.congestion_surcharge,
        t.airport_fee,

        -- enriched from dimensions
        pu.borough as pickup_borough,
        pu.zone_name as pickup_zone,
        do_loc.borough as dropoff_borough,
        do_loc.zone_name as dropoff_zone

    from trip_metrics t
    left join pickup_locations pu
        on t.pickup_location_id = pu.location_id
    left join dropoff_locations do_loc
        on t.dropoff_location_id = do_loc.location_id

    
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:27:03.438252 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:27:03.438595 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m18:27:03.439098 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m18:27:03.439365 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: BEGIN
[0m18:27:03.439742 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: BEGIN
[0m18:27:03.440098 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:27:03.440459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:03.456982 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m18:27:03.457314 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m18:27:03.457565 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m18:27:03.457897 [debug] [Thread-3 (]: SQL status: OK in 0.020 seconds
[0m18:27:03.458103 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m18:27:03.458494 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */

  
  create view "dev"."main"."int_daily_summary__dbt_tmp" as (
    /*
    Intermediate model: Daily aggregated trip and revenue metrics.
    One row per day with counts, averages, and revenue totals.
*/

with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

daily_agg as (
    select
        pickup_date,
        pickup_day_of_week,
        is_weekend,

        count(*) as total_trips,
        sum(passenger_count) as total_passengers,

        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(avg(avg_speed_mph), 2) as avg_speed_mph,

        round(sum(fare_amount), 2) as total_fare_revenue,
        round(sum(tip_amount), 2) as total_tip_revenue,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_trip_revenue,
        round(avg(tip_percentage), 2) as avg_tip_percentage,

        count(case when payment_type_id = 1 then 1 end) as credit_card_trips,
        count(case when payment_type_id = 2 then 1 end) as cash_trips

    from trip_metrics
    group by pickup_date, pickup_day_of_week, is_weekend
)

select * from daily_agg
  );

[0m18:27:03.460757 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m18:27:03.461002 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */

  
  create view "dev"."main"."int_hourly_patterns__dbt_tmp" as (
    /*
    Intermediate model: Hourly trip patterns by date.
    One row per date + hour combination.
*/

with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

hourly_agg as (
    select
        pickup_date,
        pickup_hour,
        pickup_day_of_week,
        is_weekend,

        count(*) as total_trips,
        round(avg(trip_distance_miles), 2) as avg_distance,
        round(avg(trip_duration_minutes), 2) as avg_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue

    from trip_metrics
    group by pickup_date, pickup_hour, pickup_day_of_week, is_weekend
)

select * from hourly_agg
  );

[0m18:27:03.461711 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as varchar)
 as trip_id, 
      
    cast(null as integer)
 as vendor_id, 
      
    cast(null as integer)
 as rate_code_id, 
      
    cast(null as integer)
 as payment_type_id, 
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as integer)
 as dropoff_location_id, 
      
    cast(null as timestamp)
 as pickup_datetime, 
      
    cast(null as timestamp)
 as dropoff_datetime, 
      
    cast(null as date)
 as pickup_date, 
      
    cast(null as bigint)
 as pickup_hour, 
      
    cast(null as varchar)
 as pickup_day_of_week, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as integer)
 as passenger_count, 
      
    cast(null as double)
 as trip_distance_miles, 
      
    cast(null as bigint)
 as trip_duration_minutes, 
      
    cast(null as double)
 as avg_speed_mph, 
      
    cast(null as double)
 as cost_per_mile, 
      
    cast(null as decimal(10,2))
 as fare_amount, 
      
    cast(null as decimal(10,2))
 as extra_amount, 
      
    cast(null as decimal(10,2))
 as mta_tax, 
      
    cast(null as decimal(10,2))
 as tip_amount, 
      
    cast(null as double)
 as tip_percentage, 
      
    cast(null as decimal(10,2))
 as tolls_amount, 
      
    cast(null as decimal(10,2))
 as improvement_surcharge, 
      
    cast(null as decimal(10,2))
 as total_amount, 
      
    cast(null as decimal(10,2))
 as congestion_surcharge, 
      
    cast(null as decimal(10,2))
 as airport_fee, 
      
    cast(null as varchar)
 as pickup_borough, 
      
    cast(null as varchar)
 as pickup_zone, 
      
    cast(null as varchar)
 as dropoff_borough, 
      
    cast(null as varchar)
 as dropoff_zone
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:27:03.462636 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:27:03.462874 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:27:03.465007 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m18:27:03.465348 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:27:03.467640 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.fct_trips"
[0m18:27:03.467923 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
alter view "dev"."main"."int_daily_summary" rename to "int_daily_summary__dbt_backup"
[0m18:27:03.469966 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m18:27:03.470808 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
alter view "dev"."main"."int_hourly_patterns" rename to "int_hourly_patterns__dbt_backup"
[0m18:27:03.471055 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:27:03.472922 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m18:27:03.473464 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:27:03.473906 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
alter view "dev"."main"."int_daily_summary__dbt_tmp" rename to "int_daily_summary"
[0m18:27:03.476346 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m18:27:03.476990 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
alter view "dev"."main"."int_hourly_patterns__dbt_tmp" rename to "int_hourly_patterns"
[0m18:27:03.477286 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:27:03.478458 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: COMMIT
[0m18:27:03.478810 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:27:03.479090 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m18:27:03.480126 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: COMMIT
[0m18:27:03.480376 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m18:27:03.480562 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: COMMIT
[0m18:27:03.480889 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m18:27:03.481244 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.fct_trips: BEGIN
[0m18:27:03.481781 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: COMMIT
[0m18:27:03.482462 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:27:03.482812 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m18:27:03.483243 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */

  
    
    
      
    

    create  table
      "dev"."main"."fct_trips__dbt_tmp"
  
  (
    trip_id varchar,
    vendor_id integer,
    rate_code_id integer,
    payment_type_id integer,
    pickup_location_id integer,
    dropoff_location_id integer,
    pickup_datetime timestamp,
    dropoff_datetime timestamp,
    pickup_date date,
    pickup_hour bigint,
    pickup_day_of_week varchar,
    is_weekend boolean,
    passenger_count integer,
    trip_distance_miles double,
    trip_duration_minutes bigint,
    avg_speed_mph double,
    cost_per_mile double,
    fare_amount decimal(10,2),
    extra_amount decimal(10,2),
    mta_tax decimal(10,2),
    tip_amount decimal(10,2),
    tip_percentage double,
    tolls_amount decimal(10,2),
    improvement_surcharge decimal(10,2),
    total_amount decimal(10,2),
    congestion_surcharge decimal(10,2),
    airport_fee decimal(10,2),
    pickup_borough varchar,
    pickup_zone varchar,
    dropoff_borough varchar,
    dropoff_zone varchar
    
    )
 ;
    insert into "dev"."main"."fct_trips__dbt_tmp" 
  (
    
      
      trip_id ,
    
      
      vendor_id ,
    
      
      rate_code_id ,
    
      
      payment_type_id ,
    
      
      pickup_location_id ,
    
      
      dropoff_location_id ,
    
      
      pickup_datetime ,
    
      
      dropoff_datetime ,
    
      
      pickup_date ,
    
      
      pickup_hour ,
    
      
      pickup_day_of_week ,
    
      
      is_weekend ,
    
      
      passenger_count ,
    
      
      trip_distance_miles ,
    
      
      trip_duration_minutes ,
    
      
      avg_speed_mph ,
    
      
      cost_per_mile ,
    
      
      fare_amount ,
    
      
      extra_amount ,
    
      
      mta_tax ,
    
      
      tip_amount ,
    
      
      tip_percentage ,
    
      
      tolls_amount ,
    
      
      improvement_surcharge ,
    
      
      total_amount ,
    
      
      congestion_surcharge ,
    
      
      airport_fee ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      dropoff_borough ,
    
      
      dropoff_zone 
    
  )
 (
      
    select trip_id, vendor_id, rate_code_id, payment_type_id, pickup_location_id, dropoff_location_id, pickup_datetime, dropoff_datetime, pickup_date, pickup_hour, pickup_day_of_week, is_weekend, passenger_count, trip_distance_miles, trip_duration_minutes, avg_speed_mph, cost_per_mile, fare_amount, extra_amount, mta_tax, tip_amount, tip_percentage, tolls_amount, improvement_surcharge, total_amount, congestion_surcharge, airport_fee, pickup_borough, pickup_zone, dropoff_borough, dropoff_zone
    from (
        /*
    Fact table: Fully enriched trip records with location names.
    Incremental with delete+insert strategy.
*/



with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

pickup_locations as (
    select * from "dev"."main"."dim_locations"
),

dropoff_locations as (
    select * from "dev"."main"."dim_locations"
),

final as (
    select
        t.trip_id,
        t.vendor_id,
        t.rate_code_id,
        t.payment_type_id,
        t.pickup_location_id,
        t.dropoff_location_id,
        t.pickup_datetime,
        t.dropoff_datetime,
        t.pickup_date,
        t.pickup_hour,
        t.pickup_day_of_week,
        t.is_weekend,
        t.passenger_count,
        t.trip_distance_miles,
        t.trip_duration_minutes,
        t.avg_speed_mph,
        t.cost_per_mile,
        t.fare_amount,
        t.extra_amount,
        t.mta_tax,
        t.tip_amount,
        t.tip_percentage,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.congestion_surcharge,
        t.airport_fee,

        -- enriched from dimensions
        pu.borough as pickup_borough,
        pu.zone_name as pickup_zone,
        do_loc.borough as dropoff_borough,
        do_loc.zone_name as dropoff_zone

    from trip_metrics t
    left join pickup_locations pu
        on t.pickup_location_id = pu.location_id
    left join dropoff_locations do_loc
        on t.dropoff_location_id = do_loc.location_id

    
)

select * from final
    ) as model_subq
    );
  
  
  
[0m18:27:03.486176 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m18:27:03.488001 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m18:27:03.490427 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
drop view if exists "dev"."main"."int_daily_summary__dbt_backup" cascade
[0m18:27:03.491957 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m18:27:03.496570 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m18:27:03.497525 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
drop view if exists "dev"."main"."int_hourly_patterns__dbt_backup" cascade
[0m18:27:03.501242 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m18:27:03.504484 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: Close
[0m18:27:03.505723 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9349b72-bc74-4683-b4a2-2948217f647e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6acc0099d0>]}
[0m18:27:03.507627 [info ] [Thread-2 (]: 65 of 91 OK created sql view model main.int_daily_summary ...................... [[32mOK[0m in 0.11s]
[0m18:27:03.510079 [debug] [Thread-2 (]: Finished running node model.nyc_taxi_pipeline_00.int_daily_summary
[0m18:27:03.510654 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m18:27:03.512396 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m18:27:03.512620 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m18:27:03.513640 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: Close
[0m18:27:03.515499 [info ] [Thread-4 (]: 68 of 91 START test dbt_utils_accepted_range_int_daily_summary_total_trips__0 .. [RUN]
[0m18:27:03.517636 [info ] [Thread-2 (]: 69 of 91 START test not_null_int_daily_summary_pickup_date ..................... [RUN]
[0m18:27:03.519488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9349b72-bc74-4683-b4a2-2948217f647e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6adc0eda90>]}
[0m18:27:03.521408 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863)
[0m18:27:03.523498 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_daily_summary, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686)
[0m18:27:03.525519 [info ] [Thread-1 (]: 66 of 91 OK created sql view model main.int_hourly_patterns .................... [[32mOK[0m in 0.12s]
[0m18:27:03.527493 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m18:27:03.529146 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m18:27:03.531060 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m18:27:03.535789 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m18:27:03.539042 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m18:27:03.540855 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m18:27:03.545403 [info ] [Thread-1 (]: 70 of 91 START test not_null_int_daily_summary_total_revenue ................... [RUN]
[0m18:27:03.547669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_hourly_patterns, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50)
[0m18:27:03.549471 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m18:27:03.554007 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m18:27:03.573918 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m18:27:03.577779 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m18:27:03.578269 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m18:27:03.581660 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m18:27:03.582211 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m18:27:03.586097 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m18:27:03.590311 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m18:27:03.590824 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m18:27:03.591140 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: BEGIN
[0m18:27:03.591643 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: BEGIN
[0m18:27:03.592091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:03.592481 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m18:27:03.598470 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:27:03.599736 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m18:27:03.600184 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: BEGIN
[0m18:27:03.601530 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:27:03.603693 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m18:27:03.603195 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:27:03.602185 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m18:27:03.606548 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_daily_summary"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m18:27:03.607418 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m18:27:03.610726 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "dev"."main"."int_daily_summary"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m18:27:03.615687 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m18:27:03.620871 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_daily_summary"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_trips >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m18:27:03.617507 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m18:27:03.623369 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: ROLLBACK
[0m18:27:03.627083 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686'
[0m18:27:03.631298 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: Close
[0m18:27:03.633637 [info ] [Thread-2 (]: 69 of 91 PASS not_null_int_daily_summary_pickup_date ........................... [[32mPASS[0m in 0.11s]
[0m18:27:03.639126 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m18:27:03.642794 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m18:27:03.643650 [info ] [Thread-2 (]: 71 of 91 START test not_null_int_daily_summary_total_trips ..................... [RUN]
[0m18:27:03.644884 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10)
[0m18:27:03.646607 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m18:27:03.660074 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m18:27:03.712365 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m18:27:03.715797 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m18:27:03.783262 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m18:27:03.793870 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: BEGIN
[0m18:27:03.796069 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:27:03.798848 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:27:03.800559 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m18:27:03.801573 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_trips
from "dev"."main"."int_daily_summary"
where total_trips is null



  
  
      
    ) dbt_internal_test
[0m18:27:03.933890 [debug] [Thread-4 (]: SQL status: OK in 0.312 seconds
[0m18:27:03.935700 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: ROLLBACK
[0m18:27:03.936607 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863'
[0m18:27:03.937069 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: Close
[0m18:27:03.937713 [info ] [Thread-4 (]: 68 of 91 PASS dbt_utils_accepted_range_int_daily_summary_total_trips__0 ........ [[32mPASS[0m in 0.42s]
[0m18:27:03.938263 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m18:27:03.938746 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m18:27:03.939194 [info ] [Thread-4 (]: 72 of 91 START test unique_int_daily_summary_pickup_date ....................... [RUN]
[0m18:27:03.939807 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863, now test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e)
[0m18:27:03.940371 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m18:27:03.943664 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m18:27:03.953948 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m18:27:03.957867 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m18:27:03.970161 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m18:27:03.970734 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: BEGIN
[0m18:27:03.971147 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:27:03.971956 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:27:03.972410 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m18:27:03.972840 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pickup_date as unique_field,
    count(*) as n_records

from "dev"."main"."int_daily_summary"
where pickup_date is not null
group by pickup_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:27:04.033657 [debug] [Thread-2 (]: SQL status: OK in 0.231 seconds
[0m18:27:04.035106 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: ROLLBACK
[0m18:27:04.035958 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10'
[0m18:27:04.036532 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: Close
[0m18:27:04.037417 [info ] [Thread-2 (]: 71 of 91 PASS not_null_int_daily_summary_total_trips ........................... [[32mPASS[0m in 0.39s]
[0m18:27:04.037996 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m18:27:04.038414 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m18:27:04.038868 [info ] [Thread-2 (]: 73 of 91 START test dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0  [RUN]
[0m18:27:04.039402 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe)
[0m18:27:04.040045 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m18:27:04.043575 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m18:27:04.052163 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m18:27:04.054203 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m18:27:04.062047 [debug] [Thread-1 (]: SQL status: OK in 0.442 seconds
[0m18:27:04.063514 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: ROLLBACK
[0m18:27:04.063845 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m18:27:04.064469 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50'
[0m18:27:04.064703 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: BEGIN
[0m18:27:04.065100 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: Close
[0m18:27:04.065412 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:27:04.065964 [info ] [Thread-1 (]: 70 of 91 PASS not_null_int_daily_summary_total_revenue ......................... [[32mPASS[0m in 0.52s]
[0m18:27:04.066647 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:27:04.066998 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m18:27:04.067372 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m18:27:04.067804 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m18:27:04.068211 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_hourly_patterns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m18:27:04.068728 [info ] [Thread-1 (]: 74 of 91 START test not_null_int_hourly_patterns_pickup_date ................... [RUN]
[0m18:27:04.069611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2)
[0m18:27:04.069966 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m18:27:04.073228 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m18:27:04.083413 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m18:27:04.085635 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m18:27:04.087832 [debug] [Thread-2 (]: SQL status: OK in 0.019 seconds
[0m18:27:04.089106 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: ROLLBACK
[0m18:27:04.089856 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe'
[0m18:27:04.090251 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: Close
[0m18:27:04.090953 [info ] [Thread-2 (]: 73 of 91 PASS dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0 .. [[32mPASS[0m in 0.05s]
[0m18:27:04.091600 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m18:27:04.092037 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m18:27:04.092428 [info ] [Thread-2 (]: 75 of 91 START test not_null_int_hourly_patterns_pickup_hour ................... [RUN]
[0m18:27:04.092923 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d)
[0m18:27:04.093573 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m18:27:04.096467 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m18:27:04.096787 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m18:27:04.097333 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: BEGIN
[0m18:27:04.097702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:04.098377 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:27:04.098719 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m18:27:04.099152 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_hourly_patterns"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m18:27:04.101150 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:27:04.102370 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: ROLLBACK
[0m18:27:04.103125 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2'
[0m18:27:04.103593 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: Close
[0m18:27:04.104547 [info ] [Thread-1 (]: 74 of 91 PASS not_null_int_hourly_patterns_pickup_date ......................... [[32mPASS[0m in 0.03s]
[0m18:27:04.105234 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m18:27:04.105546 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m18:27:04.105840 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m18:27:04.108064 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m18:27:04.108603 [info ] [Thread-1 (]: 76 of 91 START test not_null_int_hourly_patterns_total_trips ................... [RUN]
[0m18:27:04.109430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf)
[0m18:27:04.109809 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m18:27:04.112794 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m18:27:04.117277 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m18:27:04.117658 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: BEGIN
[0m18:27:04.118052 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:27:04.118854 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:27:04.119236 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m18:27:04.120015 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."int_hourly_patterns"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m18:27:04.120610 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m18:27:04.122248 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m18:27:04.122760 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:27:04.123879 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: ROLLBACK
[0m18:27:04.124552 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d'
[0m18:27:04.124995 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: Close
[0m18:27:04.125511 [info ] [Thread-2 (]: 75 of 91 PASS not_null_int_hourly_patterns_pickup_hour ......................... [[32mPASS[0m in 0.03s]
[0m18:27:04.126145 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m18:27:04.129684 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m18:27:04.130143 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: BEGIN
[0m18:27:04.130479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:04.131103 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:27:04.131474 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m18:27:04.131843 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_trips
from "dev"."main"."int_hourly_patterns"
where total_trips is null



  
  
      
    ) dbt_internal_test
[0m18:27:04.135119 [debug] [Thread-4 (]: SQL status: OK in 0.162 seconds
[0m18:27:04.136362 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: ROLLBACK
[0m18:27:04.137552 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e'
[0m18:27:04.138214 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: Close
[0m18:27:04.138902 [info ] [Thread-4 (]: 72 of 91 PASS unique_int_daily_summary_pickup_date ............................. [[32mPASS[0m in 0.20s]
[0m18:27:04.139423 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m18:27:04.140175 [debug] [Thread-2 (]: Began running node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m18:27:04.140757 [info ] [Thread-2 (]: 77 of 91 START sql table model main.mart_daily_revenue ......................... [RUN]
[0m18:27:04.141271 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d, now model.nyc_taxi_pipeline_00.mart_daily_revenue)
[0m18:27:04.141655 [debug] [Thread-2 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m18:27:04.145176 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m18:27:04.153026 [debug] [Thread-2 (]: Began executing node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m18:27:04.156060 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m18:27:04.156582 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Daily revenue metrics with running totals.
*/

with daily as (
    select * from "dev"."main"."int_daily_summary"
),

dates as (
    select * from "dev"."main"."dim_dates"
),

final as (
    select
        d.date_key,
        d.day_of_week_name,
        d.is_weekend,
        d.is_holiday,
        d.week_of_year,

        daily.total_trips,
        daily.total_passengers,
        daily.total_fare_revenue,
        daily.total_tip_revenue,
        daily.total_revenue,
        daily.avg_trip_revenue,
        daily.avg_tip_percentage,
        daily.credit_card_trips,
        daily.cash_trips,
        daily.avg_trip_distance,
        daily.avg_trip_duration_min,

        -- running total
        sum(daily.total_revenue) over (order by d.date_key) as cumulative_revenue,

        -- day-over-day change
        daily.total_revenue - lag(daily.total_revenue) over (order by d.date_key) as revenue_change_vs_prior_day

    from daily
    inner join dates d
        on daily.pickup_date = d.date_key
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:27:04.157073 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:27:04.159559 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:27:04.162054 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m18:27:04.162486 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as date_key, 
      
    cast(null as varchar)
 as day_of_week_name, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as boolean)
 as is_holiday, 
      
    cast(null as bigint)
 as week_of_year, 
      
    cast(null as bigint)
 as total_trips, 
      
    cast(null as hugeint)
 as total_passengers, 
      
    cast(null as decimal(38,2))
 as total_fare_revenue, 
      
    cast(null as decimal(38,2))
 as total_tip_revenue, 
      
    cast(null as decimal(38,2))
 as total_revenue, 
      
    cast(null as double)
 as avg_trip_revenue, 
      
    cast(null as double)
 as avg_tip_percentage, 
      
    cast(null as bigint)
 as credit_card_trips, 
      
    cast(null as bigint)
 as cash_trips, 
      
    cast(null as double)
 as avg_trip_distance, 
      
    cast(null as double)
 as avg_trip_duration_min, 
      
    cast(null as decimal(38,2))
 as cumulative_revenue, 
      
    cast(null as decimal(38,2))
 as revenue_change_vs_prior_day
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:27:04.163313 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:27:04.165141 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m18:27:04.173833 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m18:27:04.174308 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: BEGIN
[0m18:27:04.174883 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:27:04.175209 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m18:27:04.175682 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_daily_revenue__dbt_tmp"
  
  (
    date_key date,
    day_of_week_name varchar,
    is_weekend boolean,
    is_holiday boolean,
    week_of_year bigint,
    total_trips bigint,
    total_passengers hugeint,
    total_fare_revenue decimal(38,2),
    total_tip_revenue decimal(38,2),
    total_revenue decimal(38,2),
    avg_trip_revenue double,
    avg_tip_percentage double,
    credit_card_trips bigint,
    cash_trips bigint,
    avg_trip_distance double,
    avg_trip_duration_min double,
    cumulative_revenue decimal(38,2),
    revenue_change_vs_prior_day decimal(38,2)
    
    )
 ;
    insert into "dev"."main"."mart_daily_revenue__dbt_tmp" 
  (
    
      
      date_key ,
    
      
      day_of_week_name ,
    
      
      is_weekend ,
    
      
      is_holiday ,
    
      
      week_of_year ,
    
      
      total_trips ,
    
      
      total_passengers ,
    
      
      total_fare_revenue ,
    
      
      total_tip_revenue ,
    
      
      total_revenue ,
    
      
      avg_trip_revenue ,
    
      
      avg_tip_percentage ,
    
      
      credit_card_trips ,
    
      
      cash_trips ,
    
      
      avg_trip_distance ,
    
      
      avg_trip_duration_min ,
    
      
      cumulative_revenue ,
    
      
      revenue_change_vs_prior_day 
    
  )
 (
      
    select date_key, day_of_week_name, is_weekend, is_holiday, week_of_year, total_trips, total_passengers, total_fare_revenue, total_tip_revenue, total_revenue, avg_trip_revenue, avg_tip_percentage, credit_card_trips, cash_trips, avg_trip_distance, avg_trip_duration_min, cumulative_revenue, revenue_change_vs_prior_day
    from (
        /*
    Analytics mart: Daily revenue metrics with running totals.
*/

with daily as (
    select * from "dev"."main"."int_daily_summary"
),

dates as (
    select * from "dev"."main"."dim_dates"
),

final as (
    select
        d.date_key,
        d.day_of_week_name,
        d.is_weekend,
        d.is_holiday,
        d.week_of_year,

        daily.total_trips,
        daily.total_passengers,
        daily.total_fare_revenue,
        daily.total_tip_revenue,
        daily.total_revenue,
        daily.avg_trip_revenue,
        daily.avg_tip_percentage,
        daily.credit_card_trips,
        daily.cash_trips,
        daily.avg_trip_distance,
        daily.avg_trip_duration_min,

        -- running total
        sum(daily.total_revenue) over (order by d.date_key) as cumulative_revenue,

        -- day-over-day change
        daily.total_revenue - lag(daily.total_revenue) over (order by d.date_key) as revenue_change_vs_prior_day

    from daily
    inner join dates d
        on daily.pickup_date = d.date_key
)

select * from final
    ) as model_subq
    );
  
  
[0m18:27:04.246723 [debug] [Thread-1 (]: SQL status: OK in 0.114 seconds
[0m18:27:04.248273 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: ROLLBACK
[0m18:27:04.249095 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf'
[0m18:27:04.249503 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: Close
[0m18:27:04.250287 [info ] [Thread-1 (]: 76 of 91 PASS not_null_int_hourly_patterns_total_trips ......................... [[32mPASS[0m in 0.14s]
[0m18:27:04.250932 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m18:27:04.251937 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m18:27:04.252584 [info ] [Thread-4 (]: 78 of 91 START sql table model main.mart_hourly_demand ......................... [RUN]
[0m18:27:04.253135 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e, now model.nyc_taxi_pipeline_00.mart_hourly_demand)
[0m18:27:04.253632 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m18:27:04.256172 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m18:27:04.263785 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m18:27:04.266163 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m18:27:04.266688 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Hourly demand patterns.
*/

with hourly as (
    select * from "dev"."main"."int_hourly_patterns"
),

final as (
    select
        pickup_hour,
        is_weekend,

        count(*) as days_observed,
        round(avg(total_trips), 0) as avg_trips_per_period,
        round(avg(avg_distance), 2) as avg_distance,
        round(avg(avg_duration_min), 2) as avg_duration_min,
        round(avg(total_revenue), 2) as avg_revenue_per_period,
        sum(total_trips) as total_trips_all_days

    from hourly
    group by pickup_hour, is_weekend
)

select * from final
order by is_weekend, pickup_hour
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:27:04.267416 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:27:04.270050 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:27:04.271808 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m18:27:04.272522 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as bigint)
 as pickup_hour, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as bigint)
 as days_observed, 
      
    cast(null as double)
 as avg_trips_per_period, 
      
    cast(null as double)
 as avg_distance, 
      
    cast(null as double)
 as avg_duration_min, 
      
    cast(null as double)
 as avg_revenue_per_period, 
      
    cast(null as hugeint)
 as total_trips_all_days
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:27:04.273346 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:27:04.274642 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m18:27:04.282466 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m18:27:04.282960 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: BEGIN
[0m18:27:04.283574 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:27:04.283957 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m18:27:04.284945 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_hourly_demand__dbt_tmp"
  
  (
    pickup_hour bigint,
    is_weekend boolean,
    days_observed bigint,
    avg_trips_per_period double,
    avg_distance double,
    avg_duration_min double,
    avg_revenue_per_period double,
    total_trips_all_days hugeint
    
    )
 ;
    insert into "dev"."main"."mart_hourly_demand__dbt_tmp" 
  (
    
      
      pickup_hour ,
    
      
      is_weekend ,
    
      
      days_observed ,
    
      
      avg_trips_per_period ,
    
      
      avg_distance ,
    
      
      avg_duration_min ,
    
      
      avg_revenue_per_period ,
    
      
      total_trips_all_days 
    
  )
 (
      
    select pickup_hour, is_weekend, days_observed, avg_trips_per_period, avg_distance, avg_duration_min, avg_revenue_per_period, total_trips_all_days
    from (
        /*
    Analytics mart: Hourly demand patterns.
*/

with hourly as (
    select * from "dev"."main"."int_hourly_patterns"
),

final as (
    select
        pickup_hour,
        is_weekend,

        count(*) as days_observed,
        round(avg(total_trips), 0) as avg_trips_per_period,
        round(avg(avg_distance), 2) as avg_distance,
        round(avg(avg_duration_min), 2) as avg_duration_min,
        round(avg(total_revenue), 2) as avg_revenue_per_period,
        sum(total_trips) as total_trips_all_days

    from hourly
    group by pickup_hour, is_weekend
)

select * from final
order by is_weekend, pickup_hour
    ) as model_subq
    );
  
  
[0m18:27:04.388417 [debug] [Thread-2 (]: SQL status: OK in 0.212 seconds
[0m18:27:04.391216 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m18:27:04.391747 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
alter table "dev"."main"."mart_daily_revenue" rename to "mart_daily_revenue__dbt_backup"
[0m18:27:04.392674 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:27:04.394953 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m18:27:04.395412 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
alter table "dev"."main"."mart_daily_revenue__dbt_tmp" rename to "mart_daily_revenue"
[0m18:27:04.396326 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:27:04.397515 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: COMMIT
[0m18:27:04.397915 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m18:27:04.398282 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: COMMIT
[0m18:27:04.402669 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m18:27:04.405017 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m18:27:04.405542 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
drop table if exists "dev"."main"."mart_daily_revenue__dbt_backup" cascade
[0m18:27:04.408356 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:27:04.409268 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: Close
[0m18:27:04.409760 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9349b72-bc74-4683-b4a2-2948217f647e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6acc0276e0>]}
[0m18:27:04.410890 [info ] [Thread-2 (]: 77 of 91 OK created sql table model main.mart_daily_revenue .................... [[32mOK[0m in 0.27s]
[0m18:27:04.412003 [debug] [Thread-2 (]: Finished running node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m18:27:04.412844 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m18:27:04.413193 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m18:27:04.413515 [info ] [Thread-1 (]: 79 of 91 START test not_null_mart_daily_revenue_date_key ....................... [RUN]
[0m18:27:04.414023 [info ] [Thread-2 (]: 80 of 91 START test not_null_mart_daily_revenue_total_revenue .................. [RUN]
[0m18:27:04.414554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf, now test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a)
[0m18:27:04.415039 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.mart_daily_revenue, now test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9)
[0m18:27:04.415486 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m18:27:04.415971 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m18:27:04.420148 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m18:27:04.423265 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m18:27:04.428753 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m18:27:04.430422 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m18:27:04.430763 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m18:27:04.432879 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m18:27:04.437060 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m18:27:04.437634 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: BEGIN
[0m18:27:04.438031 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m18:27:04.438336 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:04.438626 [debug] [Thread-4 (]: SQL status: OK in 0.153 seconds
[0m18:27:04.438824 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: BEGIN
[0m18:27:04.439388 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:27:04.441077 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m18:27:04.441413 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:27:04.441788 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m18:27:04.442184 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
alter table "dev"."main"."mart_hourly_demand" rename to "mart_hourly_demand__dbt_backup"
[0m18:27:04.442765 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:27:04.443015 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "dev"."main"."mart_daily_revenue"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m18:27:04.443675 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m18:27:04.443926 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:27:04.444426 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "dev"."main"."mart_daily_revenue"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m18:27:04.444722 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:27:04.446824 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m18:27:04.448122 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: ROLLBACK
[0m18:27:04.448322 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
alter table "dev"."main"."mart_hourly_demand__dbt_tmp" rename to "mart_hourly_demand"
[0m18:27:04.448553 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:27:04.449252 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a'
[0m18:27:04.449893 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:27:04.450764 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: ROLLBACK
[0m18:27:04.450981 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: Close
[0m18:27:04.451812 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: COMMIT
[0m18:27:04.452349 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9'
[0m18:27:04.452693 [info ] [Thread-1 (]: 79 of 91 PASS not_null_mart_daily_revenue_date_key ............................. [[32mPASS[0m in 0.04s]
[0m18:27:04.452915 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m18:27:04.453196 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: Close
[0m18:27:04.453829 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m18:27:04.454257 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: COMMIT
[0m18:27:04.454915 [info ] [Thread-2 (]: 80 of 91 PASS not_null_mart_daily_revenue_total_revenue ........................ [[32mPASS[0m in 0.04s]
[0m18:27:04.455247 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m18:27:04.455863 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m18:27:04.456169 [info ] [Thread-1 (]: 81 of 91 START test unique_mart_daily_revenue_date_key ......................... [RUN]
[0m18:27:04.456884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a, now test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7)
[0m18:27:04.457217 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m18:27:04.460631 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m18:27:04.461024 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m18:27:04.462633 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m18:27:04.462960 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
drop table if exists "dev"."main"."mart_hourly_demand__dbt_backup" cascade
[0m18:27:04.466867 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:27:04.467980 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: Close
[0m18:27:04.468552 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9349b72-bc74-4683-b4a2-2948217f647e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6acc196210>]}
[0m18:27:04.469124 [info ] [Thread-4 (]: 78 of 91 OK created sql table model main.mart_hourly_demand .................... [[32mOK[0m in 0.22s]
[0m18:27:04.469654 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m18:27:04.470210 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m18:27:04.470417 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m18:27:04.470626 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m18:27:04.470871 [info ] [Thread-2 (]: 82 of 91 START test not_null_mart_hourly_demand_is_weekend ..................... [RUN]
[0m18:27:04.471377 [info ] [Thread-4 (]: 83 of 91 START test not_null_mart_hourly_demand_pickup_hour .................... [RUN]
[0m18:27:04.473335 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m18:27:04.473788 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9, now test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8)
[0m18:27:04.474168 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.mart_hourly_demand, now test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418)
[0m18:27:04.474691 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m18:27:04.475104 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m18:27:04.478699 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m18:27:04.480679 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m18:27:04.484554 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m18:27:04.484948 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: BEGIN
[0m18:27:04.485319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:04.486166 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:27:04.486420 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m18:27:04.486668 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m18:27:04.488138 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m18:27:04.488407 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m18:27:04.488649 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "dev"."main"."mart_daily_revenue"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:27:04.490899 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m18:27:04.491915 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:27:04.492905 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: ROLLBACK
[0m18:27:04.493579 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7'
[0m18:27:04.493969 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: Close
[0m18:27:04.494489 [info ] [Thread-1 (]: 81 of 91 PASS unique_mart_daily_revenue_date_key ............................... [[32mPASS[0m in 0.04s]
[0m18:27:04.494942 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m18:27:04.495502 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m18:27:04.496047 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: BEGIN
[0m18:27:04.496841 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:27:04.497098 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m18:27:04.497553 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: BEGIN
[0m18:27:04.497808 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:27:04.498007 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:27:04.498327 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m18:27:04.498783 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:27:04.498986 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."mart_hourly_demand"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m18:27:04.499373 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m18:27:04.499925 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."mart_hourly_demand"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m18:27:04.500409 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:27:04.500729 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:27:04.501896 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: ROLLBACK
[0m18:27:04.502829 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: ROLLBACK
[0m18:27:04.503275 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418'
[0m18:27:04.503840 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8'
[0m18:27:04.504140 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: Close
[0m18:27:04.504417 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: Close
[0m18:27:04.504998 [info ] [Thread-4 (]: 83 of 91 PASS not_null_mart_hourly_demand_pickup_hour .......................... [[32mPASS[0m in 0.03s]
[0m18:27:04.505516 [info ] [Thread-2 (]: 82 of 91 PASS not_null_mart_hourly_demand_is_weekend ........................... [[32mPASS[0m in 0.03s]
[0m18:27:04.505939 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m18:27:04.506426 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m18:27:08.548919 [debug] [Thread-3 (]: SQL status: OK in 5.065 seconds
[0m18:27:08.551335 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m18:27:08.551706 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
alter table "dev"."main"."fct_trips" rename to "fct_trips__dbt_backup"
[0m18:27:08.552382 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:27:08.554066 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m18:27:08.554445 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
alter table "dev"."main"."fct_trips__dbt_tmp" rename to "fct_trips"
[0m18:27:08.554869 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:27:08.555664 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.fct_trips: COMMIT
[0m18:27:08.556102 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m18:27:08.556407 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.fct_trips: COMMIT
[0m18:27:08.926799 [debug] [Thread-3 (]: SQL status: OK in 0.370 seconds
[0m18:27:08.928891 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m18:27:08.929188 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
drop table if exists "dev"."main"."fct_trips__dbt_backup" cascade
[0m18:27:09.263037 [debug] [Thread-3 (]: SQL status: OK in 0.333 seconds
[0m18:27:09.264263 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.fct_trips: Close
[0m18:27:09.327383 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9349b72-bc74-4683-b4a2-2948217f647e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6aef12e6f0>]}
[0m18:27:09.328282 [info ] [Thread-3 (]: 67 of 91 OK created sql incremental model main.fct_trips ....................... [[32mOK[0m in 5.93s]
[0m18:27:09.328827 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.fct_trips
[0m18:27:09.329668 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m18:27:09.329932 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m18:27:09.330237 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m18:27:09.330465 [info ] [Thread-1 (]: 84 of 91 START test not_null_fct_trips_pickup_datetime ......................... [RUN]
[0m18:27:09.330745 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m18:27:09.330978 [info ] [Thread-4 (]: 85 of 91 START test not_null_fct_trips_total_amount ............................ [RUN]
[0m18:27:09.331654 [info ] [Thread-2 (]: 86 of 91 START test not_null_fct_trips_trip_id ................................. [RUN]
[0m18:27:09.332406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7, now test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83)
[0m18:27:09.333173 [info ] [Thread-3 (]: 87 of 91 START test unique_fct_trips_trip_id ................................... [RUN]
[0m18:27:09.333685 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418, now test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d)
[0m18:27:09.334105 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8, now test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d)
[0m18:27:09.334481 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m18:27:09.334864 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.fct_trips, now test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab)
[0m18:27:09.335223 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m18:27:09.335545 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m18:27:09.338321 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m18:27:09.338865 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m18:27:09.341879 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m18:27:09.345685 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m18:27:09.348392 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m18:27:09.353082 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m18:27:09.355433 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m18:27:09.355769 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m18:27:09.357383 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m18:27:09.357698 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m18:27:09.358045 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m18:27:09.359675 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m18:27:09.360961 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m18:27:09.362207 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m18:27:09.362541 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m18:27:09.362808 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: BEGIN
[0m18:27:09.363222 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: BEGIN
[0m18:27:09.363681 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:27:09.364103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:09.364379 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m18:27:09.364935 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m18:27:09.365337 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: BEGIN
[0m18:27:09.365663 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: BEGIN
[0m18:27:09.366013 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:27:09.366441 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:27:09.380483 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m18:27:09.380885 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m18:27:09.381228 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m18:27:09.381479 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m18:27:09.381835 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m18:27:09.382068 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m18:27:09.382456 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m18:27:09.382757 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."fct_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m18:27:09.383039 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m18:27:09.383355 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "dev"."main"."fct_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m18:27:09.383658 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."main"."fct_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:27:09.384095 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."fct_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m18:27:09.384413 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:27:09.385111 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:27:09.385916 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:27:09.388382 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: ROLLBACK
[0m18:27:09.389776 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: ROLLBACK
[0m18:27:09.391270 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: ROLLBACK
[0m18:27:09.393230 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d'
[0m18:27:09.394085 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83'
[0m18:27:09.396406 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d'
[0m18:27:09.397809 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: Close
[0m18:27:09.399641 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: Close
[0m18:27:09.401384 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: Close
[0m18:27:09.403325 [info ] [Thread-4 (]: 85 of 91 PASS not_null_fct_trips_total_amount .................................. [[32mPASS[0m in 0.07s]
[0m18:27:09.404093 [info ] [Thread-1 (]: 84 of 91 PASS not_null_fct_trips_pickup_datetime ............................... [[32mPASS[0m in 0.07s]
[0m18:27:09.406302 [info ] [Thread-2 (]: 86 of 91 PASS not_null_fct_trips_trip_id ....................................... [[32mPASS[0m in 0.07s]
[0m18:27:09.407992 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m18:27:09.410502 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m18:27:09.413321 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m18:27:09.507238 [debug] [Thread-3 (]: SQL status: OK in 0.122 seconds
[0m18:27:09.509084 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: ROLLBACK
[0m18:27:09.509842 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab'
[0m18:27:09.510313 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: Close
[0m18:27:09.531599 [info ] [Thread-3 (]: 87 of 91 PASS unique_fct_trips_trip_id ......................................... [[32mPASS[0m in 0.20s]
[0m18:27:09.532541 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m18:27:09.533281 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.mart_location_performance
[0m18:27:09.533654 [info ] [Thread-4 (]: 88 of 91 START sql table model main.mart_location_performance .................. [RUN]
[0m18:27:09.534147 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d, now model.nyc_taxi_pipeline_00.mart_location_performance)
[0m18:27:09.534534 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_location_performance
[0m18:27:09.537266 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m18:27:09.542892 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.mart_location_performance
[0m18:27:09.545073 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m18:27:09.545490 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Location-level performance summary.
    Uses adapter-dispatched mode_compat() for cross-dialect support.
*/

with trips as (
    select * from "dev"."main"."fct_trips"
),

final as (
    select
        pickup_location_id,
        pickup_borough,
        pickup_zone,

        count(*) as total_pickups,
        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue_per_trip,
        round(avg(tip_percentage), 2) as avg_tip_pct,
        round(avg(passenger_count), 2) as avg_passengers,

        -- most common dropoff destination
        
    mode(dropoff_zone)
 as most_common_dropoff_zone,

        -- busiest hour
        
    mode(pickup_hour)
 as peak_pickup_hour

    from trips
    where pickup_zone is not null
    group by pickup_location_id, pickup_borough, pickup_zone
)

select * from final
order by total_pickups desc
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:27:09.545936 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:27:09.591370 [debug] [Thread-4 (]: SQL status: OK in 0.045 seconds
[0m18:27:09.593864 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m18:27:09.594477 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as varchar)
 as pickup_borough, 
      
    cast(null as varchar)
 as pickup_zone, 
      
    cast(null as bigint)
 as total_pickups, 
      
    cast(null as double)
 as avg_trip_distance, 
      
    cast(null as double)
 as avg_trip_duration_min, 
      
    cast(null as decimal(38,2))
 as total_revenue, 
      
    cast(null as double)
 as avg_revenue_per_trip, 
      
    cast(null as double)
 as avg_tip_pct, 
      
    cast(null as double)
 as avg_passengers, 
      
    cast(null as varchar)
 as most_common_dropoff_zone, 
      
    cast(null as bigint)
 as peak_pickup_hour
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:27:09.595374 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:27:09.596745 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m18:27:09.606155 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m18:27:09.606647 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: BEGIN
[0m18:27:09.607304 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:27:09.607565 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m18:27:09.607857 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_location_performance__dbt_tmp"
  
  (
    pickup_location_id integer,
    pickup_borough varchar,
    pickup_zone varchar,
    total_pickups bigint,
    avg_trip_distance double,
    avg_trip_duration_min double,
    total_revenue decimal(38,2),
    avg_revenue_per_trip double,
    avg_tip_pct double,
    avg_passengers double,
    most_common_dropoff_zone varchar,
    peak_pickup_hour bigint
    
    )
 ;
    insert into "dev"."main"."mart_location_performance__dbt_tmp" 
  (
    
      
      pickup_location_id ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      total_pickups ,
    
      
      avg_trip_distance ,
    
      
      avg_trip_duration_min ,
    
      
      total_revenue ,
    
      
      avg_revenue_per_trip ,
    
      
      avg_tip_pct ,
    
      
      avg_passengers ,
    
      
      most_common_dropoff_zone ,
    
      
      peak_pickup_hour 
    
  )
 (
      
    select pickup_location_id, pickup_borough, pickup_zone, total_pickups, avg_trip_distance, avg_trip_duration_min, total_revenue, avg_revenue_per_trip, avg_tip_pct, avg_passengers, most_common_dropoff_zone, peak_pickup_hour
    from (
        /*
    Analytics mart: Location-level performance summary.
    Uses adapter-dispatched mode_compat() for cross-dialect support.
*/

with trips as (
    select * from "dev"."main"."fct_trips"
),

final as (
    select
        pickup_location_id,
        pickup_borough,
        pickup_zone,

        count(*) as total_pickups,
        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue_per_trip,
        round(avg(tip_percentage), 2) as avg_tip_pct,
        round(avg(passenger_count), 2) as avg_passengers,

        -- most common dropoff destination
        
    mode(dropoff_zone)
 as most_common_dropoff_zone,

        -- busiest hour
        
    mode(pickup_hour)
 as peak_pickup_hour

    from trips
    where pickup_zone is not null
    group by pickup_location_id, pickup_borough, pickup_zone
)

select * from final
order by total_pickups desc
    ) as model_subq
    );
  
  
[0m18:27:09.699568 [debug] [Thread-4 (]: SQL status: OK in 0.091 seconds
[0m18:27:09.701744 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m18:27:09.702170 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
alter table "dev"."main"."mart_location_performance" rename to "mart_location_performance__dbt_backup"
[0m18:27:09.702906 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:27:09.705904 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m18:27:09.706360 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
alter table "dev"."main"."mart_location_performance__dbt_tmp" rename to "mart_location_performance"
[0m18:27:09.706902 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:27:09.707774 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: COMMIT
[0m18:27:09.708259 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m18:27:09.708606 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: COMMIT
[0m18:27:09.713545 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m18:27:09.715070 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m18:27:09.715524 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
drop table if exists "dev"."main"."mart_location_performance__dbt_backup" cascade
[0m18:27:09.717822 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:27:09.718752 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: Close
[0m18:27:09.764054 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9349b72-bc74-4683-b4a2-2948217f647e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6acc1e9ee0>]}
[0m18:27:09.764962 [info ] [Thread-4 (]: 88 of 91 OK created sql table model main.mart_location_performance ............. [[32mOK[0m in 0.23s]
[0m18:27:09.765348 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.mart_location_performance
[0m18:27:09.765960 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m18:27:09.766345 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m18:27:09.766585 [info ] [Thread-2 (]: 89 of 91 START test not_null_mart_location_performance_pickup_location_id ...... [RUN]
[0m18:27:09.766869 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m18:27:09.767086 [info ] [Thread-3 (]: 90 of 91 START test not_null_mart_location_performance_total_pickups ........... [RUN]
[0m18:27:09.767533 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d, now test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c)
[0m18:27:09.767937 [info ] [Thread-1 (]: 91 of 91 START test unique_mart_location_performance_pickup_location_id ........ [RUN]
[0m18:27:09.768362 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab, now test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259)
[0m18:27:09.768841 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m18:27:09.769263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83, now test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62)
[0m18:27:09.769601 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m18:27:09.772170 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m18:27:09.772550 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m18:27:09.774600 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m18:27:09.777174 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m18:27:09.780175 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m18:27:09.780472 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m18:27:09.781665 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m18:27:09.781914 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m18:27:09.783413 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m18:27:09.784963 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m18:27:09.787242 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m18:27:09.787655 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: BEGIN
[0m18:27:09.787929 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m18:27:09.788200 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:27:09.788596 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: BEGIN
[0m18:27:09.789421 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m18:27:09.789933 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:27:09.790296 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: BEGIN
[0m18:27:09.790790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:09.806139 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m18:27:09.806662 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m18:27:09.806946 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m18:27:09.807226 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m18:27:09.807728 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m18:27:09.808150 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m18:27:09.808520 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_location_id
from "dev"."main"."mart_location_performance"
where pickup_location_id is null



  
  
      
    ) dbt_internal_test
[0m18:27:09.808870 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_pickups
from "dev"."main"."mart_location_performance"
where total_pickups is null



  
  
      
    ) dbt_internal_test
[0m18:27:09.809238 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pickup_location_id as unique_field,
    count(*) as n_records

from "dev"."main"."mart_location_performance"
where pickup_location_id is not null
group by pickup_location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:27:09.810315 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:27:09.810608 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:27:09.811765 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: ROLLBACK
[0m18:27:09.812108 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:27:09.813278 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: ROLLBACK
[0m18:27:09.813788 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c'
[0m18:27:09.814729 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: ROLLBACK
[0m18:27:09.815149 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259'
[0m18:27:09.815535 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: Close
[0m18:27:09.816131 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62'
[0m18:27:09.816494 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: Close
[0m18:27:09.817384 [info ] [Thread-2 (]: 89 of 91 PASS not_null_mart_location_performance_pickup_location_id ............ [[32mPASS[0m in 0.05s]
[0m18:27:09.817925 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: Close
[0m18:27:09.818918 [info ] [Thread-3 (]: 90 of 91 PASS not_null_mart_location_performance_total_pickups ................. [[32mPASS[0m in 0.05s]
[0m18:27:09.819467 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m18:27:09.820238 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m18:27:09.822396 [info ] [Thread-1 (]: 91 of 91 PASS unique_mart_location_performance_pickup_location_id .............. [[32mPASS[0m in 0.05s]
[0m18:27:09.822951 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m18:27:09.824825 [debug] [MainThread]: Using duckdb connection "master"
[0m18:27:09.825361 [debug] [MainThread]: On master: BEGIN
[0m18:27:09.825827 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:27:09.844990 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m18:27:09.845496 [debug] [MainThread]: On master: COMMIT
[0m18:27:09.845789 [debug] [MainThread]: Using duckdb connection "master"
[0m18:27:09.846032 [debug] [MainThread]: On master: COMMIT
[0m18:27:09.846520 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:27:09.846843 [debug] [MainThread]: On master: Close
[0m18:27:09.849695 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:27:09.850062 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m18:27:09.850413 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62' was properly closed.
[0m18:27:09.850722 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c' was properly closed.
[0m18:27:09.851012 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259' was properly closed.
[0m18:27:09.851327 [debug] [MainThread]: Connection 'model.nyc_taxi_pipeline_00.mart_location_performance' was properly closed.
[0m18:27:09.851830 [info ] [MainThread]: 
[0m18:27:09.852254 [info ] [MainThread]: Finished running 1 incremental model, 3 seeds, 7 table models, 74 data tests, 6 view models in 0 hours 0 minutes and 9.86 seconds (9.86s).
[0m18:27:09.857200 [debug] [MainThread]: Command end result
[0m18:27:09.896488 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m18:27:09.900717 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m18:27:09.911598 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m18:27:09.912066 [info ] [MainThread]: 
[0m18:27:09.912469 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:27:09.912824 [info ] [MainThread]: 
[0m18:27:09.913140 [info ] [MainThread]: Done. PASS=91 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=91
[0m18:27:09.914084 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 10.919535, "process_in_blocks": "0", "process_kernel_time": 6.915542, "process_mem_max_rss": "1762716", "process_out_blocks": "136", "process_user_time": 22.5359}
[0m18:27:09.914784 [debug] [MainThread]: Command `dbt build` succeeded at 18:27:09.914671 after 10.92 seconds
[0m18:27:09.915454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6b5f5615e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6acc181c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6adc18d9a0>]}
[0m18:27:09.916062 [debug] [MainThread]: Flushing usage events
[0m18:27:10.146157 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:52:09.028492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777fcca564b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777fcdd010a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777fcca57b30>]}


============================== 18:52:09.032525 | 3e5aa7ee-5192-4056-bb47-aed21911d894 ==============================
[0m18:52:09.032525 [info ] [MainThread]: Running with dbt=1.11.4
[0m18:52:09.033125 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'fail_fast': 'False', 'target_path': 'None', 'warn_error': 'None', 'profiles_dir': '.', 'use_colors': 'True', 'no_print': 'None', 'introspect': 'True', 'empty': 'None', 'log_format': 'default', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/dbt/logs', 'invocation_command': 'dbt deps --profiles-dir .', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'printer_width': '80'}
[0m18:52:09.129768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e5aa7ee-5192-4056-bb47-aed21911d894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777fcc99b290>]}
[0m18:52:09.371629 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-h36wgosh'
[0m18:52:09.372089 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:52:09.507931 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:52:09.509135 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:52:09.611410 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:52:09.614375 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:52:12.974669 [info ] [MainThread]: Installed from version 1.3.3
[0m18:52:12.975149 [info ] [MainThread]: Up to date!
[0m18:52:12.975580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3e5aa7ee-5192-4056-bb47-aed21911d894', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777fcc9783b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777fcc849310>]}
[0m18:52:12.976726 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.0133634, "process_in_blocks": "0", "process_kernel_time": 0.416403, "process_mem_max_rss": "105592", "process_out_blocks": "176", "process_user_time": 1.080876}
[0m18:52:12.977311 [debug] [MainThread]: Command `dbt deps` succeeded at 18:52:12.977228 after 4.01 seconds
[0m18:52:12.977713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777fcccd7fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777fcc780b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777fccd7a9f0>]}
[0m18:52:12.978070 [debug] [MainThread]: Flushing usage events
[0m18:52:13.266400 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:52:14.112395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0cf6617c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0cf054200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0cfa32900>]}


============================== 18:52:14.114895 | 7b1704f5-13c8-403b-905d-802e8cb7d35c ==============================
[0m18:52:14.114895 [info ] [MainThread]: Running with dbt=1.11.4
[0m18:52:14.115332 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt build --full-refresh --profiles-dir .', 'empty': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'no_print': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'quiet': 'False', 'fail_fast': 'False', 'version_check': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'printer_width': '80', 'log_path': '/dbt/logs', 'use_experimental_parser': 'False', 'debug': 'False', 'use_colors': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True'}
[0m18:52:14.234224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b1704f5-13c8-403b-905d-802e8cb7d35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0cea600b0>]}
[0m18:52:14.267448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b1704f5-13c8-403b-905d-802e8cb7d35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0d172ec30>]}
[0m18:52:14.269570 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m18:52:14.320120 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m18:52:14.894636 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:52:14.895098 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:52:14.895797 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:52:14.926718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b1704f5-13c8-403b-905d-802e8cb7d35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0bef26840>]}
[0m18:52:15.005181 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m18:52:15.009517 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m18:52:15.038331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b1704f5-13c8-403b-905d-802e8cb7d35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0bec1d3a0>]}
[0m18:52:15.038829 [info ] [MainThread]: Found 14 models, 74 data tests, 3 seeds, 1 source, 578 macros
[0m18:52:15.042567 [info ] [MainThread]: 
[0m18:52:15.042992 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:52:15.043375 [info ] [MainThread]: 
[0m18:52:15.043906 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:52:15.047520 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m18:52:15.126656 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m18:52:15.127149 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m18:52:15.127494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:15.147808 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m18:52:15.148871 [debug] [ThreadPool]: On list_dev: Close
[0m18:52:15.151893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m18:52:15.152344 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m18:52:15.156193 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:52:15.156577 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m18:52:15.156948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:52:15.171225 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m18:52:15.172450 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:52:15.172843 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m18:52:15.173349 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:52:15.173792 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:52:15.174207 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m18:52:15.174810 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:52:15.175461 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:52:15.175789 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:52:15.176057 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:52:15.176490 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:52:15.176795 [debug] [ThreadPool]: On create_dev_main: Close
[0m18:52:15.180197 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m18:52:15.183803 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:52:15.184287 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m18:52:15.184653 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:52:15.198558 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m18:52:15.199013 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:52:15.199305 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m18:52:15.205557 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m18:52:15.206592 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m18:52:15.207335 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m18:52:15.207597 [debug] [ThreadPool]: On list_dev_main: Close
[0m18:52:15.211713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b1704f5-13c8-403b-905d-802e8cb7d35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0d172efc0>]}
[0m18:52:15.212841 [debug] [MainThread]: Using duckdb connection "master"
[0m18:52:15.213196 [debug] [MainThread]: On master: BEGIN
[0m18:52:15.213462 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:52:15.228212 [debug] [MainThread]: SQL status: OK in 0.015 seconds
[0m18:52:15.228686 [debug] [MainThread]: On master: COMMIT
[0m18:52:15.229007 [debug] [MainThread]: Using duckdb connection "master"
[0m18:52:15.229268 [debug] [MainThread]: On master: COMMIT
[0m18:52:15.229750 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:52:15.230043 [debug] [MainThread]: On master: Close
[0m18:52:15.235241 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.dim_dates
[0m18:52:15.235547 [debug] [Thread-2 (]: Began running node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m18:52:15.235839 [debug] [Thread-3 (]: Began running node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m18:52:15.236160 [info ] [Thread-1 (]: 1 of 91 START sql table model main.dim_dates ................................... [RUN]
[0m18:52:15.236422 [debug] [Thread-4 (]: Began running node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m18:52:15.236702 [info ] [Thread-2 (]: 2 of 91 START sql table model main.stg_yellow_trips ............................ [RUN]
[0m18:52:15.237140 [info ] [Thread-3 (]: 3 of 91 START seed file main.payment_type_lookup ............................... [RUN]
[0m18:52:15.237679 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nyc_taxi_pipeline_00.dim_dates'
[0m18:52:15.238120 [info ] [Thread-4 (]: 4 of 91 START seed file main.rate_code_lookup .................................. [RUN]
[0m18:52:15.238614 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.nyc_taxi_pipeline_00.stg_yellow_trips'
[0m18:52:15.239065 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.nyc_taxi_pipeline_00.payment_type_lookup'
[0m18:52:15.239432 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_dates
[0m18:52:15.239885 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.nyc_taxi_pipeline_00.rate_code_lookup'
[0m18:52:15.240622 [debug] [Thread-2 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m18:52:15.240986 [debug] [Thread-3 (]: Began compiling node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m18:52:15.251786 [debug] [Thread-4 (]: Began compiling node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m18:52:15.252065 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:52:15.262239 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m18:52:15.262544 [debug] [Thread-3 (]: Began executing node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m18:52:15.262917 [debug] [Thread-4 (]: Began executing node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m18:52:15.263246 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: BEGIN
[0m18:52:15.273905 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:52:15.274832 [debug] [Thread-2 (]: Began executing node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m18:52:15.293148 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m18:52:15.299314 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m18:52:15.299580 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m18:52:15.301354 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m18:52:15.301650 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.payment_type_lookup"} */
drop table if exists "dev"."main"."payment_type_lookup" cascade
[0m18:52:15.302137 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:52:15.302659 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.rate_code_lookup"} */
drop table if exists "dev"."main"."rate_code_lookup" cascade
[0m18:52:15.303153 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:52:15.303588 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m18:52:15.303884 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */


        select 
        (date_diff('day', cast('2024-01-01' as date)::timestamp, cast('2024-02-01' as date)::timestamp ))
    
[0m18:52:15.304270 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:52:15.305113 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: BEGIN
[0m18:52:15.306010 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:52:15.306316 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.306834 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.312426 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m18:52:15.312766 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m18:52:15.316322 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:52:15.316645 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */

  
    
    

    create  table
      "dev"."main"."stg_yellow_trips__dbt_tmp"
  
    as (
      

with source as (
    select * from read_parquet('/data/yellow_tripdata_2024-01.parquet')
),

renamed as (
    select
        -- surrogate key (MD5 hash of composite key)
        md5(cast(coalesce(cast(VendorID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(PULocationID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DOLocationID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(fare_amount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(total_amount as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- identifiers
        cast("VendorID" as integer) as vendor_id,
        cast("RatecodeID" as integer) as rate_code_id,
        cast("PULocationID" as integer) as pickup_location_id,
        cast("DOLocationID" as integer) as dropoff_location_id,
        cast(payment_type as integer) as payment_type_id,

        -- timestamps
        cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
        cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as double) as trip_distance_miles,
        store_and_fwd_flag,

        -- financials
        round(cast(fare_amount as decimal(10, 2)), 2) as fare_amount,
        round(cast(extra as decimal(10, 2)), 2) as extra_amount,
        round(cast(mta_tax as decimal(10, 2)), 2) as mta_tax,
        round(cast(tip_amount as decimal(10, 2)), 2) as tip_amount,
        round(cast(tolls_amount as decimal(10, 2)), 2) as tolls_amount,
        round(cast(improvement_surcharge as decimal(10, 2)), 2) as improvement_surcharge,
        round(cast(total_amount as decimal(10, 2)), 2) as total_amount,
        round(cast(congestion_surcharge as decimal(10, 2)), 2) as congestion_surcharge,
        round(cast(Airport_fee as decimal(10, 2)), 2) as airport_fee

    from source
    where tpep_pickup_datetime is not null
      and tpep_dropoff_datetime is not null
      and trip_distance >= 0
      and fare_amount >= 0
      -- filter out-of-range dates (data quality: ~18 trips outside Jan 2024)
      and cast(tpep_pickup_datetime as date) >= date '2024-01-01'
      and cast(tpep_pickup_datetime as date) < date '2024-02-01'
)

select * from renamed
    );
  
  
[0m18:52:15.316970 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m18:52:15.322006 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m18:52:15.324061 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m18:52:15.324647 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: BEGIN
[0m18:52:15.325033 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: BEGIN
[0m18:52:15.325823 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:52:15.326171 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:52:15.326432 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m18:52:15.326869 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m18:52:15.327256 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.payment_type_lookup"} */

    create table "dev"."main"."payment_type_lookup" ("payment_type_id" integer,"payment_type_name" varchar)
  
[0m18:52:15.327667 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.rate_code_lookup"} */

    create table "dev"."main"."rate_code_lookup" ("rate_code_id" integer,"rate_code_name" varchar)
  
[0m18:52:15.328606 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:52:15.328907 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:52:15.335700 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m18:52:15.336144 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.dim_dates
[0m18:52:15.337179 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m18:52:15.337678 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: 
          COPY "dev"."main"."payment_type_lookup" FROM '/dbt/seeds/payment_type_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:52:15.348394 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: 
          COPY "dev"."main"."rate_code_lookup" FROM '/dbt/seeds/rate_code_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:52:15.352207 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:52:15.353350 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
DESCRIBE (select * from (
        /*
    Dimension table: Calendar dates for January 2024.
    Uses adapter-dispatched macros for dayname/monthname.
*/

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 31
    order by generated_number



),

all_periods as (

    select (
        

    date_add(cast('2024-01-01' as date), interval (row_number() over (order by generated_number) - 1) day)


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-02-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week_num,
        
    dayname(date_day)
 as day_of_week_name,
        
    monthname(date_day)
 as month_name,
        extract(week from date_day) as week_of_year,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when cast(date_day as date) in (
                cast('2024-01-01' as date),
                cast('2024-01-15' as date)
            ) then true
            else false
        end as is_holiday

    from date_spine
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:52:15.358488 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:52:15.369465 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m18:52:15.369791 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m18:52:15.370022 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:52:15.373011 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m18:52:15.373676 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m18:52:15.374199 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as date_key, 
      
    cast(null as bigint)
 as year, 
      
    cast(null as bigint)
 as month, 
      
    cast(null as bigint)
 as day_of_month, 
      
    cast(null as bigint)
 as day_of_week_num, 
      
    cast(null as varchar)
 as day_of_week_name, 
      
    cast(null as varchar)
 as month_name, 
      
    cast(null as bigint)
 as week_of_year, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as boolean)
 as is_holiday
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:52:15.377015 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.394453 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:52:15.406168 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: COMMIT
[0m18:52:15.406528 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: COMMIT
[0m18:52:15.406908 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m18:52:15.407479 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m18:52:15.408042 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: COMMIT
[0m18:52:15.408520 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: COMMIT
[0m18:52:15.411144 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:52:15.411936 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_dates__dbt_tmp"
  
  (
    date_key date,
    year bigint,
    month bigint,
    day_of_month bigint,
    day_of_week_num bigint,
    day_of_week_name varchar,
    month_name varchar,
    week_of_year bigint,
    is_weekend boolean,
    is_holiday boolean
    
    )
 ;
    insert into "dev"."main"."dim_dates__dbt_tmp" 
  (
    
      
      date_key ,
    
      
      year ,
    
      
      month ,
    
      
      day_of_month ,
    
      
      day_of_week_num ,
    
      
      day_of_week_name ,
    
      
      month_name ,
    
      
      week_of_year ,
    
      
      is_weekend ,
    
      
      is_holiday 
    
  )
 (
      
    select date_key, year, month, day_of_month, day_of_week_num, day_of_week_name, month_name, week_of_year, is_weekend, is_holiday
    from (
        /*
    Dimension table: Calendar dates for January 2024.
    Uses adapter-dispatched macros for dayname/monthname.
*/

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 31
    order by generated_number



),

all_periods as (

    select (
        

    date_add(cast('2024-01-01' as date), interval (row_number() over (order by generated_number) - 1) day)


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-02-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week_num,
        
    dayname(date_day)
 as day_of_week_name,
        
    monthname(date_day)
 as month_name,
        extract(week from date_day) as week_of_year,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when cast(date_day as date) in (
                cast('2024-01-01' as date),
                cast('2024-01-15' as date)
            ) then true
            else false
        end as is_holiday

    from date_spine
)

select * from final
    ) as model_subq
    );
  
  
[0m18:52:15.412327 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:52:15.414502 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: Close
[0m18:52:15.416141 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m18:52:15.416452 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b1704f5-13c8-403b-905d-802e8cb7d35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0cfab13d0>]}
[0m18:52:15.417223 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: Close
[0m18:52:15.418367 [info ] [Thread-4 (]: 4 of 91 OK loaded seed file main.rate_code_lookup .............................. [[32mCREATE 7[0m in 0.18s]
[0m18:52:15.419222 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b1704f5-13c8-403b-905d-802e8cb7d35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0ad563b30>]}
[0m18:52:15.419815 [debug] [Thread-4 (]: Finished running node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m18:52:15.420899 [info ] [Thread-3 (]: 3 of 91 OK loaded seed file main.payment_type_lookup ........................... [[32mCREATE 6[0m in 0.18s]
[0m18:52:15.421666 [debug] [Thread-4 (]: Began running node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m18:52:15.422697 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m18:52:15.423341 [debug] [Thread-3 (]: Finished running node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m18:52:15.423967 [info ] [Thread-4 (]: 5 of 91 START seed file main.taxi_zone_lookup .................................. [RUN]
[0m18:52:15.428622 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:52:15.429236 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m18:52:15.430015 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.rate_code_lookup, now seed.nyc_taxi_pipeline_00.taxi_zone_lookup)
[0m18:52:15.430418 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
alter table "dev"."main"."dim_dates" rename to "dim_dates__dbt_backup"
[0m18:52:15.430841 [info ] [Thread-3 (]: 6 of 91 START test not_null_rate_code_lookup_rate_code_id ...................... [RUN]
[0m18:52:15.431308 [debug] [Thread-4 (]: Began compiling node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m18:52:15.432191 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.payment_type_lookup, now test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec)
[0m18:52:15.432648 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.432969 [debug] [Thread-4 (]: Began executing node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m18:52:15.433423 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m18:52:15.435800 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:52:15.446177 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m18:52:15.447149 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
alter table "dev"."main"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m18:52:15.448839 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.450207 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: COMMIT
[0m18:52:15.451640 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:52:15.453272 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m18:52:15.453516 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: COMMIT
[0m18:52:15.453959 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"} */
drop table if exists "dev"."main"."taxi_zone_lookup" cascade
[0m18:52:15.454865 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:52:15.456251 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m18:52:15.466899 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m18:52:15.467209 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m18:52:15.467618 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:52:15.468573 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m18:52:15.470870 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m18:52:15.471379 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: BEGIN
[0m18:52:15.471886 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
drop table if exists "dev"."main"."dim_dates__dbt_backup" cascade
[0m18:52:15.472595 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:52:15.473098 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m18:52:15.473518 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"} */

    create table "dev"."main"."taxi_zone_lookup" ("LocationID" integer,"Borough" varchar,"Zone" varchar,"service_zone" varchar)
  
[0m18:52:15.475458 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:52:15.475925 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:52:15.476377 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m18:52:15.477408 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: Close
[0m18:52:15.478404 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m18:52:15.478878 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: BEGIN
[0m18:52:15.479738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b1704f5-13c8-403b-905d-802e8cb7d35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0aef1bd70>]}
[0m18:52:15.480054 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: 
          COPY "dev"."main"."taxi_zone_lookup" FROM '/dbt/seeds/taxi_zone_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:52:15.480483 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:52:15.481169 [info ] [Thread-1 (]: 1 of 91 OK created sql table model main.dim_dates .............................. [[32mOK[0m in 0.24s]
[0m18:52:15.482427 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.dim_dates
[0m18:52:15.482764 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:52:15.483084 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m18:52:15.483746 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m18:52:15.484363 [info ] [Thread-1 (]: 7 of 91 START test unique_rate_code_lookup_rate_code_id ........................ [RUN]
[0m18:52:15.484892 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_id
from "dev"."main"."rate_code_lookup"
where rate_code_id is null



  
  
      
    ) dbt_internal_test
[0m18:52:15.485460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_dates, now test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d)
[0m18:52:15.486229 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m18:52:15.490620 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m18:52:15.491107 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m18:52:15.491643 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m18:52:15.493995 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: ROLLBACK
[0m18:52:15.494538 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m18:52:15.495914 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec'
[0m18:52:15.496818 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: Close
[0m18:52:15.497463 [info ] [Thread-3 (]: 6 of 91 PASS not_null_rate_code_lookup_rate_code_id ............................ [[32mPASS[0m in 0.07s]
[0m18:52:15.498006 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m18:52:15.498383 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m18:52:15.498768 [info ] [Thread-3 (]: 8 of 91 START test not_null_payment_type_lookup_payment_type_id ................ [RUN]
[0m18:52:15.499267 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec, now test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521)
[0m18:52:15.499821 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m18:52:15.500142 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m18:52:15.503277 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m18:52:15.505539 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m18:52:15.507767 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: COMMIT
[0m18:52:15.508317 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m18:52:15.508853 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: COMMIT
[0m18:52:15.512981 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m18:52:15.513437 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m18:52:15.513814 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: BEGIN
[0m18:52:15.514225 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m18:52:15.516050 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m18:52:15.516512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:15.517192 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: Close
[0m18:52:15.518200 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:52:15.518737 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b1704f5-13c8-403b-905d-802e8cb7d35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0ad5e1e20>]}
[0m18:52:15.519050 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m18:52:15.519760 [info ] [Thread-4 (]: 5 of 91 OK loaded seed file main.taxi_zone_lookup .............................. [[32mCREATE 265[0m in 0.09s]
[0m18:52:15.520387 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rate_code_id as unique_field,
    count(*) as n_records

from "dev"."main"."rate_code_lookup"
where rate_code_id is not null
group by rate_code_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:52:15.521076 [debug] [Thread-4 (]: Finished running node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m18:52:15.521916 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m18:52:15.522340 [info ] [Thread-4 (]: 9 of 91 START test unique_payment_type_lookup_payment_type_id .................. [RUN]
[0m18:52:15.522926 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.taxi_zone_lookup, now test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7)
[0m18:52:15.523212 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:52:15.523646 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m18:52:15.525166 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: ROLLBACK
[0m18:52:15.528086 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m18:52:15.528533 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m18:52:15.529676 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d'
[0m18:52:15.530277 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: BEGIN
[0m18:52:15.530759 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: Close
[0m18:52:15.531381 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:52:15.532237 [info ] [Thread-1 (]: 7 of 91 PASS unique_rate_code_lookup_rate_code_id .............................. [[32mPASS[0m in 0.05s]
[0m18:52:15.532795 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.533237 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m18:52:15.533721 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m18:52:15.534259 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m18:52:15.534944 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."payment_type_lookup"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m18:52:15.535540 [info ] [Thread-1 (]: 10 of 91 START test not_null_dim_dates_date_key ................................ [RUN]
[0m18:52:15.536755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d, now test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348)
[0m18:52:15.537115 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.537396 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m18:52:15.537757 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m18:52:15.539332 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: ROLLBACK
[0m18:52:15.541984 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m18:52:15.545126 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m18:52:15.546051 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521'
[0m18:52:15.547046 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: Close
[0m18:52:15.547607 [info ] [Thread-3 (]: 8 of 91 PASS not_null_payment_type_lookup_payment_type_id ...................... [[32mPASS[0m in 0.05s]
[0m18:52:15.548198 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m18:52:15.548629 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m18:52:15.549023 [info ] [Thread-3 (]: 11 of 91 START test not_null_dim_dates_day_of_week_name ........................ [RUN]
[0m18:52:15.549508 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521, now test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541)
[0m18:52:15.549956 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m18:52:15.552684 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m18:52:15.553987 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m18:52:15.554466 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m18:52:15.556085 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m18:52:15.556741 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: BEGIN
[0m18:52:15.557633 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:52:15.558430 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m18:52:15.558732 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.560645 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m18:52:15.561192 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m18:52:15.562046 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."payment_type_lookup"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:52:15.564139 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:52:15.565489 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: ROLLBACK
[0m18:52:15.566488 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7'
[0m18:52:15.567019 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: Close
[0m18:52:15.567778 [info ] [Thread-4 (]: 9 of 91 PASS unique_payment_type_lookup_payment_type_id ........................ [[32mPASS[0m in 0.04s]
[0m18:52:15.568158 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m18:52:15.568506 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m18:52:15.568950 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m18:52:15.569469 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: BEGIN
[0m18:52:15.570093 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: BEGIN
[0m18:52:15.570727 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m18:52:15.571640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:15.572171 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:52:15.572787 [info ] [Thread-4 (]: 12 of 91 START test not_null_dim_dates_is_holiday .............................. [RUN]
[0m18:52:15.573753 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:52:15.574437 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:52:15.574914 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7, now test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a)
[0m18:52:15.575408 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m18:52:15.576010 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m18:52:15.576575 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m18:52:15.577171 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "dev"."main"."dim_dates"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m18:52:15.577662 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select day_of_week_name
from "dev"."main"."dim_dates"
where day_of_week_name is null



  
  
      
    ) dbt_internal_test
[0m18:52:15.581391 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m18:52:15.583150 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.583538 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.584956 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: ROLLBACK
[0m18:52:15.586456 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: ROLLBACK
[0m18:52:15.587370 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541'
[0m18:52:15.588072 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348'
[0m18:52:15.588498 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: Close
[0m18:52:15.589001 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: Close
[0m18:52:15.589993 [info ] [Thread-3 (]: 11 of 91 PASS not_null_dim_dates_day_of_week_name .............................. [[32mPASS[0m in 0.04s]
[0m18:52:15.590628 [info ] [Thread-1 (]: 10 of 91 PASS not_null_dim_dates_date_key ...................................... [[32mPASS[0m in 0.05s]
[0m18:52:15.591091 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m18:52:15.591667 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m18:52:15.592443 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m18:52:15.593234 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m18:52:15.594030 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m18:52:15.594413 [info ] [Thread-3 (]: 13 of 91 START test not_null_dim_dates_is_weekend .............................. [RUN]
[0m18:52:15.595014 [info ] [Thread-1 (]: 14 of 91 START test unique_dim_dates_date_key .................................. [RUN]
[0m18:52:15.597044 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m18:52:15.597790 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541, now test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0)
[0m18:52:15.598357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348, now test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d)
[0m18:52:15.599235 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m18:52:15.599759 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m18:52:15.603676 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m18:52:15.606489 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m18:52:15.611355 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m18:52:15.611866 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: BEGIN
[0m18:52:15.612539 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:52:15.613580 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m18:52:15.613937 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.615742 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m18:52:15.616159 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m18:52:15.616497 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m18:52:15.618757 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m18:52:15.619312 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_holiday
from "dev"."main"."dim_dates"
where is_holiday is null



  
  
      
    ) dbt_internal_test
[0m18:52:15.621397 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.622569 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: ROLLBACK
[0m18:52:15.623307 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a'
[0m18:52:15.623975 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: Close
[0m18:52:15.624665 [info ] [Thread-4 (]: 12 of 91 PASS not_null_dim_dates_is_holiday .................................... [[32mPASS[0m in 0.05s]
[0m18:52:15.625067 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m18:52:15.626602 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m18:52:15.627048 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m18:52:15.627379 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: BEGIN
[0m18:52:15.627918 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m18:52:15.628567 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: BEGIN
[0m18:52:15.629083 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:52:15.629603 [info ] [Thread-4 (]: 15 of 91 START test not_null_taxi_zone_lookup_Borough .......................... [RUN]
[0m18:52:15.630234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:15.631284 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a, now test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa)
[0m18:52:15.631838 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:52:15.632519 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:52:15.632790 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m18:52:15.633287 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m18:52:15.633776 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m18:52:15.636998 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m18:52:15.637730 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."dim_dates"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m18:52:15.638235 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "dev"."main"."dim_dates"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:52:15.640171 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.640536 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.641628 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: ROLLBACK
[0m18:52:15.642849 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: ROLLBACK
[0m18:52:15.643528 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0'
[0m18:52:15.644288 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d'
[0m18:52:15.644860 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: Close
[0m18:52:15.645754 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: Close
[0m18:52:15.646720 [info ] [Thread-3 (]: 13 of 91 PASS not_null_dim_dates_is_weekend .................................... [[32mPASS[0m in 0.05s]
[0m18:52:15.647246 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m18:52:15.647743 [info ] [Thread-1 (]: 14 of 91 PASS unique_dim_dates_date_key ........................................ [[32mPASS[0m in 0.05s]
[0m18:52:15.648127 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m18:52:15.650077 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m18:52:15.650829 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m18:52:15.651399 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m18:52:15.652238 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m18:52:15.652663 [info ] [Thread-3 (]: 16 of 91 START test not_null_taxi_zone_lookup_LocationID ....................... [RUN]
[0m18:52:15.653069 [info ] [Thread-1 (]: 17 of 91 START test unique_taxi_zone_lookup_LocationID ......................... [RUN]
[0m18:52:15.653695 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0, now test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a)
[0m18:52:15.654269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d, now test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8)
[0m18:52:15.654728 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m18:52:15.655256 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m18:52:15.658432 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m18:52:15.661384 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m18:52:15.663829 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m18:52:15.664305 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: BEGIN
[0m18:52:15.664785 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:52:15.665594 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.666075 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m18:52:15.666708 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Borough
from "dev"."main"."taxi_zone_lookup"
where Borough is null



  
  
      
    ) dbt_internal_test
[0m18:52:15.668643 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.669036 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m18:52:15.669464 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m18:52:15.670841 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: ROLLBACK
[0m18:52:15.672734 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m18:52:15.674102 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m18:52:15.674882 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa'
[0m18:52:15.675849 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: Close
[0m18:52:15.676482 [info ] [Thread-4 (]: 15 of 91 PASS not_null_taxi_zone_lookup_Borough ................................ [[32mPASS[0m in 0.05s]
[0m18:52:15.677074 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m18:52:15.677641 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m18:52:15.678169 [info ] [Thread-4 (]: 18 of 91 START sql view model main.stg_rate_codes .............................. [RUN]
[0m18:52:15.678715 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa, now model.nyc_taxi_pipeline_00.stg_rate_codes)
[0m18:52:15.679230 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m18:52:15.681499 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m18:52:15.682910 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m18:52:15.683578 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m18:52:15.683969 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: BEGIN
[0m18:52:15.684647 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: BEGIN
[0m18:52:15.685197 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:52:15.685899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:15.686940 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:52:15.687332 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.687734 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m18:52:15.688280 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m18:52:15.689050 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select LocationID
from "dev"."main"."taxi_zone_lookup"
where LocationID is null



  
  
      
    ) dbt_internal_test
[0m18:52:15.689554 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    LocationID as unique_field,
    count(*) as n_records

from "dev"."main"."taxi_zone_lookup"
where LocationID is not null
group by LocationID
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:52:15.689989 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m18:52:15.702250 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m18:52:15.702689 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m18:52:15.702987 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m18:52:15.704653 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: ROLLBACK
[0m18:52:15.705831 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: ROLLBACK
[0m18:52:15.706731 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a'
[0m18:52:15.707495 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8'
[0m18:52:15.707930 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: Close
[0m18:52:15.708385 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: Close
[0m18:52:15.709037 [info ] [Thread-3 (]: 16 of 91 PASS not_null_taxi_zone_lookup_LocationID ............................. [[32mPASS[0m in 0.06s]
[0m18:52:15.709542 [info ] [Thread-1 (]: 17 of 91 PASS unique_taxi_zone_lookup_LocationID ............................... [[32mPASS[0m in 0.06s]
[0m18:52:15.710299 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m18:52:15.710887 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m18:52:15.711287 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m18:52:15.711958 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.stg_payment_types
[0m18:52:15.712522 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: BEGIN
[0m18:52:15.713516 [info ] [Thread-3 (]: 19 of 91 START sql view model main.stg_payment_types ........................... [RUN]
[0m18:52:15.714055 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m18:52:15.714394 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:52:15.715105 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a, now model.nyc_taxi_pipeline_00.stg_payment_types)
[0m18:52:15.715749 [info ] [Thread-1 (]: 20 of 91 START sql view model main.stg_taxi_zones .............................. [RUN]
[0m18:52:15.716595 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_payment_types
[0m18:52:15.716939 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:52:15.717385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8, now model.nyc_taxi_pipeline_00.stg_taxi_zones)
[0m18:52:15.721202 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m18:52:15.721885 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m18:52:15.722501 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m18:52:15.723367 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */

  
  create view "dev"."main"."stg_rate_codes__dbt_tmp" as (
    /*
    Staging model: Rate code lookup
    Maps rate_code_id to human-readable names.
*/

with source as (
    select * from "dev"."main"."rate_code_lookup"
),

renamed as (
    select
        rate_code_id,
        rate_code_name
    from source
)

select * from renamed
  );

[0m18:52:15.725946 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m18:52:15.727214 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.729527 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m18:52:15.730062 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
alter view "dev"."main"."stg_rate_codes" rename to "stg_rate_codes__dbt_backup"
[0m18:52:15.731056 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.stg_payment_types
[0m18:52:15.731421 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.733902 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m18:52:15.736307 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m18:52:15.737359 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
alter view "dev"."main"."stg_rate_codes__dbt_tmp" rename to "stg_rate_codes"
[0m18:52:15.737733 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m18:52:15.740719 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m18:52:15.741077 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:52:15.742481 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: COMMIT
[0m18:52:15.743007 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m18:52:15.743384 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: COMMIT
[0m18:52:15.745668 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m18:52:15.746174 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: BEGIN
[0m18:52:15.746526 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m18:52:15.746785 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:52:15.747271 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: BEGIN
[0m18:52:15.748254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:15.748523 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:52:15.749141 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m18:52:15.749432 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.749744 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */

  
  create view "dev"."main"."stg_payment_types__dbt_tmp" as (
    /*
    Staging model: Payment type lookup
    Maps payment_type_id to human-readable names.
*/

with source as (
    select * from "dev"."main"."payment_type_lookup"
),

renamed as (
    select
        payment_type_id,
        payment_type_name
    from source
)

select * from renamed
  );

[0m18:52:15.750191 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m18:52:15.750960 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */

  
  create view "dev"."main"."stg_taxi_zones__dbt_tmp" as (
    /*
    Staging model: Taxi zone lookup
    Maps LocationID to borough and zone name.
*/

with source as (
    select * from "dev"."main"."taxi_zone_lookup"
),

renamed as (
    select
        cast("LocationID" as integer) as location_id,
        "Borough" as borough,
        "Zone" as zone_name,
        service_zone
    from source
)

select * from renamed
  );

[0m18:52:15.857097 [debug] [Thread-4 (]: SQL status: OK in 0.113 seconds
[0m18:52:15.857490 [debug] [Thread-3 (]: SQL status: OK in 0.107 seconds
[0m18:52:15.857764 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m18:52:15.859277 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m18:52:15.861095 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m18:52:15.863043 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m18:52:15.863510 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
drop view if exists "dev"."main"."stg_rate_codes__dbt_backup" cascade
[0m18:52:15.864015 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
alter view "dev"."main"."stg_payment_types" rename to "stg_payment_types__dbt_backup"
[0m18:52:15.864771 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
alter view "dev"."main"."stg_taxi_zones" rename to "stg_taxi_zones__dbt_backup"
[0m18:52:15.866330 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:15.866684 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.869668 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m18:52:15.872093 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m18:52:15.872742 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
alter view "dev"."main"."stg_taxi_zones__dbt_tmp" rename to "stg_taxi_zones"
[0m18:52:15.873050 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m18:52:15.873582 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
alter view "dev"."main"."stg_payment_types__dbt_tmp" rename to "stg_payment_types"
[0m18:52:15.874874 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: Close
[0m18:52:15.875372 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.876191 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b1704f5-13c8-403b-905d-802e8cb7d35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0ac6ebec0>]}
[0m18:52:15.876516 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.877557 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: COMMIT
[0m18:52:15.878273 [info ] [Thread-4 (]: 18 of 91 OK created sql view model main.stg_rate_codes ......................... [[32mOK[0m in 0.20s]
[0m18:52:15.879651 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: COMMIT
[0m18:52:15.880201 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m18:52:15.880884 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m18:52:15.881281 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m18:52:15.881753 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: COMMIT
[0m18:52:15.882644 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m18:52:15.882891 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: COMMIT
[0m18:52:15.883597 [info ] [Thread-4 (]: 21 of 91 START test not_null_stg_rate_codes_rate_code_id ....................... [RUN]
[0m18:52:15.884726 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_rate_codes, now test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a)
[0m18:52:15.885171 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m18:52:15.888097 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m18:52:15.888563 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:52:15.890488 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m18:52:15.890978 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m18:52:15.891357 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
drop view if exists "dev"."main"."stg_taxi_zones__dbt_backup" cascade
[0m18:52:15.893199 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m18:52:15.894180 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
drop view if exists "dev"."main"."stg_payment_types__dbt_backup" cascade
[0m18:52:15.896080 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:52:15.896517 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m18:52:15.897646 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: Close
[0m18:52:15.899378 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m18:52:15.899748 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m18:52:15.900244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b1704f5-13c8-403b-905d-802e8cb7d35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0ac693a40>]}
[0m18:52:15.901495 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: Close
[0m18:52:15.902153 [info ] [Thread-1 (]: 20 of 91 OK created sql view model main.stg_taxi_zones ......................... [[32mOK[0m in 0.18s]
[0m18:52:15.902783 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b1704f5-13c8-403b-905d-802e8cb7d35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0aef3df70>]}
[0m18:52:15.903187 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m18:52:15.903719 [info ] [Thread-3 (]: 19 of 91 OK created sql view model main.stg_payment_types ...................... [[32mOK[0m in 0.19s]
[0m18:52:15.904273 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m18:52:15.904969 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.stg_payment_types
[0m18:52:15.905486 [info ] [Thread-1 (]: 22 of 91 START test not_null_stg_rate_codes_rate_code_name ..................... [RUN]
[0m18:52:15.905989 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m18:52:15.906758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_taxi_zones, now test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f)
[0m18:52:15.907352 [info ] [Thread-3 (]: 23 of 91 START test unique_stg_rate_codes_rate_code_id ......................... [RUN]
[0m18:52:15.907833 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m18:52:15.908352 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_payment_types, now test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3)
[0m18:52:15.911069 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m18:52:15.911378 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m18:52:15.911837 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m18:52:15.912500 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: BEGIN
[0m18:52:15.914944 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m18:52:15.915640 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:52:15.916870 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.917241 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m18:52:15.917661 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_id
from "dev"."main"."stg_rate_codes"
where rate_code_id is null



  
  
      
    ) dbt_internal_test
[0m18:52:15.918841 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.920127 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: ROLLBACK
[0m18:52:15.921011 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a'
[0m18:52:15.921393 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m18:52:15.921767 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m18:52:15.922104 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: Close
[0m18:52:15.924103 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m18:52:15.925785 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m18:52:15.926558 [info ] [Thread-4 (]: 21 of 91 PASS not_null_stg_rate_codes_rate_code_id ............................. [[32mPASS[0m in 0.04s]
[0m18:52:15.927559 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m18:52:15.928009 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m18:52:15.928469 [info ] [Thread-4 (]: 24 of 91 START test not_null_stg_taxi_zones_borough ............................ [RUN]
[0m18:52:15.928968 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b)
[0m18:52:15.929386 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m18:52:15.933371 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m18:52:15.934748 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m18:52:15.935199 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m18:52:15.935444 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: BEGIN
[0m18:52:15.935917 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: BEGIN
[0m18:52:15.936403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:15.936811 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:52:15.937785 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.938077 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.938324 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m18:52:15.938763 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m18:52:15.939204 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_name
from "dev"."main"."stg_rate_codes"
where rate_code_name is null



  
  
      
    ) dbt_internal_test
[0m18:52:15.939681 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rate_code_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_rate_codes"
where rate_code_id is not null
group by rate_code_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:52:15.940852 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.941984 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: ROLLBACK
[0m18:52:15.942322 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m18:52:15.942611 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:52:15.943133 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f'
[0m18:52:15.944759 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m18:52:15.946287 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: ROLLBACK
[0m18:52:15.946646 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: Close
[0m18:52:15.947754 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3'
[0m18:52:15.948524 [info ] [Thread-1 (]: 22 of 91 PASS not_null_stg_rate_codes_rate_code_name ........................... [[32mPASS[0m in 0.04s]
[0m18:52:15.948931 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: Close
[0m18:52:15.949460 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m18:52:15.950094 [info ] [Thread-3 (]: 23 of 91 PASS unique_stg_rate_codes_rate_code_id ............................... [[32mPASS[0m in 0.04s]
[0m18:52:15.950576 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m18:52:15.951212 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m18:52:15.951640 [info ] [Thread-1 (]: 25 of 91 START test not_null_stg_taxi_zones_location_id ........................ [RUN]
[0m18:52:15.952178 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m18:52:15.952635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf)
[0m18:52:15.953060 [info ] [Thread-3 (]: 26 of 91 START test not_null_stg_taxi_zones_zone_name .......................... [RUN]
[0m18:52:15.953498 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m18:52:15.954067 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84)
[0m18:52:15.956862 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m18:52:15.957203 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m18:52:15.957486 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m18:52:15.958204 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: BEGIN
[0m18:52:15.960940 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m18:52:15.961509 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:52:15.962694 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.963097 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m18:52:15.963650 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select borough
from "dev"."main"."stg_taxi_zones"
where borough is null



  
  
      
    ) dbt_internal_test
[0m18:52:15.965187 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.965524 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m18:52:15.966826 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: ROLLBACK
[0m18:52:15.967139 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m18:52:15.968580 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m18:52:15.969479 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b'
[0m18:52:15.971054 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m18:52:15.971771 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: Close
[0m18:52:15.972572 [info ] [Thread-4 (]: 24 of 91 PASS not_null_stg_taxi_zones_borough .................................. [[32mPASS[0m in 0.04s]
[0m18:52:15.973043 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m18:52:15.973431 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m18:52:15.973844 [info ] [Thread-4 (]: 27 of 91 START test unique_stg_taxi_zones_location_id .......................... [RUN]
[0m18:52:15.974292 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b, now test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c)
[0m18:52:15.974739 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m18:52:15.977608 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m18:52:15.978885 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m18:52:15.979514 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m18:52:15.979874 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: BEGIN
[0m18:52:15.980532 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: BEGIN
[0m18:52:15.981000 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:52:15.981508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:15.982331 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.982840 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.983103 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m18:52:15.983491 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m18:52:15.984021 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select zone_name
from "dev"."main"."stg_taxi_zones"
where zone_name is null



  
  
      
    ) dbt_internal_test
[0m18:52:15.984438 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "dev"."main"."stg_taxi_zones"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m18:52:15.985137 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m18:52:15.985801 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:52:15.987861 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m18:52:15.988286 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:52:15.989738 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: ROLLBACK
[0m18:52:15.991651 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: ROLLBACK
[0m18:52:15.992418 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84'
[0m18:52:15.992932 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf'
[0m18:52:15.993418 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: Close
[0m18:52:15.993912 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: Close
[0m18:52:15.994731 [info ] [Thread-3 (]: 26 of 91 PASS not_null_stg_taxi_zones_zone_name ................................ [[32mPASS[0m in 0.04s]
[0m18:52:15.995477 [info ] [Thread-1 (]: 25 of 91 PASS not_null_stg_taxi_zones_location_id .............................. [[32mPASS[0m in 0.04s]
[0m18:52:15.995994 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m18:52:15.996669 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m18:52:15.997230 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m18:52:15.997958 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m18:52:15.998573 [info ] [Thread-3 (]: 28 of 91 START test not_null_stg_payment_types_payment_type_id ................. [RUN]
[0m18:52:15.999055 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m18:52:15.999430 [info ] [Thread-1 (]: 29 of 91 START test not_null_stg_payment_types_payment_type_name ............... [RUN]
[0m18:52:16.000079 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84, now test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78)
[0m18:52:16.000582 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: BEGIN
[0m18:52:16.001153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf, now test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39)
[0m18:52:16.001651 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m18:52:16.002140 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:52:16.002671 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m18:52:16.005877 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m18:52:16.010495 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m18:52:16.010909 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m18:52:16.012048 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m18:52:16.012478 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_taxi_zones"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:52:16.014137 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:52:16.015376 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: ROLLBACK
[0m18:52:16.016224 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c'
[0m18:52:16.016690 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: Close
[0m18:52:16.017359 [info ] [Thread-4 (]: 27 of 91 PASS unique_stg_taxi_zones_location_id ................................ [[32mPASS[0m in 0.04s]
[0m18:52:16.017673 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m18:52:16.018123 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m18:52:16.020393 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m18:52:16.020714 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m18:52:16.021339 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m18:52:16.023517 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m18:52:16.023989 [info ] [Thread-4 (]: 30 of 91 START test unique_stg_payment_types_payment_type_id ................... [RUN]
[0m18:52:16.025005 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c, now test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534)
[0m18:52:16.025611 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m18:52:16.028980 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m18:52:16.030559 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m18:52:16.031061 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: BEGIN
[0m18:52:16.031414 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m18:52:16.031787 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:52:16.032298 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: BEGIN
[0m18:52:16.033324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:16.033577 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:52:16.034097 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:16.034442 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m18:52:16.034935 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m18:52:16.035798 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."stg_payment_types"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m18:52:16.036283 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_name
from "dev"."main"."stg_payment_types"
where payment_type_name is null



  
  
      
    ) dbt_internal_test
[0m18:52:16.037584 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:52:16.037967 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:16.039413 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: ROLLBACK
[0m18:52:16.040567 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: ROLLBACK
[0m18:52:16.040918 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m18:52:16.041518 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78'
[0m18:52:16.042202 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39'
[0m18:52:16.043989 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m18:52:16.044454 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: Close
[0m18:52:16.044921 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: Close
[0m18:52:16.046197 [info ] [Thread-3 (]: 28 of 91 PASS not_null_stg_payment_types_payment_type_id ....................... [[32mPASS[0m in 0.05s]
[0m18:52:16.046556 [info ] [Thread-1 (]: 29 of 91 PASS not_null_stg_payment_types_payment_type_name ..................... [[32mPASS[0m in 0.05s]
[0m18:52:16.047095 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m18:52:16.047640 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m18:52:16.048182 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.dim_locations
[0m18:52:16.049390 [info ] [Thread-3 (]: 31 of 91 START sql table model main.dim_locations .............................. [RUN]
[0m18:52:16.050150 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78, now model.nyc_taxi_pipeline_00.dim_locations)
[0m18:52:16.050899 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_locations
[0m18:52:16.052913 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_locations"
[0m18:52:16.055074 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m18:52:16.055836 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: BEGIN
[0m18:52:16.056202 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:52:16.057778 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:52:16.058248 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m18:52:16.058655 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_payment_types"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:52:16.060228 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:52:16.061530 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: ROLLBACK
[0m18:52:16.062356 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534'
[0m18:52:16.062779 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: Close
[0m18:52:16.063358 [info ] [Thread-4 (]: 30 of 91 PASS unique_stg_payment_types_payment_type_id ......................... [[32mPASS[0m in 0.04s]
[0m18:52:16.063882 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m18:52:16.064253 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.dim_locations
[0m18:52:16.064838 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.dim_payment_types
[0m18:52:16.067252 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m18:52:16.067958 [info ] [Thread-1 (]: 32 of 91 START sql table model main.dim_payment_types .......................... [RUN]
[0m18:52:16.068516 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
DESCRIBE (select * from (
        /*
    Dimension table: TLC Taxi Zone locations.
*/

with zones as (
    select * from "dev"."main"."stg_taxi_zones"
),

final as (
    select
        location_id,
        borough,
        zone_name,
        service_zone
    from zones
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:52:16.069152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39, now model.nyc_taxi_pipeline_00.dim_payment_types)
[0m18:52:16.069689 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:52:16.070472 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_payment_types
[0m18:52:16.073172 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m18:52:16.073479 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m18:52:16.074711 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m18:52:16.075126 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as location_id, 
      
    cast(null as varchar)
 as borough, 
      
    cast(null as varchar)
 as zone_name, 
      
    cast(null as varchar)
 as service_zone
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:52:16.076205 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:52:16.077579 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_locations"
[0m18:52:16.083855 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.dim_payment_types
[0m18:52:16.087199 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m18:52:16.087789 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
DESCRIBE (select * from (
        /*
    Dimension table: Payment type descriptions.
*/

with payment_types as (
    select * from "dev"."main"."stg_payment_types"
),

final as (
    select
        payment_type_id,
        payment_type_name
    from payment_types
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:52:16.088340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:16.089229 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m18:52:16.089625 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: BEGIN
[0m18:52:16.089874 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:52:16.091130 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m18:52:16.091415 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:52:16.091800 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as payment_type_id, 
      
    cast(null as varchar)
 as payment_type_name
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:52:16.092281 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m18:52:16.093001 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_locations__dbt_tmp"
  
  (
    location_id integer,
    borough varchar,
    zone_name varchar,
    service_zone varchar
    
    )
 ;
    insert into "dev"."main"."dim_locations__dbt_tmp" 
  (
    
      
      location_id ,
    
      
      borough ,
    
      
      zone_name ,
    
      
      service_zone 
    
  )
 (
      
    select location_id, borough, zone_name, service_zone
    from (
        /*
    Dimension table: TLC Taxi Zone locations.
*/

with zones as (
    select * from "dev"."main"."stg_taxi_zones"
),

final as (
    select
        location_id,
        borough,
        zone_name,
        service_zone
    from zones
)

select * from final
    ) as model_subq
    );
  
  
[0m18:52:16.093270 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:16.094524 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m18:52:16.095006 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:52:16.097289 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m18:52:16.097696 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
alter table "dev"."main"."dim_locations" rename to "dim_locations__dbt_backup"
[0m18:52:16.098642 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:52:16.100752 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m18:52:16.101127 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
alter table "dev"."main"."dim_locations__dbt_tmp" rename to "dim_locations"
[0m18:52:16.101819 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:52:16.103034 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: COMMIT
[0m18:52:16.103397 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m18:52:16.103798 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m18:52:16.104264 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: BEGIN
[0m18:52:16.104692 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: COMMIT
[0m18:52:16.105555 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:16.106165 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m18:52:16.106563 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_payment_types__dbt_tmp"
  
  (
    payment_type_id integer,
    payment_type_name varchar
    
    )
 ;
    insert into "dev"."main"."dim_payment_types__dbt_tmp" 
  (
    
      
      payment_type_id ,
    
      
      payment_type_name 
    
  )
 (
      
    select payment_type_id, payment_type_name
    from (
        /*
    Dimension table: Payment type descriptions.
*/

with payment_types as (
    select * from "dev"."main"."stg_payment_types"
),

final as (
    select
        payment_type_id,
        payment_type_name
    from payment_types
)

select * from final
    ) as model_subq
    );
  
  
[0m18:52:16.108478 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:16.110593 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m18:52:16.110927 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m18:52:16.111227 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
alter table "dev"."main"."dim_payment_types" rename to "dim_payment_types__dbt_backup"
[0m18:52:16.112717 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m18:52:16.113475 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
drop table if exists "dev"."main"."dim_locations__dbt_backup" cascade
[0m18:52:16.113768 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:16.115717 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m18:52:16.116093 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
alter table "dev"."main"."dim_payment_types__dbt_tmp" rename to "dim_payment_types"
[0m18:52:16.116355 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:52:16.116916 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:16.117874 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: Close
[0m18:52:16.119117 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: COMMIT
[0m18:52:16.119852 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b1704f5-13c8-403b-905d-802e8cb7d35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0ac1075f0>]}
[0m18:52:16.120109 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m18:52:16.120769 [info ] [Thread-3 (]: 31 of 91 OK created sql table model main.dim_locations ......................... [[32mOK[0m in 0.07s]
[0m18:52:16.121253 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: COMMIT
[0m18:52:16.121859 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.dim_locations
[0m18:52:16.122988 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m18:52:16.123373 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m18:52:16.123686 [info ] [Thread-4 (]: 33 of 91 START test not_null_dim_locations_borough ............................. [RUN]
[0m18:52:16.124165 [info ] [Thread-3 (]: 34 of 91 START test not_null_dim_locations_location_id ......................... [RUN]
[0m18:52:16.124904 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534, now test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af)
[0m18:52:16.125765 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_locations, now test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476)
[0m18:52:16.126198 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:52:16.126518 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m18:52:16.126998 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m18:52:16.129004 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m18:52:16.131562 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m18:52:16.134083 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m18:52:16.134595 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
drop table if exists "dev"."main"."dim_payment_types__dbt_backup" cascade
[0m18:52:16.138771 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:52:16.139901 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: Close
[0m18:52:16.141034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b1704f5-13c8-403b-905d-802e8cb7d35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0aef49ee0>]}
[0m18:52:16.141363 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m18:52:16.141902 [info ] [Thread-1 (]: 32 of 91 OK created sql table model main.dim_payment_types ..................... [[32mOK[0m in 0.07s]
[0m18:52:16.142485 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m18:52:16.145303 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m18:52:16.146077 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.dim_payment_types
[0m18:52:16.148087 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m18:52:16.148994 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m18:52:16.149944 [info ] [Thread-1 (]: 35 of 91 START test not_null_dim_locations_zone_name ........................... [RUN]
[0m18:52:16.150470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_payment_types, now test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d)
[0m18:52:16.150863 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m18:52:16.153857 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m18:52:16.155708 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m18:52:16.156161 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: BEGIN
[0m18:52:16.156519 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m18:52:16.156860 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:52:16.157453 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: BEGIN
[0m18:52:16.158688 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:52:16.159008 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:52:16.159449 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m18:52:16.160202 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "dev"."main"."dim_locations"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m18:52:16.160546 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:52:16.161097 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m18:52:16.161482 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select borough
from "dev"."main"."dim_locations"
where borough is null



  
  
      
    ) dbt_internal_test
[0m18:52:16.161838 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:52:16.163193 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: ROLLBACK
[0m18:52:16.163585 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m18:52:16.164236 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476'
[0m18:52:16.164545 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:52:16.165898 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m18:52:16.166315 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: Close
[0m18:52:16.167546 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: ROLLBACK
[0m18:52:16.168435 [info ] [Thread-3 (]: 34 of 91 PASS not_null_dim_locations_location_id ............................... [[32mPASS[0m in 0.04s]
[0m18:52:16.169091 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af'
[0m18:52:16.169618 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m18:52:16.170063 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: Close
[0m18:52:16.170742 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m18:52:16.171524 [info ] [Thread-4 (]: 33 of 91 PASS not_null_dim_locations_borough ................................... [[32mPASS[0m in 0.05s]
[0m18:52:16.171835 [info ] [Thread-3 (]: 36 of 91 START test unique_dim_locations_location_id ........................... [RUN]
[0m18:52:16.172495 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m18:52:16.173009 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476, now test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d)
[0m18:52:16.173479 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m18:52:16.173960 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m18:52:16.174432 [info ] [Thread-4 (]: 37 of 91 START test not_null_dim_payment_types_payment_type_id ................. [RUN]
[0m18:52:16.177229 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m18:52:16.177837 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af, now test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10)
[0m18:52:16.178459 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m18:52:16.181105 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m18:52:16.181459 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m18:52:16.182087 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: BEGIN
[0m18:52:16.182456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:16.183156 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:16.183474 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m18:52:16.183825 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select zone_name
from "dev"."main"."dim_locations"
where zone_name is null



  
  
      
    ) dbt_internal_test
[0m18:52:16.184780 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:16.186038 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: ROLLBACK
[0m18:52:16.186904 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d'
[0m18:52:16.187233 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m18:52:16.187534 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: Close
[0m18:52:16.189664 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m18:52:16.189972 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m18:52:16.190633 [info ] [Thread-1 (]: 35 of 91 PASS not_null_dim_locations_zone_name ................................. [[32mPASS[0m in 0.04s]
[0m18:52:16.192642 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m18:52:16.193219 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m18:52:16.194006 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m18:52:16.194411 [info ] [Thread-1 (]: 38 of 91 START test not_null_dim_payment_types_payment_type_name ............... [RUN]
[0m18:52:16.194947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d, now test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0)
[0m18:52:16.195410 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m18:52:16.198559 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m18:52:16.199843 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m18:52:16.200286 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: BEGIN
[0m18:52:16.200647 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m18:52:16.200951 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:52:16.201467 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: BEGIN
[0m18:52:16.202438 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:52:16.202876 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:52:16.203391 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:52:16.203765 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m18:52:16.204249 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m18:52:16.204702 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "dev"."main"."dim_locations"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:52:16.205149 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."dim_payment_types"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m18:52:16.206643 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:52:16.206954 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m18:52:16.207187 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:52:16.208442 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: ROLLBACK
[0m18:52:16.210290 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m18:52:16.212930 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: ROLLBACK
[0m18:52:16.213522 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d'
[0m18:52:16.214397 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10'
[0m18:52:16.214733 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: Close
[0m18:52:16.215084 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: Close
[0m18:52:16.215710 [info ] [Thread-3 (]: 36 of 91 PASS unique_dim_locations_location_id ................................. [[32mPASS[0m in 0.04s]
[0m18:52:16.216372 [info ] [Thread-4 (]: 37 of 91 PASS not_null_dim_payment_types_payment_type_id ....................... [[32mPASS[0m in 0.04s]
[0m18:52:16.216793 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m18:52:16.217462 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m18:52:16.218024 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m18:52:16.218952 [info ] [Thread-3 (]: 39 of 91 START test unique_dim_payment_types_payment_type_id ................... [RUN]
[0m18:52:16.219483 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d, now test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62)
[0m18:52:16.219902 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m18:52:16.222405 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m18:52:16.224690 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m18:52:16.225147 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: BEGIN
[0m18:52:16.225553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:16.226586 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:16.227070 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m18:52:16.227441 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_name
from "dev"."main"."dim_payment_types"
where payment_type_name is null



  
  
      
    ) dbt_internal_test
[0m18:52:16.228462 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:16.229632 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: ROLLBACK
[0m18:52:16.230453 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0'
[0m18:52:16.230906 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: Close
[0m18:52:16.231595 [info ] [Thread-1 (]: 38 of 91 PASS not_null_dim_payment_types_payment_type_name ..................... [[32mPASS[0m in 0.04s]
[0m18:52:16.232296 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m18:52:16.233880 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m18:52:16.235539 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m18:52:16.246343 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m18:52:16.246841 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: BEGIN
[0m18:52:16.247257 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:52:16.248023 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:52:16.248369 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m18:52:16.248786 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."dim_payment_types"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:52:16.250011 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:52:16.251142 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: ROLLBACK
[0m18:52:16.252095 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62'
[0m18:52:16.252660 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: Close
[0m18:52:16.253340 [info ] [Thread-3 (]: 39 of 91 PASS unique_dim_payment_types_payment_type_id ......................... [[32mPASS[0m in 0.03s]
[0m18:52:16.253905 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m18:52:17.119123 [debug] [Thread-2 (]: SQL status: OK in 1.796 seconds
[0m18:52:17.121214 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m18:52:17.121599 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
alter table "dev"."main"."stg_yellow_trips" rename to "stg_yellow_trips__dbt_backup"
[0m18:52:17.122249 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:52:17.123820 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m18:52:17.124104 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
alter table "dev"."main"."stg_yellow_trips__dbt_tmp" rename to "stg_yellow_trips"
[0m18:52:17.124575 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:52:17.125326 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: COMMIT
[0m18:52:17.125603 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m18:52:17.125876 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: COMMIT
[0m18:52:17.163612 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m18:52:17.165283 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m18:52:17.165617 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
drop table if exists "dev"."main"."stg_yellow_trips__dbt_backup" cascade
[0m18:52:17.169663 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m18:52:17.170567 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: Close
[0m18:52:17.231428 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b1704f5-13c8-403b-905d-802e8cb7d35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0aef3f4a0>]}
[0m18:52:17.232315 [info ] [Thread-2 (]: 2 of 91 OK created sql table model main.stg_yellow_trips ....................... [[32mOK[0m in 1.99s]
[0m18:52:17.232952 [debug] [Thread-2 (]: Finished running node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m18:52:17.233849 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m18:52:17.234116 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m18:52:17.234361 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m18:52:17.234599 [info ] [Thread-4 (]: 40 of 91 START test accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6  [RUN]
[0m18:52:17.234836 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m18:52:17.235667 [info ] [Thread-1 (]: 41 of 91 START test accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99  [RUN]
[0m18:52:17.236130 [info ] [Thread-3 (]: 42 of 91 START test accepted_values_stg_yellow_trips_vendor_id__1__2__6 ........ [RUN]
[0m18:52:17.236690 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44)
[0m18:52:17.237074 [info ] [Thread-2 (]: 43 of 91 START test assert_fare_not_exceeds_total .............................. [RUN]
[0m18:52:17.237454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098)
[0m18:52:17.237817 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27)
[0m18:52:17.238232 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m18:52:17.238606 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_yellow_trips, now test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total)
[0m18:52:17.238965 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m18:52:17.239346 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m18:52:17.244312 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m18:52:17.244800 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m18:52:17.247215 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m18:52:17.249559 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m18:52:17.251530 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m18:52:17.254016 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m18:52:17.254281 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m18:52:17.257177 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m18:52:17.257527 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m18:52:17.258738 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m18:52:17.260208 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m18:52:17.260455 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m18:52:17.261979 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m18:52:17.262973 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m18:52:17.263351 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: BEGIN
[0m18:52:17.263723 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:52:17.264730 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m18:52:17.265095 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m18:52:17.265384 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: BEGIN
[0m18:52:17.265860 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: BEGIN
[0m18:52:17.266316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:17.266586 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m18:52:17.266812 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:52:17.267306 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: BEGIN
[0m18:52:17.267913 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:52:17.280261 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m18:52:17.280590 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m18:52:17.280813 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m18:52:17.281065 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m18:52:17.281281 [debug] [Thread-2 (]: SQL status: OK in 0.013 seconds
[0m18:52:17.281554 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m18:52:17.281863 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m18:52:17.282228 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rate_code_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by rate_code_id

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5','6','99'
)



  
  
      
    ) dbt_internal_test
[0m18:52:17.282551 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m18:52:17.282885 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        payment_type_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by payment_type_id

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6'
)



  
  
      
    ) dbt_internal_test
[0m18:52:17.283213 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        vendor_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by vendor_id

)

select *
from all_values
where value_field not in (
    '1','2','6'
)



  
  
      
    ) dbt_internal_test
[0m18:52:17.283797 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
    Singular test: fare_amount should not exceed total_amount.
*/

select
    trip_id,
    fare_amount,
    total_amount
from "dev"."main"."stg_yellow_trips"
where fare_amount > total_amount + 0.01
  and total_amount > 0
  
  
      
    ) dbt_internal_test
[0m18:52:17.299783 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m18:52:17.302524 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: ROLLBACK
[0m18:52:17.304773 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098'
[0m18:52:17.306393 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: Close
[0m18:52:17.309451 [info ] [Thread-1 (]: 41 of 91 PASS accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99  [[32mPASS[0m in 0.07s]
[0m18:52:17.310976 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m18:52:17.312644 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m18:52:17.313829 [info ] [Thread-1 (]: 44 of 91 START test not_null_stg_yellow_trips_dropoff_datetime ................. [RUN]
[0m18:52:17.314233 [debug] [Thread-3 (]: SQL status: OK in 0.029 seconds
[0m18:52:17.314476 [debug] [Thread-4 (]: SQL status: OK in 0.030 seconds
[0m18:52:17.315440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052)
[0m18:52:17.317705 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: ROLLBACK
[0m18:52:17.318970 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: ROLLBACK
[0m18:52:17.319348 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m18:52:17.319624 [debug] [Thread-2 (]: SQL status: OK in 0.033 seconds
[0m18:52:17.320511 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27'
[0m18:52:17.321125 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44'
[0m18:52:17.324044 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m18:52:17.325378 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: ROLLBACK
[0m18:52:17.325670 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: Close
[0m18:52:17.326162 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: Close
[0m18:52:17.327129 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total'
[0m18:52:17.327666 [info ] [Thread-3 (]: 42 of 91 PASS accepted_values_stg_yellow_trips_vendor_id__1__2__6 .............. [[32mPASS[0m in 0.09s]
[0m18:52:17.328202 [info ] [Thread-4 (]: 40 of 91 PASS accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6  [[32mPASS[0m in 0.09s]
[0m18:52:17.328463 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: Close
[0m18:52:17.328989 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m18:52:17.329554 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m18:52:17.330275 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m18:52:17.330861 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m18:52:17.331371 [info ] [Thread-3 (]: 45 of 91 START test not_null_stg_yellow_trips_dropoff_location_id .............. [RUN]
[0m18:52:17.331921 [info ] [Thread-4 (]: 46 of 91 START test not_null_stg_yellow_trips_fare_amount ...................... [RUN]
[0m18:52:17.333135 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048)
[0m18:52:17.333714 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97)
[0m18:52:17.334312 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m18:52:17.334832 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m18:52:17.335153 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m18:52:17.337929 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m18:52:17.338316 [info ] [Thread-2 (]: 43 of 91 PASS assert_fare_not_exceeds_total .................................... [[32mPASS[0m in 0.10s]
[0m18:52:17.340235 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m18:52:17.341722 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m18:52:17.342560 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m18:52:17.343340 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m18:52:17.343737 [info ] [Thread-2 (]: 47 of 91 START test not_null_stg_yellow_trips_pickup_datetime .................. [RUN]
[0m18:52:17.344197 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed)
[0m18:52:17.344547 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m18:52:17.347347 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m18:52:17.348495 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m18:52:17.348734 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m18:52:17.351211 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m18:52:17.352849 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m18:52:17.353815 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m18:52:17.354146 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: BEGIN
[0m18:52:17.354408 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m18:52:17.354658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:17.356332 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m18:52:17.357449 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m18:52:17.357866 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m18:52:17.358093 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: BEGIN
[0m18:52:17.358472 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: BEGIN
[0m18:52:17.358852 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:52:17.359235 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:52:17.361099 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m18:52:17.361562 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: BEGIN
[0m18:52:17.361916 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:52:17.373930 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m18:52:17.374346 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m18:52:17.374627 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m18:52:17.374947 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m18:52:17.375231 [debug] [Thread-2 (]: SQL status: OK in 0.013 seconds
[0m18:52:17.375505 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m18:52:17.375970 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m18:52:17.376454 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_datetime
from "dev"."main"."stg_yellow_trips"
where dropoff_datetime is null



  
  
      
    ) dbt_internal_test
[0m18:52:17.376896 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m18:52:17.377298 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fare_amount
from "dev"."main"."stg_yellow_trips"
where fare_amount is null



  
  
      
    ) dbt_internal_test
[0m18:52:17.377687 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_location_id
from "dev"."main"."stg_yellow_trips"
where dropoff_location_id is null



  
  
      
    ) dbt_internal_test
[0m18:52:17.378474 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "dev"."main"."stg_yellow_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m18:52:17.379020 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:17.380097 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:52:17.380490 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:52:17.381377 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:52:17.382607 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: ROLLBACK
[0m18:52:17.384026 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: ROLLBACK
[0m18:52:17.385297 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: ROLLBACK
[0m18:52:17.386420 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: ROLLBACK
[0m18:52:17.387030 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052'
[0m18:52:17.387512 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97'
[0m18:52:17.388147 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048'
[0m18:52:17.388749 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed'
[0m18:52:17.389143 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: Close
[0m18:52:17.389522 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: Close
[0m18:52:17.389894 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: Close
[0m18:52:17.390288 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: Close
[0m18:52:17.390915 [info ] [Thread-1 (]: 44 of 91 PASS not_null_stg_yellow_trips_dropoff_datetime ....................... [[32mPASS[0m in 0.08s]
[0m18:52:17.391420 [info ] [Thread-4 (]: 46 of 91 PASS not_null_stg_yellow_trips_fare_amount ............................ [[32mPASS[0m in 0.06s]
[0m18:52:17.391829 [info ] [Thread-3 (]: 45 of 91 PASS not_null_stg_yellow_trips_dropoff_location_id .................... [[32mPASS[0m in 0.06s]
[0m18:52:17.392481 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m18:52:17.392940 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m18:52:17.393397 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m18:52:17.394173 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m18:52:17.394715 [info ] [Thread-2 (]: 47 of 91 PASS not_null_stg_yellow_trips_pickup_datetime ........................ [[32mPASS[0m in 0.05s]
[0m18:52:17.395028 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m18:52:17.395516 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m18:52:17.396093 [info ] [Thread-1 (]: 48 of 91 START test not_null_stg_yellow_trips_pickup_location_id ............... [RUN]
[0m18:52:17.396605 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m18:52:17.396974 [info ] [Thread-4 (]: 49 of 91 START test not_null_stg_yellow_trips_total_amount ..................... [RUN]
[0m18:52:17.397420 [info ] [Thread-3 (]: 50 of 91 START test not_null_stg_yellow_trips_trip_distance_miles .............. [RUN]
[0m18:52:17.397918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1)
[0m18:52:17.398363 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m18:52:17.398821 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6)
[0m18:52:17.399247 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7)
[0m18:52:17.399671 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m18:52:17.400094 [info ] [Thread-2 (]: 51 of 91 START test not_null_stg_yellow_trips_trip_id .......................... [RUN]
[0m18:52:17.400737 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m18:52:17.401154 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m18:52:17.404183 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m18:52:17.404820 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1)
[0m18:52:17.407756 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m18:52:17.409995 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m18:52:17.410710 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m18:52:17.413604 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m18:52:17.418335 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m18:52:17.418711 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m18:52:17.420608 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m18:52:17.420971 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m18:52:17.422278 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m18:52:17.422516 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m18:52:17.423915 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m18:52:17.426925 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m18:52:17.431115 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m18:52:17.431757 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: BEGIN
[0m18:52:17.432131 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m18:52:17.432495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:17.432923 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m18:52:17.433259 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: BEGIN
[0m18:52:17.434041 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m18:52:17.434358 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: BEGIN
[0m18:52:17.434807 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:52:17.435188 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: BEGIN
[0m18:52:17.435542 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:52:17.436101 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:52:17.450746 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m18:52:17.451105 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m18:52:17.451353 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m18:52:17.451754 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m18:52:17.452044 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m18:52:17.452263 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m18:52:17.452634 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m18:52:17.452999 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_distance_miles
from "dev"."main"."stg_yellow_trips"
where trip_distance_miles is null



  
  
      
    ) dbt_internal_test
[0m18:52:17.453349 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m18:52:17.453720 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."stg_yellow_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m18:52:17.454105 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_location_id
from "dev"."main"."stg_yellow_trips"
where pickup_location_id is null



  
  
      
    ) dbt_internal_test
[0m18:52:17.454733 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."stg_yellow_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m18:52:17.455104 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:52:17.455890 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:52:17.456187 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:17.457228 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: ROLLBACK
[0m18:52:17.457468 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:52:17.458474 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: ROLLBACK
[0m18:52:17.459323 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: ROLLBACK
[0m18:52:17.460007 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7'
[0m18:52:17.461003 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: ROLLBACK
[0m18:52:17.461519 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6'
[0m18:52:17.462194 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1'
[0m18:52:17.462589 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: Close
[0m18:52:17.463341 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1'
[0m18:52:17.463564 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: Close
[0m18:52:17.464024 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: Close
[0m18:52:17.464726 [info ] [Thread-3 (]: 50 of 91 PASS not_null_stg_yellow_trips_trip_distance_miles .................... [[32mPASS[0m in 0.07s]
[0m18:52:17.465040 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: Close
[0m18:52:17.465758 [info ] [Thread-4 (]: 49 of 91 PASS not_null_stg_yellow_trips_total_amount ........................... [[32mPASS[0m in 0.07s]
[0m18:52:17.466211 [info ] [Thread-1 (]: 48 of 91 PASS not_null_stg_yellow_trips_pickup_location_id ..................... [[32mPASS[0m in 0.07s]
[0m18:52:17.466597 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m18:52:17.467272 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m18:52:17.467970 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m18:52:17.468704 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m18:52:17.469356 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m18:52:17.469832 [info ] [Thread-2 (]: 51 of 91 PASS not_null_stg_yellow_trips_trip_id ................................ [[32mPASS[0m in 0.07s]
[0m18:52:17.470171 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m18:52:17.470679 [info ] [Thread-3 (]: 52 of 91 START test not_null_stg_yellow_trips_vendor_id ........................ [RUN]
[0m18:52:17.471163 [info ] [Thread-4 (]: 53 of 91 START test unique_stg_yellow_trips_trip_id ............................ [RUN]
[0m18:52:17.471791 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m18:52:17.472169 [info ] [Thread-1 (]: 54 of 91 START test relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_  [RUN]
[0m18:52:17.472709 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57)
[0m18:52:17.473274 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6, now test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965)
[0m18:52:17.473889 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m18:52:17.474444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1, now test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a)
[0m18:52:17.474959 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m18:52:17.475577 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m18:52:17.476090 [info ] [Thread-2 (]: 55 of 91 START test relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_  [RUN]
[0m18:52:17.476555 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m18:52:17.479642 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m18:52:17.483130 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m18:52:17.483839 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1, now test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f)
[0m18:52:17.489272 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m18:52:17.490152 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m18:52:17.493690 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m18:52:17.497665 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m18:52:17.499559 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m18:52:17.499926 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m18:52:17.500294 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m18:52:17.501628 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m18:52:17.501881 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m18:52:17.502993 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m18:52:17.504592 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m18:52:17.507419 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m18:52:17.508082 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: BEGIN
[0m18:52:17.508476 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m18:52:17.508903 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m18:52:17.509215 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:52:17.509731 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: BEGIN
[0m18:52:17.510138 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: BEGIN
[0m18:52:17.510439 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m18:52:17.511093 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:52:17.511439 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:52:17.511837 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: BEGIN
[0m18:52:17.512528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:17.526872 [debug] [Thread-4 (]: SQL status: OK in 0.018 seconds
[0m18:52:17.527255 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m18:52:17.527589 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m18:52:17.527874 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m18:52:17.528147 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m18:52:17.528666 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m18:52:17.529146 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m18:52:17.529586 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m18:52:17.529997 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_yellow_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:52:17.530398 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "dev"."main"."stg_yellow_trips"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m18:52:17.530805 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select pickup_location_id as from_field
    from "dev"."main"."stg_yellow_trips"
    where pickup_location_id is not null
),

parent as (
    select location_id as to_field
    from "dev"."main"."stg_taxi_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m18:52:17.531233 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select dropoff_location_id as from_field
    from "dev"."main"."stg_yellow_trips"
    where dropoff_location_id is not null
),

parent as (
    select location_id as to_field
    from "dev"."main"."stg_taxi_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m18:52:17.532721 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:52:17.537170 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: ROLLBACK
[0m18:52:17.540451 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57'
[0m18:52:17.542609 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: Close
[0m18:52:17.544173 [info ] [Thread-3 (]: 52 of 91 PASS not_null_stg_yellow_trips_vendor_id .............................. [[32mPASS[0m in 0.07s]
[0m18:52:17.545556 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m18:52:17.650051 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m18:52:17.650637 [debug] [Thread-2 (]: SQL status: OK in 0.118 seconds
[0m18:52:17.652240 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: ROLLBACK
[0m18:52:17.653629 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: ROLLBACK
[0m18:52:17.654318 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a'
[0m18:52:17.655224 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f'
[0m18:52:17.655876 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: Close
[0m18:52:17.656559 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: Close
[0m18:52:17.657750 [info ] [Thread-1 (]: 54 of 91 PASS relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_  [[32mPASS[0m in 0.18s]
[0m18:52:17.659011 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m18:52:17.658510 [info ] [Thread-2 (]: 55 of 91 PASS relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_  [[32mPASS[0m in 0.17s]
[0m18:52:17.664993 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m18:52:17.705698 [debug] [Thread-4 (]: SQL status: OK in 0.174 seconds
[0m18:52:17.707098 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: ROLLBACK
[0m18:52:17.707819 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965'
[0m18:52:17.708169 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: Close
[0m18:52:17.728987 [info ] [Thread-4 (]: 53 of 91 PASS unique_stg_yellow_trips_trip_id .................................. [[32mPASS[0m in 0.26s]
[0m18:52:17.730696 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m18:52:17.731587 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m18:52:17.732108 [info ] [Thread-3 (]: 56 of 91 START sql view model main.int_trip_metrics ............................ [RUN]
[0m18:52:17.732602 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57, now model.nyc_taxi_pipeline_00.int_trip_metrics)
[0m18:52:17.733089 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m18:52:17.737380 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m18:52:17.743482 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m18:52:17.745949 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m18:52:17.751192 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m18:52:17.751679 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: BEGIN
[0m18:52:17.752075 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:52:17.766494 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m18:52:17.766989 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m18:52:17.767365 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */

  
  create view "dev"."main"."int_trip_metrics__dbt_tmp" as (
    /*
    Intermediate model: Trip-level enrichment with calculated metrics.
    Uses adapter-dispatched macros for cross-dialect compatibility.
*/

with trips as (
    select * from "dev"."main"."stg_yellow_trips"
),

enriched as (
    select
        trip_id,
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        payment_type_id,
        pickup_datetime,
        dropoff_datetime,
        passenger_count,
        trip_distance_miles,
        store_and_fwd_flag,

        -- calculated: duration in minutes
        
    datediff('minute', pickup_datetime, dropoff_datetime)
 as trip_duration_minutes,

        -- calculated: average speed (avoid division by zero)
        case
            when 
    datediff('minute', pickup_datetime, dropoff_datetime)
 > 0
            then round(
                trip_distance_miles / (
    datediff('minute', pickup_datetime, dropoff_datetime)
 / 60.0),
                2
            )
            else null
        end as avg_speed_mph,

        -- calculated: cost per mile
        case
            when trip_distance_miles > 0
            then round(fare_amount / trip_distance_miles, 2)
            else null
        end as cost_per_mile,

        -- calculated: tip percentage
        case
            when fare_amount > 0
            then round((tip_amount / fare_amount) * 100, 2)
            else null
        end as tip_percentage,

        -- time dimensions (using adapter-dispatched macros)
        date_trunc('day', pickup_datetime)::date as pickup_date,
        extract(hour from pickup_datetime) as pickup_hour,
        
    dayname(pickup_datetime)
 as pickup_day_of_week,
        case
            when extract(dow from pickup_datetime) in (0, 6) then true
            else false
        end as is_weekend,

        -- financials passthrough
        fare_amount,
        extra_amount,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount,
        congestion_surcharge,
        airport_fee

    from trips
)

select *
from enriched
where trip_duration_minutes between 1 and 720
  and (avg_speed_mph is null or avg_speed_mph < 100)
  );

[0m18:52:17.768752 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:52:17.771000 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m18:52:17.771996 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
alter view "dev"."main"."int_trip_metrics" rename to "int_trip_metrics__dbt_backup"
[0m18:52:17.772663 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:52:17.774285 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m18:52:17.774628 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
alter view "dev"."main"."int_trip_metrics__dbt_tmp" rename to "int_trip_metrics"
[0m18:52:17.775663 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:52:17.776824 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: COMMIT
[0m18:52:17.777260 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m18:52:17.777612 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: COMMIT
[0m18:52:17.783213 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m18:52:17.785038 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m18:52:17.785551 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
drop view if exists "dev"."main"."int_trip_metrics__dbt_backup" cascade
[0m18:52:17.787986 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:52:17.788946 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: Close
[0m18:52:17.824243 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b1704f5-13c8-403b-905d-802e8cb7d35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0ac6843b0>]}
[0m18:52:17.825000 [info ] [Thread-3 (]: 56 of 91 OK created sql view model main.int_trip_metrics ....................... [[32mOK[0m in 0.09s]
[0m18:52:17.825481 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m18:52:17.826471 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m18:52:17.827071 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m18:52:17.827545 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m18:52:17.827877 [info ] [Thread-2 (]: 57 of 91 START test assert_trip_duration_positive .............................. [RUN]
[0m18:52:17.828205 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m18:52:17.828476 [info ] [Thread-4 (]: 58 of 91 START test dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0  [RUN]
[0m18:52:17.828922 [info ] [Thread-1 (]: 59 of 91 START test dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1  [RUN]
[0m18:52:17.829589 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f, now test.nyc_taxi_pipeline_00.assert_trip_duration_positive)
[0m18:52:17.829998 [info ] [Thread-3 (]: 60 of 91 START test not_null_int_trip_metrics_is_weekend ....................... [RUN]
[0m18:52:17.830453 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574)
[0m18:52:17.830822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718)
[0m18:52:17.831168 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m18:52:17.831596 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_trip_metrics, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed)
[0m18:52:17.832045 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m18:52:17.832458 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m18:52:17.834354 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m18:52:17.834753 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m18:52:17.839380 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m18:52:17.842167 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m18:52:17.844738 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m18:52:17.848211 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m18:52:17.851393 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m18:52:17.852081 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m18:52:17.852369 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m18:52:17.908679 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m18:52:17.909987 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m18:52:17.911071 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m18:52:17.912277 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m18:52:17.913436 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m18:52:17.913906 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: BEGIN
[0m18:52:17.914261 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:52:17.915867 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m18:52:17.916318 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: BEGIN
[0m18:52:17.916759 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m18:52:17.917071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:17.917633 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: BEGIN
[0m18:52:17.918316 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:52:17.918723 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m18:52:17.919232 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: BEGIN
[0m18:52:17.919636 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:52:17.934142 [debug] [Thread-2 (]: SQL status: OK in 0.020 seconds
[0m18:52:17.934559 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m18:52:17.934846 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m18:52:17.935110 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m18:52:17.935390 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m18:52:17.935832 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m18:52:17.936240 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m18:52:17.936618 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m18:52:17.936998 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
    Singular test: No trip should have negative duration.
*/

select
    trip_id,
    pickup_datetime,
    dropoff_datetime,
    trip_duration_minutes
from "dev"."main"."int_trip_metrics"
where trip_duration_minutes < 0
  
  
      
    ) dbt_internal_test
[0m18:52:17.937426 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_trip_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not trip_duration_minutes >= 1
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not trip_duration_minutes <= 720
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m18:52:17.937828 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_trip_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m18:52:17.938322 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."int_trip_metrics"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m18:52:17.940362 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:52:17.940847 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:52:17.943808 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: ROLLBACK
[0m18:52:17.946432 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: ROLLBACK
[0m18:52:17.947542 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.assert_trip_duration_positive'
[0m18:52:17.949203 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed'
[0m18:52:17.950307 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: Close
[0m18:52:17.953342 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: Close
[0m18:52:17.955850 [info ] [Thread-2 (]: 57 of 91 PASS assert_trip_duration_positive .................................... [[32mPASS[0m in 0.13s]
[0m18:52:17.957724 [info ] [Thread-3 (]: 60 of 91 PASS not_null_int_trip_metrics_is_weekend ............................. [[32mPASS[0m in 0.13s]
[0m18:52:17.958888 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m18:52:17.961720 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m18:52:17.964158 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m18:52:17.966096 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m18:52:17.967993 [info ] [Thread-2 (]: 61 of 91 START test not_null_int_trip_metrics_pickup_date ...................... [RUN]
[0m18:52:17.970308 [info ] [Thread-3 (]: 62 of 91 START test not_null_int_trip_metrics_pickup_hour ...................... [RUN]
[0m18:52:17.973630 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.assert_trip_duration_positive, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3)
[0m18:52:17.975803 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082)
[0m18:52:17.977439 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m18:52:17.979377 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m18:52:17.984078 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m18:52:17.989491 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m18:52:17.995331 [debug] [Thread-4 (]: SQL status: OK in 0.056 seconds
[0m18:52:17.997183 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: ROLLBACK
[0m18:52:17.997676 [debug] [Thread-1 (]: SQL status: OK in 0.059 seconds
[0m18:52:17.998328 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574'
[0m18:52:17.999758 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: ROLLBACK
[0m18:52:18.000050 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: Close
[0m18:52:18.000880 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718'
[0m18:52:18.001678 [info ] [Thread-4 (]: 58 of 91 PASS dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0 ..... [[32mPASS[0m in 0.17s]
[0m18:52:18.002104 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: Close
[0m18:52:18.002848 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m18:52:18.003277 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m18:52:18.004035 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m18:52:18.004495 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m18:52:18.006886 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m18:52:18.007943 [info ] [Thread-4 (]: 63 of 91 START test not_null_int_trip_metrics_trip_duration_minutes ............ [RUN]
[0m18:52:18.010667 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m18:52:18.011476 [info ] [Thread-1 (]: 59 of 91 PASS dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1  [[32mPASS[0m in 0.18s]
[0m18:52:18.012468 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c)
[0m18:52:18.013759 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m18:52:18.014226 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m18:52:18.014709 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m18:52:18.018081 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m18:52:18.018691 [info ] [Thread-1 (]: 64 of 91 START test not_null_int_trip_metrics_trip_id .......................... [RUN]
[0m18:52:18.019974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f)
[0m18:52:18.020613 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m18:52:18.023664 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m18:52:18.025190 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m18:52:18.025794 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m18:52:18.026254 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: BEGIN
[0m18:52:18.026949 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: BEGIN
[0m18:52:18.028657 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:52:18.029350 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:52:18.030311 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m18:52:18.032425 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m18:52:18.032799 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m18:52:18.034911 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m18:52:18.040231 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m18:52:18.041009 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: BEGIN
[0m18:52:18.041538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:18.042066 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m18:52:18.042700 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: BEGIN
[0m18:52:18.043219 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:52:18.072003 [debug] [Thread-2 (]: SQL status: OK in 0.043 seconds
[0m18:52:18.072708 [debug] [Thread-3 (]: SQL status: OK in 0.043 seconds
[0m18:52:18.073003 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m18:52:18.073333 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m18:52:18.073611 [debug] [Thread-4 (]: SQL status: OK in 0.030 seconds
[0m18:52:18.073893 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m18:52:18.074349 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_trip_metrics"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m18:52:18.074829 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m18:52:18.075579 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m18:52:18.076175 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."int_trip_metrics"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m18:52:18.077057 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."int_trip_metrics"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m18:52:18.077523 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_duration_minutes
from "dev"."main"."int_trip_metrics"
where trip_duration_minutes is null



  
  
      
    ) dbt_internal_test
[0m18:52:18.078766 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:52:18.080977 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: ROLLBACK
[0m18:52:18.081832 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:52:18.082606 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m18:52:18.085660 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3'
[0m18:52:18.089380 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: ROLLBACK
[0m18:52:18.091827 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: ROLLBACK
[0m18:52:18.093036 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: Close
[0m18:52:18.097376 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f'
[0m18:52:18.101782 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082'
[0m18:52:18.104113 [info ] [Thread-2 (]: 61 of 91 PASS not_null_int_trip_metrics_pickup_date ............................ [[32mPASS[0m in 0.13s]
[0m18:52:18.106451 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: Close
[0m18:52:18.110199 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: Close
[0m18:52:18.112821 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m18:52:18.115605 [info ] [Thread-1 (]: 64 of 91 PASS not_null_int_trip_metrics_trip_id ................................ [[32mPASS[0m in 0.10s]
[0m18:52:18.116527 [info ] [Thread-3 (]: 62 of 91 PASS not_null_int_trip_metrics_pickup_hour ............................ [[32mPASS[0m in 0.14s]
[0m18:52:18.120728 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m18:52:18.123513 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m18:52:18.150528 [debug] [Thread-4 (]: SQL status: OK in 0.071 seconds
[0m18:52:18.152229 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: ROLLBACK
[0m18:52:18.152978 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c'
[0m18:52:18.153335 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: Close
[0m18:52:18.157958 [info ] [Thread-4 (]: 63 of 91 PASS not_null_int_trip_metrics_trip_duration_minutes .................. [[32mPASS[0m in 0.15s]
[0m18:52:18.158798 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m18:52:18.160030 [debug] [Thread-2 (]: Began running node model.nyc_taxi_pipeline_00.int_daily_summary
[0m18:52:18.160306 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m18:52:18.160601 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.fct_trips
[0m18:52:18.160985 [info ] [Thread-2 (]: 65 of 91 START sql view model main.int_daily_summary ........................... [RUN]
[0m18:52:18.161583 [info ] [Thread-1 (]: 66 of 91 START sql view model main.int_hourly_patterns ......................... [RUN]
[0m18:52:18.162151 [info ] [Thread-3 (]: 67 of 91 START sql incremental model main.fct_trips ............................ [RUN]
[0m18:52:18.162784 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3, now model.nyc_taxi_pipeline_00.int_daily_summary)
[0m18:52:18.163446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f, now model.nyc_taxi_pipeline_00.int_hourly_patterns)
[0m18:52:18.164003 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082, now model.nyc_taxi_pipeline_00.fct_trips)
[0m18:52:18.164526 [debug] [Thread-2 (]: Began compiling node model.nyc_taxi_pipeline_00.int_daily_summary
[0m18:52:18.164998 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m18:52:18.165481 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.fct_trips
[0m18:52:18.167651 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m18:52:18.169317 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m18:52:18.173711 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.fct_trips"
[0m18:52:18.178168 [debug] [Thread-2 (]: Began executing node model.nyc_taxi_pipeline_00.int_daily_summary
[0m18:52:18.178531 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m18:52:18.180592 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m18:52:18.182786 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m18:52:18.183045 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.fct_trips
[0m18:52:18.201499 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m18:52:18.202115 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
DESCRIBE (select * from (
        /*
    Fact table: Fully enriched trip records with location names.
    Incremental with delete+insert strategy.
*/



with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

pickup_locations as (
    select * from "dev"."main"."dim_locations"
),

dropoff_locations as (
    select * from "dev"."main"."dim_locations"
),

final as (
    select
        t.trip_id,
        t.vendor_id,
        t.rate_code_id,
        t.payment_type_id,
        t.pickup_location_id,
        t.dropoff_location_id,
        t.pickup_datetime,
        t.dropoff_datetime,
        t.pickup_date,
        t.pickup_hour,
        t.pickup_day_of_week,
        t.is_weekend,
        t.passenger_count,
        t.trip_distance_miles,
        t.trip_duration_minutes,
        t.avg_speed_mph,
        t.cost_per_mile,
        t.fare_amount,
        t.extra_amount,
        t.mta_tax,
        t.tip_amount,
        t.tip_percentage,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.congestion_surcharge,
        t.airport_fee,

        -- enriched from dimensions
        pu.borough as pickup_borough,
        pu.zone_name as pickup_zone,
        do_loc.borough as dropoff_borough,
        do_loc.zone_name as dropoff_zone

    from trip_metrics t
    left join pickup_locations pu
        on t.pickup_location_id = pu.location_id
    left join dropoff_locations do_loc
        on t.dropoff_location_id = do_loc.location_id

    
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:52:18.202455 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m18:52:18.202703 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:52:18.203082 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: BEGIN
[0m18:52:18.203696 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m18:52:18.203895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:18.204245 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: BEGIN
[0m18:52:18.204736 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:52:18.219725 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m18:52:18.220070 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m18:52:18.220322 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m18:52:18.220644 [debug] [Thread-3 (]: SQL status: OK in 0.018 seconds
[0m18:52:18.220857 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m18:52:18.221284 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */

  
  create view "dev"."main"."int_daily_summary__dbt_tmp" as (
    /*
    Intermediate model: Daily aggregated trip and revenue metrics.
    One row per day with counts, averages, and revenue totals.
*/

with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

daily_agg as (
    select
        pickup_date,
        pickup_day_of_week,
        is_weekend,

        count(*) as total_trips,
        sum(passenger_count) as total_passengers,

        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(avg(avg_speed_mph), 2) as avg_speed_mph,

        round(sum(fare_amount), 2) as total_fare_revenue,
        round(sum(tip_amount), 2) as total_tip_revenue,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_trip_revenue,
        round(avg(tip_percentage), 2) as avg_tip_percentage,

        count(case when payment_type_id = 1 then 1 end) as credit_card_trips,
        count(case when payment_type_id = 2 then 1 end) as cash_trips

    from trip_metrics
    group by pickup_date, pickup_day_of_week, is_weekend
)

select * from daily_agg
  );

[0m18:52:18.223070 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m18:52:18.223270 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */

  
  create view "dev"."main"."int_hourly_patterns__dbt_tmp" as (
    /*
    Intermediate model: Hourly trip patterns by date.
    One row per date + hour combination.
*/

with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

hourly_agg as (
    select
        pickup_date,
        pickup_hour,
        pickup_day_of_week,
        is_weekend,

        count(*) as total_trips,
        round(avg(trip_distance_miles), 2) as avg_distance,
        round(avg(trip_duration_minutes), 2) as avg_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue

    from trip_metrics
    group by pickup_date, pickup_hour, pickup_day_of_week, is_weekend
)

select * from hourly_agg
  );

[0m18:52:18.224091 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as varchar)
 as trip_id, 
      
    cast(null as integer)
 as vendor_id, 
      
    cast(null as integer)
 as rate_code_id, 
      
    cast(null as integer)
 as payment_type_id, 
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as integer)
 as dropoff_location_id, 
      
    cast(null as timestamp)
 as pickup_datetime, 
      
    cast(null as timestamp)
 as dropoff_datetime, 
      
    cast(null as date)
 as pickup_date, 
      
    cast(null as bigint)
 as pickup_hour, 
      
    cast(null as varchar)
 as pickup_day_of_week, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as integer)
 as passenger_count, 
      
    cast(null as double)
 as trip_distance_miles, 
      
    cast(null as bigint)
 as trip_duration_minutes, 
      
    cast(null as double)
 as avg_speed_mph, 
      
    cast(null as double)
 as cost_per_mile, 
      
    cast(null as decimal(10,2))
 as fare_amount, 
      
    cast(null as decimal(10,2))
 as extra_amount, 
      
    cast(null as decimal(10,2))
 as mta_tax, 
      
    cast(null as decimal(10,2))
 as tip_amount, 
      
    cast(null as double)
 as tip_percentage, 
      
    cast(null as decimal(10,2))
 as tolls_amount, 
      
    cast(null as decimal(10,2))
 as improvement_surcharge, 
      
    cast(null as decimal(10,2))
 as total_amount, 
      
    cast(null as decimal(10,2))
 as congestion_surcharge, 
      
    cast(null as decimal(10,2))
 as airport_fee, 
      
    cast(null as varchar)
 as pickup_borough, 
      
    cast(null as varchar)
 as pickup_zone, 
      
    cast(null as varchar)
 as dropoff_borough, 
      
    cast(null as varchar)
 as dropoff_zone
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:52:18.224766 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:52:18.225058 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:52:18.226887 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m18:52:18.227133 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:52:18.229384 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.fct_trips"
[0m18:52:18.229577 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
alter view "dev"."main"."int_daily_summary" rename to "int_daily_summary__dbt_backup"
[0m18:52:18.231229 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m18:52:18.232189 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
alter view "dev"."main"."int_hourly_patterns" rename to "int_hourly_patterns__dbt_backup"
[0m18:52:18.232421 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:52:18.233826 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m18:52:18.234034 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:18.234230 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
alter view "dev"."main"."int_daily_summary__dbt_tmp" rename to "int_daily_summary"
[0m18:52:18.235839 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m18:52:18.236302 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
alter view "dev"."main"."int_hourly_patterns__dbt_tmp" rename to "int_hourly_patterns"
[0m18:52:18.236554 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:52:18.237280 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: COMMIT
[0m18:52:18.237490 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:18.237676 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m18:52:18.238396 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: COMMIT
[0m18:52:18.238657 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m18:52:18.238850 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: COMMIT
[0m18:52:18.239139 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m18:52:18.239503 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.fct_trips: BEGIN
[0m18:52:18.240031 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: COMMIT
[0m18:52:18.240565 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:52:18.240877 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m18:52:18.241164 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */

  
    
    
      
    

    create  table
      "dev"."main"."fct_trips__dbt_tmp"
  
  (
    trip_id varchar,
    vendor_id integer,
    rate_code_id integer,
    payment_type_id integer,
    pickup_location_id integer,
    dropoff_location_id integer,
    pickup_datetime timestamp,
    dropoff_datetime timestamp,
    pickup_date date,
    pickup_hour bigint,
    pickup_day_of_week varchar,
    is_weekend boolean,
    passenger_count integer,
    trip_distance_miles double,
    trip_duration_minutes bigint,
    avg_speed_mph double,
    cost_per_mile double,
    fare_amount decimal(10,2),
    extra_amount decimal(10,2),
    mta_tax decimal(10,2),
    tip_amount decimal(10,2),
    tip_percentage double,
    tolls_amount decimal(10,2),
    improvement_surcharge decimal(10,2),
    total_amount decimal(10,2),
    congestion_surcharge decimal(10,2),
    airport_fee decimal(10,2),
    pickup_borough varchar,
    pickup_zone varchar,
    dropoff_borough varchar,
    dropoff_zone varchar
    
    )
 ;
    insert into "dev"."main"."fct_trips__dbt_tmp" 
  (
    
      
      trip_id ,
    
      
      vendor_id ,
    
      
      rate_code_id ,
    
      
      payment_type_id ,
    
      
      pickup_location_id ,
    
      
      dropoff_location_id ,
    
      
      pickup_datetime ,
    
      
      dropoff_datetime ,
    
      
      pickup_date ,
    
      
      pickup_hour ,
    
      
      pickup_day_of_week ,
    
      
      is_weekend ,
    
      
      passenger_count ,
    
      
      trip_distance_miles ,
    
      
      trip_duration_minutes ,
    
      
      avg_speed_mph ,
    
      
      cost_per_mile ,
    
      
      fare_amount ,
    
      
      extra_amount ,
    
      
      mta_tax ,
    
      
      tip_amount ,
    
      
      tip_percentage ,
    
      
      tolls_amount ,
    
      
      improvement_surcharge ,
    
      
      total_amount ,
    
      
      congestion_surcharge ,
    
      
      airport_fee ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      dropoff_borough ,
    
      
      dropoff_zone 
    
  )
 (
      
    select trip_id, vendor_id, rate_code_id, payment_type_id, pickup_location_id, dropoff_location_id, pickup_datetime, dropoff_datetime, pickup_date, pickup_hour, pickup_day_of_week, is_weekend, passenger_count, trip_distance_miles, trip_duration_minutes, avg_speed_mph, cost_per_mile, fare_amount, extra_amount, mta_tax, tip_amount, tip_percentage, tolls_amount, improvement_surcharge, total_amount, congestion_surcharge, airport_fee, pickup_borough, pickup_zone, dropoff_borough, dropoff_zone
    from (
        /*
    Fact table: Fully enriched trip records with location names.
    Incremental with delete+insert strategy.
*/



with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

pickup_locations as (
    select * from "dev"."main"."dim_locations"
),

dropoff_locations as (
    select * from "dev"."main"."dim_locations"
),

final as (
    select
        t.trip_id,
        t.vendor_id,
        t.rate_code_id,
        t.payment_type_id,
        t.pickup_location_id,
        t.dropoff_location_id,
        t.pickup_datetime,
        t.dropoff_datetime,
        t.pickup_date,
        t.pickup_hour,
        t.pickup_day_of_week,
        t.is_weekend,
        t.passenger_count,
        t.trip_distance_miles,
        t.trip_duration_minutes,
        t.avg_speed_mph,
        t.cost_per_mile,
        t.fare_amount,
        t.extra_amount,
        t.mta_tax,
        t.tip_amount,
        t.tip_percentage,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.congestion_surcharge,
        t.airport_fee,

        -- enriched from dimensions
        pu.borough as pickup_borough,
        pu.zone_name as pickup_zone,
        do_loc.borough as dropoff_borough,
        do_loc.zone_name as dropoff_zone

    from trip_metrics t
    left join pickup_locations pu
        on t.pickup_location_id = pu.location_id
    left join dropoff_locations do_loc
        on t.dropoff_location_id = do_loc.location_id

    
)

select * from final
    ) as model_subq
    );
  
  
  
[0m18:52:18.246464 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m18:52:18.250624 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m18:52:18.252526 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
drop view if exists "dev"."main"."int_daily_summary__dbt_backup" cascade
[0m18:52:18.258402 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m18:52:18.261463 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m18:52:18.263814 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
drop view if exists "dev"."main"."int_hourly_patterns__dbt_backup" cascade
[0m18:52:18.266031 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m18:52:18.268016 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: Close
[0m18:52:18.270531 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b1704f5-13c8-403b-905d-802e8cb7d35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0ac6478f0>]}
[0m18:52:18.272365 [info ] [Thread-2 (]: 65 of 91 OK created sql view model main.int_daily_summary ...................... [[32mOK[0m in 0.11s]
[0m18:52:18.274153 [debug] [Thread-2 (]: Finished running node model.nyc_taxi_pipeline_00.int_daily_summary
[0m18:52:18.274410 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:52:18.276082 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m18:52:18.276356 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m18:52:18.277968 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: Close
[0m18:52:18.279759 [info ] [Thread-4 (]: 68 of 91 START test dbt_utils_accepted_range_int_daily_summary_total_trips__0 .. [RUN]
[0m18:52:18.281455 [info ] [Thread-2 (]: 69 of 91 START test not_null_int_daily_summary_pickup_date ..................... [RUN]
[0m18:52:18.282938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b1704f5-13c8-403b-905d-802e8cb7d35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0ac1343e0>]}
[0m18:52:18.284291 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863)
[0m18:52:18.286180 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_daily_summary, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686)
[0m18:52:18.288195 [info ] [Thread-1 (]: 66 of 91 OK created sql view model main.int_hourly_patterns .................... [[32mOK[0m in 0.12s]
[0m18:52:18.289606 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m18:52:18.291835 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m18:52:18.293639 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m18:52:18.299005 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m18:52:18.303140 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m18:52:18.304584 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m18:52:18.309624 [info ] [Thread-1 (]: 70 of 91 START test not_null_int_daily_summary_total_revenue ................... [RUN]
[0m18:52:18.310955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_hourly_patterns, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50)
[0m18:52:18.312047 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m18:52:18.317009 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m18:52:18.330302 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m18:52:18.333096 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m18:52:18.340630 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m18:52:18.343250 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m18:52:18.350269 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m18:52:18.354267 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m18:52:18.371574 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m18:52:18.373071 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: BEGIN
[0m18:52:18.374325 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:52:18.375493 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:52:18.376112 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m18:52:18.376759 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m18:52:18.377422 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: BEGIN
[0m18:52:18.377994 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_daily_summary"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_trips >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m18:52:18.378405 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m18:52:18.380586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:18.383260 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: BEGIN
[0m18:52:18.385371 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:52:18.388886 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m18:52:18.386167 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:52:18.392933 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "dev"."main"."int_daily_summary"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m18:52:18.395096 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m18:52:18.400511 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m18:52:18.402115 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_daily_summary"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m18:52:18.405753 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:52:18.408373 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: ROLLBACK
[0m18:52:18.409571 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686'
[0m18:52:18.410329 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: Close
[0m18:52:18.411336 [info ] [Thread-2 (]: 69 of 91 PASS not_null_int_daily_summary_pickup_date ........................... [[32mPASS[0m in 0.13s]
[0m18:52:18.412794 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m18:52:18.414909 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m18:52:18.416611 [info ] [Thread-2 (]: 71 of 91 START test not_null_int_daily_summary_total_trips ..................... [RUN]
[0m18:52:18.419345 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10)
[0m18:52:18.421674 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m18:52:18.432617 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m18:52:18.469015 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m18:52:18.474475 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m18:52:18.540863 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m18:52:18.543029 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: BEGIN
[0m18:52:18.549469 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:52:18.550794 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:52:18.552484 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m18:52:18.554638 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_trips
from "dev"."main"."int_daily_summary"
where total_trips is null



  
  
      
    ) dbt_internal_test
[0m18:52:18.742490 [debug] [Thread-4 (]: SQL status: OK in 0.360 seconds
[0m18:52:18.746543 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: ROLLBACK
[0m18:52:18.749043 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863'
[0m18:52:18.750302 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: Close
[0m18:52:18.751835 [info ] [Thread-4 (]: 68 of 91 PASS dbt_utils_accepted_range_int_daily_summary_total_trips__0 ........ [[32mPASS[0m in 0.47s]
[0m18:52:18.752707 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m18:52:18.753421 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m18:52:18.753989 [info ] [Thread-4 (]: 72 of 91 START test unique_int_daily_summary_pickup_date ....................... [RUN]
[0m18:52:18.754807 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863, now test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e)
[0m18:52:18.755440 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m18:52:18.760084 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m18:52:18.773957 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m18:52:18.779825 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m18:52:18.789983 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m18:52:18.790653 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: BEGIN
[0m18:52:18.791128 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:52:18.791961 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:52:18.792418 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m18:52:18.792823 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pickup_date as unique_field,
    count(*) as n_records

from "dev"."main"."int_daily_summary"
where pickup_date is not null
group by pickup_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:52:18.865531 [debug] [Thread-2 (]: SQL status: OK in 0.310 seconds
[0m18:52:18.867028 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: ROLLBACK
[0m18:52:18.868083 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10'
[0m18:52:18.868525 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: Close
[0m18:52:18.869193 [info ] [Thread-2 (]: 71 of 91 PASS not_null_int_daily_summary_total_trips ........................... [[32mPASS[0m in 0.45s]
[0m18:52:18.869886 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m18:52:18.870385 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m18:52:18.870886 [info ] [Thread-2 (]: 73 of 91 START test dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0  [RUN]
[0m18:52:18.871598 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe)
[0m18:52:18.872133 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m18:52:18.875149 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m18:52:18.878087 [debug] [Thread-1 (]: SQL status: OK in 0.482 seconds
[0m18:52:18.879847 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: ROLLBACK
[0m18:52:18.880591 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50'
[0m18:52:18.880870 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: Close
[0m18:52:18.881398 [info ] [Thread-1 (]: 70 of 91 PASS not_null_int_daily_summary_total_revenue ......................... [[32mPASS[0m in 0.57s]
[0m18:52:18.881989 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m18:52:18.882506 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m18:52:18.883070 [info ] [Thread-1 (]: 74 of 91 START test not_null_int_hourly_patterns_pickup_date ................... [RUN]
[0m18:52:18.883641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2)
[0m18:52:18.884111 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m18:52:18.887215 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m18:52:18.888318 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m18:52:18.890130 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m18:52:18.892363 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m18:52:18.894195 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m18:52:18.900010 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m18:52:18.900758 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: BEGIN
[0m18:52:18.901498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:18.901904 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m18:52:18.902611 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:18.902986 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: BEGIN
[0m18:52:18.903572 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m18:52:18.904130 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:52:18.904717 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_hourly_patterns"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m18:52:18.905476 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:52:18.906040 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m18:52:18.906374 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_hourly_patterns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m18:52:18.907647 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:52:18.909479 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: ROLLBACK
[0m18:52:18.910348 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2'
[0m18:52:18.910752 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: Close
[0m18:52:18.911395 [info ] [Thread-1 (]: 74 of 91 PASS not_null_int_hourly_patterns_pickup_date ......................... [[32mPASS[0m in 0.03s]
[0m18:52:18.912141 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m18:52:18.912651 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m18:52:18.913118 [info ] [Thread-1 (]: 75 of 91 START test not_null_int_hourly_patterns_pickup_hour ................... [RUN]
[0m18:52:18.913764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d)
[0m18:52:18.914276 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m18:52:18.917991 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m18:52:18.924674 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m18:52:18.926158 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: ROLLBACK
[0m18:52:18.926987 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe'
[0m18:52:18.927474 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: Close
[0m18:52:18.928257 [info ] [Thread-2 (]: 73 of 91 PASS dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0 .. [[32mPASS[0m in 0.06s]
[0m18:52:18.928748 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m18:52:18.929055 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m18:52:18.929420 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m18:52:18.931951 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m18:52:18.932673 [info ] [Thread-2 (]: 76 of 91 START test not_null_int_hourly_patterns_total_trips ................... [RUN]
[0m18:52:18.933633 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf)
[0m18:52:18.934199 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m18:52:18.937882 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m18:52:18.943171 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m18:52:18.943792 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: BEGIN
[0m18:52:18.944215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:18.944934 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:18.945370 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m18:52:18.945882 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."int_hourly_patterns"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m18:52:18.946645 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m18:52:18.948509 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m18:52:18.949137 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:52:18.950707 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: ROLLBACK
[0m18:52:18.951541 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d'
[0m18:52:18.952013 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: Close
[0m18:52:18.952676 [info ] [Thread-1 (]: 75 of 91 PASS not_null_int_hourly_patterns_pickup_hour ......................... [[32mPASS[0m in 0.04s]
[0m18:52:18.953179 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m18:52:18.958533 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m18:52:18.959037 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: BEGIN
[0m18:52:18.959497 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:52:18.960254 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:52:18.960684 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m18:52:18.961171 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_trips
from "dev"."main"."int_hourly_patterns"
where total_trips is null



  
  
      
    ) dbt_internal_test
[0m18:52:18.991536 [debug] [Thread-4 (]: SQL status: OK in 0.198 seconds
[0m18:52:18.993047 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: ROLLBACK
[0m18:52:18.993876 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e'
[0m18:52:18.994360 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: Close
[0m18:52:18.995160 [info ] [Thread-4 (]: 72 of 91 PASS unique_int_daily_summary_pickup_date ............................. [[32mPASS[0m in 0.24s]
[0m18:52:18.996001 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m18:52:18.996927 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m18:52:18.997581 [info ] [Thread-1 (]: 77 of 91 START sql table model main.mart_daily_revenue ......................... [RUN]
[0m18:52:18.998135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d, now model.nyc_taxi_pipeline_00.mart_daily_revenue)
[0m18:52:18.998696 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m18:52:19.001460 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m18:52:19.011362 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m18:52:19.016100 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m18:52:19.016820 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Daily revenue metrics with running totals.
*/

with daily as (
    select * from "dev"."main"."int_daily_summary"
),

dates as (
    select * from "dev"."main"."dim_dates"
),

final as (
    select
        d.date_key,
        d.day_of_week_name,
        d.is_weekend,
        d.is_holiday,
        d.week_of_year,

        daily.total_trips,
        daily.total_passengers,
        daily.total_fare_revenue,
        daily.total_tip_revenue,
        daily.total_revenue,
        daily.avg_trip_revenue,
        daily.avg_tip_percentage,
        daily.credit_card_trips,
        daily.cash_trips,
        daily.avg_trip_distance,
        daily.avg_trip_duration_min,

        -- running total
        sum(daily.total_revenue) over (order by d.date_key) as cumulative_revenue,

        -- day-over-day change
        daily.total_revenue - lag(daily.total_revenue) over (order by d.date_key) as revenue_change_vs_prior_day

    from daily
    inner join dates d
        on daily.pickup_date = d.date_key
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:52:19.017510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:19.020163 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:52:19.023520 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m18:52:19.024421 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as date_key, 
      
    cast(null as varchar)
 as day_of_week_name, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as boolean)
 as is_holiday, 
      
    cast(null as bigint)
 as week_of_year, 
      
    cast(null as bigint)
 as total_trips, 
      
    cast(null as hugeint)
 as total_passengers, 
      
    cast(null as decimal(38,2))
 as total_fare_revenue, 
      
    cast(null as decimal(38,2))
 as total_tip_revenue, 
      
    cast(null as decimal(38,2))
 as total_revenue, 
      
    cast(null as double)
 as avg_trip_revenue, 
      
    cast(null as double)
 as avg_tip_percentage, 
      
    cast(null as bigint)
 as credit_card_trips, 
      
    cast(null as bigint)
 as cash_trips, 
      
    cast(null as double)
 as avg_trip_distance, 
      
    cast(null as double)
 as avg_trip_duration_min, 
      
    cast(null as decimal(38,2))
 as cumulative_revenue, 
      
    cast(null as decimal(38,2))
 as revenue_change_vs_prior_day
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:52:19.025762 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:19.028062 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m18:52:19.037709 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m18:52:19.038316 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: BEGIN
[0m18:52:19.039083 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:19.039519 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m18:52:19.039952 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_daily_revenue__dbt_tmp"
  
  (
    date_key date,
    day_of_week_name varchar,
    is_weekend boolean,
    is_holiday boolean,
    week_of_year bigint,
    total_trips bigint,
    total_passengers hugeint,
    total_fare_revenue decimal(38,2),
    total_tip_revenue decimal(38,2),
    total_revenue decimal(38,2),
    avg_trip_revenue double,
    avg_tip_percentage double,
    credit_card_trips bigint,
    cash_trips bigint,
    avg_trip_distance double,
    avg_trip_duration_min double,
    cumulative_revenue decimal(38,2),
    revenue_change_vs_prior_day decimal(38,2)
    
    )
 ;
    insert into "dev"."main"."mart_daily_revenue__dbt_tmp" 
  (
    
      
      date_key ,
    
      
      day_of_week_name ,
    
      
      is_weekend ,
    
      
      is_holiday ,
    
      
      week_of_year ,
    
      
      total_trips ,
    
      
      total_passengers ,
    
      
      total_fare_revenue ,
    
      
      total_tip_revenue ,
    
      
      total_revenue ,
    
      
      avg_trip_revenue ,
    
      
      avg_tip_percentage ,
    
      
      credit_card_trips ,
    
      
      cash_trips ,
    
      
      avg_trip_distance ,
    
      
      avg_trip_duration_min ,
    
      
      cumulative_revenue ,
    
      
      revenue_change_vs_prior_day 
    
  )
 (
      
    select date_key, day_of_week_name, is_weekend, is_holiday, week_of_year, total_trips, total_passengers, total_fare_revenue, total_tip_revenue, total_revenue, avg_trip_revenue, avg_tip_percentage, credit_card_trips, cash_trips, avg_trip_distance, avg_trip_duration_min, cumulative_revenue, revenue_change_vs_prior_day
    from (
        /*
    Analytics mart: Daily revenue metrics with running totals.
*/

with daily as (
    select * from "dev"."main"."int_daily_summary"
),

dates as (
    select * from "dev"."main"."dim_dates"
),

final as (
    select
        d.date_key,
        d.day_of_week_name,
        d.is_weekend,
        d.is_holiday,
        d.week_of_year,

        daily.total_trips,
        daily.total_passengers,
        daily.total_fare_revenue,
        daily.total_tip_revenue,
        daily.total_revenue,
        daily.avg_trip_revenue,
        daily.avg_tip_percentage,
        daily.credit_card_trips,
        daily.cash_trips,
        daily.avg_trip_distance,
        daily.avg_trip_duration_min,

        -- running total
        sum(daily.total_revenue) over (order by d.date_key) as cumulative_revenue,

        -- day-over-day change
        daily.total_revenue - lag(daily.total_revenue) over (order by d.date_key) as revenue_change_vs_prior_day

    from daily
    inner join dates d
        on daily.pickup_date = d.date_key
)

select * from final
    ) as model_subq
    );
  
  
[0m18:52:19.111067 [debug] [Thread-2 (]: SQL status: OK in 0.149 seconds
[0m18:52:19.112748 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: ROLLBACK
[0m18:52:19.113573 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf'
[0m18:52:19.114011 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: Close
[0m18:52:19.114569 [info ] [Thread-2 (]: 76 of 91 PASS not_null_int_hourly_patterns_total_trips ......................... [[32mPASS[0m in 0.18s]
[0m18:52:19.115060 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m18:52:19.115832 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m18:52:19.116381 [info ] [Thread-4 (]: 78 of 91 START sql table model main.mart_hourly_demand ......................... [RUN]
[0m18:52:19.116978 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e, now model.nyc_taxi_pipeline_00.mart_hourly_demand)
[0m18:52:19.117414 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m18:52:19.119599 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m18:52:19.129187 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m18:52:19.132177 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m18:52:19.132673 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Hourly demand patterns.
*/

with hourly as (
    select * from "dev"."main"."int_hourly_patterns"
),

final as (
    select
        pickup_hour,
        is_weekend,

        count(*) as days_observed,
        round(avg(total_trips), 0) as avg_trips_per_period,
        round(avg(avg_distance), 2) as avg_distance,
        round(avg(avg_duration_min), 2) as avg_duration_min,
        round(avg(total_revenue), 2) as avg_revenue_per_period,
        sum(total_trips) as total_trips_all_days

    from hourly
    group by pickup_hour, is_weekend
)

select * from final
order by is_weekend, pickup_hour
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:52:19.133224 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:52:19.135502 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:52:19.137346 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m18:52:19.137847 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as bigint)
 as pickup_hour, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as bigint)
 as days_observed, 
      
    cast(null as double)
 as avg_trips_per_period, 
      
    cast(null as double)
 as avg_distance, 
      
    cast(null as double)
 as avg_duration_min, 
      
    cast(null as double)
 as avg_revenue_per_period, 
      
    cast(null as hugeint)
 as total_trips_all_days
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:52:19.138746 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:52:19.140264 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m18:52:19.148688 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m18:52:19.149176 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: BEGIN
[0m18:52:19.149800 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:52:19.150194 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m18:52:19.150692 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_hourly_demand__dbt_tmp"
  
  (
    pickup_hour bigint,
    is_weekend boolean,
    days_observed bigint,
    avg_trips_per_period double,
    avg_distance double,
    avg_duration_min double,
    avg_revenue_per_period double,
    total_trips_all_days hugeint
    
    )
 ;
    insert into "dev"."main"."mart_hourly_demand__dbt_tmp" 
  (
    
      
      pickup_hour ,
    
      
      is_weekend ,
    
      
      days_observed ,
    
      
      avg_trips_per_period ,
    
      
      avg_distance ,
    
      
      avg_duration_min ,
    
      
      avg_revenue_per_period ,
    
      
      total_trips_all_days 
    
  )
 (
      
    select pickup_hour, is_weekend, days_observed, avg_trips_per_period, avg_distance, avg_duration_min, avg_revenue_per_period, total_trips_all_days
    from (
        /*
    Analytics mart: Hourly demand patterns.
*/

with hourly as (
    select * from "dev"."main"."int_hourly_patterns"
),

final as (
    select
        pickup_hour,
        is_weekend,

        count(*) as days_observed,
        round(avg(total_trips), 0) as avg_trips_per_period,
        round(avg(avg_distance), 2) as avg_distance,
        round(avg(avg_duration_min), 2) as avg_duration_min,
        round(avg(total_revenue), 2) as avg_revenue_per_period,
        sum(total_trips) as total_trips_all_days

    from hourly
    group by pickup_hour, is_weekend
)

select * from final
order by is_weekend, pickup_hour
    ) as model_subq
    );
  
  
[0m18:52:19.252226 [debug] [Thread-1 (]: SQL status: OK in 0.212 seconds
[0m18:52:19.254498 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m18:52:19.254906 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
alter table "dev"."main"."mart_daily_revenue" rename to "mart_daily_revenue__dbt_backup"
[0m18:52:19.255595 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:19.257466 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m18:52:19.257889 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
alter table "dev"."main"."mart_daily_revenue__dbt_tmp" rename to "mart_daily_revenue"
[0m18:52:19.258609 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:19.259624 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: COMMIT
[0m18:52:19.260173 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m18:52:19.260665 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: COMMIT
[0m18:52:19.265806 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:52:19.267558 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m18:52:19.267914 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
drop table if exists "dev"."main"."mart_daily_revenue__dbt_backup" cascade
[0m18:52:19.270496 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:52:19.271629 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: Close
[0m18:52:19.272313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b1704f5-13c8-403b-905d-802e8cb7d35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0ac128f20>]}
[0m18:52:19.272868 [info ] [Thread-1 (]: 77 of 91 OK created sql table model main.mart_daily_revenue .................... [[32mOK[0m in 0.27s]
[0m18:52:19.273382 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m18:52:19.274146 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m18:52:19.274528 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m18:52:19.274888 [info ] [Thread-2 (]: 79 of 91 START test not_null_mart_daily_revenue_date_key ....................... [RUN]
[0m18:52:19.275613 [info ] [Thread-1 (]: 80 of 91 START test not_null_mart_daily_revenue_total_revenue .................. [RUN]
[0m18:52:19.276157 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf, now test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a)
[0m18:52:19.276613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.mart_daily_revenue, now test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9)
[0m18:52:19.277054 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m18:52:19.277472 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m18:52:19.280910 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m18:52:19.283387 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m18:52:19.289316 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m18:52:19.291298 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m18:52:19.291680 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m18:52:19.293633 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m18:52:19.297159 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m18:52:19.297580 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: BEGIN
[0m18:52:19.297918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:19.298212 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m18:52:19.298808 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:19.299084 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: BEGIN
[0m18:52:19.299615 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m18:52:19.300059 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:52:19.300531 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "dev"."main"."mart_daily_revenue"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m18:52:19.301206 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:52:19.301746 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m18:52:19.302102 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "dev"."main"."mart_daily_revenue"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m18:52:19.302402 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:19.303824 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: ROLLBACK
[0m18:52:19.304195 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:52:19.304778 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9'
[0m18:52:19.305938 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: ROLLBACK
[0m18:52:19.306179 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: Close
[0m18:52:19.307009 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a'
[0m18:52:19.307499 [info ] [Thread-1 (]: 80 of 91 PASS not_null_mart_daily_revenue_total_revenue ........................ [[32mPASS[0m in 0.03s]
[0m18:52:19.307781 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: Close
[0m18:52:19.308314 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m18:52:19.309032 [info ] [Thread-2 (]: 79 of 91 PASS not_null_mart_daily_revenue_date_key ............................. [[32mPASS[0m in 0.03s]
[0m18:52:19.309495 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m18:52:19.310103 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m18:52:19.310560 [info ] [Thread-1 (]: 81 of 91 START test unique_mart_daily_revenue_date_key ......................... [RUN]
[0m18:52:19.311385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9, now test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7)
[0m18:52:19.311799 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m18:52:19.314749 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m18:52:19.323672 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m18:52:19.325656 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m18:52:19.334419 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m18:52:19.334874 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: BEGIN
[0m18:52:19.335621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:19.336418 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:19.336817 [debug] [Thread-4 (]: SQL status: OK in 0.186 seconds
[0m18:52:19.337055 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m18:52:19.339277 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m18:52:19.339783 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "dev"."main"."mart_daily_revenue"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:52:19.340158 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
alter table "dev"."main"."mart_hourly_demand" rename to "mart_hourly_demand__dbt_backup"
[0m18:52:19.341089 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:52:19.341350 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:19.342997 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m18:52:19.344121 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: ROLLBACK
[0m18:52:19.344329 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
alter table "dev"."main"."mart_hourly_demand__dbt_tmp" rename to "mart_hourly_demand"
[0m18:52:19.344995 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7'
[0m18:52:19.345438 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: Close
[0m18:52:19.345661 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:52:19.346100 [info ] [Thread-1 (]: 81 of 91 PASS unique_mart_daily_revenue_date_key ............................... [[32mPASS[0m in 0.03s]
[0m18:52:19.346871 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: COMMIT
[0m18:52:19.347400 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m18:52:19.347805 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m18:52:19.348426 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: COMMIT
[0m18:52:19.352576 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m18:52:19.354204 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m18:52:19.354516 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
drop table if exists "dev"."main"."mart_hourly_demand__dbt_backup" cascade
[0m18:52:19.356945 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:52:19.357948 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: Close
[0m18:52:19.358383 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b1704f5-13c8-403b-905d-802e8cb7d35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0581b5010>]}
[0m18:52:19.358826 [info ] [Thread-4 (]: 78 of 91 OK created sql table model main.mart_hourly_demand .................... [[32mOK[0m in 0.24s]
[0m18:52:19.359242 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m18:52:19.359855 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m18:52:19.360114 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m18:52:19.360388 [info ] [Thread-2 (]: 82 of 91 START test not_null_mart_hourly_demand_is_weekend ..................... [RUN]
[0m18:52:19.360808 [info ] [Thread-1 (]: 83 of 91 START test not_null_mart_hourly_demand_pickup_hour .................... [RUN]
[0m18:52:19.361257 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a, now test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8)
[0m18:52:19.361683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7, now test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418)
[0m18:52:19.362041 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m18:52:19.362472 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m18:52:19.364930 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m18:52:19.368317 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m18:52:19.373049 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m18:52:19.374589 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m18:52:19.374846 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m18:52:19.376273 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m18:52:19.378979 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m18:52:19.379331 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: BEGIN
[0m18:52:19.379621 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:52:19.380358 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:52:19.380639 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m18:52:19.380853 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m18:52:19.381234 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: BEGIN
[0m18:52:19.381605 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."mart_hourly_demand"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m18:52:19.381953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:19.382871 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:19.383129 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:52:19.383359 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m18:52:19.384591 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: ROLLBACK
[0m18:52:19.384885 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."mart_hourly_demand"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m18:52:19.385642 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8'
[0m18:52:19.386144 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: Close
[0m18:52:19.386515 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:19.386884 [info ] [Thread-2 (]: 82 of 91 PASS not_null_mart_hourly_demand_is_weekend ........................... [[32mPASS[0m in 0.03s]
[0m18:52:19.387916 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: ROLLBACK
[0m18:52:19.388239 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m18:52:19.388868 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418'
[0m18:52:19.389368 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: Close
[0m18:52:19.389850 [info ] [Thread-1 (]: 83 of 91 PASS not_null_mart_hourly_demand_pickup_hour .......................... [[32mPASS[0m in 0.03s]
[0m18:52:19.390309 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m18:52:23.140791 [debug] [Thread-3 (]: SQL status: OK in 4.899 seconds
[0m18:52:23.142834 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m18:52:23.143184 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
alter table "dev"."main"."fct_trips" rename to "fct_trips__dbt_backup"
[0m18:52:23.143851 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.145264 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m18:52:23.145686 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
alter table "dev"."main"."fct_trips__dbt_tmp" rename to "fct_trips"
[0m18:52:23.146216 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.147287 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.fct_trips: COMMIT
[0m18:52:23.147606 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m18:52:23.147954 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.fct_trips: COMMIT
[0m18:52:23.482508 [debug] [Thread-3 (]: SQL status: OK in 0.334 seconds
[0m18:52:23.484387 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m18:52:23.484976 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
drop table if exists "dev"."main"."fct_trips__dbt_backup" cascade
[0m18:52:23.797298 [debug] [Thread-3 (]: SQL status: OK in 0.312 seconds
[0m18:52:23.798500 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.fct_trips: Close
[0m18:52:23.862771 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b1704f5-13c8-403b-905d-802e8cb7d35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0ac135130>]}
[0m18:52:23.863594 [info ] [Thread-3 (]: 67 of 91 OK created sql incremental model main.fct_trips ....................... [[32mOK[0m in 5.70s]
[0m18:52:23.864257 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.fct_trips
[0m18:52:23.865117 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m18:52:23.865424 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m18:52:23.865715 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m18:52:23.865979 [info ] [Thread-4 (]: 84 of 91 START test not_null_fct_trips_pickup_datetime ......................... [RUN]
[0m18:52:23.866267 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m18:52:23.866562 [info ] [Thread-2 (]: 85 of 91 START test not_null_fct_trips_total_amount ............................ [RUN]
[0m18:52:23.867022 [info ] [Thread-1 (]: 86 of 91 START test not_null_fct_trips_trip_id ................................. [RUN]
[0m18:52:23.867594 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.mart_hourly_demand, now test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83)
[0m18:52:23.868074 [info ] [Thread-3 (]: 87 of 91 START test unique_fct_trips_trip_id ................................... [RUN]
[0m18:52:23.868597 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8, now test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d)
[0m18:52:23.869089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418, now test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d)
[0m18:52:23.869718 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m18:52:23.870170 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.fct_trips, now test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab)
[0m18:52:23.870538 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m18:52:23.870863 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m18:52:23.873553 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m18:52:23.873954 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m18:52:23.876206 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m18:52:23.878343 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m18:52:23.882957 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m18:52:23.887532 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m18:52:23.887980 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m18:52:23.889559 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m18:52:23.889836 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m18:52:23.891268 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m18:52:23.891490 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m18:52:23.892877 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m18:52:23.894287 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m18:52:23.898193 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m18:52:23.898501 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m18:52:23.898767 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: BEGIN
[0m18:52:23.899165 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: BEGIN
[0m18:52:23.899429 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m18:52:23.899631 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:52:23.899958 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m18:52:23.900168 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:52:23.900549 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: BEGIN
[0m18:52:23.901298 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: BEGIN
[0m18:52:23.901755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:23.902071 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:52:23.919020 [debug] [Thread-3 (]: SQL status: OK in 0.019 seconds
[0m18:52:23.919415 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m18:52:23.919758 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m18:52:23.919991 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m18:52:23.920217 [debug] [Thread-4 (]: SQL status: OK in 0.021 seconds
[0m18:52:23.920593 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m18:52:23.920921 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m18:52:23.921239 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."main"."fct_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:52:23.921555 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m18:52:23.921833 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."fct_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m18:52:23.922098 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."fct_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m18:52:23.922508 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "dev"."main"."fct_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m18:52:23.923154 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.923713 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.925465 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.927932 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: ROLLBACK
[0m18:52:23.928996 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: ROLLBACK
[0m18:52:23.930149 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: ROLLBACK
[0m18:52:23.931825 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d'
[0m18:52:23.934904 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d'
[0m18:52:23.936766 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83'
[0m18:52:23.938504 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: Close
[0m18:52:23.939162 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: Close
[0m18:52:23.941675 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: Close
[0m18:52:23.944114 [info ] [Thread-1 (]: 86 of 91 PASS not_null_fct_trips_trip_id ....................................... [[32mPASS[0m in 0.08s]
[0m18:52:23.945311 [info ] [Thread-2 (]: 85 of 91 PASS not_null_fct_trips_total_amount .................................. [[32mPASS[0m in 0.08s]
[0m18:52:23.947387 [info ] [Thread-4 (]: 84 of 91 PASS not_null_fct_trips_pickup_datetime ............................... [[32mPASS[0m in 0.08s]
[0m18:52:23.949023 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m18:52:23.952294 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m18:52:23.954442 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m18:52:24.029877 [debug] [Thread-3 (]: SQL status: OK in 0.107 seconds
[0m18:52:24.031423 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: ROLLBACK
[0m18:52:24.032118 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab'
[0m18:52:24.032471 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: Close
[0m18:52:24.058250 [info ] [Thread-3 (]: 87 of 91 PASS unique_fct_trips_trip_id ......................................... [[32mPASS[0m in 0.19s]
[0m18:52:24.058893 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m18:52:24.060022 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.mart_location_performance
[0m18:52:24.060507 [info ] [Thread-1 (]: 88 of 91 START sql table model main.mart_location_performance .................. [RUN]
[0m18:52:24.060979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d, now model.nyc_taxi_pipeline_00.mart_location_performance)
[0m18:52:24.061388 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_location_performance
[0m18:52:24.064028 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m18:52:24.070200 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.mart_location_performance
[0m18:52:24.072681 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m18:52:24.073167 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Location-level performance summary.
    Uses adapter-dispatched mode_compat() for cross-dialect support.
*/

with trips as (
    select * from "dev"."main"."fct_trips"
),

final as (
    select
        pickup_location_id,
        pickup_borough,
        pickup_zone,

        count(*) as total_pickups,
        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue_per_trip,
        round(avg(tip_percentage), 2) as avg_tip_pct,
        round(avg(passenger_count), 2) as avg_passengers,

        -- most common dropoff destination
        
    mode(dropoff_zone)
 as most_common_dropoff_zone,

        -- busiest hour
        
    mode(pickup_hour)
 as peak_pickup_hour

    from trips
    where pickup_zone is not null
    group by pickup_location_id, pickup_borough, pickup_zone
)

select * from final
order by total_pickups desc
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:52:24.073683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:24.089776 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m18:52:24.091661 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m18:52:24.092132 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as varchar)
 as pickup_borough, 
      
    cast(null as varchar)
 as pickup_zone, 
      
    cast(null as bigint)
 as total_pickups, 
      
    cast(null as double)
 as avg_trip_distance, 
      
    cast(null as double)
 as avg_trip_duration_min, 
      
    cast(null as decimal(38,2))
 as total_revenue, 
      
    cast(null as double)
 as avg_revenue_per_trip, 
      
    cast(null as double)
 as avg_tip_pct, 
      
    cast(null as double)
 as avg_passengers, 
      
    cast(null as varchar)
 as most_common_dropoff_zone, 
      
    cast(null as bigint)
 as peak_pickup_hour
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:52:24.092924 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:24.094570 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m18:52:24.099949 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m18:52:24.100288 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: BEGIN
[0m18:52:24.100859 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:24.101139 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m18:52:24.101400 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_location_performance__dbt_tmp"
  
  (
    pickup_location_id integer,
    pickup_borough varchar,
    pickup_zone varchar,
    total_pickups bigint,
    avg_trip_distance double,
    avg_trip_duration_min double,
    total_revenue decimal(38,2),
    avg_revenue_per_trip double,
    avg_tip_pct double,
    avg_passengers double,
    most_common_dropoff_zone varchar,
    peak_pickup_hour bigint
    
    )
 ;
    insert into "dev"."main"."mart_location_performance__dbt_tmp" 
  (
    
      
      pickup_location_id ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      total_pickups ,
    
      
      avg_trip_distance ,
    
      
      avg_trip_duration_min ,
    
      
      total_revenue ,
    
      
      avg_revenue_per_trip ,
    
      
      avg_tip_pct ,
    
      
      avg_passengers ,
    
      
      most_common_dropoff_zone ,
    
      
      peak_pickup_hour 
    
  )
 (
      
    select pickup_location_id, pickup_borough, pickup_zone, total_pickups, avg_trip_distance, avg_trip_duration_min, total_revenue, avg_revenue_per_trip, avg_tip_pct, avg_passengers, most_common_dropoff_zone, peak_pickup_hour
    from (
        /*
    Analytics mart: Location-level performance summary.
    Uses adapter-dispatched mode_compat() for cross-dialect support.
*/

with trips as (
    select * from "dev"."main"."fct_trips"
),

final as (
    select
        pickup_location_id,
        pickup_borough,
        pickup_zone,

        count(*) as total_pickups,
        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue_per_trip,
        round(avg(tip_percentage), 2) as avg_tip_pct,
        round(avg(passenger_count), 2) as avg_passengers,

        -- most common dropoff destination
        
    mode(dropoff_zone)
 as most_common_dropoff_zone,

        -- busiest hour
        
    mode(pickup_hour)
 as peak_pickup_hour

    from trips
    where pickup_zone is not null
    group by pickup_location_id, pickup_borough, pickup_zone
)

select * from final
order by total_pickups desc
    ) as model_subq
    );
  
  
[0m18:52:24.192995 [debug] [Thread-1 (]: SQL status: OK in 0.091 seconds
[0m18:52:24.195229 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m18:52:24.195613 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
alter table "dev"."main"."mart_location_performance" rename to "mart_location_performance__dbt_backup"
[0m18:52:24.196292 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:24.198004 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m18:52:24.198405 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
alter table "dev"."main"."mart_location_performance__dbt_tmp" rename to "mart_location_performance"
[0m18:52:24.198971 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:24.199824 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: COMMIT
[0m18:52:24.200125 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m18:52:24.200379 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: COMMIT
[0m18:52:24.206029 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:52:24.208519 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m18:52:24.208936 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
drop table if exists "dev"."main"."mart_location_performance__dbt_backup" cascade
[0m18:52:24.211413 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:52:24.212380 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: Close
[0m18:52:24.262112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b1704f5-13c8-403b-905d-802e8cb7d35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0ac148620>]}
[0m18:52:24.263020 [info ] [Thread-1 (]: 88 of 91 OK created sql table model main.mart_location_performance ............. [[32mOK[0m in 0.20s]
[0m18:52:24.263788 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.mart_location_performance
[0m18:52:24.264582 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m18:52:24.264859 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m18:52:24.265165 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m18:52:24.265388 [info ] [Thread-4 (]: 89 of 91 START test not_null_mart_location_performance_pickup_location_id ...... [RUN]
[0m18:52:24.265780 [info ] [Thread-3 (]: 90 of 91 START test not_null_mart_location_performance_total_pickups ........... [RUN]
[0m18:52:24.266179 [info ] [Thread-2 (]: 91 of 91 START test unique_mart_location_performance_pickup_location_id ........ [RUN]
[0m18:52:24.266641 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83, now test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c)
[0m18:52:24.267067 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab, now test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259)
[0m18:52:24.267503 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d, now test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62)
[0m18:52:24.268038 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m18:52:24.268369 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m18:52:24.268682 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m18:52:24.271115 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m18:52:24.273385 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m18:52:24.275639 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m18:52:24.280192 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m18:52:24.280547 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m18:52:24.282410 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m18:52:24.282739 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m18:52:24.284254 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m18:52:24.285707 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m18:52:24.289501 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m18:52:24.289832 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m18:52:24.290084 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: BEGIN
[0m18:52:24.290505 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: BEGIN
[0m18:52:24.290958 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:52:24.291295 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m18:52:24.291628 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:52:24.292523 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: BEGIN
[0m18:52:24.293068 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:52:24.307216 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m18:52:24.307591 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m18:52:24.307856 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m18:52:24.308076 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m18:52:24.308432 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m18:52:24.308766 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m18:52:24.309087 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_location_id
from "dev"."main"."mart_location_performance"
where pickup_location_id is null



  
  
      
    ) dbt_internal_test
[0m18:52:24.309430 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_pickups
from "dev"."main"."mart_location_performance"
where total_pickups is null



  
  
      
    ) dbt_internal_test
[0m18:52:24.309806 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pickup_location_id as unique_field,
    count(*) as n_records

from "dev"."main"."mart_location_performance"
where pickup_location_id is not null
group by pickup_location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:52:24.310817 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:52:24.311017 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:52:24.312075 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: ROLLBACK
[0m18:52:24.312362 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:52:24.313115 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: ROLLBACK
[0m18:52:24.313747 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259'
[0m18:52:24.314472 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: ROLLBACK
[0m18:52:24.314920 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c'
[0m18:52:24.315267 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: Close
[0m18:52:24.315879 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62'
[0m18:52:24.316211 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: Close
[0m18:52:24.316820 [info ] [Thread-3 (]: 90 of 91 PASS not_null_mart_location_performance_total_pickups ................. [[32mPASS[0m in 0.05s]
[0m18:52:24.317107 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: Close
[0m18:52:24.317675 [info ] [Thread-4 (]: 89 of 91 PASS not_null_mart_location_performance_pickup_location_id ............ [[32mPASS[0m in 0.05s]
[0m18:52:24.318134 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m18:52:24.318850 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m18:52:24.320773 [info ] [Thread-2 (]: 91 of 91 PASS unique_mart_location_performance_pickup_location_id .............. [[32mPASS[0m in 0.05s]
[0m18:52:24.321254 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m18:52:24.322601 [debug] [MainThread]: Using duckdb connection "master"
[0m18:52:24.322932 [debug] [MainThread]: On master: BEGIN
[0m18:52:24.323198 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:52:24.338672 [debug] [MainThread]: SQL status: OK in 0.015 seconds
[0m18:52:24.339178 [debug] [MainThread]: On master: COMMIT
[0m18:52:24.339534 [debug] [MainThread]: Using duckdb connection "master"
[0m18:52:24.339878 [debug] [MainThread]: On master: COMMIT
[0m18:52:24.340317 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:52:24.340588 [debug] [MainThread]: On master: Close
[0m18:52:24.342717 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:52:24.343015 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m18:52:24.343251 [debug] [MainThread]: Connection 'model.nyc_taxi_pipeline_00.mart_location_performance' was properly closed.
[0m18:52:24.343474 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62' was properly closed.
[0m18:52:24.343828 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259' was properly closed.
[0m18:52:24.344106 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c' was properly closed.
[0m18:52:24.344531 [info ] [MainThread]: 
[0m18:52:24.344954 [info ] [MainThread]: Finished running 1 incremental model, 3 seeds, 7 table models, 74 data tests, 6 view models in 0 hours 0 minutes and 9.30 seconds (9.30s).
[0m18:52:24.349681 [debug] [MainThread]: Command end result
[0m18:52:24.386481 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m18:52:24.391363 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m18:52:24.400147 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m18:52:24.400537 [info ] [MainThread]: 
[0m18:52:24.400948 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:52:24.401332 [info ] [MainThread]: 
[0m18:52:24.401697 [info ] [MainThread]: Done. PASS=91 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=91
[0m18:52:24.403215 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 10.339138, "process_in_blocks": "16", "process_kernel_time": 9.072883, "process_mem_max_rss": "1794100", "process_out_blocks": "136", "process_user_time": 22.106855}
[0m18:52:24.403762 [debug] [MainThread]: Command `dbt build` succeeded at 18:52:24.403645 after 10.34 seconds
[0m18:52:24.404173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0d1a573b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0ac6555e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0ac1b7aa0>]}
[0m18:52:24.404534 [debug] [MainThread]: Flushing usage events
[0m18:52:24.633868 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:03:31.374980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cbc7422d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cbc99927b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cbc7422cc0>]}


============================== 19:03:31.378496 | d709f9a1-7b89-46a7-9585-4d2dbcfcdf37 ==============================
[0m19:03:31.378496 [info ] [MainThread]: Running with dbt=1.11.4
[0m19:03:31.379063 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'log_path': '/dbt/logs', 'debug': 'False', 'empty': 'None', 'introspect': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'write_json': 'True', 'profiles_dir': '.', 'target_path': 'None', 'use_colors': 'True', 'printer_width': '80', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir .', 'version_check': 'True'}
[0m19:03:31.462428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd709f9a1-7b89-46a7-9585-4d2dbcfcdf37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cbc6cf1820>]}
[0m19:03:31.746721 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-sy2ad6nc'
[0m19:03:31.747248 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:03:32.029086 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:03:32.030488 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m19:03:32.118755 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m19:03:32.122382 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m19:03:38.964731 [info ] [MainThread]: Installed from version 1.3.3
[0m19:03:38.965307 [info ] [MainThread]: Up to date!
[0m19:03:38.965872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd709f9a1-7b89-46a7-9585-4d2dbcfcdf37', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cbc6becfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cbc6becb00>]}
[0m19:03:38.967354 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.3078885, "process_in_blocks": "10504", "process_kernel_time": 0.414987, "process_mem_max_rss": "106136", "process_out_blocks": "176", "process_user_time": 1.314904}
[0m19:03:38.968144 [debug] [MainThread]: Command `dbt deps` succeeded at 19:03:38.967960 after 4.31 seconds
[0m19:03:38.968614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cbc7bc8260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cbc6cf1700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cbc72e3f80>]}
[0m19:03:38.969009 [debug] [MainThread]: Flushing usage events
[0m19:03:39.244054 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:03:40.422024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ea8fa2120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ea9967ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5eaaf11580>]}


============================== 19:03:40.425290 | 84172053-510c-4981-92d2-735fe95c3111 ==============================
[0m19:03:40.425290 [info ] [MainThread]: Running with dbt=1.11.4
[0m19:03:40.425942 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt build --full-refresh --profiles-dir .', 'log_cache_events': 'False', 'introspect': 'True', 'log_path': '/dbt/logs', 'partial_parse': 'True', 'static_parser': 'True', 'profiles_dir': '.', 'target_path': 'None', 'indirect_selection': 'eager', 'use_colors': 'True', 'empty': 'False', 'write_json': 'True', 'version_check': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'quiet': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m19:03:40.633150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84172053-510c-4981-92d2-735fe95c3111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ea870bec0>]}
[0m19:03:40.673506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84172053-510c-4981-92d2-735fe95c3111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ea8b0bbf0>]}
[0m19:03:40.676628 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m19:03:40.730813 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m19:03:41.430672 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:03:41.431581 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:03:41.432020 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:03:41.474758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84172053-510c-4981-92d2-735fe95c3111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e98bc54c0>]}
[0m19:03:41.568197 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m19:03:41.573124 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m19:03:41.606744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84172053-510c-4981-92d2-735fe95c3111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e988223c0>]}
[0m19:03:41.607345 [info ] [MainThread]: Found 14 models, 74 data tests, 3 seeds, 1 source, 578 macros
[0m19:03:41.611518 [info ] [MainThread]: 
[0m19:03:41.612166 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:03:41.612706 [info ] [MainThread]: 
[0m19:03:41.613452 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:03:41.617670 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m19:03:41.713648 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m19:03:41.714201 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m19:03:41.714543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:41.737028 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m19:03:41.738306 [debug] [ThreadPool]: On list_dev: Close
[0m19:03:41.743322 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m19:03:41.744241 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m19:03:41.748897 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:03:41.749471 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m19:03:41.749979 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:03:41.766836 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m19:03:41.768150 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:03:41.768815 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m19:03:41.769405 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:03:41.769683 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:03:41.769991 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m19:03:41.770598 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:03:41.771258 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m19:03:41.771563 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:03:41.771938 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m19:03:41.772406 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:03:41.772986 [debug] [ThreadPool]: On create_dev_main: Close
[0m19:03:41.776677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m19:03:41.780140 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m19:03:41.780622 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m19:03:41.780934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:03:41.797218 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m19:03:41.797734 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m19:03:41.797995 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m19:03:41.805389 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m19:03:41.806795 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m19:03:41.807744 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m19:03:41.808124 [debug] [ThreadPool]: On list_dev_main: Close
[0m19:03:41.811741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84172053-510c-4981-92d2-735fe95c3111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5eab216f00>]}
[0m19:03:41.812363 [debug] [MainThread]: Using duckdb connection "master"
[0m19:03:41.812707 [debug] [MainThread]: On master: BEGIN
[0m19:03:41.813005 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:03:41.829792 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m19:03:41.830409 [debug] [MainThread]: On master: COMMIT
[0m19:03:41.830771 [debug] [MainThread]: Using duckdb connection "master"
[0m19:03:41.831075 [debug] [MainThread]: On master: COMMIT
[0m19:03:41.831628 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:03:41.831961 [debug] [MainThread]: On master: Close
[0m19:03:41.838838 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.dim_dates
[0m19:03:41.839221 [debug] [Thread-2 (]: Began running node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m19:03:41.839523 [debug] [Thread-3 (]: Began running node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m19:03:41.839887 [info ] [Thread-1 (]: 1 of 91 START sql table model main.dim_dates ................................... [RUN]
[0m19:03:41.840184 [debug] [Thread-4 (]: Began running node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m19:03:41.840459 [info ] [Thread-2 (]: 2 of 91 START sql table model main.stg_yellow_trips ............................ [RUN]
[0m19:03:41.840908 [info ] [Thread-3 (]: 3 of 91 START seed file main.payment_type_lookup ............................... [RUN]
[0m19:03:41.841425 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nyc_taxi_pipeline_00.dim_dates'
[0m19:03:41.841943 [info ] [Thread-4 (]: 4 of 91 START seed file main.rate_code_lookup .................................. [RUN]
[0m19:03:41.842439 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.nyc_taxi_pipeline_00.stg_yellow_trips'
[0m19:03:41.842882 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.nyc_taxi_pipeline_00.payment_type_lookup'
[0m19:03:41.843322 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_dates
[0m19:03:41.843794 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.nyc_taxi_pipeline_00.rate_code_lookup'
[0m19:03:41.844150 [debug] [Thread-2 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m19:03:41.844481 [debug] [Thread-3 (]: Began compiling node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m19:03:41.855356 [debug] [Thread-4 (]: Began compiling node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m19:03:41.856620 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m19:03:41.866263 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m19:03:41.866645 [debug] [Thread-3 (]: Began executing node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m19:03:41.867116 [debug] [Thread-4 (]: Began executing node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m19:03:41.867519 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: BEGIN
[0m19:03:41.878476 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:03:41.880850 [debug] [Thread-2 (]: Began executing node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m19:03:41.900704 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m19:03:41.907223 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m19:03:41.907620 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.payment_type_lookup"} */
drop table if exists "dev"."main"."payment_type_lookup" cascade
[0m19:03:41.909386 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m19:03:41.909750 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m19:03:41.910229 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:03:41.910601 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.rate_code_lookup"} */
drop table if exists "dev"."main"."rate_code_lookup" cascade
[0m19:03:41.911383 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m19:03:41.912201 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:03:41.912706 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */


        select 
        (date_diff('day', cast('2024-01-01' as date)::timestamp, cast('2024-02-01' as date)::timestamp ))
    
[0m19:03:41.913985 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:03:41.922185 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m19:03:41.923656 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_dates"
[0m19:03:41.924098 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m19:03:41.929283 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m19:03:41.930861 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m19:03:41.931117 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m19:03:41.931313 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: BEGIN
[0m19:03:41.931767 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: BEGIN
[0m19:03:41.932178 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: BEGIN
[0m19:03:41.933019 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m19:03:41.933542 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:03:41.933893 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:41.934192 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m19:03:41.935119 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m19:03:41.935365 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m19:03:41.935765 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.payment_type_lookup"} */

    create table "dev"."main"."payment_type_lookup" ("payment_type_id" integer,"payment_type_name" varchar)
  
[0m19:03:41.936186 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.rate_code_lookup"} */

    create table "dev"."main"."rate_code_lookup" ("rate_code_id" integer,"rate_code_name" varchar)
  
[0m19:03:41.936835 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m19:03:41.937775 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.dim_dates
[0m19:03:41.938136 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */

  
    
    

    create  table
      "dev"."main"."stg_yellow_trips__dbt_tmp"
  
    as (
      

with source as (
    select * from read_parquet('/data/yellow_tripdata_2024-01.parquet')
),

renamed as (
    select
        -- surrogate key (MD5 hash of composite key)
        md5(cast(coalesce(cast(VendorID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(PULocationID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DOLocationID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(fare_amount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(total_amount as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- identifiers
        cast("VendorID" as integer) as vendor_id,
        cast("RatecodeID" as integer) as rate_code_id,
        cast("PULocationID" as integer) as pickup_location_id,
        cast("DOLocationID" as integer) as dropoff_location_id,
        cast(payment_type as integer) as payment_type_id,

        -- timestamps
        cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
        cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as double) as trip_distance_miles,
        store_and_fwd_flag,

        -- financials
        round(cast(fare_amount as decimal(10, 2)), 2) as fare_amount,
        round(cast(extra as decimal(10, 2)), 2) as extra_amount,
        round(cast(mta_tax as decimal(10, 2)), 2) as mta_tax,
        round(cast(tip_amount as decimal(10, 2)), 2) as tip_amount,
        round(cast(tolls_amount as decimal(10, 2)), 2) as tolls_amount,
        round(cast(improvement_surcharge as decimal(10, 2)), 2) as improvement_surcharge,
        round(cast(total_amount as decimal(10, 2)), 2) as total_amount,
        round(cast(congestion_surcharge as decimal(10, 2)), 2) as congestion_surcharge,
        round(cast(Airport_fee as decimal(10, 2)), 2) as airport_fee

    from source
    where tpep_pickup_datetime is not null
      and tpep_dropoff_datetime is not null
      and trip_distance >= 0
      and fare_amount >= 0
      -- filter out-of-range dates (data quality: ~18 trips outside Jan 2024)
      and cast(tpep_pickup_datetime as date) >= date '2024-01-01'
      and cast(tpep_pickup_datetime as date) < date '2024-02-01'
)

select * from renamed
    );
  
  
[0m19:03:41.938530 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:03:41.938806 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:41.952825 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m19:03:41.959509 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m19:03:41.960877 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m19:03:41.961780 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
DESCRIBE (select * from (
        /*
    Dimension table: Calendar dates for January 2024.
    Uses adapter-dispatched macros for dayname/monthname.
*/

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 31
    order by generated_number



),

all_periods as (

    select (
        

    date_add(cast('2024-01-01' as date), interval (row_number() over (order by generated_number) - 1) day)


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-02-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week_num,
        
    dayname(date_day)
 as day_of_week_name,
        
    monthname(date_day)
 as month_name,
        extract(week from date_day) as week_of_year,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when cast(date_day as date) in (
                cast('2024-01-01' as date),
                cast('2024-01-15' as date)
            ) then true
            else false
        end as is_holiday

    from date_spine
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m19:03:41.962423 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: 
          COPY "dev"."main"."payment_type_lookup" FROM '/dbt/seeds/payment_type_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:03:41.963019 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: 
          COPY "dev"."main"."rate_code_lookup" FROM '/dbt/seeds/rate_code_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:03:41.969353 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:03:41.983413 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m19:03:41.983887 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m19:03:41.984195 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m19:03:41.984547 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as date_key, 
      
    cast(null as bigint)
 as year, 
      
    cast(null as bigint)
 as month, 
      
    cast(null as bigint)
 as day_of_month, 
      
    cast(null as bigint)
 as day_of_week_num, 
      
    cast(null as varchar)
 as day_of_week_name, 
      
    cast(null as varchar)
 as month_name, 
      
    cast(null as bigint)
 as week_of_year, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as boolean)
 as is_holiday
    ) as __dbt_sbq
    where false
    limit 0
)
[0m19:03:41.988106 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m19:03:41.988914 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m19:03:41.990566 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.007656 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_dates"
[0m19:03:42.017453 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: COMMIT
[0m19:03:42.018713 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: COMMIT
[0m19:03:42.019071 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m19:03:42.019546 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m19:03:42.020059 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: COMMIT
[0m19:03:42.020614 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: COMMIT
[0m19:03:42.023210 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m19:03:42.023873 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_dates__dbt_tmp"
  
  (
    date_key date,
    year bigint,
    month bigint,
    day_of_month bigint,
    day_of_week_num bigint,
    day_of_week_name varchar,
    month_name varchar,
    week_of_year bigint,
    is_weekend boolean,
    is_holiday boolean
    
    )
 ;
    insert into "dev"."main"."dim_dates__dbt_tmp" 
  (
    
      
      date_key ,
    
      
      year ,
    
      
      month ,
    
      
      day_of_month ,
    
      
      day_of_week_num ,
    
      
      day_of_week_name ,
    
      
      month_name ,
    
      
      week_of_year ,
    
      
      is_weekend ,
    
      
      is_holiday 
    
  )
 (
      
    select date_key, year, month, day_of_month, day_of_week_num, day_of_week_name, month_name, week_of_year, is_weekend, is_holiday
    from (
        /*
    Dimension table: Calendar dates for January 2024.
    Uses adapter-dispatched macros for dayname/monthname.
*/

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 31
    order by generated_number



),

all_periods as (

    select (
        

    date_add(cast('2024-01-01' as date), interval (row_number() over (order by generated_number) - 1) day)


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-02-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week_num,
        
    dayname(date_day)
 as day_of_week_name,
        
    monthname(date_day)
 as month_name,
        extract(week from date_day) as week_of_year,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when cast(date_day as date) in (
                cast('2024-01-01' as date),
                cast('2024-01-15' as date)
            ) then true
            else false
        end as is_holiday

    from date_spine
)

select * from final
    ) as model_subq
    );
  
  
[0m19:03:42.025394 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m19:03:42.027006 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: Close
[0m19:03:42.028570 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m19:03:42.029013 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84172053-510c-4981-92d2-735fe95c3111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e74aefa40>]}
[0m19:03:42.029835 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: Close
[0m19:03:42.030651 [info ] [Thread-4 (]: 4 of 91 OK loaded seed file main.rate_code_lookup .............................. [[32mCREATE 7[0m in 0.18s]
[0m19:03:42.031913 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84172053-510c-4981-92d2-735fe95c3111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e746cb110>]}
[0m19:03:42.032646 [debug] [Thread-4 (]: Finished running node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m19:03:42.033710 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m19:03:42.034285 [info ] [Thread-3 (]: 3 of 91 OK loaded seed file main.payment_type_lookup ........................... [[32mCREATE 6[0m in 0.19s]
[0m19:03:42.035524 [debug] [Thread-4 (]: Began running node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m19:03:42.040387 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m19:03:42.041125 [debug] [Thread-3 (]: Finished running node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m19:03:42.041848 [info ] [Thread-4 (]: 5 of 91 START seed file main.taxi_zone_lookup .................................. [RUN]
[0m19:03:42.042400 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
alter table "dev"."main"."dim_dates" rename to "dim_dates__dbt_backup"
[0m19:03:42.042930 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m19:03:42.043738 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.rate_code_lookup, now seed.nyc_taxi_pipeline_00.taxi_zone_lookup)
[0m19:03:42.044716 [info ] [Thread-3 (]: 6 of 91 START test not_null_rate_code_lookup_rate_code_id ...................... [RUN]
[0m19:03:42.045247 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.045649 [debug] [Thread-4 (]: Began compiling node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m19:03:42.046375 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.payment_type_lookup, now test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec)
[0m19:03:42.048789 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m19:03:42.049310 [debug] [Thread-4 (]: Began executing node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m19:03:42.049748 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m19:03:42.050174 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
alter table "dev"."main"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m19:03:42.060490 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m19:03:42.061775 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.063077 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: COMMIT
[0m19:03:42.063680 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m19:03:42.064173 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: COMMIT
[0m19:03:42.067702 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m19:03:42.068312 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"} */
drop table if exists "dev"."main"."taxi_zone_lookup" cascade
[0m19:03:42.068684 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:03:42.068975 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:03:42.070843 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m19:03:42.071378 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m19:03:42.072598 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
drop table if exists "dev"."main"."dim_dates__dbt_backup" cascade
[0m19:03:42.082887 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m19:03:42.083287 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m19:03:42.085550 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m19:03:42.086141 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: BEGIN
[0m19:03:42.086852 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m19:03:42.087258 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m19:03:42.087911 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:03:42.088220 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"} */

    create table "dev"."main"."taxi_zone_lookup" ("LocationID" integer,"Borough" varchar,"Zone" varchar,"service_zone" varchar)
  
[0m19:03:42.089585 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: Close
[0m19:03:42.090644 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m19:03:42.091349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84172053-510c-4981-92d2-735fe95c3111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e746fbdd0>]}
[0m19:03:42.092324 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m19:03:42.093185 [info ] [Thread-1 (]: 1 of 91 OK created sql table model main.dim_dates .............................. [[32mOK[0m in 0.25s]
[0m19:03:42.093855 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: 
          COPY "dev"."main"."taxi_zone_lookup" FROM '/dbt/seeds/taxi_zone_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:03:42.094522 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.dim_dates
[0m19:03:42.094986 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m19:03:42.095801 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m19:03:42.096490 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: BEGIN
[0m19:03:42.097271 [info ] [Thread-1 (]: 7 of 91 START test unique_rate_code_lookup_rate_code_id ........................ [RUN]
[0m19:03:42.097902 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:03:42.098684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_dates, now test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d)
[0m19:03:42.099717 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m19:03:42.100110 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m19:03:42.105517 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m19:03:42.106508 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m19:03:42.107016 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m19:03:42.107871 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_id
from "dev"."main"."rate_code_lookup"
where rate_code_id is null



  
  
      
    ) dbt_internal_test
[0m19:03:42.108618 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m19:03:42.110294 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.113310 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: ROLLBACK
[0m19:03:42.114256 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec'
[0m19:03:42.114658 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: Close
[0m19:03:42.115476 [info ] [Thread-3 (]: 6 of 91 PASS not_null_rate_code_lookup_rate_code_id ............................ [[32mPASS[0m in 0.07s]
[0m19:03:42.115834 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m19:03:42.116284 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m19:03:42.118190 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m19:03:42.118867 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m19:03:42.120592 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: COMMIT
[0m19:03:42.120938 [info ] [Thread-3 (]: 8 of 91 START test not_null_payment_type_lookup_payment_type_id ................ [RUN]
[0m19:03:42.121453 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m19:03:42.122024 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec, now test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521)
[0m19:03:42.122501 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: COMMIT
[0m19:03:42.123187 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m19:03:42.126826 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m19:03:42.127684 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m19:03:42.128621 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: Close
[0m19:03:42.129304 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84172053-510c-4981-92d2-735fe95c3111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e746f7b90>]}
[0m19:03:42.129729 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m19:03:42.130254 [info ] [Thread-4 (]: 5 of 91 OK loaded seed file main.taxi_zone_lookup .............................. [[32mCREATE 265[0m in 0.09s]
[0m19:03:42.130859 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: BEGIN
[0m19:03:42.131508 [debug] [Thread-4 (]: Finished running node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m19:03:42.132152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:42.132860 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m19:03:42.134112 [info ] [Thread-4 (]: 9 of 91 START test unique_payment_type_lookup_payment_type_id .................. [RUN]
[0m19:03:42.134605 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.taxi_zone_lookup, now test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7)
[0m19:03:42.134951 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:03:42.135253 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m19:03:42.135804 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m19:03:42.136076 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m19:03:42.139127 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m19:03:42.141357 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m19:03:42.142087 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rate_code_id as unique_field,
    count(*) as n_records

from "dev"."main"."rate_code_lookup"
where rate_code_id is not null
group by rate_code_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:03:42.144910 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.146752 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: ROLLBACK
[0m19:03:42.147681 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d'
[0m19:03:42.148104 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: Close
[0m19:03:42.148941 [info ] [Thread-1 (]: 7 of 91 PASS unique_rate_code_lookup_rate_code_id .............................. [[32mPASS[0m in 0.05s]
[0m19:03:42.149725 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m19:03:42.150233 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m19:03:42.150572 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m19:03:42.151266 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m19:03:42.151637 [info ] [Thread-1 (]: 10 of 91 START test not_null_dim_dates_date_key ................................ [RUN]
[0m19:03:42.154264 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m19:03:42.154897 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: BEGIN
[0m19:03:42.155608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d, now test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348)
[0m19:03:42.156550 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:03:42.157103 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m19:03:42.161614 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m19:03:42.162049 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m19:03:42.162812 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m19:03:42.163278 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."payment_type_lookup"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m19:03:42.164619 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.166116 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: ROLLBACK
[0m19:03:42.166979 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521'
[0m19:03:42.167511 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: Close
[0m19:03:42.168135 [info ] [Thread-3 (]: 8 of 91 PASS not_null_payment_type_lookup_payment_type_id ...................... [[32mPASS[0m in 0.05s]
[0m19:03:42.168631 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m19:03:42.169075 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m19:03:42.169766 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: BEGIN
[0m19:03:42.170418 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m19:03:42.171027 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:03:42.171662 [info ] [Thread-3 (]: 11 of 91 START test not_null_dim_dates_day_of_week_name ........................ [RUN]
[0m19:03:42.172672 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m19:03:42.172995 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m19:03:42.173552 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521, now test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541)
[0m19:03:42.175665 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m19:03:42.176327 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m19:03:42.176789 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m19:03:42.177490 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."payment_type_lookup"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:03:42.180580 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m19:03:42.182562 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.184113 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: ROLLBACK
[0m19:03:42.185162 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7'
[0m19:03:42.185686 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: Close
[0m19:03:42.186466 [info ] [Thread-4 (]: 9 of 91 PASS unique_payment_type_lookup_payment_type_id ........................ [[32mPASS[0m in 0.05s]
[0m19:03:42.187217 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m19:03:42.187801 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m19:03:42.188265 [info ] [Thread-4 (]: 12 of 91 START test not_null_dim_dates_is_holiday .............................. [RUN]
[0m19:03:42.188750 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m19:03:42.189285 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7, now test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a)
[0m19:03:42.190150 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: BEGIN
[0m19:03:42.190783 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m19:03:42.191415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:42.191784 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m19:03:42.195635 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m19:03:42.198904 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m19:03:42.199748 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m19:03:42.200990 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m19:03:42.201575 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "dev"."main"."dim_dates"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m19:03:42.203258 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.205046 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: ROLLBACK
[0m19:03:42.205863 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348'
[0m19:03:42.206287 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: Close
[0m19:03:42.207300 [info ] [Thread-1 (]: 10 of 91 PASS not_null_dim_dates_date_key ...................................... [[32mPASS[0m in 0.05s]
[0m19:03:42.208249 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m19:03:42.208866 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m19:03:42.209586 [info ] [Thread-1 (]: 13 of 91 START test not_null_dim_dates_is_weekend .............................. [RUN]
[0m19:03:42.210420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348, now test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0)
[0m19:03:42.211559 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m19:03:42.212086 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m19:03:42.212683 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m19:03:42.213169 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: BEGIN
[0m19:03:42.216482 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m19:03:42.218917 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m19:03:42.219491 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:03:42.221668 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m19:03:42.222246 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m19:03:42.222747 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select day_of_week_name
from "dev"."main"."dim_dates"
where day_of_week_name is null



  
  
      
    ) dbt_internal_test
[0m19:03:42.223992 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.225582 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: ROLLBACK
[0m19:03:42.226617 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541'
[0m19:03:42.227353 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: Close
[0m19:03:42.228111 [info ] [Thread-3 (]: 11 of 91 PASS not_null_dim_dates_day_of_week_name .............................. [[32mPASS[0m in 0.05s]
[0m19:03:42.228870 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m19:03:42.229482 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m19:03:42.230092 [info ] [Thread-3 (]: 14 of 91 START test unique_dim_dates_date_key .................................. [RUN]
[0m19:03:42.230651 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541, now test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d)
[0m19:03:42.231230 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m19:03:42.235062 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m19:03:42.235470 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m19:03:42.236151 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m19:03:42.237764 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m19:03:42.238311 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: BEGIN
[0m19:03:42.239299 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:03:42.240255 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.240814 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m19:03:42.241300 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_holiday
from "dev"."main"."dim_dates"
where is_holiday is null



  
  
      
    ) dbt_internal_test
[0m19:03:42.242852 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.244311 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: ROLLBACK
[0m19:03:42.245136 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a'
[0m19:03:42.245721 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: Close
[0m19:03:42.246376 [info ] [Thread-4 (]: 12 of 91 PASS not_null_dim_dates_is_holiday .................................... [[32mPASS[0m in 0.06s]
[0m19:03:42.247021 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m19:03:42.247843 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m19:03:42.248360 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m19:03:42.248988 [info ] [Thread-4 (]: 15 of 91 START test not_null_taxi_zone_lookup_Borough .......................... [RUN]
[0m19:03:42.253139 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m19:03:42.253787 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m19:03:42.254637 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a, now test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa)
[0m19:03:42.255546 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: BEGIN
[0m19:03:42.256551 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m19:03:42.257326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:42.260677 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m19:03:42.262233 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:03:42.262761 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m19:03:42.263267 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."dim_dates"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m19:03:42.264523 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.266136 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: ROLLBACK
[0m19:03:42.267235 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0'
[0m19:03:42.267763 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: Close
[0m19:03:42.268662 [info ] [Thread-1 (]: 13 of 91 PASS not_null_dim_dates_is_weekend .................................... [[32mPASS[0m in 0.06s]
[0m19:03:42.269316 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m19:03:42.269824 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m19:03:42.270218 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m19:03:42.270798 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: BEGIN
[0m19:03:42.271618 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m19:03:42.274230 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m19:03:42.274811 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:03:42.275573 [info ] [Thread-1 (]: 16 of 91 START test not_null_taxi_zone_lookup_LocationID ....................... [RUN]
[0m19:03:42.278621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0, now test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a)
[0m19:03:42.279433 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m19:03:42.279845 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m19:03:42.280502 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m19:03:42.284779 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m19:03:42.285509 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "dev"."main"."dim_dates"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:03:42.288231 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.289638 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: ROLLBACK
[0m19:03:42.290630 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d'
[0m19:03:42.291247 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: Close
[0m19:03:42.292100 [info ] [Thread-3 (]: 14 of 91 PASS unique_dim_dates_date_key ........................................ [[32mPASS[0m in 0.06s]
[0m19:03:42.292629 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m19:03:42.293243 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m19:03:42.293871 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: BEGIN
[0m19:03:42.294785 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m19:03:42.295627 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:03:42.296754 [info ] [Thread-3 (]: 17 of 91 START test unique_taxi_zone_lookup_LocationID ......................... [RUN]
[0m19:03:42.297273 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m19:03:42.298025 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m19:03:42.298453 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d, now test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8)
[0m19:03:42.301040 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m19:03:42.301746 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m19:03:42.302373 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m19:03:42.303479 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Borough
from "dev"."main"."taxi_zone_lookup"
where Borough is null



  
  
      
    ) dbt_internal_test
[0m19:03:42.306975 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m19:03:42.308544 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.309843 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: ROLLBACK
[0m19:03:42.310612 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa'
[0m19:03:42.311074 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: Close
[0m19:03:42.311886 [info ] [Thread-4 (]: 15 of 91 PASS not_null_taxi_zone_lookup_Borough ................................ [[32mPASS[0m in 0.06s]
[0m19:03:42.312534 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m19:03:42.312900 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m19:03:42.313326 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m19:03:42.313859 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: BEGIN
[0m19:03:42.314585 [info ] [Thread-4 (]: 18 of 91 START sql view model main.stg_rate_codes .............................. [RUN]
[0m19:03:42.315165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:42.315614 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m19:03:42.316015 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa, now model.nyc_taxi_pipeline_00.stg_rate_codes)
[0m19:03:42.316886 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:03:42.318886 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m19:03:42.319469 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m19:03:42.320121 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m19:03:42.323448 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m19:03:42.324267 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select LocationID
from "dev"."main"."taxi_zone_lookup"
where LocationID is null



  
  
      
    ) dbt_internal_test
[0m19:03:42.326057 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.327391 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: ROLLBACK
[0m19:03:42.328658 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a'
[0m19:03:42.329319 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: Close
[0m19:03:42.330083 [info ] [Thread-1 (]: 16 of 91 PASS not_null_taxi_zone_lookup_LocationID ............................. [[32mPASS[0m in 0.05s]
[0m19:03:42.330430 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m19:03:42.330821 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m19:03:42.331386 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: BEGIN
[0m19:03:42.332052 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.stg_payment_types
[0m19:03:42.332872 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:03:42.333294 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m19:03:42.333783 [info ] [Thread-1 (]: 19 of 91 START sql view model main.stg_payment_types ........................... [RUN]
[0m19:03:42.345243 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m19:03:42.347137 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m19:03:42.347557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a, now model.nyc_taxi_pipeline_00.stg_payment_types)
[0m19:03:42.348244 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m19:03:42.349179 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_payment_types
[0m19:03:42.349681 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    LocationID as unique_field,
    count(*) as n_records

from "dev"."main"."taxi_zone_lookup"
where LocationID is not null
group by LocationID
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:03:42.353159 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m19:03:42.354907 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.356378 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: ROLLBACK
[0m19:03:42.357238 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8'
[0m19:03:42.357655 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: Close
[0m19:03:42.358326 [info ] [Thread-3 (]: 17 of 91 PASS unique_taxi_zone_lookup_LocationID ............................... [[32mPASS[0m in 0.06s]
[0m19:03:42.358902 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m19:03:42.359270 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m19:03:42.359958 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: BEGIN
[0m19:03:42.360972 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m19:03:42.361332 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.stg_payment_types
[0m19:03:42.361814 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:03:42.362493 [info ] [Thread-3 (]: 20 of 91 START sql view model main.stg_taxi_zones .............................. [RUN]
[0m19:03:42.365084 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m19:03:42.366324 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8, now model.nyc_taxi_pipeline_00.stg_taxi_zones)
[0m19:03:42.366640 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m19:03:42.367602 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m19:03:42.368225 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m19:03:42.371160 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m19:03:42.371798 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */

  
  create view "dev"."main"."stg_rate_codes__dbt_tmp" as (
    /*
    Staging model: Rate code lookup
    Maps rate_code_id to human-readable names.
*/

with source as (
    select * from "dev"."main"."rate_code_lookup"
),

renamed as (
    select
        rate_code_id,
        rate_code_name
    from source
)

select * from renamed
  );

[0m19:03:42.373446 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.375900 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m19:03:42.376518 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
alter view "dev"."main"."stg_rate_codes" rename to "stg_rate_codes__dbt_backup"
[0m19:03:42.377474 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.378171 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m19:03:42.380516 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m19:03:42.381085 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: BEGIN
[0m19:03:42.381844 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
alter view "dev"."main"."stg_rate_codes__dbt_tmp" rename to "stg_rate_codes"
[0m19:03:42.382289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:42.382575 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m19:03:42.383616 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.386212 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m19:03:42.386504 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:03:42.387629 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: COMMIT
[0m19:03:42.388497 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m19:03:42.388961 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m19:03:42.389378 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */

  
  create view "dev"."main"."stg_payment_types__dbt_tmp" as (
    /*
    Staging model: Payment type lookup
    Maps payment_type_id to human-readable names.
*/

with source as (
    select * from "dev"."main"."payment_type_lookup"
),

renamed as (
    select
        payment_type_id,
        payment_type_name
    from source
)

select * from renamed
  );

[0m19:03:42.389815 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: COMMIT
[0m19:03:42.391162 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.394352 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m19:03:42.394757 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m19:03:42.395146 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
alter view "dev"."main"."stg_payment_types" rename to "stg_payment_types__dbt_backup"
[0m19:03:42.397282 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m19:03:42.398184 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
drop view if exists "dev"."main"."stg_rate_codes__dbt_backup" cascade
[0m19:03:42.398548 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.398895 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m19:03:42.401120 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m19:03:42.401625 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m19:03:42.401855 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: BEGIN
[0m19:03:42.402216 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
alter view "dev"."main"."stg_payment_types__dbt_tmp" rename to "stg_payment_types"
[0m19:03:42.404457 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: Close
[0m19:03:42.405061 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:03:42.406173 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84172053-510c-4981-92d2-735fe95c3111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e5c15fad0>]}
[0m19:03:42.406655 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.407587 [info ] [Thread-4 (]: 18 of 91 OK created sql view model main.stg_rate_codes ......................... [[32mOK[0m in 0.09s]
[0m19:03:42.407983 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m19:03:42.409039 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: COMMIT
[0m19:03:42.409922 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m19:03:42.410493 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m19:03:42.411076 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m19:03:42.412156 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m19:03:42.412626 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */

  
  create view "dev"."main"."stg_taxi_zones__dbt_tmp" as (
    /*
    Staging model: Taxi zone lookup
    Maps LocationID to borough and zone name.
*/

with source as (
    select * from "dev"."main"."taxi_zone_lookup"
),

renamed as (
    select
        cast("LocationID" as integer) as location_id,
        "Borough" as borough,
        "Zone" as zone_name,
        service_zone
    from source
)

select * from renamed
  );

[0m19:03:42.413114 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: COMMIT
[0m19:03:42.413614 [info ] [Thread-4 (]: 21 of 91 START test not_null_stg_rate_codes_rate_code_id ....................... [RUN]
[0m19:03:42.414961 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_rate_codes, now test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a)
[0m19:03:42.415312 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.415709 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m19:03:42.418749 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m19:03:42.419493 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:03:42.422835 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m19:03:42.423702 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
alter view "dev"."main"."stg_taxi_zones" rename to "stg_taxi_zones__dbt_backup"
[0m19:03:42.426158 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m19:03:42.427635 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
drop view if exists "dev"."main"."stg_payment_types__dbt_backup" cascade
[0m19:03:42.428259 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.430788 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m19:03:42.431361 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
alter view "dev"."main"."stg_taxi_zones__dbt_tmp" rename to "stg_taxi_zones"
[0m19:03:42.431778 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:03:42.433561 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: Close
[0m19:03:42.433876 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m19:03:42.434578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84172053-510c-4981-92d2-735fe95c3111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e74a42150>]}
[0m19:03:42.435575 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: COMMIT
[0m19:03:42.436489 [info ] [Thread-1 (]: 19 of 91 OK created sql view model main.stg_payment_types ...................... [[32mOK[0m in 0.09s]
[0m19:03:42.437073 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m19:03:42.437690 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.stg_payment_types
[0m19:03:42.438273 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m19:03:42.438542 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: COMMIT
[0m19:03:42.438988 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m19:03:42.441300 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m19:03:42.442620 [info ] [Thread-1 (]: 22 of 91 START test not_null_stg_rate_codes_rate_code_name ..................... [RUN]
[0m19:03:42.443674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_payment_types, now test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f)
[0m19:03:42.444233 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m19:03:42.447622 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m19:03:42.448117 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m19:03:42.450374 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m19:03:42.451573 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
drop view if exists "dev"."main"."stg_taxi_zones__dbt_backup" cascade
[0m19:03:42.455224 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m19:03:42.455624 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m19:03:42.456004 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: BEGIN
[0m19:03:42.457402 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: Close
[0m19:03:42.457879 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:03:42.458671 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84172053-510c-4981-92d2-735fe95c3111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e6c0fe600>]}
[0m19:03:42.459371 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.459983 [info ] [Thread-3 (]: 20 of 91 OK created sql view model main.stg_taxi_zones ......................... [[32mOK[0m in 0.09s]
[0m19:03:42.460438 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m19:03:42.460806 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m19:03:42.461589 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m19:03:42.463700 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m19:03:42.464237 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_id
from "dev"."main"."stg_rate_codes"
where rate_code_id is null



  
  
      
    ) dbt_internal_test
[0m19:03:42.464831 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m19:03:42.466587 [info ] [Thread-3 (]: 23 of 91 START test unique_stg_rate_codes_rate_code_id ......................... [RUN]
[0m19:03:42.466994 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.467523 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_taxi_zones, now test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3)
[0m19:03:42.469232 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: ROLLBACK
[0m19:03:42.469576 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m19:03:42.470577 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a'
[0m19:03:42.473419 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m19:03:42.474201 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: Close
[0m19:03:42.475907 [info ] [Thread-4 (]: 21 of 91 PASS not_null_stg_rate_codes_rate_code_id ............................. [[32mPASS[0m in 0.06s]
[0m19:03:42.476615 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m19:03:42.477380 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m19:03:42.477914 [info ] [Thread-4 (]: 24 of 91 START test not_null_stg_payment_types_payment_type_id ................. [RUN]
[0m19:03:42.478798 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a, now test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78)
[0m19:03:42.479545 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m19:03:42.479909 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m19:03:42.480358 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: BEGIN
[0m19:03:42.485216 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m19:03:42.486092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:42.487720 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m19:03:42.488247 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:03:42.489872 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m19:03:42.490515 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m19:03:42.491719 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_name
from "dev"."main"."stg_rate_codes"
where rate_code_name is null



  
  
      
    ) dbt_internal_test
[0m19:03:42.492454 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m19:03:42.494473 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m19:03:42.494799 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:03:42.496271 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: ROLLBACK
[0m19:03:42.496964 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f'
[0m19:03:42.497311 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: Close
[0m19:03:42.497989 [info ] [Thread-1 (]: 22 of 91 PASS not_null_stg_rate_codes_rate_code_name ........................... [[32mPASS[0m in 0.05s]
[0m19:03:42.498566 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m19:03:42.499175 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m19:03:42.499769 [info ] [Thread-1 (]: 25 of 91 START test not_null_stg_payment_types_payment_type_name ............... [RUN]
[0m19:03:42.500337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f, now test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39)
[0m19:03:42.500747 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m19:03:42.501300 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m19:03:42.504234 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m19:03:42.504779 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m19:03:42.505337 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: BEGIN
[0m19:03:42.506287 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: BEGIN
[0m19:03:42.506674 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:03:42.507454 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:03:42.508446 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m19:03:42.509108 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m19:03:42.509394 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m19:03:42.509824 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rate_code_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_rate_codes"
where rate_code_id is not null
group by rate_code_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:03:42.510360 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m19:03:42.511644 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."stg_payment_types"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m19:03:42.512630 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.513001 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.514545 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: ROLLBACK
[0m19:03:42.515939 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: ROLLBACK
[0m19:03:42.517109 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3'
[0m19:03:42.517789 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78'
[0m19:03:42.518143 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m19:03:42.518406 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: Close
[0m19:03:42.518854 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: Close
[0m19:03:42.521020 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m19:03:42.521698 [info ] [Thread-3 (]: 23 of 91 PASS unique_stg_rate_codes_rate_code_id ............................... [[32mPASS[0m in 0.05s]
[0m19:03:42.522272 [info ] [Thread-4 (]: 24 of 91 PASS not_null_stg_payment_types_payment_type_id ....................... [[32mPASS[0m in 0.04s]
[0m19:03:42.523187 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m19:03:42.523837 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m19:03:42.524531 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m19:03:42.525257 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m19:03:42.525883 [info ] [Thread-3 (]: 26 of 91 START test unique_stg_payment_types_payment_type_id ................... [RUN]
[0m19:03:42.526457 [info ] [Thread-4 (]: 27 of 91 START test not_null_stg_taxi_zones_borough ............................ [RUN]
[0m19:03:42.527282 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3, now test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534)
[0m19:03:42.527947 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b)
[0m19:03:42.528485 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m19:03:42.529068 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m19:03:42.532494 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m19:03:42.535655 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m19:03:42.537557 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m19:03:42.538040 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: BEGIN
[0m19:03:42.538467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:42.539189 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.539602 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m19:03:42.539930 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_name
from "dev"."main"."stg_payment_types"
where payment_type_name is null



  
  
      
    ) dbt_internal_test
[0m19:03:42.541304 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.542682 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: ROLLBACK
[0m19:03:42.543406 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39'
[0m19:03:42.543740 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m19:03:42.544186 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: Close
[0m19:03:42.544716 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m19:03:42.546759 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m19:03:42.547766 [info ] [Thread-1 (]: 25 of 91 PASS not_null_stg_payment_types_payment_type_name ..................... [[32mPASS[0m in 0.05s]
[0m19:03:42.549361 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m19:03:42.550634 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m19:03:42.551940 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m19:03:42.552584 [info ] [Thread-1 (]: 28 of 91 START test not_null_stg_taxi_zones_location_id ........................ [RUN]
[0m19:03:42.553363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf)
[0m19:03:42.553940 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m19:03:42.558645 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m19:03:42.560085 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m19:03:42.560485 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m19:03:42.560836 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: BEGIN
[0m19:03:42.561431 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: BEGIN
[0m19:03:42.561914 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:03:42.562439 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:03:42.563535 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m19:03:42.563848 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.564134 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m19:03:42.564623 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m19:03:42.565133 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_payment_types"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:03:42.565714 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select borough
from "dev"."main"."stg_taxi_zones"
where borough is null



  
  
      
    ) dbt_internal_test
[0m19:03:42.567884 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.568361 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m19:03:42.568747 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m19:03:42.570084 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: ROLLBACK
[0m19:03:42.572837 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m19:03:42.575191 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: ROLLBACK
[0m19:03:42.576355 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b'
[0m19:03:42.578158 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534'
[0m19:03:42.580411 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: Close
[0m19:03:42.581293 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: Close
[0m19:03:42.582424 [info ] [Thread-4 (]: 27 of 91 PASS not_null_stg_taxi_zones_borough .................................. [[32mPASS[0m in 0.05s]
[0m19:03:42.583228 [info ] [Thread-3 (]: 26 of 91 PASS unique_stg_payment_types_payment_type_id ......................... [[32mPASS[0m in 0.06s]
[0m19:03:42.584204 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m19:03:42.585071 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m19:03:42.585867 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m19:03:42.586471 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m19:03:42.587068 [info ] [Thread-4 (]: 29 of 91 START test not_null_stg_taxi_zones_zone_name .......................... [RUN]
[0m19:03:42.587627 [info ] [Thread-3 (]: 30 of 91 START test unique_stg_taxi_zones_location_id .......................... [RUN]
[0m19:03:42.588515 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84)
[0m19:03:42.589344 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534, now test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c)
[0m19:03:42.589886 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m19:03:42.590240 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m19:03:42.590704 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m19:03:42.591210 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: BEGIN
[0m19:03:42.594630 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m19:03:42.598290 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m19:03:42.599087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:42.601224 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:03:42.601696 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m19:03:42.602128 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "dev"."main"."stg_taxi_zones"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m19:03:42.603641 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.605017 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: ROLLBACK
[0m19:03:42.605924 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf'
[0m19:03:42.606513 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: Close
[0m19:03:42.606804 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m19:03:42.607383 [info ] [Thread-1 (]: 28 of 91 PASS not_null_stg_taxi_zones_location_id .............................. [[32mPASS[0m in 0.05s]
[0m19:03:42.609613 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m19:03:42.610009 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m19:03:42.610811 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m19:03:42.613926 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m19:03:42.614790 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.dim_payment_types
[0m19:03:42.616326 [info ] [Thread-1 (]: 31 of 91 START sql table model main.dim_payment_types .......................... [RUN]
[0m19:03:42.617106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf, now model.nyc_taxi_pipeline_00.dim_payment_types)
[0m19:03:42.617649 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_payment_types
[0m19:03:42.620259 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m19:03:42.621967 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m19:03:42.622530 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: BEGIN
[0m19:03:42.623339 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:03:42.624722 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m19:03:42.625145 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m19:03:42.625491 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: BEGIN
[0m19:03:42.626023 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m19:03:42.626500 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:03:42.627123 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select zone_name
from "dev"."main"."stg_taxi_zones"
where zone_name is null



  
  
      
    ) dbt_internal_test
[0m19:03:42.628487 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m19:03:42.628907 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m19:03:42.629276 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.629591 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_taxi_zones"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:03:42.631567 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: ROLLBACK
[0m19:03:42.632057 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.dim_payment_types
[0m19:03:42.633411 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84'
[0m19:03:42.633990 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.636891 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m19:03:42.637535 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: Close
[0m19:03:42.639430 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: ROLLBACK
[0m19:03:42.639902 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
DESCRIBE (select * from (
        /*
    Dimension table: Payment type descriptions.
*/

with payment_types as (
    select * from "dev"."main"."stg_payment_types"
),

final as (
    select
        payment_type_id,
        payment_type_name
    from payment_types
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m19:03:42.640940 [info ] [Thread-4 (]: 29 of 91 PASS not_null_stg_taxi_zones_zone_name ................................ [[32mPASS[0m in 0.05s]
[0m19:03:42.641666 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c'
[0m19:03:42.642364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:42.643114 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m19:03:42.643791 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: Close
[0m19:03:42.645430 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:03:42.646022 [info ] [Thread-3 (]: 30 of 91 PASS unique_stg_taxi_zones_location_id ................................ [[32mPASS[0m in 0.06s]
[0m19:03:42.647076 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m19:03:42.647536 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m19:03:42.648204 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as payment_type_id, 
      
    cast(null as varchar)
 as payment_type_name
    ) as __dbt_sbq
    where false
    limit 0
)
[0m19:03:42.649110 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.dim_locations
[0m19:03:42.650380 [info ] [Thread-4 (]: 32 of 91 START sql table model main.dim_locations .............................. [RUN]
[0m19:03:42.650789 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.651216 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84, now model.nyc_taxi_pipeline_00.dim_locations)
[0m19:03:42.652822 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m19:03:42.653315 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_locations
[0m19:03:42.656688 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_locations"
[0m19:03:42.662664 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m19:03:42.663734 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: BEGIN
[0m19:03:42.664879 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:03:42.665362 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m19:03:42.666078 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_payment_types__dbt_tmp"
  
  (
    payment_type_id integer,
    payment_type_name varchar
    
    )
 ;
    insert into "dev"."main"."dim_payment_types__dbt_tmp" 
  (
    
      
      payment_type_id ,
    
      
      payment_type_name 
    
  )
 (
      
    select payment_type_id, payment_type_name
    from (
        /*
    Dimension table: Payment type descriptions.
*/

with payment_types as (
    select * from "dev"."main"."stg_payment_types"
),

final as (
    select
        payment_type_id,
        payment_type_name
    from payment_types
)

select * from final
    ) as model_subq
    );
  
  
[0m19:03:42.667093 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.dim_locations
[0m19:03:42.671166 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m19:03:42.671915 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:03:42.672257 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
DESCRIBE (select * from (
        /*
    Dimension table: TLC Taxi Zone locations.
*/

with zones as (
    select * from "dev"."main"."stg_taxi_zones"
),

final as (
    select
        location_id,
        borough,
        zone_name,
        service_zone
    from zones
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m19:03:42.674823 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m19:03:42.675507 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:03:42.676445 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
alter table "dev"."main"."dim_payment_types" rename to "dim_payment_types__dbt_backup"
[0m19:03:42.678009 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m19:03:42.678715 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.680714 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m19:03:42.682846 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m19:03:42.683439 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as location_id, 
      
    cast(null as varchar)
 as borough, 
      
    cast(null as varchar)
 as zone_name, 
      
    cast(null as varchar)
 as service_zone
    ) as __dbt_sbq
    where false
    limit 0
)
[0m19:03:42.684145 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
alter table "dev"."main"."dim_payment_types__dbt_tmp" rename to "dim_payment_types"
[0m19:03:42.685592 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.686055 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.687274 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_locations"
[0m19:03:42.688322 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: COMMIT
[0m19:03:42.689399 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m19:03:42.689796 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: COMMIT
[0m19:03:42.694337 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:03:42.697569 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m19:03:42.698050 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
drop table if exists "dev"."main"."dim_payment_types__dbt_backup" cascade
[0m19:03:42.700403 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m19:03:42.701086 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: BEGIN
[0m19:03:42.701883 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:03:42.702185 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.703386 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: Close
[0m19:03:42.704061 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m19:03:42.704771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84172053-510c-4981-92d2-735fe95c3111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e74a40dd0>]}
[0m19:03:42.705130 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_locations__dbt_tmp"
  
  (
    location_id integer,
    borough varchar,
    zone_name varchar,
    service_zone varchar
    
    )
 ;
    insert into "dev"."main"."dim_locations__dbt_tmp" 
  (
    
      
      location_id ,
    
      
      borough ,
    
      
      zone_name ,
    
      
      service_zone 
    
  )
 (
      
    select location_id, borough, zone_name, service_zone
    from (
        /*
    Dimension table: TLC Taxi Zone locations.
*/

with zones as (
    select * from "dev"."main"."stg_taxi_zones"
),

final as (
    select
        location_id,
        borough,
        zone_name,
        service_zone
    from zones
)

select * from final
    ) as model_subq
    );
  
  
[0m19:03:42.705845 [info ] [Thread-1 (]: 31 of 91 OK created sql table model main.dim_payment_types ..................... [[32mOK[0m in 0.09s]
[0m19:03:42.707354 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.dim_payment_types
[0m19:03:42.708314 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m19:03:42.708682 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m19:03:42.709078 [info ] [Thread-3 (]: 33 of 91 START test not_null_dim_payment_types_payment_type_id ................. [RUN]
[0m19:03:42.709552 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m19:03:42.709945 [info ] [Thread-1 (]: 34 of 91 START test not_null_dim_payment_types_payment_type_name ............... [RUN]
[0m19:03:42.710670 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c, now test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10)
[0m19:03:42.713510 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m19:03:42.714186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_payment_types, now test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0)
[0m19:03:42.714849 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m19:03:42.715609 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
alter table "dev"."main"."dim_locations" rename to "dim_locations__dbt_backup"
[0m19:03:42.716202 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m19:03:42.719086 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m19:03:42.723231 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m19:03:42.723899 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m19:03:42.728096 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m19:03:42.728671 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
alter table "dev"."main"."dim_locations__dbt_tmp" rename to "dim_locations"
[0m19:03:42.729594 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m19:03:42.731073 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: COMMIT
[0m19:03:42.731794 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m19:03:42.732319 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: COMMIT
[0m19:03:42.733383 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m19:03:42.736919 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m19:03:42.737374 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m19:03:42.739646 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m19:03:42.740527 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m19:03:42.743153 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m19:03:42.743756 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
drop table if exists "dev"."main"."dim_locations__dbt_backup" cascade
[0m19:03:42.745202 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m19:03:42.745981 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: BEGIN
[0m19:03:42.746752 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:03:42.747539 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m19:03:42.748017 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m19:03:42.748349 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m19:03:42.748672 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: BEGIN
[0m19:03:42.750429 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: Close
[0m19:03:42.751092 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m19:03:42.751858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:42.753188 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84172053-510c-4981-92d2-735fe95c3111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5dcc794950>]}
[0m19:03:42.753562 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."dim_payment_types"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m19:03:42.755086 [info ] [Thread-4 (]: 32 of 91 OK created sql table model main.dim_locations ......................... [[32mOK[0m in 0.10s]
[0m19:03:42.755795 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:03:42.756725 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.dim_locations
[0m19:03:42.757187 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.757547 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m19:03:42.758347 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m19:03:42.760478 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: ROLLBACK
[0m19:03:42.761035 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_name
from "dev"."main"."dim_payment_types"
where payment_type_name is null



  
  
      
    ) dbt_internal_test
[0m19:03:42.761730 [info ] [Thread-4 (]: 35 of 91 START test unique_dim_payment_types_payment_type_id ................... [RUN]
[0m19:03:42.762883 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10'
[0m19:03:42.764014 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_locations, now test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62)
[0m19:03:42.764651 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.764972 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: Close
[0m19:03:42.765651 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m19:03:42.767379 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: ROLLBACK
[0m19:03:42.768299 [info ] [Thread-3 (]: 33 of 91 PASS not_null_dim_payment_types_payment_type_id ....................... [[32mPASS[0m in 0.06s]
[0m19:03:42.772010 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m19:03:42.773216 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0'
[0m19:03:42.773941 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m19:03:42.774842 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: Close
[0m19:03:42.775497 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m19:03:42.776623 [info ] [Thread-1 (]: 34 of 91 PASS not_null_dim_payment_types_payment_type_name ..................... [[32mPASS[0m in 0.06s]
[0m19:03:42.777367 [info ] [Thread-3 (]: 36 of 91 START test not_null_dim_locations_borough ............................. [RUN]
[0m19:03:42.778172 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m19:03:42.779013 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10, now test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af)
[0m19:03:42.779626 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m19:03:42.780367 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m19:03:42.781383 [info ] [Thread-1 (]: 37 of 91 START test not_null_dim_locations_location_id ......................... [RUN]
[0m19:03:42.784407 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m19:03:42.785136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0, now test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476)
[0m19:03:42.786091 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m19:03:42.788820 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m19:03:42.789219 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m19:03:42.791702 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m19:03:42.792162 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m19:03:42.794323 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m19:03:42.795790 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m19:03:42.797701 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m19:03:42.799402 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m19:03:42.800142 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m19:03:42.800542 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: BEGIN
[0m19:03:42.801253 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: BEGIN
[0m19:03:42.801892 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:03:42.802636 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m19:03:42.803062 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:03:42.804252 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m19:03:42.804533 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: BEGIN
[0m19:03:42.805424 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m19:03:42.805786 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m19:03:42.806316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:42.806784 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m19:03:42.807280 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."dim_payment_types"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:03:42.808223 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:03:42.808590 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select borough
from "dev"."main"."dim_locations"
where borough is null



  
  
      
    ) dbt_internal_test
[0m19:03:42.809343 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m19:03:42.810271 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "dev"."main"."dim_locations"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m19:03:42.810624 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m19:03:42.811005 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.812976 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: ROLLBACK
[0m19:03:42.813418 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:03:42.814753 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: ROLLBACK
[0m19:03:42.815561 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62'
[0m19:03:42.817373 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: ROLLBACK
[0m19:03:42.818342 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af'
[0m19:03:42.818975 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: Close
[0m19:03:42.820010 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476'
[0m19:03:42.820563 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: Close
[0m19:03:42.821425 [info ] [Thread-4 (]: 35 of 91 PASS unique_dim_payment_types_payment_type_id ......................... [[32mPASS[0m in 0.06s]
[0m19:03:42.821707 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: Close
[0m19:03:42.822335 [info ] [Thread-3 (]: 36 of 91 PASS not_null_dim_locations_borough ................................... [[32mPASS[0m in 0.04s]
[0m19:03:42.822961 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m19:03:42.824010 [info ] [Thread-1 (]: 37 of 91 PASS not_null_dim_locations_location_id ............................... [[32mPASS[0m in 0.04s]
[0m19:03:42.824533 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m19:03:42.825116 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m19:03:42.825871 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m19:03:42.826449 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m19:03:42.827018 [info ] [Thread-4 (]: 38 of 91 START test not_null_dim_locations_zone_name ........................... [RUN]
[0m19:03:42.827880 [info ] [Thread-3 (]: 39 of 91 START test unique_dim_locations_location_id ........................... [RUN]
[0m19:03:42.828462 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62, now test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d)
[0m19:03:42.829006 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af, now test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d)
[0m19:03:42.829508 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m19:03:42.830030 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m19:03:42.833792 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m19:03:42.838111 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m19:03:42.845618 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m19:03:42.846152 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m19:03:42.848218 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m19:03:42.850665 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m19:03:42.858454 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m19:03:42.859193 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: BEGIN
[0m19:03:42.859776 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m19:03:42.860222 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:03:42.860940 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: BEGIN
[0m19:03:42.862056 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m19:03:42.862370 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:03:42.862902 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m19:03:42.863839 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "dev"."main"."dim_locations"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:03:42.864187 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m19:03:42.864970 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m19:03:42.865463 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select zone_name
from "dev"."main"."dim_locations"
where zone_name is null



  
  
      
    ) dbt_internal_test
[0m19:03:42.865872 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:03:42.867609 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: ROLLBACK
[0m19:03:42.868162 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m19:03:42.869129 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d'
[0m19:03:42.870459 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: ROLLBACK
[0m19:03:42.870748 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: Close
[0m19:03:42.871643 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d'
[0m19:03:42.872859 [info ] [Thread-3 (]: 39 of 91 PASS unique_dim_locations_location_id ................................. [[32mPASS[0m in 0.04s]
[0m19:03:42.873207 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: Close
[0m19:03:42.873903 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m19:03:42.874917 [info ] [Thread-4 (]: 38 of 91 PASS not_null_dim_locations_zone_name ................................. [[32mPASS[0m in 0.05s]
[0m19:03:42.875783 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m19:03:43.885173 [debug] [Thread-2 (]: SQL status: OK in 1.935 seconds
[0m19:03:43.887468 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m19:03:43.887940 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
alter table "dev"."main"."stg_yellow_trips" rename to "stg_yellow_trips__dbt_backup"
[0m19:03:43.888766 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m19:03:43.890608 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m19:03:43.891067 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
alter table "dev"."main"."stg_yellow_trips__dbt_tmp" rename to "stg_yellow_trips"
[0m19:03:43.891882 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m19:03:43.892929 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: COMMIT
[0m19:03:43.893257 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m19:03:43.893601 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: COMMIT
[0m19:03:43.954011 [debug] [Thread-2 (]: SQL status: OK in 0.060 seconds
[0m19:03:43.956120 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m19:03:43.956494 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
drop table if exists "dev"."main"."stg_yellow_trips__dbt_backup" cascade
[0m19:03:43.960950 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m19:03:43.962184 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: Close
[0m19:03:44.027887 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84172053-510c-4981-92d2-735fe95c3111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e74a41970>]}
[0m19:03:44.028651 [info ] [Thread-2 (]: 2 of 91 OK created sql table model main.stg_yellow_trips ....................... [[32mOK[0m in 2.19s]
[0m19:03:44.029239 [debug] [Thread-2 (]: Finished running node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m19:03:44.030441 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m19:03:44.030877 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m19:03:44.031161 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m19:03:44.031478 [info ] [Thread-1 (]: 40 of 91 START test accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6  [RUN]
[0m19:03:44.031820 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m19:03:44.032073 [info ] [Thread-3 (]: 41 of 91 START test accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99  [RUN]
[0m19:03:44.032501 [info ] [Thread-4 (]: 42 of 91 START test accepted_values_stg_yellow_trips_vendor_id__1__2__6 ........ [RUN]
[0m19:03:44.033008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44)
[0m19:03:44.033468 [info ] [Thread-2 (]: 43 of 91 START test assert_fare_not_exceeds_total .............................. [RUN]
[0m19:03:44.033976 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098)
[0m19:03:44.034431 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27)
[0m19:03:44.034895 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m19:03:44.035367 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_yellow_trips, now test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total)
[0m19:03:44.035769 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m19:03:44.036132 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m19:03:44.040928 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m19:03:44.041540 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m19:03:44.044561 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m19:03:44.047119 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m19:03:44.050409 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m19:03:44.054426 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m19:03:44.054763 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m19:03:44.055042 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m19:03:44.056931 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m19:03:44.058682 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m19:03:44.059004 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m19:03:44.060817 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m19:03:44.062956 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m19:03:44.065997 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m19:03:44.066459 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m19:03:44.066734 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: BEGIN
[0m19:03:44.067429 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: BEGIN
[0m19:03:44.067819 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m19:03:44.068082 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:03:44.068443 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m19:03:44.068685 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:03:44.069091 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: BEGIN
[0m19:03:44.069835 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: BEGIN
[0m19:03:44.070358 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:03:44.070761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:44.086613 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m19:03:44.087034 [debug] [Thread-4 (]: SQL status: OK in 0.018 seconds
[0m19:03:44.087419 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m19:03:44.087790 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m19:03:44.088010 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m19:03:44.088410 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m19:03:44.088809 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m19:03:44.089151 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
    Singular test: fare_amount should not exceed total_amount.
*/

select
    trip_id,
    fare_amount,
    total_amount
from "dev"."main"."stg_yellow_trips"
where fare_amount > total_amount + 0.01
  and total_amount > 0
  
  
      
    ) dbt_internal_test
[0m19:03:44.089534 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m19:03:44.089873 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        vendor_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by vendor_id

)

select *
from all_values
where value_field not in (
    '1','2','6'
)



  
  
      
    ) dbt_internal_test
[0m19:03:44.090236 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rate_code_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by rate_code_id

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5','6','99'
)



  
  
      
    ) dbt_internal_test
[0m19:03:44.091086 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        payment_type_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by payment_type_id

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6'
)



  
  
      
    ) dbt_internal_test
[0m19:03:44.124431 [debug] [Thread-2 (]: SQL status: OK in 0.034 seconds
[0m19:03:44.127043 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: ROLLBACK
[0m19:03:44.128754 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total'
[0m19:03:44.129300 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: Close
[0m19:03:44.129757 [debug] [Thread-4 (]: SQL status: OK in 0.038 seconds
[0m19:03:44.130134 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m19:03:44.130687 [info ] [Thread-2 (]: 43 of 91 PASS assert_fare_not_exceeds_total .................................... [[32mPASS[0m in 0.10s]
[0m19:03:44.132222 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: ROLLBACK
[0m19:03:44.132483 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m19:03:44.133474 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: ROLLBACK
[0m19:03:44.133817 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m19:03:44.134631 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27'
[0m19:03:44.135876 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: ROLLBACK
[0m19:03:44.136707 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44'
[0m19:03:44.137729 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m19:03:44.138149 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: Close
[0m19:03:44.138719 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098'
[0m19:03:44.139062 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: Close
[0m19:03:44.139421 [info ] [Thread-2 (]: 44 of 91 START test not_null_stg_yellow_trips_dropoff_datetime ................. [RUN]
[0m19:03:44.140140 [info ] [Thread-4 (]: 42 of 91 PASS accepted_values_stg_yellow_trips_vendor_id__1__2__6 .............. [[32mPASS[0m in 0.11s]
[0m19:03:44.140587 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: Close
[0m19:03:44.141324 [info ] [Thread-1 (]: 40 of 91 PASS accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6  [[32mPASS[0m in 0.11s]
[0m19:03:44.141740 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052)
[0m19:03:44.142240 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m19:03:44.142914 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m19:03:44.143455 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m19:03:44.144089 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m19:03:44.144581 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m19:03:44.149047 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m19:03:44.149486 [info ] [Thread-3 (]: 41 of 91 PASS accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99  [[32mPASS[0m in 0.12s]
[0m19:03:44.149838 [info ] [Thread-4 (]: 45 of 91 START test not_null_stg_yellow_trips_dropoff_location_id .............. [RUN]
[0m19:03:44.150480 [info ] [Thread-1 (]: 46 of 91 START test not_null_stg_yellow_trips_fare_amount ...................... [RUN]
[0m19:03:44.151194 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m19:03:44.151628 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048)
[0m19:03:44.152106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97)
[0m19:03:44.152507 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m19:03:44.152902 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m19:03:44.153276 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m19:03:44.153637 [info ] [Thread-3 (]: 47 of 91 START test not_null_stg_yellow_trips_pickup_datetime .................. [RUN]
[0m19:03:44.156673 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m19:03:44.159104 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m19:03:44.159817 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed)
[0m19:03:44.160453 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m19:03:44.160919 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m19:03:44.162451 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m19:03:44.165943 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m19:03:44.167725 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m19:03:44.169406 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m19:03:44.169687 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m19:03:44.171771 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m19:03:44.172057 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m19:03:44.173619 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m19:03:44.174783 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m19:03:44.175146 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m19:03:44.175450 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m19:03:44.175718 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: BEGIN
[0m19:03:44.176101 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: BEGIN
[0m19:03:44.176561 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: BEGIN
[0m19:03:44.176911 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:03:44.177214 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:03:44.177454 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m19:03:44.177670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:44.178563 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: BEGIN
[0m19:03:44.179043 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:03:44.194336 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m19:03:44.194677 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m19:03:44.194987 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m19:03:44.195233 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m19:03:44.195486 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m19:03:44.195896 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m19:03:44.196221 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m19:03:44.196562 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_datetime
from "dev"."main"."stg_yellow_trips"
where dropoff_datetime is null



  
  
      
    ) dbt_internal_test
[0m19:03:44.196909 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m19:03:44.197233 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_location_id
from "dev"."main"."stg_yellow_trips"
where dropoff_location_id is null



  
  
      
    ) dbt_internal_test
[0m19:03:44.197571 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "dev"."main"."stg_yellow_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m19:03:44.198142 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fare_amount
from "dev"."main"."stg_yellow_trips"
where fare_amount is null



  
  
      
    ) dbt_internal_test
[0m19:03:44.198656 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:03:44.199130 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:44.200268 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: ROLLBACK
[0m19:03:44.200506 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m19:03:44.200981 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:03:44.201789 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: ROLLBACK
[0m19:03:44.202305 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052'
[0m19:03:44.203048 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: ROLLBACK
[0m19:03:44.203776 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: ROLLBACK
[0m19:03:44.204225 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048'
[0m19:03:44.204607 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: Close
[0m19:03:44.205258 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed'
[0m19:03:44.205811 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97'
[0m19:03:44.206149 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: Close
[0m19:03:44.206717 [info ] [Thread-2 (]: 44 of 91 PASS not_null_stg_yellow_trips_dropoff_datetime ....................... [[32mPASS[0m in 0.06s]
[0m19:03:44.206933 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: Close
[0m19:03:44.207235 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: Close
[0m19:03:44.207777 [info ] [Thread-4 (]: 45 of 91 PASS not_null_stg_yellow_trips_dropoff_location_id .................... [[32mPASS[0m in 0.06s]
[0m19:03:44.208162 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m19:03:44.208685 [info ] [Thread-3 (]: 47 of 91 PASS not_null_stg_yellow_trips_pickup_datetime ........................ [[32mPASS[0m in 0.05s]
[0m19:03:44.209180 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m19:03:44.209745 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m19:03:44.210306 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m19:03:44.210863 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m19:03:44.211422 [info ] [Thread-2 (]: 48 of 91 START test not_null_stg_yellow_trips_pickup_location_id ............... [RUN]
[0m19:03:44.211866 [info ] [Thread-1 (]: 46 of 91 PASS not_null_stg_yellow_trips_fare_amount ............................ [[32mPASS[0m in 0.06s]
[0m19:03:44.212299 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m19:03:44.212644 [info ] [Thread-4 (]: 49 of 91 START test not_null_stg_yellow_trips_total_amount ..................... [RUN]
[0m19:03:44.213064 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1)
[0m19:03:44.213535 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m19:03:44.213945 [info ] [Thread-3 (]: 50 of 91 START test not_null_stg_yellow_trips_trip_distance_miles .............. [RUN]
[0m19:03:44.214510 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6)
[0m19:03:44.214854 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m19:03:44.215218 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m19:03:44.215609 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7)
[0m19:03:44.216020 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m19:03:44.218672 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m19:03:44.219179 [info ] [Thread-1 (]: 51 of 91 START test not_null_stg_yellow_trips_trip_id .......................... [RUN]
[0m19:03:44.219610 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m19:03:44.222485 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m19:03:44.223396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1)
[0m19:03:44.226218 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m19:03:44.226949 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m19:03:44.229476 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m19:03:44.230490 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m19:03:44.232064 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m19:03:44.233165 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m19:03:44.233435 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m19:03:44.234827 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m19:03:44.235192 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m19:03:44.237695 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m19:03:44.239875 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m19:03:44.241048 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m19:03:44.241347 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m19:03:44.241715 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: BEGIN
[0m19:03:44.242128 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: BEGIN
[0m19:03:44.242484 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:03:44.242909 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:03:44.243182 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m19:03:44.244376 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: BEGIN
[0m19:03:44.244805 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:03:44.245099 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m19:03:44.245589 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: BEGIN
[0m19:03:44.245903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:44.260899 [debug] [Thread-4 (]: SQL status: OK in 0.018 seconds
[0m19:03:44.261322 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m19:03:44.261592 [debug] [Thread-2 (]: SQL status: OK in 0.019 seconds
[0m19:03:44.261819 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m19:03:44.262053 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m19:03:44.262540 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m19:03:44.262915 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m19:03:44.263222 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."stg_yellow_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m19:03:44.263519 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m19:03:44.263969 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_distance_miles
from "dev"."main"."stg_yellow_trips"
where trip_distance_miles is null



  
  
      
    ) dbt_internal_test
[0m19:03:44.264354 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_location_id
from "dev"."main"."stg_yellow_trips"
where pickup_location_id is null



  
  
      
    ) dbt_internal_test
[0m19:03:44.265061 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."stg_yellow_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m19:03:44.265451 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:44.266347 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:03:44.266736 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:03:44.266978 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:03:44.268098 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: ROLLBACK
[0m19:03:44.268998 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: ROLLBACK
[0m19:03:44.269749 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: ROLLBACK
[0m19:03:44.270506 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: ROLLBACK
[0m19:03:44.271264 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6'
[0m19:03:44.272119 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7'
[0m19:03:44.272603 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1'
[0m19:03:44.273214 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1'
[0m19:03:44.273582 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: Close
[0m19:03:44.273910 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: Close
[0m19:03:44.274170 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: Close
[0m19:03:44.274432 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: Close
[0m19:03:44.274951 [info ] [Thread-4 (]: 49 of 91 PASS not_null_stg_yellow_trips_total_amount ........................... [[32mPASS[0m in 0.06s]
[0m19:03:44.275477 [info ] [Thread-3 (]: 50 of 91 PASS not_null_stg_yellow_trips_trip_distance_miles .................... [[32mPASS[0m in 0.06s]
[0m19:03:44.275906 [info ] [Thread-1 (]: 51 of 91 PASS not_null_stg_yellow_trips_trip_id ................................ [[32mPASS[0m in 0.05s]
[0m19:03:44.276357 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m19:03:44.276773 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m19:03:44.277301 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m19:03:44.277855 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m19:03:44.278435 [info ] [Thread-2 (]: 48 of 91 PASS not_null_stg_yellow_trips_pickup_location_id ..................... [[32mPASS[0m in 0.07s]
[0m19:03:44.278725 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m19:03:44.279110 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m19:03:44.279609 [info ] [Thread-4 (]: 52 of 91 START test not_null_stg_yellow_trips_vendor_id ........................ [RUN]
[0m19:03:44.280199 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m19:03:44.280570 [info ] [Thread-3 (]: 53 of 91 START test unique_stg_yellow_trips_trip_id ............................ [RUN]
[0m19:03:44.281189 [info ] [Thread-1 (]: 54 of 91 START test relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_  [RUN]
[0m19:03:44.281668 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57)
[0m19:03:44.282075 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m19:03:44.282452 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7, now test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965)
[0m19:03:44.282876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1, now test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a)
[0m19:03:44.283268 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m19:03:44.283760 [info ] [Thread-2 (]: 55 of 91 START test relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_  [RUN]
[0m19:03:44.284144 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m19:03:44.284518 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m19:03:44.287253 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m19:03:44.287812 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1, now test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f)
[0m19:03:44.290138 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m19:03:44.295025 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m19:03:44.295961 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m19:03:44.299637 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m19:03:44.303184 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m19:03:44.304960 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m19:03:44.305256 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m19:03:44.305627 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m19:03:44.307246 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m19:03:44.307623 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m19:03:44.308867 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m19:03:44.311607 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m19:03:44.313013 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m19:03:44.313418 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: BEGIN
[0m19:03:44.313829 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:03:44.314533 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m19:03:44.314863 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m19:03:44.315196 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: BEGIN
[0m19:03:44.315602 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: BEGIN
[0m19:03:44.315953 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m19:03:44.316172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:44.316576 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:03:44.316957 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: BEGIN
[0m19:03:44.317634 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:03:44.330495 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m19:03:44.330960 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m19:03:44.331205 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m19:03:44.331448 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m19:03:44.331723 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m19:03:44.332168 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m19:03:44.332551 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m19:03:44.332865 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m19:03:44.333198 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select dropoff_location_id as from_field
    from "dev"."main"."stg_yellow_trips"
    where dropoff_location_id is not null
),

parent as (
    select location_id as to_field
    from "dev"."main"."stg_taxi_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m19:03:44.333541 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_yellow_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:03:44.333877 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "dev"."main"."stg_yellow_trips"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m19:03:44.334207 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select pickup_location_id as from_field
    from "dev"."main"."stg_yellow_trips"
    where pickup_location_id is not null
),

parent as (
    select location_id as to_field
    from "dev"."main"."stg_taxi_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m19:03:44.335782 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:44.339760 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: ROLLBACK
[0m19:03:44.342245 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57'
[0m19:03:44.344115 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: Close
[0m19:03:44.345462 [info ] [Thread-4 (]: 52 of 91 PASS not_null_stg_yellow_trips_vendor_id .............................. [[32mPASS[0m in 0.06s]
[0m19:03:44.347769 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m19:03:44.445471 [debug] [Thread-2 (]: SQL status: OK in 0.110 seconds
[0m19:03:44.447753 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: ROLLBACK
[0m19:03:44.448220 [debug] [Thread-1 (]: SQL status: OK in 0.114 seconds
[0m19:03:44.449115 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f'
[0m19:03:44.450416 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: ROLLBACK
[0m19:03:44.450702 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: Close
[0m19:03:44.451435 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a'
[0m19:03:44.452259 [info ] [Thread-2 (]: 55 of 91 PASS relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_  [[32mPASS[0m in 0.16s]
[0m19:03:44.452580 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: Close
[0m19:03:44.454160 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m19:03:44.458254 [info ] [Thread-1 (]: 54 of 91 PASS relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_  [[32mPASS[0m in 0.18s]
[0m19:03:44.460088 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m19:03:44.486710 [debug] [Thread-3 (]: SQL status: OK in 0.152 seconds
[0m19:03:44.488333 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: ROLLBACK
[0m19:03:44.489117 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965'
[0m19:03:44.489508 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: Close
[0m19:03:44.510733 [info ] [Thread-3 (]: 53 of 91 PASS unique_stg_yellow_trips_trip_id .................................. [[32mPASS[0m in 0.23s]
[0m19:03:44.511401 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m19:03:44.512343 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m19:03:44.512881 [info ] [Thread-4 (]: 56 of 91 START sql view model main.int_trip_metrics ............................ [RUN]
[0m19:03:44.513367 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57, now model.nyc_taxi_pipeline_00.int_trip_metrics)
[0m19:03:44.513742 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m19:03:44.576449 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m19:03:44.582776 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m19:03:44.585130 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m19:03:44.592621 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m19:03:44.593156 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: BEGIN
[0m19:03:44.593525 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:03:44.610291 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m19:03:44.611002 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m19:03:44.611551 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */

  
  create view "dev"."main"."int_trip_metrics__dbt_tmp" as (
    /*
    Intermediate model: Trip-level enrichment with calculated metrics.
    Uses adapter-dispatched macros for cross-dialect compatibility.
*/

with trips as (
    select * from "dev"."main"."stg_yellow_trips"
),

enriched as (
    select
        trip_id,
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        payment_type_id,
        pickup_datetime,
        dropoff_datetime,
        passenger_count,
        trip_distance_miles,
        store_and_fwd_flag,

        -- calculated: duration in minutes
        
    datediff('minute', pickup_datetime, dropoff_datetime)
 as trip_duration_minutes,

        -- calculated: average speed (avoid division by zero)
        case
            when 
    datediff('minute', pickup_datetime, dropoff_datetime)
 > 0
            then round(
                trip_distance_miles / (
    datediff('minute', pickup_datetime, dropoff_datetime)
 / 60.0),
                2
            )
            else null
        end as avg_speed_mph,

        -- calculated: cost per mile
        case
            when trip_distance_miles > 0
            then round(fare_amount / trip_distance_miles, 2)
            else null
        end as cost_per_mile,

        -- calculated: tip percentage
        case
            when fare_amount > 0
            then round((tip_amount / fare_amount) * 100, 2)
            else null
        end as tip_percentage,

        -- time dimensions (using adapter-dispatched macros)
        date_trunc('day', pickup_datetime)::date as pickup_date,
        extract(hour from pickup_datetime) as pickup_hour,
        
    dayname(pickup_datetime)
 as pickup_day_of_week,
        case
            when extract(dow from pickup_datetime) in (0, 6) then true
            else false
        end as is_weekend,

        -- financials passthrough
        fare_amount,
        extra_amount,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount,
        congestion_surcharge,
        airport_fee

    from trips
)

select *
from enriched
where trip_duration_minutes between 1 and 720
  and (avg_speed_mph is null or avg_speed_mph < 100)
  );

[0m19:03:44.613360 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:44.615980 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m19:03:44.616430 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
alter view "dev"."main"."int_trip_metrics" rename to "int_trip_metrics__dbt_backup"
[0m19:03:44.617149 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m19:03:44.618852 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m19:03:44.619183 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
alter view "dev"."main"."int_trip_metrics__dbt_tmp" rename to "int_trip_metrics"
[0m19:03:44.619861 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m19:03:44.620803 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: COMMIT
[0m19:03:44.621175 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m19:03:44.621540 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: COMMIT
[0m19:03:44.626505 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m19:03:44.628003 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m19:03:44.628337 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
drop view if exists "dev"."main"."int_trip_metrics__dbt_backup" cascade
[0m19:03:44.630917 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m19:03:44.631985 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: Close
[0m19:03:44.667475 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84172053-510c-4981-92d2-735fe95c3111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5dcc7b15b0>]}
[0m19:03:44.668244 [info ] [Thread-4 (]: 56 of 91 OK created sql view model main.int_trip_metrics ....................... [[32mOK[0m in 0.15s]
[0m19:03:44.668758 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m19:03:44.669731 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m19:03:44.670346 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m19:03:44.670030 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m19:03:44.671012 [info ] [Thread-1 (]: 57 of 91 START test assert_trip_duration_positive .............................. [RUN]
[0m19:03:44.671363 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m19:03:44.671636 [info ] [Thread-2 (]: 59 of 91 START test dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1  [RUN]
[0m19:03:44.672196 [info ] [Thread-3 (]: 58 of 91 START test dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0  [RUN]
[0m19:03:44.672774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a, now test.nyc_taxi_pipeline_00.assert_trip_duration_positive)
[0m19:03:44.673257 [info ] [Thread-4 (]: 60 of 91 START test not_null_int_trip_metrics_is_weekend ....................... [RUN]
[0m19:03:44.673877 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718)
[0m19:03:44.674406 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574)
[0m19:03:44.674854 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m19:03:44.675436 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_trip_metrics, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed)
[0m19:03:44.675908 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m19:03:44.676292 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m19:03:44.678735 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m19:03:44.679202 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m19:03:44.684308 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m19:03:44.687657 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m19:03:44.691321 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m19:03:44.694960 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m19:03:44.696765 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m19:03:44.697462 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m19:03:44.697754 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m19:03:44.699040 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m19:03:44.699413 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m19:03:44.700795 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m19:03:44.702648 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m19:03:44.704092 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m19:03:44.704467 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: BEGIN
[0m19:03:44.704812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:44.706110 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m19:03:44.706455 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: BEGIN
[0m19:03:44.706777 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m19:03:44.707055 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:03:44.707533 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: BEGIN
[0m19:03:44.708006 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m19:03:44.708222 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:03:44.708575 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: BEGIN
[0m19:03:44.709075 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:03:44.723247 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m19:03:44.723787 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m19:03:44.724039 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m19:03:44.724268 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m19:03:44.724471 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m19:03:44.724862 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m19:03:44.725277 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m19:03:44.725711 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_trip_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not trip_duration_minutes >= 1
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not trip_duration_minutes <= 720
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m19:03:44.726128 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m19:03:44.726523 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
    Singular test: No trip should have negative duration.
*/

select
    trip_id,
    pickup_datetime,
    dropoff_datetime,
    trip_duration_minutes
from "dev"."main"."int_trip_metrics"
where trip_duration_minutes < 0
  
  
      
    ) dbt_internal_test
[0m19:03:44.726910 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."int_trip_metrics"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m19:03:44.727593 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_trip_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m19:03:44.729303 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:03:44.729648 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:44.733088 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: ROLLBACK
[0m19:03:44.734765 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: ROLLBACK
[0m19:03:44.735859 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.assert_trip_duration_positive'
[0m19:03:44.737696 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed'
[0m19:03:44.739858 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: Close
[0m19:03:44.742310 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: Close
[0m19:03:44.745203 [info ] [Thread-1 (]: 57 of 91 PASS assert_trip_duration_positive .................................... [[32mPASS[0m in 0.07s]
[0m19:03:44.746721 [info ] [Thread-4 (]: 60 of 91 PASS not_null_int_trip_metrics_is_weekend ............................. [[32mPASS[0m in 0.07s]
[0m19:03:44.748736 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m19:03:44.750957 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m19:03:44.753339 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m19:03:44.755230 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m19:03:44.756018 [info ] [Thread-1 (]: 61 of 91 START test not_null_int_trip_metrics_pickup_date ...................... [RUN]
[0m19:03:44.759118 [info ] [Thread-4 (]: 62 of 91 START test not_null_int_trip_metrics_pickup_hour ...................... [RUN]
[0m19:03:44.761526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.assert_trip_duration_positive, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3)
[0m19:03:44.764145 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082)
[0m19:03:44.765698 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m19:03:44.767936 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m19:03:44.773005 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m19:03:44.777351 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m19:03:44.782637 [debug] [Thread-3 (]: SQL status: OK in 0.054 seconds
[0m19:03:44.784323 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: ROLLBACK
[0m19:03:44.785173 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574'
[0m19:03:44.785513 [debug] [Thread-2 (]: SQL status: OK in 0.058 seconds
[0m19:03:44.785802 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: Close
[0m19:03:44.786944 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: ROLLBACK
[0m19:03:44.787482 [info ] [Thread-3 (]: 58 of 91 PASS dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0 ..... [[32mPASS[0m in 0.11s]
[0m19:03:44.788178 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718'
[0m19:03:44.788935 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m19:03:44.789284 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m19:03:44.789544 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: Close
[0m19:03:44.789999 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m19:03:44.791955 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m19:03:44.792261 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m19:03:44.792691 [info ] [Thread-3 (]: 63 of 91 START test not_null_int_trip_metrics_trip_duration_minutes ............ [RUN]
[0m19:03:44.794622 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m19:03:44.795219 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c)
[0m19:03:44.796163 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m19:03:44.799091 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m19:03:44.799611 [info ] [Thread-2 (]: 59 of 91 PASS dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1  [[32mPASS[0m in 0.13s]
[0m19:03:44.800634 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m19:03:44.801028 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m19:03:44.801379 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m19:03:44.802028 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: BEGIN
[0m19:03:44.802563 [info ] [Thread-2 (]: 64 of 91 START test not_null_int_trip_metrics_trip_id .......................... [RUN]
[0m19:03:44.803047 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m19:03:44.803321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:44.803823 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f)
[0m19:03:44.804260 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: BEGIN
[0m19:03:44.805126 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m19:03:44.805573 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:03:44.810297 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m19:03:44.811980 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m19:03:44.813847 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m19:03:44.815746 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m19:03:44.817434 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m19:03:44.822413 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m19:03:44.822941 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: BEGIN
[0m19:03:44.823379 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:03:44.823906 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m19:03:44.824348 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: BEGIN
[0m19:03:44.824724 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:03:44.826010 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m19:03:44.826237 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m19:03:44.826453 [debug] [Thread-4 (]: SQL status: OK in 0.021 seconds
[0m19:03:44.826733 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m19:03:44.826961 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m19:03:44.827316 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m19:03:44.827725 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m19:03:44.828104 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_trip_metrics"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m19:03:44.828449 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m19:03:44.828833 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_duration_minutes
from "dev"."main"."int_trip_metrics"
where trip_duration_minutes is null



  
  
      
    ) dbt_internal_test
[0m19:03:44.829206 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."int_trip_metrics"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m19:03:44.829846 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."int_trip_metrics"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m19:03:44.831073 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:03:44.831727 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:44.832068 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:03:44.833344 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: ROLLBACK
[0m19:03:44.835343 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: ROLLBACK
[0m19:03:44.837745 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: ROLLBACK
[0m19:03:44.839608 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3'
[0m19:03:44.841189 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082'
[0m19:03:44.844610 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f'
[0m19:03:44.846013 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: Close
[0m19:03:44.848038 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: Close
[0m19:03:44.849646 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: Close
[0m19:03:44.853610 [info ] [Thread-1 (]: 61 of 91 PASS not_null_int_trip_metrics_pickup_date ............................ [[32mPASS[0m in 0.09s]
[0m19:03:44.855350 [info ] [Thread-4 (]: 62 of 91 PASS not_null_int_trip_metrics_pickup_hour ............................ [[32mPASS[0m in 0.09s]
[0m19:03:44.857581 [info ] [Thread-2 (]: 64 of 91 PASS not_null_int_trip_metrics_trip_id ................................ [[32mPASS[0m in 0.05s]
[0m19:03:44.859618 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m19:03:44.862970 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m19:03:44.865105 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m19:03:44.889097 [debug] [Thread-3 (]: SQL status: OK in 0.059 seconds
[0m19:03:44.890467 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: ROLLBACK
[0m19:03:44.891132 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c'
[0m19:03:44.891573 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: Close
[0m19:03:44.896665 [info ] [Thread-3 (]: 63 of 91 PASS not_null_int_trip_metrics_trip_duration_minutes .................. [[32mPASS[0m in 0.10s]
[0m19:03:44.897417 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m19:03:44.898239 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.int_daily_summary
[0m19:03:44.898565 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m19:03:44.898817 [debug] [Thread-2 (]: Began running node model.nyc_taxi_pipeline_00.fct_trips
[0m19:03:44.899162 [info ] [Thread-1 (]: 65 of 91 START sql view model main.int_daily_summary ........................... [RUN]
[0m19:03:44.899769 [info ] [Thread-4 (]: 66 of 91 START sql view model main.int_hourly_patterns ......................... [RUN]
[0m19:03:44.900243 [info ] [Thread-2 (]: 67 of 91 START sql incremental model main.fct_trips ............................ [RUN]
[0m19:03:44.900687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3, now model.nyc_taxi_pipeline_00.int_daily_summary)
[0m19:03:44.901075 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082, now model.nyc_taxi_pipeline_00.int_hourly_patterns)
[0m19:03:44.901439 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f, now model.nyc_taxi_pipeline_00.fct_trips)
[0m19:03:44.901880 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.int_daily_summary
[0m19:03:44.902274 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m19:03:44.902611 [debug] [Thread-2 (]: Began compiling node model.nyc_taxi_pipeline_00.fct_trips
[0m19:03:44.905162 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m19:03:44.907056 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m19:03:44.911649 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.fct_trips"
[0m19:03:44.916424 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m19:03:44.916848 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.int_daily_summary
[0m19:03:44.919149 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m19:03:44.921855 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m19:03:44.922232 [debug] [Thread-2 (]: Began executing node model.nyc_taxi_pipeline_00.fct_trips
[0m19:03:44.940950 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m19:03:44.941454 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
DESCRIBE (select * from (
        /*
    Fact table: Fully enriched trip records with location names.
    Incremental with delete+insert strategy.
*/



with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

pickup_locations as (
    select * from "dev"."main"."dim_locations"
),

dropoff_locations as (
    select * from "dev"."main"."dim_locations"
),

final as (
    select
        t.trip_id,
        t.vendor_id,
        t.rate_code_id,
        t.payment_type_id,
        t.pickup_location_id,
        t.dropoff_location_id,
        t.pickup_datetime,
        t.dropoff_datetime,
        t.pickup_date,
        t.pickup_hour,
        t.pickup_day_of_week,
        t.is_weekend,
        t.passenger_count,
        t.trip_distance_miles,
        t.trip_duration_minutes,
        t.avg_speed_mph,
        t.cost_per_mile,
        t.fare_amount,
        t.extra_amount,
        t.mta_tax,
        t.tip_amount,
        t.tip_percentage,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.congestion_surcharge,
        t.airport_fee,

        -- enriched from dimensions
        pu.borough as pickup_borough,
        pu.zone_name as pickup_zone,
        do_loc.borough as dropoff_borough,
        do_loc.zone_name as dropoff_zone

    from trip_metrics t
    left join pickup_locations pu
        on t.pickup_location_id = pu.location_id
    left join dropoff_locations do_loc
        on t.dropoff_location_id = do_loc.location_id

    
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m19:03:44.941800 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m19:03:44.942064 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:03:44.942564 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: BEGIN
[0m19:03:44.943351 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:03:44.943606 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m19:03:44.943985 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: BEGIN
[0m19:03:44.944261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:44.961639 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m19:03:44.962009 [debug] [Thread-4 (]: SQL status: OK in 0.019 seconds
[0m19:03:44.962288 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m19:03:44.962637 [debug] [Thread-2 (]: SQL status: OK in 0.021 seconds
[0m19:03:44.962888 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m19:03:44.963380 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */

  
  create view "dev"."main"."int_daily_summary__dbt_tmp" as (
    /*
    Intermediate model: Daily aggregated trip and revenue metrics.
    One row per day with counts, averages, and revenue totals.
*/

with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

daily_agg as (
    select
        pickup_date,
        pickup_day_of_week,
        is_weekend,

        count(*) as total_trips,
        sum(passenger_count) as total_passengers,

        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(avg(avg_speed_mph), 2) as avg_speed_mph,

        round(sum(fare_amount), 2) as total_fare_revenue,
        round(sum(tip_amount), 2) as total_tip_revenue,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_trip_revenue,
        round(avg(tip_percentage), 2) as avg_tip_percentage,

        count(case when payment_type_id = 1 then 1 end) as credit_card_trips,
        count(case when payment_type_id = 2 then 1 end) as cash_trips

    from trip_metrics
    group by pickup_date, pickup_day_of_week, is_weekend
)

select * from daily_agg
  );

[0m19:03:44.965418 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m19:03:44.965704 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */

  
  create view "dev"."main"."int_hourly_patterns__dbt_tmp" as (
    /*
    Intermediate model: Hourly trip patterns by date.
    One row per date + hour combination.
*/

with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

hourly_agg as (
    select
        pickup_date,
        pickup_hour,
        pickup_day_of_week,
        is_weekend,

        count(*) as total_trips,
        round(avg(trip_distance_miles), 2) as avg_distance,
        round(avg(trip_duration_minutes), 2) as avg_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue

    from trip_metrics
    group by pickup_date, pickup_hour, pickup_day_of_week, is_weekend
)

select * from hourly_agg
  );

[0m19:03:44.966492 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as varchar)
 as trip_id, 
      
    cast(null as integer)
 as vendor_id, 
      
    cast(null as integer)
 as rate_code_id, 
      
    cast(null as integer)
 as payment_type_id, 
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as integer)
 as dropoff_location_id, 
      
    cast(null as timestamp)
 as pickup_datetime, 
      
    cast(null as timestamp)
 as dropoff_datetime, 
      
    cast(null as date)
 as pickup_date, 
      
    cast(null as bigint)
 as pickup_hour, 
      
    cast(null as varchar)
 as pickup_day_of_week, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as integer)
 as passenger_count, 
      
    cast(null as double)
 as trip_distance_miles, 
      
    cast(null as bigint)
 as trip_duration_minutes, 
      
    cast(null as double)
 as avg_speed_mph, 
      
    cast(null as double)
 as cost_per_mile, 
      
    cast(null as decimal(10,2))
 as fare_amount, 
      
    cast(null as decimal(10,2))
 as extra_amount, 
      
    cast(null as decimal(10,2))
 as mta_tax, 
      
    cast(null as decimal(10,2))
 as tip_amount, 
      
    cast(null as double)
 as tip_percentage, 
      
    cast(null as decimal(10,2))
 as tolls_amount, 
      
    cast(null as decimal(10,2))
 as improvement_surcharge, 
      
    cast(null as decimal(10,2))
 as total_amount, 
      
    cast(null as decimal(10,2))
 as congestion_surcharge, 
      
    cast(null as decimal(10,2))
 as airport_fee, 
      
    cast(null as varchar)
 as pickup_borough, 
      
    cast(null as varchar)
 as pickup_zone, 
      
    cast(null as varchar)
 as dropoff_borough, 
      
    cast(null as varchar)
 as dropoff_zone
    ) as __dbt_sbq
    where false
    limit 0
)
[0m19:03:44.967656 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:03:44.967946 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:03:44.968201 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:44.971041 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.fct_trips"
[0m19:03:44.973284 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m19:03:44.975382 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m19:03:44.976246 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
alter view "dev"."main"."int_daily_summary" rename to "int_daily_summary__dbt_backup"
[0m19:03:44.976711 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
alter view "dev"."main"."int_hourly_patterns" rename to "int_hourly_patterns__dbt_backup"
[0m19:03:44.977944 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:03:44.978278 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:44.980519 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m19:03:44.982376 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m19:03:44.982712 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
alter view "dev"."main"."int_daily_summary__dbt_tmp" rename to "int_daily_summary"
[0m19:03:44.983146 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
alter view "dev"."main"."int_hourly_patterns__dbt_tmp" rename to "int_hourly_patterns"
[0m19:03:44.984087 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:03:44.984381 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:44.985300 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: COMMIT
[0m19:03:44.985609 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m19:03:44.986352 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: COMMIT
[0m19:03:44.986946 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m19:03:44.987372 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: BEGIN
[0m19:03:44.987710 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m19:03:44.988027 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: COMMIT
[0m19:03:44.988640 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m19:03:44.988857 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: COMMIT
[0m19:03:44.989466 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m19:03:44.990016 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */

  
    
    
      
    

    create  table
      "dev"."main"."fct_trips__dbt_tmp"
  
  (
    trip_id varchar,
    vendor_id integer,
    rate_code_id integer,
    payment_type_id integer,
    pickup_location_id integer,
    dropoff_location_id integer,
    pickup_datetime timestamp,
    dropoff_datetime timestamp,
    pickup_date date,
    pickup_hour bigint,
    pickup_day_of_week varchar,
    is_weekend boolean,
    passenger_count integer,
    trip_distance_miles double,
    trip_duration_minutes bigint,
    avg_speed_mph double,
    cost_per_mile double,
    fare_amount decimal(10,2),
    extra_amount decimal(10,2),
    mta_tax decimal(10,2),
    tip_amount decimal(10,2),
    tip_percentage double,
    tolls_amount decimal(10,2),
    improvement_surcharge decimal(10,2),
    total_amount decimal(10,2),
    congestion_surcharge decimal(10,2),
    airport_fee decimal(10,2),
    pickup_borough varchar,
    pickup_zone varchar,
    dropoff_borough varchar,
    dropoff_zone varchar
    
    )
 ;
    insert into "dev"."main"."fct_trips__dbt_tmp" 
  (
    
      
      trip_id ,
    
      
      vendor_id ,
    
      
      rate_code_id ,
    
      
      payment_type_id ,
    
      
      pickup_location_id ,
    
      
      dropoff_location_id ,
    
      
      pickup_datetime ,
    
      
      dropoff_datetime ,
    
      
      pickup_date ,
    
      
      pickup_hour ,
    
      
      pickup_day_of_week ,
    
      
      is_weekend ,
    
      
      passenger_count ,
    
      
      trip_distance_miles ,
    
      
      trip_duration_minutes ,
    
      
      avg_speed_mph ,
    
      
      cost_per_mile ,
    
      
      fare_amount ,
    
      
      extra_amount ,
    
      
      mta_tax ,
    
      
      tip_amount ,
    
      
      tip_percentage ,
    
      
      tolls_amount ,
    
      
      improvement_surcharge ,
    
      
      total_amount ,
    
      
      congestion_surcharge ,
    
      
      airport_fee ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      dropoff_borough ,
    
      
      dropoff_zone 
    
  )
 (
      
    select trip_id, vendor_id, rate_code_id, payment_type_id, pickup_location_id, dropoff_location_id, pickup_datetime, dropoff_datetime, pickup_date, pickup_hour, pickup_day_of_week, is_weekend, passenger_count, trip_distance_miles, trip_duration_minutes, avg_speed_mph, cost_per_mile, fare_amount, extra_amount, mta_tax, tip_amount, tip_percentage, tolls_amount, improvement_surcharge, total_amount, congestion_surcharge, airport_fee, pickup_borough, pickup_zone, dropoff_borough, dropoff_zone
    from (
        /*
    Fact table: Fully enriched trip records with location names.
    Incremental with delete+insert strategy.
*/



with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

pickup_locations as (
    select * from "dev"."main"."dim_locations"
),

dropoff_locations as (
    select * from "dev"."main"."dim_locations"
),

final as (
    select
        t.trip_id,
        t.vendor_id,
        t.rate_code_id,
        t.payment_type_id,
        t.pickup_location_id,
        t.dropoff_location_id,
        t.pickup_datetime,
        t.dropoff_datetime,
        t.pickup_date,
        t.pickup_hour,
        t.pickup_day_of_week,
        t.is_weekend,
        t.passenger_count,
        t.trip_distance_miles,
        t.trip_duration_minutes,
        t.avg_speed_mph,
        t.cost_per_mile,
        t.fare_amount,
        t.extra_amount,
        t.mta_tax,
        t.tip_amount,
        t.tip_percentage,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.congestion_surcharge,
        t.airport_fee,

        -- enriched from dimensions
        pu.borough as pickup_borough,
        pu.zone_name as pickup_zone,
        do_loc.borough as dropoff_borough,
        do_loc.zone_name as dropoff_zone

    from trip_metrics t
    left join pickup_locations pu
        on t.pickup_location_id = pu.location_id
    left join dropoff_locations do_loc
        on t.dropoff_location_id = do_loc.location_id

    
)

select * from final
    ) as model_subq
    );
  
  
  
[0m19:03:44.993884 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:03:44.996682 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m19:03:44.998796 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
drop view if exists "dev"."main"."int_daily_summary__dbt_backup" cascade
[0m19:03:45.004148 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m19:03:45.009042 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m19:03:45.011242 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
drop view if exists "dev"."main"."int_hourly_patterns__dbt_backup" cascade
[0m19:03:45.013690 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m19:03:45.016846 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: Close
[0m19:03:45.018963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84172053-510c-4981-92d2-735fe95c3111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e74694560>]}
[0m19:03:45.020915 [info ] [Thread-1 (]: 65 of 91 OK created sql view model main.int_daily_summary ...................... [[32mOK[0m in 0.12s]
[0m19:03:45.023064 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.int_daily_summary
[0m19:03:45.023402 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m19:03:45.025836 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m19:03:45.026214 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m19:03:45.028183 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: Close
[0m19:03:45.029076 [info ] [Thread-3 (]: 68 of 91 START test dbt_utils_accepted_range_int_daily_summary_total_trips__0 .. [RUN]
[0m19:03:45.031823 [info ] [Thread-1 (]: 69 of 91 START test not_null_int_daily_summary_pickup_date ..................... [RUN]
[0m19:03:45.033994 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84172053-510c-4981-92d2-735fe95c3111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5dcc7d2720>]}
[0m19:03:45.035432 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863)
[0m19:03:45.036607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_daily_summary, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686)
[0m19:03:45.039746 [info ] [Thread-4 (]: 66 of 91 OK created sql view model main.int_hourly_patterns .................... [[32mOK[0m in 0.13s]
[0m19:03:45.041874 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m19:03:45.043826 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m19:03:45.045423 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m19:03:45.050786 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m19:03:45.055246 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m19:03:45.057581 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m19:03:45.062891 [info ] [Thread-4 (]: 70 of 91 START test not_null_int_daily_summary_total_revenue ................... [RUN]
[0m19:03:45.065284 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_hourly_patterns, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50)
[0m19:03:45.067475 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m19:03:45.072261 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m19:03:45.091506 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m19:03:45.092247 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m19:03:45.095332 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m19:03:45.098421 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m19:03:45.099551 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m19:03:45.106123 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m19:03:45.130858 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m19:03:45.132194 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: BEGIN
[0m19:03:45.133496 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:03:45.136988 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m19:03:45.137731 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m19:03:45.140955 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m19:03:45.143488 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: BEGIN
[0m19:03:45.146284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:45.147851 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:03:45.147049 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m19:03:45.145061 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "dev"."main"."int_daily_summary"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m19:03:45.152150 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m19:03:45.153418 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: BEGIN
[0m19:03:45.160620 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_daily_summary"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m19:03:45.161647 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:03:45.163551 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m19:03:45.164084 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m19:03:45.164981 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_daily_summary"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_trips >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m19:03:45.166320 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:03:45.170109 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: ROLLBACK
[0m19:03:45.171340 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686'
[0m19:03:45.171960 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: Close
[0m19:03:45.172869 [info ] [Thread-1 (]: 69 of 91 PASS not_null_int_daily_summary_pickup_date ........................... [[32mPASS[0m in 0.14s]
[0m19:03:45.174050 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m19:03:45.174939 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m19:03:45.176547 [info ] [Thread-1 (]: 71 of 91 START test not_null_int_daily_summary_total_trips ..................... [RUN]
[0m19:03:45.177693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10)
[0m19:03:45.178887 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m19:03:45.185732 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m19:03:45.240031 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m19:03:45.244896 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m19:03:45.307482 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m19:03:45.309431 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: BEGIN
[0m19:03:45.310753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:45.313771 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:03:45.319029 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m19:03:45.320365 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_trips
from "dev"."main"."int_daily_summary"
where total_trips is null



  
  
      
    ) dbt_internal_test
[0m19:03:45.431183 [debug] [Thread-4 (]: SQL status: OK in 0.277 seconds
[0m19:03:45.433639 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: ROLLBACK
[0m19:03:45.434766 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50'
[0m19:03:45.435356 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: Close
[0m19:03:45.436824 [info ] [Thread-4 (]: 70 of 91 PASS not_null_int_daily_summary_total_revenue ......................... [[32mPASS[0m in 0.37s]
[0m19:03:45.437641 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m19:03:45.438138 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m19:03:45.438633 [info ] [Thread-4 (]: 72 of 91 START test unique_int_daily_summary_pickup_date ....................... [RUN]
[0m19:03:45.439142 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50, now test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e)
[0m19:03:45.439573 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m19:03:45.442992 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m19:03:45.454954 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m19:03:45.458319 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m19:03:45.468225 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m19:03:45.468901 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: BEGIN
[0m19:03:45.469426 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:03:45.470282 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:45.470838 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m19:03:45.471259 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pickup_date as unique_field,
    count(*) as n_records

from "dev"."main"."int_daily_summary"
where pickup_date is not null
group by pickup_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:03:45.564330 [debug] [Thread-1 (]: SQL status: OK in 0.243 seconds
[0m19:03:45.566241 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: ROLLBACK
[0m19:03:45.567218 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10'
[0m19:03:45.567735 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: Close
[0m19:03:45.568471 [info ] [Thread-1 (]: 71 of 91 PASS not_null_int_daily_summary_total_trips ........................... [[32mPASS[0m in 0.39s]
[0m19:03:45.569155 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m19:03:45.569722 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m19:03:45.570185 [info ] [Thread-1 (]: 73 of 91 START test dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0  [RUN]
[0m19:03:45.570754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe)
[0m19:03:45.571388 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m19:03:45.575505 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m19:03:45.577673 [debug] [Thread-3 (]: SQL status: OK in 0.410 seconds
[0m19:03:45.579781 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: ROLLBACK
[0m19:03:45.580727 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863'
[0m19:03:45.581249 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: Close
[0m19:03:45.582055 [info ] [Thread-3 (]: 68 of 91 PASS dbt_utils_accepted_range_int_daily_summary_total_trips__0 ........ [[32mPASS[0m in 0.55s]
[0m19:03:45.582836 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m19:03:45.583362 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m19:03:45.583912 [info ] [Thread-3 (]: 74 of 91 START test not_null_int_hourly_patterns_pickup_date ................... [RUN]
[0m19:03:45.584603 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2)
[0m19:03:45.585261 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m19:03:45.590357 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m19:03:45.591020 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m19:03:45.593566 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m19:03:45.600384 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m19:03:45.602920 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m19:03:45.604306 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m19:03:45.604985 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: BEGIN
[0m19:03:45.605512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:45.606381 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:03:45.606949 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m19:03:45.607480 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_hourly_patterns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m19:03:45.608012 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m19:03:45.608857 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: BEGIN
[0m19:03:45.609344 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:03:45.610174 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:03:45.610776 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m19:03:45.611313 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_hourly_patterns"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m19:03:45.613903 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m19:03:45.616010 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: ROLLBACK
[0m19:03:45.617558 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2'
[0m19:03:45.618210 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: Close
[0m19:03:45.619124 [info ] [Thread-3 (]: 74 of 91 PASS not_null_int_hourly_patterns_pickup_date ......................... [[32mPASS[0m in 0.03s]
[0m19:03:45.619677 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m19:03:45.620199 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m19:03:45.620749 [info ] [Thread-3 (]: 75 of 91 START test not_null_int_hourly_patterns_pickup_hour ................... [RUN]
[0m19:03:45.621400 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d)
[0m19:03:45.622068 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m19:03:45.625240 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m19:03:45.627486 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m19:03:45.628888 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: ROLLBACK
[0m19:03:45.629691 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe'
[0m19:03:45.630172 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: Close
[0m19:03:45.631228 [info ] [Thread-1 (]: 73 of 91 PASS dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0 .. [[32mPASS[0m in 0.06s]
[0m19:03:45.632041 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m19:03:45.633144 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m19:03:45.634371 [info ] [Thread-1 (]: 76 of 91 START test not_null_int_hourly_patterns_total_trips ................... [RUN]
[0m19:03:45.635205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf)
[0m19:03:45.635846 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m19:03:45.640150 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m19:03:45.640567 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m19:03:45.642629 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m19:03:45.649748 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m19:03:45.652305 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m19:03:45.653691 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m19:03:45.654268 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: BEGIN
[0m19:03:45.654732 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:03:45.655787 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:03:45.656414 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m19:03:45.656793 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."int_hourly_patterns"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m19:03:45.657520 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m19:03:45.658035 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: BEGIN
[0m19:03:45.658385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:45.659030 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:03:45.659467 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m19:03:45.659904 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m19:03:45.661534 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: ROLLBACK
[0m19:03:45.662018 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_trips
from "dev"."main"."int_hourly_patterns"
where total_trips is null



  
  
      
    ) dbt_internal_test
[0m19:03:45.662803 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d'
[0m19:03:45.663742 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: Close
[0m19:03:45.664536 [info ] [Thread-3 (]: 75 of 91 PASS not_null_int_hourly_patterns_pickup_hour ......................... [[32mPASS[0m in 0.04s]
[0m19:03:45.665121 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m19:03:45.665422 [debug] [Thread-4 (]: SQL status: OK in 0.194 seconds
[0m19:03:45.667154 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: ROLLBACK
[0m19:03:45.668005 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e'
[0m19:03:45.668425 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: Close
[0m19:03:45.669254 [info ] [Thread-4 (]: 72 of 91 PASS unique_int_daily_summary_pickup_date ............................. [[32mPASS[0m in 0.23s]
[0m19:03:45.669984 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m19:03:45.670852 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m19:03:45.671547 [info ] [Thread-3 (]: 77 of 91 START sql table model main.mart_daily_revenue ......................... [RUN]
[0m19:03:45.672338 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d, now model.nyc_taxi_pipeline_00.mart_daily_revenue)
[0m19:03:45.672916 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m19:03:45.677633 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m19:03:45.688573 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m19:03:45.692645 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m19:03:45.693517 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Daily revenue metrics with running totals.
*/

with daily as (
    select * from "dev"."main"."int_daily_summary"
),

dates as (
    select * from "dev"."main"."dim_dates"
),

final as (
    select
        d.date_key,
        d.day_of_week_name,
        d.is_weekend,
        d.is_holiday,
        d.week_of_year,

        daily.total_trips,
        daily.total_passengers,
        daily.total_fare_revenue,
        daily.total_tip_revenue,
        daily.total_revenue,
        daily.avg_trip_revenue,
        daily.avg_tip_percentage,
        daily.credit_card_trips,
        daily.cash_trips,
        daily.avg_trip_distance,
        daily.avg_trip_duration_min,

        -- running total
        sum(daily.total_revenue) over (order by d.date_key) as cumulative_revenue,

        -- day-over-day change
        daily.total_revenue - lag(daily.total_revenue) over (order by d.date_key) as revenue_change_vs_prior_day

    from daily
    inner join dates d
        on daily.pickup_date = d.date_key
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m19:03:45.694190 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:03:45.697312 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m19:03:45.701212 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m19:03:45.701855 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as date_key, 
      
    cast(null as varchar)
 as day_of_week_name, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as boolean)
 as is_holiday, 
      
    cast(null as bigint)
 as week_of_year, 
      
    cast(null as bigint)
 as total_trips, 
      
    cast(null as hugeint)
 as total_passengers, 
      
    cast(null as decimal(38,2))
 as total_fare_revenue, 
      
    cast(null as decimal(38,2))
 as total_tip_revenue, 
      
    cast(null as decimal(38,2))
 as total_revenue, 
      
    cast(null as double)
 as avg_trip_revenue, 
      
    cast(null as double)
 as avg_tip_percentage, 
      
    cast(null as bigint)
 as credit_card_trips, 
      
    cast(null as bigint)
 as cash_trips, 
      
    cast(null as double)
 as avg_trip_distance, 
      
    cast(null as double)
 as avg_trip_duration_min, 
      
    cast(null as decimal(38,2))
 as cumulative_revenue, 
      
    cast(null as decimal(38,2))
 as revenue_change_vs_prior_day
    ) as __dbt_sbq
    where false
    limit 0
)
[0m19:03:45.702959 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:03:45.705615 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m19:03:45.713862 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m19:03:45.714370 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: BEGIN
[0m19:03:45.715120 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m19:03:45.715822 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m19:03:45.716373 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_daily_revenue__dbt_tmp"
  
  (
    date_key date,
    day_of_week_name varchar,
    is_weekend boolean,
    is_holiday boolean,
    week_of_year bigint,
    total_trips bigint,
    total_passengers hugeint,
    total_fare_revenue decimal(38,2),
    total_tip_revenue decimal(38,2),
    total_revenue decimal(38,2),
    avg_trip_revenue double,
    avg_tip_percentage double,
    credit_card_trips bigint,
    cash_trips bigint,
    avg_trip_distance double,
    avg_trip_duration_min double,
    cumulative_revenue decimal(38,2),
    revenue_change_vs_prior_day decimal(38,2)
    
    )
 ;
    insert into "dev"."main"."mart_daily_revenue__dbt_tmp" 
  (
    
      
      date_key ,
    
      
      day_of_week_name ,
    
      
      is_weekend ,
    
      
      is_holiday ,
    
      
      week_of_year ,
    
      
      total_trips ,
    
      
      total_passengers ,
    
      
      total_fare_revenue ,
    
      
      total_tip_revenue ,
    
      
      total_revenue ,
    
      
      avg_trip_revenue ,
    
      
      avg_tip_percentage ,
    
      
      credit_card_trips ,
    
      
      cash_trips ,
    
      
      avg_trip_distance ,
    
      
      avg_trip_duration_min ,
    
      
      cumulative_revenue ,
    
      
      revenue_change_vs_prior_day 
    
  )
 (
      
    select date_key, day_of_week_name, is_weekend, is_holiday, week_of_year, total_trips, total_passengers, total_fare_revenue, total_tip_revenue, total_revenue, avg_trip_revenue, avg_tip_percentage, credit_card_trips, cash_trips, avg_trip_distance, avg_trip_duration_min, cumulative_revenue, revenue_change_vs_prior_day
    from (
        /*
    Analytics mart: Daily revenue metrics with running totals.
*/

with daily as (
    select * from "dev"."main"."int_daily_summary"
),

dates as (
    select * from "dev"."main"."dim_dates"
),

final as (
    select
        d.date_key,
        d.day_of_week_name,
        d.is_weekend,
        d.is_holiday,
        d.week_of_year,

        daily.total_trips,
        daily.total_passengers,
        daily.total_fare_revenue,
        daily.total_tip_revenue,
        daily.total_revenue,
        daily.avg_trip_revenue,
        daily.avg_tip_percentage,
        daily.credit_card_trips,
        daily.cash_trips,
        daily.avg_trip_distance,
        daily.avg_trip_duration_min,

        -- running total
        sum(daily.total_revenue) over (order by d.date_key) as cumulative_revenue,

        -- day-over-day change
        daily.total_revenue - lag(daily.total_revenue) over (order by d.date_key) as revenue_change_vs_prior_day

    from daily
    inner join dates d
        on daily.pickup_date = d.date_key
)

select * from final
    ) as model_subq
    );
  
  
[0m19:03:45.801901 [debug] [Thread-1 (]: SQL status: OK in 0.138 seconds
[0m19:03:45.803556 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: ROLLBACK
[0m19:03:45.804341 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf'
[0m19:03:45.804842 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: Close
[0m19:03:45.805508 [info ] [Thread-1 (]: 76 of 91 PASS not_null_int_hourly_patterns_total_trips ......................... [[32mPASS[0m in 0.17s]
[0m19:03:45.806212 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m19:03:45.807072 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m19:03:45.807682 [info ] [Thread-4 (]: 78 of 91 START sql table model main.mart_hourly_demand ......................... [RUN]
[0m19:03:45.808212 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e, now model.nyc_taxi_pipeline_00.mart_hourly_demand)
[0m19:03:45.808614 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m19:03:45.811061 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m19:03:45.819599 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m19:03:45.823468 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m19:03:45.824299 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Hourly demand patterns.
*/

with hourly as (
    select * from "dev"."main"."int_hourly_patterns"
),

final as (
    select
        pickup_hour,
        is_weekend,

        count(*) as days_observed,
        round(avg(total_trips), 0) as avg_trips_per_period,
        round(avg(avg_distance), 2) as avg_distance,
        round(avg(avg_duration_min), 2) as avg_duration_min,
        round(avg(total_revenue), 2) as avg_revenue_per_period,
        sum(total_trips) as total_trips_all_days

    from hourly
    group by pickup_hour, is_weekend
)

select * from final
order by is_weekend, pickup_hour
    ) as __dbt_sbq
    where false
    limit 0
)
[0m19:03:45.825014 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:03:45.827821 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m19:03:45.830156 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m19:03:45.831507 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as bigint)
 as pickup_hour, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as bigint)
 as days_observed, 
      
    cast(null as double)
 as avg_trips_per_period, 
      
    cast(null as double)
 as avg_distance, 
      
    cast(null as double)
 as avg_duration_min, 
      
    cast(null as double)
 as avg_revenue_per_period, 
      
    cast(null as hugeint)
 as total_trips_all_days
    ) as __dbt_sbq
    where false
    limit 0
)
[0m19:03:45.832916 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:45.834933 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m19:03:45.845401 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m19:03:45.846256 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: BEGIN
[0m19:03:45.847145 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m19:03:45.847664 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m19:03:45.848262 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_hourly_demand__dbt_tmp"
  
  (
    pickup_hour bigint,
    is_weekend boolean,
    days_observed bigint,
    avg_trips_per_period double,
    avg_distance double,
    avg_duration_min double,
    avg_revenue_per_period double,
    total_trips_all_days hugeint
    
    )
 ;
    insert into "dev"."main"."mart_hourly_demand__dbt_tmp" 
  (
    
      
      pickup_hour ,
    
      
      is_weekend ,
    
      
      days_observed ,
    
      
      avg_trips_per_period ,
    
      
      avg_distance ,
    
      
      avg_duration_min ,
    
      
      avg_revenue_per_period ,
    
      
      total_trips_all_days 
    
  )
 (
      
    select pickup_hour, is_weekend, days_observed, avg_trips_per_period, avg_distance, avg_duration_min, avg_revenue_per_period, total_trips_all_days
    from (
        /*
    Analytics mart: Hourly demand patterns.
*/

with hourly as (
    select * from "dev"."main"."int_hourly_patterns"
),

final as (
    select
        pickup_hour,
        is_weekend,

        count(*) as days_observed,
        round(avg(total_trips), 0) as avg_trips_per_period,
        round(avg(avg_distance), 2) as avg_distance,
        round(avg(avg_duration_min), 2) as avg_duration_min,
        round(avg(total_revenue), 2) as avg_revenue_per_period,
        sum(total_trips) as total_trips_all_days

    from hourly
    group by pickup_hour, is_weekend
)

select * from final
order by is_weekend, pickup_hour
    ) as model_subq
    );
  
  
[0m19:03:45.937796 [debug] [Thread-3 (]: SQL status: OK in 0.221 seconds
[0m19:03:45.941255 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m19:03:45.941985 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
alter table "dev"."main"."mart_daily_revenue" rename to "mart_daily_revenue__dbt_backup"
[0m19:03:45.943101 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:03:45.945931 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m19:03:45.946591 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
alter table "dev"."main"."mart_daily_revenue__dbt_tmp" rename to "mart_daily_revenue"
[0m19:03:45.947614 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m19:03:45.948938 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: COMMIT
[0m19:03:45.949381 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m19:03:45.949813 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: COMMIT
[0m19:03:45.954951 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m19:03:45.957954 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m19:03:45.958510 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
drop table if exists "dev"."main"."mart_daily_revenue__dbt_backup" cascade
[0m19:03:45.962677 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m19:03:45.964248 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: Close
[0m19:03:45.965014 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84172053-510c-4981-92d2-735fe95c3111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e746fdd00>]}
[0m19:03:45.965763 [info ] [Thread-3 (]: 77 of 91 OK created sql table model main.mart_daily_revenue .................... [[32mOK[0m in 0.29s]
[0m19:03:45.966545 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m19:03:45.967501 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m19:03:45.968010 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m19:03:45.968523 [info ] [Thread-1 (]: 79 of 91 START test not_null_mart_daily_revenue_date_key ....................... [RUN]
[0m19:03:45.969173 [info ] [Thread-3 (]: 80 of 91 START test not_null_mart_daily_revenue_total_revenue .................. [RUN]
[0m19:03:45.969865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf, now test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a)
[0m19:03:45.970400 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.mart_daily_revenue, now test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9)
[0m19:03:45.970881 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m19:03:45.971484 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m19:03:45.976186 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m19:03:45.979113 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m19:03:45.986154 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m19:03:45.988551 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m19:03:45.989046 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m19:03:45.991064 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m19:03:45.995620 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m19:03:45.996428 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: BEGIN
[0m19:03:45.996863 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m19:03:45.997204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:45.997913 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: BEGIN
[0m19:03:45.998853 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:03:45.999155 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:03:45.999763 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:03:46.000045 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m19:03:46.000671 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m19:03:46.001200 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "dev"."main"."mart_daily_revenue"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m19:03:46.001672 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "dev"."main"."mart_daily_revenue"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m19:03:46.003127 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:03:46.003441 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:03:46.004976 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: ROLLBACK
[0m19:03:46.006280 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: ROLLBACK
[0m19:03:46.007023 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a'
[0m19:03:46.007817 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9'
[0m19:03:46.008276 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: Close
[0m19:03:46.008735 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: Close
[0m19:03:46.009595 [info ] [Thread-1 (]: 79 of 91 PASS not_null_mart_daily_revenue_date_key ............................. [[32mPASS[0m in 0.04s]
[0m19:03:46.010189 [info ] [Thread-3 (]: 80 of 91 PASS not_null_mart_daily_revenue_total_revenue ........................ [[32mPASS[0m in 0.04s]
[0m19:03:46.010653 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m19:03:46.011437 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m19:03:46.012003 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m19:03:46.012857 [info ] [Thread-1 (]: 81 of 91 START test unique_mart_daily_revenue_date_key ......................... [RUN]
[0m19:03:46.013448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a, now test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7)
[0m19:03:46.013978 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m19:03:46.017124 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m19:03:46.023123 [debug] [Thread-4 (]: SQL status: OK in 0.174 seconds
[0m19:03:46.025792 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m19:03:46.026193 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
alter table "dev"."main"."mart_hourly_demand" rename to "mart_hourly_demand__dbt_backup"
[0m19:03:46.027513 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:46.029788 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m19:03:46.030239 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m19:03:46.030510 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
alter table "dev"."main"."mart_hourly_demand__dbt_tmp" rename to "mart_hourly_demand"
[0m19:03:46.032258 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m19:03:46.033117 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m19:03:46.034207 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: COMMIT
[0m19:03:46.034570 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m19:03:46.034864 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: COMMIT
[0m19:03:46.038171 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m19:03:46.039914 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m19:03:46.040267 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
drop table if exists "dev"."main"."mart_hourly_demand__dbt_backup" cascade
[0m19:03:46.041782 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m19:03:46.042139 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: BEGIN
[0m19:03:46.042534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:46.042854 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m19:03:46.043417 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:03:46.044456 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: Close
[0m19:03:46.044896 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m19:03:46.045734 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84172053-510c-4981-92d2-735fe95c3111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5dcc834f50>]}
[0m19:03:46.046021 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "dev"."main"."mart_daily_revenue"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:03:46.046615 [info ] [Thread-4 (]: 78 of 91 OK created sql table model main.mart_hourly_demand .................... [[32mOK[0m in 0.24s]
[0m19:03:46.047567 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m19:03:46.048003 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:03:46.048598 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m19:03:46.048970 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m19:03:46.050235 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: ROLLBACK
[0m19:03:46.050759 [info ] [Thread-3 (]: 82 of 91 START test not_null_mart_hourly_demand_is_weekend ..................... [RUN]
[0m19:03:46.051342 [info ] [Thread-4 (]: 83 of 91 START test not_null_mart_hourly_demand_pickup_hour .................... [RUN]
[0m19:03:46.052316 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7'
[0m19:03:46.052759 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9, now test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8)
[0m19:03:46.053372 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.mart_hourly_demand, now test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418)
[0m19:03:46.053974 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: Close
[0m19:03:46.054523 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m19:03:46.055033 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m19:03:46.055755 [info ] [Thread-1 (]: 81 of 91 PASS unique_mart_daily_revenue_date_key ............................... [[32mPASS[0m in 0.04s]
[0m19:03:46.060701 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m19:03:46.063775 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m19:03:46.064533 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m19:03:46.070584 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m19:03:46.072667 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m19:03:46.072984 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m19:03:46.074897 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m19:03:46.079159 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m19:03:46.079850 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: BEGIN
[0m19:03:46.080314 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:03:46.081631 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:46.082092 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m19:03:46.082396 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m19:03:46.082674 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."mart_hourly_demand"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m19:03:46.083113 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: BEGIN
[0m19:03:46.083867 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:03:46.084424 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:46.084688 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:03:46.085868 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: ROLLBACK
[0m19:03:46.086144 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m19:03:46.086872 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418'
[0m19:03:46.087238 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."mart_hourly_demand"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m19:03:46.087623 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: Close
[0m19:03:46.088517 [info ] [Thread-4 (]: 83 of 91 PASS not_null_mart_hourly_demand_pickup_hour .......................... [[32mPASS[0m in 0.04s]
[0m19:03:46.088852 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:03:46.089190 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m19:03:46.090510 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: ROLLBACK
[0m19:03:46.091659 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8'
[0m19:03:46.092217 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: Close
[0m19:03:46.092885 [info ] [Thread-3 (]: 82 of 91 PASS not_null_mart_hourly_demand_is_weekend ........................... [[32mPASS[0m in 0.04s]
[0m19:03:46.093444 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m19:03:50.011312 [debug] [Thread-2 (]: SQL status: OK in 5.020 seconds
[0m19:03:50.016402 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m19:03:50.017377 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
alter table "dev"."main"."fct_trips" rename to "fct_trips__dbt_backup"
[0m19:03:50.022261 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m19:03:50.026021 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m19:03:50.026743 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
alter table "dev"."main"."fct_trips__dbt_tmp" rename to "fct_trips"
[0m19:03:50.028328 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:03:50.030210 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: COMMIT
[0m19:03:50.031064 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m19:03:50.031594 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: COMMIT
[0m19:03:50.440575 [debug] [Thread-2 (]: SQL status: OK in 0.408 seconds
[0m19:03:50.443138 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m19:03:50.443799 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
drop table if exists "dev"."main"."fct_trips__dbt_backup" cascade
[0m19:03:50.780799 [debug] [Thread-2 (]: SQL status: OK in 0.336 seconds
[0m19:03:50.782182 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: Close
[0m19:03:50.843366 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84172053-510c-4981-92d2-735fe95c3111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e74a40e30>]}
[0m19:03:50.844443 [info ] [Thread-2 (]: 67 of 91 OK created sql incremental model main.fct_trips ....................... [[32mOK[0m in 5.94s]
[0m19:03:50.845028 [debug] [Thread-2 (]: Finished running node model.nyc_taxi_pipeline_00.fct_trips
[0m19:03:50.846011 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m19:03:50.846465 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m19:03:50.846816 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m19:03:50.847125 [info ] [Thread-1 (]: 84 of 91 START test not_null_fct_trips_pickup_datetime ......................... [RUN]
[0m19:03:50.847502 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m19:03:50.847792 [info ] [Thread-4 (]: 85 of 91 START test not_null_fct_trips_total_amount ............................ [RUN]
[0m19:03:50.848300 [info ] [Thread-3 (]: 86 of 91 START test not_null_fct_trips_trip_id ................................. [RUN]
[0m19:03:50.848965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7, now test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83)
[0m19:03:50.849438 [info ] [Thread-2 (]: 87 of 91 START test unique_fct_trips_trip_id ................................... [RUN]
[0m19:03:50.849926 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418, now test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d)
[0m19:03:50.850411 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8, now test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d)
[0m19:03:50.850907 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m19:03:50.851416 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.fct_trips, now test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab)
[0m19:03:50.851843 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m19:03:50.852290 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m19:03:50.855542 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m19:03:50.855997 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m19:03:50.858485 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m19:03:50.862254 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m19:03:50.865264 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m19:03:50.870270 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m19:03:50.872517 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m19:03:50.872837 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m19:03:50.873290 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m19:03:50.874516 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m19:03:50.876258 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m19:03:50.876640 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m19:03:50.878510 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m19:03:50.881752 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m19:03:50.882255 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m19:03:50.882531 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: BEGIN
[0m19:03:50.883041 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: BEGIN
[0m19:03:50.883364 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m19:03:50.883573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:50.883885 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m19:03:50.884187 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:03:50.884648 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: BEGIN
[0m19:03:50.885333 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: BEGIN
[0m19:03:50.885843 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:03:50.886211 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:03:50.905390 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m19:03:50.905894 [debug] [Thread-2 (]: SQL status: OK in 0.022 seconds
[0m19:03:50.906183 [debug] [Thread-3 (]: SQL status: OK in 0.020 seconds
[0m19:03:50.906439 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m19:03:50.906704 [debug] [Thread-4 (]: SQL status: OK in 0.020 seconds
[0m19:03:50.907123 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m19:03:50.907516 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m19:03:50.907933 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "dev"."main"."fct_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m19:03:50.908349 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m19:03:50.908722 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."main"."fct_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:03:50.909131 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."fct_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m19:03:50.910002 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."fct_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m19:03:50.910697 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:03:50.911641 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:03:50.912149 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:50.916349 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: ROLLBACK
[0m19:03:50.918551 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: ROLLBACK
[0m19:03:50.921513 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: ROLLBACK
[0m19:03:50.923458 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83'
[0m19:03:50.927574 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d'
[0m19:03:50.930944 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d'
[0m19:03:50.933009 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: Close
[0m19:03:50.935916 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: Close
[0m19:03:50.938044 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: Close
[0m19:03:50.940303 [info ] [Thread-1 (]: 84 of 91 PASS not_null_fct_trips_pickup_datetime ............................... [[32mPASS[0m in 0.09s]
[0m19:03:50.942803 [info ] [Thread-3 (]: 86 of 91 PASS not_null_fct_trips_trip_id ....................................... [[32mPASS[0m in 0.09s]
[0m19:03:50.945625 [info ] [Thread-4 (]: 85 of 91 PASS not_null_fct_trips_total_amount .................................. [[32mPASS[0m in 0.10s]
[0m19:03:50.949984 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m19:03:50.952155 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m19:03:50.954601 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m19:03:51.043284 [debug] [Thread-2 (]: SQL status: OK in 0.133 seconds
[0m19:03:51.045047 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: ROLLBACK
[0m19:03:51.045876 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab'
[0m19:03:51.046321 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: Close
[0m19:03:51.071684 [info ] [Thread-2 (]: 87 of 91 PASS unique_fct_trips_trip_id ......................................... [[32mPASS[0m in 0.22s]
[0m19:03:51.072420 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m19:03:51.073470 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.mart_location_performance
[0m19:03:51.073932 [info ] [Thread-1 (]: 88 of 91 START sql table model main.mart_location_performance .................. [RUN]
[0m19:03:51.074523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83, now model.nyc_taxi_pipeline_00.mart_location_performance)
[0m19:03:51.074910 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_location_performance
[0m19:03:51.078215 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m19:03:51.085658 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.mart_location_performance
[0m19:03:51.088505 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m19:03:51.089171 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Location-level performance summary.
    Uses adapter-dispatched mode_compat() for cross-dialect support.
*/

with trips as (
    select * from "dev"."main"."fct_trips"
),

final as (
    select
        pickup_location_id,
        pickup_borough,
        pickup_zone,

        count(*) as total_pickups,
        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue_per_trip,
        round(avg(tip_percentage), 2) as avg_tip_pct,
        round(avg(passenger_count), 2) as avg_passengers,

        -- most common dropoff destination
        
    mode(dropoff_zone)
 as most_common_dropoff_zone,

        -- busiest hour
        
    mode(pickup_hour)
 as peak_pickup_hour

    from trips
    where pickup_zone is not null
    group by pickup_location_id, pickup_borough, pickup_zone
)

select * from final
order by total_pickups desc
    ) as __dbt_sbq
    where false
    limit 0
)
[0m19:03:51.089675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:51.107107 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m19:03:51.109178 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m19:03:51.109653 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as varchar)
 as pickup_borough, 
      
    cast(null as varchar)
 as pickup_zone, 
      
    cast(null as bigint)
 as total_pickups, 
      
    cast(null as double)
 as avg_trip_distance, 
      
    cast(null as double)
 as avg_trip_duration_min, 
      
    cast(null as decimal(38,2))
 as total_revenue, 
      
    cast(null as double)
 as avg_revenue_per_trip, 
      
    cast(null as double)
 as avg_tip_pct, 
      
    cast(null as double)
 as avg_passengers, 
      
    cast(null as varchar)
 as most_common_dropoff_zone, 
      
    cast(null as bigint)
 as peak_pickup_hour
    ) as __dbt_sbq
    where false
    limit 0
)
[0m19:03:51.110565 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:03:51.112209 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m19:03:51.118794 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m19:03:51.119283 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: BEGIN
[0m19:03:51.120025 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:03:51.120346 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m19:03:51.120690 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_location_performance__dbt_tmp"
  
  (
    pickup_location_id integer,
    pickup_borough varchar,
    pickup_zone varchar,
    total_pickups bigint,
    avg_trip_distance double,
    avg_trip_duration_min double,
    total_revenue decimal(38,2),
    avg_revenue_per_trip double,
    avg_tip_pct double,
    avg_passengers double,
    most_common_dropoff_zone varchar,
    peak_pickup_hour bigint
    
    )
 ;
    insert into "dev"."main"."mart_location_performance__dbt_tmp" 
  (
    
      
      pickup_location_id ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      total_pickups ,
    
      
      avg_trip_distance ,
    
      
      avg_trip_duration_min ,
    
      
      total_revenue ,
    
      
      avg_revenue_per_trip ,
    
      
      avg_tip_pct ,
    
      
      avg_passengers ,
    
      
      most_common_dropoff_zone ,
    
      
      peak_pickup_hour 
    
  )
 (
      
    select pickup_location_id, pickup_borough, pickup_zone, total_pickups, avg_trip_distance, avg_trip_duration_min, total_revenue, avg_revenue_per_trip, avg_tip_pct, avg_passengers, most_common_dropoff_zone, peak_pickup_hour
    from (
        /*
    Analytics mart: Location-level performance summary.
    Uses adapter-dispatched mode_compat() for cross-dialect support.
*/

with trips as (
    select * from "dev"."main"."fct_trips"
),

final as (
    select
        pickup_location_id,
        pickup_borough,
        pickup_zone,

        count(*) as total_pickups,
        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue_per_trip,
        round(avg(tip_percentage), 2) as avg_tip_pct,
        round(avg(passenger_count), 2) as avg_passengers,

        -- most common dropoff destination
        
    mode(dropoff_zone)
 as most_common_dropoff_zone,

        -- busiest hour
        
    mode(pickup_hour)
 as peak_pickup_hour

    from trips
    where pickup_zone is not null
    group by pickup_location_id, pickup_borough, pickup_zone
)

select * from final
order by total_pickups desc
    ) as model_subq
    );
  
  
[0m19:03:51.217140 [debug] [Thread-1 (]: SQL status: OK in 0.096 seconds
[0m19:03:51.219497 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m19:03:51.219866 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
alter table "dev"."main"."mart_location_performance" rename to "mart_location_performance__dbt_backup"
[0m19:03:51.220600 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:03:51.223208 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m19:03:51.223561 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
alter table "dev"."main"."mart_location_performance__dbt_tmp" rename to "mart_location_performance"
[0m19:03:51.224286 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:03:51.225152 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: COMMIT
[0m19:03:51.225594 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m19:03:51.225915 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: COMMIT
[0m19:03:51.231591 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:03:51.233742 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m19:03:51.234195 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
drop table if exists "dev"."main"."mart_location_performance__dbt_backup" cascade
[0m19:03:51.237868 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:03:51.239308 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: Close
[0m19:03:51.293290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84172053-510c-4981-92d2-735fe95c3111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e5c1c8dd0>]}
[0m19:03:51.294226 [info ] [Thread-1 (]: 88 of 91 OK created sql table model main.mart_location_performance ............. [[32mOK[0m in 0.22s]
[0m19:03:51.294797 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.mart_location_performance
[0m19:03:51.295580 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m19:03:51.295877 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m19:03:51.296128 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m19:03:51.296380 [info ] [Thread-4 (]: 89 of 91 START test not_null_mart_location_performance_pickup_location_id ...... [RUN]
[0m19:03:51.296829 [info ] [Thread-2 (]: 90 of 91 START test not_null_mart_location_performance_total_pickups ........... [RUN]
[0m19:03:51.297321 [info ] [Thread-3 (]: 91 of 91 START test unique_mart_location_performance_pickup_location_id ........ [RUN]
[0m19:03:51.297847 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d, now test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c)
[0m19:03:51.298344 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab, now test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259)
[0m19:03:51.298891 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d, now test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62)
[0m19:03:51.299366 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m19:03:51.299928 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m19:03:51.300398 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m19:03:51.303725 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m19:03:51.307046 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m19:03:51.310536 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m19:03:51.316253 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m19:03:51.316706 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m19:03:51.318625 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m19:03:51.320381 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m19:03:51.320725 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m19:03:51.322840 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m19:03:51.325817 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m19:03:51.326223 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m19:03:51.326549 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: BEGIN
[0m19:03:51.326997 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: BEGIN
[0m19:03:51.327476 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:03:51.327982 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m19:03:51.328265 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:03:51.328832 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: BEGIN
[0m19:03:51.329360 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:03:51.347724 [debug] [Thread-4 (]: SQL status: OK in 0.020 seconds
[0m19:03:51.348117 [debug] [Thread-3 (]: SQL status: OK in 0.020 seconds
[0m19:03:51.348421 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m19:03:51.348661 [debug] [Thread-2 (]: SQL status: OK in 0.019 seconds
[0m19:03:51.349055 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m19:03:51.349453 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_location_id
from "dev"."main"."mart_location_performance"
where pickup_location_id is null



  
  
      
    ) dbt_internal_test
[0m19:03:51.349810 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m19:03:51.350271 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pickup_location_id as unique_field,
    count(*) as n_records

from "dev"."main"."mart_location_performance"
where pickup_location_id is not null
group by pickup_location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:03:51.350915 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_pickups
from "dev"."main"."mart_location_performance"
where total_pickups is null



  
  
      
    ) dbt_internal_test
[0m19:03:51.351227 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:03:51.353046 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: ROLLBACK
[0m19:03:51.353373 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m19:03:51.353623 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m19:03:51.354238 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c'
[0m19:03:51.355404 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: ROLLBACK
[0m19:03:51.356639 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: ROLLBACK
[0m19:03:51.356939 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: Close
[0m19:03:51.357775 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62'
[0m19:03:51.358439 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259'
[0m19:03:51.358971 [info ] [Thread-4 (]: 89 of 91 PASS not_null_mart_location_performance_pickup_location_id ............ [[32mPASS[0m in 0.06s]
[0m19:03:51.359307 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: Close
[0m19:03:51.359917 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: Close
[0m19:03:51.360562 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m19:03:51.361300 [info ] [Thread-3 (]: 91 of 91 PASS unique_mart_location_performance_pickup_location_id .............. [[32mPASS[0m in 0.06s]
[0m19:03:51.362297 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m19:03:51.364363 [info ] [Thread-2 (]: 90 of 91 PASS not_null_mart_location_performance_total_pickups ................. [[32mPASS[0m in 0.07s]
[0m19:03:51.365000 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m19:03:51.366849 [debug] [MainThread]: Using duckdb connection "master"
[0m19:03:51.367296 [debug] [MainThread]: On master: BEGIN
[0m19:03:51.367809 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:03:51.385955 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m19:03:51.386590 [debug] [MainThread]: On master: COMMIT
[0m19:03:51.386982 [debug] [MainThread]: Using duckdb connection "master"
[0m19:03:51.387269 [debug] [MainThread]: On master: COMMIT
[0m19:03:51.387924 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:03:51.388267 [debug] [MainThread]: On master: Close
[0m19:03:51.392751 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:03:51.393344 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m19:03:51.393739 [debug] [MainThread]: Connection 'model.nyc_taxi_pipeline_00.mart_location_performance' was properly closed.
[0m19:03:51.394124 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259' was properly closed.
[0m19:03:51.394602 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62' was properly closed.
[0m19:03:51.395025 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c' was properly closed.
[0m19:03:51.395595 [info ] [MainThread]: 
[0m19:03:51.395991 [info ] [MainThread]: Finished running 1 incremental model, 3 seeds, 7 table models, 74 data tests, 6 view models in 0 hours 0 minutes and 9.78 seconds (9.78s).
[0m19:03:51.401406 [debug] [MainThread]: Command end result
[0m19:03:51.443337 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m19:03:51.448529 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m19:03:51.461337 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m19:03:51.461991 [info ] [MainThread]: 
[0m19:03:51.462468 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:03:51.462835 [info ] [MainThread]: 
[0m19:03:51.463260 [info ] [MainThread]: Done. PASS=91 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=91
[0m19:03:51.464759 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 11.101833, "process_in_blocks": "1592", "process_kernel_time": 5.033756, "process_mem_max_rss": "1721588", "process_out_blocks": "136", "process_user_time": 23.227573}
[0m19:03:51.465288 [debug] [MainThread]: Command `dbt build` succeeded at 19:03:51.465197 after 11.10 seconds
[0m19:03:51.465736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ea87c3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ea86a7cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e74776780>]}
[0m19:03:51.466125 [debug] [MainThread]: Flushing usage events
[0m19:03:51.699319 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:55:48.326180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7016e2e1eff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7016e51799d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7016e42e53a0>]}


============================== 14:55:48.330475 | 167be9ac-9d28-48db-86da-e75ac405fdd9 ==============================
[0m14:55:48.330475 [info ] [MainThread]: Running with dbt=1.11.4
[0m14:55:48.331051 [debug] [MainThread]: running dbt with arguments {'log_path': '/dbt/logs', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir .', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'introspect': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'profiles_dir': '.', 'quiet': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'empty': 'None', 'version_check': 'True', 'printer_width': '80', 'write_json': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error': 'None', 'use_experimental_parser': 'False', 'debug': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m14:55:48.406207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '167be9ac-9d28-48db-86da-e75ac405fdd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7016e2e1e180>]}
[0m14:55:48.734678 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_q12b5us'
[0m14:55:48.735215 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:55:49.081067 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:55:49.082748 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:55:49.226792 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:55:49.230276 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:55:52.488832 [info ] [MainThread]: Installed from version 1.3.3
[0m14:55:52.489352 [info ] [MainThread]: Up to date!
[0m14:55:52.489872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '167be9ac-9d28-48db-86da-e75ac405fdd9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7016e2d5fb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7016e2d5fe90>]}
[0m14:55:52.490981 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.254366, "process_in_blocks": "65808", "process_kernel_time": 0.34338, "process_mem_max_rss": "105260", "process_out_blocks": "176", "process_user_time": 0.961466}
[0m14:55:52.491514 [debug] [MainThread]: Command `dbt deps` succeeded at 14:55:52.491394 after 4.25 seconds
[0m14:55:52.491815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7016e3c20860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7016e3c200b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7016e2ba4710>]}
[0m14:55:52.492109 [debug] [MainThread]: Flushing usage events
[0m14:55:52.787486 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:55:53.837910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762103d9ff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762103c7c8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7621035b10d0>]}


============================== 14:55:53.840688 | cb7f1911-2dd1-446e-af23-d570d9616a98 ==============================
[0m14:55:53.840688 [info ] [MainThread]: Running with dbt=1.11.4
[0m14:55:53.841215 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'target_path': 'None', 'use_colors': 'True', 'empty': 'False', 'version_check': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'log_path': '/dbt/logs', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'quiet': 'False', 'invocation_command': 'dbt build --full-refresh --profiles-dir .', 'log_format': 'default', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'printer_width': '80'}
[0m14:55:54.048050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb7f1911-2dd1-446e-af23-d570d9616a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762102dac080>]}
[0m14:55:54.084501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb7f1911-2dd1-446e-af23-d570d9616a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762102df8bc0>]}
[0m14:55:54.087291 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:55:54.144083 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m14:55:54.834233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:55:54.834683 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m14:55:54.834982 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:55:54.866942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb7f1911-2dd1-446e-af23-d570d9616a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7620f32ae600>]}
[0m14:55:54.959886 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:55:54.967540 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:55:55.020460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb7f1911-2dd1-446e-af23-d570d9616a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7620f32ad910>]}
[0m14:55:55.021020 [info ] [MainThread]: Found 14 models, 74 data tests, 3 seeds, 1 source, 578 macros
[0m14:55:55.025515 [info ] [MainThread]: 
[0m14:55:55.025971 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:55:55.026559 [info ] [MainThread]: 
[0m14:55:55.027234 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:55:55.030655 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m14:55:55.104524 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m14:55:55.105605 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m14:55:55.106500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:55.144454 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m14:55:55.145686 [debug] [ThreadPool]: On list_dev: Close
[0m14:55:55.149588 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m14:55:55.150018 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m14:55:55.153677 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:55:55.154175 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m14:55:55.154490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:55.168859 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m14:55:55.170007 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:55:55.170391 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m14:55:55.170839 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:55:55.171175 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:55:55.171434 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m14:55:55.171808 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:55:55.172453 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:55:55.172755 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:55:55.173083 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:55:55.173492 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:55:55.173790 [debug] [ThreadPool]: On create_dev_main: Close
[0m14:55:55.177263 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m14:55:55.180658 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:55:55.181141 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:55:55.181446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:55.197934 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m14:55:55.198489 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:55:55.199056 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:55:55.207177 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m14:55:55.208599 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:55:55.209866 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:55:55.210247 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:55:55.214118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb7f1911-2dd1-446e-af23-d570d9616a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762102dacb60>]}
[0m14:55:55.214700 [debug] [MainThread]: Using duckdb connection "master"
[0m14:55:55.215156 [debug] [MainThread]: On master: BEGIN
[0m14:55:55.215398 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:55:55.234820 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m14:55:55.235483 [debug] [MainThread]: On master: COMMIT
[0m14:55:55.235861 [debug] [MainThread]: Using duckdb connection "master"
[0m14:55:55.236182 [debug] [MainThread]: On master: COMMIT
[0m14:55:55.236721 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:55:55.237226 [debug] [MainThread]: On master: Close
[0m14:55:55.243648 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.dim_dates
[0m14:55:55.243973 [debug] [Thread-2 (]: Began running node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m14:55:55.244243 [debug] [Thread-3 (]: Began running node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m14:55:55.244575 [info ] [Thread-1 (]: 1 of 91 START sql table model main.dim_dates ................................... [RUN]
[0m14:55:55.244832 [debug] [Thread-4 (]: Began running node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m14:55:55.245094 [info ] [Thread-2 (]: 2 of 91 START sql table model main.stg_yellow_trips ............................ [RUN]
[0m14:55:55.245520 [info ] [Thread-3 (]: 3 of 91 START seed file main.payment_type_lookup ............................... [RUN]
[0m14:55:55.246106 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nyc_taxi_pipeline_00.dim_dates'
[0m14:55:55.246559 [info ] [Thread-4 (]: 4 of 91 START seed file main.rate_code_lookup .................................. [RUN]
[0m14:55:55.247209 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.nyc_taxi_pipeline_00.stg_yellow_trips'
[0m14:55:55.247573 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.nyc_taxi_pipeline_00.payment_type_lookup'
[0m14:55:55.247875 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_dates
[0m14:55:55.248202 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.nyc_taxi_pipeline_00.rate_code_lookup'
[0m14:55:55.248537 [debug] [Thread-2 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m14:55:55.248879 [debug] [Thread-3 (]: Began compiling node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m14:55:55.259730 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:55:55.260309 [debug] [Thread-4 (]: Began compiling node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m14:55:55.269570 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m14:55:55.269903 [debug] [Thread-3 (]: Began executing node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m14:55:55.270390 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: BEGIN
[0m14:55:55.270895 [debug] [Thread-4 (]: Began executing node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m14:55:55.279707 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:55:55.289489 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m14:55:55.289950 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.payment_type_lookup"} */
drop table if exists "dev"."main"."payment_type_lookup" cascade
[0m14:55:55.290547 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:55:55.292233 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m14:55:55.292636 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.rate_code_lookup"} */
drop table if exists "dev"."main"."rate_code_lookup" cascade
[0m14:55:55.293114 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:55:55.293525 [debug] [Thread-2 (]: Began executing node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m14:55:55.307501 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m14:55:55.309700 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m14:55:55.309972 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:55:55.310503 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */


        select 
        (date_diff('day', cast('2024-01-01' as date)::timestamp, cast('2024-02-01' as date)::timestamp ))
    
[0m14:55:55.313563 [debug] [Thread-3 (]: SQL status: OK in 0.023 seconds
[0m14:55:55.317776 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m14:55:55.318146 [debug] [Thread-4 (]: SQL status: OK in 0.025 seconds
[0m14:55:55.318392 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m14:55:55.318617 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: BEGIN
[0m14:55:55.319555 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m14:55:55.327396 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:55:55.327749 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: BEGIN
[0m14:55:55.327980 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:55:55.328862 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m14:55:55.329136 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:55:55.329354 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.payment_type_lookup"} */

    create table "dev"."main"."payment_type_lookup" ("payment_type_id" integer,"payment_type_name" varchar)
  
[0m14:55:55.329661 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m14:55:55.329936 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m14:55:55.330389 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: BEGIN
[0m14:55:55.330749 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.330962 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.rate_code_lookup"} */

    create table "dev"."main"."rate_code_lookup" ("rate_code_id" integer,"rate_code_name" varchar)
  
[0m14:55:55.331271 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:55:55.337038 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m14:55:55.337771 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:55:55.337988 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: 
          COPY "dev"."main"."payment_type_lookup" FROM '/dbt/seeds/payment_type_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m14:55:55.338167 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m14:55:55.339486 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m14:55:55.340792 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m14:55:55.341305 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: 
          COPY "dev"."main"."rate_code_lookup" FROM '/dbt/seeds/rate_code_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m14:55:55.341676 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */

  
    
    

    create  table
      "dev"."main"."stg_yellow_trips__dbt_tmp"
  
    as (
      

with source as (
    select * from read_parquet('/data/yellow_tripdata_2024-01.parquet')
),

renamed as (
    select
        -- surrogate key (MD5 hash of composite key)
        md5(cast(coalesce(cast(VendorID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(PULocationID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DOLocationID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(fare_amount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(total_amount as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- identifiers
        cast("VendorID" as integer) as vendor_id,
        cast("RatecodeID" as integer) as rate_code_id,
        cast("PULocationID" as integer) as pickup_location_id,
        cast("DOLocationID" as integer) as dropoff_location_id,
        cast(payment_type as integer) as payment_type_id,

        -- timestamps
        cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
        cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as double) as trip_distance_miles,
        store_and_fwd_flag,

        -- financials
        round(cast(fare_amount as decimal(10, 2)), 2) as fare_amount,
        round(cast(extra as decimal(10, 2)), 2) as extra_amount,
        round(cast(mta_tax as decimal(10, 2)), 2) as mta_tax,
        round(cast(tip_amount as decimal(10, 2)), 2) as tip_amount,
        round(cast(tolls_amount as decimal(10, 2)), 2) as tolls_amount,
        round(cast(improvement_surcharge as decimal(10, 2)), 2) as improvement_surcharge,
        round(cast(total_amount as decimal(10, 2)), 2) as total_amount,
        round(cast(congestion_surcharge as decimal(10, 2)), 2) as congestion_surcharge,
        round(cast(Airport_fee as decimal(10, 2)), 2) as airport_fee

    from source
    where tpep_pickup_datetime is not null
      and tpep_dropoff_datetime is not null
      and trip_distance >= 0
      and fare_amount >= 0
      -- filter out-of-range dates (data quality: ~18 trips outside Jan 2024)
      and cast(tpep_pickup_datetime as date) >= date '2024-01-01'
      and cast(tpep_pickup_datetime as date) < date '2024-02-01'
)

select * from renamed
    );
  
  
[0m14:55:55.342915 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.dim_dates
[0m14:55:55.355670 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:55:55.356105 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m14:55:55.356385 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
DESCRIBE (select * from (
        /*
    Dimension table: Calendar dates for January 2024.
    Uses adapter-dispatched macros for dayname/monthname.
*/

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 31
    order by generated_number



),

all_periods as (

    select (
        

    date_add(cast('2024-01-01' as date), interval (row_number() over (order by generated_number) - 1) day)


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-02-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week_num,
        
    dayname(date_day)
 as day_of_week_name,
        
    monthname(date_day)
 as month_name,
        extract(week from date_day) as week_of_year,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when cast(date_day as date) in (
                cast('2024-01-01' as date),
                cast('2024-01-15' as date)
            ) then true
            else false
        end as is_holiday

    from date_spine
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:55:55.356682 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m14:55:55.359604 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m14:55:55.361912 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m14:55:55.363460 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:55:55.371408 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:55:55.372335 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as date_key, 
      
    cast(null as bigint)
 as year, 
      
    cast(null as bigint)
 as month, 
      
    cast(null as bigint)
 as day_of_month, 
      
    cast(null as bigint)
 as day_of_week_num, 
      
    cast(null as varchar)
 as day_of_week_name, 
      
    cast(null as varchar)
 as month_name, 
      
    cast(null as bigint)
 as week_of_year, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as boolean)
 as is_holiday
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:55:55.373458 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:55.385459 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:55:55.394759 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: COMMIT
[0m14:55:55.395728 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: COMMIT
[0m14:55:55.396002 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m14:55:55.396387 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m14:55:55.396814 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: COMMIT
[0m14:55:55.397173 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: COMMIT
[0m14:55:55.400506 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:55:55.401798 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: Close
[0m14:55:55.403207 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m14:55:55.403666 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb7f1911-2dd1-446e-af23-d570d9616a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7620f3257500>]}
[0m14:55:55.404202 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: Close
[0m14:55:55.404756 [info ] [Thread-3 (]: 3 of 91 OK loaded seed file main.payment_type_lookup ........................... [[32mCREATE 6[0m in 0.15s]
[0m14:55:55.405021 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:55:55.406081 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb7f1911-2dd1-446e-af23-d570d9616a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762092ef1af0>]}
[0m14:55:55.406427 [debug] [Thread-3 (]: Finished running node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m14:55:55.407096 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_dates__dbt_tmp"
  
  (
    date_key date,
    year bigint,
    month bigint,
    day_of_month bigint,
    day_of_week_num bigint,
    day_of_week_name varchar,
    month_name varchar,
    week_of_year bigint,
    is_weekend boolean,
    is_holiday boolean
    
    )
 ;
    insert into "dev"."main"."dim_dates__dbt_tmp" 
  (
    
      
      date_key ,
    
      
      year ,
    
      
      month ,
    
      
      day_of_month ,
    
      
      day_of_week_num ,
    
      
      day_of_week_name ,
    
      
      month_name ,
    
      
      week_of_year ,
    
      
      is_weekend ,
    
      
      is_holiday 
    
  )
 (
      
    select date_key, year, month, day_of_month, day_of_week_num, day_of_week_name, month_name, week_of_year, is_weekend, is_holiday
    from (
        /*
    Dimension table: Calendar dates for January 2024.
    Uses adapter-dispatched macros for dayname/monthname.
*/

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 31
    order by generated_number



),

all_periods as (

    select (
        

    date_add(cast('2024-01-01' as date), interval (row_number() over (order by generated_number) - 1) day)


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-02-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week_num,
        
    dayname(date_day)
 as day_of_week_name,
        
    monthname(date_day)
 as month_name,
        extract(week from date_day) as week_of_year,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when cast(date_day as date) in (
                cast('2024-01-01' as date),
                cast('2024-01-15' as date)
            ) then true
            else false
        end as is_holiday

    from date_spine
)

select * from final
    ) as model_subq
    );
  
  
[0m14:55:55.407710 [info ] [Thread-4 (]: 4 of 91 OK loaded seed file main.rate_code_lookup .............................. [[32mCREATE 7[0m in 0.16s]
[0m14:55:55.408139 [debug] [Thread-3 (]: Began running node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m14:55:55.409718 [debug] [Thread-4 (]: Finished running node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m14:55:55.410187 [info ] [Thread-3 (]: 5 of 91 START seed file main.taxi_zone_lookup .................................. [RUN]
[0m14:55:55.410948 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m14:55:55.411379 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.payment_type_lookup, now seed.nyc_taxi_pipeline_00.taxi_zone_lookup)
[0m14:55:55.411829 [info ] [Thread-4 (]: 6 of 91 START test not_null_payment_type_lookup_payment_type_id ................ [RUN]
[0m14:55:55.412593 [debug] [Thread-3 (]: Began compiling node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m14:55:55.413077 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.rate_code_lookup, now test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521)
[0m14:55:55.413915 [debug] [Thread-3 (]: Began executing node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m14:55:55.414255 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m14:55:55.422950 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m14:55:55.424030 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m14:55:55.427633 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:55:55.428217 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
alter table "dev"."main"."dim_dates" rename to "dim_dates__dbt_backup"
[0m14:55:55.428943 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:55.430945 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:55:55.432323 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m14:55:55.432607 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
alter table "dev"."main"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m14:55:55.433037 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"} */
drop table if exists "dev"."main"."taxi_zone_lookup" cascade
[0m14:55:55.433755 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:55.434008 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.435369 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: COMMIT
[0m14:55:55.435927 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:55:55.436230 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: COMMIT
[0m14:55:55.436457 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:55:55.437672 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m14:55:55.437918 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: BEGIN
[0m14:55:55.438404 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:55:55.439589 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m14:55:55.439987 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"} */

    create table "dev"."main"."taxi_zone_lookup" ("LocationID" integer,"Borough" varchar,"Zone" varchar,"service_zone" varchar)
  
[0m14:55:55.440358 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m14:55:55.440842 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:55:55.441161 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.450041 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m14:55:55.451586 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:55:55.452752 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m14:55:55.453713 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
drop table if exists "dev"."main"."dim_dates__dbt_backup" cascade
[0m14:55:55.454062 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: 
          COPY "dev"."main"."taxi_zone_lookup" FROM '/dbt/seeds/taxi_zone_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m14:55:55.457871 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:55:55.458973 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: Close
[0m14:55:55.459708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb7f1911-2dd1-446e-af23-d570d9616a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76209323fe30>]}
[0m14:55:55.460242 [info ] [Thread-1 (]: 1 of 91 OK created sql table model main.dim_dates .............................. [[32mOK[0m in 0.21s]
[0m14:55:55.460972 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.dim_dates
[0m14:55:55.461545 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m14:55:55.461878 [info ] [Thread-1 (]: 7 of 91 START test unique_payment_type_lookup_payment_type_id .................. [RUN]
[0m14:55:55.462308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_dates, now test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7)
[0m14:55:55.462688 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m14:55:55.462949 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m14:55:55.463485 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m14:55:55.467470 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m14:55:55.469421 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m14:55:55.469999 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: BEGIN
[0m14:55:55.470424 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:55:55.471423 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.472273 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m14:55:55.472672 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."payment_type_lookup"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m14:55:55.474248 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.477318 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: ROLLBACK
[0m14:55:55.478304 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521'
[0m14:55:55.478899 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: Close
[0m14:55:55.479510 [info ] [Thread-4 (]: 6 of 91 PASS not_null_payment_type_lookup_payment_type_id ...................... [[32mPASS[0m in 0.07s]
[0m14:55:55.480765 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: COMMIT
[0m14:55:55.481220 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m14:55:55.481787 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m14:55:55.482227 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m14:55:55.482948 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: COMMIT
[0m14:55:55.483503 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m14:55:55.483771 [info ] [Thread-4 (]: 8 of 91 START test not_null_rate_code_lookup_rate_code_id ...................... [RUN]
[0m14:55:55.486484 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m14:55:55.487066 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521, now test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec)
[0m14:55:55.487697 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m14:55:55.487956 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:55:55.491250 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m14:55:55.492135 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: Close
[0m14:55:55.493113 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb7f1911-2dd1-446e-af23-d570d9616a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762092ed9b20>]}
[0m14:55:55.493628 [info ] [Thread-3 (]: 5 of 91 OK loaded seed file main.taxi_zone_lookup .............................. [[32mCREATE 265[0m in 0.08s]
[0m14:55:55.494126 [debug] [Thread-3 (]: Finished running node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m14:55:55.494549 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m14:55:55.495041 [info ] [Thread-3 (]: 9 of 91 START test unique_rate_code_lookup_rate_code_id ........................ [RUN]
[0m14:55:55.495418 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.taxi_zone_lookup, now test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d)
[0m14:55:55.495778 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m14:55:55.498492 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m14:55:55.503290 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m14:55:55.503714 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: BEGIN
[0m14:55:55.504108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:55.504634 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m14:55:55.505721 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:55:55.507501 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m14:55:55.508161 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m14:55:55.509171 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."payment_type_lookup"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:55:55.509445 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m14:55:55.511812 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m14:55:55.512253 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:55:55.513681 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: ROLLBACK
[0m14:55:55.514412 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7'
[0m14:55:55.514919 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: Close
[0m14:55:55.515494 [info ] [Thread-1 (]: 7 of 91 PASS unique_payment_type_lookup_payment_type_id ........................ [[32mPASS[0m in 0.05s]
[0m14:55:55.516104 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m14:55:55.516606 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m14:55:55.517034 [info ] [Thread-1 (]: 10 of 91 START test not_null_dim_dates_date_key ................................ [RUN]
[0m14:55:55.517511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7, now test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348)
[0m14:55:55.517946 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m14:55:55.521265 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m14:55:55.522875 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m14:55:55.523309 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m14:55:55.523657 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: BEGIN
[0m14:55:55.524186 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: BEGIN
[0m14:55:55.524737 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:55.525271 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:55:55.526062 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.526700 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.526986 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m14:55:55.527391 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m14:55:55.527738 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rate_code_id as unique_field,
    count(*) as n_records

from "dev"."main"."rate_code_lookup"
where rate_code_id is not null
group by rate_code_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:55:55.528174 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_id
from "dev"."main"."rate_code_lookup"
where rate_code_id is null



  
  
      
    ) dbt_internal_test
[0m14:55:55.529512 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.529836 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.531195 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: ROLLBACK
[0m14:55:55.532217 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: ROLLBACK
[0m14:55:55.532737 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d'
[0m14:55:55.533502 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec'
[0m14:55:55.534026 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: Close
[0m14:55:55.534409 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: Close
[0m14:55:55.535049 [info ] [Thread-3 (]: 9 of 91 PASS unique_rate_code_lookup_rate_code_id .............................. [[32mPASS[0m in 0.04s]
[0m14:55:55.535520 [info ] [Thread-4 (]: 8 of 91 PASS not_null_rate_code_lookup_rate_code_id ............................ [[32mPASS[0m in 0.05s]
[0m14:55:55.535853 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m14:55:55.536398 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m14:55:55.536967 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m14:55:55.537686 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m14:55:55.538019 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m14:55:55.539048 [info ] [Thread-3 (]: 11 of 91 START test not_null_dim_dates_day_of_week_name ........................ [RUN]
[0m14:55:55.539494 [info ] [Thread-4 (]: 12 of 91 START test not_null_dim_dates_is_holiday .............................. [RUN]
[0m14:55:55.542007 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m14:55:55.542968 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d, now test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541)
[0m14:55:55.543522 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec, now test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a)
[0m14:55:55.544442 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m14:55:55.544911 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m14:55:55.548419 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m14:55:55.550984 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m14:55:55.561606 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m14:55:55.562124 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m14:55:55.563934 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m14:55:55.564315 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m14:55:55.564803 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: BEGIN
[0m14:55:55.566552 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m14:55:55.567376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:55.569209 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:55:55.569635 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m14:55:55.570062 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "dev"."main"."dim_dates"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m14:55:55.571231 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.572976 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: ROLLBACK
[0m14:55:55.573812 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348'
[0m14:55:55.574709 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: Close
[0m14:55:55.575462 [info ] [Thread-1 (]: 10 of 91 PASS not_null_dim_dates_date_key ...................................... [[32mPASS[0m in 0.06s]
[0m14:55:55.576056 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m14:55:55.576637 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m14:55:55.577071 [info ] [Thread-1 (]: 13 of 91 START test not_null_dim_dates_is_weekend .............................. [RUN]
[0m14:55:55.577546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348, now test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0)
[0m14:55:55.578252 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m14:55:55.581409 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m14:55:55.581731 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m14:55:55.582181 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m14:55:55.582422 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: BEGIN
[0m14:55:55.582916 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: BEGIN
[0m14:55:55.583654 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:55.584225 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:55:55.585253 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:55:55.585770 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:55:55.586098 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m14:55:55.586577 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m14:55:55.587026 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select day_of_week_name
from "dev"."main"."dim_dates"
where day_of_week_name is null



  
  
      
    ) dbt_internal_test
[0m14:55:55.587696 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_holiday
from "dev"."main"."dim_dates"
where is_holiday is null



  
  
      
    ) dbt_internal_test
[0m14:55:55.588840 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.589092 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.590273 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: ROLLBACK
[0m14:55:55.591259 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: ROLLBACK
[0m14:55:55.592013 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541'
[0m14:55:55.592625 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a'
[0m14:55:55.592993 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: Close
[0m14:55:55.593433 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: Close
[0m14:55:55.594048 [info ] [Thread-3 (]: 11 of 91 PASS not_null_dim_dates_day_of_week_name .............................. [[32mPASS[0m in 0.05s]
[0m14:55:55.594416 [info ] [Thread-4 (]: 12 of 91 PASS not_null_dim_dates_is_holiday .................................... [[32mPASS[0m in 0.05s]
[0m14:55:55.594899 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m14:55:55.595408 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m14:55:55.596162 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m14:55:55.596803 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m14:55:55.597423 [info ] [Thread-3 (]: 14 of 91 START test unique_dim_dates_date_key .................................. [RUN]
[0m14:55:55.597845 [info ] [Thread-4 (]: 15 of 91 START test not_null_taxi_zone_lookup_Borough .......................... [RUN]
[0m14:55:55.598556 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541, now test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d)
[0m14:55:55.599517 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a, now test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa)
[0m14:55:55.600072 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m14:55:55.600555 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m14:55:55.603361 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m14:55:55.603799 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m14:55:55.605922 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m14:55:55.609231 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m14:55:55.620762 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m14:55:55.621496 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m14:55:55.623126 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m14:55:55.624965 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m14:55:55.625786 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m14:55:55.626278 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: BEGIN
[0m14:55:55.626635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:55.627418 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.627787 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m14:55:55.628173 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."dim_dates"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m14:55:55.629369 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.630713 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: ROLLBACK
[0m14:55:55.631391 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0'
[0m14:55:55.631661 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: Close
[0m14:55:55.632440 [info ] [Thread-1 (]: 13 of 91 PASS not_null_dim_dates_is_weekend .................................... [[32mPASS[0m in 0.05s]
[0m14:55:55.633187 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m14:55:55.633984 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m14:55:55.634428 [info ] [Thread-1 (]: 16 of 91 START test not_null_taxi_zone_lookup_LocationID ....................... [RUN]
[0m14:55:55.634950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0, now test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a)
[0m14:55:55.635587 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m14:55:55.638649 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m14:55:55.641050 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m14:55:55.641502 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m14:55:55.641852 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: BEGIN
[0m14:55:55.642326 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: BEGIN
[0m14:55:55.642890 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:55:55.643309 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:55.644218 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.644479 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.644720 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m14:55:55.645108 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m14:55:55.645411 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Borough
from "dev"."main"."taxi_zone_lookup"
where Borough is null



  
  
      
    ) dbt_internal_test
[0m14:55:55.646316 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "dev"."main"."dim_dates"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:55:55.647703 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.648088 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.649421 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: ROLLBACK
[0m14:55:55.650312 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: ROLLBACK
[0m14:55:55.651154 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa'
[0m14:55:55.651758 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d'
[0m14:55:55.652121 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: Close
[0m14:55:55.652582 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: Close
[0m14:55:55.653193 [info ] [Thread-4 (]: 15 of 91 PASS not_null_taxi_zone_lookup_Borough ................................ [[32mPASS[0m in 0.05s]
[0m14:55:55.653591 [info ] [Thread-3 (]: 14 of 91 PASS unique_dim_dates_date_key ........................................ [[32mPASS[0m in 0.06s]
[0m14:55:55.653953 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m14:55:55.654299 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m14:55:55.654805 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m14:55:55.657182 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m14:55:55.657774 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m14:55:55.658261 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.stg_payment_types
[0m14:55:55.658907 [info ] [Thread-4 (]: 17 of 91 START test unique_taxi_zone_lookup_LocationID ......................... [RUN]
[0m14:55:55.659541 [info ] [Thread-3 (]: 18 of 91 START sql view model main.stg_payment_types ........................... [RUN]
[0m14:55:55.660209 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa, now test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8)
[0m14:55:55.660596 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d, now model.nyc_taxi_pipeline_00.stg_payment_types)
[0m14:55:55.660970 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m14:55:55.661373 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_payment_types
[0m14:55:55.664042 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m14:55:55.666000 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m14:55:55.674426 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m14:55:55.675257 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: BEGIN
[0m14:55:55.675764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:55.676592 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.677024 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m14:55:55.677345 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select LocationID
from "dev"."main"."taxi_zone_lookup"
where LocationID is null



  
  
      
    ) dbt_internal_test
[0m14:55:55.677633 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.stg_payment_types
[0m14:55:55.684035 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m14:55:55.690998 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m14:55:55.691456 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m14:55:55.691948 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m14:55:55.693827 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: ROLLBACK
[0m14:55:55.694530 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a'
[0m14:55:55.694995 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: Close
[0m14:55:55.695776 [info ] [Thread-1 (]: 16 of 91 PASS not_null_taxi_zone_lookup_LocationID ............................. [[32mPASS[0m in 0.06s]
[0m14:55:55.696333 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m14:55:55.696726 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m14:55:55.697432 [info ] [Thread-1 (]: 19 of 91 START sql view model main.stg_rate_codes .............................. [RUN]
[0m14:55:55.698029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a, now model.nyc_taxi_pipeline_00.stg_rate_codes)
[0m14:55:55.698474 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m14:55:55.701414 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m14:55:55.707321 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m14:55:55.707773 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m14:55:55.708205 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: BEGIN
[0m14:55:55.708695 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: BEGIN
[0m14:55:55.709199 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:55.709687 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:55:55.710722 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.711453 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:55:55.711697 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m14:55:55.712153 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m14:55:55.712570 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */

  
  create view "dev"."main"."stg_payment_types__dbt_tmp" as (
    /*
    Staging model: Payment type lookup
    Maps payment_type_id to human-readable names.
*/

with source as (
    select * from "dev"."main"."payment_type_lookup"
),

renamed as (
    select
        payment_type_id,
        payment_type_name
    from source
)

select * from renamed
  );

[0m14:55:55.713045 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    LocationID as unique_field,
    count(*) as n_records

from "dev"."main"."taxi_zone_lookup"
where LocationID is not null
group by LocationID
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:55:55.714045 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.716528 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m14:55:55.716799 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:55:55.717008 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
alter view "dev"."main"."stg_payment_types" rename to "stg_payment_types__dbt_backup"
[0m14:55:55.718248 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: ROLLBACK
[0m14:55:55.718659 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m14:55:55.718973 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:55:55.719716 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8'
[0m14:55:55.721786 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m14:55:55.724146 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m14:55:55.724721 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: Close
[0m14:55:55.725478 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
alter view "dev"."main"."stg_payment_types__dbt_tmp" rename to "stg_payment_types"
[0m14:55:55.726264 [info ] [Thread-4 (]: 17 of 91 PASS unique_taxi_zone_lookup_LocationID ............................... [[32mPASS[0m in 0.07s]
[0m14:55:55.726963 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:55:55.727340 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m14:55:55.728374 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: COMMIT
[0m14:55:55.729169 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m14:55:55.729546 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m14:55:55.729753 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: COMMIT
[0m14:55:55.730224 [info ] [Thread-4 (]: 20 of 91 START sql view model main.stg_taxi_zones .............................. [RUN]
[0m14:55:55.731238 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8, now model.nyc_taxi_pipeline_00.stg_taxi_zones)
[0m14:55:55.731652 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m14:55:55.733933 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m14:55:55.734819 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m14:55:55.736172 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m14:55:55.736535 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
drop view if exists "dev"."main"."stg_payment_types__dbt_backup" cascade
[0m14:55:55.738406 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m14:55:55.738802 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: BEGIN
[0m14:55:55.739236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:55.739605 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:55:55.741385 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: Close
[0m14:55:55.741698 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:55:55.742291 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb7f1911-2dd1-446e-af23-d570d9616a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76209015d310>]}
[0m14:55:55.742682 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m14:55:55.743356 [info ] [Thread-3 (]: 18 of 91 OK created sql view model main.stg_payment_types ...................... [[32mOK[0m in 0.08s]
[0m14:55:55.743940 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */

  
  create view "dev"."main"."stg_rate_codes__dbt_tmp" as (
    /*
    Staging model: Rate code lookup
    Maps rate_code_id to human-readable names.
*/

with source as (
    select * from "dev"."main"."rate_code_lookup"
),

renamed as (
    select
        rate_code_id,
        rate_code_name
    from source
)

select * from renamed
  );

[0m14:55:55.744710 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.stg_payment_types
[0m14:55:55.746203 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.746941 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m14:55:55.749162 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m14:55:55.749820 [info ] [Thread-3 (]: 21 of 91 START test not_null_stg_payment_types_payment_type_id ................. [RUN]
[0m14:55:55.750340 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
alter view "dev"."main"."stg_rate_codes" rename to "stg_rate_codes__dbt_backup"
[0m14:55:55.750725 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m14:55:55.751085 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_payment_types, now test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78)
[0m14:55:55.753908 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m14:55:55.754349 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:55:55.754948 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m14:55:55.758571 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m14:55:55.762413 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m14:55:55.763233 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
alter view "dev"."main"."stg_rate_codes__dbt_tmp" rename to "stg_rate_codes"
[0m14:55:55.764668 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.765887 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: COMMIT
[0m14:55:55.766362 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m14:55:55.766757 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: COMMIT
[0m14:55:55.769877 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:55:55.772571 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m14:55:55.773040 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m14:55:55.773444 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
drop view if exists "dev"."main"."stg_rate_codes__dbt_backup" cascade
[0m14:55:55.774543 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: BEGIN
[0m14:55:55.775448 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:55:55.776064 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.776504 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m14:55:55.776894 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */

  
  create view "dev"."main"."stg_taxi_zones__dbt_tmp" as (
    /*
    Staging model: Taxi zone lookup
    Maps LocationID to borough and zone name.
*/

with source as (
    select * from "dev"."main"."taxi_zone_lookup"
),

renamed as (
    select
        cast("LocationID" as integer) as location_id,
        "Borough" as borough,
        "Zone" as zone_name,
        service_zone
    from source
)

select * from renamed
  );

[0m14:55:55.778006 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:55:55.778375 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.779356 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: Close
[0m14:55:55.781527 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m14:55:55.781779 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m14:55:55.782505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb7f1911-2dd1-446e-af23-d570d9616a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762080144dd0>]}
[0m14:55:55.783194 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
alter view "dev"."main"."stg_taxi_zones" rename to "stg_taxi_zones__dbt_backup"
[0m14:55:55.784643 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m14:55:55.785425 [info ] [Thread-1 (]: 19 of 91 OK created sql view model main.stg_rate_codes ......................... [[32mOK[0m in 0.08s]
[0m14:55:55.786647 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.786968 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m14:55:55.789170 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m14:55:55.790102 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m14:55:55.790748 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
alter view "dev"."main"."stg_taxi_zones__dbt_tmp" rename to "stg_taxi_zones"
[0m14:55:55.791196 [info ] [Thread-1 (]: 22 of 91 START test not_null_stg_payment_types_payment_type_name ............... [RUN]
[0m14:55:55.792131 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.792544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_rate_codes, now test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39)
[0m14:55:55.793597 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: COMMIT
[0m14:55:55.793966 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m14:55:55.794420 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m14:55:55.797142 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m14:55:55.797628 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: COMMIT
[0m14:55:55.802225 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:55:55.803907 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m14:55:55.804321 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
drop view if exists "dev"."main"."stg_taxi_zones__dbt_backup" cascade
[0m14:55:55.807262 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m14:55:55.807882 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: BEGIN
[0m14:55:55.808356 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:55:55.808739 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:55.810234 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: Close
[0m14:55:55.811042 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:55:55.811591 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb7f1911-2dd1-446e-af23-d570d9616a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762093261f40>]}
[0m14:55:55.811834 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m14:55:55.812506 [info ] [Thread-4 (]: 20 of 91 OK created sql view model main.stg_taxi_zones ......................... [[32mOK[0m in 0.08s]
[0m14:55:55.812894 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m14:55:55.813384 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."stg_payment_types"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m14:55:55.814020 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m14:55:55.815717 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m14:55:55.816488 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m14:55:55.816980 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.817541 [info ] [Thread-4 (]: 23 of 91 START test unique_stg_payment_types_payment_type_id ................... [RUN]
[0m14:55:55.818763 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: ROLLBACK
[0m14:55:55.819103 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_taxi_zones, now test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534)
[0m14:55:55.819822 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78'
[0m14:55:55.820335 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m14:55:55.820776 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: Close
[0m14:55:55.823263 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m14:55:55.824263 [info ] [Thread-3 (]: 21 of 91 PASS not_null_stg_payment_types_payment_type_id ....................... [[32mPASS[0m in 0.07s]
[0m14:55:55.824999 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m14:55:55.825446 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m14:55:55.825864 [info ] [Thread-3 (]: 24 of 91 START test not_null_stg_rate_codes_rate_code_id ....................... [RUN]
[0m14:55:55.826291 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78, now test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a)
[0m14:55:55.826713 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m14:55:55.829177 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m14:55:55.833161 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m14:55:55.833962 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: BEGIN
[0m14:55:55.834568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:55.835498 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.835861 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m14:55:55.836173 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_name
from "dev"."main"."stg_payment_types"
where payment_type_name is null



  
  
      
    ) dbt_internal_test
[0m14:55:55.837062 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.838212 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: ROLLBACK
[0m14:55:55.839393 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39'
[0m14:55:55.839976 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: Close
[0m14:55:55.840738 [info ] [Thread-1 (]: 22 of 91 PASS not_null_stg_payment_types_payment_type_name ..................... [[32mPASS[0m in 0.05s]
[0m14:55:55.841253 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m14:55:55.841534 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m14:55:55.841851 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m14:55:55.844875 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m14:55:55.845271 [info ] [Thread-1 (]: 25 of 91 START test not_null_stg_rate_codes_rate_code_name ..................... [RUN]
[0m14:55:55.845820 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m14:55:55.846189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39, now test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f)
[0m14:55:55.847566 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m14:55:55.848028 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m14:55:55.850474 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m14:55:55.858968 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m14:55:55.859529 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: BEGIN
[0m14:55:55.859838 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m14:55:55.860075 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:55.860518 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: BEGIN
[0m14:55:55.861277 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:55:55.861533 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.861993 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m14:55:55.862376 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.862652 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m14:55:55.864645 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m14:55:55.865200 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m14:55:55.865624 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_id
from "dev"."main"."stg_rate_codes"
where rate_code_id is null



  
  
      
    ) dbt_internal_test
[0m14:55:55.866231 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_payment_types"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:55:55.867393 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.867691 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.868777 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: ROLLBACK
[0m14:55:55.869677 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: ROLLBACK
[0m14:55:55.870280 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a'
[0m14:55:55.870855 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534'
[0m14:55:55.871166 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: Close
[0m14:55:55.871454 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: Close
[0m14:55:55.871925 [info ] [Thread-3 (]: 24 of 91 PASS not_null_stg_rate_codes_rate_code_id ............................. [[32mPASS[0m in 0.05s]
[0m14:55:55.872510 [info ] [Thread-4 (]: 23 of 91 PASS unique_stg_payment_types_payment_type_id ......................... [[32mPASS[0m in 0.05s]
[0m14:55:55.872843 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m14:55:55.873582 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m14:55:55.874248 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m14:55:55.874795 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m14:55:55.875508 [info ] [Thread-3 (]: 26 of 91 START test unique_stg_rate_codes_rate_code_id ......................... [RUN]
[0m14:55:55.875888 [info ] [Thread-4 (]: 27 of 91 START test not_null_stg_taxi_zones_borough ............................ [RUN]
[0m14:55:55.876721 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a, now test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3)
[0m14:55:55.877086 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b)
[0m14:55:55.877376 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m14:55:55.877713 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m14:55:55.880546 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m14:55:55.882859 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m14:55:55.884402 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m14:55:55.884670 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: BEGIN
[0m14:55:55.885141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:55.885774 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.886162 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m14:55:55.886502 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_name
from "dev"."main"."stg_rate_codes"
where rate_code_name is null



  
  
      
    ) dbt_internal_test
[0m14:55:55.887482 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.888630 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: ROLLBACK
[0m14:55:55.889725 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f'
[0m14:55:55.890146 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: Close
[0m14:55:55.890891 [info ] [Thread-1 (]: 25 of 91 PASS not_null_stg_rate_codes_rate_code_name ........................... [[32mPASS[0m in 0.04s]
[0m14:55:55.891791 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m14:55:55.892338 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m14:55:55.892839 [info ] [Thread-1 (]: 28 of 91 START test not_null_stg_taxi_zones_location_id ........................ [RUN]
[0m14:55:55.893292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf)
[0m14:55:55.893806 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m14:55:55.897127 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m14:55:55.898119 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m14:55:55.898382 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m14:55:55.899933 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m14:55:55.901508 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m14:55:55.908706 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m14:55:55.912135 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m14:55:55.914034 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m14:55:55.914390 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m14:55:55.914677 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: BEGIN
[0m14:55:55.915223 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: BEGIN
[0m14:55:55.915786 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:55.916605 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:55:55.917814 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:55:55.918430 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:55:55.918647 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m14:55:55.919196 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m14:55:55.919784 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rate_code_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_rate_codes"
where rate_code_id is not null
group by rate_code_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:55:55.920356 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select borough
from "dev"."main"."stg_taxi_zones"
where borough is null



  
  
      
    ) dbt_internal_test
[0m14:55:55.921761 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.922109 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.923358 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: ROLLBACK
[0m14:55:55.923679 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m14:55:55.924569 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: ROLLBACK
[0m14:55:55.925319 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3'
[0m14:55:55.925740 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: BEGIN
[0m14:55:55.926412 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b'
[0m14:55:55.926824 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: Close
[0m14:55:55.927331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:55.927895 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: Close
[0m14:55:55.928640 [info ] [Thread-3 (]: 26 of 91 PASS unique_stg_rate_codes_rate_code_id ............................... [[32mPASS[0m in 0.05s]
[0m14:55:55.929283 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:55:55.929963 [info ] [Thread-4 (]: 27 of 91 PASS not_null_stg_taxi_zones_borough .................................. [[32mPASS[0m in 0.05s]
[0m14:55:55.930446 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m14:55:55.931002 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m14:55:55.931417 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m14:55:55.931816 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m14:55:55.932189 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "dev"."main"."stg_taxi_zones"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m14:55:55.932589 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m14:55:55.933008 [info ] [Thread-3 (]: 29 of 91 START test not_null_stg_taxi_zones_zone_name .......................... [RUN]
[0m14:55:55.934082 [info ] [Thread-4 (]: 30 of 91 START test unique_stg_taxi_zones_location_id .......................... [RUN]
[0m14:55:55.934463 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.934818 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84)
[0m14:55:55.935223 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b, now test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c)
[0m14:55:55.936334 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: ROLLBACK
[0m14:55:55.936560 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m14:55:55.936983 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m14:55:55.937525 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf'
[0m14:55:55.941070 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m14:55:55.943747 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m14:55:55.944171 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: Close
[0m14:55:55.945033 [info ] [Thread-1 (]: 28 of 91 PASS not_null_stg_taxi_zones_location_id .............................. [[32mPASS[0m in 0.05s]
[0m14:55:55.945517 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m14:55:55.945992 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.dim_payment_types
[0m14:55:55.946438 [info ] [Thread-1 (]: 31 of 91 START sql table model main.dim_payment_types .......................... [RUN]
[0m14:55:55.947001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf, now model.nyc_taxi_pipeline_00.dim_payment_types)
[0m14:55:55.947416 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_payment_types
[0m14:55:55.949320 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m14:55:55.959385 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m14:55:55.959806 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.dim_payment_types
[0m14:55:55.961696 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m14:55:55.962162 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m14:55:55.964430 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m14:55:55.966947 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m14:55:55.967614 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
DESCRIBE (select * from (
        /*
    Dimension table: Payment type descriptions.
*/

with payment_types as (
    select * from "dev"."main"."stg_payment_types"
),

final as (
    select
        payment_type_id,
        payment_type_name
    from payment_types
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:55:55.968350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:55.969646 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.970724 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m14:55:55.971477 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as payment_type_id, 
      
    cast(null as varchar)
 as payment_type_name
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:55:55.974088 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.975706 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m14:55:55.980529 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m14:55:55.980978 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m14:55:55.981307 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: BEGIN
[0m14:55:55.981786 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: BEGIN
[0m14:55:55.982302 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:55:55.983033 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:55.984072 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:55:55.984352 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.984578 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m14:55:55.984901 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m14:55:55.985396 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_taxi_zones"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:55:55.986233 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select zone_name
from "dev"."main"."stg_taxi_zones"
where zone_name is null



  
  
      
    ) dbt_internal_test
[0m14:55:55.988224 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.988604 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:55:55.990715 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: ROLLBACK
[0m14:55:55.991314 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m14:55:55.992233 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: ROLLBACK
[0m14:55:55.992811 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c'
[0m14:55:55.993334 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: BEGIN
[0m14:55:55.994079 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84'
[0m14:55:55.994419 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: Close
[0m14:55:55.995304 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:55.995522 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: Close
[0m14:55:55.996163 [info ] [Thread-4 (]: 30 of 91 PASS unique_stg_taxi_zones_location_id ................................ [[32mPASS[0m in 0.06s]
[0m14:55:55.996410 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m14:55:55.997104 [info ] [Thread-3 (]: 29 of 91 PASS not_null_stg_taxi_zones_zone_name ................................ [[32mPASS[0m in 0.06s]
[0m14:55:55.997453 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m14:55:55.997860 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_payment_types__dbt_tmp"
  
  (
    payment_type_id integer,
    payment_type_name varchar
    
    )
 ;
    insert into "dev"."main"."dim_payment_types__dbt_tmp" 
  (
    
      
      payment_type_id ,
    
      
      payment_type_name 
    
  )
 (
      
    select payment_type_id, payment_type_name
    from (
        /*
    Dimension table: Payment type descriptions.
*/

with payment_types as (
    select * from "dev"."main"."stg_payment_types"
),

final as (
    select
        payment_type_id,
        payment_type_name
    from payment_types
)

select * from final
    ) as model_subq
    );
  
  
[0m14:55:55.998858 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m14:55:56.000488 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.dim_locations
[0m14:55:56.001021 [info ] [Thread-4 (]: 32 of 91 START sql table model main.dim_locations .............................. [RUN]
[0m14:55:56.001487 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:56.002039 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c, now model.nyc_taxi_pipeline_00.dim_locations)
[0m14:55:56.004270 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m14:55:56.004786 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_locations
[0m14:55:56.005976 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
alter table "dev"."main"."dim_payment_types" rename to "dim_payment_types__dbt_backup"
[0m14:55:56.008119 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_locations"
[0m14:55:56.009316 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:56.012324 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m14:55:56.012801 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
alter table "dev"."main"."dim_payment_types__dbt_tmp" rename to "dim_payment_types"
[0m14:55:56.013451 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:56.014339 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: COMMIT
[0m14:55:56.014678 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m14:55:56.015064 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: COMMIT
[0m14:55:56.019981 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:55:56.021661 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m14:55:56.022691 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
drop table if exists "dev"."main"."dim_payment_types__dbt_backup" cascade
[0m14:55:56.026436 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:55:56.026788 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.dim_locations
[0m14:55:56.028000 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: Close
[0m14:55:56.030247 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m14:55:56.030986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb7f1911-2dd1-446e-af23-d570d9616a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76209323f590>]}
[0m14:55:56.031213 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
DESCRIBE (select * from (
        /*
    Dimension table: TLC Taxi Zone locations.
*/

with zones as (
    select * from "dev"."main"."stg_taxi_zones"
),

final as (
    select
        location_id,
        borough,
        zone_name,
        service_zone
    from zones
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:55:56.031772 [info ] [Thread-1 (]: 31 of 91 OK created sql table model main.dim_payment_types ..................... [[32mOK[0m in 0.08s]
[0m14:55:56.032331 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:55:56.033067 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.dim_payment_types
[0m14:55:56.035032 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m14:55:56.035304 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m14:55:56.035589 [info ] [Thread-3 (]: 33 of 91 START test not_null_dim_payment_types_payment_type_id ................. [RUN]
[0m14:55:56.035845 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:55:56.036298 [info ] [Thread-1 (]: 34 of 91 START test not_null_dim_payment_types_payment_type_name ............... [RUN]
[0m14:55:56.036896 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84, now test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10)
[0m14:55:56.038056 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m14:55:56.038314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_payment_types, now test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0)
[0m14:55:56.039157 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m14:55:56.039635 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as location_id, 
      
    cast(null as varchar)
 as borough, 
      
    cast(null as varchar)
 as zone_name, 
      
    cast(null as varchar)
 as service_zone
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:55:56.040157 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m14:55:56.043027 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m14:55:56.045723 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m14:55:56.046151 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:55:56.047577 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_locations"
[0m14:55:56.059321 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m14:55:56.061717 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m14:55:56.062068 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m14:55:56.062404 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m14:55:56.062993 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: BEGIN
[0m14:55:56.064661 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m14:55:56.065511 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:55:56.065998 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m14:55:56.066326 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_locations__dbt_tmp"
  
  (
    location_id integer,
    borough varchar,
    zone_name varchar,
    service_zone varchar
    
    )
 ;
    insert into "dev"."main"."dim_locations__dbt_tmp" 
  (
    
      
      location_id ,
    
      
      borough ,
    
      
      zone_name ,
    
      
      service_zone 
    
  )
 (
      
    select location_id, borough, zone_name, service_zone
    from (
        /*
    Dimension table: TLC Taxi Zone locations.
*/

with zones as (
    select * from "dev"."main"."stg_taxi_zones"
),

final as (
    select
        location_id,
        borough,
        zone_name,
        service_zone
    from zones
)

select * from final
    ) as model_subq
    );
  
  
[0m14:55:56.067887 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:55:56.070136 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m14:55:56.070919 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
alter table "dev"."main"."dim_locations" rename to "dim_locations__dbt_backup"
[0m14:55:56.071680 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:55:56.074511 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m14:55:56.075090 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
alter table "dev"."main"."dim_locations__dbt_tmp" rename to "dim_locations"
[0m14:55:56.075789 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:55:56.077680 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: COMMIT
[0m14:55:56.078129 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m14:55:56.078461 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: COMMIT
[0m14:55:56.079354 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m14:55:56.079929 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: BEGIN
[0m14:55:56.080297 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:56.080582 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m14:55:56.081241 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:55:56.081585 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: BEGIN
[0m14:55:56.082043 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m14:55:56.082434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:56.083074 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."dim_payment_types"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m14:55:56.083895 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:56.084164 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m14:55:56.084434 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m14:55:56.086353 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m14:55:56.086873 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:55:56.087174 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_name
from "dev"."main"."dim_payment_types"
where payment_type_name is null



  
  
      
    ) dbt_internal_test
[0m14:55:56.087540 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
drop table if exists "dev"."main"."dim_locations__dbt_backup" cascade
[0m14:55:56.089393 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: ROLLBACK
[0m14:55:56.090288 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:56.090917 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10'
[0m14:55:56.092225 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: ROLLBACK
[0m14:55:56.092549 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: Close
[0m14:55:56.092795 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:55:56.093472 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0'
[0m14:55:56.094024 [info ] [Thread-3 (]: 33 of 91 PASS not_null_dim_payment_types_payment_type_id ....................... [[32mPASS[0m in 0.06s]
[0m14:55:56.094857 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: Close
[0m14:55:56.095189 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: Close
[0m14:55:56.095830 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m14:55:56.096510 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb7f1911-2dd1-446e-af23-d570d9616a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76209326c800>]}
[0m14:55:56.096939 [info ] [Thread-1 (]: 34 of 91 PASS not_null_dim_payment_types_payment_type_name ..................... [[32mPASS[0m in 0.06s]
[0m14:55:56.097442 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m14:55:56.098055 [info ] [Thread-4 (]: 32 of 91 OK created sql table model main.dim_locations ......................... [[32mOK[0m in 0.09s]
[0m14:55:56.098584 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m14:55:56.098914 [info ] [Thread-3 (]: 35 of 91 START test unique_dim_payment_types_payment_type_id ................... [RUN]
[0m14:55:56.099314 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.dim_locations
[0m14:55:56.099906 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10, now test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62)
[0m14:55:56.100451 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m14:55:56.100741 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m14:55:56.102958 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m14:55:56.103236 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m14:55:56.103650 [info ] [Thread-1 (]: 36 of 91 START test not_null_dim_locations_borough ............................. [RUN]
[0m14:55:56.104378 [info ] [Thread-4 (]: 37 of 91 START test not_null_dim_locations_location_id ......................... [RUN]
[0m14:55:56.104774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0, now test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af)
[0m14:55:56.105190 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_locations, now test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476)
[0m14:55:56.105867 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m14:55:56.106342 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m14:55:56.109591 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m14:55:56.112179 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m14:55:56.120328 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m14:55:56.120730 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m14:55:56.122387 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m14:55:56.122735 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m14:55:56.124793 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m14:55:56.127430 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m14:55:56.137433 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m14:55:56.137834 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m14:55:56.138149 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: BEGIN
[0m14:55:56.138453 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m14:55:56.138855 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: BEGIN
[0m14:55:56.139487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:56.140151 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: BEGIN
[0m14:55:56.140748 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:55:56.141851 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:55:56.142113 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:56.142883 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:55:56.143123 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m14:55:56.143723 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:55:56.143965 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m14:55:56.144522 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select borough
from "dev"."main"."dim_locations"
where borough is null



  
  
      
    ) dbt_internal_test
[0m14:55:56.145037 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m14:55:56.145417 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "dev"."main"."dim_locations"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m14:55:56.146171 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."dim_payment_types"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:55:56.146514 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:56.147258 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:55:56.148786 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: ROLLBACK
[0m14:55:56.149844 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: ROLLBACK
[0m14:55:56.150449 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af'
[0m14:55:56.150927 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m14:55:56.151431 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476'
[0m14:55:56.151869 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: Close
[0m14:55:56.153028 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: ROLLBACK
[0m14:55:56.153267 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: Close
[0m14:55:56.154004 [info ] [Thread-1 (]: 36 of 91 PASS not_null_dim_locations_borough ................................... [[32mPASS[0m in 0.05s]
[0m14:55:56.154757 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62'
[0m14:55:56.155250 [info ] [Thread-4 (]: 37 of 91 PASS not_null_dim_locations_location_id ............................... [[32mPASS[0m in 0.05s]
[0m14:55:56.155607 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m14:55:56.156220 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: Close
[0m14:55:56.156744 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m14:55:56.157555 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m14:55:56.158789 [info ] [Thread-3 (]: 35 of 91 PASS unique_dim_payment_types_payment_type_id ......................... [[32mPASS[0m in 0.06s]
[0m14:55:56.159164 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m14:55:56.159666 [info ] [Thread-1 (]: 38 of 91 START test not_null_dim_locations_zone_name ........................... [RUN]
[0m14:55:56.160218 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m14:55:56.160757 [info ] [Thread-4 (]: 39 of 91 START test unique_dim_locations_location_id ........................... [RUN]
[0m14:55:56.161422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af, now test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d)
[0m14:55:56.162157 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476, now test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d)
[0m14:55:56.162548 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m14:55:56.163023 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m14:55:56.165783 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m14:55:56.168242 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m14:55:56.184213 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m14:55:56.187421 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m14:55:56.187771 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m14:55:56.189380 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m14:55:56.203102 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m14:55:56.203728 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: BEGIN
[0m14:55:56.204331 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:55:56.204603 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m14:55:56.205191 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: BEGIN
[0m14:55:56.205586 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:55:56.206208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:56.206631 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m14:55:56.207505 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:56.207771 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "dev"."main"."dim_locations"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:55:56.208343 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m14:55:56.209863 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select zone_name
from "dev"."main"."dim_locations"
where zone_name is null



  
  
      
    ) dbt_internal_test
[0m14:55:56.210192 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:55:56.211412 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: ROLLBACK
[0m14:55:56.211663 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:56.212245 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d'
[0m14:55:56.213345 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: ROLLBACK
[0m14:55:56.213544 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: Close
[0m14:55:56.214203 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d'
[0m14:55:56.214800 [info ] [Thread-4 (]: 39 of 91 PASS unique_dim_locations_location_id ................................. [[32mPASS[0m in 0.05s]
[0m14:55:56.215039 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: Close
[0m14:55:56.215477 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m14:55:56.216137 [info ] [Thread-1 (]: 38 of 91 PASS not_null_dim_locations_zone_name ................................. [[32mPASS[0m in 0.05s]
[0m14:55:56.217321 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m14:55:57.092437 [debug] [Thread-2 (]: SQL status: OK in 1.750 seconds
[0m14:55:57.094762 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m14:55:57.095206 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
alter table "dev"."main"."stg_yellow_trips" rename to "stg_yellow_trips__dbt_backup"
[0m14:55:57.095889 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:55:57.097555 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m14:55:57.097956 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
alter table "dev"."main"."stg_yellow_trips__dbt_tmp" rename to "stg_yellow_trips"
[0m14:55:57.098406 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:55:57.099351 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: COMMIT
[0m14:55:57.099759 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m14:55:57.100022 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: COMMIT
[0m14:55:57.155022 [debug] [Thread-2 (]: SQL status: OK in 0.054 seconds
[0m14:55:57.157112 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m14:55:57.157706 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
drop table if exists "dev"."main"."stg_yellow_trips__dbt_backup" cascade
[0m14:55:57.164033 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m14:55:57.165249 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: Close
[0m14:55:57.235199 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb7f1911-2dd1-446e-af23-d570d9616a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7620932631a0>]}
[0m14:55:57.236037 [info ] [Thread-2 (]: 2 of 91 OK created sql table model main.stg_yellow_trips ....................... [[32mOK[0m in 1.99s]
[0m14:55:57.236640 [debug] [Thread-2 (]: Finished running node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m14:55:57.237831 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m14:55:57.238157 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m14:55:57.240493 [info ] [Thread-4 (]: 41 of 91 START test accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99  [RUN]
[0m14:55:57.238862 [info ] [Thread-3 (]: 40 of 91 START test accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6  [RUN]
[0m14:55:57.239419 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m14:55:57.238475 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m14:55:57.241025 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098)
[0m14:55:57.242577 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44)
[0m14:55:57.243100 [info ] [Thread-2 (]: 43 of 91 START test assert_fare_not_exceeds_total .............................. [RUN]
[0m14:55:57.243496 [info ] [Thread-1 (]: 42 of 91 START test accepted_values_stg_yellow_trips_vendor_id__1__2__6 ........ [RUN]
[0m14:55:57.243841 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m14:55:57.244193 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m14:55:57.244594 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_yellow_trips, now test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total)
[0m14:55:57.244984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27)
[0m14:55:57.249672 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m14:55:57.252187 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m14:55:57.252634 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m14:55:57.253016 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m14:55:57.255125 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m14:55:57.257409 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m14:55:57.269261 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m14:55:57.272645 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m14:55:57.273665 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m14:55:57.274113 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m14:55:57.275462 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m14:55:57.275748 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m14:55:57.276953 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m14:55:57.278575 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m14:55:57.284605 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m14:55:57.285048 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: BEGIN
[0m14:55:57.285372 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:55:57.288254 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m14:55:57.288601 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: BEGIN
[0m14:55:57.288993 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m14:55:57.289220 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:57.289859 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: BEGIN
[0m14:55:57.290297 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m14:55:57.291114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:57.291540 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: BEGIN
[0m14:55:57.292461 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:55:57.302874 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m14:55:57.303227 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m14:55:57.303475 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m14:55:57.303697 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m14:55:57.303894 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m14:55:57.304231 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m14:55:57.304540 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m14:55:57.304874 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
    Singular test: fare_amount should not exceed total_amount.
*/

select
    trip_id,
    fare_amount,
    total_amount
from "dev"."main"."stg_yellow_trips"
where fare_amount > total_amount + 0.01
  and total_amount > 0
  
  
      
    ) dbt_internal_test
[0m14:55:57.305214 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m14:55:57.305517 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        payment_type_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by payment_type_id

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6'
)



  
  
      
    ) dbt_internal_test
[0m14:55:57.305842 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        vendor_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by vendor_id

)

select *
from all_values
where value_field not in (
    '1','2','6'
)



  
  
      
    ) dbt_internal_test
[0m14:55:57.306669 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rate_code_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by rate_code_id

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5','6','99'
)



  
  
      
    ) dbt_internal_test
[0m14:55:57.340740 [debug] [Thread-2 (]: SQL status: OK in 0.034 seconds
[0m14:55:57.342846 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: ROLLBACK
[0m14:55:57.344072 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total'
[0m14:55:57.344408 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: Close
[0m14:55:57.344687 [debug] [Thread-3 (]: SQL status: OK in 0.037 seconds
[0m14:55:57.344907 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m14:55:57.345158 [debug] [Thread-4 (]: SQL status: OK in 0.034 seconds
[0m14:55:57.345534 [info ] [Thread-2 (]: 43 of 91 PASS assert_fare_not_exceeds_total .................................... [[32mPASS[0m in 0.10s]
[0m14:55:57.346446 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: ROLLBACK
[0m14:55:57.347351 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: ROLLBACK
[0m14:55:57.348272 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: ROLLBACK
[0m14:55:57.348571 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m14:55:57.349288 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44'
[0m14:55:57.349758 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27'
[0m14:55:57.350427 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098'
[0m14:55:57.351015 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m14:55:57.351356 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: Close
[0m14:55:57.351649 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: Close
[0m14:55:57.351906 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: Close
[0m14:55:57.352189 [info ] [Thread-2 (]: 44 of 91 START test not_null_stg_yellow_trips_dropoff_datetime ................. [RUN]
[0m14:55:57.352776 [info ] [Thread-3 (]: 40 of 91 PASS accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6  [[32mPASS[0m in 0.11s]
[0m14:55:57.353111 [info ] [Thread-1 (]: 42 of 91 PASS accepted_values_stg_yellow_trips_vendor_id__1__2__6 .............. [[32mPASS[0m in 0.11s]
[0m14:55:57.353571 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052)
[0m14:55:57.353994 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m14:55:57.354368 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m14:55:57.354789 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m14:55:57.355382 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m14:55:57.355858 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m14:55:57.359245 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m14:55:57.359690 [info ] [Thread-3 (]: 45 of 91 START test not_null_stg_yellow_trips_dropoff_location_id .............. [RUN]
[0m14:55:57.360197 [info ] [Thread-4 (]: 41 of 91 PASS accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99  [[32mPASS[0m in 0.12s]
[0m14:55:57.360466 [info ] [Thread-1 (]: 46 of 91 START test not_null_stg_yellow_trips_fare_amount ...................... [RUN]
[0m14:55:57.361054 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048)
[0m14:55:57.361453 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m14:55:57.361756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97)
[0m14:55:57.362036 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m14:55:57.362408 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m14:55:57.363003 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m14:55:57.365138 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m14:55:57.365475 [info ] [Thread-4 (]: 47 of 91 START test not_null_stg_yellow_trips_pickup_datetime .................. [RUN]
[0m14:55:57.367649 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m14:55:57.368306 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed)
[0m14:55:57.368810 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m14:55:57.370856 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m14:55:57.373767 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m14:55:57.375467 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m14:55:57.376383 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m14:55:57.376624 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m14:55:57.377935 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m14:55:57.380272 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m14:55:57.381419 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m14:55:57.382713 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m14:55:57.386751 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m14:55:57.387433 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: BEGIN
[0m14:55:57.387776 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:55:57.388040 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m14:55:57.388288 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m14:55:57.388737 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: BEGIN
[0m14:55:57.389111 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: BEGIN
[0m14:55:57.389778 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:57.390104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:57.390750 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m14:55:57.391139 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: BEGIN
[0m14:55:57.391493 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:55:57.404948 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m14:55:57.405418 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m14:55:57.405729 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m14:55:57.405988 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m14:55:57.406204 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m14:55:57.406679 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m14:55:57.407154 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_datetime
from "dev"."main"."stg_yellow_trips"
where dropoff_datetime is null



  
  
      
    ) dbt_internal_test
[0m14:55:57.407621 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m14:55:57.407973 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m14:55:57.408340 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_location_id
from "dev"."main"."stg_yellow_trips"
where dropoff_location_id is null



  
  
      
    ) dbt_internal_test
[0m14:55:57.409034 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fare_amount
from "dev"."main"."stg_yellow_trips"
where fare_amount is null



  
  
      
    ) dbt_internal_test
[0m14:55:57.409436 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:55:57.409707 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "dev"."main"."stg_yellow_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m14:55:57.411294 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: ROLLBACK
[0m14:55:57.411553 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:55:57.412230 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:55:57.412766 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052'
[0m14:55:57.413018 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:55:57.413821 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: ROLLBACK
[0m14:55:57.414810 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: ROLLBACK
[0m14:55:57.414999 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: Close
[0m14:55:57.415820 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: ROLLBACK
[0m14:55:57.416369 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048'
[0m14:55:57.416865 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97'
[0m14:55:57.417468 [info ] [Thread-2 (]: 44 of 91 PASS not_null_stg_yellow_trips_dropoff_datetime ....................... [[32mPASS[0m in 0.06s]
[0m14:55:57.417977 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed'
[0m14:55:57.418182 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: Close
[0m14:55:57.418619 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: Close
[0m14:55:57.419055 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m14:55:57.419365 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: Close
[0m14:55:57.419769 [info ] [Thread-3 (]: 45 of 91 PASS not_null_stg_yellow_trips_dropoff_location_id .................... [[32mPASS[0m in 0.06s]
[0m14:55:57.420127 [info ] [Thread-1 (]: 46 of 91 PASS not_null_stg_yellow_trips_fare_amount ............................ [[32mPASS[0m in 0.06s]
[0m14:55:57.420410 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m14:55:57.420945 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m14:55:57.421341 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m14:55:57.421839 [info ] [Thread-2 (]: 48 of 91 START test not_null_stg_yellow_trips_pickup_location_id ............... [RUN]
[0m14:55:57.422338 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m14:55:57.422864 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m14:55:57.423266 [info ] [Thread-4 (]: 47 of 91 PASS not_null_stg_yellow_trips_pickup_datetime ........................ [[32mPASS[0m in 0.05s]
[0m14:55:57.423582 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1)
[0m14:55:57.423969 [info ] [Thread-3 (]: 49 of 91 START test not_null_stg_yellow_trips_total_amount ..................... [RUN]
[0m14:55:57.424351 [info ] [Thread-1 (]: 50 of 91 START test not_null_stg_yellow_trips_trip_distance_miles .............. [RUN]
[0m14:55:57.424877 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m14:55:57.425197 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m14:55:57.425549 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6)
[0m14:55:57.425872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7)
[0m14:55:57.426244 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m14:55:57.428828 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m14:55:57.429250 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m14:55:57.429692 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m14:55:57.430072 [info ] [Thread-4 (]: 51 of 91 START test not_null_stg_yellow_trips_trip_id .......................... [RUN]
[0m14:55:57.432347 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m14:55:57.434410 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m14:55:57.434829 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1)
[0m14:55:57.435526 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m14:55:57.437450 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m14:55:57.442685 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m14:55:57.443069 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m14:55:57.443320 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m14:55:57.444782 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m14:55:57.446110 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m14:55:57.447505 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m14:55:57.448705 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m14:55:57.450776 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m14:55:57.459468 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m14:55:57.459856 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m14:55:57.460123 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m14:55:57.460383 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m14:55:57.460586 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: BEGIN
[0m14:55:57.461005 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: BEGIN
[0m14:55:57.461368 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: BEGIN
[0m14:55:57.461704 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: BEGIN
[0m14:55:57.461976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:57.462233 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:55:57.462460 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:55:57.462743 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:57.477358 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m14:55:57.477749 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m14:55:57.478129 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m14:55:57.478345 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m14:55:57.478655 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m14:55:57.478863 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m14:55:57.479187 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_distance_miles
from "dev"."main"."stg_yellow_trips"
where trip_distance_miles is null



  
  
      
    ) dbt_internal_test
[0m14:55:57.479490 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m14:55:57.479779 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m14:55:57.480056 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_location_id
from "dev"."main"."stg_yellow_trips"
where pickup_location_id is null



  
  
      
    ) dbt_internal_test
[0m14:55:57.480509 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."stg_yellow_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m14:55:57.480878 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:57.481108 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."stg_yellow_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m14:55:57.482614 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: ROLLBACK
[0m14:55:57.482815 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:55:57.483060 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:55:57.483869 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7'
[0m14:55:57.484149 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:55:57.484956 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: ROLLBACK
[0m14:55:57.485749 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: ROLLBACK
[0m14:55:57.485933 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: Close
[0m14:55:57.486799 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: ROLLBACK
[0m14:55:57.487256 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1'
[0m14:55:57.487878 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1'
[0m14:55:57.488357 [info ] [Thread-1 (]: 50 of 91 PASS not_null_stg_yellow_trips_trip_distance_miles .................... [[32mPASS[0m in 0.06s]
[0m14:55:57.488940 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6'
[0m14:55:57.489157 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: Close
[0m14:55:57.489503 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: Close
[0m14:55:57.489951 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m14:55:57.490317 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: Close
[0m14:55:57.490882 [info ] [Thread-2 (]: 48 of 91 PASS not_null_stg_yellow_trips_pickup_location_id ..................... [[32mPASS[0m in 0.07s]
[0m14:55:57.491232 [info ] [Thread-4 (]: 51 of 91 PASS not_null_stg_yellow_trips_trip_id ................................ [[32mPASS[0m in 0.06s]
[0m14:55:57.491979 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m14:55:57.492572 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m14:55:57.492936 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m14:55:57.493439 [info ] [Thread-1 (]: 52 of 91 START test not_null_stg_yellow_trips_vendor_id ........................ [RUN]
[0m14:55:57.493860 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m14:55:57.494385 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m14:55:57.494904 [info ] [Thread-3 (]: 49 of 91 PASS not_null_stg_yellow_trips_total_amount ........................... [[32mPASS[0m in 0.07s]
[0m14:55:57.495259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57)
[0m14:55:57.495566 [info ] [Thread-2 (]: 53 of 91 START test unique_stg_yellow_trips_trip_id ............................ [RUN]
[0m14:55:57.496010 [info ] [Thread-4 (]: 54 of 91 START test relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_  [RUN]
[0m14:55:57.496535 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m14:55:57.496868 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m14:55:57.497210 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1, now test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965)
[0m14:55:57.500771 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m14:55:57.497835 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m14:55:57.500294 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m14:55:57.497526 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1, now test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a)
[0m14:55:57.503232 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m14:55:57.503754 [info ] [Thread-3 (]: 55 of 91 START test relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_  [RUN]
[0m14:55:57.504324 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m14:55:57.505137 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6, now test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f)
[0m14:55:57.511097 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m14:55:57.510370 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m14:55:57.514258 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m14:55:57.523811 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m14:55:57.524236 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m14:55:57.526186 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m14:55:57.526498 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m14:55:57.526930 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m14:55:57.528574 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m14:55:57.530340 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m14:55:57.532241 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m14:55:57.543161 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m14:55:57.543597 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m14:55:57.543936 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m14:55:57.544208 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: BEGIN
[0m14:55:57.544568 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m14:55:57.544791 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: BEGIN
[0m14:55:57.545160 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: BEGIN
[0m14:55:57.545490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:57.545795 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: BEGIN
[0m14:55:57.546142 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:55:57.546503 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:57.547150 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:55:57.561396 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m14:55:57.561759 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m14:55:57.562011 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m14:55:57.562232 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m14:55:57.562455 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m14:55:57.562830 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m14:55:57.563145 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m14:55:57.563458 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "dev"."main"."stg_yellow_trips"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m14:55:57.563735 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m14:55:57.564033 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select dropoff_location_id as from_field
    from "dev"."main"."stg_yellow_trips"
    where dropoff_location_id is not null
),

parent as (
    select location_id as to_field
    from "dev"."main"."stg_taxi_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:55:57.564489 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select pickup_location_id as from_field
    from "dev"."main"."stg_yellow_trips"
    where pickup_location_id is not null
),

parent as (
    select location_id as to_field
    from "dev"."main"."stg_taxi_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:55:57.565044 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_yellow_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:55:57.565389 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:57.567260 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: ROLLBACK
[0m14:55:57.569595 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57'
[0m14:55:57.571481 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: Close
[0m14:55:57.573260 [info ] [Thread-1 (]: 52 of 91 PASS not_null_stg_yellow_trips_vendor_id .............................. [[32mPASS[0m in 0.08s]
[0m14:55:57.574549 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m14:55:57.684050 [debug] [Thread-4 (]: SQL status: OK in 0.118 seconds
[0m14:55:57.684518 [debug] [Thread-3 (]: SQL status: OK in 0.119 seconds
[0m14:55:57.685960 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: ROLLBACK
[0m14:55:57.687019 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: ROLLBACK
[0m14:55:57.687768 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a'
[0m14:55:57.688656 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f'
[0m14:55:57.695146 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: Close
[0m14:55:57.696514 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: Close
[0m14:55:57.698295 [info ] [Thread-4 (]: 54 of 91 PASS relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_  [[32mPASS[0m in 0.20s]
[0m14:55:57.699325 [info ] [Thread-3 (]: 55 of 91 PASS relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_  [[32mPASS[0m in 0.19s]
[0m14:55:57.699935 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m14:55:57.700775 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m14:55:57.718177 [debug] [Thread-2 (]: SQL status: OK in 0.152 seconds
[0m14:55:57.719980 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: ROLLBACK
[0m14:55:57.720807 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965'
[0m14:55:57.721362 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: Close
[0m14:55:57.739798 [info ] [Thread-2 (]: 53 of 91 PASS unique_stg_yellow_trips_trip_id .................................. [[32mPASS[0m in 0.24s]
[0m14:55:57.740514 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m14:55:57.741357 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m14:55:57.741857 [info ] [Thread-1 (]: 56 of 91 START sql view model main.int_trip_metrics ............................ [RUN]
[0m14:55:57.742319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57, now model.nyc_taxi_pipeline_00.int_trip_metrics)
[0m14:55:57.742785 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m14:55:57.747061 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m14:55:57.761147 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m14:55:57.763502 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m14:55:57.776849 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m14:55:57.777342 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: BEGIN
[0m14:55:57.777655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:57.793082 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m14:55:57.793738 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m14:55:57.794138 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */

  
  create view "dev"."main"."int_trip_metrics__dbt_tmp" as (
    /*
    Intermediate model: Trip-level enrichment with calculated metrics.
    Uses adapter-dispatched macros for cross-dialect compatibility.
*/

with trips as (
    select * from "dev"."main"."stg_yellow_trips"
),

enriched as (
    select
        trip_id,
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        payment_type_id,
        pickup_datetime,
        dropoff_datetime,
        passenger_count,
        trip_distance_miles,
        store_and_fwd_flag,

        -- calculated: duration in minutes
        
    datediff('minute', pickup_datetime, dropoff_datetime)
 as trip_duration_minutes,

        -- calculated: average speed (avoid division by zero)
        case
            when 
    datediff('minute', pickup_datetime, dropoff_datetime)
 > 0
            then round(
                trip_distance_miles / (
    datediff('minute', pickup_datetime, dropoff_datetime)
 / 60.0),
                2
            )
            else null
        end as avg_speed_mph,

        -- calculated: cost per mile
        case
            when trip_distance_miles > 0
            then round(fare_amount / trip_distance_miles, 2)
            else null
        end as cost_per_mile,

        -- calculated: tip percentage
        case
            when fare_amount > 0
            then round((tip_amount / fare_amount) * 100, 2)
            else null
        end as tip_percentage,

        -- time dimensions (using adapter-dispatched macros)
        date_trunc('day', pickup_datetime)::date as pickup_date,
        extract(hour from pickup_datetime) as pickup_hour,
        
    dayname(pickup_datetime)
 as pickup_day_of_week,
        case
            when extract(dow from pickup_datetime) in (0, 6) then true
            else false
        end as is_weekend,

        -- financials passthrough
        fare_amount,
        extra_amount,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount,
        congestion_surcharge,
        airport_fee

    from trips
)

select *
from enriched
where trip_duration_minutes between 1 and 720
  and (avg_speed_mph is null or avg_speed_mph < 100)
  );

[0m14:55:57.795625 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:57.798047 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m14:55:57.798440 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
alter view "dev"."main"."int_trip_metrics" rename to "int_trip_metrics__dbt_backup"
[0m14:55:57.799272 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:57.801276 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m14:55:57.801772 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
alter view "dev"."main"."int_trip_metrics__dbt_tmp" rename to "int_trip_metrics"
[0m14:55:57.802657 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:57.803778 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: COMMIT
[0m14:55:57.804409 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m14:55:57.804838 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: COMMIT
[0m14:55:57.811342 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:55:57.813185 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m14:55:57.813605 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
drop view if exists "dev"."main"."int_trip_metrics__dbt_backup" cascade
[0m14:55:57.816655 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:55:57.817602 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: Close
[0m14:55:57.855714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb7f1911-2dd1-446e-af23-d570d9616a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762050d19550>]}
[0m14:55:57.856474 [info ] [Thread-1 (]: 56 of 91 OK created sql view model main.int_trip_metrics ....................... [[32mOK[0m in 0.11s]
[0m14:55:57.857013 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m14:55:57.857983 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m14:55:57.858278 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m14:55:57.858616 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m14:55:57.858874 [info ] [Thread-3 (]: 57 of 91 START test assert_trip_duration_positive .............................. [RUN]
[0m14:55:57.859117 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m14:55:57.859283 [info ] [Thread-2 (]: 58 of 91 START test dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0  [RUN]
[0m14:55:57.859651 [info ] [Thread-4 (]: 59 of 91 START test dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1  [RUN]
[0m14:55:57.860145 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f, now test.nyc_taxi_pipeline_00.assert_trip_duration_positive)
[0m14:55:57.860524 [info ] [Thread-1 (]: 60 of 91 START test not_null_int_trip_metrics_is_weekend ....................... [RUN]
[0m14:55:57.860904 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574)
[0m14:55:57.861230 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718)
[0m14:55:57.861508 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m14:55:57.861765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_trip_metrics, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed)
[0m14:55:57.862179 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m14:55:57.862429 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m14:55:57.864230 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m14:55:57.864706 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m14:55:57.869201 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m14:55:57.871704 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m14:55:57.874293 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m14:55:57.885193 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m14:55:57.885585 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m14:55:57.885908 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m14:55:57.886228 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m14:55:57.889320 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m14:55:57.954203 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m14:55:57.955879 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m14:55:57.957260 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m14:55:57.968997 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m14:55:57.969407 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m14:55:57.969674 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m14:55:57.969915 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: BEGIN
[0m14:55:57.970161 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m14:55:57.970531 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: BEGIN
[0m14:55:57.970865 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: BEGIN
[0m14:55:57.971125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:57.971364 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: BEGIN
[0m14:55:57.971588 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:57.971805 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:55:57.972389 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:55:57.987789 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m14:55:57.988142 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m14:55:57.988364 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m14:55:57.988579 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m14:55:57.988776 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m14:55:57.988967 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m14:55:57.989266 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m14:55:57.989560 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
    Singular test: No trip should have negative duration.
*/

select
    trip_id,
    pickup_datetime,
    dropoff_datetime,
    trip_duration_minutes
from "dev"."main"."int_trip_metrics"
where trip_duration_minutes < 0
  
  
      
    ) dbt_internal_test
[0m14:55:57.989832 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m14:55:57.990103 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_trip_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not trip_duration_minutes >= 1
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not trip_duration_minutes <= 720
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m14:55:57.990375 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."int_trip_metrics"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m14:55:57.991013 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_trip_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m14:55:57.991830 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:55:57.993486 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: ROLLBACK
[0m14:55:57.993757 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:55:57.996783 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.assert_trip_duration_positive'
[0m14:55:57.999360 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: ROLLBACK
[0m14:55:58.001130 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: Close
[0m14:55:58.004788 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed'
[0m14:55:58.006977 [info ] [Thread-3 (]: 57 of 91 PASS assert_trip_duration_positive .................................... [[32mPASS[0m in 0.15s]
[0m14:55:58.009530 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: Close
[0m14:55:58.013744 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m14:55:58.018252 [info ] [Thread-1 (]: 60 of 91 PASS not_null_int_trip_metrics_is_weekend ............................. [[32mPASS[0m in 0.16s]
[0m14:55:58.019182 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m14:55:58.024396 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m14:55:58.027715 [info ] [Thread-3 (]: 61 of 91 START test not_null_int_trip_metrics_pickup_date ...................... [RUN]
[0m14:55:58.030958 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m14:55:58.032520 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.assert_trip_duration_positive, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3)
[0m14:55:58.034003 [info ] [Thread-1 (]: 62 of 91 START test not_null_int_trip_metrics_pickup_hour ...................... [RUN]
[0m14:55:58.036952 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m14:55:58.041560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082)
[0m14:55:58.048092 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m14:55:58.052075 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m14:55:58.060458 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m14:55:58.081281 [debug] [Thread-2 (]: SQL status: OK in 0.089 seconds
[0m14:55:58.082934 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: ROLLBACK
[0m14:55:58.083223 [debug] [Thread-4 (]: SQL status: OK in 0.092 seconds
[0m14:55:58.083780 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574'
[0m14:55:58.084970 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: ROLLBACK
[0m14:55:58.085223 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: Close
[0m14:55:58.085921 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718'
[0m14:55:58.086425 [info ] [Thread-2 (]: 58 of 91 PASS dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0 ..... [[32mPASS[0m in 0.23s]
[0m14:55:58.086742 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: Close
[0m14:55:58.087253 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m14:55:58.087812 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m14:55:58.088172 [info ] [Thread-2 (]: 63 of 91 START test not_null_int_trip_metrics_trip_duration_minutes ............ [RUN]
[0m14:55:58.088616 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c)
[0m14:55:58.089063 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m14:55:58.092552 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m14:55:58.093330 [info ] [Thread-4 (]: 59 of 91 PASS dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1  [[32mPASS[0m in 0.23s]
[0m14:55:58.093880 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m14:55:58.094229 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m14:55:58.094524 [info ] [Thread-4 (]: 64 of 91 START test not_null_int_trip_metrics_trip_id .......................... [RUN]
[0m14:55:58.094943 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f)
[0m14:55:58.095506 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m14:55:58.095800 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m14:55:58.098104 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m14:55:58.098340 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m14:55:58.099970 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m14:55:58.101539 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m14:55:58.102403 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m14:55:58.104645 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m14:55:58.110630 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m14:55:58.112465 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m14:55:58.114044 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m14:55:58.114300 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m14:55:58.114552 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m14:55:58.114850 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: BEGIN
[0m14:55:58.115184 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: BEGIN
[0m14:55:58.115461 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: BEGIN
[0m14:55:58.115765 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:58.116093 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:55:58.116406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:58.120635 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m14:55:58.120987 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: BEGIN
[0m14:55:58.121279 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:55:58.132926 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m14:55:58.133251 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m14:55:58.133492 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m14:55:58.133677 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m14:55:58.133865 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m14:55:58.134343 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m14:55:58.134753 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m14:55:58.135131 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_duration_minutes
from "dev"."main"."int_trip_metrics"
where trip_duration_minutes is null



  
  
      
    ) dbt_internal_test
[0m14:55:58.135548 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m14:55:58.135908 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_trip_metrics"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m14:55:58.136213 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."int_trip_metrics"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m14:55:58.136680 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."int_trip_metrics"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m14:55:58.137978 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:55:58.138261 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:58.138626 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:55:58.141908 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: ROLLBACK
[0m14:55:58.143100 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: ROLLBACK
[0m14:55:58.145069 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: ROLLBACK
[0m14:55:58.146746 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3'
[0m14:55:58.149799 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082'
[0m14:55:58.150977 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f'
[0m14:55:58.153506 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: Close
[0m14:55:58.154973 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: Close
[0m14:55:58.157577 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: Close
[0m14:55:58.160286 [info ] [Thread-3 (]: 61 of 91 PASS not_null_int_trip_metrics_pickup_date ............................ [[32mPASS[0m in 0.13s]
[0m14:55:58.162679 [info ] [Thread-1 (]: 62 of 91 PASS not_null_int_trip_metrics_pickup_hour ............................ [[32mPASS[0m in 0.12s]
[0m14:55:58.164092 [info ] [Thread-4 (]: 64 of 91 PASS not_null_int_trip_metrics_trip_id ................................ [[32mPASS[0m in 0.07s]
[0m14:55:58.166189 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m14:55:58.168676 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m14:55:58.170931 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m14:55:58.194683 [debug] [Thread-2 (]: SQL status: OK in 0.058 seconds
[0m14:55:58.196046 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: ROLLBACK
[0m14:55:58.196932 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c'
[0m14:55:58.197261 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: Close
[0m14:55:58.202772 [info ] [Thread-2 (]: 63 of 91 PASS not_null_int_trip_metrics_trip_duration_minutes .................. [[32mPASS[0m in 0.11s]
[0m14:55:58.203311 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m14:55:58.204059 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.int_daily_summary
[0m14:55:58.204274 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m14:55:58.204473 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.fct_trips
[0m14:55:58.204746 [info ] [Thread-3 (]: 65 of 91 START sql view model main.int_daily_summary ........................... [RUN]
[0m14:55:58.205151 [info ] [Thread-1 (]: 66 of 91 START sql view model main.int_hourly_patterns ......................... [RUN]
[0m14:55:58.205524 [info ] [Thread-4 (]: 67 of 91 START sql incremental model main.fct_trips ............................ [RUN]
[0m14:55:58.205927 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3, now model.nyc_taxi_pipeline_00.int_daily_summary)
[0m14:55:58.206264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082, now model.nyc_taxi_pipeline_00.int_hourly_patterns)
[0m14:55:58.206572 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f, now model.nyc_taxi_pipeline_00.fct_trips)
[0m14:55:58.207139 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.int_daily_summary
[0m14:55:58.207468 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m14:55:58.207808 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.fct_trips
[0m14:55:58.209911 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m14:55:58.211630 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m14:55:58.216154 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.fct_trips"
[0m14:55:58.229147 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m14:55:58.229618 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.int_daily_summary
[0m14:55:58.229924 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.fct_trips
[0m14:55:58.232070 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m14:55:58.234260 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m14:55:58.253112 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m14:55:58.253811 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
DESCRIBE (select * from (
        /*
    Fact table: Fully enriched trip records with location names.
    Incremental with delete+insert strategy.
*/



with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

pickup_locations as (
    select * from "dev"."main"."dim_locations"
),

dropoff_locations as (
    select * from "dev"."main"."dim_locations"
),

final as (
    select
        t.trip_id,
        t.vendor_id,
        t.rate_code_id,
        t.payment_type_id,
        t.pickup_location_id,
        t.dropoff_location_id,
        t.pickup_datetime,
        t.dropoff_datetime,
        t.pickup_date,
        t.pickup_hour,
        t.pickup_day_of_week,
        t.is_weekend,
        t.passenger_count,
        t.trip_distance_miles,
        t.trip_duration_minutes,
        t.avg_speed_mph,
        t.cost_per_mile,
        t.fare_amount,
        t.extra_amount,
        t.mta_tax,
        t.tip_amount,
        t.tip_percentage,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.congestion_surcharge,
        t.airport_fee,

        -- enriched from dimensions
        pu.borough as pickup_borough,
        pu.zone_name as pickup_zone,
        do_loc.borough as dropoff_borough,
        do_loc.zone_name as dropoff_zone

    from trip_metrics t
    left join pickup_locations pu
        on t.pickup_location_id = pu.location_id
    left join dropoff_locations do_loc
        on t.dropoff_location_id = do_loc.location_id

    
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:55:58.254258 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:55:58.265593 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m14:55:58.266079 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: BEGIN
[0m14:55:58.266493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:58.267915 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m14:55:58.268293 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: BEGIN
[0m14:55:58.268634 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:58.274695 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m14:55:58.275097 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m14:55:58.275377 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m14:55:58.275758 [debug] [Thread-4 (]: SQL status: OK in 0.021 seconds
[0m14:55:58.276092 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m14:55:58.276538 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */

  
  create view "dev"."main"."int_hourly_patterns__dbt_tmp" as (
    /*
    Intermediate model: Hourly trip patterns by date.
    One row per date + hour combination.
*/

with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

hourly_agg as (
    select
        pickup_date,
        pickup_hour,
        pickup_day_of_week,
        is_weekend,

        count(*) as total_trips,
        round(avg(trip_distance_miles), 2) as avg_distance,
        round(avg(trip_duration_minutes), 2) as avg_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue

    from trip_metrics
    group by pickup_date, pickup_hour, pickup_day_of_week, is_weekend
)

select * from hourly_agg
  );

[0m14:55:58.278441 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m14:55:58.278687 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */

  
  create view "dev"."main"."int_daily_summary__dbt_tmp" as (
    /*
    Intermediate model: Daily aggregated trip and revenue metrics.
    One row per day with counts, averages, and revenue totals.
*/

with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

daily_agg as (
    select
        pickup_date,
        pickup_day_of_week,
        is_weekend,

        count(*) as total_trips,
        sum(passenger_count) as total_passengers,

        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(avg(avg_speed_mph), 2) as avg_speed_mph,

        round(sum(fare_amount), 2) as total_fare_revenue,
        round(sum(tip_amount), 2) as total_tip_revenue,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_trip_revenue,
        round(avg(tip_percentage), 2) as avg_tip_percentage,

        count(case when payment_type_id = 1 then 1 end) as credit_card_trips,
        count(case when payment_type_id = 2 then 1 end) as cash_trips

    from trip_metrics
    group by pickup_date, pickup_day_of_week, is_weekend
)

select * from daily_agg
  );

[0m14:55:58.279455 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as varchar)
 as trip_id, 
      
    cast(null as integer)
 as vendor_id, 
      
    cast(null as integer)
 as rate_code_id, 
      
    cast(null as integer)
 as payment_type_id, 
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as integer)
 as dropoff_location_id, 
      
    cast(null as timestamp)
 as pickup_datetime, 
      
    cast(null as timestamp)
 as dropoff_datetime, 
      
    cast(null as date)
 as pickup_date, 
      
    cast(null as bigint)
 as pickup_hour, 
      
    cast(null as varchar)
 as pickup_day_of_week, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as integer)
 as passenger_count, 
      
    cast(null as double)
 as trip_distance_miles, 
      
    cast(null as bigint)
 as trip_duration_minutes, 
      
    cast(null as double)
 as avg_speed_mph, 
      
    cast(null as double)
 as cost_per_mile, 
      
    cast(null as decimal(10,2))
 as fare_amount, 
      
    cast(null as decimal(10,2))
 as extra_amount, 
      
    cast(null as decimal(10,2))
 as mta_tax, 
      
    cast(null as decimal(10,2))
 as tip_amount, 
      
    cast(null as double)
 as tip_percentage, 
      
    cast(null as decimal(10,2))
 as tolls_amount, 
      
    cast(null as decimal(10,2))
 as improvement_surcharge, 
      
    cast(null as decimal(10,2))
 as total_amount, 
      
    cast(null as decimal(10,2))
 as congestion_surcharge, 
      
    cast(null as decimal(10,2))
 as airport_fee, 
      
    cast(null as varchar)
 as pickup_borough, 
      
    cast(null as varchar)
 as pickup_zone, 
      
    cast(null as varchar)
 as dropoff_borough, 
      
    cast(null as varchar)
 as dropoff_zone
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:55:58.280232 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:58.282582 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m14:55:58.282881 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:55:58.283117 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:55:58.283343 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
alter view "dev"."main"."int_hourly_patterns" rename to "int_hourly_patterns__dbt_backup"
[0m14:55:58.285274 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m14:55:58.287872 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.fct_trips"
[0m14:55:58.288395 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
alter view "dev"."main"."int_daily_summary" rename to "int_daily_summary__dbt_backup"
[0m14:55:58.288688 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:58.290629 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m14:55:58.290885 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:55:58.291098 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
alter view "dev"."main"."int_hourly_patterns__dbt_tmp" rename to "int_hourly_patterns"
[0m14:55:58.292774 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m14:55:58.293463 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
alter view "dev"."main"."int_daily_summary__dbt_tmp" rename to "int_daily_summary"
[0m14:55:58.293833 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:58.294305 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:55:58.295091 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: COMMIT
[0m14:55:58.295932 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: COMMIT
[0m14:55:58.296261 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m14:55:58.296563 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m14:55:58.297044 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: COMMIT
[0m14:55:58.297609 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: COMMIT
[0m14:55:58.302818 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:55:58.304679 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m14:55:58.305002 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
drop view if exists "dev"."main"."int_hourly_patterns__dbt_backup" cascade
[0m14:55:58.305484 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m14:55:58.307041 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m14:55:58.307531 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m14:55:58.307820 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
drop view if exists "dev"."main"."int_daily_summary__dbt_backup" cascade
[0m14:55:58.308400 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.fct_trips: BEGIN
[0m14:55:58.308731 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:55:58.309507 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:55:58.310466 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: Close
[0m14:55:58.310853 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m14:55:58.311522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb7f1911-2dd1-446e-af23-d570d9616a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762092ec7950>]}
[0m14:55:58.311804 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:55:58.312120 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */

  
    
    
      
    

    create  table
      "dev"."main"."fct_trips__dbt_tmp"
  
  (
    trip_id varchar,
    vendor_id integer,
    rate_code_id integer,
    payment_type_id integer,
    pickup_location_id integer,
    dropoff_location_id integer,
    pickup_datetime timestamp,
    dropoff_datetime timestamp,
    pickup_date date,
    pickup_hour bigint,
    pickup_day_of_week varchar,
    is_weekend boolean,
    passenger_count integer,
    trip_distance_miles double,
    trip_duration_minutes bigint,
    avg_speed_mph double,
    cost_per_mile double,
    fare_amount decimal(10,2),
    extra_amount decimal(10,2),
    mta_tax decimal(10,2),
    tip_amount decimal(10,2),
    tip_percentage double,
    tolls_amount decimal(10,2),
    improvement_surcharge decimal(10,2),
    total_amount decimal(10,2),
    congestion_surcharge decimal(10,2),
    airport_fee decimal(10,2),
    pickup_borough varchar,
    pickup_zone varchar,
    dropoff_borough varchar,
    dropoff_zone varchar
    
    )
 ;
    insert into "dev"."main"."fct_trips__dbt_tmp" 
  (
    
      
      trip_id ,
    
      
      vendor_id ,
    
      
      rate_code_id ,
    
      
      payment_type_id ,
    
      
      pickup_location_id ,
    
      
      dropoff_location_id ,
    
      
      pickup_datetime ,
    
      
      dropoff_datetime ,
    
      
      pickup_date ,
    
      
      pickup_hour ,
    
      
      pickup_day_of_week ,
    
      
      is_weekend ,
    
      
      passenger_count ,
    
      
      trip_distance_miles ,
    
      
      trip_duration_minutes ,
    
      
      avg_speed_mph ,
    
      
      cost_per_mile ,
    
      
      fare_amount ,
    
      
      extra_amount ,
    
      
      mta_tax ,
    
      
      tip_amount ,
    
      
      tip_percentage ,
    
      
      tolls_amount ,
    
      
      improvement_surcharge ,
    
      
      total_amount ,
    
      
      congestion_surcharge ,
    
      
      airport_fee ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      dropoff_borough ,
    
      
      dropoff_zone 
    
  )
 (
      
    select trip_id, vendor_id, rate_code_id, payment_type_id, pickup_location_id, dropoff_location_id, pickup_datetime, dropoff_datetime, pickup_date, pickup_hour, pickup_day_of_week, is_weekend, passenger_count, trip_distance_miles, trip_duration_minutes, avg_speed_mph, cost_per_mile, fare_amount, extra_amount, mta_tax, tip_amount, tip_percentage, tolls_amount, improvement_surcharge, total_amount, congestion_surcharge, airport_fee, pickup_borough, pickup_zone, dropoff_borough, dropoff_zone
    from (
        /*
    Fact table: Fully enriched trip records with location names.
    Incremental with delete+insert strategy.
*/



with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

pickup_locations as (
    select * from "dev"."main"."dim_locations"
),

dropoff_locations as (
    select * from "dev"."main"."dim_locations"
),

final as (
    select
        t.trip_id,
        t.vendor_id,
        t.rate_code_id,
        t.payment_type_id,
        t.pickup_location_id,
        t.dropoff_location_id,
        t.pickup_datetime,
        t.dropoff_datetime,
        t.pickup_date,
        t.pickup_hour,
        t.pickup_day_of_week,
        t.is_weekend,
        t.passenger_count,
        t.trip_distance_miles,
        t.trip_duration_minutes,
        t.avg_speed_mph,
        t.cost_per_mile,
        t.fare_amount,
        t.extra_amount,
        t.mta_tax,
        t.tip_amount,
        t.tip_percentage,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.congestion_surcharge,
        t.airport_fee,

        -- enriched from dimensions
        pu.borough as pickup_borough,
        pu.zone_name as pickup_zone,
        do_loc.borough as dropoff_borough,
        do_loc.zone_name as dropoff_zone

    from trip_metrics t
    left join pickup_locations pu
        on t.pickup_location_id = pu.location_id
    left join dropoff_locations do_loc
        on t.dropoff_location_id = do_loc.location_id

    
)

select * from final
    ) as model_subq
    );
  
  
  
[0m14:55:58.312777 [info ] [Thread-1 (]: 66 of 91 OK created sql view model main.int_hourly_patterns .................... [[32mOK[0m in 0.11s]
[0m14:55:58.313923 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: Close
[0m14:55:58.314953 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m14:55:58.315513 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb7f1911-2dd1-446e-af23-d570d9616a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762093283ec0>]}
[0m14:55:58.316189 [info ] [Thread-3 (]: 65 of 91 OK created sql view model main.int_daily_summary ...................... [[32mOK[0m in 0.11s]
[0m14:55:58.316476 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m14:55:58.316693 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m14:55:58.317007 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.int_daily_summary
[0m14:55:58.317663 [info ] [Thread-2 (]: 68 of 91 START test dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0  [RUN]
[0m14:55:58.318136 [info ] [Thread-1 (]: 69 of 91 START test not_null_int_hourly_patterns_pickup_date ................... [RUN]
[0m14:55:58.318660 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m14:55:58.319528 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe)
[0m14:55:58.322276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_hourly_patterns, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2)
[0m14:55:58.325034 [info ] [Thread-3 (]: 70 of 91 START test not_null_int_hourly_patterns_pickup_hour ................... [RUN]
[0m14:55:58.328115 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m14:55:58.329802 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m14:55:58.330730 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_daily_summary, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d)
[0m14:55:58.336519 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m14:55:58.340575 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m14:55:58.342931 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m14:55:58.352625 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m14:55:58.391581 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m14:55:58.395843 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m14:55:58.396208 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m14:55:58.401298 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m14:55:58.405444 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m14:55:58.410206 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m14:55:58.437893 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m14:55:58.438990 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m14:55:58.439990 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: BEGIN
[0m14:55:58.447423 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: BEGIN
[0m14:55:58.448756 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:58.456376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:58.459400 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m14:55:58.461613 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m14:55:58.461317 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m14:55:58.460538 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:55:58.462315 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."int_hourly_patterns"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m14:55:58.463225 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: BEGIN
[0m14:55:58.464785 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m14:55:58.470511 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:55:58.471445 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:55:58.472495 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_hourly_patterns"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m14:55:58.474701 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: ROLLBACK
[0m14:55:58.480988 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d'
[0m14:55:58.479328 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:55:58.476008 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m14:55:58.481783 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: Close
[0m14:55:58.488461 [info ] [Thread-3 (]: 70 of 91 PASS not_null_int_hourly_patterns_pickup_hour ......................... [[32mPASS[0m in 0.16s]
[0m14:55:58.485638 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m14:55:58.485137 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: ROLLBACK
[0m14:55:58.492105 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m14:55:58.504401 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m14:55:58.499763 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2'
[0m14:55:58.510781 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: Close
[0m14:55:58.511936 [info ] [Thread-1 (]: 69 of 91 PASS not_null_int_hourly_patterns_pickup_date ......................... [[32mPASS[0m in 0.19s]
[0m14:55:58.506267 [info ] [Thread-3 (]: 71 of 91 START test not_null_int_hourly_patterns_total_trips ................... [RUN]
[0m14:55:58.517172 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf)
[0m14:55:58.515494 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m14:55:58.517890 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m14:55:58.518858 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m14:55:58.493934 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_hourly_patterns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m14:55:58.523639 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m14:55:58.526117 [info ] [Thread-1 (]: 72 of 91 START test dbt_utils_accepted_range_int_daily_summary_total_trips__0 .. [RUN]
[0m14:55:58.540806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863)
[0m14:55:58.544160 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m14:55:58.549910 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m14:55:58.580881 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m14:55:58.587369 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m14:55:58.589479 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m14:55:58.590300 [debug] [Thread-2 (]: SQL status: OK in 0.062 seconds
[0m14:55:58.598120 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m14:55:58.602012 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: ROLLBACK
[0m14:55:58.603988 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe'
[0m14:55:58.607159 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: Close
[0m14:55:58.609564 [info ] [Thread-2 (]: 68 of 91 PASS dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0 .. [[32mPASS[0m in 0.29s]
[0m14:55:58.612858 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m14:55:58.615281 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m14:55:58.616610 [info ] [Thread-2 (]: 73 of 91 START test not_null_int_daily_summary_pickup_date ..................... [RUN]
[0m14:55:58.619004 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686)
[0m14:55:58.620119 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m14:55:58.628460 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m14:55:58.639852 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m14:55:58.641710 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: BEGIN
[0m14:55:58.642865 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:58.643411 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m14:55:58.644682 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:55:58.645112 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: BEGIN
[0m14:55:58.646081 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m14:55:58.646982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:58.647566 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_trips
from "dev"."main"."int_hourly_patterns"
where total_trips is null



  
  
      
    ) dbt_internal_test
[0m14:55:58.649074 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:55:58.653460 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m14:55:58.655159 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_daily_summary"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_trips >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m14:55:58.670279 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m14:55:58.672827 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m14:55:58.695949 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m14:55:58.696772 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: BEGIN
[0m14:55:58.697379 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:55:58.698324 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:55:58.699087 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m14:55:58.699933 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_daily_summary"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m14:55:58.702966 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:55:58.705987 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: ROLLBACK
[0m14:55:58.707226 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686'
[0m14:55:58.707804 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: Close
[0m14:55:58.708861 [info ] [Thread-2 (]: 73 of 91 PASS not_null_int_daily_summary_pickup_date ........................... [[32mPASS[0m in 0.09s]
[0m14:55:58.709687 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m14:55:58.710338 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m14:55:58.710915 [info ] [Thread-2 (]: 74 of 91 START test not_null_int_daily_summary_total_revenue ................... [RUN]
[0m14:55:58.711635 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50)
[0m14:55:58.712232 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m14:55:58.717422 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m14:55:58.741051 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m14:55:58.744523 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m14:55:58.768315 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m14:55:58.768977 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: BEGIN
[0m14:55:58.769532 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:55:58.770391 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:55:58.771113 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m14:55:58.772191 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "dev"."main"."int_daily_summary"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m14:55:58.864196 [debug] [Thread-3 (]: SQL status: OK in 0.215 seconds
[0m14:55:58.865780 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: ROLLBACK
[0m14:55:58.866645 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf'
[0m14:55:58.867080 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: Close
[0m14:55:58.867834 [info ] [Thread-3 (]: 71 of 91 PASS not_null_int_hourly_patterns_total_trips ......................... [[32mPASS[0m in 0.35s]
[0m14:55:58.868368 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m14:55:58.868706 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m14:55:58.869244 [info ] [Thread-3 (]: 75 of 91 START test not_null_int_daily_summary_total_trips ..................... [RUN]
[0m14:55:58.869908 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10)
[0m14:55:58.870345 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m14:55:58.873336 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m14:55:58.890971 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m14:55:58.893162 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m14:55:58.907452 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m14:55:58.908721 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: BEGIN
[0m14:55:58.909263 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:58.910201 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:55:58.910705 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m14:55:58.911130 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_trips
from "dev"."main"."int_daily_summary"
where total_trips is null



  
  
      
    ) dbt_internal_test
[0m14:55:58.958639 [debug] [Thread-1 (]: SQL status: OK in 0.302 seconds
[0m14:55:58.960542 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: ROLLBACK
[0m14:55:58.961786 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863'
[0m14:55:58.962482 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: Close
[0m14:55:58.963351 [info ] [Thread-1 (]: 72 of 91 PASS dbt_utils_accepted_range_int_daily_summary_total_trips__0 ........ [[32mPASS[0m in 0.42s]
[0m14:55:58.964138 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m14:55:58.965107 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m14:55:58.965865 [info ] [Thread-1 (]: 76 of 91 START test unique_int_daily_summary_pickup_date ....................... [RUN]
[0m14:55:58.966394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863, now test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e)
[0m14:55:58.967100 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m14:55:58.970416 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m14:55:58.978673 [debug] [Thread-2 (]: SQL status: OK in 0.206 seconds
[0m14:55:58.980198 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: ROLLBACK
[0m14:55:58.980890 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50'
[0m14:55:58.981212 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: Close
[0m14:55:58.982077 [info ] [Thread-2 (]: 74 of 91 PASS not_null_int_daily_summary_total_revenue ......................... [[32mPASS[0m in 0.27s]
[0m14:55:58.982643 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m14:55:58.983511 [debug] [Thread-2 (]: Began running node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m14:55:58.984111 [info ] [Thread-2 (]: 77 of 91 START sql table model main.mart_hourly_demand ......................... [RUN]
[0m14:55:58.984963 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50, now model.nyc_taxi_pipeline_00.mart_hourly_demand)
[0m14:55:58.985491 [debug] [Thread-2 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m14:55:58.988057 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m14:55:58.990381 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m14:55:58.992127 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m14:55:59.002419 [debug] [Thread-2 (]: Began executing node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m14:55:59.007170 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m14:55:59.007793 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Hourly demand patterns.
*/

with hourly as (
    select * from "dev"."main"."int_hourly_patterns"
),

final as (
    select
        pickup_hour,
        is_weekend,

        count(*) as days_observed,
        round(avg(total_trips), 0) as avg_trips_per_period,
        round(avg(avg_distance), 2) as avg_distance,
        round(avg(avg_duration_min), 2) as avg_duration_min,
        round(avg(total_revenue), 2) as avg_revenue_per_period,
        sum(total_trips) as total_trips_all_days

    from hourly
    group by pickup_hour, is_weekend
)

select * from final
order by is_weekend, pickup_hour
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:55:59.008476 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:55:59.010009 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m14:55:59.010492 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: BEGIN
[0m14:55:59.010902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:59.011297 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:55:59.012014 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:59.013557 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m14:55:59.013831 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m14:55:59.014366 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as bigint)
 as pickup_hour, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as bigint)
 as days_observed, 
      
    cast(null as double)
 as avg_trips_per_period, 
      
    cast(null as double)
 as avg_distance, 
      
    cast(null as double)
 as avg_duration_min, 
      
    cast(null as double)
 as avg_revenue_per_period, 
      
    cast(null as hugeint)
 as total_trips_all_days
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:55:59.014780 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pickup_date as unique_field,
    count(*) as n_records

from "dev"."main"."int_daily_summary"
where pickup_date is not null
group by pickup_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:55:59.015781 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:55:59.017871 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m14:55:59.034066 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m14:55:59.034654 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: BEGIN
[0m14:55:59.035414 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:55:59.035927 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m14:55:59.036378 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_hourly_demand__dbt_tmp"
  
  (
    pickup_hour bigint,
    is_weekend boolean,
    days_observed bigint,
    avg_trips_per_period double,
    avg_distance double,
    avg_duration_min double,
    avg_revenue_per_period double,
    total_trips_all_days hugeint
    
    )
 ;
    insert into "dev"."main"."mart_hourly_demand__dbt_tmp" 
  (
    
      
      pickup_hour ,
    
      
      is_weekend ,
    
      
      days_observed ,
    
      
      avg_trips_per_period ,
    
      
      avg_distance ,
    
      
      avg_duration_min ,
    
      
      avg_revenue_per_period ,
    
      
      total_trips_all_days 
    
  )
 (
      
    select pickup_hour, is_weekend, days_observed, avg_trips_per_period, avg_distance, avg_duration_min, avg_revenue_per_period, total_trips_all_days
    from (
        /*
    Analytics mart: Hourly demand patterns.
*/

with hourly as (
    select * from "dev"."main"."int_hourly_patterns"
),

final as (
    select
        pickup_hour,
        is_weekend,

        count(*) as days_observed,
        round(avg(total_trips), 0) as avg_trips_per_period,
        round(avg(avg_distance), 2) as avg_distance,
        round(avg(avg_duration_min), 2) as avg_duration_min,
        round(avg(total_revenue), 2) as avg_revenue_per_period,
        sum(total_trips) as total_trips_all_days

    from hourly
    group by pickup_hour, is_weekend
)

select * from final
order by is_weekend, pickup_hour
    ) as model_subq
    );
  
  
[0m14:55:59.053588 [debug] [Thread-3 (]: SQL status: OK in 0.142 seconds
[0m14:55:59.055384 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: ROLLBACK
[0m14:55:59.056399 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10'
[0m14:55:59.056953 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: Close
[0m14:55:59.057829 [info ] [Thread-3 (]: 75 of 91 PASS not_null_int_daily_summary_total_trips ........................... [[32mPASS[0m in 0.19s]
[0m14:55:59.058700 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m14:55:59.169411 [debug] [Thread-1 (]: SQL status: OK in 0.154 seconds
[0m14:55:59.171934 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: ROLLBACK
[0m14:55:59.172954 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e'
[0m14:55:59.173459 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: Close
[0m14:55:59.174159 [info ] [Thread-1 (]: 76 of 91 PASS unique_int_daily_summary_pickup_date ............................. [[32mPASS[0m in 0.21s]
[0m14:55:59.174783 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m14:55:59.176205 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m14:55:59.177273 [info ] [Thread-3 (]: 78 of 91 START sql table model main.mart_daily_revenue ......................... [RUN]
[0m14:55:59.178464 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10, now model.nyc_taxi_pipeline_00.mart_daily_revenue)
[0m14:55:59.179173 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m14:55:59.181669 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m14:55:59.202829 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m14:55:59.205716 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m14:55:59.206252 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Daily revenue metrics with running totals.
*/

with daily as (
    select * from "dev"."main"."int_daily_summary"
),

dates as (
    select * from "dev"."main"."dim_dates"
),

final as (
    select
        d.date_key,
        d.day_of_week_name,
        d.is_weekend,
        d.is_holiday,
        d.week_of_year,

        daily.total_trips,
        daily.total_passengers,
        daily.total_fare_revenue,
        daily.total_tip_revenue,
        daily.total_revenue,
        daily.avg_trip_revenue,
        daily.avg_tip_percentage,
        daily.credit_card_trips,
        daily.cash_trips,
        daily.avg_trip_distance,
        daily.avg_trip_duration_min,

        -- running total
        sum(daily.total_revenue) over (order by d.date_key) as cumulative_revenue,

        -- day-over-day change
        daily.total_revenue - lag(daily.total_revenue) over (order by d.date_key) as revenue_change_vs_prior_day

    from daily
    inner join dates d
        on daily.pickup_date = d.date_key
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:55:59.206612 [debug] [Thread-2 (]: SQL status: OK in 0.170 seconds
[0m14:55:59.206927 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:59.208833 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m14:55:59.210308 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
alter table "dev"."main"."mart_hourly_demand" rename to "mart_hourly_demand__dbt_backup"
[0m14:55:59.211160 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:55:59.211499 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m14:55:59.213281 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m14:55:59.215490 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m14:55:59.215763 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
alter table "dev"."main"."mart_hourly_demand__dbt_tmp" rename to "mart_hourly_demand"
[0m14:55:59.216206 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as date_key, 
      
    cast(null as varchar)
 as day_of_week_name, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as boolean)
 as is_holiday, 
      
    cast(null as bigint)
 as week_of_year, 
      
    cast(null as bigint)
 as total_trips, 
      
    cast(null as hugeint)
 as total_passengers, 
      
    cast(null as decimal(38,2))
 as total_fare_revenue, 
      
    cast(null as decimal(38,2))
 as total_tip_revenue, 
      
    cast(null as decimal(38,2))
 as total_revenue, 
      
    cast(null as double)
 as avg_trip_revenue, 
      
    cast(null as double)
 as avg_tip_percentage, 
      
    cast(null as bigint)
 as credit_card_trips, 
      
    cast(null as bigint)
 as cash_trips, 
      
    cast(null as double)
 as avg_trip_distance, 
      
    cast(null as double)
 as avg_trip_duration_min, 
      
    cast(null as decimal(38,2))
 as cumulative_revenue, 
      
    cast(null as decimal(38,2))
 as revenue_change_vs_prior_day
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:55:59.216909 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:55:59.218057 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: COMMIT
[0m14:55:59.218340 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:55:59.218627 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m14:55:59.220608 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m14:55:59.220946 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: COMMIT
[0m14:55:59.224260 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:55:59.225807 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m14:55:59.226233 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
drop table if exists "dev"."main"."mart_hourly_demand__dbt_backup" cascade
[0m14:55:59.229419 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:55:59.230485 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: Close
[0m14:55:59.231326 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb7f1911-2dd1-446e-af23-d570d9616a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762093260170>]}
[0m14:55:59.231923 [info ] [Thread-2 (]: 77 of 91 OK created sql table model main.mart_hourly_demand .................... [[32mOK[0m in 0.25s]
[0m14:55:59.232448 [debug] [Thread-2 (]: Finished running node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m14:55:59.233135 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m14:55:59.233391 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m14:55:59.233674 [info ] [Thread-1 (]: 79 of 91 START test not_null_mart_hourly_demand_is_weekend ..................... [RUN]
[0m14:55:59.234114 [info ] [Thread-2 (]: 80 of 91 START test not_null_mart_hourly_demand_pickup_hour .................... [RUN]
[0m14:55:59.234650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e, now test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8)
[0m14:55:59.235212 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.mart_hourly_demand, now test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418)
[0m14:55:59.235636 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m14:55:59.235965 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m14:55:59.238613 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m14:55:59.241858 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m14:55:59.244597 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m14:55:59.245176 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: BEGIN
[0m14:55:59.246057 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:55:59.246452 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m14:55:59.247033 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_daily_revenue__dbt_tmp"
  
  (
    date_key date,
    day_of_week_name varchar,
    is_weekend boolean,
    is_holiday boolean,
    week_of_year bigint,
    total_trips bigint,
    total_passengers hugeint,
    total_fare_revenue decimal(38,2),
    total_tip_revenue decimal(38,2),
    total_revenue decimal(38,2),
    avg_trip_revenue double,
    avg_tip_percentage double,
    credit_card_trips bigint,
    cash_trips bigint,
    avg_trip_distance double,
    avg_trip_duration_min double,
    cumulative_revenue decimal(38,2),
    revenue_change_vs_prior_day decimal(38,2)
    
    )
 ;
    insert into "dev"."main"."mart_daily_revenue__dbt_tmp" 
  (
    
      
      date_key ,
    
      
      day_of_week_name ,
    
      
      is_weekend ,
    
      
      is_holiday ,
    
      
      week_of_year ,
    
      
      total_trips ,
    
      
      total_passengers ,
    
      
      total_fare_revenue ,
    
      
      total_tip_revenue ,
    
      
      total_revenue ,
    
      
      avg_trip_revenue ,
    
      
      avg_tip_percentage ,
    
      
      credit_card_trips ,
    
      
      cash_trips ,
    
      
      avg_trip_distance ,
    
      
      avg_trip_duration_min ,
    
      
      cumulative_revenue ,
    
      
      revenue_change_vs_prior_day 
    
  )
 (
      
    select date_key, day_of_week_name, is_weekend, is_holiday, week_of_year, total_trips, total_passengers, total_fare_revenue, total_tip_revenue, total_revenue, avg_trip_revenue, avg_tip_percentage, credit_card_trips, cash_trips, avg_trip_distance, avg_trip_duration_min, cumulative_revenue, revenue_change_vs_prior_day
    from (
        /*
    Analytics mart: Daily revenue metrics with running totals.
*/

with daily as (
    select * from "dev"."main"."int_daily_summary"
),

dates as (
    select * from "dev"."main"."dim_dates"
),

final as (
    select
        d.date_key,
        d.day_of_week_name,
        d.is_weekend,
        d.is_holiday,
        d.week_of_year,

        daily.total_trips,
        daily.total_passengers,
        daily.total_fare_revenue,
        daily.total_tip_revenue,
        daily.total_revenue,
        daily.avg_trip_revenue,
        daily.avg_tip_percentage,
        daily.credit_card_trips,
        daily.cash_trips,
        daily.avg_trip_distance,
        daily.avg_trip_duration_min,

        -- running total
        sum(daily.total_revenue) over (order by d.date_key) as cumulative_revenue,

        -- day-over-day change
        daily.total_revenue - lag(daily.total_revenue) over (order by d.date_key) as revenue_change_vs_prior_day

    from daily
    inner join dates d
        on daily.pickup_date = d.date_key
)

select * from final
    ) as model_subq
    );
  
  
[0m14:55:59.255796 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m14:55:59.258025 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m14:55:59.258284 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m14:55:59.261233 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m14:55:59.273872 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m14:55:59.275450 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: BEGIN
[0m14:55:59.276089 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m14:55:59.276486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:59.277395 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: BEGIN
[0m14:55:59.278195 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:55:59.278475 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:55:59.278945 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m14:55:59.280012 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:55:59.280241 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."mart_hourly_demand"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m14:55:59.280659 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m14:55:59.281272 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."mart_hourly_demand"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m14:55:59.281800 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:59.282163 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:55:59.283817 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: ROLLBACK
[0m14:55:59.284727 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: ROLLBACK
[0m14:55:59.285473 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8'
[0m14:55:59.285941 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418'
[0m14:55:59.286337 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: Close
[0m14:55:59.286688 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: Close
[0m14:55:59.287331 [info ] [Thread-1 (]: 79 of 91 PASS not_null_mart_hourly_demand_is_weekend ........................... [[32mPASS[0m in 0.05s]
[0m14:55:59.288362 [info ] [Thread-2 (]: 80 of 91 PASS not_null_mart_hourly_demand_pickup_hour .......................... [[32mPASS[0m in 0.05s]
[0m14:55:59.288841 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m14:55:59.289434 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m14:55:59.378580 [debug] [Thread-3 (]: SQL status: OK in 0.131 seconds
[0m14:55:59.381460 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m14:55:59.381955 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
alter table "dev"."main"."mart_daily_revenue" rename to "mart_daily_revenue__dbt_backup"
[0m14:55:59.382649 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:55:59.384357 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m14:55:59.384705 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
alter table "dev"."main"."mart_daily_revenue__dbt_tmp" rename to "mart_daily_revenue"
[0m14:55:59.385222 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:55:59.386372 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: COMMIT
[0m14:55:59.386785 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m14:55:59.387314 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: COMMIT
[0m14:55:59.392782 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m14:55:59.394975 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m14:55:59.395463 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
drop table if exists "dev"."main"."mart_daily_revenue__dbt_backup" cascade
[0m14:55:59.398179 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:55:59.399114 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: Close
[0m14:55:59.399729 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb7f1911-2dd1-446e-af23-d570d9616a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7620901d3470>]}
[0m14:55:59.400262 [info ] [Thread-3 (]: 78 of 91 OK created sql table model main.mart_daily_revenue .................... [[32mOK[0m in 0.22s]
[0m14:55:59.400708 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m14:55:59.401533 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m14:55:59.401777 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m14:55:59.402023 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m14:55:59.402345 [info ] [Thread-1 (]: 81 of 91 START test not_null_mart_daily_revenue_date_key ....................... [RUN]
[0m14:55:59.403387 [info ] [Thread-2 (]: 82 of 91 START test not_null_mart_daily_revenue_total_revenue .................. [RUN]
[0m14:55:59.403932 [info ] [Thread-3 (]: 83 of 91 START test unique_mart_daily_revenue_date_key ......................... [RUN]
[0m14:55:59.404862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8, now test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a)
[0m14:55:59.405504 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418, now test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9)
[0m14:55:59.406023 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.mart_daily_revenue, now test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7)
[0m14:55:59.406506 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m14:55:59.406986 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m14:55:59.407325 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m14:55:59.410077 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m14:55:59.412741 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m14:55:59.415072 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m14:55:59.428272 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m14:55:59.428682 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m14:55:59.431595 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m14:55:59.431975 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m14:55:59.433260 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m14:55:59.435200 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m14:55:59.445313 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m14:55:59.445762 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m14:55:59.446022 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m14:55:59.446300 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: BEGIN
[0m14:55:59.446678 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: BEGIN
[0m14:55:59.447340 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: BEGIN
[0m14:55:59.447760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:59.448079 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:59.448646 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:55:59.449628 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:55:59.450459 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:55:59.450746 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m14:55:59.450979 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:55:59.451524 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m14:55:59.451925 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "dev"."main"."mart_daily_revenue"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m14:55:59.452262 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m14:55:59.452616 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "dev"."main"."mart_daily_revenue"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:55:59.453279 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "dev"."main"."mart_daily_revenue"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m14:55:59.453588 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:59.454424 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:55:59.454714 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:55:59.455904 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: ROLLBACK
[0m14:55:59.456782 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: ROLLBACK
[0m14:55:59.457670 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: ROLLBACK
[0m14:55:59.458203 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a'
[0m14:55:59.458726 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7'
[0m14:55:59.459421 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9'
[0m14:55:59.459625 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: Close
[0m14:55:59.460211 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: Close
[0m14:55:59.460750 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: Close
[0m14:55:59.461516 [info ] [Thread-1 (]: 81 of 91 PASS not_null_mart_daily_revenue_date_key ............................. [[32mPASS[0m in 0.06s]
[0m14:55:59.461957 [info ] [Thread-3 (]: 83 of 91 PASS unique_mart_daily_revenue_date_key ............................... [[32mPASS[0m in 0.06s]
[0m14:55:59.462394 [info ] [Thread-2 (]: 82 of 91 PASS not_null_mart_daily_revenue_total_revenue ........................ [[32mPASS[0m in 0.06s]
[0m14:55:59.462983 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m14:55:59.463427 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m14:55:59.464200 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m14:56:02.992743 [debug] [Thread-4 (]: SQL status: OK in 4.678 seconds
[0m14:56:02.997341 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m14:56:02.998166 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
alter table "dev"."main"."fct_trips" rename to "fct_trips__dbt_backup"
[0m14:56:02.999738 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:56:03.002905 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m14:56:03.003676 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
alter table "dev"."main"."fct_trips__dbt_tmp" rename to "fct_trips"
[0m14:56:03.004564 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:56:03.005797 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.fct_trips: COMMIT
[0m14:56:03.006226 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m14:56:03.006804 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.fct_trips: COMMIT
[0m14:56:03.403158 [debug] [Thread-4 (]: SQL status: OK in 0.396 seconds
[0m14:56:03.405477 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m14:56:03.406154 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
drop table if exists "dev"."main"."fct_trips__dbt_backup" cascade
[0m14:56:03.734139 [debug] [Thread-4 (]: SQL status: OK in 0.327 seconds
[0m14:56:03.735629 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.fct_trips: Close
[0m14:56:03.798219 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb7f1911-2dd1-446e-af23-d570d9616a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762103c7ce30>]}
[0m14:56:03.799367 [info ] [Thread-4 (]: 67 of 91 OK created sql incremental model main.fct_trips ....................... [[32mOK[0m in 5.59s]
[0m14:56:03.800006 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.fct_trips
[0m14:56:03.801287 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m14:56:03.801742 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m14:56:03.801989 [info ] [Thread-1 (]: 84 of 91 START test not_null_fct_trips_pickup_datetime ......................... [RUN]
[0m14:56:03.802294 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m14:56:03.802491 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m14:56:03.802744 [info ] [Thread-3 (]: 85 of 91 START test not_null_fct_trips_total_amount ............................ [RUN]
[0m14:56:03.803393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a, now test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83)
[0m14:56:03.803948 [info ] [Thread-2 (]: 86 of 91 START test not_null_fct_trips_trip_id ................................. [RUN]
[0m14:56:03.804337 [info ] [Thread-4 (]: 87 of 91 START test unique_fct_trips_trip_id ................................... [RUN]
[0m14:56:03.804787 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7, now test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d)
[0m14:56:03.805341 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m14:56:03.806035 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9, now test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d)
[0m14:56:03.806418 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.fct_trips, now test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab)
[0m14:56:03.806812 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m14:56:03.810283 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m14:56:03.810795 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m14:56:03.811177 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m14:56:03.813292 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m14:56:03.815805 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m14:56:03.819421 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m14:56:03.831442 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m14:56:03.831810 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m14:56:03.832294 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m14:56:03.834145 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m14:56:03.834517 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m14:56:03.836184 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m14:56:03.837720 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m14:56:03.839715 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m14:56:03.850303 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m14:56:03.850929 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m14:56:03.851224 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m14:56:03.851476 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: BEGIN
[0m14:56:03.851884 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: BEGIN
[0m14:56:03.852140 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m14:56:03.852365 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: BEGIN
[0m14:56:03.852792 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:56:03.853177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:03.853522 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: BEGIN
[0m14:56:03.853853 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:56:03.854724 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:56:03.872651 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m14:56:03.873166 [debug] [Thread-3 (]: SQL status: OK in 0.020 seconds
[0m14:56:03.873553 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m14:56:03.873850 [debug] [Thread-4 (]: SQL status: OK in 0.020 seconds
[0m14:56:03.874134 [debug] [Thread-2 (]: SQL status: OK in 0.019 seconds
[0m14:56:03.874364 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m14:56:03.874764 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "dev"."main"."fct_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m14:56:03.875174 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m14:56:03.875612 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m14:56:03.875927 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."fct_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m14:56:03.876497 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."main"."fct_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:56:03.876807 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:03.877019 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."fct_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m14:56:03.879016 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: ROLLBACK
[0m14:56:03.879374 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:56:03.879686 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:56:03.881621 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83'
[0m14:56:03.884720 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: ROLLBACK
[0m14:56:03.886211 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: ROLLBACK
[0m14:56:03.886744 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: Close
[0m14:56:03.887706 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d'
[0m14:56:03.890097 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d'
[0m14:56:03.891578 [info ] [Thread-1 (]: 84 of 91 PASS not_null_fct_trips_pickup_datetime ............................... [[32mPASS[0m in 0.09s]
[0m14:56:03.892846 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: Close
[0m14:56:03.894753 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: Close
[0m14:56:03.896481 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m14:56:03.897961 [info ] [Thread-3 (]: 85 of 91 PASS not_null_fct_trips_total_amount .................................. [[32mPASS[0m in 0.09s]
[0m14:56:03.899524 [info ] [Thread-2 (]: 86 of 91 PASS not_null_fct_trips_trip_id ....................................... [[32mPASS[0m in 0.09s]
[0m14:56:03.903476 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m14:56:03.905107 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m14:56:03.990849 [debug] [Thread-4 (]: SQL status: OK in 0.113 seconds
[0m14:56:03.992590 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: ROLLBACK
[0m14:56:03.993417 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab'
[0m14:56:03.993876 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: Close
[0m14:56:04.017733 [info ] [Thread-4 (]: 87 of 91 PASS unique_fct_trips_trip_id ......................................... [[32mPASS[0m in 0.21s]
[0m14:56:04.018503 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m14:56:04.019538 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.mart_location_performance
[0m14:56:04.019989 [info ] [Thread-1 (]: 88 of 91 START sql table model main.mart_location_performance .................. [RUN]
[0m14:56:04.020389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83, now model.nyc_taxi_pipeline_00.mart_location_performance)
[0m14:56:04.020766 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_location_performance
[0m14:56:04.023641 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m14:56:04.038367 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.mart_location_performance
[0m14:56:04.041032 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m14:56:04.041572 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Location-level performance summary.
    Uses adapter-dispatched mode_compat() for cross-dialect support.
*/

with trips as (
    select * from "dev"."main"."fct_trips"
),

final as (
    select
        pickup_location_id,
        pickup_borough,
        pickup_zone,

        count(*) as total_pickups,
        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue_per_trip,
        round(avg(tip_percentage), 2) as avg_tip_pct,
        round(avg(passenger_count), 2) as avg_passengers,

        -- most common dropoff destination
        
    mode(dropoff_zone)
 as most_common_dropoff_zone,

        -- busiest hour
        
    mode(pickup_hour)
 as peak_pickup_hour

    from trips
    where pickup_zone is not null
    group by pickup_location_id, pickup_borough, pickup_zone
)

select * from final
order by total_pickups desc
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:56:04.042001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:04.060964 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m14:56:04.062958 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m14:56:04.063390 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as varchar)
 as pickup_borough, 
      
    cast(null as varchar)
 as pickup_zone, 
      
    cast(null as bigint)
 as total_pickups, 
      
    cast(null as double)
 as avg_trip_distance, 
      
    cast(null as double)
 as avg_trip_duration_min, 
      
    cast(null as decimal(38,2))
 as total_revenue, 
      
    cast(null as double)
 as avg_revenue_per_trip, 
      
    cast(null as double)
 as avg_tip_pct, 
      
    cast(null as double)
 as avg_passengers, 
      
    cast(null as varchar)
 as most_common_dropoff_zone, 
      
    cast(null as bigint)
 as peak_pickup_hour
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:56:04.064130 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:56:04.065824 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m14:56:04.081664 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m14:56:04.082200 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: BEGIN
[0m14:56:04.083084 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:56:04.083528 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m14:56:04.084093 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_location_performance__dbt_tmp"
  
  (
    pickup_location_id integer,
    pickup_borough varchar,
    pickup_zone varchar,
    total_pickups bigint,
    avg_trip_distance double,
    avg_trip_duration_min double,
    total_revenue decimal(38,2),
    avg_revenue_per_trip double,
    avg_tip_pct double,
    avg_passengers double,
    most_common_dropoff_zone varchar,
    peak_pickup_hour bigint
    
    )
 ;
    insert into "dev"."main"."mart_location_performance__dbt_tmp" 
  (
    
      
      pickup_location_id ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      total_pickups ,
    
      
      avg_trip_distance ,
    
      
      avg_trip_duration_min ,
    
      
      total_revenue ,
    
      
      avg_revenue_per_trip ,
    
      
      avg_tip_pct ,
    
      
      avg_passengers ,
    
      
      most_common_dropoff_zone ,
    
      
      peak_pickup_hour 
    
  )
 (
      
    select pickup_location_id, pickup_borough, pickup_zone, total_pickups, avg_trip_distance, avg_trip_duration_min, total_revenue, avg_revenue_per_trip, avg_tip_pct, avg_passengers, most_common_dropoff_zone, peak_pickup_hour
    from (
        /*
    Analytics mart: Location-level performance summary.
    Uses adapter-dispatched mode_compat() for cross-dialect support.
*/

with trips as (
    select * from "dev"."main"."fct_trips"
),

final as (
    select
        pickup_location_id,
        pickup_borough,
        pickup_zone,

        count(*) as total_pickups,
        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue_per_trip,
        round(avg(tip_percentage), 2) as avg_tip_pct,
        round(avg(passenger_count), 2) as avg_passengers,

        -- most common dropoff destination
        
    mode(dropoff_zone)
 as most_common_dropoff_zone,

        -- busiest hour
        
    mode(pickup_hour)
 as peak_pickup_hour

    from trips
    where pickup_zone is not null
    group by pickup_location_id, pickup_borough, pickup_zone
)

select * from final
order by total_pickups desc
    ) as model_subq
    );
  
  
[0m14:56:04.189932 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m14:56:04.192368 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m14:56:04.192755 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
alter table "dev"."main"."mart_location_performance" rename to "mart_location_performance__dbt_backup"
[0m14:56:04.193383 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:56:04.195190 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m14:56:04.195519 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
alter table "dev"."main"."mart_location_performance__dbt_tmp" rename to "mart_location_performance"
[0m14:56:04.195998 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:56:04.196787 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: COMMIT
[0m14:56:04.197086 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m14:56:04.197560 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: COMMIT
[0m14:56:04.204794 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m14:56:04.207617 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m14:56:04.208100 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
drop table if exists "dev"."main"."mart_location_performance__dbt_backup" cascade
[0m14:56:04.210711 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:56:04.211842 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: Close
[0m14:56:04.263413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb7f1911-2dd1-446e-af23-d570d9616a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762091753c20>]}
[0m14:56:04.264422 [info ] [Thread-1 (]: 88 of 91 OK created sql table model main.mart_location_performance ............. [[32mOK[0m in 0.24s]
[0m14:56:04.264940 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.mart_location_performance
[0m14:56:04.266298 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m14:56:04.266562 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m14:56:04.266824 [info ] [Thread-2 (]: 89 of 91 START test not_null_mart_location_performance_pickup_location_id ...... [RUN]
[0m14:56:04.267146 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m14:56:04.267568 [info ] [Thread-4 (]: 90 of 91 START test not_null_mart_location_performance_total_pickups ........... [RUN]
[0m14:56:04.268076 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d, now test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c)
[0m14:56:04.268449 [info ] [Thread-3 (]: 91 of 91 START test unique_mart_location_performance_pickup_location_id ........ [RUN]
[0m14:56:04.268902 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab, now test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259)
[0m14:56:04.269328 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m14:56:04.269702 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d, now test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62)
[0m14:56:04.270148 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m14:56:04.273144 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m14:56:04.273875 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m14:56:04.276707 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m14:56:04.279641 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m14:56:04.289300 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m14:56:04.289775 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m14:56:04.290055 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m14:56:04.291743 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m14:56:04.293446 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m14:56:04.294953 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m14:56:04.306990 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m14:56:04.307467 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m14:56:04.307735 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: BEGIN
[0m14:56:04.308144 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m14:56:04.308350 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: BEGIN
[0m14:56:04.308739 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:56:04.309435 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: BEGIN
[0m14:56:04.309969 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:56:04.311084 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:56:04.328481 [debug] [Thread-4 (]: SQL status: OK in 0.020 seconds
[0m14:56:04.328889 [debug] [Thread-3 (]: SQL status: OK in 0.018 seconds
[0m14:56:04.329114 [debug] [Thread-2 (]: SQL status: OK in 0.019 seconds
[0m14:56:04.329343 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m14:56:04.329697 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m14:56:04.330057 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m14:56:04.330365 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_pickups
from "dev"."main"."mart_location_performance"
where total_pickups is null



  
  
      
    ) dbt_internal_test
[0m14:56:04.330666 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pickup_location_id as unique_field,
    count(*) as n_records

from "dev"."main"."mart_location_performance"
where pickup_location_id is not null
group by pickup_location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:56:04.331063 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_location_id
from "dev"."main"."mart_location_performance"
where pickup_location_id is null



  
  
      
    ) dbt_internal_test
[0m14:56:04.332228 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:56:04.333854 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: ROLLBACK
[0m14:56:04.334184 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:56:04.334537 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:56:04.335120 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259'
[0m14:56:04.336076 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: ROLLBACK
[0m14:56:04.336883 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: ROLLBACK
[0m14:56:04.337073 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: Close
[0m14:56:04.337693 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c'
[0m14:56:04.338132 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62'
[0m14:56:04.338748 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: Close
[0m14:56:04.338527 [info ] [Thread-4 (]: 90 of 91 PASS not_null_mart_location_performance_total_pickups ................. [[32mPASS[0m in 0.07s]
[0m14:56:04.339141 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: Close
[0m14:56:04.339579 [info ] [Thread-2 (]: 89 of 91 PASS not_null_mart_location_performance_pickup_location_id ............ [[32mPASS[0m in 0.07s]
[0m14:56:04.339910 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m14:56:04.340550 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m14:56:04.342683 [info ] [Thread-3 (]: 91 of 91 PASS unique_mart_location_performance_pickup_location_id .............. [[32mPASS[0m in 0.07s]
[0m14:56:04.343209 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m14:56:04.344817 [debug] [MainThread]: Using duckdb connection "master"
[0m14:56:04.345177 [debug] [MainThread]: On master: BEGIN
[0m14:56:04.345528 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:56:04.364618 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m14:56:04.365165 [debug] [MainThread]: On master: COMMIT
[0m14:56:04.365597 [debug] [MainThread]: Using duckdb connection "master"
[0m14:56:04.365979 [debug] [MainThread]: On master: COMMIT
[0m14:56:04.366570 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:56:04.366957 [debug] [MainThread]: On master: Close
[0m14:56:04.369877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:56:04.370405 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m14:56:04.370720 [debug] [MainThread]: Connection 'model.nyc_taxi_pipeline_00.mart_location_performance' was properly closed.
[0m14:56:04.370970 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c' was properly closed.
[0m14:56:04.371192 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62' was properly closed.
[0m14:56:04.371391 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259' was properly closed.
[0m14:56:04.371825 [info ] [MainThread]: 
[0m14:56:04.372202 [info ] [MainThread]: Finished running 1 incremental model, 3 seeds, 7 table models, 74 data tests, 6 view models in 0 hours 0 minutes and 9.34 seconds (9.34s).
[0m14:56:04.377399 [debug] [MainThread]: Command end result
[0m14:56:04.418360 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:56:04.423255 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:56:04.445382 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m14:56:04.445830 [info ] [MainThread]: 
[0m14:56:04.446376 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:56:04.446772 [info ] [MainThread]: 
[0m14:56:04.447127 [info ] [MainThread]: Done. PASS=91 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=91
[0m14:56:04.448396 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 10.662831, "process_in_blocks": "86376", "process_kernel_time": 3.8634, "process_mem_max_rss": "1784524", "process_out_blocks": "136", "process_user_time": 19.57804}
[0m14:56:04.449284 [debug] [MainThread]: Command `dbt build` succeeded at 14:56:04.449163 after 10.66 seconds
[0m14:56:04.450147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762104169370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7620801b0920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7620901b2030>]}
[0m14:56:04.450776 [debug] [MainThread]: Flushing usage events
[0m14:56:04.716155 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:58:09.756118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7165989dd820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71659adca360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716598a10c80>]}


============================== 21:58:09.764253 | e5890a57-2b5b-4dad-b31d-5c3b6085034b ==============================
[0m21:58:09.764253 [info ] [MainThread]: Running with dbt=1.11.4
[0m21:58:09.765041 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'empty': 'None', 'no_print': 'None', 'target_path': 'None', 'profiles_dir': '.', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'quiet': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'printer_width': '80', 'log_path': '/dbt/logs', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'version_check': 'True', 'write_json': 'True', 'invocation_command': 'dbt deps --profiles-dir .'}
[0m21:58:09.857446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5890a57-2b5b-4dad-b31d-5c3b6085034b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7165982f7b30>]}
[0m21:58:10.128857 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-sxe1uju8'
[0m21:58:10.129521 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:58:10.448838 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:58:10.450180 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:58:10.541029 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:58:10.544081 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:58:14.706136 [info ] [MainThread]: Installed from version 1.3.3
[0m21:58:14.706810 [info ] [MainThread]: Up to date!
[0m21:58:14.707417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e5890a57-2b5b-4dad-b31d-5c3b6085034b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71659873ff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71659805aba0>]}
[0m21:58:14.709345 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 3.9501565, "process_in_blocks": "105256", "process_kernel_time": 0.863803, "process_mem_max_rss": "105088", "process_out_blocks": "176", "process_user_time": 1.05713}
[0m21:58:14.709980 [debug] [MainThread]: Command `dbt deps` succeeded at 21:58:14.709872 after 3.95 seconds
[0m21:58:14.710446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716598237c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716599126a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7165982740b0>]}
[0m21:58:14.710837 [debug] [MainThread]: Flushing usage events
[0m21:58:15.047151 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:58:15.987779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74eea5939640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74eea5ffeed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74eea5ffedb0>]}


============================== 21:58:15.990453 | 3c8ce2c5-1c6d-497c-9be8-24ed718e61c6 ==============================
[0m21:58:15.990453 [info ] [MainThread]: Running with dbt=1.11.4
[0m21:58:15.991332 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'log_path': '/dbt/logs', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --full-refresh --profiles-dir .', 'quiet': 'False', 'partial_parse': 'True', 'no_print': 'None', 'static_parser': 'True', 'version_check': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'log_cache_events': 'False', 'profiles_dir': '.', 'cache_selected_only': 'False', 'use_colors': 'True', 'debug': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'printer_width': '80'}
[0m21:58:16.188309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c8ce2c5-1c6d-497c-9be8-24ed718e61c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74eea50300b0>]}
[0m21:58:16.222238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c8ce2c5-1c6d-497c-9be8-24ed718e61c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74eea7550110>]}
[0m21:58:16.224009 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m21:58:16.277970 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m21:58:16.977408 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:58:16.977819 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:58:16.978269 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:58:17.010065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c8ce2c5-1c6d-497c-9be8-24ed718e61c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ee954bb380>]}
[0m21:58:17.085055 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m21:58:17.089388 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m21:58:17.125293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c8ce2c5-1c6d-497c-9be8-24ed718e61c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ee94efaae0>]}
[0m21:58:17.125744 [info ] [MainThread]: Found 14 models, 74 data tests, 3 seeds, 1 source, 578 macros
[0m21:58:17.129577 [info ] [MainThread]: 
[0m21:58:17.130008 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:58:17.130338 [info ] [MainThread]: 
[0m21:58:17.130864 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:58:17.134172 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m21:58:17.230488 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m21:58:17.231072 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m21:58:17.231760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:17.262139 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m21:58:17.263690 [debug] [ThreadPool]: On list_dev: Close
[0m21:58:17.268209 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m21:58:17.268851 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m21:58:17.272558 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m21:58:17.273173 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m21:58:17.273537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:58:17.288841 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m21:58:17.290153 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m21:58:17.290506 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m21:58:17.290924 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:58:17.291197 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m21:58:17.291409 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m21:58:17.291762 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:58:17.292448 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m21:58:17.292856 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m21:58:17.293130 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m21:58:17.293750 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:58:17.294199 [debug] [ThreadPool]: On create_dev_main: Close
[0m21:58:17.297622 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m21:58:17.300931 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m21:58:17.301307 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m21:58:17.301547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:58:17.313991 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m21:58:17.314363 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m21:58:17.314647 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m21:58:17.321511 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m21:58:17.322645 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m21:58:17.323809 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m21:58:17.324104 [debug] [ThreadPool]: On list_dev_main: Close
[0m21:58:17.327871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c8ce2c5-1c6d-497c-9be8-24ed718e61c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ee954bb710>]}
[0m21:58:17.328512 [debug] [MainThread]: Using duckdb connection "master"
[0m21:58:17.328786 [debug] [MainThread]: On master: BEGIN
[0m21:58:17.329024 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:58:17.347696 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m21:58:17.348168 [debug] [MainThread]: On master: COMMIT
[0m21:58:17.348430 [debug] [MainThread]: Using duckdb connection "master"
[0m21:58:17.348627 [debug] [MainThread]: On master: COMMIT
[0m21:58:17.348936 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:58:17.349161 [debug] [MainThread]: On master: Close
[0m21:58:17.356238 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.dim_dates
[0m21:58:17.356458 [debug] [Thread-2 (]: Began running node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m21:58:17.356690 [debug] [Thread-3 (]: Began running node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m21:58:17.356974 [info ] [Thread-1 (]: 1 of 91 START sql table model main.dim_dates ................................... [RUN]
[0m21:58:17.357645 [info ] [Thread-2 (]: 2 of 91 START sql table model main.stg_yellow_trips ............................ [RUN]
[0m21:58:17.357959 [debug] [Thread-4 (]: Began running node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m21:58:17.358459 [info ] [Thread-3 (]: 3 of 91 START seed file main.payment_type_lookup ............................... [RUN]
[0m21:58:17.359319 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nyc_taxi_pipeline_00.dim_dates'
[0m21:58:17.359719 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.nyc_taxi_pipeline_00.stg_yellow_trips'
[0m21:58:17.360603 [info ] [Thread-4 (]: 4 of 91 START seed file main.rate_code_lookup .................................. [RUN]
[0m21:58:17.361073 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.nyc_taxi_pipeline_00.payment_type_lookup'
[0m21:58:17.361514 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_dates
[0m21:58:17.361972 [debug] [Thread-2 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m21:58:17.362448 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.nyc_taxi_pipeline_00.rate_code_lookup'
[0m21:58:17.362857 [debug] [Thread-3 (]: Began compiling node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m21:58:17.379287 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m21:58:17.383294 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m21:58:17.383555 [debug] [Thread-4 (]: Began compiling node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m21:58:17.383960 [debug] [Thread-3 (]: Began executing node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m21:58:17.384377 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: BEGIN
[0m21:58:17.384905 [debug] [Thread-4 (]: Began executing node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m21:58:17.392622 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:58:17.395491 [debug] [Thread-2 (]: Began executing node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m21:58:17.412202 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m21:58:17.412730 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m21:58:17.413076 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m21:58:17.413460 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */


        select 
        (date_diff('day', cast('2024-01-01' as date)::timestamp, cast('2024-02-01' as date)::timestamp ))
    
[0m21:58:17.417797 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m21:58:17.419155 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m21:58:17.419691 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.payment_type_lookup"} */
drop table if exists "dev"."main"."payment_type_lookup" cascade
[0m21:58:17.420052 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.rate_code_lookup"} */
drop table if exists "dev"."main"."rate_code_lookup" cascade
[0m21:58:17.420369 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:17.420549 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:58:17.420868 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:58:17.427509 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_dates"
[0m21:58:17.429016 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m21:58:17.429341 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: BEGIN
[0m21:58:17.429614 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:58:17.430201 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:58:17.430495 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m21:58:17.430832 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */

  
    
    

    create  table
      "dev"."main"."stg_yellow_trips__dbt_tmp"
  
    as (
      

with source as (
    select * from read_parquet('/data/yellow_tripdata_2024-01.parquet')
),

renamed as (
    select
        -- surrogate key (MD5 hash of composite key)
        md5(cast(coalesce(cast(VendorID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(PULocationID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DOLocationID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(fare_amount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(total_amount as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- identifiers
        cast("VendorID" as integer) as vendor_id,
        cast("RatecodeID" as integer) as rate_code_id,
        cast("PULocationID" as integer) as pickup_location_id,
        cast("DOLocationID" as integer) as dropoff_location_id,
        cast(payment_type as integer) as payment_type_id,

        -- timestamps
        cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
        cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as double) as trip_distance_miles,
        store_and_fwd_flag,

        -- financials
        round(cast(fare_amount as decimal(10, 2)), 2) as fare_amount,
        round(cast(extra as decimal(10, 2)), 2) as extra_amount,
        round(cast(mta_tax as decimal(10, 2)), 2) as mta_tax,
        round(cast(tip_amount as decimal(10, 2)), 2) as tip_amount,
        round(cast(tolls_amount as decimal(10, 2)), 2) as tolls_amount,
        round(cast(improvement_surcharge as decimal(10, 2)), 2) as improvement_surcharge,
        round(cast(total_amount as decimal(10, 2)), 2) as total_amount,
        round(cast(congestion_surcharge as decimal(10, 2)), 2) as congestion_surcharge,
        round(cast(Airport_fee as decimal(10, 2)), 2) as airport_fee

    from source
    where tpep_pickup_datetime is not null
      and tpep_dropoff_datetime is not null
      and trip_distance >= 0
      and fare_amount >= 0
      -- filter out-of-range dates (data quality: ~18 trips outside Jan 2024)
      and cast(tpep_pickup_datetime as date) >= date '2024-01-01'
      and cast(tpep_pickup_datetime as date) < date '2024-02-01'
)

select * from renamed
    );
  
  
[0m21:58:17.433228 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m21:58:17.437084 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m21:58:17.437474 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: BEGIN
[0m21:58:17.437677 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m21:58:17.438146 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m21:58:17.438833 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m21:58:17.439100 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.dim_dates
[0m21:58:17.439301 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m21:58:17.439647 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: BEGIN
[0m21:58:17.450616 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m21:58:17.450976 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.payment_type_lookup"} */

    create table "dev"."main"."payment_type_lookup" ("payment_type_id" integer,"payment_type_name" varchar)
  
[0m21:58:17.451829 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
DESCRIBE (select * from (
        /*
    Dimension table: Calendar dates for January 2024.
    Uses adapter-dispatched macros for dayname/monthname.
*/

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 31
    order by generated_number



),

all_periods as (

    select (
        

    date_add(cast('2024-01-01' as date), interval (row_number() over (order by generated_number) - 1) day)


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-02-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week_num,
        
    dayname(date_day)
 as day_of_week_name,
        
    monthname(date_day)
 as month_name,
        extract(week from date_day) as week_of_year,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when cast(date_day as date) in (
                cast('2024-01-01' as date),
                cast('2024-01-15' as date)
            ) then true
            else false
        end as is_holiday

    from date_spine
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m21:58:17.452143 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:58:17.453187 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m21:58:17.455008 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m21:58:17.462462 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m21:58:17.463225 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m21:58:17.463534 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.rate_code_lookup"} */

    create table "dev"."main"."rate_code_lookup" ("rate_code_id" integer,"rate_code_name" varchar)
  
[0m21:58:17.463991 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: 
          COPY "dev"."main"."payment_type_lookup" FROM '/dbt/seeds/payment_type_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m21:58:17.473921 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m21:58:17.474607 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m21:58:17.474866 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as date_key, 
      
    cast(null as bigint)
 as year, 
      
    cast(null as bigint)
 as month, 
      
    cast(null as bigint)
 as day_of_month, 
      
    cast(null as bigint)
 as day_of_week_num, 
      
    cast(null as varchar)
 as day_of_week_name, 
      
    cast(null as varchar)
 as month_name, 
      
    cast(null as bigint)
 as week_of_year, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as boolean)
 as is_holiday
    ) as __dbt_sbq
    where false
    limit 0
)
[0m21:58:17.476108 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m21:58:17.477675 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: 
          COPY "dev"."main"."rate_code_lookup" FROM '/dbt/seeds/rate_code_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m21:58:17.478354 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:17.491891 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_dates"
[0m21:58:17.492227 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m21:58:17.495299 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m21:58:17.495700 [debug] [Thread-3 (]: SQL status: OK in 0.021 seconds
[0m21:58:17.496361 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m21:58:17.501400 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m21:58:17.510381 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: COMMIT
[0m21:58:17.510748 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_dates__dbt_tmp"
  
  (
    date_key date,
    year bigint,
    month bigint,
    day_of_month bigint,
    day_of_week_num bigint,
    day_of_week_name varchar,
    month_name varchar,
    week_of_year bigint,
    is_weekend boolean,
    is_holiday boolean
    
    )
 ;
    insert into "dev"."main"."dim_dates__dbt_tmp" 
  (
    
      
      date_key ,
    
      
      year ,
    
      
      month ,
    
      
      day_of_month ,
    
      
      day_of_week_num ,
    
      
      day_of_week_name ,
    
      
      month_name ,
    
      
      week_of_year ,
    
      
      is_weekend ,
    
      
      is_holiday 
    
  )
 (
      
    select date_key, year, month, day_of_month, day_of_week_num, day_of_week_name, month_name, week_of_year, is_weekend, is_holiday
    from (
        /*
    Dimension table: Calendar dates for January 2024.
    Uses adapter-dispatched macros for dayname/monthname.
*/

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 31
    order by generated_number



),

all_periods as (

    select (
        

    date_add(cast('2024-01-01' as date), interval (row_number() over (order by generated_number) - 1) day)


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-02-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week_num,
        
    dayname(date_day)
 as day_of_week_name,
        
    monthname(date_day)
 as month_name,
        extract(week from date_day) as week_of_year,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when cast(date_day as date) in (
                cast('2024-01-01' as date),
                cast('2024-01-15' as date)
            ) then true
            else false
        end as is_holiday

    from date_spine
)

select * from final
    ) as model_subq
    );
  
  
[0m21:58:17.511611 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m21:58:17.513804 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: COMMIT
[0m21:58:17.514114 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: COMMIT
[0m21:58:17.514608 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m21:58:17.515592 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: COMMIT
[0m21:58:17.518695 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m21:58:17.520314 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: Close
[0m21:58:17.522031 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m21:58:17.522853 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: Close
[0m21:58:17.523154 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c8ce2c5-1c6d-497c-9be8-24ed718e61c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ee3544e5a0>]}
[0m21:58:17.523772 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c8ce2c5-1c6d-497c-9be8-24ed718e61c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ee353a1d00>]}
[0m21:58:17.524413 [info ] [Thread-4 (]: 4 of 91 OK loaded seed file main.rate_code_lookup .............................. [[32mCREATE 7[0m in 0.16s]
[0m21:58:17.524986 [info ] [Thread-3 (]: 3 of 91 OK loaded seed file main.payment_type_lookup ........................... [[32mCREATE 6[0m in 0.16s]
[0m21:58:17.525781 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m21:58:17.526175 [debug] [Thread-4 (]: Finished running node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m21:58:17.526528 [debug] [Thread-3 (]: Finished running node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m21:58:17.529983 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m21:58:17.530421 [debug] [Thread-4 (]: Began running node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m21:58:17.531016 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m21:58:17.531563 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
alter table "dev"."main"."dim_dates" rename to "dim_dates__dbt_backup"
[0m21:58:17.532091 [info ] [Thread-4 (]: 5 of 91 START seed file main.taxi_zone_lookup .................................. [RUN]
[0m21:58:17.532725 [info ] [Thread-3 (]: 6 of 91 START test not_null_rate_code_lookup_rate_code_id ...................... [RUN]
[0m21:58:17.533914 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.rate_code_lookup, now seed.nyc_taxi_pipeline_00.taxi_zone_lookup)
[0m21:58:17.534183 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:17.534521 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.payment_type_lookup, now test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec)
[0m21:58:17.534954 [debug] [Thread-4 (]: Began compiling node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m21:58:17.536809 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m21:58:17.537541 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m21:58:17.538213 [debug] [Thread-4 (]: Began executing node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m21:58:17.538793 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
alter table "dev"."main"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m21:58:17.545027 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m21:58:17.546739 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:58:17.547827 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: COMMIT
[0m21:58:17.548647 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m21:58:17.549064 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: COMMIT
[0m21:58:17.553251 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m21:58:17.553689 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:58:17.554132 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"} */
drop table if exists "dev"."main"."taxi_zone_lookup" cascade
[0m21:58:17.556806 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m21:58:17.557289 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m21:58:17.557785 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:58:17.558434 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
drop table if exists "dev"."main"."dim_dates__dbt_backup" cascade
[0m21:58:17.568408 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m21:58:17.572645 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m21:58:17.574185 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m21:58:17.574553 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:58:17.574904 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: BEGIN
[0m21:58:17.576691 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: Close
[0m21:58:17.577782 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m21:58:17.578513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c8ce2c5-1c6d-497c-9be8-24ed718e61c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ee3544fcb0>]}
[0m21:58:17.578962 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m21:58:17.579325 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m21:58:17.580187 [info ] [Thread-1 (]: 1 of 91 OK created sql table model main.dim_dates .............................. [[32mOK[0m in 0.22s]
[0m21:58:17.581049 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"} */

    create table "dev"."main"."taxi_zone_lookup" ("LocationID" integer,"Borough" varchar,"Zone" varchar,"service_zone" varchar)
  
[0m21:58:17.581663 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: BEGIN
[0m21:58:17.582263 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.dim_dates
[0m21:58:17.583072 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:17.583523 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:58:17.583847 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m21:58:17.584930 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:58:17.586009 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m21:58:17.586608 [info ] [Thread-1 (]: 7 of 91 START test unique_rate_code_lookup_rate_code_id ........................ [RUN]
[0m21:58:17.587101 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m21:58:17.587670 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: 
          COPY "dev"."main"."taxi_zone_lookup" FROM '/dbt/seeds/taxi_zone_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m21:58:17.588330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_dates, now test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d)
[0m21:58:17.588871 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_id
from "dev"."main"."rate_code_lookup"
where rate_code_id is null



  
  
      
    ) dbt_internal_test
[0m21:58:17.589869 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m21:58:17.594653 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m21:58:17.595153 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m21:58:17.598643 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: ROLLBACK
[0m21:58:17.598977 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m21:58:17.599663 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec'
[0m21:58:17.600310 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m21:58:17.600770 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: Close
[0m21:58:17.602357 [info ] [Thread-3 (]: 6 of 91 PASS not_null_rate_code_lookup_rate_code_id ............................ [[32mPASS[0m in 0.07s]
[0m21:58:17.603155 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m21:58:17.603643 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m21:58:17.604117 [info ] [Thread-3 (]: 8 of 91 START test not_null_payment_type_lookup_payment_type_id ................ [RUN]
[0m21:58:17.604684 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec, now test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521)
[0m21:58:17.604950 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m21:58:17.605245 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m21:58:17.607289 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m21:58:17.609871 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m21:58:17.611836 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: COMMIT
[0m21:58:17.612328 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m21:58:17.612819 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: COMMIT
[0m21:58:17.616655 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m21:58:17.617131 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m21:58:17.617649 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: BEGIN
[0m21:58:17.618072 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m21:58:17.620287 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m21:58:17.620729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:17.621500 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: Close
[0m21:58:17.622619 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:58:17.623220 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c8ce2c5-1c6d-497c-9be8-24ed718e61c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ee353ad8e0>]}
[0m21:58:17.623556 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m21:58:17.624296 [info ] [Thread-4 (]: 5 of 91 OK loaded seed file main.taxi_zone_lookup .............................. [[32mCREATE 265[0m in 0.09s]
[0m21:58:17.624955 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rate_code_id as unique_field,
    count(*) as n_records

from "dev"."main"."rate_code_lookup"
where rate_code_id is not null
group by rate_code_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:58:17.625743 [debug] [Thread-4 (]: Finished running node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m21:58:17.626611 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m21:58:17.627182 [info ] [Thread-4 (]: 9 of 91 START test unique_payment_type_lookup_payment_type_id .................. [RUN]
[0m21:58:17.627747 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.taxi_zone_lookup, now test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7)
[0m21:58:17.628261 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:58:17.628622 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m21:58:17.630158 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: ROLLBACK
[0m21:58:17.633058 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m21:58:17.633643 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m21:58:17.634644 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d'
[0m21:58:17.635651 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: BEGIN
[0m21:58:17.636016 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: Close
[0m21:58:17.636327 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:17.636862 [info ] [Thread-1 (]: 7 of 91 PASS unique_rate_code_lookup_rate_code_id .............................. [[32mPASS[0m in 0.05s]
[0m21:58:17.637436 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:58:17.637965 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m21:58:17.638477 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m21:58:17.639144 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m21:58:17.639765 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."payment_type_lookup"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m21:58:17.640359 [info ] [Thread-1 (]: 10 of 91 START test not_null_dim_dates_date_key ................................ [RUN]
[0m21:58:17.641575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d, now test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348)
[0m21:58:17.641980 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:58:17.642315 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m21:58:17.642722 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m21:58:17.644134 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: ROLLBACK
[0m21:58:17.647487 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m21:58:17.650446 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m21:58:17.651490 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521'
[0m21:58:17.652707 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: Close
[0m21:58:17.653464 [info ] [Thread-3 (]: 8 of 91 PASS not_null_payment_type_lookup_payment_type_id ...................... [[32mPASS[0m in 0.05s]
[0m21:58:17.654204 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m21:58:17.654724 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m21:58:17.655182 [info ] [Thread-3 (]: 11 of 91 START test not_null_dim_dates_day_of_week_name ........................ [RUN]
[0m21:58:17.655751 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521, now test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541)
[0m21:58:17.656125 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m21:58:17.659591 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m21:58:17.660928 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m21:58:17.661307 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m21:58:17.663514 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m21:58:17.664181 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: BEGIN
[0m21:58:17.664952 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:58:17.665548 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m21:58:17.665921 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:58:17.668371 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m21:58:17.669135 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m21:58:17.670055 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."payment_type_lookup"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:58:17.671382 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:58:17.672639 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: ROLLBACK
[0m21:58:17.673877 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7'
[0m21:58:17.674682 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: Close
[0m21:58:17.675048 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m21:58:17.675594 [info ] [Thread-4 (]: 9 of 91 PASS unique_payment_type_lookup_payment_type_id ........................ [[32mPASS[0m in 0.05s]
[0m21:58:17.675852 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: BEGIN
[0m21:58:17.676297 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m21:58:17.676619 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m21:58:17.676977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:17.677328 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: BEGIN
[0m21:58:17.677798 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m21:58:17.678660 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:58:17.678895 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:17.679327 [info ] [Thread-4 (]: 12 of 91 START test not_null_dim_dates_is_holiday .............................. [RUN]
[0m21:58:17.679765 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m21:58:17.680558 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:58:17.680865 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7, now test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a)
[0m21:58:17.681288 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "dev"."main"."dim_dates"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m21:58:17.682085 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m21:58:17.682767 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m21:58:17.683752 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select day_of_week_name
from "dev"."main"."dim_dates"
where day_of_week_name is null



  
  
      
    ) dbt_internal_test
[0m21:58:17.684238 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:17.686982 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m21:58:17.689234 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: ROLLBACK
[0m21:58:17.689684 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:58:17.690822 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348'
[0m21:58:17.692171 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: ROLLBACK
[0m21:58:17.692480 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: Close
[0m21:58:17.693245 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541'
[0m21:58:17.693833 [info ] [Thread-1 (]: 10 of 91 PASS not_null_dim_dates_date_key ...................................... [[32mPASS[0m in 0.05s]
[0m21:58:17.694090 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: Close
[0m21:58:17.694653 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m21:58:17.695322 [info ] [Thread-3 (]: 11 of 91 PASS not_null_dim_dates_day_of_week_name .............................. [[32mPASS[0m in 0.04s]
[0m21:58:17.695673 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m21:58:17.696281 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m21:58:17.696821 [info ] [Thread-1 (]: 13 of 91 START test not_null_dim_dates_is_weekend .............................. [RUN]
[0m21:58:17.697440 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m21:58:17.698406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348, now test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0)
[0m21:58:17.698914 [info ] [Thread-3 (]: 14 of 91 START test unique_dim_dates_date_key .................................. [RUN]
[0m21:58:17.699275 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m21:58:17.699638 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m21:58:17.700220 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541, now test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d)
[0m21:58:17.702557 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m21:58:17.706095 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m21:58:17.706560 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m21:58:17.710234 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m21:58:17.715161 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m21:58:17.717510 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m21:58:17.718052 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m21:58:17.718870 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: BEGIN
[0m21:58:17.719187 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m21:58:17.719475 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:58:17.723209 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m21:58:17.724240 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m21:58:17.724664 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m21:58:17.724978 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_holiday
from "dev"."main"."dim_dates"
where is_holiday is null



  
  
      
    ) dbt_internal_test
[0m21:58:17.725924 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:58:17.727221 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: ROLLBACK
[0m21:58:17.728033 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a'
[0m21:58:17.728612 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: Close
[0m21:58:17.729190 [info ] [Thread-4 (]: 12 of 91 PASS not_null_dim_dates_is_holiday .................................... [[32mPASS[0m in 0.05s]
[0m21:58:17.729534 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m21:58:17.729966 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m21:58:17.730253 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m21:58:17.730475 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: BEGIN
[0m21:58:17.731064 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m21:58:17.731865 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: BEGIN
[0m21:58:17.732665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:17.733261 [info ] [Thread-4 (]: 15 of 91 START test not_null_taxi_zone_lookup_Borough .......................... [RUN]
[0m21:58:17.733764 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:17.734681 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a, now test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa)
[0m21:58:17.735067 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:58:17.735710 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:58:17.736120 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m21:58:17.736705 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m21:58:17.737228 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m21:58:17.739851 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m21:58:17.740461 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."dim_dates"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m21:58:17.740948 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "dev"."main"."dim_dates"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:58:17.742549 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:17.742868 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:58:17.744041 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: ROLLBACK
[0m21:58:17.745199 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: ROLLBACK
[0m21:58:17.745832 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0'
[0m21:58:17.746967 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d'
[0m21:58:17.747342 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: Close
[0m21:58:17.748078 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: Close
[0m21:58:17.748857 [info ] [Thread-1 (]: 13 of 91 PASS not_null_dim_dates_is_weekend .................................... [[32mPASS[0m in 0.05s]
[0m21:58:17.749406 [info ] [Thread-3 (]: 14 of 91 PASS unique_dim_dates_date_key ........................................ [[32mPASS[0m in 0.05s]
[0m21:58:17.749852 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m21:58:17.750328 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m21:58:17.750855 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m21:58:17.751489 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m21:58:17.752003 [info ] [Thread-1 (]: 16 of 91 START test not_null_taxi_zone_lookup_LocationID ....................... [RUN]
[0m21:58:17.752307 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m21:58:17.752845 [info ] [Thread-3 (]: 17 of 91 START test unique_taxi_zone_lookup_LocationID ......................... [RUN]
[0m21:58:17.753424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0, now test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a)
[0m21:58:17.755455 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m21:58:17.755901 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d, now test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8)
[0m21:58:17.756267 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m21:58:17.757027 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m21:58:17.759732 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m21:58:17.763413 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m21:58:17.765702 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m21:58:17.766292 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: BEGIN
[0m21:58:17.766688 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:58:17.767583 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:58:17.767966 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m21:58:17.768369 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Borough
from "dev"."main"."taxi_zone_lookup"
where Borough is null



  
  
      
    ) dbt_internal_test
[0m21:58:17.769097 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m21:58:17.769368 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:58:17.770891 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m21:58:17.771162 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m21:58:17.772781 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: ROLLBACK
[0m21:58:17.774301 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m21:58:17.775238 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa'
[0m21:58:17.776172 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: Close
[0m21:58:17.776917 [info ] [Thread-4 (]: 15 of 91 PASS not_null_taxi_zone_lookup_Borough ................................ [[32mPASS[0m in 0.04s]
[0m21:58:17.777512 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m21:58:17.778026 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m21:58:17.778606 [info ] [Thread-4 (]: 18 of 91 START sql view model main.stg_rate_codes .............................. [RUN]
[0m21:58:17.779086 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa, now model.nyc_taxi_pipeline_00.stg_rate_codes)
[0m21:58:17.779406 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m21:58:17.781932 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m21:58:17.783051 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m21:58:17.783403 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m21:58:17.783670 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: BEGIN
[0m21:58:17.784146 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: BEGIN
[0m21:58:17.784542 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:17.785121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:17.785995 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:58:17.786511 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:17.786745 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m21:58:17.787165 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m21:58:17.787743 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    LocationID as unique_field,
    count(*) as n_records

from "dev"."main"."taxi_zone_lookup"
where LocationID is not null
group by LocationID
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:58:17.788288 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select LocationID
from "dev"."main"."taxi_zone_lookup"
where LocationID is null



  
  
      
    ) dbt_internal_test
[0m21:58:17.789821 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:58:17.790226 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m21:58:17.791664 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: ROLLBACK
[0m21:58:17.792097 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:58:17.803791 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m21:58:17.804819 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8'
[0m21:58:17.806065 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: ROLLBACK
[0m21:58:17.806723 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: Close
[0m21:58:17.807467 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a'
[0m21:58:17.808419 [info ] [Thread-3 (]: 17 of 91 PASS unique_taxi_zone_lookup_LocationID ............................... [[32mPASS[0m in 0.05s]
[0m21:58:17.808703 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: Close
[0m21:58:17.809348 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m21:58:17.809975 [info ] [Thread-1 (]: 16 of 91 PASS not_null_taxi_zone_lookup_LocationID ............................. [[32mPASS[0m in 0.06s]
[0m21:58:17.810273 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.stg_payment_types
[0m21:58:17.810734 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m21:58:17.811268 [info ] [Thread-3 (]: 19 of 91 START sql view model main.stg_payment_types ........................... [RUN]
[0m21:58:17.812360 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m21:58:17.812902 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8, now model.nyc_taxi_pipeline_00.stg_payment_types)
[0m21:58:17.813536 [info ] [Thread-1 (]: 20 of 91 START sql view model main.stg_taxi_zones .............................. [RUN]
[0m21:58:17.814190 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_payment_types
[0m21:58:17.814715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a, now model.nyc_taxi_pipeline_00.stg_taxi_zones)
[0m21:58:17.818180 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m21:58:17.818742 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m21:58:17.819076 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m21:58:17.819800 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: BEGIN
[0m21:58:17.821909 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m21:58:17.822490 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:58:17.824037 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:58:17.824549 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m21:58:17.824929 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */

  
  create view "dev"."main"."stg_rate_codes__dbt_tmp" as (
    /*
    Staging model: Rate code lookup
    Maps rate_code_id to human-readable names.
*/

with source as (
    select * from "dev"."main"."rate_code_lookup"
),

renamed as (
    select
        rate_code_id,
        rate_code_name
    from source
)

select * from renamed
  );

[0m21:58:17.825700 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m21:58:17.828179 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m21:58:17.828996 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
alter view "dev"."main"."stg_rate_codes" rename to "stg_rate_codes__dbt_backup"
[0m21:58:17.829305 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.stg_payment_types
[0m21:58:17.831958 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m21:58:17.832271 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m21:58:17.832565 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m21:58:17.835306 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m21:58:17.838256 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m21:58:17.838931 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
alter view "dev"."main"."stg_rate_codes__dbt_tmp" rename to "stg_rate_codes"
[0m21:58:17.840557 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m21:58:17.840849 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:58:17.841153 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: BEGIN
[0m21:58:17.842318 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: COMMIT
[0m21:58:17.842907 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:17.843521 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m21:58:17.844020 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m21:58:17.844568 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:58:17.844853 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: COMMIT
[0m21:58:17.845290 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: BEGIN
[0m21:58:17.845763 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m21:58:17.846503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:17.847034 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */

  
  create view "dev"."main"."stg_payment_types__dbt_tmp" as (
    /*
    Staging model: Payment type lookup
    Maps payment_type_id to human-readable names.
*/

with source as (
    select * from "dev"."main"."payment_type_lookup"
),

renamed as (
    select
        payment_type_id,
        payment_type_name
    from source
)

select * from renamed
  );

[0m21:58:17.848037 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:58:17.848692 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m21:58:17.849081 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */

  
  create view "dev"."main"."stg_taxi_zones__dbt_tmp" as (
    /*
    Staging model: Taxi zone lookup
    Maps LocationID to borough and zone name.
*/

with source as (
    select * from "dev"."main"."taxi_zone_lookup"
),

renamed as (
    select
        cast("LocationID" as integer) as location_id,
        "Borough" as borough,
        "Zone" as zone_name,
        service_zone
    from source
)

select * from renamed
  );

[0m21:58:17.849416 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m21:58:17.851587 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m21:58:17.851883 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m21:58:17.852193 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:58:17.852421 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
drop view if exists "dev"."main"."stg_rate_codes__dbt_backup" cascade
[0m21:58:17.854763 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m21:58:17.857326 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m21:58:17.858083 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
alter view "dev"."main"."stg_payment_types" rename to "stg_payment_types__dbt_backup"
[0m21:58:17.858557 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
alter view "dev"."main"."stg_taxi_zones" rename to "stg_taxi_zones__dbt_backup"
[0m21:58:17.859618 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m21:58:17.860051 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:17.863276 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m21:58:17.863732 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m21:58:17.865433 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m21:58:17.866120 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
alter view "dev"."main"."stg_payment_types__dbt_tmp" rename to "stg_payment_types"
[0m21:58:17.867641 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: Close
[0m21:58:17.868182 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
alter view "dev"."main"."stg_taxi_zones__dbt_tmp" rename to "stg_taxi_zones"
[0m21:58:17.869514 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c8ce2c5-1c6d-497c-9be8-24ed718e61c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ee341612b0>]}
[0m21:58:17.869901 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:58:17.870419 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:58:17.870888 [info ] [Thread-4 (]: 18 of 91 OK created sql view model main.stg_rate_codes ......................... [[32mOK[0m in 0.09s]
[0m21:58:17.872116 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: COMMIT
[0m21:58:17.873119 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: COMMIT
[0m21:58:17.873683 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m21:58:17.874101 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m21:58:17.874970 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m21:58:17.875822 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: COMMIT
[0m21:58:17.876124 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m21:58:17.876548 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: COMMIT
[0m21:58:17.877383 [info ] [Thread-4 (]: 21 of 91 START test not_null_stg_rate_codes_rate_code_id ....................... [RUN]
[0m21:58:17.878319 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_rate_codes, now test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a)
[0m21:58:17.878681 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m21:58:17.881847 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m21:58:17.882243 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m21:58:17.882692 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:58:17.884100 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m21:58:17.885948 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m21:58:17.886474 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
drop view if exists "dev"."main"."stg_payment_types__dbt_backup" cascade
[0m21:58:17.886883 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
drop view if exists "dev"."main"."stg_taxi_zones__dbt_backup" cascade
[0m21:58:17.889379 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:58:17.890510 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: Close
[0m21:58:17.891316 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c8ce2c5-1c6d-497c-9be8-24ed718e61c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ee34120260>]}
[0m21:58:17.891953 [info ] [Thread-3 (]: 19 of 91 OK created sql view model main.stg_payment_types ...................... [[32mOK[0m in 0.08s]
[0m21:58:17.892295 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:58:17.892675 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.stg_payment_types
[0m21:58:17.893745 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: Close
[0m21:58:17.894054 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m21:58:17.894393 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m21:58:17.895244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c8ce2c5-1c6d-497c-9be8-24ed718e61c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ee354722d0>]}
[0m21:58:17.896819 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m21:58:17.897328 [info ] [Thread-3 (]: 22 of 91 START test not_null_stg_rate_codes_rate_code_name ..................... [RUN]
[0m21:58:17.897860 [info ] [Thread-1 (]: 20 of 91 OK created sql view model main.stg_taxi_zones ......................... [[32mOK[0m in 0.08s]
[0m21:58:17.898622 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_payment_types, now test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f)
[0m21:58:17.899108 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m21:58:17.899495 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m21:58:17.900012 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m21:58:17.902911 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m21:58:17.903509 [info ] [Thread-1 (]: 23 of 91 START test unique_stg_rate_codes_rate_code_id ......................... [RUN]
[0m21:58:17.904162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_taxi_zones, now test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3)
[0m21:58:17.904518 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m21:58:17.907387 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m21:58:17.909263 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m21:58:17.909666 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: BEGIN
[0m21:58:17.910155 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:58:17.911258 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:58:17.911775 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m21:58:17.912102 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m21:58:17.912362 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_id
from "dev"."main"."stg_rate_codes"
where rate_code_id is null



  
  
      
    ) dbt_internal_test
[0m21:58:17.914279 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m21:58:17.914604 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m21:58:17.917675 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m21:58:17.918160 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m21:58:17.919719 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: ROLLBACK
[0m21:58:17.920483 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a'
[0m21:58:17.920939 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: Close
[0m21:58:17.921565 [info ] [Thread-4 (]: 21 of 91 PASS not_null_stg_rate_codes_rate_code_id ............................. [[32mPASS[0m in 0.04s]
[0m21:58:17.922170 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m21:58:17.922611 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m21:58:17.923201 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m21:58:17.923703 [info ] [Thread-4 (]: 24 of 91 START test not_null_stg_payment_types_payment_type_id ................. [RUN]
[0m21:58:17.924473 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: BEGIN
[0m21:58:17.924967 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m21:58:17.925700 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a, now test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78)
[0m21:58:17.926244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:17.926659 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: BEGIN
[0m21:58:17.927176 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m21:58:17.927956 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:58:17.928236 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:17.932323 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m21:58:17.932873 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m21:58:17.933744 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m21:58:17.934411 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rate_code_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_rate_codes"
where rate_code_id is not null
group by rate_code_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:58:17.934800 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m21:58:17.935499 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_name
from "dev"."main"."stg_rate_codes"
where rate_code_name is null



  
  
      
    ) dbt_internal_test
[0m21:58:17.936335 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:17.936698 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:58:17.937885 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: ROLLBACK
[0m21:58:17.939076 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: ROLLBACK
[0m21:58:17.939740 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3'
[0m21:58:17.940440 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f'
[0m21:58:17.940846 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: Close
[0m21:58:17.941325 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: Close
[0m21:58:17.941936 [info ] [Thread-1 (]: 23 of 91 PASS unique_stg_rate_codes_rate_code_id ............................... [[32mPASS[0m in 0.04s]
[0m21:58:17.942321 [info ] [Thread-3 (]: 22 of 91 PASS not_null_stg_rate_codes_rate_code_name ........................... [[32mPASS[0m in 0.04s]
[0m21:58:17.942847 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m21:58:17.943555 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m21:58:17.944070 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m21:58:17.944752 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m21:58:17.945060 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m21:58:17.945671 [info ] [Thread-1 (]: 25 of 91 START test not_null_stg_payment_types_payment_type_name ............... [RUN]
[0m21:58:17.946287 [info ] [Thread-3 (]: 26 of 91 START test unique_stg_payment_types_payment_type_id ................... [RUN]
[0m21:58:17.947865 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m21:58:17.948331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3, now test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39)
[0m21:58:17.948879 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f, now test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534)
[0m21:58:17.949692 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m21:58:17.950161 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m21:58:17.952844 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m21:58:17.955675 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m21:58:17.959658 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m21:58:17.960308 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: BEGIN
[0m21:58:17.960784 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:58:17.961556 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:58:17.962085 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m21:58:17.962399 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m21:58:17.964159 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m21:58:17.964435 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m21:58:17.964731 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."stg_payment_types"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m21:58:17.966762 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m21:58:17.968314 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:58:17.969564 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: ROLLBACK
[0m21:58:17.970205 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78'
[0m21:58:17.971229 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: Close
[0m21:58:17.972071 [info ] [Thread-4 (]: 24 of 91 PASS not_null_stg_payment_types_payment_type_id ....................... [[32mPASS[0m in 0.05s]
[0m21:58:17.972639 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m21:58:17.973171 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m21:58:17.973521 [info ] [Thread-4 (]: 27 of 91 START test not_null_stg_taxi_zones_borough ............................ [RUN]
[0m21:58:17.973944 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m21:58:17.974264 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b)
[0m21:58:17.974596 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: BEGIN
[0m21:58:17.974910 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m21:58:17.975143 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m21:58:17.975537 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:17.976044 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: BEGIN
[0m21:58:17.979602 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m21:58:17.980510 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m21:58:17.980779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:17.981547 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m21:58:17.982587 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_payment_types"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:58:17.983147 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:58:17.984052 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m21:58:17.984559 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_name
from "dev"."main"."stg_payment_types"
where payment_type_name is null



  
  
      
    ) dbt_internal_test
[0m21:58:17.984901 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:58:17.985803 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:17.986887 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: ROLLBACK
[0m21:58:17.987758 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: ROLLBACK
[0m21:58:17.988347 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534'
[0m21:58:17.988861 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39'
[0m21:58:17.989325 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: Close
[0m21:58:17.989843 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: Close
[0m21:58:17.990536 [info ] [Thread-3 (]: 26 of 91 PASS unique_stg_payment_types_payment_type_id ......................... [[32mPASS[0m in 0.04s]
[0m21:58:17.991414 [info ] [Thread-1 (]: 25 of 91 PASS not_null_stg_payment_types_payment_type_name ..................... [[32mPASS[0m in 0.04s]
[0m21:58:17.991862 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m21:58:17.992310 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m21:58:17.992497 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m21:58:17.992872 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m21:58:17.993315 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m21:58:17.995508 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m21:58:17.996388 [info ] [Thread-3 (]: 28 of 91 START test not_null_stg_taxi_zones_location_id ........................ [RUN]
[0m21:58:17.996918 [info ] [Thread-1 (]: 29 of 91 START test not_null_stg_taxi_zones_zone_name .......................... [RUN]
[0m21:58:17.997822 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf)
[0m21:58:17.998315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84)
[0m21:58:17.998753 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m21:58:17.999281 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m21:58:18.002641 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m21:58:18.006433 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m21:58:18.009021 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m21:58:18.009588 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: BEGIN
[0m21:58:18.010143 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:58:18.010876 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:58:18.011227 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m21:58:18.011536 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select borough
from "dev"."main"."stg_taxi_zones"
where borough is null



  
  
      
    ) dbt_internal_test
[0m21:58:18.012505 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:58:18.013679 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: ROLLBACK
[0m21:58:18.014583 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b'
[0m21:58:18.015090 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: Close
[0m21:58:18.015533 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m21:58:18.016167 [info ] [Thread-4 (]: 27 of 91 PASS not_null_stg_taxi_zones_borough .................................. [[32mPASS[0m in 0.04s]
[0m21:58:18.018060 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m21:58:18.018378 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m21:58:18.018909 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m21:58:18.021319 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m21:58:18.021890 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m21:58:18.022812 [info ] [Thread-4 (]: 30 of 91 START test unique_stg_taxi_zones_location_id .......................... [RUN]
[0m21:58:18.023295 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b, now test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c)
[0m21:58:18.023681 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m21:58:18.026493 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m21:58:18.027580 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m21:58:18.027986 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: BEGIN
[0m21:58:18.028317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:18.029153 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:18.029650 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m21:58:18.030046 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m21:58:18.030358 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select zone_name
from "dev"."main"."stg_taxi_zones"
where zone_name is null



  
  
      
    ) dbt_internal_test
[0m21:58:18.030853 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: BEGIN
[0m21:58:18.031483 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:18.032088 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:18.032433 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:58:18.033741 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: ROLLBACK
[0m21:58:18.034114 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m21:58:18.034444 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m21:58:18.035263 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84'
[0m21:58:18.035738 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "dev"."main"."stg_taxi_zones"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m21:58:18.037336 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m21:58:18.037718 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: Close
[0m21:58:18.039001 [info ] [Thread-1 (]: 29 of 91 PASS not_null_stg_taxi_zones_zone_name ................................ [[32mPASS[0m in 0.04s]
[0m21:58:18.039297 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:58:18.039740 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m21:58:18.041358 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: ROLLBACK
[0m21:58:18.041912 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.dim_payment_types
[0m21:58:18.042804 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf'
[0m21:58:18.043225 [info ] [Thread-1 (]: 31 of 91 START sql table model main.dim_payment_types .......................... [RUN]
[0m21:58:18.043567 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: Close
[0m21:58:18.044024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84, now model.nyc_taxi_pipeline_00.dim_payment_types)
[0m21:58:18.044504 [info ] [Thread-3 (]: 28 of 91 PASS not_null_stg_taxi_zones_location_id .............................. [[32mPASS[0m in 0.05s]
[0m21:58:18.044736 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_payment_types
[0m21:58:18.045231 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m21:58:18.047362 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m21:58:18.048665 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m21:58:18.048986 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: BEGIN
[0m21:58:18.049290 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:58:18.049855 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:58:18.050181 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m21:58:18.050516 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_taxi_zones"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:58:18.052443 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:58:18.053539 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: ROLLBACK
[0m21:58:18.054324 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c'
[0m21:58:18.054683 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: Close
[0m21:58:18.055283 [info ] [Thread-4 (]: 30 of 91 PASS unique_stg_taxi_zones_location_id ................................ [[32mPASS[0m in 0.03s]
[0m21:58:18.055824 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m21:58:18.056086 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.dim_payment_types
[0m21:58:18.056737 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.dim_locations
[0m21:58:18.059405 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m21:58:18.060113 [info ] [Thread-3 (]: 32 of 91 START sql table model main.dim_locations .............................. [RUN]
[0m21:58:18.060623 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
DESCRIBE (select * from (
        /*
    Dimension table: Payment type descriptions.
*/

with payment_types as (
    select * from "dev"."main"."stg_payment_types"
),

final as (
    select
        payment_type_id,
        payment_type_name
    from payment_types
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m21:58:18.061321 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf, now model.nyc_taxi_pipeline_00.dim_locations)
[0m21:58:18.061907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:18.062694 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_locations
[0m21:58:18.066092 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_locations"
[0m21:58:18.066413 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:58:18.067758 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m21:58:18.068315 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as payment_type_id, 
      
    cast(null as varchar)
 as payment_type_name
    ) as __dbt_sbq
    where false
    limit 0
)
[0m21:58:18.069661 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:18.070656 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m21:58:18.075648 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.dim_locations
[0m21:58:18.079511 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m21:58:18.080024 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
DESCRIBE (select * from (
        /*
    Dimension table: TLC Taxi Zone locations.
*/

with zones as (
    select * from "dev"."main"."stg_taxi_zones"
),

final as (
    select
        location_id,
        borough,
        zone_name,
        service_zone
    from zones
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m21:58:18.080559 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:18.081393 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m21:58:18.081739 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: BEGIN
[0m21:58:18.082119 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:58:18.082610 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:58:18.083664 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m21:58:18.083947 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m21:58:18.084397 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as location_id, 
      
    cast(null as varchar)
 as borough, 
      
    cast(null as varchar)
 as zone_name, 
      
    cast(null as varchar)
 as service_zone
    ) as __dbt_sbq
    where false
    limit 0
)
[0m21:58:18.084771 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_payment_types__dbt_tmp"
  
  (
    payment_type_id integer,
    payment_type_name varchar
    
    )
 ;
    insert into "dev"."main"."dim_payment_types__dbt_tmp" 
  (
    
      
      payment_type_id ,
    
      
      payment_type_name 
    
  )
 (
      
    select payment_type_id, payment_type_name
    from (
        /*
    Dimension table: Payment type descriptions.
*/

with payment_types as (
    select * from "dev"."main"."stg_payment_types"
),

final as (
    select
        payment_type_id,
        payment_type_name
    from payment_types
)

select * from final
    ) as model_subq
    );
  
  
[0m21:58:18.085525 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m21:58:18.086889 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_locations"
[0m21:58:18.087376 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:58:18.089776 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m21:58:18.090123 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
alter table "dev"."main"."dim_payment_types" rename to "dim_payment_types__dbt_backup"
[0m21:58:18.090700 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:58:18.092574 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m21:58:18.092941 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
alter table "dev"."main"."dim_payment_types__dbt_tmp" rename to "dim_payment_types"
[0m21:58:18.093572 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:58:18.094487 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: COMMIT
[0m21:58:18.094758 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m21:58:18.095020 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m21:58:18.095460 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: BEGIN
[0m21:58:18.096043 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: COMMIT
[0m21:58:18.096735 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m21:58:18.097276 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m21:58:18.097665 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_locations__dbt_tmp"
  
  (
    location_id integer,
    borough varchar,
    zone_name varchar,
    service_zone varchar
    
    )
 ;
    insert into "dev"."main"."dim_locations__dbt_tmp" 
  (
    
      
      location_id ,
    
      
      borough ,
    
      
      zone_name ,
    
      
      service_zone 
    
  )
 (
      
    select location_id, borough, zone_name, service_zone
    from (
        /*
    Dimension table: TLC Taxi Zone locations.
*/

with zones as (
    select * from "dev"."main"."stg_taxi_zones"
),

final as (
    select
        location_id,
        borough,
        zone_name,
        service_zone
    from zones
)

select * from final
    ) as model_subq
    );
  
  
[0m21:58:18.099141 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:58:18.101624 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m21:58:18.102032 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:58:18.102350 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
alter table "dev"."main"."dim_locations" rename to "dim_locations__dbt_backup"
[0m21:58:18.103809 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m21:58:18.104604 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
drop table if exists "dev"."main"."dim_payment_types__dbt_backup" cascade
[0m21:58:18.105007 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:58:18.107370 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m21:58:18.107617 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:58:18.107868 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
alter table "dev"."main"."dim_locations__dbt_tmp" rename to "dim_locations"
[0m21:58:18.109021 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: Close
[0m21:58:18.109911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c8ce2c5-1c6d-497c-9be8-24ed718e61c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ee3539db80>]}
[0m21:58:18.110236 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:58:18.110672 [info ] [Thread-1 (]: 31 of 91 OK created sql table model main.dim_payment_types ..................... [[32mOK[0m in 0.07s]
[0m21:58:18.111697 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: COMMIT
[0m21:58:18.112417 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.dim_payment_types
[0m21:58:18.112959 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m21:58:18.114119 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m21:58:18.114468 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m21:58:18.114801 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: COMMIT
[0m21:58:18.115240 [info ] [Thread-4 (]: 33 of 91 START test not_null_dim_payment_types_payment_type_id ................. [RUN]
[0m21:58:18.116142 [info ] [Thread-1 (]: 34 of 91 START test not_null_dim_payment_types_payment_type_name ............... [RUN]
[0m21:58:18.117364 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c, now test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10)
[0m21:58:18.118042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_payment_types, now test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0)
[0m21:58:18.118900 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m21:58:18.119926 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m21:58:18.123359 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m21:58:18.123725 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m21:58:18.126790 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m21:58:18.128858 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m21:58:18.129581 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
drop table if exists "dev"."main"."dim_locations__dbt_backup" cascade
[0m21:58:18.131724 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m21:58:18.134870 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m21:58:18.135234 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m21:58:18.135624 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m21:58:18.138345 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m21:58:18.139663 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: Close
[0m21:58:18.140732 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c8ce2c5-1c6d-497c-9be8-24ed718e61c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ee241d8710>]}
[0m21:58:18.141313 [info ] [Thread-3 (]: 32 of 91 OK created sql table model main.dim_locations ......................... [[32mOK[0m in 0.08s]
[0m21:58:18.141951 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.dim_locations
[0m21:58:18.142570 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m21:58:18.143161 [info ] [Thread-3 (]: 35 of 91 START test unique_dim_payment_types_payment_type_id ................... [RUN]
[0m21:58:18.143607 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_locations, now test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62)
[0m21:58:18.143978 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m21:58:18.146505 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m21:58:18.147354 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m21:58:18.147855 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: BEGIN
[0m21:58:18.148343 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:58:18.149098 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m21:58:18.149452 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:58:18.149739 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: BEGIN
[0m21:58:18.150188 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m21:58:18.150755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:18.151295 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."dim_payment_types"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m21:58:18.152025 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:18.152790 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m21:58:18.153188 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:58:18.153398 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_name
from "dev"."main"."dim_payment_types"
where payment_type_name is null



  
  
      
    ) dbt_internal_test
[0m21:58:18.154661 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: ROLLBACK
[0m21:58:18.155816 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10'
[0m21:58:18.156105 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:18.156543 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: Close
[0m21:58:18.158097 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: ROLLBACK
[0m21:58:18.158721 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m21:58:18.159219 [info ] [Thread-4 (]: 33 of 91 PASS not_null_dim_payment_types_payment_type_id ....................... [[32mPASS[0m in 0.04s]
[0m21:58:18.159800 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0'
[0m21:58:18.161554 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m21:58:18.162176 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m21:58:18.162525 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: Close
[0m21:58:18.163287 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m21:58:18.164033 [info ] [Thread-1 (]: 34 of 91 PASS not_null_dim_payment_types_payment_type_name ..................... [[32mPASS[0m in 0.05s]
[0m21:58:18.164538 [info ] [Thread-4 (]: 36 of 91 START test not_null_dim_locations_borough ............................. [RUN]
[0m21:58:18.165426 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m21:58:18.166408 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10, now test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af)
[0m21:58:18.167128 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m21:58:18.167789 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m21:58:18.168254 [info ] [Thread-1 (]: 37 of 91 START test not_null_dim_locations_location_id ......................... [RUN]
[0m21:58:18.171293 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m21:58:18.171907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0, now test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476)
[0m21:58:18.172653 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m21:58:18.175109 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m21:58:18.176699 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m21:58:18.177075 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: BEGIN
[0m21:58:18.177425 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:18.178240 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:58:18.178608 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m21:58:18.179149 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."dim_payment_types"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:58:18.179908 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m21:58:18.181661 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m21:58:18.182021 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:58:18.183533 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: ROLLBACK
[0m21:58:18.183758 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m21:58:18.184310 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62'
[0m21:58:18.186202 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m21:58:18.186802 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: Close
[0m21:58:18.187708 [info ] [Thread-3 (]: 35 of 91 PASS unique_dim_payment_types_payment_type_id ......................... [[32mPASS[0m in 0.04s]
[0m21:58:18.188136 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m21:58:18.188452 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m21:58:18.188789 [info ] [Thread-3 (]: 38 of 91 START test not_null_dim_locations_zone_name ........................... [RUN]
[0m21:58:18.189197 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62, now test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d)
[0m21:58:18.189559 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m21:58:18.192632 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m21:58:18.194356 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m21:58:18.194883 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: BEGIN
[0m21:58:18.195400 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m21:58:18.195787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:18.196356 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: BEGIN
[0m21:58:18.197287 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:58:18.197663 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:58:18.198247 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:58:18.198573 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m21:58:18.199120 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m21:58:18.199940 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "dev"."main"."dim_locations"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m21:58:18.200601 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select borough
from "dev"."main"."dim_locations"
where borough is null



  
  
      
    ) dbt_internal_test
[0m21:58:18.202084 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:18.202424 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:58:18.203928 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: ROLLBACK
[0m21:58:18.205000 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: ROLLBACK
[0m21:58:18.205647 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476'
[0m21:58:18.206004 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m21:58:18.206505 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af'
[0m21:58:18.206887 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: Close
[0m21:58:18.208627 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m21:58:18.209049 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: Close
[0m21:58:18.209573 [info ] [Thread-1 (]: 37 of 91 PASS not_null_dim_locations_location_id ............................... [[32mPASS[0m in 0.04s]
[0m21:58:18.210312 [info ] [Thread-4 (]: 36 of 91 PASS not_null_dim_locations_borough ................................... [[32mPASS[0m in 0.04s]
[0m21:58:18.210721 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m21:58:18.211268 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m21:58:18.211775 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m21:58:18.212751 [info ] [Thread-1 (]: 39 of 91 START test unique_dim_locations_location_id ........................... [RUN]
[0m21:58:18.213290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476, now test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d)
[0m21:58:18.213738 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m21:58:18.217630 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m21:58:18.219268 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m21:58:18.219557 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: BEGIN
[0m21:58:18.219818 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:18.220619 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:58:18.221096 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m21:58:18.221544 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select zone_name
from "dev"."main"."dim_locations"
where zone_name is null



  
  
      
    ) dbt_internal_test
[0m21:58:18.222535 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:58:18.223601 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: ROLLBACK
[0m21:58:18.224321 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d'
[0m21:58:18.224757 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: Close
[0m21:58:18.225393 [info ] [Thread-3 (]: 38 of 91 PASS not_null_dim_locations_zone_name ................................. [[32mPASS[0m in 0.04s]
[0m21:58:18.225958 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m21:58:18.226291 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m21:58:18.228268 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m21:58:18.235102 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m21:58:18.235659 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: BEGIN
[0m21:58:18.236068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:18.236952 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:18.237347 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m21:58:18.237634 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "dev"."main"."dim_locations"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:58:18.238792 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:18.239902 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: ROLLBACK
[0m21:58:18.240540 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d'
[0m21:58:18.240956 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: Close
[0m21:58:18.241548 [info ] [Thread-1 (]: 39 of 91 PASS unique_dim_locations_location_id ................................. [[32mPASS[0m in 0.03s]
[0m21:58:18.242130 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m21:58:19.342404 [debug] [Thread-2 (]: SQL status: OK in 1.911 seconds
[0m21:58:19.344921 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m21:58:19.345256 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
alter table "dev"."main"."stg_yellow_trips" rename to "stg_yellow_trips__dbt_backup"
[0m21:58:19.346028 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m21:58:19.347763 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m21:58:19.348196 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
alter table "dev"."main"."stg_yellow_trips__dbt_tmp" rename to "stg_yellow_trips"
[0m21:58:19.348803 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m21:58:19.349663 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: COMMIT
[0m21:58:19.350012 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m21:58:19.350307 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: COMMIT
[0m21:58:19.385143 [debug] [Thread-2 (]: SQL status: OK in 0.034 seconds
[0m21:58:19.387589 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m21:58:19.388234 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
drop table if exists "dev"."main"."stg_yellow_trips__dbt_backup" cascade
[0m21:58:19.394545 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m21:58:19.395851 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: Close
[0m21:58:19.461966 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c8ce2c5-1c6d-497c-9be8-24ed718e61c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ee354718b0>]}
[0m21:58:19.462892 [info ] [Thread-2 (]: 2 of 91 OK created sql table model main.stg_yellow_trips ....................... [[32mOK[0m in 2.10s]
[0m21:58:19.463456 [debug] [Thread-2 (]: Finished running node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m21:58:19.464737 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m21:58:19.464990 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m21:58:19.465224 [info ] [Thread-4 (]: 40 of 91 START test accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6  [RUN]
[0m21:58:19.465605 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m21:58:19.465911 [info ] [Thread-3 (]: 41 of 91 START test accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99  [RUN]
[0m21:58:19.466301 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m21:58:19.466751 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44)
[0m21:58:19.467380 [info ] [Thread-1 (]: 42 of 91 START test accepted_values_stg_yellow_trips_vendor_id__1__2__6 ........ [RUN]
[0m21:58:19.467971 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098)
[0m21:58:19.468388 [info ] [Thread-2 (]: 43 of 91 START test assert_fare_not_exceeds_total .............................. [RUN]
[0m21:58:19.468983 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m21:58:19.469596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27)
[0m21:58:19.470000 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m21:58:19.470740 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_yellow_trips, now test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total)
[0m21:58:19.475608 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m21:58:19.476277 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m21:58:19.479091 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m21:58:19.479655 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m21:58:19.482045 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m21:58:19.484652 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m21:58:19.486308 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m21:58:19.488908 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m21:58:19.489245 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m21:58:19.490803 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m21:58:19.491019 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m21:58:19.492588 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m21:58:19.492851 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m21:58:19.494751 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m21:58:19.498464 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m21:58:19.499214 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: BEGIN
[0m21:58:19.499699 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m21:58:19.500241 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m21:58:19.500550 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:58:19.500987 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: BEGIN
[0m21:58:19.501584 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: BEGIN
[0m21:58:19.502306 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:19.502591 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m21:58:19.502780 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:19.503271 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: BEGIN
[0m21:58:19.503710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:19.522072 [debug] [Thread-4 (]: SQL status: OK in 0.021 seconds
[0m21:58:19.522448 [debug] [Thread-2 (]: SQL status: OK in 0.020 seconds
[0m21:58:19.522724 [debug] [Thread-3 (]: SQL status: OK in 0.020 seconds
[0m21:58:19.523017 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m21:58:19.523286 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m21:58:19.523711 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m21:58:19.524111 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m21:58:19.524513 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m21:58:19.524869 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        payment_type_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by payment_type_id

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6'
)



  
  
      
    ) dbt_internal_test
[0m21:58:19.525206 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
    Singular test: fare_amount should not exceed total_amount.
*/

select
    trip_id,
    fare_amount,
    total_amount
from "dev"."main"."stg_yellow_trips"
where fare_amount > total_amount + 0.01
  and total_amount > 0
  
  
      
    ) dbt_internal_test
[0m21:58:19.525556 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rate_code_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by rate_code_id

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5','6','99'
)



  
  
      
    ) dbt_internal_test
[0m21:58:19.525882 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        vendor_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by vendor_id

)

select *
from all_values
where value_field not in (
    '1','2','6'
)



  
  
      
    ) dbt_internal_test
[0m21:58:19.548313 [debug] [Thread-4 (]: SQL status: OK in 0.022 seconds
[0m21:58:19.552715 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: ROLLBACK
[0m21:58:19.555167 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44'
[0m21:58:19.557501 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: Close
[0m21:58:19.558114 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m21:58:19.559846 [info ] [Thread-4 (]: 40 of 91 PASS accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6  [[32mPASS[0m in 0.09s]
[0m21:58:19.562259 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: ROLLBACK
[0m21:58:19.563537 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m21:58:19.566874 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27'
[0m21:58:19.567251 [debug] [Thread-2 (]: SQL status: OK in 0.041 seconds
[0m21:58:19.567497 [debug] [Thread-3 (]: SQL status: OK in 0.040 seconds
[0m21:58:19.567797 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m21:58:19.568208 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: Close
[0m21:58:19.569520 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: ROLLBACK
[0m21:58:19.570318 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: ROLLBACK
[0m21:58:19.570568 [info ] [Thread-4 (]: 44 of 91 START test not_null_stg_yellow_trips_dropoff_datetime ................. [RUN]
[0m21:58:19.571195 [info ] [Thread-1 (]: 42 of 91 PASS accepted_values_stg_yellow_trips_vendor_id__1__2__6 .............. [[32mPASS[0m in 0.10s]
[0m21:58:19.571798 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total'
[0m21:58:19.572323 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098'
[0m21:58:19.572842 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052)
[0m21:58:19.573342 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m21:58:19.573625 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: Close
[0m21:58:19.573970 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: Close
[0m21:58:19.574277 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m21:58:19.574674 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m21:58:19.575158 [info ] [Thread-2 (]: 43 of 91 PASS assert_fare_not_exceeds_total .................................... [[32mPASS[0m in 0.10s]
[0m21:58:19.577982 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m21:58:19.578375 [info ] [Thread-1 (]: 45 of 91 START test not_null_stg_yellow_trips_dropoff_location_id .............. [RUN]
[0m21:58:19.578804 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m21:58:19.579650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048)
[0m21:58:19.580636 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m21:58:19.581353 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m21:58:19.581837 [info ] [Thread-2 (]: 46 of 91 START test not_null_stg_yellow_trips_fare_amount ...................... [RUN]
[0m21:58:19.584853 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m21:58:19.585293 [info ] [Thread-3 (]: 41 of 91 PASS accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99  [[32mPASS[0m in 0.12s]
[0m21:58:19.585628 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97)
[0m21:58:19.586479 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m21:58:19.586801 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m21:58:19.587152 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m21:58:19.589451 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m21:58:19.589863 [info ] [Thread-3 (]: 47 of 91 START test not_null_stg_yellow_trips_pickup_datetime .................. [RUN]
[0m21:58:19.590645 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed)
[0m21:58:19.590918 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m21:58:19.591148 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m21:58:19.591353 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m21:58:19.592776 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m21:58:19.594143 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m21:58:19.597344 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m21:58:19.597713 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m21:58:19.600661 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m21:58:19.604651 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m21:58:19.604911 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m21:58:19.605146 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m21:58:19.605336 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: BEGIN
[0m21:58:19.607036 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m21:58:19.607384 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m21:58:19.607650 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: BEGIN
[0m21:58:19.608097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:19.608778 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: BEGIN
[0m21:58:19.609089 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:58:19.609606 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:19.615092 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m21:58:19.615423 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: BEGIN
[0m21:58:19.615705 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:19.623764 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m21:58:19.624024 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m21:58:19.624249 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m21:58:19.624438 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m21:58:19.624653 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m21:58:19.625083 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m21:58:19.625540 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m21:58:19.626045 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_location_id
from "dev"."main"."stg_yellow_trips"
where dropoff_location_id is null



  
  
      
    ) dbt_internal_test
[0m21:58:19.626409 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m21:58:19.626754 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_datetime
from "dev"."main"."stg_yellow_trips"
where dropoff_datetime is null



  
  
      
    ) dbt_internal_test
[0m21:58:19.627558 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fare_amount
from "dev"."main"."stg_yellow_trips"
where fare_amount is null



  
  
      
    ) dbt_internal_test
[0m21:58:19.628172 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "dev"."main"."stg_yellow_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m21:58:19.628541 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:19.629197 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m21:58:19.629543 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:58:19.631191 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: ROLLBACK
[0m21:58:19.631466 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:58:19.632327 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: ROLLBACK
[0m21:58:19.633172 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: ROLLBACK
[0m21:58:19.633703 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048'
[0m21:58:19.634694 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: ROLLBACK
[0m21:58:19.635292 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052'
[0m21:58:19.636061 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97'
[0m21:58:19.636414 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: Close
[0m21:58:19.636949 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed'
[0m21:58:19.637321 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: Close
[0m21:58:19.637631 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: Close
[0m21:58:19.638171 [info ] [Thread-1 (]: 45 of 91 PASS not_null_stg_yellow_trips_dropoff_location_id .................... [[32mPASS[0m in 0.06s]
[0m21:58:19.638520 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: Close
[0m21:58:19.638976 [info ] [Thread-4 (]: 44 of 91 PASS not_null_stg_yellow_trips_dropoff_datetime ....................... [[32mPASS[0m in 0.07s]
[0m21:58:19.639330 [info ] [Thread-2 (]: 46 of 91 PASS not_null_stg_yellow_trips_fare_amount ............................ [[32mPASS[0m in 0.05s]
[0m21:58:19.639641 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m21:58:19.640229 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m21:58:19.640685 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m21:58:19.641154 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m21:58:19.641590 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m21:58:19.642242 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m21:58:19.642679 [info ] [Thread-3 (]: 47 of 91 PASS not_null_stg_yellow_trips_pickup_datetime ........................ [[32mPASS[0m in 0.05s]
[0m21:58:19.642919 [info ] [Thread-1 (]: 48 of 91 START test not_null_stg_yellow_trips_pickup_location_id ............... [RUN]
[0m21:58:19.643944 [info ] [Thread-4 (]: 49 of 91 START test not_null_stg_yellow_trips_total_amount ..................... [RUN]
[0m21:58:19.644313 [info ] [Thread-2 (]: 50 of 91 START test not_null_stg_yellow_trips_trip_distance_miles .............. [RUN]
[0m21:58:19.644770 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m21:58:19.645134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1)
[0m21:58:19.645533 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6)
[0m21:58:19.645970 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7)
[0m21:58:19.646348 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m21:58:19.646630 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m21:58:19.646916 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m21:58:19.647208 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m21:58:19.647501 [info ] [Thread-3 (]: 51 of 91 START test not_null_stg_yellow_trips_trip_id .......................... [RUN]
[0m21:58:19.649830 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m21:58:19.651864 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m21:58:19.653938 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m21:58:19.654365 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1)
[0m21:58:19.655184 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m21:58:19.657251 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m21:58:19.660881 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m21:58:19.661156 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m21:58:19.662522 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m21:58:19.664197 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m21:58:19.664412 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m21:58:19.665972 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m21:58:19.666185 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m21:58:19.668859 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m21:58:19.670045 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m21:58:19.670309 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m21:58:19.670502 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: BEGIN
[0m21:58:19.670834 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: BEGIN
[0m21:58:19.671198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:19.671477 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:58:19.671858 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m21:58:19.672656 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: BEGIN
[0m21:58:19.672966 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:19.673300 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m21:58:19.675017 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: BEGIN
[0m21:58:19.675800 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:19.686424 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m21:58:19.686884 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m21:58:19.687096 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m21:58:19.687338 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m21:58:19.687544 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m21:58:19.687881 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m21:58:19.688164 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m21:58:19.688426 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_location_id
from "dev"."main"."stg_yellow_trips"
where pickup_location_id is null



  
  
      
    ) dbt_internal_test
[0m21:58:19.688682 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m21:58:19.688933 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."stg_yellow_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m21:58:19.689208 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_distance_miles
from "dev"."main"."stg_yellow_trips"
where trip_distance_miles is null



  
  
      
    ) dbt_internal_test
[0m21:58:19.689647 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."stg_yellow_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m21:58:19.690118 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:19.690488 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m21:58:19.690817 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m21:58:19.692110 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: ROLLBACK
[0m21:58:19.692380 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:58:19.693079 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: ROLLBACK
[0m21:58:19.693814 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: ROLLBACK
[0m21:58:19.694306 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1'
[0m21:58:19.695059 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: ROLLBACK
[0m21:58:19.695725 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6'
[0m21:58:19.696297 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7'
[0m21:58:19.696620 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: Close
[0m21:58:19.697218 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1'
[0m21:58:19.697499 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: Close
[0m21:58:19.697830 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: Close
[0m21:58:19.698325 [info ] [Thread-1 (]: 48 of 91 PASS not_null_stg_yellow_trips_pickup_location_id ..................... [[32mPASS[0m in 0.05s]
[0m21:58:19.698617 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: Close
[0m21:58:19.699196 [info ] [Thread-4 (]: 49 of 91 PASS not_null_stg_yellow_trips_total_amount ........................... [[32mPASS[0m in 0.05s]
[0m21:58:19.699539 [info ] [Thread-2 (]: 50 of 91 PASS not_null_stg_yellow_trips_trip_distance_miles .................... [[32mPASS[0m in 0.05s]
[0m21:58:19.700082 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m21:58:19.700606 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m21:58:19.700963 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m21:58:19.701473 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m21:58:19.701955 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m21:58:19.703790 [info ] [Thread-4 (]: 53 of 91 START test unique_stg_yellow_trips_trip_id ............................ [RUN]
[0m21:58:19.703022 [info ] [Thread-3 (]: 51 of 91 PASS not_null_stg_yellow_trips_trip_id ................................ [[32mPASS[0m in 0.05s]
[0m21:58:19.703270 [info ] [Thread-1 (]: 52 of 91 START test not_null_stg_yellow_trips_vendor_id ........................ [RUN]
[0m21:58:19.702629 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m21:58:19.704142 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6, now test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965)
[0m21:58:19.704526 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m21:58:19.704819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57)
[0m21:58:19.706139 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m21:58:19.705522 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m21:58:19.705850 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m21:58:19.705108 [info ] [Thread-2 (]: 54 of 91 START test relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_  [RUN]
[0m21:58:19.767179 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m21:58:19.769158 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m21:58:19.770139 [info ] [Thread-3 (]: 55 of 91 START test relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_  [RUN]
[0m21:58:19.772909 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1, now test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f)
[0m21:58:19.770970 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7, now test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a)
[0m21:58:19.773265 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m21:58:19.773602 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m21:58:19.778047 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m21:58:19.780740 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m21:58:19.781826 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m21:58:19.782050 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m21:58:19.783271 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m21:58:19.784605 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m21:58:19.785581 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m21:58:19.787237 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m21:58:19.787501 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m21:58:19.789824 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m21:58:19.796108 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m21:58:19.796495 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m21:58:19.796761 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: BEGIN
[0m21:58:19.797285 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: BEGIN
[0m21:58:19.798077 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m21:58:19.798377 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:58:19.798773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:19.799315 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: BEGIN
[0m21:58:19.800115 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m21:58:19.800577 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:19.800946 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: BEGIN
[0m21:58:19.801615 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:19.818205 [debug] [Thread-4 (]: SQL status: OK in 0.020 seconds
[0m21:58:19.818556 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m21:58:19.818809 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m21:58:19.819040 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m21:58:19.819275 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m21:58:19.819620 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m21:58:19.819973 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m21:58:19.820667 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m21:58:19.821046 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_yellow_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:58:19.821412 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "dev"."main"."stg_yellow_trips"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m21:58:19.821831 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select dropoff_location_id as from_field
    from "dev"."main"."stg_yellow_trips"
    where dropoff_location_id is not null
),

parent as (
    select location_id as to_field
    from "dev"."main"."stg_taxi_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m21:58:19.822200 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select pickup_location_id as from_field
    from "dev"."main"."stg_yellow_trips"
    where pickup_location_id is not null
),

parent as (
    select location_id as to_field
    from "dev"."main"."stg_taxi_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m21:58:19.823690 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:19.829276 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: ROLLBACK
[0m21:58:19.831466 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57'
[0m21:58:19.833081 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: Close
[0m21:58:19.835574 [info ] [Thread-1 (]: 52 of 91 PASS not_null_stg_yellow_trips_vendor_id .............................. [[32mPASS[0m in 0.13s]
[0m21:58:19.836565 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m21:58:19.938161 [debug] [Thread-3 (]: SQL status: OK in 0.112 seconds
[0m21:58:19.938638 [debug] [Thread-2 (]: SQL status: OK in 0.115 seconds
[0m21:58:19.940148 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: ROLLBACK
[0m21:58:19.941050 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: ROLLBACK
[0m21:58:19.941568 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f'
[0m21:58:19.942010 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a'
[0m21:58:19.942429 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: Close
[0m21:58:19.942876 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: Close
[0m21:58:19.943524 [info ] [Thread-3 (]: 55 of 91 PASS relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_  [[32mPASS[0m in 0.17s]
[0m21:58:19.943984 [info ] [Thread-2 (]: 54 of 91 PASS relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_  [[32mPASS[0m in 0.17s]
[0m21:58:19.944285 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m21:58:19.944802 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m21:58:19.981714 [debug] [Thread-4 (]: SQL status: OK in 0.159 seconds
[0m21:58:19.983206 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: ROLLBACK
[0m21:58:19.983923 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965'
[0m21:58:19.984273 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: Close
[0m21:58:20.004173 [info ] [Thread-4 (]: 53 of 91 PASS unique_stg_yellow_trips_trip_id .................................. [[32mPASS[0m in 0.30s]
[0m21:58:20.004878 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m21:58:20.005622 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m21:58:20.006052 [info ] [Thread-1 (]: 56 of 91 START sql view model main.int_trip_metrics ............................ [RUN]
[0m21:58:20.006458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57, now model.nyc_taxi_pipeline_00.int_trip_metrics)
[0m21:58:20.006855 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m21:58:20.009651 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m21:58:20.020432 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m21:58:20.023803 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m21:58:20.029908 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m21:58:20.030347 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: BEGIN
[0m21:58:20.030612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:20.060007 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m21:58:20.060701 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m21:58:20.061238 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */

  
  create view "dev"."main"."int_trip_metrics__dbt_tmp" as (
    /*
    Intermediate model: Trip-level enrichment with calculated metrics.
    Uses adapter-dispatched macros for cross-dialect compatibility.
*/

with trips as (
    select * from "dev"."main"."stg_yellow_trips"
),

enriched as (
    select
        trip_id,
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        payment_type_id,
        pickup_datetime,
        dropoff_datetime,
        passenger_count,
        trip_distance_miles,
        store_and_fwd_flag,

        -- calculated: duration in minutes
        
    datediff('minute', pickup_datetime, dropoff_datetime)
 as trip_duration_minutes,

        -- calculated: average speed (avoid division by zero)
        case
            when 
    datediff('minute', pickup_datetime, dropoff_datetime)
 > 0
            then round(
                trip_distance_miles / (
    datediff('minute', pickup_datetime, dropoff_datetime)
 / 60.0),
                2
            )
            else null
        end as avg_speed_mph,

        -- calculated: cost per mile
        case
            when trip_distance_miles > 0
            then round(fare_amount / trip_distance_miles, 2)
            else null
        end as cost_per_mile,

        -- calculated: tip percentage
        case
            when fare_amount > 0
            then round((tip_amount / fare_amount) * 100, 2)
            else null
        end as tip_percentage,

        -- time dimensions (using adapter-dispatched macros)
        date_trunc('day', pickup_datetime)::date as pickup_date,
        extract(hour from pickup_datetime) as pickup_hour,
        
    dayname(pickup_datetime)
 as pickup_day_of_week,
        case
            when extract(dow from pickup_datetime) in (0, 6) then true
            else false
        end as is_weekend,

        -- financials passthrough
        fare_amount,
        extra_amount,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount,
        congestion_surcharge,
        airport_fee

    from trips
)

select *
from enriched
where trip_duration_minutes between 1 and 720
  and (avg_speed_mph is null or avg_speed_mph < 100)
  );

[0m21:58:20.063022 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:20.065103 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m21:58:20.065538 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
alter view "dev"."main"."int_trip_metrics" rename to "int_trip_metrics__dbt_backup"
[0m21:58:20.066250 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:58:20.067862 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m21:58:20.068221 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
alter view "dev"."main"."int_trip_metrics__dbt_tmp" rename to "int_trip_metrics"
[0m21:58:20.068886 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:58:20.069809 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: COMMIT
[0m21:58:20.070125 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m21:58:20.070405 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: COMMIT
[0m21:58:20.075473 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:58:20.077027 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m21:58:20.077352 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
drop view if exists "dev"."main"."int_trip_metrics__dbt_backup" cascade
[0m21:58:20.080889 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:58:20.081917 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: Close
[0m21:58:20.116390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c8ce2c5-1c6d-497c-9be8-24ed718e61c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ee2412e240>]}
[0m21:58:20.117302 [info ] [Thread-1 (]: 56 of 91 OK created sql view model main.int_trip_metrics ....................... [[32mOK[0m in 0.11s]
[0m21:58:20.118002 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m21:58:20.118895 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m21:58:20.119121 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m21:58:20.119360 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m21:58:20.119705 [info ] [Thread-2 (]: 57 of 91 START test assert_trip_duration_positive .............................. [RUN]
[0m21:58:20.120006 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m21:58:20.120230 [info ] [Thread-4 (]: 58 of 91 START test dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0  [RUN]
[0m21:58:20.120649 [info ] [Thread-3 (]: 59 of 91 START test dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1  [RUN]
[0m21:58:20.121176 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a, now test.nyc_taxi_pipeline_00.assert_trip_duration_positive)
[0m21:58:20.121563 [info ] [Thread-1 (]: 60 of 91 START test not_null_int_trip_metrics_is_weekend ....................... [RUN]
[0m21:58:20.122059 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574)
[0m21:58:20.122511 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718)
[0m21:58:20.122831 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m21:58:20.123157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_trip_metrics, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed)
[0m21:58:20.123486 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m21:58:20.123808 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m21:58:20.126219 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m21:58:20.126731 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m21:58:20.130771 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m21:58:20.132971 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m21:58:20.135405 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m21:58:20.138962 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m21:58:20.140684 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m21:58:20.141992 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m21:58:20.142273 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m21:58:20.144791 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m21:58:20.145134 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m21:58:20.146281 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m21:58:20.147837 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m21:58:20.148989 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m21:58:20.149321 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: BEGIN
[0m21:58:20.149612 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:20.150826 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m21:58:20.151178 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: BEGIN
[0m21:58:20.151492 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:58:20.151732 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m21:58:20.152128 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: BEGIN
[0m21:58:20.152456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:20.152690 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m21:58:20.153033 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: BEGIN
[0m21:58:20.153431 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:20.166432 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m21:58:20.166758 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m21:58:20.166973 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m21:58:20.167248 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m21:58:20.167512 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m21:58:20.167691 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m21:58:20.168003 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
    Singular test: No trip should have negative duration.
*/

select
    trip_id,
    pickup_datetime,
    dropoff_datetime,
    trip_duration_minutes
from "dev"."main"."int_trip_metrics"
where trip_duration_minutes < 0
  
  
      
    ) dbt_internal_test
[0m21:58:20.168390 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m21:58:20.168631 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m21:58:20.169067 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_trip_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m21:58:20.169609 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."int_trip_metrics"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m21:58:20.170011 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_trip_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not trip_duration_minutes >= 1
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not trip_duration_minutes <= 720
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m21:58:20.170306 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:58:20.171933 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: ROLLBACK
[0m21:58:20.172203 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:20.175080 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.assert_trip_duration_positive'
[0m21:58:20.176597 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: ROLLBACK
[0m21:58:20.177405 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: Close
[0m21:58:20.179399 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed'
[0m21:58:20.182370 [info ] [Thread-2 (]: 57 of 91 PASS assert_trip_duration_positive .................................... [[32mPASS[0m in 0.06s]
[0m21:58:20.183543 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: Close
[0m21:58:20.185497 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m21:58:20.187767 [info ] [Thread-1 (]: 60 of 91 PASS not_null_int_trip_metrics_is_weekend ............................. [[32mPASS[0m in 0.06s]
[0m21:58:20.188202 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m21:58:20.191278 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m21:58:20.192868 [info ] [Thread-2 (]: 61 of 91 START test not_null_int_trip_metrics_pickup_date ...................... [RUN]
[0m21:58:20.194725 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m21:58:20.195893 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.assert_trip_duration_positive, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3)
[0m21:58:20.196337 [debug] [Thread-4 (]: SQL status: OK in 0.026 seconds
[0m21:58:20.197960 [info ] [Thread-1 (]: 62 of 91 START test not_null_int_trip_metrics_pickup_hour ...................... [RUN]
[0m21:58:20.199334 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m21:58:20.201919 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: ROLLBACK
[0m21:58:20.202203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082)
[0m21:58:20.206199 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m21:58:20.208822 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574'
[0m21:58:20.209687 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m21:58:20.211846 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: Close
[0m21:58:20.216212 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m21:58:20.217907 [info ] [Thread-4 (]: 58 of 91 PASS dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0 ..... [[32mPASS[0m in 0.10s]
[0m21:58:20.218699 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m21:58:20.219220 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m21:58:20.219648 [info ] [Thread-4 (]: 63 of 91 START test not_null_int_trip_metrics_trip_duration_minutes ............ [RUN]
[0m21:58:20.220016 [debug] [Thread-3 (]: SQL status: OK in 0.049 seconds
[0m21:58:20.220302 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c)
[0m21:58:20.221334 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: ROLLBACK
[0m21:58:20.221527 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m21:58:20.222253 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718'
[0m21:58:20.224701 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m21:58:20.225019 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m21:58:20.225253 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m21:58:20.225531 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: Close
[0m21:58:20.227319 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m21:58:20.228768 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m21:58:20.233134 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m21:58:20.233463 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m21:58:20.233763 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: BEGIN
[0m21:58:20.235603 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m21:58:20.235909 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m21:58:20.236309 [info ] [Thread-3 (]: 59 of 91 PASS dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1  [[32mPASS[0m in 0.11s]
[0m21:58:20.236531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:20.237041 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: BEGIN
[0m21:58:20.237533 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m21:58:20.238787 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:20.239346 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m21:58:20.239932 [info ] [Thread-3 (]: 64 of 91 START test not_null_int_trip_metrics_trip_id .......................... [RUN]
[0m21:58:20.240472 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f)
[0m21:58:20.240893 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m21:58:20.244611 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m21:58:20.246348 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m21:58:20.246710 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: BEGIN
[0m21:58:20.246961 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:58:20.251077 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m21:58:20.252577 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m21:58:20.255924 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m21:58:20.256240 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m21:58:20.256449 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m21:58:20.256649 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m21:58:20.256964 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m21:58:20.257372 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m21:58:20.257719 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."int_trip_metrics"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m21:58:20.258132 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_duration_minutes
from "dev"."main"."int_trip_metrics"
where trip_duration_minutes is null



  
  
      
    ) dbt_internal_test
[0m21:58:20.258514 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_trip_metrics"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m21:58:20.260071 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:58:20.260374 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:20.263082 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: ROLLBACK
[0m21:58:20.263734 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m21:58:20.264914 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: ROLLBACK
[0m21:58:20.266339 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3'
[0m21:58:20.267818 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: BEGIN
[0m21:58:20.268794 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082'
[0m21:58:20.270835 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: Close
[0m21:58:20.272634 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:20.274303 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: Close
[0m21:58:20.276483 [info ] [Thread-2 (]: 61 of 91 PASS not_null_int_trip_metrics_pickup_date ............................ [[32mPASS[0m in 0.08s]
[0m21:58:20.277093 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m21:58:20.280368 [info ] [Thread-1 (]: 62 of 91 PASS not_null_int_trip_metrics_pickup_hour ............................ [[32mPASS[0m in 0.08s]
[0m21:58:20.282266 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m21:58:20.284793 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m21:58:20.285906 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m21:58:20.290515 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."int_trip_metrics"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m21:58:20.295627 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:58:20.298618 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: ROLLBACK
[0m21:58:20.300722 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f'
[0m21:58:20.303311 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: Close
[0m21:58:20.304098 [info ] [Thread-3 (]: 64 of 91 PASS not_null_int_trip_metrics_trip_id ................................ [[32mPASS[0m in 0.06s]
[0m21:58:20.307202 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m21:58:20.314426 [debug] [Thread-4 (]: SQL status: OK in 0.055 seconds
[0m21:58:20.315566 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: ROLLBACK
[0m21:58:20.316275 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c'
[0m21:58:20.316541 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: Close
[0m21:58:20.321264 [info ] [Thread-4 (]: 63 of 91 PASS not_null_int_trip_metrics_trip_duration_minutes .................. [[32mPASS[0m in 0.10s]
[0m21:58:20.321968 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m21:58:20.322667 [debug] [Thread-2 (]: Began running node model.nyc_taxi_pipeline_00.int_daily_summary
[0m21:58:20.322970 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m21:58:20.323194 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.fct_trips
[0m21:58:20.323467 [info ] [Thread-2 (]: 65 of 91 START sql view model main.int_daily_summary ........................... [RUN]
[0m21:58:20.323836 [info ] [Thread-1 (]: 66 of 91 START sql view model main.int_hourly_patterns ......................... [RUN]
[0m21:58:20.324195 [info ] [Thread-3 (]: 67 of 91 START sql incremental model main.fct_trips ............................ [RUN]
[0m21:58:20.324561 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3, now model.nyc_taxi_pipeline_00.int_daily_summary)
[0m21:58:20.324902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082, now model.nyc_taxi_pipeline_00.int_hourly_patterns)
[0m21:58:20.325217 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f, now model.nyc_taxi_pipeline_00.fct_trips)
[0m21:58:20.325481 [debug] [Thread-2 (]: Began compiling node model.nyc_taxi_pipeline_00.int_daily_summary
[0m21:58:20.325774 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m21:58:20.326343 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.fct_trips
[0m21:58:20.328212 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m21:58:20.330224 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m21:58:20.334721 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.fct_trips"
[0m21:58:20.338603 [debug] [Thread-2 (]: Began executing node model.nyc_taxi_pipeline_00.int_daily_summary
[0m21:58:20.340416 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m21:58:20.340799 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m21:58:20.342669 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m21:58:20.342902 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.fct_trips
[0m21:58:20.360587 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m21:58:20.361321 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
DESCRIBE (select * from (
        /*
    Fact table: Fully enriched trip records with location names.
    Incremental with delete+insert strategy.
*/



with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

pickup_locations as (
    select * from "dev"."main"."dim_locations"
),

dropoff_locations as (
    select * from "dev"."main"."dim_locations"
),

final as (
    select
        t.trip_id,
        t.vendor_id,
        t.rate_code_id,
        t.payment_type_id,
        t.pickup_location_id,
        t.dropoff_location_id,
        t.pickup_datetime,
        t.dropoff_datetime,
        t.pickup_date,
        t.pickup_hour,
        t.pickup_day_of_week,
        t.is_weekend,
        t.passenger_count,
        t.trip_distance_miles,
        t.trip_duration_minutes,
        t.avg_speed_mph,
        t.cost_per_mile,
        t.fare_amount,
        t.extra_amount,
        t.mta_tax,
        t.tip_amount,
        t.tip_percentage,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.congestion_surcharge,
        t.airport_fee,

        -- enriched from dimensions
        pu.borough as pickup_borough,
        pu.zone_name as pickup_zone,
        do_loc.borough as dropoff_borough,
        do_loc.zone_name as dropoff_zone

    from trip_metrics t
    left join pickup_locations pu
        on t.pickup_location_id = pu.location_id
    left join dropoff_locations do_loc
        on t.dropoff_location_id = do_loc.location_id

    
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m21:58:20.361680 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m21:58:20.362005 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:20.362323 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: BEGIN
[0m21:58:20.362874 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m21:58:20.363090 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:20.363458 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: BEGIN
[0m21:58:20.363969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:20.379533 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m21:58:20.379850 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m21:58:20.380106 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m21:58:20.380397 [debug] [Thread-3 (]: SQL status: OK in 0.018 seconds
[0m21:58:20.380586 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m21:58:20.380974 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */

  
  create view "dev"."main"."int_daily_summary__dbt_tmp" as (
    /*
    Intermediate model: Daily aggregated trip and revenue metrics.
    One row per day with counts, averages, and revenue totals.
*/

with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

daily_agg as (
    select
        pickup_date,
        pickup_day_of_week,
        is_weekend,

        count(*) as total_trips,
        sum(passenger_count) as total_passengers,

        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(avg(avg_speed_mph), 2) as avg_speed_mph,

        round(sum(fare_amount), 2) as total_fare_revenue,
        round(sum(tip_amount), 2) as total_tip_revenue,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_trip_revenue,
        round(avg(tip_percentage), 2) as avg_tip_percentage,

        count(case when payment_type_id = 1 then 1 end) as credit_card_trips,
        count(case when payment_type_id = 2 then 1 end) as cash_trips

    from trip_metrics
    group by pickup_date, pickup_day_of_week, is_weekend
)

select * from daily_agg
  );

[0m21:58:20.382698 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m21:58:20.382957 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */

  
  create view "dev"."main"."int_hourly_patterns__dbt_tmp" as (
    /*
    Intermediate model: Hourly trip patterns by date.
    One row per date + hour combination.
*/

with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

hourly_agg as (
    select
        pickup_date,
        pickup_hour,
        pickup_day_of_week,
        is_weekend,

        count(*) as total_trips,
        round(avg(trip_distance_miles), 2) as avg_distance,
        round(avg(trip_duration_minutes), 2) as avg_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue

    from trip_metrics
    group by pickup_date, pickup_hour, pickup_day_of_week, is_weekend
)

select * from hourly_agg
  );

[0m21:58:20.383687 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as varchar)
 as trip_id, 
      
    cast(null as integer)
 as vendor_id, 
      
    cast(null as integer)
 as rate_code_id, 
      
    cast(null as integer)
 as payment_type_id, 
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as integer)
 as dropoff_location_id, 
      
    cast(null as timestamp)
 as pickup_datetime, 
      
    cast(null as timestamp)
 as dropoff_datetime, 
      
    cast(null as date)
 as pickup_date, 
      
    cast(null as bigint)
 as pickup_hour, 
      
    cast(null as varchar)
 as pickup_day_of_week, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as integer)
 as passenger_count, 
      
    cast(null as double)
 as trip_distance_miles, 
      
    cast(null as bigint)
 as trip_duration_minutes, 
      
    cast(null as double)
 as avg_speed_mph, 
      
    cast(null as double)
 as cost_per_mile, 
      
    cast(null as decimal(10,2))
 as fare_amount, 
      
    cast(null as decimal(10,2))
 as extra_amount, 
      
    cast(null as decimal(10,2))
 as mta_tax, 
      
    cast(null as decimal(10,2))
 as tip_amount, 
      
    cast(null as double)
 as tip_percentage, 
      
    cast(null as decimal(10,2))
 as tolls_amount, 
      
    cast(null as decimal(10,2))
 as improvement_surcharge, 
      
    cast(null as decimal(10,2))
 as total_amount, 
      
    cast(null as decimal(10,2))
 as congestion_surcharge, 
      
    cast(null as decimal(10,2))
 as airport_fee, 
      
    cast(null as varchar)
 as pickup_borough, 
      
    cast(null as varchar)
 as pickup_zone, 
      
    cast(null as varchar)
 as dropoff_borough, 
      
    cast(null as varchar)
 as dropoff_zone
    ) as __dbt_sbq
    where false
    limit 0
)
[0m21:58:20.384393 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:58:20.384643 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m21:58:20.386402 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m21:58:20.386824 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:58:20.389229 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.fct_trips"
[0m21:58:20.389454 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
alter view "dev"."main"."int_daily_summary" rename to "int_daily_summary__dbt_backup"
[0m21:58:20.391300 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m21:58:20.392208 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
alter view "dev"."main"."int_hourly_patterns" rename to "int_hourly_patterns__dbt_backup"
[0m21:58:20.392462 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m21:58:20.394146 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m21:58:20.394357 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:58:20.394561 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
alter view "dev"."main"."int_daily_summary__dbt_tmp" rename to "int_daily_summary"
[0m21:58:20.395964 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m21:58:20.396700 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m21:58:20.397094 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
alter view "dev"."main"."int_hourly_patterns__dbt_tmp" rename to "int_hourly_patterns"
[0m21:58:20.398102 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: COMMIT
[0m21:58:20.398795 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:58:20.399135 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m21:58:20.400030 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: COMMIT
[0m21:58:20.400281 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m21:58:20.400474 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: COMMIT
[0m21:58:20.400767 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m21:58:20.401560 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.fct_trips: BEGIN
[0m21:58:20.402573 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: COMMIT
[0m21:58:20.403329 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m21:58:20.404030 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m21:58:20.404398 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */

  
    
    
      
    

    create  table
      "dev"."main"."fct_trips__dbt_tmp"
  
  (
    trip_id varchar,
    vendor_id integer,
    rate_code_id integer,
    payment_type_id integer,
    pickup_location_id integer,
    dropoff_location_id integer,
    pickup_datetime timestamp,
    dropoff_datetime timestamp,
    pickup_date date,
    pickup_hour bigint,
    pickup_day_of_week varchar,
    is_weekend boolean,
    passenger_count integer,
    trip_distance_miles double,
    trip_duration_minutes bigint,
    avg_speed_mph double,
    cost_per_mile double,
    fare_amount decimal(10,2),
    extra_amount decimal(10,2),
    mta_tax decimal(10,2),
    tip_amount decimal(10,2),
    tip_percentage double,
    tolls_amount decimal(10,2),
    improvement_surcharge decimal(10,2),
    total_amount decimal(10,2),
    congestion_surcharge decimal(10,2),
    airport_fee decimal(10,2),
    pickup_borough varchar,
    pickup_zone varchar,
    dropoff_borough varchar,
    dropoff_zone varchar
    
    )
 ;
    insert into "dev"."main"."fct_trips__dbt_tmp" 
  (
    
      
      trip_id ,
    
      
      vendor_id ,
    
      
      rate_code_id ,
    
      
      payment_type_id ,
    
      
      pickup_location_id ,
    
      
      dropoff_location_id ,
    
      
      pickup_datetime ,
    
      
      dropoff_datetime ,
    
      
      pickup_date ,
    
      
      pickup_hour ,
    
      
      pickup_day_of_week ,
    
      
      is_weekend ,
    
      
      passenger_count ,
    
      
      trip_distance_miles ,
    
      
      trip_duration_minutes ,
    
      
      avg_speed_mph ,
    
      
      cost_per_mile ,
    
      
      fare_amount ,
    
      
      extra_amount ,
    
      
      mta_tax ,
    
      
      tip_amount ,
    
      
      tip_percentage ,
    
      
      tolls_amount ,
    
      
      improvement_surcharge ,
    
      
      total_amount ,
    
      
      congestion_surcharge ,
    
      
      airport_fee ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      dropoff_borough ,
    
      
      dropoff_zone 
    
  )
 (
      
    select trip_id, vendor_id, rate_code_id, payment_type_id, pickup_location_id, dropoff_location_id, pickup_datetime, dropoff_datetime, pickup_date, pickup_hour, pickup_day_of_week, is_weekend, passenger_count, trip_distance_miles, trip_duration_minutes, avg_speed_mph, cost_per_mile, fare_amount, extra_amount, mta_tax, tip_amount, tip_percentage, tolls_amount, improvement_surcharge, total_amount, congestion_surcharge, airport_fee, pickup_borough, pickup_zone, dropoff_borough, dropoff_zone
    from (
        /*
    Fact table: Fully enriched trip records with location names.
    Incremental with delete+insert strategy.
*/



with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

pickup_locations as (
    select * from "dev"."main"."dim_locations"
),

dropoff_locations as (
    select * from "dev"."main"."dim_locations"
),

final as (
    select
        t.trip_id,
        t.vendor_id,
        t.rate_code_id,
        t.payment_type_id,
        t.pickup_location_id,
        t.dropoff_location_id,
        t.pickup_datetime,
        t.dropoff_datetime,
        t.pickup_date,
        t.pickup_hour,
        t.pickup_day_of_week,
        t.is_weekend,
        t.passenger_count,
        t.trip_distance_miles,
        t.trip_duration_minutes,
        t.avg_speed_mph,
        t.cost_per_mile,
        t.fare_amount,
        t.extra_amount,
        t.mta_tax,
        t.tip_amount,
        t.tip_percentage,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.congestion_surcharge,
        t.airport_fee,

        -- enriched from dimensions
        pu.borough as pickup_borough,
        pu.zone_name as pickup_zone,
        do_loc.borough as dropoff_borough,
        do_loc.zone_name as dropoff_zone

    from trip_metrics t
    left join pickup_locations pu
        on t.pickup_location_id = pu.location_id
    left join dropoff_locations do_loc
        on t.dropoff_location_id = do_loc.location_id

    
)

select * from final
    ) as model_subq
    );
  
  
  
[0m21:58:20.407525 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m21:58:20.409457 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m21:58:20.410132 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m21:58:20.410953 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
drop view if exists "dev"."main"."int_daily_summary__dbt_backup" cascade
[0m21:58:20.415680 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m21:58:20.419024 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
drop view if exists "dev"."main"."int_hourly_patterns__dbt_backup" cascade
[0m21:58:20.426681 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m21:58:20.430718 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: Close
[0m21:58:20.433154 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c8ce2c5-1c6d-497c-9be8-24ed718e61c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ee353400b0>]}
[0m21:58:20.435186 [info ] [Thread-2 (]: 65 of 91 OK created sql view model main.int_daily_summary ...................... [[32mOK[0m in 0.11s]
[0m21:58:20.436689 [debug] [Thread-2 (]: Finished running node model.nyc_taxi_pipeline_00.int_daily_summary
[0m21:58:20.437375 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m21:58:20.438700 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m21:58:20.438913 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m21:58:20.440551 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: Close
[0m21:58:20.442334 [info ] [Thread-4 (]: 68 of 91 START test dbt_utils_accepted_range_int_daily_summary_total_trips__0 .. [RUN]
[0m21:58:20.443700 [info ] [Thread-2 (]: 69 of 91 START test not_null_int_daily_summary_pickup_date ..................... [RUN]
[0m21:58:20.445713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c8ce2c5-1c6d-497c-9be8-24ed718e61c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ee35ff7a70>]}
[0m21:58:20.447672 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863)
[0m21:58:20.449964 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_daily_summary, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686)
[0m21:58:20.452005 [info ] [Thread-1 (]: 66 of 91 OK created sql view model main.int_hourly_patterns .................... [[32mOK[0m in 0.12s]
[0m21:58:20.454523 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m21:58:20.456738 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m21:58:20.458508 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m21:58:20.461592 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m21:58:20.467084 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m21:58:20.468854 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m21:58:20.473321 [info ] [Thread-1 (]: 70 of 91 START test not_null_int_daily_summary_total_revenue ................... [RUN]
[0m21:58:20.475271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_hourly_patterns, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50)
[0m21:58:20.477012 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m21:58:20.480276 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m21:58:20.503181 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m21:58:20.508538 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m21:58:20.510215 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m21:58:20.515342 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m21:58:20.515985 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m21:58:20.521781 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m21:58:20.536481 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m21:58:20.537303 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m21:58:20.537934 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: BEGIN
[0m21:58:20.544862 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:58:20.543276 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: BEGIN
[0m21:58:20.546421 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:58:20.549144 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:20.550061 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m21:58:20.553862 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: BEGIN
[0m21:58:20.553339 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m21:58:20.550835 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m21:58:20.554480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:20.555755 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m21:58:20.561344 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_daily_summary"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m21:58:20.559746 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:58:20.563957 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m21:58:20.556829 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_daily_summary"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_trips >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m21:58:20.564727 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "dev"."main"."int_daily_summary"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m21:58:20.565844 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m21:58:20.568328 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: ROLLBACK
[0m21:58:20.571396 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686'
[0m21:58:20.572502 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: Close
[0m21:58:20.573669 [info ] [Thread-2 (]: 69 of 91 PASS not_null_int_daily_summary_pickup_date ........................... [[32mPASS[0m in 0.12s]
[0m21:58:20.575479 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m21:58:20.577422 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m21:58:20.578319 [info ] [Thread-2 (]: 71 of 91 START test not_null_int_daily_summary_total_trips ..................... [RUN]
[0m21:58:20.579179 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10)
[0m21:58:20.580415 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m21:58:20.585924 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m21:58:20.641988 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m21:58:20.645862 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m21:58:20.699097 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m21:58:20.701307 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: BEGIN
[0m21:58:20.706501 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:20.708909 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:58:20.712185 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m21:58:20.713008 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_trips
from "dev"."main"."int_daily_summary"
where total_trips is null



  
  
      
    ) dbt_internal_test
[0m21:58:20.817368 [debug] [Thread-4 (]: SQL status: OK in 0.252 seconds
[0m21:58:20.819637 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: ROLLBACK
[0m21:58:20.820279 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863'
[0m21:58:20.820646 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: Close
[0m21:58:20.821245 [info ] [Thread-4 (]: 68 of 91 PASS dbt_utils_accepted_range_int_daily_summary_total_trips__0 ........ [[32mPASS[0m in 0.37s]
[0m21:58:20.822755 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m21:58:20.823269 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m21:58:20.823703 [info ] [Thread-4 (]: 72 of 91 START test unique_int_daily_summary_pickup_date ....................... [RUN]
[0m21:58:20.824319 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863, now test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e)
[0m21:58:20.824756 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m21:58:20.827474 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m21:58:20.836995 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m21:58:20.839005 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m21:58:20.846786 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m21:58:20.847177 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: BEGIN
[0m21:58:20.847564 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:58:20.848276 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:58:20.848750 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m21:58:20.849316 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pickup_date as unique_field,
    count(*) as n_records

from "dev"."main"."int_daily_summary"
where pickup_date is not null
group by pickup_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:58:20.917756 [debug] [Thread-2 (]: SQL status: OK in 0.199 seconds
[0m21:58:20.919442 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: ROLLBACK
[0m21:58:20.920372 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10'
[0m21:58:20.920829 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: Close
[0m21:58:20.921419 [info ] [Thread-2 (]: 71 of 91 PASS not_null_int_daily_summary_total_trips ........................... [[32mPASS[0m in 0.34s]
[0m21:58:20.921919 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m21:58:20.922529 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m21:58:20.923180 [info ] [Thread-2 (]: 73 of 91 START test dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0  [RUN]
[0m21:58:20.923912 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe)
[0m21:58:20.924307 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m21:58:20.928254 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m21:58:20.933902 [debug] [Thread-1 (]: SQL status: OK in 0.368 seconds
[0m21:58:20.935293 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: ROLLBACK
[0m21:58:20.936056 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50'
[0m21:58:20.936459 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: Close
[0m21:58:20.937091 [info ] [Thread-1 (]: 70 of 91 PASS not_null_int_daily_summary_total_revenue ......................... [[32mPASS[0m in 0.46s]
[0m21:58:20.937698 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m21:58:20.938119 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m21:58:20.938476 [info ] [Thread-1 (]: 74 of 91 START test not_null_int_hourly_patterns_pickup_date ................... [RUN]
[0m21:58:20.939084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2)
[0m21:58:20.940131 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m21:58:20.940662 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m21:58:20.943979 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m21:58:20.945519 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m21:58:20.954048 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m21:58:20.954447 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m21:58:20.955957 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m21:58:20.956405 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: BEGIN
[0m21:58:20.956915 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:20.957571 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:58:20.957934 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m21:58:20.958304 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_hourly_patterns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m21:58:20.963402 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m21:58:20.963915 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: BEGIN
[0m21:58:20.964316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:20.965043 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:20.965359 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m21:58:20.965695 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_hourly_patterns"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m21:58:20.967492 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:20.968929 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: ROLLBACK
[0m21:58:20.969730 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2'
[0m21:58:20.970122 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: Close
[0m21:58:20.970653 [info ] [Thread-1 (]: 74 of 91 PASS not_null_int_hourly_patterns_pickup_date ......................... [[32mPASS[0m in 0.03s]
[0m21:58:20.971207 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m21:58:20.971595 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m21:58:20.972159 [info ] [Thread-1 (]: 75 of 91 START test not_null_int_hourly_patterns_pickup_hour ................... [RUN]
[0m21:58:20.972756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d)
[0m21:58:20.973134 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m21:58:20.976202 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m21:58:20.976979 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m21:58:20.978519 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: ROLLBACK
[0m21:58:20.979493 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe'
[0m21:58:20.979897 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: Close
[0m21:58:20.980463 [info ] [Thread-2 (]: 73 of 91 PASS dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0 .. [[32mPASS[0m in 0.06s]
[0m21:58:20.980920 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m21:58:20.981221 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m21:58:20.981560 [info ] [Thread-2 (]: 76 of 91 START test not_null_int_hourly_patterns_total_trips ................... [RUN]
[0m21:58:20.982009 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf)
[0m21:58:20.982366 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m21:58:20.985134 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m21:58:20.986041 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m21:58:20.987363 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m21:58:20.989030 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m21:58:20.990481 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m21:58:20.995555 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m21:58:20.996309 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: BEGIN
[0m21:58:20.996882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:20.997925 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m21:58:20.998467 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:58:20.998831 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: BEGIN
[0m21:58:20.999409 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m21:58:20.999919 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:21.000418 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."int_hourly_patterns"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m21:58:21.001196 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:58:21.001721 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m21:58:21.002250 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_trips
from "dev"."main"."int_hourly_patterns"
where total_trips is null



  
  
      
    ) dbt_internal_test
[0m21:58:21.003353 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:58:21.004704 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: ROLLBACK
[0m21:58:21.005543 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d'
[0m21:58:21.005959 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: Close
[0m21:58:21.006537 [info ] [Thread-1 (]: 75 of 91 PASS not_null_int_hourly_patterns_pickup_hour ......................... [[32mPASS[0m in 0.03s]
[0m21:58:21.007011 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m21:58:21.021534 [debug] [Thread-4 (]: SQL status: OK in 0.172 seconds
[0m21:58:21.023247 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: ROLLBACK
[0m21:58:21.024123 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e'
[0m21:58:21.024592 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: Close
[0m21:58:21.025282 [info ] [Thread-4 (]: 72 of 91 PASS unique_int_daily_summary_pickup_date ............................. [[32mPASS[0m in 0.20s]
[0m21:58:21.026016 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m21:58:21.026695 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m21:58:21.027213 [info ] [Thread-1 (]: 77 of 91 START sql table model main.mart_daily_revenue ......................... [RUN]
[0m21:58:21.027626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d, now model.nyc_taxi_pipeline_00.mart_daily_revenue)
[0m21:58:21.027965 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m21:58:21.030411 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m21:58:21.038762 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m21:58:21.042588 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m21:58:21.043060 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Daily revenue metrics with running totals.
*/

with daily as (
    select * from "dev"."main"."int_daily_summary"
),

dates as (
    select * from "dev"."main"."dim_dates"
),

final as (
    select
        d.date_key,
        d.day_of_week_name,
        d.is_weekend,
        d.is_holiday,
        d.week_of_year,

        daily.total_trips,
        daily.total_passengers,
        daily.total_fare_revenue,
        daily.total_tip_revenue,
        daily.total_revenue,
        daily.avg_trip_revenue,
        daily.avg_tip_percentage,
        daily.credit_card_trips,
        daily.cash_trips,
        daily.avg_trip_distance,
        daily.avg_trip_duration_min,

        -- running total
        sum(daily.total_revenue) over (order by d.date_key) as cumulative_revenue,

        -- day-over-day change
        daily.total_revenue - lag(daily.total_revenue) over (order by d.date_key) as revenue_change_vs_prior_day

    from daily
    inner join dates d
        on daily.pickup_date = d.date_key
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m21:58:21.043523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:21.046050 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:58:21.049172 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m21:58:21.049572 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as date_key, 
      
    cast(null as varchar)
 as day_of_week_name, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as boolean)
 as is_holiday, 
      
    cast(null as bigint)
 as week_of_year, 
      
    cast(null as bigint)
 as total_trips, 
      
    cast(null as hugeint)
 as total_passengers, 
      
    cast(null as decimal(38,2))
 as total_fare_revenue, 
      
    cast(null as decimal(38,2))
 as total_tip_revenue, 
      
    cast(null as decimal(38,2))
 as total_revenue, 
      
    cast(null as double)
 as avg_trip_revenue, 
      
    cast(null as double)
 as avg_tip_percentage, 
      
    cast(null as bigint)
 as credit_card_trips, 
      
    cast(null as bigint)
 as cash_trips, 
      
    cast(null as double)
 as avg_trip_distance, 
      
    cast(null as double)
 as avg_trip_duration_min, 
      
    cast(null as decimal(38,2))
 as cumulative_revenue, 
      
    cast(null as decimal(38,2))
 as revenue_change_vs_prior_day
    ) as __dbt_sbq
    where false
    limit 0
)
[0m21:58:21.050647 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:21.052598 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m21:58:21.058621 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m21:58:21.059079 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: BEGIN
[0m21:58:21.059711 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:58:21.060187 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m21:58:21.060613 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_daily_revenue__dbt_tmp"
  
  (
    date_key date,
    day_of_week_name varchar,
    is_weekend boolean,
    is_holiday boolean,
    week_of_year bigint,
    total_trips bigint,
    total_passengers hugeint,
    total_fare_revenue decimal(38,2),
    total_tip_revenue decimal(38,2),
    total_revenue decimal(38,2),
    avg_trip_revenue double,
    avg_tip_percentage double,
    credit_card_trips bigint,
    cash_trips bigint,
    avg_trip_distance double,
    avg_trip_duration_min double,
    cumulative_revenue decimal(38,2),
    revenue_change_vs_prior_day decimal(38,2)
    
    )
 ;
    insert into "dev"."main"."mart_daily_revenue__dbt_tmp" 
  (
    
      
      date_key ,
    
      
      day_of_week_name ,
    
      
      is_weekend ,
    
      
      is_holiday ,
    
      
      week_of_year ,
    
      
      total_trips ,
    
      
      total_passengers ,
    
      
      total_fare_revenue ,
    
      
      total_tip_revenue ,
    
      
      total_revenue ,
    
      
      avg_trip_revenue ,
    
      
      avg_tip_percentage ,
    
      
      credit_card_trips ,
    
      
      cash_trips ,
    
      
      avg_trip_distance ,
    
      
      avg_trip_duration_min ,
    
      
      cumulative_revenue ,
    
      
      revenue_change_vs_prior_day 
    
  )
 (
      
    select date_key, day_of_week_name, is_weekend, is_holiday, week_of_year, total_trips, total_passengers, total_fare_revenue, total_tip_revenue, total_revenue, avg_trip_revenue, avg_tip_percentage, credit_card_trips, cash_trips, avg_trip_distance, avg_trip_duration_min, cumulative_revenue, revenue_change_vs_prior_day
    from (
        /*
    Analytics mart: Daily revenue metrics with running totals.
*/

with daily as (
    select * from "dev"."main"."int_daily_summary"
),

dates as (
    select * from "dev"."main"."dim_dates"
),

final as (
    select
        d.date_key,
        d.day_of_week_name,
        d.is_weekend,
        d.is_holiday,
        d.week_of_year,

        daily.total_trips,
        daily.total_passengers,
        daily.total_fare_revenue,
        daily.total_tip_revenue,
        daily.total_revenue,
        daily.avg_trip_revenue,
        daily.avg_tip_percentage,
        daily.credit_card_trips,
        daily.cash_trips,
        daily.avg_trip_distance,
        daily.avg_trip_duration_min,

        -- running total
        sum(daily.total_revenue) over (order by d.date_key) as cumulative_revenue,

        -- day-over-day change
        daily.total_revenue - lag(daily.total_revenue) over (order by d.date_key) as revenue_change_vs_prior_day

    from daily
    inner join dates d
        on daily.pickup_date = d.date_key
)

select * from final
    ) as model_subq
    );
  
  
[0m21:58:21.131055 [debug] [Thread-2 (]: SQL status: OK in 0.128 seconds
[0m21:58:21.132533 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: ROLLBACK
[0m21:58:21.133288 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf'
[0m21:58:21.133700 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: Close
[0m21:58:21.134341 [info ] [Thread-2 (]: 76 of 91 PASS not_null_int_hourly_patterns_total_trips ......................... [[32mPASS[0m in 0.15s]
[0m21:58:21.134846 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m21:58:21.135625 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m21:58:21.136112 [info ] [Thread-4 (]: 78 of 91 START sql table model main.mart_hourly_demand ......................... [RUN]
[0m21:58:21.136619 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e, now model.nyc_taxi_pipeline_00.mart_hourly_demand)
[0m21:58:21.137028 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m21:58:21.139236 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m21:58:21.146817 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m21:58:21.149454 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m21:58:21.149856 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Hourly demand patterns.
*/

with hourly as (
    select * from "dev"."main"."int_hourly_patterns"
),

final as (
    select
        pickup_hour,
        is_weekend,

        count(*) as days_observed,
        round(avg(total_trips), 0) as avg_trips_per_period,
        round(avg(avg_distance), 2) as avg_distance,
        round(avg(avg_duration_min), 2) as avg_duration_min,
        round(avg(total_revenue), 2) as avg_revenue_per_period,
        sum(total_trips) as total_trips_all_days

    from hourly
    group by pickup_hour, is_weekend
)

select * from final
order by is_weekend, pickup_hour
    ) as __dbt_sbq
    where false
    limit 0
)
[0m21:58:21.150259 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:58:21.152542 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:58:21.154160 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m21:58:21.154812 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as bigint)
 as pickup_hour, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as bigint)
 as days_observed, 
      
    cast(null as double)
 as avg_trips_per_period, 
      
    cast(null as double)
 as avg_distance, 
      
    cast(null as double)
 as avg_duration_min, 
      
    cast(null as double)
 as avg_revenue_per_period, 
      
    cast(null as hugeint)
 as total_trips_all_days
    ) as __dbt_sbq
    where false
    limit 0
)
[0m21:58:21.155757 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m21:58:21.157281 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m21:58:21.165214 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m21:58:21.165565 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: BEGIN
[0m21:58:21.166466 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m21:58:21.166836 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m21:58:21.167189 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_hourly_demand__dbt_tmp"
  
  (
    pickup_hour bigint,
    is_weekend boolean,
    days_observed bigint,
    avg_trips_per_period double,
    avg_distance double,
    avg_duration_min double,
    avg_revenue_per_period double,
    total_trips_all_days hugeint
    
    )
 ;
    insert into "dev"."main"."mart_hourly_demand__dbt_tmp" 
  (
    
      
      pickup_hour ,
    
      
      is_weekend ,
    
      
      days_observed ,
    
      
      avg_trips_per_period ,
    
      
      avg_distance ,
    
      
      avg_duration_min ,
    
      
      avg_revenue_per_period ,
    
      
      total_trips_all_days 
    
  )
 (
      
    select pickup_hour, is_weekend, days_observed, avg_trips_per_period, avg_distance, avg_duration_min, avg_revenue_per_period, total_trips_all_days
    from (
        /*
    Analytics mart: Hourly demand patterns.
*/

with hourly as (
    select * from "dev"."main"."int_hourly_patterns"
),

final as (
    select
        pickup_hour,
        is_weekend,

        count(*) as days_observed,
        round(avg(total_trips), 0) as avg_trips_per_period,
        round(avg(avg_distance), 2) as avg_distance,
        round(avg(avg_duration_min), 2) as avg_duration_min,
        round(avg(total_revenue), 2) as avg_revenue_per_period,
        sum(total_trips) as total_trips_all_days

    from hourly
    group by pickup_hour, is_weekend
)

select * from final
order by is_weekend, pickup_hour
    ) as model_subq
    );
  
  
[0m21:58:21.275546 [debug] [Thread-1 (]: SQL status: OK in 0.214 seconds
[0m21:58:21.278098 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m21:58:21.278571 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
alter table "dev"."main"."mart_daily_revenue" rename to "mart_daily_revenue__dbt_backup"
[0m21:58:21.279389 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:58:21.281451 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m21:58:21.281865 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
alter table "dev"."main"."mart_daily_revenue__dbt_tmp" rename to "mart_daily_revenue"
[0m21:58:21.282460 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:58:21.283537 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: COMMIT
[0m21:58:21.283968 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m21:58:21.284331 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: COMMIT
[0m21:58:21.288780 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:58:21.291008 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m21:58:21.291449 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
drop table if exists "dev"."main"."mart_daily_revenue__dbt_backup" cascade
[0m21:58:21.293877 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:58:21.294918 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: Close
[0m21:58:21.295492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c8ce2c5-1c6d-497c-9be8-24ed718e61c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ee34160e60>]}
[0m21:58:21.296052 [info ] [Thread-1 (]: 77 of 91 OK created sql table model main.mart_daily_revenue .................... [[32mOK[0m in 0.27s]
[0m21:58:21.296622 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m21:58:21.297391 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m21:58:21.297690 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m21:58:21.297967 [info ] [Thread-2 (]: 79 of 91 START test not_null_mart_daily_revenue_date_key ....................... [RUN]
[0m21:58:21.298419 [info ] [Thread-1 (]: 80 of 91 START test not_null_mart_daily_revenue_total_revenue .................. [RUN]
[0m21:58:21.298948 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf, now test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a)
[0m21:58:21.299575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.mart_daily_revenue, now test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9)
[0m21:58:21.300070 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m21:58:21.300498 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m21:58:21.303507 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m21:58:21.307036 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m21:58:21.312015 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m21:58:21.315142 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m21:58:21.315388 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m21:58:21.317308 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m21:58:21.322399 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m21:58:21.322948 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: BEGIN
[0m21:58:21.323330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:21.323962 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m21:58:21.324277 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:21.324523 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: BEGIN
[0m21:58:21.324886 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m21:58:21.325291 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:21.325776 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "dev"."main"."mart_daily_revenue"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m21:58:21.326564 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:58:21.326883 [debug] [Thread-4 (]: SQL status: OK in 0.159 seconds
[0m21:58:21.327194 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:21.327444 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m21:58:21.329467 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m21:58:21.330471 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: ROLLBACK
[0m21:58:21.330704 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "dev"."main"."mart_daily_revenue"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m21:58:21.331022 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
alter table "dev"."main"."mart_hourly_demand" rename to "mart_hourly_demand__dbt_backup"
[0m21:58:21.332231 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9'
[0m21:58:21.332841 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: Close
[0m21:58:21.333235 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:58:21.333615 [info ] [Thread-1 (]: 80 of 91 PASS not_null_mart_daily_revenue_total_revenue ........................ [[32mPASS[0m in 0.03s]
[0m21:58:21.333915 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:58:21.334714 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: ROLLBACK
[0m21:58:21.335011 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m21:58:21.336836 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m21:58:21.337560 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a'
[0m21:58:21.337835 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m21:58:21.338141 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
alter table "dev"."main"."mart_hourly_demand__dbt_tmp" rename to "mart_hourly_demand"
[0m21:58:21.338431 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: Close
[0m21:58:21.338789 [info ] [Thread-1 (]: 81 of 91 START test unique_mart_daily_revenue_date_key ......................... [RUN]
[0m21:58:21.339498 [info ] [Thread-2 (]: 79 of 91 PASS not_null_mart_daily_revenue_date_key ............................. [[32mPASS[0m in 0.04s]
[0m21:58:21.339877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9, now test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7)
[0m21:58:21.340152 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:58:21.340421 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m21:58:21.340694 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m21:58:21.341594 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: COMMIT
[0m21:58:21.343841 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m21:58:21.344189 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m21:58:21.344726 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: COMMIT
[0m21:58:21.347703 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m21:58:21.349113 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m21:58:21.349405 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
drop table if exists "dev"."main"."mart_hourly_demand__dbt_backup" cascade
[0m21:58:21.351010 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m21:58:21.352239 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m21:58:21.352638 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m21:58:21.353459 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: Close
[0m21:58:21.353882 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c8ce2c5-1c6d-497c-9be8-24ed718e61c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ee35471370>]}
[0m21:58:21.354359 [info ] [Thread-4 (]: 78 of 91 OK created sql table model main.mart_hourly_demand .................... [[32mOK[0m in 0.22s]
[0m21:58:21.354813 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m21:58:21.355352 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m21:58:21.355557 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m21:58:21.355753 [info ] [Thread-2 (]: 82 of 91 START test not_null_mart_hourly_demand_is_weekend ..................... [RUN]
[0m21:58:21.356430 [info ] [Thread-4 (]: 83 of 91 START test not_null_mart_hourly_demand_pickup_hour .................... [RUN]
[0m21:58:21.356818 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a, now test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8)
[0m21:58:21.357177 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.mart_hourly_demand, now test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418)
[0m21:58:21.357608 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m21:58:21.358038 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m21:58:21.360694 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m21:58:21.360965 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m21:58:21.364034 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: BEGIN
[0m21:58:21.362949 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m21:58:21.364549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:21.365526 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:21.365840 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m21:58:21.366243 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "dev"."main"."mart_daily_revenue"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:58:21.367158 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:21.368143 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: ROLLBACK
[0m21:58:21.369046 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7'
[0m21:58:21.369584 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: Close
[0m21:58:21.370094 [info ] [Thread-1 (]: 81 of 91 PASS unique_mart_daily_revenue_date_key ............................... [[32mPASS[0m in 0.03s]
[0m21:58:21.370325 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m21:58:21.370678 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m21:58:21.373227 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m21:58:21.373478 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m21:58:21.375356 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m21:58:21.379156 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m21:58:21.379919 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: BEGIN
[0m21:58:21.380229 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:21.380733 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m21:58:21.381349 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:58:21.381974 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: BEGIN
[0m21:58:21.382368 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m21:58:21.382853 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:58:21.383213 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."mart_hourly_demand"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m21:58:21.383884 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:58:21.384446 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m21:58:21.384696 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:58:21.384908 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."mart_hourly_demand"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m21:58:21.386088 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: ROLLBACK
[0m21:58:21.386882 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8'
[0m21:58:21.387190 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:58:21.387420 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: Close
[0m21:58:21.388320 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: ROLLBACK
[0m21:58:21.388733 [info ] [Thread-2 (]: 82 of 91 PASS not_null_mart_hourly_demand_is_weekend ........................... [[32mPASS[0m in 0.03s]
[0m21:58:21.389423 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418'
[0m21:58:21.389861 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m21:58:21.390315 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: Close
[0m21:58:21.390994 [info ] [Thread-4 (]: 83 of 91 PASS not_null_mart_hourly_demand_pickup_hour .......................... [[32mPASS[0m in 0.03s]
[0m21:58:21.391374 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m21:58:24.765020 [debug] [Thread-3 (]: SQL status: OK in 4.360 seconds
[0m21:58:24.767109 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m21:58:24.767619 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
alter table "dev"."main"."fct_trips" rename to "fct_trips__dbt_backup"
[0m21:58:24.768392 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m21:58:24.769991 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m21:58:24.770268 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
alter table "dev"."main"."fct_trips__dbt_tmp" rename to "fct_trips"
[0m21:58:24.770763 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m21:58:24.771614 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.fct_trips: COMMIT
[0m21:58:24.772062 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m21:58:24.772392 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.fct_trips: COMMIT
[0m21:58:25.098696 [debug] [Thread-3 (]: SQL status: OK in 0.326 seconds
[0m21:58:25.100470 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m21:58:25.100847 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
drop table if exists "dev"."main"."fct_trips__dbt_backup" cascade
[0m21:58:25.404305 [debug] [Thread-3 (]: SQL status: OK in 0.303 seconds
[0m21:58:25.405703 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.fct_trips: Close
[0m21:58:25.457979 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c8ce2c5-1c6d-497c-9be8-24ed718e61c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ee240ed940>]}
[0m21:58:25.459017 [info ] [Thread-3 (]: 67 of 91 OK created sql incremental model main.fct_trips ....................... [[32mOK[0m in 5.13s]
[0m21:58:25.459782 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.fct_trips
[0m21:58:25.460602 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m21:58:25.460867 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m21:58:25.461094 [info ] [Thread-1 (]: 84 of 91 START test not_null_fct_trips_pickup_datetime ......................... [RUN]
[0m21:58:25.461371 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m21:58:25.461658 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m21:58:25.461877 [info ] [Thread-2 (]: 85 of 91 START test not_null_fct_trips_total_amount ............................ [RUN]
[0m21:58:25.462792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7, now test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83)
[0m21:58:25.463247 [info ] [Thread-4 (]: 86 of 91 START test not_null_fct_trips_trip_id ................................. [RUN]
[0m21:58:25.463670 [info ] [Thread-3 (]: 87 of 91 START test unique_fct_trips_trip_id ................................... [RUN]
[0m21:58:25.464051 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8, now test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d)
[0m21:58:25.464368 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m21:58:25.464687 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418, now test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d)
[0m21:58:25.464966 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.fct_trips, now test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab)
[0m21:58:25.465227 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m21:58:25.467750 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m21:58:25.468267 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m21:58:25.468573 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m21:58:25.470516 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m21:58:25.472922 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m21:58:25.474866 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m21:58:25.477298 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m21:58:25.479657 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m21:58:25.480376 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m21:58:25.480617 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m21:58:25.481942 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m21:58:25.483336 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m21:58:25.483615 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m21:58:25.485399 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m21:58:25.488410 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m21:58:25.488718 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: BEGIN
[0m21:58:25.489055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:25.489358 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m21:58:25.490080 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: BEGIN
[0m21:58:25.490335 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m21:58:25.490559 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:25.490880 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: BEGIN
[0m21:58:25.491318 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:58:25.492096 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m21:58:25.492457 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: BEGIN
[0m21:58:25.492828 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:25.506268 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m21:58:25.506629 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m21:58:25.506859 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m21:58:25.507074 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m21:58:25.507300 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m21:58:25.507722 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m21:58:25.508055 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m21:58:25.508360 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m21:58:25.508702 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "dev"."main"."fct_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m21:58:25.508986 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."main"."fct_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:58:25.509320 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."fct_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m21:58:25.509619 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."fct_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m21:58:25.510706 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:58:25.510979 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:58:25.512612 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m21:58:25.515907 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: ROLLBACK
[0m21:58:25.518000 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: ROLLBACK
[0m21:58:25.519511 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: ROLLBACK
[0m21:58:25.520577 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83'
[0m21:58:25.522547 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d'
[0m21:58:25.524324 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d'
[0m21:58:25.525978 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: Close
[0m21:58:25.528448 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: Close
[0m21:58:25.530198 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: Close
[0m21:58:25.533353 [info ] [Thread-1 (]: 84 of 91 PASS not_null_fct_trips_pickup_datetime ............................... [[32mPASS[0m in 0.07s]
[0m21:58:25.535184 [info ] [Thread-2 (]: 85 of 91 PASS not_null_fct_trips_total_amount .................................. [[32mPASS[0m in 0.07s]
[0m21:58:25.536959 [info ] [Thread-4 (]: 86 of 91 PASS not_null_fct_trips_trip_id ....................................... [[32mPASS[0m in 0.07s]
[0m21:58:25.538758 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m21:58:25.540556 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m21:58:25.543971 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m21:58:25.629506 [debug] [Thread-3 (]: SQL status: OK in 0.119 seconds
[0m21:58:25.631187 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: ROLLBACK
[0m21:58:25.631830 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab'
[0m21:58:25.632147 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: Close
[0m21:58:25.653300 [info ] [Thread-3 (]: 87 of 91 PASS unique_fct_trips_trip_id ......................................... [[32mPASS[0m in 0.19s]
[0m21:58:25.654104 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m21:58:25.654996 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.mart_location_performance
[0m21:58:25.655553 [info ] [Thread-1 (]: 88 of 91 START sql table model main.mart_location_performance .................. [RUN]
[0m21:58:25.656006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83, now model.nyc_taxi_pipeline_00.mart_location_performance)
[0m21:58:25.656415 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_location_performance
[0m21:58:25.658891 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m21:58:25.664892 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.mart_location_performance
[0m21:58:25.666966 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m21:58:25.667355 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Location-level performance summary.
    Uses adapter-dispatched mode_compat() for cross-dialect support.
*/

with trips as (
    select * from "dev"."main"."fct_trips"
),

final as (
    select
        pickup_location_id,
        pickup_borough,
        pickup_zone,

        count(*) as total_pickups,
        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue_per_trip,
        round(avg(tip_percentage), 2) as avg_tip_pct,
        round(avg(passenger_count), 2) as avg_passengers,

        -- most common dropoff destination
        
    mode(dropoff_zone)
 as most_common_dropoff_zone,

        -- busiest hour
        
    mode(pickup_hour)
 as peak_pickup_hour

    from trips
    where pickup_zone is not null
    group by pickup_location_id, pickup_borough, pickup_zone
)

select * from final
order by total_pickups desc
    ) as __dbt_sbq
    where false
    limit 0
)
[0m21:58:25.667691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:25.683425 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m21:58:25.685249 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m21:58:25.685669 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as varchar)
 as pickup_borough, 
      
    cast(null as varchar)
 as pickup_zone, 
      
    cast(null as bigint)
 as total_pickups, 
      
    cast(null as double)
 as avg_trip_distance, 
      
    cast(null as double)
 as avg_trip_duration_min, 
      
    cast(null as decimal(38,2))
 as total_revenue, 
      
    cast(null as double)
 as avg_revenue_per_trip, 
      
    cast(null as double)
 as avg_tip_pct, 
      
    cast(null as double)
 as avg_passengers, 
      
    cast(null as varchar)
 as most_common_dropoff_zone, 
      
    cast(null as bigint)
 as peak_pickup_hour
    ) as __dbt_sbq
    where false
    limit 0
)
[0m21:58:25.686243 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:58:25.687595 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m21:58:25.693033 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m21:58:25.693308 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: BEGIN
[0m21:58:25.693703 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:58:25.694006 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m21:58:25.694283 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_location_performance__dbt_tmp"
  
  (
    pickup_location_id integer,
    pickup_borough varchar,
    pickup_zone varchar,
    total_pickups bigint,
    avg_trip_distance double,
    avg_trip_duration_min double,
    total_revenue decimal(38,2),
    avg_revenue_per_trip double,
    avg_tip_pct double,
    avg_passengers double,
    most_common_dropoff_zone varchar,
    peak_pickup_hour bigint
    
    )
 ;
    insert into "dev"."main"."mart_location_performance__dbt_tmp" 
  (
    
      
      pickup_location_id ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      total_pickups ,
    
      
      avg_trip_distance ,
    
      
      avg_trip_duration_min ,
    
      
      total_revenue ,
    
      
      avg_revenue_per_trip ,
    
      
      avg_tip_pct ,
    
      
      avg_passengers ,
    
      
      most_common_dropoff_zone ,
    
      
      peak_pickup_hour 
    
  )
 (
      
    select pickup_location_id, pickup_borough, pickup_zone, total_pickups, avg_trip_distance, avg_trip_duration_min, total_revenue, avg_revenue_per_trip, avg_tip_pct, avg_passengers, most_common_dropoff_zone, peak_pickup_hour
    from (
        /*
    Analytics mart: Location-level performance summary.
    Uses adapter-dispatched mode_compat() for cross-dialect support.
*/

with trips as (
    select * from "dev"."main"."fct_trips"
),

final as (
    select
        pickup_location_id,
        pickup_borough,
        pickup_zone,

        count(*) as total_pickups,
        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue_per_trip,
        round(avg(tip_percentage), 2) as avg_tip_pct,
        round(avg(passenger_count), 2) as avg_passengers,

        -- most common dropoff destination
        
    mode(dropoff_zone)
 as most_common_dropoff_zone,

        -- busiest hour
        
    mode(pickup_hour)
 as peak_pickup_hour

    from trips
    where pickup_zone is not null
    group by pickup_location_id, pickup_borough, pickup_zone
)

select * from final
order by total_pickups desc
    ) as model_subq
    );
  
  
[0m21:58:25.787582 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m21:58:25.789805 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m21:58:25.790301 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
alter table "dev"."main"."mart_location_performance" rename to "mart_location_performance__dbt_backup"
[0m21:58:25.790856 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:58:25.792265 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m21:58:25.792633 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
alter table "dev"."main"."mart_location_performance__dbt_tmp" rename to "mart_location_performance"
[0m21:58:25.793071 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:58:25.793930 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: COMMIT
[0m21:58:25.794432 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m21:58:25.794820 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: COMMIT
[0m21:58:25.800321 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:58:25.802642 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m21:58:25.803055 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
drop table if exists "dev"."main"."mart_location_performance__dbt_backup" cascade
[0m21:58:25.805361 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:58:25.806323 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: Close
[0m21:58:25.852475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c8ce2c5-1c6d-497c-9be8-24ed718e61c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ee3538b380>]}
[0m21:58:25.853276 [info ] [Thread-1 (]: 88 of 91 OK created sql table model main.mart_location_performance ............. [[32mOK[0m in 0.20s]
[0m21:58:25.853855 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.mart_location_performance
[0m21:58:25.854590 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m21:58:25.854826 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m21:58:25.855036 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m21:58:25.855248 [info ] [Thread-4 (]: 89 of 91 START test not_null_mart_location_performance_pickup_location_id ...... [RUN]
[0m21:58:25.855609 [info ] [Thread-3 (]: 90 of 91 START test not_null_mart_location_performance_total_pickups ........... [RUN]
[0m21:58:25.855948 [info ] [Thread-2 (]: 91 of 91 START test unique_mart_location_performance_pickup_location_id ........ [RUN]
[0m21:58:25.856330 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d, now test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c)
[0m21:58:25.856684 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab, now test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259)
[0m21:58:25.857035 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d, now test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62)
[0m21:58:25.857463 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m21:58:25.857791 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m21:58:25.858152 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m21:58:25.860413 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m21:58:25.862571 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m21:58:25.864674 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m21:58:25.869618 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m21:58:25.871051 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m21:58:25.871318 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m21:58:25.872905 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m21:58:25.873144 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m21:58:25.874608 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m21:58:25.878186 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m21:58:25.878898 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m21:58:25.879122 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: BEGIN
[0m21:58:25.879463 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: BEGIN
[0m21:58:25.879783 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m21:58:25.880107 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:25.880574 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:58:25.881119 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: BEGIN
[0m21:58:25.882039 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:25.896927 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m21:58:25.897272 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m21:58:25.897531 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m21:58:25.897718 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m21:58:25.898251 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m21:58:25.898627 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pickup_location_id as unique_field,
    count(*) as n_records

from "dev"."main"."mart_location_performance"
where pickup_location_id is not null
group by pickup_location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:58:25.898950 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m21:58:25.899242 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_location_id
from "dev"."main"."mart_location_performance"
where pickup_location_id is null



  
  
      
    ) dbt_internal_test
[0m21:58:25.899776 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_pickups
from "dev"."main"."mart_location_performance"
where total_pickups is null



  
  
      
    ) dbt_internal_test
[0m21:58:25.900659 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:58:25.900898 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m21:58:25.902035 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: ROLLBACK
[0m21:58:25.902888 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: ROLLBACK
[0m21:58:25.903097 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m21:58:25.903779 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c'
[0m21:58:25.904214 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259'
[0m21:58:25.905131 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: ROLLBACK
[0m21:58:25.905323 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: Close
[0m21:58:25.905618 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: Close
[0m21:58:25.906178 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62'
[0m21:58:25.906790 [info ] [Thread-4 (]: 89 of 91 PASS not_null_mart_location_performance_pickup_location_id ............ [[32mPASS[0m in 0.05s]
[0m21:58:25.907210 [info ] [Thread-3 (]: 90 of 91 PASS not_null_mart_location_performance_total_pickups ................. [[32mPASS[0m in 0.05s]
[0m21:58:25.907436 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: Close
[0m21:58:25.907869 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m21:58:25.908291 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m21:58:25.910652 [info ] [Thread-2 (]: 91 of 91 PASS unique_mart_location_performance_pickup_location_id .............. [[32mPASS[0m in 0.05s]
[0m21:58:25.911098 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m21:58:25.912371 [debug] [MainThread]: Using duckdb connection "master"
[0m21:58:25.912689 [debug] [MainThread]: On master: BEGIN
[0m21:58:25.912992 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:58:25.927426 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m21:58:25.927809 [debug] [MainThread]: On master: COMMIT
[0m21:58:25.928099 [debug] [MainThread]: Using duckdb connection "master"
[0m21:58:25.928344 [debug] [MainThread]: On master: COMMIT
[0m21:58:25.928890 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:58:25.929278 [debug] [MainThread]: On master: Close
[0m21:58:25.931362 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:58:25.931819 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m21:58:25.932106 [debug] [MainThread]: Connection 'model.nyc_taxi_pipeline_00.mart_location_performance' was properly closed.
[0m21:58:25.932345 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62' was properly closed.
[0m21:58:25.932599 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259' was properly closed.
[0m21:58:25.933144 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c' was properly closed.
[0m21:58:25.933613 [info ] [MainThread]: 
[0m21:58:25.934006 [info ] [MainThread]: Finished running 1 incremental model, 3 seeds, 7 table models, 74 data tests, 6 view models in 0 hours 0 minutes and 8.80 seconds (8.80s).
[0m21:58:25.938386 [debug] [MainThread]: Command end result
[0m21:58:25.972561 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m21:58:25.976102 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m21:58:25.985368 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m21:58:25.985693 [info ] [MainThread]: 
[0m21:58:25.986154 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:58:25.986726 [info ] [MainThread]: 
[0m21:58:25.987204 [info ] [MainThread]: Done. PASS=91 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=91
[0m21:58:25.988013 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 10.046754, "process_in_blocks": "86872", "process_kernel_time": 4.984829, "process_mem_max_rss": "1758644", "process_out_blocks": "136", "process_user_time": 18.332256}
[0m21:58:25.988436 [debug] [MainThread]: Command `dbt build` succeeded at 21:58:25.988345 after 10.05 seconds
[0m21:58:25.988815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74eea5e1a9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74eea51a9cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74eea7e52600>]}
[0m21:58:25.989172 [debug] [MainThread]: Flushing usage events
[0m21:58:26.420761 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:40:15.393039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3f3ab0ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3f3c646210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3f3ab0f4d0>]}


============================== 14:40:15.396932 | 12713b8a-7797-49dc-9766-6a948a4ab65c ==============================
[0m14:40:15.396932 [info ] [MainThread]: Running with dbt=1.11.4
[0m14:40:15.397363 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '.', 'printer_width': '80', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps --profiles-dir .', 'empty': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'warn_error': 'None', 'quiet': 'False', 'use_colors': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'static_parser': 'True', 'target_path': 'None', 'fail_fast': 'False', 'log_format': 'default', 'partial_parse': 'True'}
[0m14:40:15.470444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12713b8a-7797-49dc-9766-6a948a4ab65c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3f399f2510>]}
[0m14:40:15.858276 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-nt_32idj'
[0m14:40:15.858817 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:40:16.054810 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:40:16.056202 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:40:16.178193 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:40:16.181668 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:40:19.794401 [info ] [MainThread]: Installed from version 1.3.3
[0m14:40:19.794887 [info ] [MainThread]: Up to date!
[0m14:40:19.795295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '12713b8a-7797-49dc-9766-6a948a4ab65c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3f3a5beff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3f399aeea0>]}
[0m14:40:19.796722 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.486572, "process_in_blocks": "106440", "process_kernel_time": 0.396616, "process_mem_max_rss": "105400", "process_out_blocks": "176", "process_user_time": 0.991541}
[0m14:40:19.797312 [debug] [MainThread]: Command `dbt deps` succeeded at 14:40:19.797225 after 4.49 seconds
[0m14:40:19.797670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3f3a282f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3f3a24ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3f39e43830>]}
[0m14:40:19.798067 [debug] [MainThread]: Flushing usage events
[0m14:40:20.078172 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:40:21.045687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f5c6db34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f5c6a4ba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f5c6db3650>]}


============================== 14:40:21.048349 | 464e5f25-1623-4796-ade1-b5af4241b61b ==============================
[0m14:40:21.048349 [info ] [MainThread]: Running with dbt=1.11.4
[0m14:40:21.049027 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'static_parser': 'True', 'invocation_command': 'dbt build --full-refresh --profiles-dir .', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'printer_width': '80', 'warn_error': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'log_format': 'default', 'introspect': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'profiles_dir': '.', 'write_json': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m14:40:21.257669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '464e5f25-1623-4796-ade1-b5af4241b61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f5c5ff0f50>]}
[0m14:40:21.298189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '464e5f25-1623-4796-ade1-b5af4241b61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f5c6706f30>]}
[0m14:40:21.299863 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:40:21.354532 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m14:40:22.106684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:40:22.107096 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m14:40:22.107447 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:40:22.139905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '464e5f25-1623-4796-ade1-b5af4241b61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f5c5f2f260>]}
[0m14:40:22.217044 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:40:22.222314 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:40:22.257007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '464e5f25-1623-4796-ade1-b5af4241b61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f5b5d420c0>]}
[0m14:40:22.257439 [info ] [MainThread]: Found 14 models, 74 data tests, 3 seeds, 1 source, 578 macros
[0m14:40:22.260863 [info ] [MainThread]: 
[0m14:40:22.261290 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:40:22.261595 [info ] [MainThread]: 
[0m14:40:22.262197 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:40:22.265343 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m14:40:22.346770 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m14:40:22.347311 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m14:40:22.347657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:22.377590 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m14:40:22.378807 [debug] [ThreadPool]: On list_dev: Close
[0m14:40:22.383325 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m14:40:22.383850 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m14:40:22.387247 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:40:22.387626 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m14:40:22.387935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:22.403448 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m14:40:22.404627 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:40:22.405073 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m14:40:22.405514 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:40:22.405754 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:40:22.406036 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m14:40:22.406450 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:40:22.407018 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:40:22.407404 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:40:22.407678 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:40:22.408075 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:40:22.408379 [debug] [ThreadPool]: On create_dev_main: Close
[0m14:40:22.412030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m14:40:22.415082 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:40:22.415490 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:40:22.415847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:22.430731 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m14:40:22.431353 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:40:22.431687 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:40:22.438919 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m14:40:22.440087 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:40:22.441187 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:40:22.441477 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:40:22.445250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '464e5f25-1623-4796-ade1-b5af4241b61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f5b63b89e0>]}
[0m14:40:22.445886 [debug] [MainThread]: Using duckdb connection "master"
[0m14:40:22.446374 [debug] [MainThread]: On master: BEGIN
[0m14:40:22.446619 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:40:22.465447 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m14:40:22.466023 [debug] [MainThread]: On master: COMMIT
[0m14:40:22.466389 [debug] [MainThread]: Using duckdb connection "master"
[0m14:40:22.466699 [debug] [MainThread]: On master: COMMIT
[0m14:40:22.467243 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:40:22.467520 [debug] [MainThread]: On master: Close
[0m14:40:22.473900 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.dim_dates
[0m14:40:22.474170 [debug] [Thread-2 (]: Began running node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m14:40:22.474405 [debug] [Thread-3 (]: Began running node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m14:40:22.474593 [debug] [Thread-4 (]: Began running node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m14:40:22.474870 [info ] [Thread-1 (]: 1 of 91 START sql table model main.dim_dates ................................... [RUN]
[0m14:40:22.475326 [info ] [Thread-2 (]: 2 of 91 START sql table model main.stg_yellow_trips ............................ [RUN]
[0m14:40:22.475738 [info ] [Thread-3 (]: 3 of 91 START seed file main.payment_type_lookup ............................... [RUN]
[0m14:40:22.476362 [info ] [Thread-4 (]: 4 of 91 START seed file main.rate_code_lookup .................................. [RUN]
[0m14:40:22.476769 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nyc_taxi_pipeline_00.dim_dates'
[0m14:40:22.477130 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.nyc_taxi_pipeline_00.stg_yellow_trips'
[0m14:40:22.477498 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.nyc_taxi_pipeline_00.payment_type_lookup'
[0m14:40:22.477847 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.nyc_taxi_pipeline_00.rate_code_lookup'
[0m14:40:22.479001 [debug] [Thread-4 (]: Began compiling node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m14:40:22.478433 [debug] [Thread-2 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m14:40:22.478722 [debug] [Thread-3 (]: Began compiling node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m14:40:22.478129 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_dates
[0m14:40:22.479270 [debug] [Thread-4 (]: Began executing node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m14:40:22.489491 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m14:40:22.489839 [debug] [Thread-3 (]: Began executing node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m14:40:22.499189 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:40:22.509061 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: BEGIN
[0m14:40:22.509658 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:40:22.517640 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m14:40:22.518170 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.rate_code_lookup"} */
drop table if exists "dev"."main"."rate_code_lookup" cascade
[0m14:40:22.518582 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:40:22.519926 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m14:40:22.520415 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.payment_type_lookup"} */
drop table if exists "dev"."main"."payment_type_lookup" cascade
[0m14:40:22.520677 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:40:22.520879 [debug] [Thread-2 (]: Began executing node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m14:40:22.535081 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m14:40:22.535843 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m14:40:22.536205 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:40:22.536533 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */


        select 
        (date_diff('day', cast('2024-01-01' as date)::timestamp, cast('2024-02-01' as date)::timestamp ))
    
[0m14:40:22.537750 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.544738 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:40:22.545044 [debug] [Thread-4 (]: SQL status: OK in 0.026 seconds
[0m14:40:22.548805 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m14:40:22.549050 [debug] [Thread-3 (]: SQL status: OK in 0.028 seconds
[0m14:40:22.549226 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: BEGIN
[0m14:40:22.549974 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m14:40:22.550218 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m14:40:22.550624 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: BEGIN
[0m14:40:22.550863 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:40:22.551053 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: BEGIN
[0m14:40:22.551453 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:40:22.551633 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m14:40:22.551925 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:40:22.552183 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m14:40:22.552385 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.dim_dates
[0m14:40:22.552654 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.rate_code_lookup"} */

    create table "dev"."main"."rate_code_lookup" ("rate_code_id" integer,"rate_code_name" varchar)
  
[0m14:40:22.553181 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.553374 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.payment_type_lookup"} */

    create table "dev"."main"."payment_type_lookup" ("payment_type_id" integer,"payment_type_name" varchar)
  
[0m14:40:22.564138 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:40:22.564922 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m14:40:22.565186 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.565687 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
DESCRIBE (select * from (
        /*
    Dimension table: Calendar dates for January 2024.
    Uses adapter-dispatched macros for dayname/monthname.
*/

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 31
    order by generated_number



),

all_periods as (

    select (
        

    date_add(cast('2024-01-01' as date), interval (row_number() over (order by generated_number) - 1) day)


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-02-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week_num,
        
    dayname(date_day)
 as day_of_week_name,
        
    monthname(date_day)
 as month_name,
        extract(week from date_day) as week_of_year,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when cast(date_day as date) in (
                cast('2024-01-01' as date),
                cast('2024-01-15' as date)
            ) then true
            else false
        end as is_holiday

    from date_spine
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:40:22.566010 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.566323 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */

  
    
    

    create  table
      "dev"."main"."stg_yellow_trips__dbt_tmp"
  
    as (
      

with source as (
    select * from read_parquet('/data/yellow_tripdata_2024-01.parquet')
),

renamed as (
    select
        -- surrogate key (MD5 hash of composite key)
        md5(cast(coalesce(cast(VendorID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(PULocationID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DOLocationID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(fare_amount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(total_amount as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- identifiers
        cast("VendorID" as integer) as vendor_id,
        cast("RatecodeID" as integer) as rate_code_id,
        cast("PULocationID" as integer) as pickup_location_id,
        cast("DOLocationID" as integer) as dropoff_location_id,
        cast(payment_type as integer) as payment_type_id,

        -- timestamps
        cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
        cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as double) as trip_distance_miles,
        store_and_fwd_flag,

        -- financials
        round(cast(fare_amount as decimal(10, 2)), 2) as fare_amount,
        round(cast(extra as decimal(10, 2)), 2) as extra_amount,
        round(cast(mta_tax as decimal(10, 2)), 2) as mta_tax,
        round(cast(tip_amount as decimal(10, 2)), 2) as tip_amount,
        round(cast(tolls_amount as decimal(10, 2)), 2) as tolls_amount,
        round(cast(improvement_surcharge as decimal(10, 2)), 2) as improvement_surcharge,
        round(cast(total_amount as decimal(10, 2)), 2) as total_amount,
        round(cast(congestion_surcharge as decimal(10, 2)), 2) as congestion_surcharge,
        round(cast(Airport_fee as decimal(10, 2)), 2) as airport_fee

    from source
    where tpep_pickup_datetime is not null
      and tpep_dropoff_datetime is not null
      and trip_distance >= 0
      and fare_amount >= 0
      -- filter out-of-range dates (data quality: ~18 trips outside Jan 2024)
      and cast(tpep_pickup_datetime as date) >= date '2024-01-01'
      and cast(tpep_pickup_datetime as date) < date '2024-02-01'
)

select * from renamed
    );
  
  
[0m14:40:22.571754 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m14:40:22.574619 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m14:40:22.575635 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:40:22.575947 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: 
          COPY "dev"."main"."rate_code_lookup" FROM '/dbt/seeds/rate_code_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m14:40:22.576275 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: 
          COPY "dev"."main"."payment_type_lookup" FROM '/dbt/seeds/payment_type_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m14:40:22.583418 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:40:22.584626 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as date_key, 
      
    cast(null as bigint)
 as year, 
      
    cast(null as bigint)
 as month, 
      
    cast(null as bigint)
 as day_of_month, 
      
    cast(null as bigint)
 as day_of_week_num, 
      
    cast(null as varchar)
 as day_of_week_name, 
      
    cast(null as varchar)
 as month_name, 
      
    cast(null as bigint)
 as week_of_year, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as boolean)
 as is_holiday
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:40:22.585859 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:40:22.598197 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:40:22.598598 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m14:40:22.598838 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m14:40:22.601877 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m14:40:22.602896 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m14:40:22.614492 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: COMMIT
[0m14:40:22.614872 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:40:22.615144 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m14:40:22.616131 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: COMMIT
[0m14:40:22.616398 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_dates__dbt_tmp"
  
  (
    date_key date,
    year bigint,
    month bigint,
    day_of_month bigint,
    day_of_week_num bigint,
    day_of_week_name varchar,
    month_name varchar,
    week_of_year bigint,
    is_weekend boolean,
    is_holiday boolean
    
    )
 ;
    insert into "dev"."main"."dim_dates__dbt_tmp" 
  (
    
      
      date_key ,
    
      
      year ,
    
      
      month ,
    
      
      day_of_month ,
    
      
      day_of_week_num ,
    
      
      day_of_week_name ,
    
      
      month_name ,
    
      
      week_of_year ,
    
      
      is_weekend ,
    
      
      is_holiday 
    
  )
 (
      
    select date_key, year, month, day_of_month, day_of_week_num, day_of_week_name, month_name, week_of_year, is_weekend, is_holiday
    from (
        /*
    Dimension table: Calendar dates for January 2024.
    Uses adapter-dispatched macros for dayname/monthname.
*/

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 31
    order by generated_number



),

all_periods as (

    select (
        

    date_add(cast('2024-01-01' as date), interval (row_number() over (order by generated_number) - 1) day)


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-02-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week_num,
        
    dayname(date_day)
 as day_of_week_name,
        
    monthname(date_day)
 as month_name,
        extract(week from date_day) as week_of_year,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when cast(date_day as date) in (
                cast('2024-01-01' as date),
                cast('2024-01-15' as date)
            ) then true
            else false
        end as is_holiday

    from date_spine
)

select * from final
    ) as model_subq
    );
  
  
[0m14:40:22.617201 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: COMMIT
[0m14:40:22.617587 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m14:40:22.619410 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: COMMIT
[0m14:40:22.622196 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:40:22.623594 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: Close
[0m14:40:22.625325 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '464e5f25-1623-4796-ade1-b5af4241b61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f579eac140>]}
[0m14:40:22.625971 [info ] [Thread-4 (]: 4 of 91 OK loaded seed file main.rate_code_lookup .............................. [[32mCREATE 7[0m in 0.15s]
[0m14:40:22.626318 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m14:40:22.626646 [debug] [Thread-4 (]: Finished running node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m14:40:22.627374 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: Close
[0m14:40:22.627794 [debug] [Thread-4 (]: Began running node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m14:40:22.628537 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '464e5f25-1623-4796-ade1-b5af4241b61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f579ece480>]}
[0m14:40:22.628906 [info ] [Thread-4 (]: 5 of 91 START seed file main.taxi_zone_lookup .................................. [RUN]
[0m14:40:22.630020 [info ] [Thread-3 (]: 3 of 91 OK loaded seed file main.payment_type_lookup ........................... [[32mCREATE 6[0m in 0.15s]
[0m14:40:22.630478 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.rate_code_lookup, now seed.nyc_taxi_pipeline_00.taxi_zone_lookup)
[0m14:40:22.630877 [debug] [Thread-3 (]: Finished running node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m14:40:22.631595 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m14:40:22.631831 [debug] [Thread-4 (]: Began compiling node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m14:40:22.632224 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m14:40:22.635924 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:40:22.636302 [debug] [Thread-4 (]: Began executing node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m14:40:22.636675 [info ] [Thread-3 (]: 6 of 91 START test not_null_rate_code_lookup_rate_code_id ...................... [RUN]
[0m14:40:22.637037 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
alter table "dev"."main"."dim_dates" rename to "dim_dates__dbt_backup"
[0m14:40:22.638704 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.payment_type_lookup, now test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec)
[0m14:40:22.639427 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:40:22.639640 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m14:40:22.641519 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:40:22.647807 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m14:40:22.648633 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
alter table "dev"."main"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m14:40:22.650436 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.651962 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m14:40:22.652900 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: COMMIT
[0m14:40:22.653783 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"} */
drop table if exists "dev"."main"."taxi_zone_lookup" cascade
[0m14:40:22.654147 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:40:22.654532 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:22.654895 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: COMMIT
[0m14:40:22.657520 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:40:22.657825 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m14:40:22.658713 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m14:40:22.669514 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m14:40:22.669066 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m14:40:22.670077 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: BEGIN
[0m14:40:22.671691 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:40:22.672486 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:40:22.672761 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
drop table if exists "dev"."main"."dim_dates__dbt_backup" cascade
[0m14:40:22.673254 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m14:40:22.674257 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"} */

    create table "dev"."main"."taxi_zone_lookup" ("LocationID" integer,"Borough" varchar,"Zone" varchar,"service_zone" varchar)
  
[0m14:40:22.675364 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:40:22.676555 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m14:40:22.677046 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: 
          COPY "dev"."main"."taxi_zone_lookup" FROM '/dbt/seeds/taxi_zone_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m14:40:22.677337 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:40:22.678844 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: Close
[0m14:40:22.679465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '464e5f25-1623-4796-ade1-b5af4241b61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f579f5da60>]}
[0m14:40:22.680224 [info ] [Thread-1 (]: 1 of 91 OK created sql table model main.dim_dates .............................. [[32mOK[0m in 0.20s]
[0m14:40:22.680828 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.dim_dates
[0m14:40:22.681327 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m14:40:22.681773 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m14:40:22.682070 [info ] [Thread-1 (]: 7 of 91 START test unique_rate_code_lookup_rate_code_id ........................ [RUN]
[0m14:40:22.682556 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: BEGIN
[0m14:40:22.683089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_dates, now test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d)
[0m14:40:22.683563 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:22.684233 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m14:40:22.689049 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m14:40:22.689459 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m14:40:22.690015 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m14:40:22.690315 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m14:40:22.690581 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_id
from "dev"."main"."rate_code_lookup"
where rate_code_id is null



  
  
      
    ) dbt_internal_test
[0m14:40:22.691186 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m14:40:22.692994 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.695330 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: ROLLBACK
[0m14:40:22.695971 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec'
[0m14:40:22.696340 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: Close
[0m14:40:22.696875 [info ] [Thread-3 (]: 6 of 91 PASS not_null_rate_code_lookup_rate_code_id ............................ [[32mPASS[0m in 0.06s]
[0m14:40:22.697467 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m14:40:22.697975 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m14:40:22.698347 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m14:40:22.698642 [info ] [Thread-3 (]: 8 of 91 START test not_null_payment_type_lookup_payment_type_id ................ [RUN]
[0m14:40:22.700634 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m14:40:22.701294 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec, now test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521)
[0m14:40:22.702754 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: COMMIT
[0m14:40:22.703402 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m14:40:22.703875 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m14:40:22.706715 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m14:40:22.707547 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: COMMIT
[0m14:40:22.712676 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m14:40:22.713186 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m14:40:22.713570 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: BEGIN
[0m14:40:22.714517 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: Close
[0m14:40:22.715002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:22.715878 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '464e5f25-1623-4796-ade1-b5af4241b61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f579f59df0>]}
[0m14:40:22.716366 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m14:40:22.716754 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:40:22.717133 [info ] [Thread-4 (]: 5 of 91 OK loaded seed file main.taxi_zone_lookup .............................. [[32mCREATE 265[0m in 0.09s]
[0m14:40:22.719125 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m14:40:22.719917 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m14:40:22.720572 [debug] [Thread-4 (]: Finished running node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m14:40:22.721321 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rate_code_id as unique_field,
    count(*) as n_records

from "dev"."main"."rate_code_lookup"
where rate_code_id is not null
group by rate_code_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:40:22.721794 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m14:40:22.723007 [info ] [Thread-4 (]: 9 of 91 START test unique_payment_type_lookup_payment_type_id .................. [RUN]
[0m14:40:22.723640 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.taxi_zone_lookup, now test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7)
[0m14:40:22.724076 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m14:40:22.724473 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:40:22.726949 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m14:40:22.728340 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: ROLLBACK
[0m14:40:22.729300 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d'
[0m14:40:22.729869 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m14:40:22.730128 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: Close
[0m14:40:22.730531 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: BEGIN
[0m14:40:22.731154 [info ] [Thread-1 (]: 7 of 91 PASS unique_rate_code_lookup_rate_code_id .............................. [[32mPASS[0m in 0.05s]
[0m14:40:22.731417 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:22.731948 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m14:40:22.732857 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m14:40:22.733424 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:40:22.733727 [info ] [Thread-1 (]: 10 of 91 START test not_null_dim_dates_date_key ................................ [RUN]
[0m14:40:22.734159 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m14:40:22.734653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d, now test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348)
[0m14:40:22.735208 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."payment_type_lookup"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m14:40:22.735600 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m14:40:22.736010 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m14:40:22.738973 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m14:40:22.739297 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:40:22.741692 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m14:40:22.743256 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: ROLLBACK
[0m14:40:22.744027 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521'
[0m14:40:22.744393 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: Close
[0m14:40:22.745104 [info ] [Thread-3 (]: 8 of 91 PASS not_null_payment_type_lookup_payment_type_id ...................... [[32mPASS[0m in 0.04s]
[0m14:40:22.745744 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m14:40:22.746158 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m14:40:22.746568 [info ] [Thread-3 (]: 11 of 91 START test not_null_dim_dates_day_of_week_name ........................ [RUN]
[0m14:40:22.747027 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521, now test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541)
[0m14:40:22.747422 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m14:40:22.749984 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m14:40:22.751247 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m14:40:22.751628 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m14:40:22.753110 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m14:40:22.753673 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: BEGIN
[0m14:40:22.754426 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:22.755148 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.755394 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m14:40:22.755693 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m14:40:22.757657 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m14:40:22.758090 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."payment_type_lookup"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:40:22.759501 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.760671 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: ROLLBACK
[0m14:40:22.761409 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7'
[0m14:40:22.762061 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: Close
[0m14:40:22.762724 [info ] [Thread-4 (]: 9 of 91 PASS unique_payment_type_lookup_payment_type_id ........................ [[32mPASS[0m in 0.04s]
[0m14:40:22.763026 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m14:40:22.763369 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m14:40:22.763789 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: BEGIN
[0m14:40:22.764190 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m14:40:22.764791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:22.765082 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m14:40:22.765552 [info ] [Thread-4 (]: 12 of 91 START test not_null_dim_dates_is_holiday .............................. [RUN]
[0m14:40:22.766388 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:40:22.766666 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: BEGIN
[0m14:40:22.767114 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7, now test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a)
[0m14:40:22.767454 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m14:40:22.767781 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:22.768107 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m14:40:22.768443 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "dev"."main"."dim_dates"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m14:40:22.771453 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m14:40:22.771880 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m14:40:22.772525 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m14:40:22.772780 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.773046 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select day_of_week_name
from "dev"."main"."dim_dates"
where day_of_week_name is null



  
  
      
    ) dbt_internal_test
[0m14:40:22.774151 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: ROLLBACK
[0m14:40:22.775131 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348'
[0m14:40:22.775404 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.775646 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: Close
[0m14:40:22.776639 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: ROLLBACK
[0m14:40:22.777220 [info ] [Thread-1 (]: 10 of 91 PASS not_null_dim_dates_date_key ...................................... [[32mPASS[0m in 0.04s]
[0m14:40:22.777765 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541'
[0m14:40:22.778213 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m14:40:22.778596 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: Close
[0m14:40:22.778990 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m14:40:22.779710 [info ] [Thread-3 (]: 11 of 91 PASS not_null_dim_dates_day_of_week_name .............................. [[32mPASS[0m in 0.03s]
[0m14:40:22.780137 [info ] [Thread-1 (]: 13 of 91 START test not_null_dim_dates_is_weekend .............................. [RUN]
[0m14:40:22.780912 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m14:40:22.781482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348, now test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0)
[0m14:40:22.782057 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m14:40:22.782390 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m14:40:22.782717 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m14:40:22.783291 [info ] [Thread-3 (]: 14 of 91 START test unique_dim_dates_date_key .................................. [RUN]
[0m14:40:22.785500 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m14:40:22.788065 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m14:40:22.788722 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541, now test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d)
[0m14:40:22.789668 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m14:40:22.791991 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m14:40:22.796995 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m14:40:22.798686 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m14:40:22.799594 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m14:40:22.799833 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m14:40:22.800070 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: BEGIN
[0m14:40:22.801582 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m14:40:22.802093 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:22.803271 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m14:40:22.803603 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: BEGIN
[0m14:40:22.803944 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:40:22.804236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:22.804629 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m14:40:22.805235 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.805477 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_holiday
from "dev"."main"."dim_dates"
where is_holiday is null



  
  
      
    ) dbt_internal_test
[0m14:40:22.805809 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m14:40:22.806418 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."dim_dates"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m14:40:22.806729 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.809637 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: ROLLBACK
[0m14:40:22.810081 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:40:22.810720 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a'
[0m14:40:22.811967 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: ROLLBACK
[0m14:40:22.812220 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: Close
[0m14:40:22.812972 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0'
[0m14:40:22.813573 [info ] [Thread-4 (]: 12 of 91 PASS not_null_dim_dates_is_holiday .................................... [[32mPASS[0m in 0.05s]
[0m14:40:22.813872 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m14:40:22.814128 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: Close
[0m14:40:22.814680 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m14:40:22.815170 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: BEGIN
[0m14:40:22.815711 [info ] [Thread-1 (]: 13 of 91 PASS not_null_dim_dates_is_weekend .................................... [[32mPASS[0m in 0.03s]
[0m14:40:22.816040 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m14:40:22.816586 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:22.817250 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m14:40:22.817701 [info ] [Thread-4 (]: 15 of 91 START test not_null_taxi_zone_lookup_Borough .......................... [RUN]
[0m14:40:22.818573 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m14:40:22.819025 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:40:22.819366 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a, now test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa)
[0m14:40:22.819768 [info ] [Thread-1 (]: 16 of 91 START test not_null_taxi_zone_lookup_LocationID ....................... [RUN]
[0m14:40:22.820122 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m14:40:22.820502 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m14:40:22.820895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0, now test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a)
[0m14:40:22.821256 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "dev"."main"."dim_dates"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:40:22.824137 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m14:40:22.824641 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m14:40:22.826181 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.828492 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m14:40:22.829962 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: ROLLBACK
[0m14:40:22.830859 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d'
[0m14:40:22.831267 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: Close
[0m14:40:22.831852 [info ] [Thread-3 (]: 14 of 91 PASS unique_dim_dates_date_key ........................................ [[32mPASS[0m in 0.04s]
[0m14:40:22.832372 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m14:40:22.832867 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m14:40:22.833342 [info ] [Thread-3 (]: 17 of 91 START test unique_taxi_zone_lookup_LocationID ......................... [RUN]
[0m14:40:22.834017 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d, now test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8)
[0m14:40:22.834301 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m14:40:22.834589 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m14:40:22.836473 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m14:40:22.836900 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m14:40:22.839255 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m14:40:22.840885 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m14:40:22.844320 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m14:40:22.844737 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: BEGIN
[0m14:40:22.845459 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:22.846354 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m14:40:22.846589 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.846781 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: BEGIN
[0m14:40:22.847218 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m14:40:22.847773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:22.848384 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Borough
from "dev"."main"."taxi_zone_lookup"
where Borough is null



  
  
      
    ) dbt_internal_test
[0m14:40:22.849069 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.849377 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m14:40:22.849868 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m14:40:22.850160 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.851717 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m14:40:22.852097 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select LocationID
from "dev"."main"."taxi_zone_lookup"
where LocationID is null



  
  
      
    ) dbt_internal_test
[0m14:40:22.853410 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: ROLLBACK
[0m14:40:22.854877 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa'
[0m14:40:22.855133 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.855356 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: Close
[0m14:40:22.856339 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: ROLLBACK
[0m14:40:22.856832 [info ] [Thread-4 (]: 15 of 91 PASS not_null_taxi_zone_lookup_Borough ................................ [[32mPASS[0m in 0.04s]
[0m14:40:22.857370 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a'
[0m14:40:22.857836 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m14:40:22.858297 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: Close
[0m14:40:22.859054 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m14:40:22.859624 [info ] [Thread-1 (]: 16 of 91 PASS not_null_taxi_zone_lookup_LocationID ............................. [[32mPASS[0m in 0.04s]
[0m14:40:22.859943 [info ] [Thread-4 (]: 18 of 91 START sql view model main.stg_rate_codes .............................. [RUN]
[0m14:40:22.860373 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m14:40:22.860891 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa, now model.nyc_taxi_pipeline_00.stg_rate_codes)
[0m14:40:22.861486 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.stg_payment_types
[0m14:40:22.862052 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m14:40:22.862324 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m14:40:22.863009 [info ] [Thread-1 (]: 19 of 91 START sql view model main.stg_payment_types ........................... [RUN]
[0m14:40:22.863442 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: BEGIN
[0m14:40:22.865497 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m14:40:22.866035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a, now model.nyc_taxi_pipeline_00.stg_payment_types)
[0m14:40:22.866481 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:22.867183 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_payment_types
[0m14:40:22.869634 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m14:40:22.869928 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:40:22.870385 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m14:40:22.870672 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    LocationID as unique_field,
    count(*) as n_records

from "dev"."main"."taxi_zone_lookup"
where LocationID is not null
group by LocationID
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:40:22.871718 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.872988 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: ROLLBACK
[0m14:40:22.874271 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8'
[0m14:40:22.874646 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: Close
[0m14:40:22.874883 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m14:40:22.875275 [info ] [Thread-3 (]: 17 of 91 PASS unique_taxi_zone_lookup_LocationID ............................... [[32mPASS[0m in 0.04s]
[0m14:40:22.881047 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.stg_payment_types
[0m14:40:22.886525 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m14:40:22.887001 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m14:40:22.888929 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m14:40:22.889917 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m14:40:22.890548 [info ] [Thread-3 (]: 20 of 91 START sql view model main.stg_taxi_zones .............................. [RUN]
[0m14:40:22.890910 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8, now model.nyc_taxi_pipeline_00.stg_taxi_zones)
[0m14:40:22.891704 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m14:40:22.893510 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m14:40:22.894597 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m14:40:22.895235 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: BEGIN
[0m14:40:22.895543 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m14:40:22.895866 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:22.896299 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: BEGIN
[0m14:40:22.896989 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.897219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:22.897713 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m14:40:22.898610 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.898953 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */

  
  create view "dev"."main"."stg_rate_codes__dbt_tmp" as (
    /*
    Staging model: Rate code lookup
    Maps rate_code_id to human-readable names.
*/

with source as (
    select * from "dev"."main"."rate_code_lookup"
),

renamed as (
    select
        rate_code_id,
        rate_code_name
    from source
)

select * from renamed
  );

[0m14:40:22.899281 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m14:40:22.899913 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */

  
  create view "dev"."main"."stg_payment_types__dbt_tmp" as (
    /*
    Staging model: Payment type lookup
    Maps payment_type_id to human-readable names.
*/

with source as (
    select * from "dev"."main"."payment_type_lookup"
),

renamed as (
    select
        payment_type_id,
        payment_type_name
    from source
)

select * from renamed
  );

[0m14:40:22.900371 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.900651 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m14:40:22.900894 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.902977 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m14:40:22.904856 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m14:40:22.907254 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m14:40:22.907682 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
alter view "dev"."main"."stg_rate_codes" rename to "stg_rate_codes__dbt_backup"
[0m14:40:22.908304 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
alter view "dev"."main"."stg_payment_types" rename to "stg_payment_types__dbt_backup"
[0m14:40:22.908965 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:40:22.909277 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:40:22.910843 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m14:40:22.912441 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m14:40:22.912860 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
alter view "dev"."main"."stg_rate_codes__dbt_tmp" rename to "stg_rate_codes"
[0m14:40:22.913183 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
alter view "dev"."main"."stg_payment_types__dbt_tmp" rename to "stg_payment_types"
[0m14:40:22.913973 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:40:22.915063 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: COMMIT
[0m14:40:22.915378 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.915643 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m14:40:22.916721 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: COMMIT
[0m14:40:22.917043 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m14:40:22.917240 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: COMMIT
[0m14:40:22.917717 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m14:40:22.918116 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: BEGIN
[0m14:40:22.918925 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: COMMIT
[0m14:40:22.919451 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:22.920398 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.920784 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m14:40:22.921329 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */

  
  create view "dev"."main"."stg_taxi_zones__dbt_tmp" as (
    /*
    Staging model: Taxi zone lookup
    Maps LocationID to borough and zone name.
*/

with source as (
    select * from "dev"."main"."taxi_zone_lookup"
),

renamed as (
    select
        cast("LocationID" as integer) as location_id,
        "Borough" as borough,
        "Zone" as zone_name,
        service_zone
    from source
)

select * from renamed
  );

[0m14:40:22.922129 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:40:22.923780 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m14:40:22.924038 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:40:22.924244 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
drop view if exists "dev"."main"."stg_rate_codes__dbt_backup" cascade
[0m14:40:22.926974 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m14:40:22.927375 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m14:40:22.927819 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
alter view "dev"."main"."stg_taxi_zones" rename to "stg_taxi_zones__dbt_backup"
[0m14:40:22.929103 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m14:40:22.929697 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
drop view if exists "dev"."main"."stg_payment_types__dbt_backup" cascade
[0m14:40:22.930019 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:40:22.930351 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.931514 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: Close
[0m14:40:22.933228 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m14:40:22.933862 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '464e5f25-1623-4796-ade1-b5af4241b61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f5781fbfe0>]}
[0m14:40:22.934139 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
alter view "dev"."main"."stg_taxi_zones__dbt_tmp" rename to "stg_taxi_zones"
[0m14:40:22.934394 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:40:22.934766 [info ] [Thread-4 (]: 18 of 91 OK created sql view model main.stg_rate_codes ......................... [[32mOK[0m in 0.07s]
[0m14:40:22.935554 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:40:22.936461 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: Close
[0m14:40:22.936992 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m14:40:22.938487 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: COMMIT
[0m14:40:22.938996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '464e5f25-1623-4796-ade1-b5af4241b61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f579f028d0>]}
[0m14:40:22.939547 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m14:40:22.939908 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m14:40:22.940373 [info ] [Thread-1 (]: 19 of 91 OK created sql view model main.stg_payment_types ...................... [[32mOK[0m in 0.07s]
[0m14:40:22.940774 [info ] [Thread-4 (]: 21 of 91 START test not_null_stg_rate_codes_rate_code_id ....................... [RUN]
[0m14:40:22.941560 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: COMMIT
[0m14:40:22.942539 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.stg_payment_types
[0m14:40:22.943152 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_rate_codes, now test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a)
[0m14:40:22.943893 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m14:40:22.944460 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m14:40:22.944867 [info ] [Thread-1 (]: 22 of 91 START test not_null_stg_rate_codes_rate_code_name ..................... [RUN]
[0m14:40:22.947271 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m14:40:22.947873 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m14:40:22.948149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_payment_types, now test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f)
[0m14:40:22.949697 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m14:40:22.950128 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m14:40:22.950593 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
drop view if exists "dev"."main"."stg_taxi_zones__dbt_backup" cascade
[0m14:40:22.952577 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m14:40:22.954279 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m14:40:22.955714 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m14:40:22.956064 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:40:22.957253 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: Close
[0m14:40:22.957717 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '464e5f25-1623-4796-ade1-b5af4241b61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f57818a090>]}
[0m14:40:22.958253 [info ] [Thread-3 (]: 20 of 91 OK created sql view model main.stg_taxi_zones ......................... [[32mOK[0m in 0.07s]
[0m14:40:22.958956 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m14:40:22.959322 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m14:40:22.959707 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m14:40:22.959948 [info ] [Thread-3 (]: 23 of 91 START test unique_stg_rate_codes_rate_code_id ......................... [RUN]
[0m14:40:22.961517 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m14:40:22.962040 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_taxi_zones, now test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3)
[0m14:40:22.962846 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m14:40:22.963174 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m14:40:22.965281 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m14:40:22.965748 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: BEGIN
[0m14:40:22.966366 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:22.967024 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.967263 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m14:40:22.967510 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m14:40:22.967920 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: BEGIN
[0m14:40:22.968365 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_id
from "dev"."main"."stg_rate_codes"
where rate_code_id is null



  
  
      
    ) dbt_internal_test
[0m14:40:22.968770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:22.970032 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.970293 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.970485 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m14:40:22.971543 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: ROLLBACK
[0m14:40:22.972117 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_name
from "dev"."main"."stg_rate_codes"
where rate_code_name is null



  
  
      
    ) dbt_internal_test
[0m14:40:22.972940 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a'
[0m14:40:22.974064 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.974301 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: Close
[0m14:40:22.975304 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: ROLLBACK
[0m14:40:22.975539 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m14:40:22.976379 [info ] [Thread-4 (]: 21 of 91 PASS not_null_stg_rate_codes_rate_code_id ............................. [[32mPASS[0m in 0.03s]
[0m14:40:22.977279 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f'
[0m14:40:22.979230 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m14:40:22.979843 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m14:40:22.980322 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: Close
[0m14:40:22.981409 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m14:40:22.982032 [info ] [Thread-1 (]: 22 of 91 PASS not_null_stg_rate_codes_rate_code_name ........................... [[32mPASS[0m in 0.03s]
[0m14:40:22.982330 [info ] [Thread-4 (]: 24 of 91 START test not_null_stg_payment_types_payment_type_id ................. [RUN]
[0m14:40:22.983368 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m14:40:22.983986 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a, now test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78)
[0m14:40:22.984490 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m14:40:22.985176 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m14:40:22.985522 [info ] [Thread-1 (]: 25 of 91 START test not_null_stg_payment_types_payment_type_name ............... [RUN]
[0m14:40:22.989196 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m14:40:22.989638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f, now test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39)
[0m14:40:22.990313 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m14:40:22.992584 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m14:40:22.992926 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m14:40:22.993430 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: BEGIN
[0m14:40:22.993737 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:22.994393 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.994731 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m14:40:22.995056 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rate_code_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_rate_codes"
where rate_code_id is not null
group by rate_code_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:40:22.996283 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:22.997559 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: ROLLBACK
[0m14:40:22.998451 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3'
[0m14:40:22.998739 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m14:40:22.999012 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: Close
[0m14:40:23.000639 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m14:40:23.001164 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m14:40:23.001880 [info ] [Thread-3 (]: 23 of 91 PASS unique_stg_rate_codes_rate_code_id ............................... [[32mPASS[0m in 0.04s]
[0m14:40:23.003795 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m14:40:23.004440 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m14:40:23.006054 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m14:40:23.006768 [info ] [Thread-3 (]: 26 of 91 START test unique_stg_payment_types_payment_type_id ................... [RUN]
[0m14:40:23.007538 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3, now test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534)
[0m14:40:23.008032 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m14:40:23.010653 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m14:40:23.011813 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m14:40:23.012288 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m14:40:23.012587 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: BEGIN
[0m14:40:23.013007 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: BEGIN
[0m14:40:23.013437 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:23.013789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:23.014611 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:23.015060 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m14:40:23.015350 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:40:23.016203 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."stg_payment_types"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m14:40:23.016729 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m14:40:23.018256 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_name
from "dev"."main"."stg_payment_types"
where payment_type_name is null



  
  
      
    ) dbt_internal_test
[0m14:40:23.018627 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:23.020336 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: ROLLBACK
[0m14:40:23.020674 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:40:23.021034 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m14:40:23.021584 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78'
[0m14:40:23.022809 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: ROLLBACK
[0m14:40:23.024385 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m14:40:23.024875 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: Close
[0m14:40:23.025561 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39'
[0m14:40:23.026530 [info ] [Thread-4 (]: 24 of 91 PASS not_null_stg_payment_types_payment_type_id ....................... [[32mPASS[0m in 0.04s]
[0m14:40:23.026822 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: Close
[0m14:40:23.027578 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m14:40:23.028315 [info ] [Thread-1 (]: 25 of 91 PASS not_null_stg_payment_types_payment_type_name ..................... [[32mPASS[0m in 0.04s]
[0m14:40:23.028665 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m14:40:23.029343 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m14:40:23.029809 [info ] [Thread-4 (]: 27 of 91 START test not_null_stg_taxi_zones_borough ............................ [RUN]
[0m14:40:23.030417 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m14:40:23.031176 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b)
[0m14:40:23.031537 [info ] [Thread-1 (]: 28 of 91 START test not_null_stg_taxi_zones_location_id ........................ [RUN]
[0m14:40:23.031984 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m14:40:23.032488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf)
[0m14:40:23.035490 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m14:40:23.035959 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m14:40:23.039175 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m14:40:23.039480 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m14:40:23.040117 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: BEGIN
[0m14:40:23.040497 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:23.041261 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:23.041946 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m14:40:23.042445 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_payment_types"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:40:23.043852 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:23.045218 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: ROLLBACK
[0m14:40:23.046029 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534'
[0m14:40:23.046540 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: Close
[0m14:40:23.047533 [info ] [Thread-3 (]: 26 of 91 PASS unique_stg_payment_types_payment_type_id ......................... [[32mPASS[0m in 0.04s]
[0m14:40:23.047870 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m14:40:23.048428 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m14:40:23.050394 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m14:40:23.050683 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m14:40:23.051005 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m14:40:23.053844 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m14:40:23.054311 [info ] [Thread-3 (]: 29 of 91 START test not_null_stg_taxi_zones_zone_name .......................... [RUN]
[0m14:40:23.055400 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84)
[0m14:40:23.055768 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m14:40:23.057966 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m14:40:23.059149 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m14:40:23.059735 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: BEGIN
[0m14:40:23.060030 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m14:40:23.060236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:23.060681 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: BEGIN
[0m14:40:23.061433 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:23.061765 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:23.062171 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m14:40:23.063114 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:23.063376 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "dev"."main"."stg_taxi_zones"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m14:40:23.063822 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m14:40:23.064893 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select borough
from "dev"."main"."stg_taxi_zones"
where borough is null



  
  
      
    ) dbt_internal_test
[0m14:40:23.065283 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:23.066054 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:23.067240 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: ROLLBACK
[0m14:40:23.067526 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m14:40:23.068474 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: ROLLBACK
[0m14:40:23.069127 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf'
[0m14:40:23.070731 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m14:40:23.071429 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b'
[0m14:40:23.071859 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: Close
[0m14:40:23.072511 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: Close
[0m14:40:23.073272 [info ] [Thread-1 (]: 28 of 91 PASS not_null_stg_taxi_zones_location_id .............................. [[32mPASS[0m in 0.04s]
[0m14:40:23.073720 [info ] [Thread-4 (]: 27 of 91 PASS not_null_stg_taxi_zones_borough .................................. [[32mPASS[0m in 0.04s]
[0m14:40:23.074100 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m14:40:23.074850 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m14:40:23.075376 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m14:40:23.075930 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.dim_payment_types
[0m14:40:23.076434 [info ] [Thread-1 (]: 30 of 91 START test unique_stg_taxi_zones_location_id .......................... [RUN]
[0m14:40:23.076982 [info ] [Thread-4 (]: 31 of 91 START sql table model main.dim_payment_types .......................... [RUN]
[0m14:40:23.077452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf, now test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c)
[0m14:40:23.078221 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b, now model.nyc_taxi_pipeline_00.dim_payment_types)
[0m14:40:23.078646 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m14:40:23.078988 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_payment_types
[0m14:40:23.081640 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m14:40:23.083263 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m14:40:23.084807 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m14:40:23.085149 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: BEGIN
[0m14:40:23.085531 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:23.086240 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:23.086604 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m14:40:23.086953 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select zone_name
from "dev"."main"."stg_taxi_zones"
where zone_name is null



  
  
      
    ) dbt_internal_test
[0m14:40:23.087838 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:23.089024 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: ROLLBACK
[0m14:40:23.089756 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84'
[0m14:40:23.090282 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: Close
[0m14:40:23.090942 [info ] [Thread-3 (]: 29 of 91 PASS not_null_stg_taxi_zones_zone_name ................................ [[32mPASS[0m in 0.04s]
[0m14:40:23.091285 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m14:40:23.091731 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m14:40:23.092082 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.dim_payment_types
[0m14:40:23.093618 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m14:40:23.095688 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m14:40:23.096583 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
DESCRIBE (select * from (
        /*
    Dimension table: Payment type descriptions.
*/

with payment_types as (
    select * from "dev"."main"."stg_payment_types"
),

final as (
    select
        payment_type_id,
        payment_type_name
    from payment_types
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:40:23.097486 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:23.098932 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:40:23.099820 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m14:40:23.100452 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as payment_type_id, 
      
    cast(null as varchar)
 as payment_type_name
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:40:23.101332 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:40:23.102396 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m14:40:23.104591 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m14:40:23.104954 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: BEGIN
[0m14:40:23.105305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:23.105926 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:23.106226 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m14:40:23.106522 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_taxi_zones"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:40:23.107697 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m14:40:23.107914 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:23.108116 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: BEGIN
[0m14:40:23.109314 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: ROLLBACK
[0m14:40:23.109743 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:40:23.110351 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c'
[0m14:40:23.110733 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m14:40:23.111075 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: Close
[0m14:40:23.111438 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_payment_types__dbt_tmp"
  
  (
    payment_type_id integer,
    payment_type_name varchar
    
    )
 ;
    insert into "dev"."main"."dim_payment_types__dbt_tmp" 
  (
    
      
      payment_type_id ,
    
      
      payment_type_name 
    
  )
 (
      
    select payment_type_id, payment_type_name
    from (
        /*
    Dimension table: Payment type descriptions.
*/

with payment_types as (
    select * from "dev"."main"."stg_payment_types"
),

final as (
    select
        payment_type_id,
        payment_type_name
    from payment_types
)

select * from final
    ) as model_subq
    );
  
  
[0m14:40:23.112116 [info ] [Thread-1 (]: 30 of 91 PASS unique_stg_taxi_zones_location_id ................................ [[32mPASS[0m in 0.03s]
[0m14:40:23.113135 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m14:40:23.113437 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:23.114178 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.dim_locations
[0m14:40:23.116054 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m14:40:23.116647 [info ] [Thread-3 (]: 32 of 91 START sql table model main.dim_locations .............................. [RUN]
[0m14:40:23.117139 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
alter table "dev"."main"."dim_payment_types" rename to "dim_payment_types__dbt_backup"
[0m14:40:23.117616 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84, now model.nyc_taxi_pipeline_00.dim_locations)
[0m14:40:23.118257 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_locations
[0m14:40:23.118641 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:23.120349 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_locations"
[0m14:40:23.123100 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m14:40:23.123789 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
alter table "dev"."main"."dim_payment_types__dbt_tmp" rename to "dim_payment_types"
[0m14:40:23.124497 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:40:23.125587 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: COMMIT
[0m14:40:23.126169 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m14:40:23.126679 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: COMMIT
[0m14:40:23.129996 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:40:23.131903 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m14:40:23.132191 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.dim_locations
[0m14:40:23.132427 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
drop table if exists "dev"."main"."dim_payment_types__dbt_backup" cascade
[0m14:40:23.134562 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m14:40:23.135393 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
DESCRIBE (select * from (
        /*
    Dimension table: TLC Taxi Zone locations.
*/

with zones as (
    select * from "dev"."main"."stg_taxi_zones"
),

final as (
    select
        location_id,
        borough,
        zone_name,
        service_zone
    from zones
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:40:23.135779 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:23.138924 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:40:23.139330 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m14:40:23.140166 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: Close
[0m14:40:23.141281 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m14:40:23.141746 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '464e5f25-1623-4796-ade1-b5af4241b61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f55c123710>]}
[0m14:40:23.141981 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as location_id, 
      
    cast(null as varchar)
 as borough, 
      
    cast(null as varchar)
 as zone_name, 
      
    cast(null as varchar)
 as service_zone
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:40:23.142697 [info ] [Thread-4 (]: 31 of 91 OK created sql table model main.dim_payment_types ..................... [[32mOK[0m in 0.06s]
[0m14:40:23.143547 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:40:23.143932 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.dim_payment_types
[0m14:40:23.145078 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_locations"
[0m14:40:23.145868 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m14:40:23.146092 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m14:40:23.146302 [info ] [Thread-1 (]: 33 of 91 START test not_null_dim_payment_types_payment_type_id ................. [RUN]
[0m14:40:23.146853 [info ] [Thread-4 (]: 34 of 91 START test not_null_dim_payment_types_payment_type_name ............... [RUN]
[0m14:40:23.147590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c, now test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10)
[0m14:40:23.148037 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_payment_types, now test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0)
[0m14:40:23.148631 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m14:40:23.149266 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m14:40:23.151602 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m14:40:23.153615 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m14:40:23.154864 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m14:40:23.155300 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: BEGIN
[0m14:40:23.156214 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:40:23.156476 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m14:40:23.156763 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_locations__dbt_tmp"
  
  (
    location_id integer,
    borough varchar,
    zone_name varchar,
    service_zone varchar
    
    )
 ;
    insert into "dev"."main"."dim_locations__dbt_tmp" 
  (
    
      
      location_id ,
    
      
      borough ,
    
      
      zone_name ,
    
      
      service_zone 
    
  )
 (
      
    select location_id, borough, zone_name, service_zone
    from (
        /*
    Dimension table: TLC Taxi Zone locations.
*/

with zones as (
    select * from "dev"."main"."stg_taxi_zones"
),

final as (
    select
        location_id,
        borough,
        zone_name,
        service_zone
    from zones
)

select * from final
    ) as model_subq
    );
  
  
[0m14:40:23.158148 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:23.159985 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m14:40:23.160511 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
alter table "dev"."main"."dim_locations" rename to "dim_locations__dbt_backup"
[0m14:40:23.161904 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:23.162288 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m14:40:23.164019 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m14:40:23.166418 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
alter table "dev"."main"."dim_locations__dbt_tmp" rename to "dim_locations"
[0m14:40:23.165692 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m14:40:23.164428 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m14:40:23.167776 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:23.170804 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m14:40:23.171923 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: COMMIT
[0m14:40:23.172521 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m14:40:23.172829 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: COMMIT
[0m14:40:23.176728 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m14:40:23.177365 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: BEGIN
[0m14:40:23.177642 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m14:40:23.177870 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:23.179727 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m14:40:23.179982 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m14:40:23.181050 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
drop table if exists "dev"."main"."dim_locations__dbt_backup" cascade
[0m14:40:23.181336 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:40:23.181720 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: BEGIN
[0m14:40:23.182636 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m14:40:23.183601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:23.184310 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_name
from "dev"."main"."dim_payment_types"
where payment_type_name is null



  
  
      
    ) dbt_internal_test
[0m14:40:23.184884 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:23.185262 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m14:40:23.185533 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:40:23.185865 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:23.186111 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."dim_payment_types"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m14:40:23.187147 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_locations: Close
[0m14:40:23.188235 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: ROLLBACK
[0m14:40:23.188942 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '464e5f25-1623-4796-ade1-b5af4241b61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f55c15e240>]}
[0m14:40:23.189278 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:23.189912 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0'
[0m14:40:23.190499 [info ] [Thread-3 (]: 32 of 91 OK created sql table model main.dim_locations ......................... [[32mOK[0m in 0.07s]
[0m14:40:23.191704 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: ROLLBACK
[0m14:40:23.191938 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: Close
[0m14:40:23.192359 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.dim_locations
[0m14:40:23.193328 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10'
[0m14:40:23.194202 [info ] [Thread-4 (]: 34 of 91 PASS not_null_dim_payment_types_payment_type_name ..................... [[32mPASS[0m in 0.05s]
[0m14:40:23.194553 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m14:40:23.195216 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: Close
[0m14:40:23.195758 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m14:40:23.196168 [info ] [Thread-3 (]: 35 of 91 START test unique_dim_payment_types_payment_type_id ................... [RUN]
[0m14:40:23.196967 [info ] [Thread-1 (]: 33 of 91 PASS not_null_dim_payment_types_payment_type_id ....................... [[32mPASS[0m in 0.05s]
[0m14:40:23.197280 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m14:40:23.197739 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_locations, now test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62)
[0m14:40:23.198179 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m14:40:23.198546 [info ] [Thread-4 (]: 36 of 91 START test not_null_dim_locations_borough ............................. [RUN]
[0m14:40:23.198982 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m14:40:23.199463 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m14:40:23.199950 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0, now test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af)
[0m14:40:23.202501 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m14:40:23.202991 [info ] [Thread-1 (]: 37 of 91 START test not_null_dim_locations_location_id ......................... [RUN]
[0m14:40:23.203359 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m14:40:23.204086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10, now test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476)
[0m14:40:23.207102 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m14:40:23.207724 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m14:40:23.211091 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m14:40:23.212779 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m14:40:23.214464 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m14:40:23.216011 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m14:40:23.217693 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m14:40:23.217941 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m14:40:23.220128 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m14:40:23.221843 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m14:40:23.222407 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: BEGIN
[0m14:40:23.223009 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:23.223812 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m14:40:23.224261 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:23.224552 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: BEGIN
[0m14:40:23.225077 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m14:40:23.225700 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:23.226383 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."dim_payment_types"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:40:23.226951 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m14:40:23.227515 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:40:23.227990 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: BEGIN
[0m14:40:23.228487 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m14:40:23.228843 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:23.229087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:23.229707 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select borough
from "dev"."main"."dim_locations"
where borough is null



  
  
      
    ) dbt_internal_test
[0m14:40:23.231339 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: ROLLBACK
[0m14:40:23.232032 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:40:23.232541 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62'
[0m14:40:23.232831 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:23.233123 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m14:40:23.233547 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: Close
[0m14:40:23.234982 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: ROLLBACK
[0m14:40:23.235292 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "dev"."main"."dim_locations"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m14:40:23.235853 [info ] [Thread-3 (]: 35 of 91 PASS unique_dim_payment_types_payment_type_id ......................... [[32mPASS[0m in 0.04s]
[0m14:40:23.236405 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af'
[0m14:40:23.237215 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m14:40:23.237485 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:23.237743 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: Close
[0m14:40:23.238290 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m14:40:23.239615 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: ROLLBACK
[0m14:40:23.240273 [info ] [Thread-4 (]: 36 of 91 PASS not_null_dim_locations_borough ................................... [[32mPASS[0m in 0.04s]
[0m14:40:23.240599 [info ] [Thread-3 (]: 38 of 91 START test not_null_dim_locations_zone_name ........................... [RUN]
[0m14:40:23.241415 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476'
[0m14:40:23.241944 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m14:40:23.242504 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62, now test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d)
[0m14:40:23.243039 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: Close
[0m14:40:23.243550 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m14:40:23.244026 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m14:40:23.244800 [info ] [Thread-1 (]: 37 of 91 PASS not_null_dim_locations_location_id ............................... [[32mPASS[0m in 0.04s]
[0m14:40:23.245107 [info ] [Thread-4 (]: 39 of 91 START test unique_dim_locations_location_id ........................... [RUN]
[0m14:40:23.247752 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m14:40:23.248491 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m14:40:23.248998 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af, now test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d)
[0m14:40:23.250037 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m14:40:23.252096 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m14:40:23.257425 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m14:40:23.260277 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m14:40:23.260590 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m14:40:23.262405 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m14:40:23.267442 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m14:40:23.267894 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m14:40:23.268165 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: BEGIN
[0m14:40:23.268726 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: BEGIN
[0m14:40:23.269251 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:23.269883 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:23.270657 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:23.271066 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:23.271265 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m14:40:23.271715 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m14:40:23.272107 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "dev"."main"."dim_locations"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:40:23.272511 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select zone_name
from "dev"."main"."dim_locations"
where zone_name is null



  
  
      
    ) dbt_internal_test
[0m14:40:23.273870 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:23.274258 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:23.275491 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: ROLLBACK
[0m14:40:23.276538 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: ROLLBACK
[0m14:40:23.277122 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d'
[0m14:40:23.277795 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d'
[0m14:40:23.278215 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: Close
[0m14:40:23.278615 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: Close
[0m14:40:23.279341 [info ] [Thread-3 (]: 38 of 91 PASS not_null_dim_locations_zone_name ................................. [[32mPASS[0m in 0.04s]
[0m14:40:23.279785 [info ] [Thread-4 (]: 39 of 91 PASS unique_dim_locations_location_id ................................. [[32mPASS[0m in 0.03s]
[0m14:40:23.280148 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m14:40:23.280644 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m14:40:24.332346 [debug] [Thread-2 (]: SQL status: OK in 1.757 seconds
[0m14:40:24.334410 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m14:40:24.334810 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
alter table "dev"."main"."stg_yellow_trips" rename to "stg_yellow_trips__dbt_backup"
[0m14:40:24.335467 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:40:24.336903 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m14:40:24.337210 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
alter table "dev"."main"."stg_yellow_trips__dbt_tmp" rename to "stg_yellow_trips"
[0m14:40:24.337660 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:40:24.338442 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: COMMIT
[0m14:40:24.338755 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m14:40:24.339162 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: COMMIT
[0m14:40:24.381290 [debug] [Thread-2 (]: SQL status: OK in 0.042 seconds
[0m14:40:24.383115 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m14:40:24.383474 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
drop table if exists "dev"."main"."stg_yellow_trips__dbt_backup" cascade
[0m14:40:24.387712 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m14:40:24.388619 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: Close
[0m14:40:24.449703 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '464e5f25-1623-4796-ade1-b5af4241b61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f57a2399d0>]}
[0m14:40:24.450569 [info ] [Thread-2 (]: 2 of 91 OK created sql table model main.stg_yellow_trips ....................... [[32mOK[0m in 1.97s]
[0m14:40:24.451264 [debug] [Thread-2 (]: Finished running node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m14:40:24.452274 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m14:40:24.452534 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m14:40:24.452760 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m14:40:24.452969 [info ] [Thread-1 (]: 40 of 91 START test accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6  [RUN]
[0m14:40:24.453217 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m14:40:24.453427 [info ] [Thread-3 (]: 41 of 91 START test accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99  [RUN]
[0m14:40:24.453812 [info ] [Thread-4 (]: 42 of 91 START test accepted_values_stg_yellow_trips_vendor_id__1__2__6 ........ [RUN]
[0m14:40:24.454446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44)
[0m14:40:24.455070 [info ] [Thread-2 (]: 43 of 91 START test assert_fare_not_exceeds_total .............................. [RUN]
[0m14:40:24.455459 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098)
[0m14:40:24.455843 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27)
[0m14:40:24.456156 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m14:40:24.456497 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_yellow_trips, now test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total)
[0m14:40:24.456789 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m14:40:24.457080 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m14:40:24.461553 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m14:40:24.462148 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m14:40:24.464498 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m14:40:24.466900 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m14:40:24.468664 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m14:40:24.472589 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m14:40:24.475735 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m14:40:24.476043 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m14:40:24.476271 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m14:40:24.477595 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m14:40:24.477865 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m14:40:24.478908 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m14:40:24.480201 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m14:40:24.482723 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m14:40:24.483161 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: BEGIN
[0m14:40:24.483635 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m14:40:24.483847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:24.484142 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m14:40:24.484367 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: BEGIN
[0m14:40:24.485337 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m14:40:24.485579 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: BEGIN
[0m14:40:24.486929 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:40:24.487282 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: BEGIN
[0m14:40:24.487611 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:24.488168 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:24.502650 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m14:40:24.503077 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m14:40:24.503301 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m14:40:24.503515 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m14:40:24.503704 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m14:40:24.504018 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m14:40:24.504330 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m14:40:24.504748 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m14:40:24.505118 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        payment_type_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by payment_type_id

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6'
)



  
  
      
    ) dbt_internal_test
[0m14:40:24.505491 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        vendor_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by vendor_id

)

select *
from all_values
where value_field not in (
    '1','2','6'
)



  
  
      
    ) dbt_internal_test
[0m14:40:24.505798 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rate_code_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by rate_code_id

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5','6','99'
)



  
  
      
    ) dbt_internal_test
[0m14:40:24.506047 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
    Singular test: fare_amount should not exceed total_amount.
*/

select
    trip_id,
    fare_amount,
    total_amount
from "dev"."main"."stg_yellow_trips"
where fare_amount > total_amount + 0.01
  and total_amount > 0
  
  
      
    ) dbt_internal_test
[0m14:40:24.531335 [debug] [Thread-4 (]: SQL status: OK in 0.025 seconds
[0m14:40:24.531817 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m14:40:24.533681 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: ROLLBACK
[0m14:40:24.533967 [debug] [Thread-3 (]: SQL status: OK in 0.027 seconds
[0m14:40:24.535946 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: ROLLBACK
[0m14:40:24.536808 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27'
[0m14:40:24.538814 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: ROLLBACK
[0m14:40:24.539760 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44'
[0m14:40:24.540640 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: Close
[0m14:40:24.541625 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098'
[0m14:40:24.542970 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: Close
[0m14:40:24.544104 [info ] [Thread-4 (]: 42 of 91 PASS accepted_values_stg_yellow_trips_vendor_id__1__2__6 .............. [[32mPASS[0m in 0.09s]
[0m14:40:24.544535 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: Close
[0m14:40:24.544928 [debug] [Thread-2 (]: SQL status: OK in 0.038 seconds
[0m14:40:24.545296 [info ] [Thread-1 (]: 40 of 91 PASS accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6  [[32mPASS[0m in 0.09s]
[0m14:40:24.545640 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m14:40:24.546182 [info ] [Thread-3 (]: 41 of 91 PASS accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99  [[32mPASS[0m in 0.09s]
[0m14:40:24.547101 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: ROLLBACK
[0m14:40:24.547389 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m14:40:24.548125 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m14:40:24.548571 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m14:40:24.549191 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total'
[0m14:40:24.549420 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m14:40:24.550410 [info ] [Thread-4 (]: 44 of 91 START test not_null_stg_yellow_trips_dropoff_datetime ................. [RUN]
[0m14:40:24.550875 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m14:40:24.551194 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: Close
[0m14:40:24.551515 [info ] [Thread-1 (]: 45 of 91 START test not_null_stg_yellow_trips_dropoff_location_id .............. [RUN]
[0m14:40:24.551898 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052)
[0m14:40:24.552223 [info ] [Thread-3 (]: 46 of 91 START test not_null_stg_yellow_trips_fare_amount ...................... [RUN]
[0m14:40:24.552768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048)
[0m14:40:24.553133 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m14:40:24.553471 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97)
[0m14:40:24.553830 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m14:40:24.556913 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m14:40:24.557225 [info ] [Thread-2 (]: 43 of 91 PASS assert_fare_not_exceeds_total .................................... [[32mPASS[0m in 0.10s]
[0m14:40:24.557418 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m14:40:24.559405 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m14:40:24.559993 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m14:40:24.561831 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m14:40:24.562726 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m14:40:24.563438 [info ] [Thread-2 (]: 47 of 91 START test not_null_stg_yellow_trips_pickup_datetime .................. [RUN]
[0m14:40:24.563770 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed)
[0m14:40:24.564071 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m14:40:24.566282 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m14:40:24.567766 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m14:40:24.568048 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m14:40:24.568283 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m14:40:24.569768 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m14:40:24.571775 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m14:40:24.574506 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m14:40:24.576300 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m14:40:24.577651 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m14:40:24.580813 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m14:40:24.581125 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m14:40:24.581405 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: BEGIN
[0m14:40:24.582127 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: BEGIN
[0m14:40:24.582714 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m14:40:24.583006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:24.583453 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:24.583783 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m14:40:24.584048 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: BEGIN
[0m14:40:24.584997 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: BEGIN
[0m14:40:24.585434 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:24.585826 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:40:24.599905 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m14:40:24.600238 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m14:40:24.600493 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m14:40:24.600719 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m14:40:24.600940 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m14:40:24.601261 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m14:40:24.601614 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m14:40:24.601879 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m14:40:24.602230 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_location_id
from "dev"."main"."stg_yellow_trips"
where dropoff_location_id is null



  
  
      
    ) dbt_internal_test
[0m14:40:24.602510 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_datetime
from "dev"."main"."stg_yellow_trips"
where dropoff_datetime is null



  
  
      
    ) dbt_internal_test
[0m14:40:24.602886 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fare_amount
from "dev"."main"."stg_yellow_trips"
where fare_amount is null



  
  
      
    ) dbt_internal_test
[0m14:40:24.603123 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "dev"."main"."stg_yellow_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m14:40:24.603923 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:40:24.604189 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:24.604488 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:40:24.605864 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: ROLLBACK
[0m14:40:24.606492 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:40:24.607274 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: ROLLBACK
[0m14:40:24.608035 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: ROLLBACK
[0m14:40:24.608567 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048'
[0m14:40:24.609506 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: ROLLBACK
[0m14:40:24.610000 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052'
[0m14:40:24.610524 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97'
[0m14:40:24.610864 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: Close
[0m14:40:24.611373 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed'
[0m14:40:24.611629 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: Close
[0m14:40:24.611908 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: Close
[0m14:40:24.612358 [info ] [Thread-1 (]: 45 of 91 PASS not_null_stg_yellow_trips_dropoff_location_id .................... [[32mPASS[0m in 0.06s]
[0m14:40:24.612574 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: Close
[0m14:40:24.613236 [info ] [Thread-4 (]: 44 of 91 PASS not_null_stg_yellow_trips_dropoff_datetime ....................... [[32mPASS[0m in 0.06s]
[0m14:40:24.613611 [info ] [Thread-3 (]: 46 of 91 PASS not_null_stg_yellow_trips_fare_amount ............................ [[32mPASS[0m in 0.06s]
[0m14:40:24.613921 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m14:40:24.614618 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m14:40:24.614995 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m14:40:24.615414 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m14:40:24.615779 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m14:40:24.616405 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m14:40:24.616807 [info ] [Thread-2 (]: 47 of 91 PASS not_null_stg_yellow_trips_pickup_datetime ........................ [[32mPASS[0m in 0.05s]
[0m14:40:24.617086 [info ] [Thread-1 (]: 48 of 91 START test not_null_stg_yellow_trips_pickup_location_id ............... [RUN]
[0m14:40:24.617505 [info ] [Thread-4 (]: 49 of 91 START test not_null_stg_yellow_trips_total_amount ..................... [RUN]
[0m14:40:24.617937 [info ] [Thread-3 (]: 50 of 91 START test not_null_stg_yellow_trips_trip_distance_miles .............. [RUN]
[0m14:40:24.618518 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m14:40:24.618896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1)
[0m14:40:24.619256 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6)
[0m14:40:24.619569 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7)
[0m14:40:24.619859 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m14:40:24.620131 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m14:40:24.620425 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m14:40:24.620719 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m14:40:24.621028 [info ] [Thread-2 (]: 51 of 91 START test not_null_stg_yellow_trips_trip_id .......................... [RUN]
[0m14:40:24.623968 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m14:40:24.627066 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m14:40:24.629571 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m14:40:24.630515 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1)
[0m14:40:24.631531 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m14:40:24.633931 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m14:40:24.638424 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m14:40:24.640406 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m14:40:24.640780 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m14:40:24.642428 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m14:40:24.642682 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m14:40:24.642934 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m14:40:24.644703 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m14:40:24.647059 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m14:40:24.648273 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m14:40:24.648618 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m14:40:24.648942 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: BEGIN
[0m14:40:24.649387 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: BEGIN
[0m14:40:24.649905 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:24.650365 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:24.650638 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m14:40:24.651259 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: BEGIN
[0m14:40:24.651630 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:40:24.651870 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m14:40:24.652221 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: BEGIN
[0m14:40:24.652543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:24.668829 [debug] [Thread-4 (]: SQL status: OK in 0.018 seconds
[0m14:40:24.669171 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m14:40:24.669394 [debug] [Thread-3 (]: SQL status: OK in 0.019 seconds
[0m14:40:24.669628 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m14:40:24.669830 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m14:40:24.670173 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m14:40:24.670487 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m14:40:24.670750 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m14:40:24.671034 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."stg_yellow_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m14:40:24.671330 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_location_id
from "dev"."main"."stg_yellow_trips"
where pickup_location_id is null



  
  
      
    ) dbt_internal_test
[0m14:40:24.671599 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_distance_miles
from "dev"."main"."stg_yellow_trips"
where trip_distance_miles is null



  
  
      
    ) dbt_internal_test
[0m14:40:24.671858 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."stg_yellow_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m14:40:24.672820 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:24.673009 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:24.673251 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:24.673511 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:40:24.674422 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: ROLLBACK
[0m14:40:24.675496 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: ROLLBACK
[0m14:40:24.676185 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: ROLLBACK
[0m14:40:24.677079 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: ROLLBACK
[0m14:40:24.677739 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6'
[0m14:40:24.678189 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1'
[0m14:40:24.678793 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7'
[0m14:40:24.679348 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1'
[0m14:40:24.679523 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: Close
[0m14:40:24.679859 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: Close
[0m14:40:24.680201 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: Close
[0m14:40:24.680507 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: Close
[0m14:40:24.680972 [info ] [Thread-4 (]: 49 of 91 PASS not_null_stg_yellow_trips_total_amount ........................... [[32mPASS[0m in 0.06s]
[0m14:40:24.681373 [info ] [Thread-1 (]: 48 of 91 PASS not_null_stg_yellow_trips_pickup_location_id ..................... [[32mPASS[0m in 0.06s]
[0m14:40:24.681733 [info ] [Thread-3 (]: 50 of 91 PASS not_null_stg_yellow_trips_trip_distance_miles .................... [[32mPASS[0m in 0.06s]
[0m14:40:24.682205 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m14:40:24.682652 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m14:40:24.683277 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m14:40:24.683877 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m14:40:24.684252 [info ] [Thread-2 (]: 51 of 91 PASS not_null_stg_yellow_trips_trip_id ................................ [[32mPASS[0m in 0.05s]
[0m14:40:24.684477 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m14:40:24.684901 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m14:40:24.685314 [info ] [Thread-4 (]: 52 of 91 START test not_null_stg_yellow_trips_vendor_id ........................ [RUN]
[0m14:40:24.685763 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m14:40:24.686125 [info ] [Thread-1 (]: 53 of 91 START test unique_stg_yellow_trips_trip_id ............................ [RUN]
[0m14:40:24.686513 [info ] [Thread-3 (]: 54 of 91 START test relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_  [RUN]
[0m14:40:24.686857 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57)
[0m14:40:24.687178 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m14:40:24.687496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1, now test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965)
[0m14:40:24.687798 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7, now test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a)
[0m14:40:24.688083 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m14:40:24.688353 [info ] [Thread-2 (]: 55 of 91 START test relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_  [RUN]
[0m14:40:24.688667 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m14:40:24.688961 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m14:40:24.691354 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m14:40:24.691787 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1, now test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f)
[0m14:40:24.693738 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m14:40:24.697982 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m14:40:24.698850 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m14:40:24.701836 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m14:40:24.705274 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m14:40:24.705509 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m14:40:24.706821 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m14:40:24.708370 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m14:40:24.708607 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m14:40:24.708808 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m14:40:24.711033 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m14:40:24.712801 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m14:40:24.717194 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m14:40:24.717512 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m14:40:24.717733 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: BEGIN
[0m14:40:24.718080 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: BEGIN
[0m14:40:24.718390 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m14:40:24.718595 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:24.718932 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:24.719244 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: BEGIN
[0m14:40:24.719766 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m14:40:24.720341 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:40:24.720719 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: BEGIN
[0m14:40:24.721361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:24.735278 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m14:40:24.735623 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m14:40:24.735859 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m14:40:24.736095 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m14:40:24.736328 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m14:40:24.736698 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m14:40:24.737058 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m14:40:24.737346 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m14:40:24.737617 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "dev"."main"."stg_yellow_trips"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m14:40:24.738126 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select pickup_location_id as from_field
    from "dev"."main"."stg_yellow_trips"
    where pickup_location_id is not null
),

parent as (
    select location_id as to_field
    from "dev"."main"."stg_taxi_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:40:24.738458 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_yellow_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:40:24.738812 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select dropoff_location_id as from_field
    from "dev"."main"."stg_yellow_trips"
    where dropoff_location_id is not null
),

parent as (
    select location_id as to_field
    from "dev"."main"."stg_taxi_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:40:24.739800 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:24.742563 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: ROLLBACK
[0m14:40:24.744942 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57'
[0m14:40:24.746691 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: Close
[0m14:40:24.748692 [info ] [Thread-4 (]: 52 of 91 PASS not_null_stg_yellow_trips_vendor_id .............................. [[32mPASS[0m in 0.06s]
[0m14:40:24.749872 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m14:40:24.838848 [debug] [Thread-3 (]: SQL status: OK in 0.099 seconds
[0m14:40:24.839318 [debug] [Thread-2 (]: SQL status: OK in 0.100 seconds
[0m14:40:24.840861 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: ROLLBACK
[0m14:40:24.841823 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: ROLLBACK
[0m14:40:24.842515 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a'
[0m14:40:24.843039 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f'
[0m14:40:24.843515 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: Close
[0m14:40:24.844023 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: Close
[0m14:40:24.844745 [info ] [Thread-3 (]: 54 of 91 PASS relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_  [[32mPASS[0m in 0.16s]
[0m14:40:24.845168 [info ] [Thread-2 (]: 55 of 91 PASS relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_  [[32mPASS[0m in 0.15s]
[0m14:40:24.845602 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m14:40:24.846372 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m14:40:24.881894 [debug] [Thread-1 (]: SQL status: OK in 0.142 seconds
[0m14:40:24.883241 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: ROLLBACK
[0m14:40:24.883943 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965'
[0m14:40:24.884312 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: Close
[0m14:40:24.901194 [info ] [Thread-1 (]: 53 of 91 PASS unique_stg_yellow_trips_trip_id .................................. [[32mPASS[0m in 0.21s]
[0m14:40:24.901911 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m14:40:24.902722 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m14:40:24.903159 [info ] [Thread-4 (]: 56 of 91 START sql view model main.int_trip_metrics ............................ [RUN]
[0m14:40:24.903539 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57, now model.nyc_taxi_pipeline_00.int_trip_metrics)
[0m14:40:24.903922 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m14:40:24.907606 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m14:40:24.912487 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m14:40:24.965498 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m14:40:24.972528 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m14:40:24.972839 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: BEGIN
[0m14:40:24.973062 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:24.991003 [debug] [Thread-4 (]: SQL status: OK in 0.018 seconds
[0m14:40:24.991484 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m14:40:24.991796 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */

  
  create view "dev"."main"."int_trip_metrics__dbt_tmp" as (
    /*
    Intermediate model: Trip-level enrichment with calculated metrics.
    Uses adapter-dispatched macros for cross-dialect compatibility.
*/

with trips as (
    select * from "dev"."main"."stg_yellow_trips"
),

enriched as (
    select
        trip_id,
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        payment_type_id,
        pickup_datetime,
        dropoff_datetime,
        passenger_count,
        trip_distance_miles,
        store_and_fwd_flag,

        -- calculated: duration in minutes
        
    datediff('minute', pickup_datetime, dropoff_datetime)
 as trip_duration_minutes,

        -- calculated: average speed (avoid division by zero)
        case
            when 
    datediff('minute', pickup_datetime, dropoff_datetime)
 > 0
            then round(
                trip_distance_miles / (
    datediff('minute', pickup_datetime, dropoff_datetime)
 / 60.0),
                2
            )
            else null
        end as avg_speed_mph,

        -- calculated: cost per mile
        case
            when trip_distance_miles > 0
            then round(fare_amount / trip_distance_miles, 2)
            else null
        end as cost_per_mile,

        -- calculated: tip percentage
        case
            when fare_amount > 0
            then round((tip_amount / fare_amount) * 100, 2)
            else null
        end as tip_percentage,

        -- time dimensions (using adapter-dispatched macros)
        date_trunc('day', pickup_datetime)::date as pickup_date,
        extract(hour from pickup_datetime) as pickup_hour,
        
    dayname(pickup_datetime)
 as pickup_day_of_week,
        case
            when extract(dow from pickup_datetime) in (0, 6) then true
            else false
        end as is_weekend,

        -- financials passthrough
        fare_amount,
        extra_amount,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount,
        congestion_surcharge,
        airport_fee

    from trips
)

select *
from enriched
where trip_duration_minutes between 1 and 720
  and (avg_speed_mph is null or avg_speed_mph < 100)
  );

[0m14:40:24.992998 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:24.994885 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m14:40:24.995275 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
alter view "dev"."main"."int_trip_metrics" rename to "int_trip_metrics__dbt_backup"
[0m14:40:24.995818 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:40:24.997252 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m14:40:24.997852 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
alter view "dev"."main"."int_trip_metrics__dbt_tmp" rename to "int_trip_metrics"
[0m14:40:24.998454 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:40:24.999293 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: COMMIT
[0m14:40:24.999631 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m14:40:25.000255 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: COMMIT
[0m14:40:25.005670 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m14:40:25.007669 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m14:40:25.008308 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
drop view if exists "dev"."main"."int_trip_metrics__dbt_backup" cascade
[0m14:40:25.010785 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:40:25.011636 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: Close
[0m14:40:25.043748 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '464e5f25-1623-4796-ade1-b5af4241b61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f54c16bdd0>]}
[0m14:40:25.044613 [info ] [Thread-4 (]: 56 of 91 OK created sql view model main.int_trip_metrics ....................... [[32mOK[0m in 0.14s]
[0m14:40:25.045495 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m14:40:25.046551 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m14:40:25.046804 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m14:40:25.047027 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m14:40:25.047223 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m14:40:25.047434 [info ] [Thread-2 (]: 57 of 91 START test assert_trip_duration_positive .............................. [RUN]
[0m14:40:25.047772 [info ] [Thread-1 (]: 58 of 91 START test dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0  [RUN]
[0m14:40:25.048150 [info ] [Thread-3 (]: 59 of 91 START test dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1  [RUN]
[0m14:40:25.048508 [info ] [Thread-4 (]: 60 of 91 START test not_null_int_trip_metrics_is_weekend ....................... [RUN]
[0m14:40:25.049070 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f, now test.nyc_taxi_pipeline_00.assert_trip_duration_positive)
[0m14:40:25.049548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574)
[0m14:40:25.049979 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718)
[0m14:40:25.050435 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_trip_metrics, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed)
[0m14:40:25.050766 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m14:40:25.051087 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m14:40:25.051368 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m14:40:25.051635 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m14:40:25.053421 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m14:40:25.057625 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m14:40:25.060253 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m14:40:25.062813 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m14:40:25.067637 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m14:40:25.068103 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m14:40:25.069812 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m14:40:25.072555 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m14:40:25.073290 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m14:40:25.074827 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m14:40:25.075112 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m14:40:25.076562 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m14:40:25.078544 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m14:40:25.079002 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m14:40:25.079227 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: BEGIN
[0m14:40:25.079827 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: BEGIN
[0m14:40:25.080374 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:40:25.080775 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m14:40:25.081042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:25.081410 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m14:40:25.081859 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: BEGIN
[0m14:40:25.082505 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: BEGIN
[0m14:40:25.082838 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:25.083143 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:25.699419 [debug] [Thread-2 (]: SQL status: OK in 0.021 seconds
[0m14:40:25.699750 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m14:40:25.699984 [debug] [Thread-4 (]: SQL status: OK in 0.019 seconds
[0m14:40:25.700385 [debug] [Thread-3 (]: SQL status: OK in 0.019 seconds
[0m14:40:25.700622 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m14:40:25.701090 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m14:40:25.701490 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m14:40:25.701835 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m14:40:25.702184 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
    Singular test: No trip should have negative duration.
*/

select
    trip_id,
    pickup_datetime,
    dropoff_datetime,
    trip_duration_minutes
from "dev"."main"."int_trip_metrics"
where trip_duration_minutes < 0
  
  
      
    ) dbt_internal_test
[0m14:40:25.702549 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_trip_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m14:40:25.702881 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."int_trip_metrics"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m14:40:25.703202 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_trip_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not trip_duration_minutes >= 1
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not trip_duration_minutes <= 720
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m14:40:25.704906 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:40:25.706020 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: ROLLBACK
[0m14:40:25.706250 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:40:25.709450 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.assert_trip_duration_positive'
[0m14:40:25.711316 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: ROLLBACK
[0m14:40:25.712719 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: Close
[0m14:40:25.714855 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed'
[0m14:40:25.715430 [info ] [Thread-2 (]: 57 of 91 PASS assert_trip_duration_positive .................................... [[32mPASS[0m in 0.67s]
[0m14:40:25.718400 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: Close
[0m14:40:25.720809 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m14:40:25.723865 [info ] [Thread-4 (]: 60 of 91 PASS not_null_int_trip_metrics_is_weekend ............................. [[32mPASS[0m in 0.67s]
[0m14:40:25.725171 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m14:40:25.727555 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m14:40:25.729942 [info ] [Thread-2 (]: 61 of 91 START test not_null_int_trip_metrics_pickup_date ...................... [RUN]
[0m14:40:25.732368 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m14:40:25.734159 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.assert_trip_duration_positive, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3)
[0m14:40:25.734744 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m14:40:25.736362 [info ] [Thread-4 (]: 62 of 91 START test not_null_int_trip_metrics_pickup_hour ...................... [RUN]
[0m14:40:25.738406 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m14:40:25.741562 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: ROLLBACK
[0m14:40:25.741954 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082)
[0m14:40:25.745883 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m14:40:25.748349 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574'
[0m14:40:25.750679 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m14:40:25.755053 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: Close
[0m14:40:25.759367 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m14:40:25.761480 [info ] [Thread-1 (]: 58 of 91 PASS dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0 ..... [[32mPASS[0m in 0.71s]
[0m14:40:25.768617 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m14:40:25.772515 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m14:40:25.773174 [info ] [Thread-1 (]: 63 of 91 START test not_null_int_trip_metrics_trip_duration_minutes ............ [RUN]
[0m14:40:25.773616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c)
[0m14:40:25.773919 [debug] [Thread-3 (]: SQL status: OK in 0.069 seconds
[0m14:40:25.774117 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m14:40:25.775277 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: ROLLBACK
[0m14:40:25.777539 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m14:40:25.778410 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718'
[0m14:40:25.778691 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m14:40:25.779067 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: Close
[0m14:40:25.779270 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m14:40:25.780462 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m14:40:25.781971 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m14:40:25.783283 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m14:40:25.784897 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m14:40:25.785567 [info ] [Thread-3 (]: 59 of 91 PASS dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1  [[32mPASS[0m in 0.74s]
[0m14:40:25.786040 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m14:40:25.786629 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m14:40:25.787113 [info ] [Thread-3 (]: 64 of 91 START test not_null_int_trip_metrics_trip_id .......................... [RUN]
[0m14:40:25.787501 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f)
[0m14:40:25.787814 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m14:40:25.791363 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m14:40:25.792874 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m14:40:25.793139 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m14:40:25.793386 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m14:40:25.793584 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: BEGIN
[0m14:40:25.793859 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: BEGIN
[0m14:40:25.794167 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: BEGIN
[0m14:40:25.794499 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:40:25.794831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:25.795176 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:26.554454 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m14:40:26.556303 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m14:40:26.562838 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m14:40:26.563408 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: BEGIN
[0m14:40:26.563891 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:26.567804 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m14:40:26.568082 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m14:40:26.568317 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m14:40:26.568513 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m14:40:26.568750 [debug] [Thread-4 (]: SQL status: OK in 0.018 seconds
[0m14:40:26.569115 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m14:40:26.569419 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_trip_metrics"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m14:40:26.569662 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m14:40:26.569886 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m14:40:26.570120 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_duration_minutes
from "dev"."main"."int_trip_metrics"
where trip_duration_minutes is null



  
  
      
    ) dbt_internal_test
[0m14:40:26.570557 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."int_trip_metrics"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m14:40:26.570836 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."int_trip_metrics"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m14:40:26.571558 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:40:26.572642 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: ROLLBACK
[0m14:40:26.572947 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:40:26.573186 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:40:26.574984 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3'
[0m14:40:26.577826 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: ROLLBACK
[0m14:40:26.579719 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: ROLLBACK
[0m14:40:26.580832 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: Close
[0m14:40:26.584297 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f'
[0m14:40:26.586257 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082'
[0m14:40:26.588798 [info ] [Thread-2 (]: 61 of 91 PASS not_null_int_trip_metrics_pickup_date ............................ [[32mPASS[0m in 0.85s]
[0m14:40:26.589695 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: Close
[0m14:40:26.592633 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: Close
[0m14:40:26.594940 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m14:40:26.597337 [info ] [Thread-3 (]: 64 of 91 PASS not_null_int_trip_metrics_trip_id ................................ [[32mPASS[0m in 0.81s]
[0m14:40:26.598881 [info ] [Thread-4 (]: 62 of 91 PASS not_null_int_trip_metrics_pickup_hour ............................ [[32mPASS[0m in 0.86s]
[0m14:40:26.602385 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m14:40:26.604708 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m14:40:26.629342 [debug] [Thread-1 (]: SQL status: OK in 0.058 seconds
[0m14:40:26.630711 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: ROLLBACK
[0m14:40:26.631380 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c'
[0m14:40:26.631679 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: Close
[0m14:40:26.635653 [info ] [Thread-1 (]: 63 of 91 PASS not_null_int_trip_metrics_trip_duration_minutes .................. [[32mPASS[0m in 0.86s]
[0m14:40:26.636132 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m14:40:26.636721 [debug] [Thread-2 (]: Began running node model.nyc_taxi_pipeline_00.int_daily_summary
[0m14:40:26.636946 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m14:40:26.637308 [info ] [Thread-2 (]: 65 of 91 START sql view model main.int_daily_summary ........................... [RUN]
[0m14:40:26.637553 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.fct_trips
[0m14:40:26.637813 [info ] [Thread-3 (]: 66 of 91 START sql view model main.int_hourly_patterns ......................... [RUN]
[0m14:40:26.638205 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3, now model.nyc_taxi_pipeline_00.int_daily_summary)
[0m14:40:26.638566 [info ] [Thread-4 (]: 67 of 91 START sql incremental model main.fct_trips ............................ [RUN]
[0m14:40:26.638888 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f, now model.nyc_taxi_pipeline_00.int_hourly_patterns)
[0m14:40:26.639207 [debug] [Thread-2 (]: Began compiling node model.nyc_taxi_pipeline_00.int_daily_summary
[0m14:40:26.639624 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082, now model.nyc_taxi_pipeline_00.fct_trips)
[0m14:40:26.639890 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m14:40:26.641591 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m14:40:26.641932 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.fct_trips
[0m14:40:26.643419 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m14:40:26.647340 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.fct_trips"
[0m14:40:26.650773 [debug] [Thread-2 (]: Began executing node model.nyc_taxi_pipeline_00.int_daily_summary
[0m14:40:26.651004 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m14:40:26.652620 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m14:40:26.654601 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m14:40:26.655952 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.fct_trips
[0m14:40:26.673086 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m14:40:26.673920 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
DESCRIBE (select * from (
        /*
    Fact table: Fully enriched trip records with location names.
    Incremental with delete+insert strategy.
*/



with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

pickup_locations as (
    select * from "dev"."main"."dim_locations"
),

dropoff_locations as (
    select * from "dev"."main"."dim_locations"
),

final as (
    select
        t.trip_id,
        t.vendor_id,
        t.rate_code_id,
        t.payment_type_id,
        t.pickup_location_id,
        t.dropoff_location_id,
        t.pickup_datetime,
        t.dropoff_datetime,
        t.pickup_date,
        t.pickup_hour,
        t.pickup_day_of_week,
        t.is_weekend,
        t.passenger_count,
        t.trip_distance_miles,
        t.trip_duration_minutes,
        t.avg_speed_mph,
        t.cost_per_mile,
        t.fare_amount,
        t.extra_amount,
        t.mta_tax,
        t.tip_amount,
        t.tip_percentage,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.congestion_surcharge,
        t.airport_fee,

        -- enriched from dimensions
        pu.borough as pickup_borough,
        pu.zone_name as pickup_zone,
        do_loc.borough as dropoff_borough,
        do_loc.zone_name as dropoff_zone

    from trip_metrics t
    left join pickup_locations pu
        on t.pickup_location_id = pu.location_id
    left join dropoff_locations do_loc
        on t.dropoff_location_id = do_loc.location_id

    
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:40:26.674348 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:26.674711 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m14:40:26.675078 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m14:40:26.675266 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: BEGIN
[0m14:40:26.675818 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: BEGIN
[0m14:40:26.676370 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:40:26.676712 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:26.692249 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m14:40:26.692565 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m14:40:26.692794 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m14:40:26.693099 [debug] [Thread-4 (]: SQL status: OK in 0.019 seconds
[0m14:40:26.693293 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m14:40:26.693585 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */

  
  create view "dev"."main"."int_daily_summary__dbt_tmp" as (
    /*
    Intermediate model: Daily aggregated trip and revenue metrics.
    One row per day with counts, averages, and revenue totals.
*/

with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

daily_agg as (
    select
        pickup_date,
        pickup_day_of_week,
        is_weekend,

        count(*) as total_trips,
        sum(passenger_count) as total_passengers,

        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(avg(avg_speed_mph), 2) as avg_speed_mph,

        round(sum(fare_amount), 2) as total_fare_revenue,
        round(sum(tip_amount), 2) as total_tip_revenue,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_trip_revenue,
        round(avg(tip_percentage), 2) as avg_tip_percentage,

        count(case when payment_type_id = 1 then 1 end) as credit_card_trips,
        count(case when payment_type_id = 2 then 1 end) as cash_trips

    from trip_metrics
    group by pickup_date, pickup_day_of_week, is_weekend
)

select * from daily_agg
  );

[0m14:40:26.695177 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m14:40:26.695396 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */

  
  create view "dev"."main"."int_hourly_patterns__dbt_tmp" as (
    /*
    Intermediate model: Hourly trip patterns by date.
    One row per date + hour combination.
*/

with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

hourly_agg as (
    select
        pickup_date,
        pickup_hour,
        pickup_day_of_week,
        is_weekend,

        count(*) as total_trips,
        round(avg(trip_distance_miles), 2) as avg_distance,
        round(avg(trip_duration_minutes), 2) as avg_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue

    from trip_metrics
    group by pickup_date, pickup_hour, pickup_day_of_week, is_weekend
)

select * from hourly_agg
  );

[0m14:40:26.695887 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as varchar)
 as trip_id, 
      
    cast(null as integer)
 as vendor_id, 
      
    cast(null as integer)
 as rate_code_id, 
      
    cast(null as integer)
 as payment_type_id, 
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as integer)
 as dropoff_location_id, 
      
    cast(null as timestamp)
 as pickup_datetime, 
      
    cast(null as timestamp)
 as dropoff_datetime, 
      
    cast(null as date)
 as pickup_date, 
      
    cast(null as bigint)
 as pickup_hour, 
      
    cast(null as varchar)
 as pickup_day_of_week, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as integer)
 as passenger_count, 
      
    cast(null as double)
 as trip_distance_miles, 
      
    cast(null as bigint)
 as trip_duration_minutes, 
      
    cast(null as double)
 as avg_speed_mph, 
      
    cast(null as double)
 as cost_per_mile, 
      
    cast(null as decimal(10,2))
 as fare_amount, 
      
    cast(null as decimal(10,2))
 as extra_amount, 
      
    cast(null as decimal(10,2))
 as mta_tax, 
      
    cast(null as decimal(10,2))
 as tip_amount, 
      
    cast(null as double)
 as tip_percentage, 
      
    cast(null as decimal(10,2))
 as tolls_amount, 
      
    cast(null as decimal(10,2))
 as improvement_surcharge, 
      
    cast(null as decimal(10,2))
 as total_amount, 
      
    cast(null as decimal(10,2))
 as congestion_surcharge, 
      
    cast(null as decimal(10,2))
 as airport_fee, 
      
    cast(null as varchar)
 as pickup_borough, 
      
    cast(null as varchar)
 as pickup_zone, 
      
    cast(null as varchar)
 as dropoff_borough, 
      
    cast(null as varchar)
 as dropoff_zone
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:40:26.696649 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:40:26.696881 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:40:26.697117 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:26.698846 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m14:40:26.701062 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.fct_trips"
[0m14:40:26.702680 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m14:40:26.703011 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
alter view "dev"."main"."int_daily_summary" rename to "int_daily_summary__dbt_backup"
[0m14:40:26.703552 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
alter view "dev"."main"."int_hourly_patterns" rename to "int_hourly_patterns__dbt_backup"
[0m14:40:26.704066 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:40:26.704311 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:40:26.705662 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m14:40:26.707023 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m14:40:26.707520 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
alter view "dev"."main"."int_daily_summary__dbt_tmp" rename to "int_daily_summary"
[0m14:40:26.707819 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
alter view "dev"."main"."int_hourly_patterns__dbt_tmp" rename to "int_hourly_patterns"
[0m14:40:26.708437 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:40:26.708677 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:40:26.709356 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: COMMIT
[0m14:40:26.709565 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m14:40:26.710323 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: COMMIT
[0m14:40:26.710664 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m14:40:26.710992 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.fct_trips: BEGIN
[0m14:40:26.711429 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m14:40:26.711736 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: COMMIT
[0m14:40:26.712194 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:40:26.712361 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: COMMIT
[0m14:40:26.712877 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m14:40:26.713417 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */

  
    
    
      
    

    create  table
      "dev"."main"."fct_trips__dbt_tmp"
  
  (
    trip_id varchar,
    vendor_id integer,
    rate_code_id integer,
    payment_type_id integer,
    pickup_location_id integer,
    dropoff_location_id integer,
    pickup_datetime timestamp,
    dropoff_datetime timestamp,
    pickup_date date,
    pickup_hour bigint,
    pickup_day_of_week varchar,
    is_weekend boolean,
    passenger_count integer,
    trip_distance_miles double,
    trip_duration_minutes bigint,
    avg_speed_mph double,
    cost_per_mile double,
    fare_amount decimal(10,2),
    extra_amount decimal(10,2),
    mta_tax decimal(10,2),
    tip_amount decimal(10,2),
    tip_percentage double,
    tolls_amount decimal(10,2),
    improvement_surcharge decimal(10,2),
    total_amount decimal(10,2),
    congestion_surcharge decimal(10,2),
    airport_fee decimal(10,2),
    pickup_borough varchar,
    pickup_zone varchar,
    dropoff_borough varchar,
    dropoff_zone varchar
    
    )
 ;
    insert into "dev"."main"."fct_trips__dbt_tmp" 
  (
    
      
      trip_id ,
    
      
      vendor_id ,
    
      
      rate_code_id ,
    
      
      payment_type_id ,
    
      
      pickup_location_id ,
    
      
      dropoff_location_id ,
    
      
      pickup_datetime ,
    
      
      dropoff_datetime ,
    
      
      pickup_date ,
    
      
      pickup_hour ,
    
      
      pickup_day_of_week ,
    
      
      is_weekend ,
    
      
      passenger_count ,
    
      
      trip_distance_miles ,
    
      
      trip_duration_minutes ,
    
      
      avg_speed_mph ,
    
      
      cost_per_mile ,
    
      
      fare_amount ,
    
      
      extra_amount ,
    
      
      mta_tax ,
    
      
      tip_amount ,
    
      
      tip_percentage ,
    
      
      tolls_amount ,
    
      
      improvement_surcharge ,
    
      
      total_amount ,
    
      
      congestion_surcharge ,
    
      
      airport_fee ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      dropoff_borough ,
    
      
      dropoff_zone 
    
  )
 (
      
    select trip_id, vendor_id, rate_code_id, payment_type_id, pickup_location_id, dropoff_location_id, pickup_datetime, dropoff_datetime, pickup_date, pickup_hour, pickup_day_of_week, is_weekend, passenger_count, trip_distance_miles, trip_duration_minutes, avg_speed_mph, cost_per_mile, fare_amount, extra_amount, mta_tax, tip_amount, tip_percentage, tolls_amount, improvement_surcharge, total_amount, congestion_surcharge, airport_fee, pickup_borough, pickup_zone, dropoff_borough, dropoff_zone
    from (
        /*
    Fact table: Fully enriched trip records with location names.
    Incremental with delete+insert strategy.
*/



with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

pickup_locations as (
    select * from "dev"."main"."dim_locations"
),

dropoff_locations as (
    select * from "dev"."main"."dim_locations"
),

final as (
    select
        t.trip_id,
        t.vendor_id,
        t.rate_code_id,
        t.payment_type_id,
        t.pickup_location_id,
        t.dropoff_location_id,
        t.pickup_datetime,
        t.dropoff_datetime,
        t.pickup_date,
        t.pickup_hour,
        t.pickup_day_of_week,
        t.is_weekend,
        t.passenger_count,
        t.trip_distance_miles,
        t.trip_duration_minutes,
        t.avg_speed_mph,
        t.cost_per_mile,
        t.fare_amount,
        t.extra_amount,
        t.mta_tax,
        t.tip_amount,
        t.tip_percentage,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.congestion_surcharge,
        t.airport_fee,

        -- enriched from dimensions
        pu.borough as pickup_borough,
        pu.zone_name as pickup_zone,
        do_loc.borough as dropoff_borough,
        do_loc.zone_name as dropoff_zone

    from trip_metrics t
    left join pickup_locations pu
        on t.pickup_location_id = pu.location_id
    left join dropoff_locations do_loc
        on t.dropoff_location_id = do_loc.location_id

    
)

select * from final
    ) as model_subq
    );
  
  
  
[0m14:40:26.718467 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m14:40:26.722489 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m14:40:26.724600 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
drop view if exists "dev"."main"."int_daily_summary__dbt_backup" cascade
[0m14:40:26.730558 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m14:40:26.734186 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m14:40:26.735861 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
drop view if exists "dev"."main"."int_hourly_patterns__dbt_backup" cascade
[0m14:40:26.741305 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m14:40:26.744213 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: Close
[0m14:40:26.745797 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '464e5f25-1623-4796-ade1-b5af4241b61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f55ff0e960>]}
[0m14:40:26.747937 [info ] [Thread-2 (]: 65 of 91 OK created sql view model main.int_daily_summary ...................... [[32mOK[0m in 0.11s]
[0m14:40:26.750602 [debug] [Thread-2 (]: Finished running node model.nyc_taxi_pipeline_00.int_daily_summary
[0m14:40:26.751685 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m14:40:26.753426 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m14:40:26.753793 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m14:40:26.755276 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: Close
[0m14:40:26.757354 [info ] [Thread-1 (]: 68 of 91 START test dbt_utils_accepted_range_int_daily_summary_total_trips__0 .. [RUN]
[0m14:40:26.759404 [info ] [Thread-2 (]: 69 of 91 START test not_null_int_daily_summary_pickup_date ..................... [RUN]
[0m14:40:26.761784 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '464e5f25-1623-4796-ade1-b5af4241b61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f57816ca10>]}
[0m14:40:26.762605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863)
[0m14:40:26.764509 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_daily_summary, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686)
[0m14:40:26.766667 [info ] [Thread-3 (]: 66 of 91 OK created sql view model main.int_hourly_patterns .................... [[32mOK[0m in 0.12s]
[0m14:40:26.768903 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m14:40:26.770312 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m14:40:26.772822 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m14:40:26.777302 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m14:40:26.780909 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m14:40:26.783586 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m14:40:26.789189 [info ] [Thread-3 (]: 70 of 91 START test not_null_int_daily_summary_total_revenue ................... [RUN]
[0m14:40:26.791350 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_hourly_patterns, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50)
[0m14:40:26.793233 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m14:40:26.797370 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m14:40:26.813832 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m14:40:26.820848 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m14:40:26.822312 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m14:40:26.827830 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m14:40:26.828888 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m14:40:26.833217 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m14:40:26.862081 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m14:40:26.864447 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: BEGIN
[0m14:40:26.866646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:26.867433 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m14:40:26.870979 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: BEGIN
[0m14:40:26.871482 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:40:26.872010 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m14:40:26.874505 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: BEGIN
[0m14:40:26.873595 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m14:40:26.872642 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:40:26.880471 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m14:40:26.879025 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_daily_summary"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_trips >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m14:40:26.875626 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:26.882147 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m14:40:26.887671 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m14:40:26.890150 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_daily_summary"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m14:40:26.892205 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m14:40:26.894663 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "dev"."main"."int_daily_summary"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m14:40:26.897511 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:40:26.899682 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: ROLLBACK
[0m14:40:26.904488 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686'
[0m14:40:26.905271 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: Close
[0m14:40:26.906331 [info ] [Thread-2 (]: 69 of 91 PASS not_null_int_daily_summary_pickup_date ........................... [[32mPASS[0m in 0.14s]
[0m14:40:26.909026 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m14:40:26.910834 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m14:40:26.912644 [info ] [Thread-2 (]: 71 of 91 START test not_null_int_daily_summary_total_trips ..................... [RUN]
[0m14:40:26.914379 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10)
[0m14:40:26.915924 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m14:40:26.922956 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m14:40:26.993523 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m14:40:26.998140 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m14:40:27.052927 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m14:40:27.053800 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: BEGIN
[0m14:40:27.054420 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:40:27.055270 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:40:27.055992 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m14:40:27.056790 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_trips
from "dev"."main"."int_daily_summary"
where total_trips is null



  
  
      
    ) dbt_internal_test
[0m14:40:27.134298 [debug] [Thread-1 (]: SQL status: OK in 0.249 seconds
[0m14:40:27.136111 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: ROLLBACK
[0m14:40:27.136952 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863'
[0m14:40:27.137268 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: Close
[0m14:40:27.137929 [info ] [Thread-1 (]: 68 of 91 PASS dbt_utils_accepted_range_int_daily_summary_total_trips__0 ........ [[32mPASS[0m in 0.38s]
[0m14:40:27.138447 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m14:40:27.139101 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m14:40:27.139659 [info ] [Thread-1 (]: 72 of 91 START test unique_int_daily_summary_pickup_date ....................... [RUN]
[0m14:40:27.140348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863, now test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e)
[0m14:40:27.140798 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m14:40:27.143797 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m14:40:27.153076 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m14:40:27.156667 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m14:40:27.168512 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m14:40:27.169167 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: BEGIN
[0m14:40:27.169674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:27.170546 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:27.171130 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m14:40:27.171683 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pickup_date as unique_field,
    count(*) as n_records

from "dev"."main"."int_daily_summary"
where pickup_date is not null
group by pickup_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:40:27.249222 [debug] [Thread-2 (]: SQL status: OK in 0.192 seconds
[0m14:40:27.250871 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: ROLLBACK
[0m14:40:27.251712 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10'
[0m14:40:27.252242 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: Close
[0m14:40:27.252853 [info ] [Thread-2 (]: 71 of 91 PASS not_null_int_daily_summary_total_trips ........................... [[32mPASS[0m in 0.34s]
[0m14:40:27.253966 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m14:40:27.254481 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m14:40:27.255030 [info ] [Thread-2 (]: 73 of 91 START test dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0  [RUN]
[0m14:40:27.255882 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe)
[0m14:40:27.256660 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m14:40:27.259858 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m14:40:27.261404 [debug] [Thread-3 (]: SQL status: OK in 0.366 seconds
[0m14:40:27.262893 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: ROLLBACK
[0m14:40:27.263714 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50'
[0m14:40:27.264132 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: Close
[0m14:40:27.264689 [info ] [Thread-3 (]: 70 of 91 PASS not_null_int_daily_summary_total_revenue ......................... [[32mPASS[0m in 0.47s]
[0m14:40:27.265506 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m14:40:27.266096 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m14:40:27.266566 [info ] [Thread-3 (]: 74 of 91 START test not_null_int_hourly_patterns_pickup_date ................... [RUN]
[0m14:40:27.267404 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2)
[0m14:40:27.267801 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m14:40:27.270999 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m14:40:27.272683 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m14:40:27.274235 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m14:40:27.276197 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m14:40:27.278060 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m14:40:27.283118 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m14:40:27.283576 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: BEGIN
[0m14:40:27.284029 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:27.284393 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m14:40:27.285035 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:27.285347 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: BEGIN
[0m14:40:27.285791 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m14:40:27.286141 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:40:27.286437 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_hourly_patterns"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m14:40:27.287115 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:40:27.287821 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m14:40:27.288416 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_hourly_patterns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m14:40:27.288994 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:40:27.291033 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: ROLLBACK
[0m14:40:27.293065 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2'
[0m14:40:27.294007 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: Close
[0m14:40:27.294972 [info ] [Thread-3 (]: 74 of 91 PASS not_null_int_hourly_patterns_pickup_date ......................... [[32mPASS[0m in 0.03s]
[0m14:40:27.295966 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m14:40:27.296711 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m14:40:27.297560 [info ] [Thread-3 (]: 75 of 91 START test not_null_int_hourly_patterns_pickup_hour ................... [RUN]
[0m14:40:27.298029 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d)
[0m14:40:27.298792 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m14:40:27.302316 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m14:40:27.304717 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m14:40:27.306079 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: ROLLBACK
[0m14:40:27.307017 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe'
[0m14:40:27.307550 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: Close
[0m14:40:27.308211 [info ] [Thread-2 (]: 73 of 91 PASS dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0 .. [[32mPASS[0m in 0.05s]
[0m14:40:27.308968 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m14:40:27.309721 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m14:40:27.310384 [info ] [Thread-2 (]: 76 of 91 START test not_null_int_hourly_patterns_total_trips ................... [RUN]
[0m14:40:27.310923 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf)
[0m14:40:27.311209 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m14:40:27.311461 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m14:40:27.313282 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m14:40:27.316184 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m14:40:27.323727 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m14:40:27.324384 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: BEGIN
[0m14:40:27.324664 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m14:40:27.324905 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:27.327339 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m14:40:27.328448 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:40:27.328939 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m14:40:27.329634 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."int_hourly_patterns"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m14:40:27.331684 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:40:27.333099 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: ROLLBACK
[0m14:40:27.334074 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d'
[0m14:40:27.334581 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: Close
[0m14:40:27.335278 [info ] [Thread-3 (]: 75 of 91 PASS not_null_int_hourly_patterns_pickup_hour ......................... [[32mPASS[0m in 0.04s]
[0m14:40:27.335813 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m14:40:27.339041 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m14:40:27.339510 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: BEGIN
[0m14:40:27.339806 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:40:27.340518 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:40:27.341131 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m14:40:27.341594 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_trips
from "dev"."main"."int_hourly_patterns"
where total_trips is null



  
  
      
    ) dbt_internal_test
[0m14:40:27.342611 [debug] [Thread-1 (]: SQL status: OK in 0.170 seconds
[0m14:40:27.344217 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: ROLLBACK
[0m14:40:27.345485 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e'
[0m14:40:27.346101 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: Close
[0m14:40:27.347110 [info ] [Thread-1 (]: 72 of 91 PASS unique_int_daily_summary_pickup_date ............................. [[32mPASS[0m in 0.21s]
[0m14:40:27.348122 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m14:40:27.349117 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m14:40:27.349797 [info ] [Thread-3 (]: 77 of 91 START sql table model main.mart_daily_revenue ......................... [RUN]
[0m14:40:27.350337 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d, now model.nyc_taxi_pipeline_00.mart_daily_revenue)
[0m14:40:27.350756 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m14:40:27.353468 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m14:40:27.362179 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m14:40:27.366352 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m14:40:27.367359 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Daily revenue metrics with running totals.
*/

with daily as (
    select * from "dev"."main"."int_daily_summary"
),

dates as (
    select * from "dev"."main"."dim_dates"
),

final as (
    select
        d.date_key,
        d.day_of_week_name,
        d.is_weekend,
        d.is_holiday,
        d.week_of_year,

        daily.total_trips,
        daily.total_passengers,
        daily.total_fare_revenue,
        daily.total_tip_revenue,
        daily.total_revenue,
        daily.avg_trip_revenue,
        daily.avg_tip_percentage,
        daily.credit_card_trips,
        daily.cash_trips,
        daily.avg_trip_distance,
        daily.avg_trip_duration_min,

        -- running total
        sum(daily.total_revenue) over (order by d.date_key) as cumulative_revenue,

        -- day-over-day change
        daily.total_revenue - lag(daily.total_revenue) over (order by d.date_key) as revenue_change_vs_prior_day

    from daily
    inner join dates d
        on daily.pickup_date = d.date_key
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:40:27.367995 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:27.370984 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:40:27.373932 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m14:40:27.374422 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as date_key, 
      
    cast(null as varchar)
 as day_of_week_name, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as boolean)
 as is_holiday, 
      
    cast(null as bigint)
 as week_of_year, 
      
    cast(null as bigint)
 as total_trips, 
      
    cast(null as hugeint)
 as total_passengers, 
      
    cast(null as decimal(38,2))
 as total_fare_revenue, 
      
    cast(null as decimal(38,2))
 as total_tip_revenue, 
      
    cast(null as decimal(38,2))
 as total_revenue, 
      
    cast(null as double)
 as avg_trip_revenue, 
      
    cast(null as double)
 as avg_tip_percentage, 
      
    cast(null as bigint)
 as credit_card_trips, 
      
    cast(null as bigint)
 as cash_trips, 
      
    cast(null as double)
 as avg_trip_distance, 
      
    cast(null as double)
 as avg_trip_duration_min, 
      
    cast(null as decimal(38,2))
 as cumulative_revenue, 
      
    cast(null as decimal(38,2))
 as revenue_change_vs_prior_day
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:40:27.375348 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:40:27.377818 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m14:40:27.385224 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m14:40:27.385544 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: BEGIN
[0m14:40:27.386258 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:40:27.386560 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m14:40:27.386931 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_daily_revenue__dbt_tmp"
  
  (
    date_key date,
    day_of_week_name varchar,
    is_weekend boolean,
    is_holiday boolean,
    week_of_year bigint,
    total_trips bigint,
    total_passengers hugeint,
    total_fare_revenue decimal(38,2),
    total_tip_revenue decimal(38,2),
    total_revenue decimal(38,2),
    avg_trip_revenue double,
    avg_tip_percentage double,
    credit_card_trips bigint,
    cash_trips bigint,
    avg_trip_distance double,
    avg_trip_duration_min double,
    cumulative_revenue decimal(38,2),
    revenue_change_vs_prior_day decimal(38,2)
    
    )
 ;
    insert into "dev"."main"."mart_daily_revenue__dbt_tmp" 
  (
    
      
      date_key ,
    
      
      day_of_week_name ,
    
      
      is_weekend ,
    
      
      is_holiday ,
    
      
      week_of_year ,
    
      
      total_trips ,
    
      
      total_passengers ,
    
      
      total_fare_revenue ,
    
      
      total_tip_revenue ,
    
      
      total_revenue ,
    
      
      avg_trip_revenue ,
    
      
      avg_tip_percentage ,
    
      
      credit_card_trips ,
    
      
      cash_trips ,
    
      
      avg_trip_distance ,
    
      
      avg_trip_duration_min ,
    
      
      cumulative_revenue ,
    
      
      revenue_change_vs_prior_day 
    
  )
 (
      
    select date_key, day_of_week_name, is_weekend, is_holiday, week_of_year, total_trips, total_passengers, total_fare_revenue, total_tip_revenue, total_revenue, avg_trip_revenue, avg_tip_percentage, credit_card_trips, cash_trips, avg_trip_distance, avg_trip_duration_min, cumulative_revenue, revenue_change_vs_prior_day
    from (
        /*
    Analytics mart: Daily revenue metrics with running totals.
*/

with daily as (
    select * from "dev"."main"."int_daily_summary"
),

dates as (
    select * from "dev"."main"."dim_dates"
),

final as (
    select
        d.date_key,
        d.day_of_week_name,
        d.is_weekend,
        d.is_holiday,
        d.week_of_year,

        daily.total_trips,
        daily.total_passengers,
        daily.total_fare_revenue,
        daily.total_tip_revenue,
        daily.total_revenue,
        daily.avg_trip_revenue,
        daily.avg_tip_percentage,
        daily.credit_card_trips,
        daily.cash_trips,
        daily.avg_trip_distance,
        daily.avg_trip_duration_min,

        -- running total
        sum(daily.total_revenue) over (order by d.date_key) as cumulative_revenue,

        -- day-over-day change
        daily.total_revenue - lag(daily.total_revenue) over (order by d.date_key) as revenue_change_vs_prior_day

    from daily
    inner join dates d
        on daily.pickup_date = d.date_key
)

select * from final
    ) as model_subq
    );
  
  
[0m14:40:27.466837 [debug] [Thread-2 (]: SQL status: OK in 0.124 seconds
[0m14:40:27.468510 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: ROLLBACK
[0m14:40:27.469338 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf'
[0m14:40:27.469712 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: Close
[0m14:40:27.470259 [info ] [Thread-2 (]: 76 of 91 PASS not_null_int_hourly_patterns_total_trips ......................... [[32mPASS[0m in 0.16s]
[0m14:40:27.470809 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m14:40:27.471795 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m14:40:27.472580 [info ] [Thread-1 (]: 78 of 91 START sql table model main.mart_hourly_demand ......................... [RUN]
[0m14:40:27.473050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e, now model.nyc_taxi_pipeline_00.mart_hourly_demand)
[0m14:40:27.473388 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m14:40:27.475601 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m14:40:27.482880 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m14:40:27.485646 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m14:40:27.486419 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Hourly demand patterns.
*/

with hourly as (
    select * from "dev"."main"."int_hourly_patterns"
),

final as (
    select
        pickup_hour,
        is_weekend,

        count(*) as days_observed,
        round(avg(total_trips), 0) as avg_trips_per_period,
        round(avg(avg_distance), 2) as avg_distance,
        round(avg(avg_duration_min), 2) as avg_duration_min,
        round(avg(total_revenue), 2) as avg_revenue_per_period,
        sum(total_trips) as total_trips_all_days

    from hourly
    group by pickup_hour, is_weekend
)

select * from final
order by is_weekend, pickup_hour
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:40:27.486948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:27.489483 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:40:27.492038 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m14:40:27.492844 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as bigint)
 as pickup_hour, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as bigint)
 as days_observed, 
      
    cast(null as double)
 as avg_trips_per_period, 
      
    cast(null as double)
 as avg_distance, 
      
    cast(null as double)
 as avg_duration_min, 
      
    cast(null as double)
 as avg_revenue_per_period, 
      
    cast(null as hugeint)
 as total_trips_all_days
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:40:27.493948 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:27.495669 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m14:40:27.507019 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m14:40:27.508038 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: BEGIN
[0m14:40:27.508981 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:40:27.509475 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m14:40:27.509981 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_hourly_demand__dbt_tmp"
  
  (
    pickup_hour bigint,
    is_weekend boolean,
    days_observed bigint,
    avg_trips_per_period double,
    avg_distance double,
    avg_duration_min double,
    avg_revenue_per_period double,
    total_trips_all_days hugeint
    
    )
 ;
    insert into "dev"."main"."mart_hourly_demand__dbt_tmp" 
  (
    
      
      pickup_hour ,
    
      
      is_weekend ,
    
      
      days_observed ,
    
      
      avg_trips_per_period ,
    
      
      avg_distance ,
    
      
      avg_duration_min ,
    
      
      avg_revenue_per_period ,
    
      
      total_trips_all_days 
    
  )
 (
      
    select pickup_hour, is_weekend, days_observed, avg_trips_per_period, avg_distance, avg_duration_min, avg_revenue_per_period, total_trips_all_days
    from (
        /*
    Analytics mart: Hourly demand patterns.
*/

with hourly as (
    select * from "dev"."main"."int_hourly_patterns"
),

final as (
    select
        pickup_hour,
        is_weekend,

        count(*) as days_observed,
        round(avg(total_trips), 0) as avg_trips_per_period,
        round(avg(avg_distance), 2) as avg_distance,
        round(avg(avg_duration_min), 2) as avg_duration_min,
        round(avg(total_revenue), 2) as avg_revenue_per_period,
        sum(total_trips) as total_trips_all_days

    from hourly
    group by pickup_hour, is_weekend
)

select * from final
order by is_weekend, pickup_hour
    ) as model_subq
    );
  
  
[0m14:40:27.605938 [debug] [Thread-3 (]: SQL status: OK in 0.218 seconds
[0m14:40:27.610519 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m14:40:27.611588 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
alter table "dev"."main"."mart_daily_revenue" rename to "mart_daily_revenue__dbt_backup"
[0m14:40:27.612924 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:27.617074 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m14:40:27.617753 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
alter table "dev"."main"."mart_daily_revenue__dbt_tmp" rename to "mart_daily_revenue"
[0m14:40:27.618797 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:40:27.621355 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: COMMIT
[0m14:40:27.621975 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m14:40:27.622544 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: COMMIT
[0m14:40:27.630095 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m14:40:27.633520 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m14:40:27.634131 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
drop table if exists "dev"."main"."mart_daily_revenue__dbt_backup" cascade
[0m14:40:27.638290 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m14:40:27.640282 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: Close
[0m14:40:27.641276 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '464e5f25-1623-4796-ade1-b5af4241b61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f5781d2d80>]}
[0m14:40:27.642175 [info ] [Thread-3 (]: 77 of 91 OK created sql table model main.mart_daily_revenue .................... [[32mOK[0m in 0.29s]
[0m14:40:27.643816 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m14:40:27.644889 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m14:40:27.645455 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m14:40:27.645834 [info ] [Thread-2 (]: 79 of 91 START test not_null_mart_daily_revenue_date_key ....................... [RUN]
[0m14:40:27.646781 [info ] [Thread-3 (]: 80 of 91 START test not_null_mart_daily_revenue_total_revenue .................. [RUN]
[0m14:40:27.647909 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf, now test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a)
[0m14:40:27.648536 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.mart_daily_revenue, now test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9)
[0m14:40:27.649082 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m14:40:27.649630 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m14:40:27.656015 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m14:40:27.660256 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m14:40:27.668493 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m14:40:27.671541 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m14:40:27.671865 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m14:40:27.673771 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m14:40:27.678697 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m14:40:27.679384 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: BEGIN
[0m14:40:27.679765 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m14:40:27.680080 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:27.680682 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: BEGIN
[0m14:40:27.681610 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:40:27.681870 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:40:27.682339 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m14:40:27.683013 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:40:27.683303 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "dev"."main"."mart_daily_revenue"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m14:40:27.683833 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m14:40:27.684798 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "dev"."main"."mart_daily_revenue"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m14:40:27.685237 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:27.686871 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: ROLLBACK
[0m14:40:27.687309 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:40:27.688166 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9'
[0m14:40:27.689565 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: ROLLBACK
[0m14:40:27.689872 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: Close
[0m14:40:27.690648 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a'
[0m14:40:27.691223 [info ] [Thread-3 (]: 80 of 91 PASS not_null_mart_daily_revenue_total_revenue ........................ [[32mPASS[0m in 0.04s]
[0m14:40:27.691500 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: Close
[0m14:40:27.692121 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m14:40:27.692885 [info ] [Thread-2 (]: 79 of 91 PASS not_null_mart_daily_revenue_date_key ............................. [[32mPASS[0m in 0.05s]
[0m14:40:27.693685 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m14:40:27.694410 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m14:40:27.694906 [info ] [Thread-3 (]: 81 of 91 START test unique_mart_daily_revenue_date_key ......................... [RUN]
[0m14:40:27.695771 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9, now test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7)
[0m14:40:27.696145 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m14:40:27.699370 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m14:40:27.703245 [debug] [Thread-1 (]: SQL status: OK in 0.193 seconds
[0m14:40:27.705474 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m14:40:27.705960 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
alter table "dev"."main"."mart_hourly_demand" rename to "mart_hourly_demand__dbt_backup"
[0m14:40:27.706665 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:40:27.708526 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m14:40:27.708847 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m14:40:27.709139 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
alter table "dev"."main"."mart_hourly_demand__dbt_tmp" rename to "mart_hourly_demand"
[0m14:40:27.710599 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m14:40:27.711445 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:40:27.712624 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: COMMIT
[0m14:40:27.713049 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m14:40:27.713448 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: COMMIT
[0m14:40:27.717918 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:40:27.718251 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m14:40:27.719668 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m14:40:27.720107 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: BEGIN
[0m14:40:27.720587 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
drop table if exists "dev"."main"."mart_hourly_demand__dbt_backup" cascade
[0m14:40:27.721012 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:27.721863 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:27.722181 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m14:40:27.722458 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "dev"."main"."mart_daily_revenue"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:40:27.723804 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:40:27.724952 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: Close
[0m14:40:27.725222 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:40:27.725846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '464e5f25-1623-4796-ade1-b5af4241b61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f57a23ad80>]}
[0m14:40:27.726933 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: ROLLBACK
[0m14:40:27.727539 [info ] [Thread-1 (]: 78 of 91 OK created sql table model main.mart_hourly_demand .................... [[32mOK[0m in 0.25s]
[0m14:40:27.728544 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7'
[0m14:40:27.728883 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m14:40:27.729255 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: Close
[0m14:40:27.729836 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m14:40:27.730033 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m14:40:27.730401 [info ] [Thread-3 (]: 81 of 91 PASS unique_mart_daily_revenue_date_key ............................... [[32mPASS[0m in 0.03s]
[0m14:40:27.730648 [info ] [Thread-2 (]: 82 of 91 START test not_null_mart_hourly_demand_is_weekend ..................... [RUN]
[0m14:40:27.731022 [info ] [Thread-1 (]: 83 of 91 START test not_null_mart_hourly_demand_pickup_hour .................... [RUN]
[0m14:40:27.731447 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m14:40:27.731850 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a, now test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8)
[0m14:40:27.732220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.mart_hourly_demand, now test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418)
[0m14:40:27.732749 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m14:40:27.733067 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m14:40:27.735867 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m14:40:27.739114 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m14:40:27.745159 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m14:40:27.746935 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m14:40:27.747273 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m14:40:27.748988 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m14:40:27.752307 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m14:40:27.752656 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: BEGIN
[0m14:40:27.752982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:27.753666 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:27.754075 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m14:40:27.754364 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m14:40:27.754599 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."mart_hourly_demand"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m14:40:27.754975 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: BEGIN
[0m14:40:27.756016 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:40:27.756300 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:27.756836 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:40:27.758119 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: ROLLBACK
[0m14:40:27.758442 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m14:40:27.759231 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418'
[0m14:40:27.759799 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."mart_hourly_demand"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m14:40:27.760237 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: Close
[0m14:40:27.761109 [info ] [Thread-1 (]: 83 of 91 PASS not_null_mart_hourly_demand_pickup_hour .......................... [[32mPASS[0m in 0.03s]
[0m14:40:27.761430 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:40:27.761796 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m14:40:27.762953 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: ROLLBACK
[0m14:40:27.763837 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8'
[0m14:40:27.764202 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: Close
[0m14:40:27.764757 [info ] [Thread-2 (]: 82 of 91 PASS not_null_mart_hourly_demand_is_weekend ........................... [[32mPASS[0m in 0.03s]
[0m14:40:27.765217 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m14:40:31.190768 [debug] [Thread-4 (]: SQL status: OK in 4.477 seconds
[0m14:40:31.193915 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m14:40:31.194369 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
alter table "dev"."main"."fct_trips" rename to "fct_trips__dbt_backup"
[0m14:40:31.195306 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:31.196982 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m14:40:31.197409 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
alter table "dev"."main"."fct_trips__dbt_tmp" rename to "fct_trips"
[0m14:40:31.197980 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:40:31.199030 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.fct_trips: COMMIT
[0m14:40:31.199419 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m14:40:31.199639 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.fct_trips: COMMIT
[0m14:40:31.533948 [debug] [Thread-4 (]: SQL status: OK in 0.334 seconds
[0m14:40:31.535848 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m14:40:31.536346 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
drop table if exists "dev"."main"."fct_trips__dbt_backup" cascade
[0m14:40:31.843377 [debug] [Thread-4 (]: SQL status: OK in 0.306 seconds
[0m14:40:31.844776 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.fct_trips: Close
[0m14:40:31.896598 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '464e5f25-1623-4796-ade1-b5af4241b61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f57816f9e0>]}
[0m14:40:31.897330 [info ] [Thread-4 (]: 67 of 91 OK created sql incremental model main.fct_trips ....................... [[32mOK[0m in 5.26s]
[0m14:40:31.897754 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.fct_trips
[0m14:40:31.898601 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m14:40:31.898838 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m14:40:31.899059 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m14:40:31.899284 [info ] [Thread-3 (]: 84 of 91 START test not_null_fct_trips_pickup_datetime ......................... [RUN]
[0m14:40:31.899676 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m14:40:31.899890 [info ] [Thread-1 (]: 85 of 91 START test not_null_fct_trips_total_amount ............................ [RUN]
[0m14:40:31.900239 [info ] [Thread-2 (]: 86 of 91 START test not_null_fct_trips_trip_id ................................. [RUN]
[0m14:40:31.900621 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7, now test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83)
[0m14:40:31.900912 [info ] [Thread-4 (]: 87 of 91 START test unique_fct_trips_trip_id ................................... [RUN]
[0m14:40:31.901259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418, now test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d)
[0m14:40:31.901594 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8, now test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d)
[0m14:40:31.901875 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m14:40:31.902162 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.fct_trips, now test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab)
[0m14:40:31.905951 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m14:40:31.902703 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m14:40:31.905424 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m14:40:31.902436 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m14:40:31.907922 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m14:40:31.910000 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m14:40:31.913165 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m14:40:31.917198 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m14:40:31.918567 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m14:40:31.918808 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m14:40:31.919047 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m14:40:31.920646 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m14:40:31.921077 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m14:40:31.922156 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m14:40:31.923819 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m14:40:31.927459 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m14:40:31.927893 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: BEGIN
[0m14:40:31.928159 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m14:40:31.928449 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:31.928841 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: BEGIN
[0m14:40:31.929069 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m14:40:31.929508 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:40:31.929794 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: BEGIN
[0m14:40:31.930043 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m14:40:31.930332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:31.930614 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: BEGIN
[0m14:40:31.931092 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:31.944648 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m14:40:31.945047 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m14:40:31.945284 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m14:40:31.945518 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m14:40:31.945712 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m14:40:31.946017 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m14:40:31.946293 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m14:40:31.946580 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "dev"."main"."fct_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m14:40:31.946837 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m14:40:31.947113 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."main"."fct_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:40:31.947433 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."fct_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m14:40:31.947893 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."fct_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m14:40:31.948395 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:31.948889 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:40:31.949383 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:40:31.952746 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: ROLLBACK
[0m14:40:31.954479 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: ROLLBACK
[0m14:40:31.956539 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: ROLLBACK
[0m14:40:31.957946 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83'
[0m14:40:31.959730 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d'
[0m14:40:31.960480 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d'
[0m14:40:31.963252 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: Close
[0m14:40:31.965282 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: Close
[0m14:40:31.967528 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: Close
[0m14:40:31.969087 [info ] [Thread-3 (]: 84 of 91 PASS not_null_fct_trips_pickup_datetime ............................... [[32mPASS[0m in 0.07s]
[0m14:40:31.970154 [info ] [Thread-2 (]: 86 of 91 PASS not_null_fct_trips_trip_id ....................................... [[32mPASS[0m in 0.07s]
[0m14:40:31.971533 [info ] [Thread-1 (]: 85 of 91 PASS not_null_fct_trips_total_amount .................................. [[32mPASS[0m in 0.07s]
[0m14:40:31.974405 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m14:40:31.976591 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m14:40:31.978578 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m14:40:32.061505 [debug] [Thread-4 (]: SQL status: OK in 0.113 seconds
[0m14:40:32.062989 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: ROLLBACK
[0m14:40:32.063774 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab'
[0m14:40:32.064088 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: Close
[0m14:40:32.085192 [info ] [Thread-4 (]: 87 of 91 PASS unique_fct_trips_trip_id ......................................... [[32mPASS[0m in 0.18s]
[0m14:40:32.095946 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m14:40:32.096872 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.mart_location_performance
[0m14:40:32.097508 [info ] [Thread-3 (]: 88 of 91 START sql table model main.mart_location_performance .................. [RUN]
[0m14:40:32.097911 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83, now model.nyc_taxi_pipeline_00.mart_location_performance)
[0m14:40:32.098390 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_location_performance
[0m14:40:32.101213 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m14:40:32.107183 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.mart_location_performance
[0m14:40:32.109475 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m14:40:32.109886 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Location-level performance summary.
    Uses adapter-dispatched mode_compat() for cross-dialect support.
*/

with trips as (
    select * from "dev"."main"."fct_trips"
),

final as (
    select
        pickup_location_id,
        pickup_borough,
        pickup_zone,

        count(*) as total_pickups,
        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue_per_trip,
        round(avg(tip_percentage), 2) as avg_tip_pct,
        round(avg(passenger_count), 2) as avg_passengers,

        -- most common dropoff destination
        
    mode(dropoff_zone)
 as most_common_dropoff_zone,

        -- busiest hour
        
    mode(pickup_hour)
 as peak_pickup_hour

    from trips
    where pickup_zone is not null
    group by pickup_location_id, pickup_borough, pickup_zone
)

select * from final
order by total_pickups desc
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:40:32.110290 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:32.127085 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m14:40:32.128843 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m14:40:32.129247 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as varchar)
 as pickup_borough, 
      
    cast(null as varchar)
 as pickup_zone, 
      
    cast(null as bigint)
 as total_pickups, 
      
    cast(null as double)
 as avg_trip_distance, 
      
    cast(null as double)
 as avg_trip_duration_min, 
      
    cast(null as decimal(38,2))
 as total_revenue, 
      
    cast(null as double)
 as avg_revenue_per_trip, 
      
    cast(null as double)
 as avg_tip_pct, 
      
    cast(null as double)
 as avg_passengers, 
      
    cast(null as varchar)
 as most_common_dropoff_zone, 
      
    cast(null as bigint)
 as peak_pickup_hour
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:40:32.129835 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:40:32.131184 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m14:40:32.137625 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m14:40:32.137912 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: BEGIN
[0m14:40:32.138322 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:40:32.138584 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m14:40:32.138839 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_location_performance__dbt_tmp"
  
  (
    pickup_location_id integer,
    pickup_borough varchar,
    pickup_zone varchar,
    total_pickups bigint,
    avg_trip_distance double,
    avg_trip_duration_min double,
    total_revenue decimal(38,2),
    avg_revenue_per_trip double,
    avg_tip_pct double,
    avg_passengers double,
    most_common_dropoff_zone varchar,
    peak_pickup_hour bigint
    
    )
 ;
    insert into "dev"."main"."mart_location_performance__dbt_tmp" 
  (
    
      
      pickup_location_id ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      total_pickups ,
    
      
      avg_trip_distance ,
    
      
      avg_trip_duration_min ,
    
      
      total_revenue ,
    
      
      avg_revenue_per_trip ,
    
      
      avg_tip_pct ,
    
      
      avg_passengers ,
    
      
      most_common_dropoff_zone ,
    
      
      peak_pickup_hour 
    
  )
 (
      
    select pickup_location_id, pickup_borough, pickup_zone, total_pickups, avg_trip_distance, avg_trip_duration_min, total_revenue, avg_revenue_per_trip, avg_tip_pct, avg_passengers, most_common_dropoff_zone, peak_pickup_hour
    from (
        /*
    Analytics mart: Location-level performance summary.
    Uses adapter-dispatched mode_compat() for cross-dialect support.
*/

with trips as (
    select * from "dev"."main"."fct_trips"
),

final as (
    select
        pickup_location_id,
        pickup_borough,
        pickup_zone,

        count(*) as total_pickups,
        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue_per_trip,
        round(avg(tip_percentage), 2) as avg_tip_pct,
        round(avg(passenger_count), 2) as avg_passengers,

        -- most common dropoff destination
        
    mode(dropoff_zone)
 as most_common_dropoff_zone,

        -- busiest hour
        
    mode(pickup_hour)
 as peak_pickup_hour

    from trips
    where pickup_zone is not null
    group by pickup_location_id, pickup_borough, pickup_zone
)

select * from final
order by total_pickups desc
    ) as model_subq
    );
  
  
[0m14:40:32.245241 [debug] [Thread-3 (]: SQL status: OK in 0.106 seconds
[0m14:40:32.247355 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m14:40:32.247903 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
alter table "dev"."main"."mart_location_performance" rename to "mart_location_performance__dbt_backup"
[0m14:40:32.248693 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:40:32.250511 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m14:40:32.250809 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
alter table "dev"."main"."mart_location_performance__dbt_tmp" rename to "mart_location_performance"
[0m14:40:32.251311 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:40:32.252097 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: COMMIT
[0m14:40:32.252402 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m14:40:32.252705 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: COMMIT
[0m14:40:32.258648 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m14:40:32.261153 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m14:40:32.261643 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
drop table if exists "dev"."main"."mart_location_performance__dbt_backup" cascade
[0m14:40:32.264382 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:40:32.265254 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: Close
[0m14:40:32.309531 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '464e5f25-1623-4796-ade1-b5af4241b61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f55ff1f470>]}
[0m14:40:32.310380 [info ] [Thread-3 (]: 88 of 91 OK created sql table model main.mart_location_performance ............. [[32mOK[0m in 0.21s]
[0m14:40:32.310921 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.mart_location_performance
[0m14:40:32.311852 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m14:40:32.312088 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m14:40:32.312311 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m14:40:32.312516 [info ] [Thread-1 (]: 89 of 91 START test not_null_mart_location_performance_pickup_location_id ...... [RUN]
[0m14:40:32.312966 [info ] [Thread-4 (]: 90 of 91 START test not_null_mart_location_performance_total_pickups ........... [RUN]
[0m14:40:32.313350 [info ] [Thread-2 (]: 91 of 91 START test unique_mart_location_performance_pickup_location_id ........ [RUN]
[0m14:40:32.313823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d, now test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c)
[0m14:40:32.314202 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab, now test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259)
[0m14:40:32.314558 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d, now test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62)
[0m14:40:32.314904 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m14:40:32.315243 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m14:40:32.315725 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m14:40:32.318131 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m14:40:32.320323 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m14:40:32.322885 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m14:40:32.327143 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m14:40:32.328528 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m14:40:32.328751 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m14:40:32.330160 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m14:40:32.330361 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m14:40:32.331809 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m14:40:32.335629 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m14:40:32.335932 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: BEGIN
[0m14:40:32.336300 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:40:32.336530 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m14:40:32.337111 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: BEGIN
[0m14:40:32.337865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:32.338541 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m14:40:32.338809 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: BEGIN
[0m14:40:32.339085 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:32.354362 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m14:40:32.354684 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m14:40:32.354988 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m14:40:32.355244 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m14:40:32.355446 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m14:40:32.355749 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_location_id
from "dev"."main"."mart_location_performance"
where pickup_location_id is null



  
  
      
    ) dbt_internal_test
[0m14:40:32.356069 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m14:40:32.356415 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pickup_location_id as unique_field,
    count(*) as n_records

from "dev"."main"."mart_location_performance"
where pickup_location_id is not null
group by pickup_location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:40:32.356926 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_pickups
from "dev"."main"."mart_location_performance"
where total_pickups is null



  
  
      
    ) dbt_internal_test
[0m14:40:32.357221 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:32.358516 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: ROLLBACK
[0m14:40:32.358767 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:32.359306 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c'
[0m14:40:32.359551 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:40:32.360309 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: ROLLBACK
[0m14:40:32.360485 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: Close
[0m14:40:32.361332 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: ROLLBACK
[0m14:40:32.361763 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259'
[0m14:40:32.362334 [info ] [Thread-1 (]: 89 of 91 PASS not_null_mart_location_performance_pickup_location_id ............ [[32mPASS[0m in 0.05s]
[0m14:40:32.362868 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62'
[0m14:40:32.363209 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: Close
[0m14:40:32.363582 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m14:40:32.363886 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: Close
[0m14:40:32.364265 [info ] [Thread-4 (]: 90 of 91 PASS not_null_mart_location_performance_total_pickups ................. [[32mPASS[0m in 0.05s]
[0m14:40:32.364893 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m14:40:32.367022 [info ] [Thread-2 (]: 91 of 91 PASS unique_mart_location_performance_pickup_location_id .............. [[32mPASS[0m in 0.05s]
[0m14:40:32.367608 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m14:40:32.369287 [debug] [MainThread]: Using duckdb connection "master"
[0m14:40:32.369635 [debug] [MainThread]: On master: BEGIN
[0m14:40:32.369895 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:40:32.384740 [debug] [MainThread]: SQL status: OK in 0.015 seconds
[0m14:40:32.385234 [debug] [MainThread]: On master: COMMIT
[0m14:40:32.385532 [debug] [MainThread]: Using duckdb connection "master"
[0m14:40:32.385773 [debug] [MainThread]: On master: COMMIT
[0m14:40:32.386107 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:40:32.386528 [debug] [MainThread]: On master: Close
[0m14:40:32.388899 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:32.389420 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m14:40:32.389692 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c' was properly closed.
[0m14:40:32.389911 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62' was properly closed.
[0m14:40:32.390089 [debug] [MainThread]: Connection 'model.nyc_taxi_pipeline_00.mart_location_performance' was properly closed.
[0m14:40:32.390283 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259' was properly closed.
[0m14:40:32.390683 [info ] [MainThread]: 
[0m14:40:32.390961 [info ] [MainThread]: Finished running 1 incremental model, 3 seeds, 7 table models, 74 data tests, 6 view models in 0 hours 0 minutes and 10.13 seconds (10.13s).
[0m14:40:32.395509 [debug] [MainThread]: Command end result
[0m14:40:32.427783 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:40:32.431607 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:40:32.439541 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m14:40:32.439899 [info ] [MainThread]: 
[0m14:40:32.440269 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:40:32.440554 [info ] [MainThread]: 
[0m14:40:32.440978 [info ] [MainThread]: Done. PASS=91 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=91
[0m14:40:32.441984 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 10.092525, "process_in_blocks": "86840", "process_kernel_time": 4.57946, "process_mem_max_rss": "1778984", "process_out_blocks": "136", "process_user_time": 20.968885}
[0m14:40:32.442427 [debug] [MainThread]: Command `dbt build` succeeded at 14:40:32.442345 after 10.09 seconds
[0m14:40:32.442831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f5c8c06660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f5c6ddb8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f578139880>]}
[0m14:40:32.443119 [debug] [MainThread]: Flushing usage events
[0m14:40:32.693692 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:40:44.215607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8bce59a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8bd0aaaab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8bce599550>]}


============================== 14:40:44.217956 | 6b9c7da3-95cf-4feb-a64f-02350b68bc7d ==============================
[0m14:40:44.217956 [info ] [MainThread]: Running with dbt=1.11.4
[0m14:40:44.218385 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'log_path': '/dbt/logs', 'invocation_command': 'dbt deps --profiles-dir .', 'indirect_selection': 'eager', 'introspect': 'True', 'target_path': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'log_format': 'default', 'log_cache_events': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'debug': 'False', 'no_print': 'None', 'printer_width': '80'}
[0m14:40:44.285251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b9c7da3-95cf-4feb-a64f-02350b68bc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8bcddf3860>]}
[0m14:40:44.493885 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-26zwbpjk'
[0m14:40:44.494296 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:40:44.643143 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:40:44.644356 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:40:44.714418 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:40:44.717537 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:40:47.354612 [info ] [MainThread]: Installed from version 1.3.3
[0m14:40:47.355229 [info ] [MainThread]: Up to date!
[0m14:40:47.355669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6b9c7da3-95cf-4feb-a64f-02350b68bc7d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8bce433f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8bcdc16b70>]}
[0m14:40:47.356757 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 3.1832297, "process_in_blocks": "0", "process_kernel_time": 0.208894, "process_mem_max_rss": "105484", "process_out_blocks": "176", "process_user_time": 0.865421}
[0m14:40:47.357242 [debug] [MainThread]: Command `dbt deps` succeeded at 14:40:47.357163 after 3.18 seconds
[0m14:40:47.357650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8bcde808f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8bcddf3860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8bcdeb3aa0>]}
[0m14:40:47.358094 [debug] [MainThread]: Flushing usage events
[0m14:40:47.589059 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:40:48.452670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a970e4f4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a970d80350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a970d807a0>]}


============================== 14:40:48.454962 | 066604cd-9ab8-44a2-8a50-44ba9a9f563e ==============================
[0m14:40:48.454962 [info ] [MainThread]: Running with dbt=1.11.4
[0m14:40:48.455384 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'quiet': 'False', 'empty': 'False', 'debug': 'False', 'no_print': 'None', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --full-refresh --profiles-dir .', 'cache_selected_only': 'False', 'log_path': '/dbt/logs', 'introspect': 'True', 'partial_parse': 'True', 'profiles_dir': '.', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'version_check': 'True'}
[0m14:40:48.578122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '066604cd-9ab8-44a2-8a50-44ba9a9f563e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a972a5b6b0>]}
[0m14:40:48.612570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '066604cd-9ab8-44a2-8a50-44ba9a9f563e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a97239fbf0>]}
[0m14:40:48.613956 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:40:48.657621 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m14:40:49.157296 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:40:49.157808 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m14:40:49.158248 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:40:49.189779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '066604cd-9ab8-44a2-8a50-44ba9a9f563e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a9603cf080>]}
[0m14:40:49.261790 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:40:49.266521 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:40:49.296012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '066604cd-9ab8-44a2-8a50-44ba9a9f563e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a96015dd00>]}
[0m14:40:49.296586 [info ] [MainThread]: Found 14 models, 74 data tests, 3 seeds, 1 source, 578 macros
[0m14:40:49.300243 [info ] [MainThread]: 
[0m14:40:49.300747 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:40:49.301134 [info ] [MainThread]: 
[0m14:40:49.301652 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:40:49.305791 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m14:40:49.363800 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m14:40:49.364431 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m14:40:49.364710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:49.379249 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m14:40:49.380252 [debug] [ThreadPool]: On list_dev: Close
[0m14:40:49.383560 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m14:40:49.384087 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m14:40:49.387566 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:40:49.387911 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m14:40:49.388221 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:49.405563 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m14:40:49.406920 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:40:49.407497 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m14:40:49.408053 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:40:49.408387 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:40:49.408602 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m14:40:49.409249 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:40:49.409906 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:40:49.410206 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:40:49.410447 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:40:49.410821 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:40:49.411071 [debug] [ThreadPool]: On create_dev_main: Close
[0m14:40:49.414235 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m14:40:49.417301 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:40:49.417751 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:40:49.418037 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:49.437114 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m14:40:49.437582 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:40:49.437885 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:40:49.443408 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m14:40:49.444523 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:40:49.445299 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:40:49.445548 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:40:49.448913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '066604cd-9ab8-44a2-8a50-44ba9a9f563e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a96ff4d790>]}
[0m14:40:49.449640 [debug] [MainThread]: Using duckdb connection "master"
[0m14:40:49.449911 [debug] [MainThread]: On master: BEGIN
[0m14:40:49.450170 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:40:49.468012 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m14:40:49.468558 [debug] [MainThread]: On master: COMMIT
[0m14:40:49.468861 [debug] [MainThread]: Using duckdb connection "master"
[0m14:40:49.469166 [debug] [MainThread]: On master: COMMIT
[0m14:40:49.469583 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:40:49.469851 [debug] [MainThread]: On master: Close
[0m14:40:49.475590 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.dim_dates
[0m14:40:49.475833 [debug] [Thread-2 (]: Began running node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m14:40:49.476061 [debug] [Thread-3 (]: Began running node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m14:40:49.476334 [info ] [Thread-1 (]: 1 of 91 START sql table model main.dim_dates ................................... [RUN]
[0m14:40:49.476614 [debug] [Thread-4 (]: Began running node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m14:40:49.476853 [info ] [Thread-2 (]: 2 of 91 START sql table model main.stg_yellow_trips ............................ [RUN]
[0m14:40:49.477257 [info ] [Thread-3 (]: 3 of 91 START seed file main.payment_type_lookup ............................... [RUN]
[0m14:40:49.477656 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nyc_taxi_pipeline_00.dim_dates'
[0m14:40:49.478041 [info ] [Thread-4 (]: 4 of 91 START seed file main.rate_code_lookup .................................. [RUN]
[0m14:40:49.478395 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.nyc_taxi_pipeline_00.stg_yellow_trips'
[0m14:40:49.478755 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.nyc_taxi_pipeline_00.payment_type_lookup'
[0m14:40:49.479648 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_dates
[0m14:40:49.480198 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.nyc_taxi_pipeline_00.rate_code_lookup'
[0m14:40:49.480449 [debug] [Thread-2 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m14:40:49.480683 [debug] [Thread-3 (]: Began compiling node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m14:40:49.491015 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:40:49.491242 [debug] [Thread-4 (]: Began compiling node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m14:40:49.499573 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m14:40:49.499830 [debug] [Thread-3 (]: Began executing node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m14:40:49.500193 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: BEGIN
[0m14:40:49.500474 [debug] [Thread-4 (]: Began executing node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m14:40:49.507988 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:40:49.511104 [debug] [Thread-2 (]: Began executing node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m14:40:49.528548 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m14:40:49.533569 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m14:40:49.533802 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m14:40:49.534337 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.payment_type_lookup"} */
drop table if exists "dev"."main"."payment_type_lookup" cascade
[0m14:40:49.535752 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m14:40:49.535951 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:40:49.536363 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:40:49.536673 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.rate_code_lookup"} */
drop table if exists "dev"."main"."rate_code_lookup" cascade
[0m14:40:49.536994 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */


        select 
        (date_diff('day', cast('2024-01-01' as date)::timestamp, cast('2024-02-01' as date)::timestamp ))
    
[0m14:40:49.537575 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:40:49.538322 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:40:49.544042 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m14:40:49.546199 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:40:49.550064 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m14:40:49.550363 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m14:40:49.550601 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m14:40:49.551248 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: BEGIN
[0m14:40:49.552189 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m14:40:49.553175 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: BEGIN
[0m14:40:49.553414 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:40:49.552635 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: BEGIN
[0m14:40:49.554073 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:40:49.554303 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m14:40:49.554761 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:40:49.555053 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m14:40:49.555562 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.payment_type_lookup"} */

    create table "dev"."main"."payment_type_lookup" ("payment_type_id" integer,"payment_type_name" varchar)
  
[0m14:40:49.556204 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.556395 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.rate_code_lookup"} */

    create table "dev"."main"."rate_code_lookup" ("rate_code_id" integer,"rate_code_name" varchar)
  
[0m14:40:49.557267 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:40:49.557479 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m14:40:49.558084 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:40:49.563772 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.dim_dates
[0m14:40:49.564124 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m14:40:49.564346 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */

  
    
    

    create  table
      "dev"."main"."stg_yellow_trips__dbt_tmp"
  
    as (
      

with source as (
    select * from read_parquet('/data/yellow_tripdata_2024-01.parquet')
),

renamed as (
    select
        -- surrogate key (MD5 hash of composite key)
        md5(cast(coalesce(cast(VendorID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(PULocationID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DOLocationID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(fare_amount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(total_amount as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- identifiers
        cast("VendorID" as integer) as vendor_id,
        cast("RatecodeID" as integer) as rate_code_id,
        cast("PULocationID" as integer) as pickup_location_id,
        cast("DOLocationID" as integer) as dropoff_location_id,
        cast(payment_type as integer) as payment_type_id,

        -- timestamps
        cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
        cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as double) as trip_distance_miles,
        store_and_fwd_flag,

        -- financials
        round(cast(fare_amount as decimal(10, 2)), 2) as fare_amount,
        round(cast(extra as decimal(10, 2)), 2) as extra_amount,
        round(cast(mta_tax as decimal(10, 2)), 2) as mta_tax,
        round(cast(tip_amount as decimal(10, 2)), 2) as tip_amount,
        round(cast(tolls_amount as decimal(10, 2)), 2) as tolls_amount,
        round(cast(improvement_surcharge as decimal(10, 2)), 2) as improvement_surcharge,
        round(cast(total_amount as decimal(10, 2)), 2) as total_amount,
        round(cast(congestion_surcharge as decimal(10, 2)), 2) as congestion_surcharge,
        round(cast(Airport_fee as decimal(10, 2)), 2) as airport_fee

    from source
    where tpep_pickup_datetime is not null
      and tpep_dropoff_datetime is not null
      and trip_distance >= 0
      and fare_amount >= 0
      -- filter out-of-range dates (data quality: ~18 trips outside Jan 2024)
      and cast(tpep_pickup_datetime as date) >= date '2024-01-01'
      and cast(tpep_pickup_datetime as date) < date '2024-02-01'
)

select * from renamed
    );
  
  
[0m14:40:49.565168 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m14:40:49.575936 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: 
          COPY "dev"."main"."payment_type_lookup" FROM '/dbt/seeds/payment_type_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m14:40:49.576970 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:40:49.577788 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: 
          COPY "dev"."main"."rate_code_lookup" FROM '/dbt/seeds/rate_code_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m14:40:49.578445 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
DESCRIBE (select * from (
        /*
    Dimension table: Calendar dates for January 2024.
    Uses adapter-dispatched macros for dayname/monthname.
*/

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 31
    order by generated_number



),

all_periods as (

    select (
        

    date_add(cast('2024-01-01' as date), interval (row_number() over (order by generated_number) - 1) day)


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-02-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week_num,
        
    dayname(date_day)
 as day_of_week_name,
        
    monthname(date_day)
 as month_name,
        extract(week from date_day) as week_of_year,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when cast(date_day as date) in (
                cast('2024-01-01' as date),
                cast('2024-01-15' as date)
            ) then true
            else false
        end as is_holiday

    from date_spine
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:40:49.581917 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:40:49.589840 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:40:49.590147 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m14:40:49.590374 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m14:40:49.590605 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as date_key, 
      
    cast(null as bigint)
 as year, 
      
    cast(null as bigint)
 as month, 
      
    cast(null as bigint)
 as day_of_month, 
      
    cast(null as bigint)
 as day_of_week_num, 
      
    cast(null as varchar)
 as day_of_week_name, 
      
    cast(null as varchar)
 as month_name, 
      
    cast(null as bigint)
 as week_of_year, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as boolean)
 as is_holiday
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:40:49.593706 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m14:40:49.594173 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m14:40:49.595097 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:40:49.606984 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:40:49.618497 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: COMMIT
[0m14:40:49.619721 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: COMMIT
[0m14:40:49.620013 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.rate_code_lookup"
[0m14:40:49.620601 [debug] [Thread-3 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.payment_type_lookup"
[0m14:40:49.621045 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: COMMIT
[0m14:40:49.621750 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: COMMIT
[0m14:40:49.622124 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:40:49.622897 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_dates__dbt_tmp"
  
  (
    date_key date,
    year bigint,
    month bigint,
    day_of_month bigint,
    day_of_week_num bigint,
    day_of_week_name varchar,
    month_name varchar,
    week_of_year bigint,
    is_weekend boolean,
    is_holiday boolean
    
    )
 ;
    insert into "dev"."main"."dim_dates__dbt_tmp" 
  (
    
      
      date_key ,
    
      
      year ,
    
      
      month ,
    
      
      day_of_month ,
    
      
      day_of_week_num ,
    
      
      day_of_week_name ,
    
      
      month_name ,
    
      
      week_of_year ,
    
      
      is_weekend ,
    
      
      is_holiday 
    
  )
 (
      
    select date_key, year, month, day_of_month, day_of_week_num, day_of_week_name, month_name, week_of_year, is_weekend, is_holiday
    from (
        /*
    Dimension table: Calendar dates for January 2024.
    Uses adapter-dispatched macros for dayname/monthname.
*/

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 31
    order by generated_number



),

all_periods as (

    select (
        

    date_add(cast('2024-01-01' as date), interval (row_number() over (order by generated_number) - 1) day)


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-02-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week_num,
        
    dayname(date_day)
 as day_of_week_name,
        
    monthname(date_day)
 as month_name,
        extract(week from date_day) as week_of_year,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when cast(date_day as date) in (
                cast('2024-01-01' as date),
                cast('2024-01-15' as date)
            ) then true
            else false
        end as is_holiday

    from date_spine
)

select * from final
    ) as model_subq
    );
  
  
[0m14:40:49.625350 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:40:49.626666 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.rate_code_lookup: Close
[0m14:40:49.628088 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '066604cd-9ab8-44a2-8a50-44ba9a9f563e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a970ec9520>]}
[0m14:40:49.628401 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m14:40:49.628808 [info ] [Thread-4 (]: 4 of 91 OK loaded seed file main.rate_code_lookup .............................. [[32mCREATE 7[0m in 0.15s]
[0m14:40:49.629578 [debug] [Thread-3 (]: On seed.nyc_taxi_pipeline_00.payment_type_lookup: Close
[0m14:40:49.630065 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:40:49.630396 [debug] [Thread-4 (]: Finished running node seed.nyc_taxi_pipeline_00.rate_code_lookup
[0m14:40:49.631044 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '066604cd-9ab8-44a2-8a50-44ba9a9f563e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a970022660>]}
[0m14:40:49.634823 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:40:49.635283 [debug] [Thread-4 (]: Began running node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m14:40:49.635782 [info ] [Thread-3 (]: 3 of 91 OK loaded seed file main.payment_type_lookup ........................... [[32mCREATE 6[0m in 0.15s]
[0m14:40:49.636185 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
alter table "dev"."main"."dim_dates" rename to "dim_dates__dbt_backup"
[0m14:40:49.636718 [info ] [Thread-4 (]: 5 of 91 START seed file main.taxi_zone_lookup .................................. [RUN]
[0m14:40:49.637251 [debug] [Thread-3 (]: Finished running node seed.nyc_taxi_pipeline_00.payment_type_lookup
[0m14:40:49.638156 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.rate_code_lookup, now seed.nyc_taxi_pipeline_00.taxi_zone_lookup)
[0m14:40:49.638523 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.638772 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m14:40:49.639161 [debug] [Thread-4 (]: Began compiling node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m14:40:49.641005 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:40:49.641553 [info ] [Thread-3 (]: 6 of 91 START test not_null_rate_code_lookup_rate_code_id ...................... [RUN]
[0m14:40:49.642188 [debug] [Thread-4 (]: Began executing node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m14:40:49.642708 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
alter table "dev"."main"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m14:40:49.643165 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.payment_type_lookup, now test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec)
[0m14:40:49.645114 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m14:40:49.645386 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:40:49.652047 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m14:40:49.653407 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: COMMIT
[0m14:40:49.654047 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:40:49.654510 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: COMMIT
[0m14:40:49.656901 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m14:40:49.657385 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"} */
drop table if exists "dev"."main"."taxi_zone_lookup" cascade
[0m14:40:49.657878 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:49.658173 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:40:49.661679 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_dates"
[0m14:40:49.662001 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:40:49.662522 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_dates"} */
drop table if exists "dev"."main"."dim_dates__dbt_backup" cascade
[0m14:40:49.663764 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m14:40:49.664125 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m14:40:49.665283 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: BEGIN
[0m14:40:49.671116 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:40:49.674321 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m14:40:49.675007 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:40:49.676267 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.dim_dates: Close
[0m14:40:49.677557 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m14:40:49.678274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '066604cd-9ab8-44a2-8a50-44ba9a9f563e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a95c385d00>]}
[0m14:40:49.678799 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"} */

    create table "dev"."main"."taxi_zone_lookup" ("LocationID" integer,"Borough" varchar,"Zone" varchar,"service_zone" varchar)
  
[0m14:40:49.679543 [info ] [Thread-1 (]: 1 of 91 OK created sql table model main.dim_dates .............................. [[32mOK[0m in 0.20s]
[0m14:40:49.680793 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.dim_dates
[0m14:40:49.681194 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.681591 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m14:40:49.682822 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m14:40:49.683250 [info ] [Thread-1 (]: 7 of 91 START test unique_rate_code_lookup_rate_code_id ........................ [RUN]
[0m14:40:49.683712 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: 
          COPY "dev"."main"."taxi_zone_lookup" FROM '/dbt/seeds/taxi_zone_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m14:40:49.684268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_dates, now test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d)
[0m14:40:49.685011 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m14:40:49.689679 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m14:40:49.690040 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m14:40:49.690578 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: BEGIN
[0m14:40:49.690949 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m14:40:49.691235 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:49.691980 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m14:40:49.692527 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.692959 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"
[0m14:40:49.693230 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_id
from "dev"."main"."rate_code_lookup"
where rate_code_id is null



  
  
      
    ) dbt_internal_test
[0m14:40:49.694961 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.697190 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: ROLLBACK
[0m14:40:49.697961 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec'
[0m14:40:49.698343 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m14:40:49.698628 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec: Close
[0m14:40:49.700724 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m14:40:49.701645 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: COMMIT
[0m14:40:49.702262 [info ] [Thread-3 (]: 6 of 91 PASS not_null_rate_code_lookup_rate_code_id ............................ [[32mPASS[0m in 0.06s]
[0m14:40:49.702844 [debug] [Thread-4 (]: Using duckdb connection "seed.nyc_taxi_pipeline_00.taxi_zone_lookup"
[0m14:40:49.703480 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec
[0m14:40:49.703859 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: COMMIT
[0m14:40:49.704294 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m14:40:49.705113 [info ] [Thread-3 (]: 8 of 91 START test not_null_payment_type_lookup_payment_type_id ................ [RUN]
[0m14:40:49.705709 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec, now test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521)
[0m14:40:49.706076 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m14:40:49.708782 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m14:40:49.709230 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:40:49.709963 [debug] [Thread-4 (]: On seed.nyc_taxi_pipeline_00.taxi_zone_lookup: Close
[0m14:40:49.710766 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '066604cd-9ab8-44a2-8a50-44ba9a9f563e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a95c125c70>]}
[0m14:40:49.711121 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m14:40:49.711657 [info ] [Thread-4 (]: 5 of 91 OK loaded seed file main.taxi_zone_lookup .............................. [[32mCREATE 265[0m in 0.07s]
[0m14:40:49.712289 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: BEGIN
[0m14:40:49.712837 [debug] [Thread-4 (]: Finished running node seed.nyc_taxi_pipeline_00.taxi_zone_lookup
[0m14:40:49.713262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:49.713731 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m14:40:49.714653 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.714917 [info ] [Thread-4 (]: 9 of 91 START test unique_payment_type_lookup_payment_type_id .................. [RUN]
[0m14:40:49.715275 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"
[0m14:40:49.715904 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.nyc_taxi_pipeline_00.taxi_zone_lookup, now test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7)
[0m14:40:49.716251 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rate_code_id as unique_field,
    count(*) as n_records

from "dev"."main"."rate_code_lookup"
where rate_code_id is not null
group by rate_code_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:40:49.716549 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m14:40:49.717057 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m14:40:49.719308 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m14:40:49.719695 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:40:49.721680 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m14:40:49.723459 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: ROLLBACK
[0m14:40:49.724336 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d'
[0m14:40:49.724705 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d: Close
[0m14:40:49.725249 [info ] [Thread-1 (]: 7 of 91 PASS unique_rate_code_lookup_rate_code_id .............................. [[32mPASS[0m in 0.04s]
[0m14:40:49.725748 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d
[0m14:40:49.726802 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m14:40:49.727354 [info ] [Thread-1 (]: 10 of 91 START test not_null_dim_dates_date_key ................................ [RUN]
[0m14:40:49.727824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d, now test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348)
[0m14:40:49.728206 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m14:40:49.730913 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m14:40:49.732102 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m14:40:49.732362 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m14:40:49.732640 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: BEGIN
[0m14:40:49.735302 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m14:40:49.735922 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:49.737045 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.737403 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"
[0m14:40:49.737784 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."payment_type_lookup"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m14:40:49.738783 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.740155 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: ROLLBACK
[0m14:40:49.740913 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521'
[0m14:40:49.741536 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521: Close
[0m14:40:49.742248 [info ] [Thread-3 (]: 8 of 91 PASS not_null_payment_type_lookup_payment_type_id ...................... [[32mPASS[0m in 0.04s]
[0m14:40:49.742829 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521
[0m14:40:49.743162 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m14:40:49.743551 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m14:40:49.743963 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m14:40:49.745822 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m14:40:49.746226 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: BEGIN
[0m14:40:49.746563 [info ] [Thread-3 (]: 11 of 91 START test not_null_dim_dates_day_of_week_name ........................ [RUN]
[0m14:40:49.747235 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:49.747643 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521, now test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541)
[0m14:40:49.748247 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m14:40:49.748511 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.750830 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m14:40:49.751395 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"
[0m14:40:49.751973 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."payment_type_lookup"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:40:49.753133 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.754308 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: ROLLBACK
[0m14:40:49.755068 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7'
[0m14:40:49.755427 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7: Close
[0m14:40:49.755948 [info ] [Thread-4 (]: 9 of 91 PASS unique_payment_type_lookup_payment_type_id ........................ [[32mPASS[0m in 0.04s]
[0m14:40:49.756351 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m14:40:49.756653 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7
[0m14:40:49.757055 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: BEGIN
[0m14:40:49.757619 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m14:40:49.758441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:49.758972 [info ] [Thread-4 (]: 12 of 91 START test not_null_dim_dates_is_holiday .............................. [RUN]
[0m14:40:49.759922 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.760215 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7, now test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a)
[0m14:40:49.760452 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m14:40:49.760837 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"
[0m14:40:49.761131 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m14:40:49.763230 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m14:40:49.764152 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "dev"."main"."dim_dates"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m14:40:49.766463 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m14:40:49.768296 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.769408 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: ROLLBACK
[0m14:40:49.770091 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348'
[0m14:40:49.770523 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348: Close
[0m14:40:49.771109 [info ] [Thread-1 (]: 10 of 91 PASS not_null_dim_dates_date_key ...................................... [[32mPASS[0m in 0.04s]
[0m14:40:49.771674 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348
[0m14:40:49.772098 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m14:40:49.772492 [info ] [Thread-1 (]: 13 of 91 START test not_null_dim_dates_is_weekend .............................. [RUN]
[0m14:40:49.773031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348, now test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0)
[0m14:40:49.773519 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m14:40:49.776345 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m14:40:49.777343 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m14:40:49.777724 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m14:40:49.779388 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m14:40:49.779940 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: BEGIN
[0m14:40:49.780838 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:49.781522 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m14:40:49.781923 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.783740 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m14:40:49.784206 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"
[0m14:40:49.784769 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select day_of_week_name
from "dev"."main"."dim_dates"
where day_of_week_name is null



  
  
      
    ) dbt_internal_test
[0m14:40:49.785869 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.787174 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: ROLLBACK
[0m14:40:49.788045 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541'
[0m14:40:49.788533 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541: Close
[0m14:40:49.789094 [info ] [Thread-3 (]: 11 of 91 PASS not_null_dim_dates_day_of_week_name .............................. [[32mPASS[0m in 0.04s]
[0m14:40:49.789416 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m14:40:49.789730 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541
[0m14:40:49.790362 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m14:40:49.790695 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: BEGIN
[0m14:40:49.791362 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m14:40:49.791955 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: BEGIN
[0m14:40:49.792421 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:49.793162 [info ] [Thread-3 (]: 14 of 91 START test unique_dim_dates_date_key .................................. [RUN]
[0m14:40:49.793616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:49.794452 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541, now test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d)
[0m14:40:49.794792 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:40:49.795413 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m14:40:49.795668 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:40:49.796122 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"
[0m14:40:49.798898 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m14:40:49.799422 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"
[0m14:40:49.799765 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_holiday
from "dev"."main"."dim_dates"
where is_holiday is null



  
  
      
    ) dbt_internal_test
[0m14:40:49.800474 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."dim_dates"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m14:40:49.801616 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.801878 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.802828 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: ROLLBACK
[0m14:40:49.804050 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: ROLLBACK
[0m14:40:49.804562 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a'
[0m14:40:49.805430 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0'
[0m14:40:49.806178 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a: Close
[0m14:40:49.806639 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0: Close
[0m14:40:49.807359 [info ] [Thread-4 (]: 12 of 91 PASS not_null_dim_dates_is_holiday .................................... [[32mPASS[0m in 0.05s]
[0m14:40:49.807885 [info ] [Thread-1 (]: 13 of 91 PASS not_null_dim_dates_is_weekend .................................... [[32mPASS[0m in 0.03s]
[0m14:40:49.808348 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a
[0m14:40:49.809046 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0
[0m14:40:49.809729 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m14:40:49.810163 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m14:40:49.810759 [info ] [Thread-4 (]: 15 of 91 START test not_null_taxi_zone_lookup_Borough .......................... [RUN]
[0m14:40:49.811312 [info ] [Thread-1 (]: 16 of 91 START test not_null_taxi_zone_lookup_LocationID ....................... [RUN]
[0m14:40:49.811835 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a, now test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa)
[0m14:40:49.812230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0, now test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a)
[0m14:40:49.812633 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m14:40:49.813103 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m14:40:49.813411 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m14:40:49.816296 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m14:40:49.819135 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m14:40:49.821620 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m14:40:49.827641 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m14:40:49.829805 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m14:40:49.830157 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m14:40:49.831886 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m14:40:49.833047 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m14:40:49.833369 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: BEGIN
[0m14:40:49.833683 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:49.834714 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.835254 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"
[0m14:40:49.835704 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m14:40:49.836097 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "dev"."main"."dim_dates"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:40:49.836530 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m14:40:49.836946 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: BEGIN
[0m14:40:49.837839 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: BEGIN
[0m14:40:49.838238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:49.838787 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.839084 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:49.839957 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:40:49.841301 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: ROLLBACK
[0m14:40:49.841871 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:40:49.842181 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"
[0m14:40:49.842954 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d'
[0m14:40:49.843354 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"
[0m14:40:49.843989 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select LocationID
from "dev"."main"."taxi_zone_lookup"
where LocationID is null



  
  
      
    ) dbt_internal_test
[0m14:40:49.844395 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d: Close
[0m14:40:49.844810 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Borough
from "dev"."main"."taxi_zone_lookup"
where Borough is null



  
  
      
    ) dbt_internal_test
[0m14:40:49.845890 [info ] [Thread-3 (]: 14 of 91 PASS unique_dim_dates_date_key ........................................ [[32mPASS[0m in 0.05s]
[0m14:40:49.846368 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.846666 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.847119 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d
[0m14:40:49.848640 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: ROLLBACK
[0m14:40:49.849766 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: ROLLBACK
[0m14:40:49.850108 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m14:40:49.851198 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a'
[0m14:40:49.851720 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa'
[0m14:40:49.852283 [info ] [Thread-3 (]: 17 of 91 START test unique_taxi_zone_lookup_LocationID ......................... [RUN]
[0m14:40:49.852791 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a: Close
[0m14:40:49.853444 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa: Close
[0m14:40:49.854098 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d, now test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8)
[0m14:40:49.854767 [info ] [Thread-1 (]: 16 of 91 PASS not_null_taxi_zone_lookup_LocationID ............................. [[32mPASS[0m in 0.04s]
[0m14:40:49.855207 [info ] [Thread-4 (]: 15 of 91 PASS not_null_taxi_zone_lookup_Borough ................................ [[32mPASS[0m in 0.04s]
[0m14:40:49.855500 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m14:40:49.856221 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a
[0m14:40:49.856767 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa
[0m14:40:49.859697 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m14:40:49.860668 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m14:40:49.861047 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.stg_payment_types
[0m14:40:49.861679 [info ] [Thread-1 (]: 18 of 91 START sql view model main.stg_rate_codes .............................. [RUN]
[0m14:40:49.862171 [info ] [Thread-4 (]: 19 of 91 START sql view model main.stg_payment_types ........................... [RUN]
[0m14:40:49.862660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a, now model.nyc_taxi_pipeline_00.stg_rate_codes)
[0m14:40:49.863124 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa, now model.nyc_taxi_pipeline_00.stg_payment_types)
[0m14:40:49.863624 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m14:40:49.864179 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_payment_types
[0m14:40:49.866333 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m14:40:49.868065 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m14:40:49.869096 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m14:40:49.871177 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m14:40:49.872311 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m14:40:49.872708 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.stg_payment_types
[0m14:40:49.884909 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m14:40:49.886737 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m14:40:49.888566 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m14:40:49.889045 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: BEGIN
[0m14:40:49.889392 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:49.890308 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.890613 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m14:40:49.890885 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"
[0m14:40:49.891417 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: BEGIN
[0m14:40:49.891862 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m14:40:49.892159 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    LocationID as unique_field,
    count(*) as n_records

from "dev"."main"."taxi_zone_lookup"
where LocationID is not null
group by LocationID
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:40:49.892556 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:49.892906 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: BEGIN
[0m14:40:49.893808 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.894066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:49.894326 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.894559 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m14:40:49.895122 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.896394 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: ROLLBACK
[0m14:40:49.896973 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */

  
  create view "dev"."main"."stg_payment_types__dbt_tmp" as (
    /*
    Staging model: Payment type lookup
    Maps payment_type_id to human-readable names.
*/

with source as (
    select * from "dev"."main"."payment_type_lookup"
),

renamed as (
    select
        payment_type_id,
        payment_type_name
    from source
)

select * from renamed
  );

[0m14:40:49.897401 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m14:40:49.898163 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8'
[0m14:40:49.898840 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */

  
  create view "dev"."main"."stg_rate_codes__dbt_tmp" as (
    /*
    Staging model: Rate code lookup
    Maps rate_code_id to human-readable names.
*/

with source as (
    select * from "dev"."main"."rate_code_lookup"
),

renamed as (
    select
        rate_code_id,
        rate_code_name
    from source
)

select * from renamed
  );

[0m14:40:49.899185 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.899513 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8: Close
[0m14:40:49.901906 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m14:40:49.902386 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:40:49.902829 [info ] [Thread-3 (]: 17 of 91 PASS unique_taxi_zone_lookup_LocationID ............................... [[32mPASS[0m in 0.05s]
[0m14:40:49.903095 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
alter view "dev"."main"."stg_payment_types" rename to "stg_payment_types__dbt_backup"
[0m14:40:49.905655 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m14:40:49.906388 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8
[0m14:40:49.907091 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
alter view "dev"."main"."stg_rate_codes" rename to "stg_rate_codes__dbt_backup"
[0m14:40:49.907439 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.907970 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m14:40:49.909949 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m14:40:49.910208 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:40:49.910792 [info ] [Thread-3 (]: 20 of 91 START sql view model main.stg_taxi_zones .............................. [RUN]
[0m14:40:49.911487 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
alter view "dev"."main"."stg_payment_types__dbt_tmp" rename to "stg_payment_types"
[0m14:40:49.913731 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m14:40:49.914308 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8, now model.nyc_taxi_pipeline_00.stg_taxi_zones)
[0m14:40:49.914918 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
alter view "dev"."main"."stg_rate_codes__dbt_tmp" rename to "stg_rate_codes"
[0m14:40:49.915240 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.915519 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m14:40:49.916422 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:40:49.917363 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: COMMIT
[0m14:40:49.919881 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m14:40:49.921027 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: COMMIT
[0m14:40:49.921452 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m14:40:49.922102 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m14:40:49.922454 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: COMMIT
[0m14:40:49.922846 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: COMMIT
[0m14:40:49.928679 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m14:40:49.929276 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m14:40:49.931770 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m14:40:49.932253 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m14:40:49.934010 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_payment_types"
[0m14:40:49.937002 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_rate_codes"
[0m14:40:49.937706 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_payment_types"} */
drop view if exists "dev"."main"."stg_payment_types__dbt_backup" cascade
[0m14:40:49.938319 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_rate_codes"} */
drop view if exists "dev"."main"."stg_rate_codes__dbt_backup" cascade
[0m14:40:49.941560 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:40:49.943149 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.stg_payment_types: Close
[0m14:40:49.943526 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m14:40:49.944112 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '066604cd-9ab8-44a2-8a50-44ba9a9f563e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a95c1cd250>]}
[0m14:40:49.944358 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: BEGIN
[0m14:40:49.944555 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:40:49.945159 [info ] [Thread-4 (]: 19 of 91 OK created sql view model main.stg_payment_types ...................... [[32mOK[0m in 0.08s]
[0m14:40:49.945763 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:49.946893 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.stg_rate_codes: Close
[0m14:40:49.947605 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.stg_payment_types
[0m14:40:49.948598 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:40:49.948963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '066604cd-9ab8-44a2-8a50-44ba9a9f563e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a95c1cc290>]}
[0m14:40:49.949884 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m14:40:49.950275 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m14:40:49.951005 [info ] [Thread-1 (]: 18 of 91 OK created sql view model main.stg_rate_codes ......................... [[32mOK[0m in 0.09s]
[0m14:40:49.951595 [info ] [Thread-4 (]: 21 of 91 START test not_null_stg_payment_types_payment_type_id ................. [RUN]
[0m14:40:49.952212 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */

  
  create view "dev"."main"."stg_taxi_zones__dbt_tmp" as (
    /*
    Staging model: Taxi zone lookup
    Maps LocationID to borough and zone name.
*/

with source as (
    select * from "dev"."main"."taxi_zone_lookup"
),

renamed as (
    select
        cast("LocationID" as integer) as location_id,
        "Borough" as borough,
        "Zone" as zone_name,
        service_zone
    from source
)

select * from renamed
  );

[0m14:40:49.952829 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.stg_rate_codes
[0m14:40:49.953427 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_payment_types, now test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78)
[0m14:40:49.954423 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m14:40:49.954759 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.955559 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m14:40:49.956248 [info ] [Thread-1 (]: 22 of 91 START test not_null_stg_payment_types_payment_type_name ............... [RUN]
[0m14:40:49.958878 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m14:40:49.961419 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m14:40:49.961960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_rate_codes, now test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39)
[0m14:40:49.962354 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
alter view "dev"."main"."stg_taxi_zones" rename to "stg_taxi_zones__dbt_backup"
[0m14:40:49.963034 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m14:40:49.965789 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m14:40:49.966223 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:40:49.968245 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m14:40:49.968679 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
alter view "dev"."main"."stg_taxi_zones__dbt_tmp" rename to "stg_taxi_zones"
[0m14:40:49.969455 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:40:49.969869 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m14:40:49.971056 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: COMMIT
[0m14:40:49.973024 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m14:40:49.973635 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m14:40:49.974184 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m14:40:49.974557 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: COMMIT
[0m14:40:49.976516 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m14:40:49.979948 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:40:49.982219 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_taxi_zones"
[0m14:40:49.982800 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones"} */
drop view if exists "dev"."main"."stg_taxi_zones__dbt_backup" cascade
[0m14:40:49.983686 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m14:40:49.984098 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: BEGIN
[0m14:40:49.984500 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:49.985096 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m14:40:49.985446 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.985763 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: BEGIN
[0m14:40:49.986199 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:40:49.986522 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"
[0m14:40:49.986992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:49.988502 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.stg_taxi_zones: Close
[0m14:40:49.989116 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."stg_payment_types"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m14:40:49.989899 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:40:49.990381 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '066604cd-9ab8-44a2-8a50-44ba9a9f563e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a95c37e2d0>]}
[0m14:40:49.991107 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"
[0m14:40:49.991739 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.992436 [info ] [Thread-3 (]: 20 of 91 OK created sql view model main.stg_taxi_zones ......................... [[32mOK[0m in 0.08s]
[0m14:40:49.993240 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_name
from "dev"."main"."stg_payment_types"
where payment_type_name is null



  
  
      
    ) dbt_internal_test
[0m14:40:49.994584 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: ROLLBACK
[0m14:40:49.995041 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.stg_taxi_zones
[0m14:40:49.996461 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78'
[0m14:40:49.996999 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:49.998140 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m14:40:49.999034 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78: Close
[0m14:40:50.000490 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: ROLLBACK
[0m14:40:50.000860 [info ] [Thread-3 (]: 23 of 91 START test unique_stg_payment_types_payment_type_id ................... [RUN]
[0m14:40:50.001658 [info ] [Thread-4 (]: 21 of 91 PASS not_null_stg_payment_types_payment_type_id ....................... [[32mPASS[0m in 0.05s]
[0m14:40:50.002307 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39'
[0m14:40:50.002667 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_taxi_zones, now test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534)
[0m14:40:50.003086 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78
[0m14:40:50.003631 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39: Close
[0m14:40:50.004035 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m14:40:50.004630 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m14:40:50.005326 [info ] [Thread-1 (]: 22 of 91 PASS not_null_stg_payment_types_payment_type_name ..................... [[32mPASS[0m in 0.04s]
[0m14:40:50.008120 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m14:40:50.008787 [info ] [Thread-4 (]: 24 of 91 START test not_null_stg_rate_codes_rate_code_id ....................... [RUN]
[0m14:40:50.009425 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39
[0m14:40:50.010028 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78, now test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a)
[0m14:40:50.010510 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m14:40:50.011073 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m14:40:50.011516 [info ] [Thread-1 (]: 25 of 91 START test not_null_stg_rate_codes_rate_code_name ..................... [RUN]
[0m14:40:50.014254 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m14:40:50.014944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39, now test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f)
[0m14:40:50.015678 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m14:40:50.018983 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m14:40:50.020330 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m14:40:50.022210 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m14:40:50.023226 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m14:40:50.024629 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m14:40:50.024877 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m14:40:50.026639 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m14:40:50.027819 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m14:40:50.028163 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m14:40:50.028495 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: BEGIN
[0m14:40:50.029169 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: BEGIN
[0m14:40:50.030372 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:50.030860 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:50.031685 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m14:40:50.031944 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:40:50.032379 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:40:50.032580 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: BEGIN
[0m14:40:50.032936 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"
[0m14:40:50.033334 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"
[0m14:40:50.033661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:50.034111 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_payment_types"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:40:50.034533 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_id
from "dev"."main"."stg_rate_codes"
where rate_code_id is null



  
  
      
    ) dbt_internal_test
[0m14:40:50.035219 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:40:50.036021 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"
[0m14:40:50.036380 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_code_name
from "dev"."main"."stg_rate_codes"
where rate_code_name is null



  
  
      
    ) dbt_internal_test
[0m14:40:50.036632 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:50.037035 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:40:50.038068 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: ROLLBACK
[0m14:40:50.038298 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:50.039069 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: ROLLBACK
[0m14:40:50.039918 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a'
[0m14:40:50.040689 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: ROLLBACK
[0m14:40:50.041409 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534'
[0m14:40:50.041814 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a: Close
[0m14:40:50.042444 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f'
[0m14:40:50.042769 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534: Close
[0m14:40:50.043580 [info ] [Thread-4 (]: 24 of 91 PASS not_null_stg_rate_codes_rate_code_id ............................. [[32mPASS[0m in 0.03s]
[0m14:40:50.043815 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f: Close
[0m14:40:50.044580 [info ] [Thread-3 (]: 23 of 91 PASS unique_stg_payment_types_payment_type_id ......................... [[32mPASS[0m in 0.04s]
[0m14:40:50.044894 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a
[0m14:40:50.045527 [info ] [Thread-1 (]: 25 of 91 PASS not_null_stg_rate_codes_rate_code_name ........................... [[32mPASS[0m in 0.03s]
[0m14:40:50.045821 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534
[0m14:40:50.046455 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m14:40:50.046976 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f
[0m14:40:50.047503 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m14:40:50.047974 [info ] [Thread-4 (]: 26 of 91 START test unique_stg_rate_codes_rate_code_id ......................... [RUN]
[0m14:40:50.048357 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m14:40:50.049097 [info ] [Thread-3 (]: 27 of 91 START test not_null_stg_taxi_zones_borough ............................ [RUN]
[0m14:40:50.049900 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a, now test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3)
[0m14:40:50.050334 [info ] [Thread-1 (]: 28 of 91 START test not_null_stg_taxi_zones_location_id ........................ [RUN]
[0m14:40:50.051255 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b)
[0m14:40:50.051829 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m14:40:50.052348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf)
[0m14:40:50.052734 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m14:40:50.055630 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m14:40:50.056085 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m14:40:50.058521 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m14:40:50.061155 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m14:40:50.065311 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m14:40:50.066982 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m14:40:50.067426 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m14:40:50.067702 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m14:40:50.069489 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m14:40:50.072053 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m14:40:50.073242 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m14:40:50.073656 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: BEGIN
[0m14:40:50.073964 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:50.074680 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:50.075019 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"
[0m14:40:50.075325 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m14:40:50.075603 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rate_code_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_rate_codes"
where rate_code_id is not null
group by rate_code_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:40:50.075934 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m14:40:50.076147 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: BEGIN
[0m14:40:50.077515 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: BEGIN
[0m14:40:50.077822 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:50.078236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:50.078614 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:50.079848 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: ROLLBACK
[0m14:40:50.080299 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:40:50.081027 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3'
[0m14:40:50.081281 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:40:50.081509 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m14:40:50.081975 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3: Close
[0m14:40:50.082308 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"
[0m14:40:50.082628 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "dev"."main"."stg_taxi_zones"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m14:40:50.083248 [info ] [Thread-4 (]: 26 of 91 PASS unique_stg_rate_codes_rate_code_id ............................... [[32mPASS[0m in 0.03s]
[0m14:40:50.083694 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select borough
from "dev"."main"."stg_taxi_zones"
where borough is null



  
  
      
    ) dbt_internal_test
[0m14:40:50.084424 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3
[0m14:40:50.084714 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:50.085187 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m14:40:50.085517 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:50.086588 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: ROLLBACK
[0m14:40:50.086808 [info ] [Thread-4 (]: 29 of 91 START test not_null_stg_taxi_zones_zone_name .......................... [RUN]
[0m14:40:50.087748 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: ROLLBACK
[0m14:40:50.088439 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf'
[0m14:40:50.088899 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3, now test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84)
[0m14:40:50.089542 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b'
[0m14:40:50.089910 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf: Close
[0m14:40:50.090276 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m14:40:50.090578 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b: Close
[0m14:40:50.091076 [info ] [Thread-1 (]: 28 of 91 PASS not_null_stg_taxi_zones_location_id .............................. [[32mPASS[0m in 0.04s]
[0m14:40:50.093467 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m14:40:50.094099 [info ] [Thread-3 (]: 27 of 91 PASS not_null_stg_taxi_zones_borough .................................. [[32mPASS[0m in 0.04s]
[0m14:40:50.094562 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m14:40:50.095188 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b
[0m14:40:50.095609 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m14:40:50.096042 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.dim_payment_types
[0m14:40:50.096516 [info ] [Thread-1 (]: 30 of 91 START test unique_stg_taxi_zones_location_id .......................... [RUN]
[0m14:40:50.097053 [info ] [Thread-3 (]: 31 of 91 START sql table model main.dim_payment_types .......................... [RUN]
[0m14:40:50.097562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf, now test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c)
[0m14:40:50.097989 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b, now model.nyc_taxi_pipeline_00.dim_payment_types)
[0m14:40:50.098284 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m14:40:50.098622 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_payment_types
[0m14:40:50.101014 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m14:40:50.103135 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m14:40:50.103927 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m14:40:50.105398 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m14:40:50.106676 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m14:40:50.108067 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m14:40:50.109845 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.dim_payment_types
[0m14:40:50.112130 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m14:40:50.112643 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
DESCRIBE (select * from (
        /*
    Dimension table: Payment type descriptions.
*/

with payment_types as (
    select * from "dev"."main"."stg_payment_types"
),

final as (
    select
        payment_type_id,
        payment_type_name
    from payment_types
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:40:50.113136 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:50.114045 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m14:40:50.114539 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:50.114824 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: BEGIN
[0m14:40:50.115427 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m14:40:50.116267 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m14:40:50.116567 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:50.116924 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: BEGIN
[0m14:40:50.117318 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as payment_type_id, 
      
    cast(null as varchar)
 as payment_type_name
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:40:50.117952 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:50.118148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:50.118758 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"
[0m14:40:50.119024 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:40:50.119528 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:50.119859 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select zone_name
from "dev"."main"."stg_taxi_zones"
where zone_name is null



  
  
      
    ) dbt_internal_test
[0m14:40:50.120799 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m14:40:50.121029 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m14:40:50.121769 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_taxi_zones"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:40:50.122237 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:50.123584 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: ROLLBACK
[0m14:40:50.123845 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:50.124584 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84'
[0m14:40:50.126159 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: ROLLBACK
[0m14:40:50.126454 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84: Close
[0m14:40:50.127292 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c'
[0m14:40:50.128062 [info ] [Thread-4 (]: 29 of 91 PASS not_null_stg_taxi_zones_zone_name ................................ [[32mPASS[0m in 0.04s]
[0m14:40:50.128303 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c: Close
[0m14:40:50.128856 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84
[0m14:40:50.129825 [info ] [Thread-1 (]: 30 of 91 PASS unique_stg_taxi_zones_location_id ................................ [[32mPASS[0m in 0.03s]
[0m14:40:50.130597 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c
[0m14:40:50.131129 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m14:40:50.131670 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.dim_locations
[0m14:40:50.132000 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: BEGIN
[0m14:40:50.132624 [info ] [Thread-4 (]: 32 of 91 START sql table model main.dim_locations .............................. [RUN]
[0m14:40:50.133409 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84, now model.nyc_taxi_pipeline_00.dim_locations)
[0m14:40:50.133635 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:50.134037 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.dim_locations
[0m14:40:50.134372 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m14:40:50.136647 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.dim_locations"
[0m14:40:50.137027 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_payment_types__dbt_tmp"
  
  (
    payment_type_id integer,
    payment_type_name varchar
    
    )
 ;
    insert into "dev"."main"."dim_payment_types__dbt_tmp" 
  (
    
      
      payment_type_id ,
    
      
      payment_type_name 
    
  )
 (
      
    select payment_type_id, payment_type_name
    from (
        /*
    Dimension table: Payment type descriptions.
*/

with payment_types as (
    select * from "dev"."main"."stg_payment_types"
),

final as (
    select
        payment_type_id,
        payment_type_name
    from payment_types
)

select * from final
    ) as model_subq
    );
  
  
[0m14:40:50.138530 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:50.140341 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m14:40:50.140733 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
alter table "dev"."main"."dim_payment_types" rename to "dim_payment_types__dbt_backup"
[0m14:40:50.141922 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:40:50.145173 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m14:40:50.145549 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
alter table "dev"."main"."dim_payment_types__dbt_tmp" rename to "dim_payment_types"
[0m14:40:50.146360 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:40:50.147585 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: COMMIT
[0m14:40:50.147873 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.dim_locations
[0m14:40:50.148224 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m14:40:50.150552 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m14:40:50.151094 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: COMMIT
[0m14:40:50.151684 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
DESCRIBE (select * from (
        /*
    Dimension table: TLC Taxi Zone locations.
*/

with zones as (
    select * from "dev"."main"."stg_taxi_zones"
),

final as (
    select
        location_id,
        borough,
        zone_name,
        service_zone
    from zones
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:40:50.152344 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:50.153527 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:50.156549 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m14:40:50.156871 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m14:40:50.157216 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as location_id, 
      
    cast(null as varchar)
 as borough, 
      
    cast(null as varchar)
 as zone_name, 
      
    cast(null as varchar)
 as service_zone
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:40:50.159059 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_payment_types"
[0m14:40:50.160183 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_payment_types"} */
drop table if exists "dev"."main"."dim_payment_types__dbt_backup" cascade
[0m14:40:50.160459 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:50.161760 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.dim_locations"
[0m14:40:50.164748 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m14:40:50.166163 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.dim_payment_types: Close
[0m14:40:50.166891 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '066604cd-9ab8-44a2-8a50-44ba9a9f563e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a8fbd6b230>]}
[0m14:40:50.167559 [info ] [Thread-3 (]: 31 of 91 OK created sql table model main.dim_payment_types ..................... [[32mOK[0m in 0.07s]
[0m14:40:50.168146 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.dim_payment_types
[0m14:40:50.169243 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m14:40:50.169653 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m14:40:50.170038 [info ] [Thread-1 (]: 33 of 91 START test not_null_dim_payment_types_payment_type_id ................. [RUN]
[0m14:40:50.170613 [info ] [Thread-3 (]: 34 of 91 START test not_null_dim_payment_types_payment_type_name ............... [RUN]
[0m14:40:50.171217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c, now test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10)
[0m14:40:50.171915 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_payment_types, now test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0)
[0m14:40:50.172398 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m14:40:50.172758 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m14:40:50.173355 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m14:40:50.173873 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: BEGIN
[0m14:40:50.177166 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m14:40:50.180143 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m14:40:50.181072 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:40:50.181693 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m14:40:50.182050 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */

  
    
    
      
    

    create  table
      "dev"."main"."dim_locations__dbt_tmp"
  
  (
    location_id integer,
    borough varchar,
    zone_name varchar,
    service_zone varchar
    
    )
 ;
    insert into "dev"."main"."dim_locations__dbt_tmp" 
  (
    
      
      location_id ,
    
      
      borough ,
    
      
      zone_name ,
    
      
      service_zone 
    
  )
 (
      
    select location_id, borough, zone_name, service_zone
    from (
        /*
    Dimension table: TLC Taxi Zone locations.
*/

with zones as (
    select * from "dev"."main"."stg_taxi_zones"
),

final as (
    select
        location_id,
        borough,
        zone_name,
        service_zone
    from zones
)

select * from final
    ) as model_subq
    );
  
  
[0m14:40:50.183749 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:50.185849 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m14:40:50.186463 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
alter table "dev"."main"."dim_locations" rename to "dim_locations__dbt_backup"
[0m14:40:50.187309 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:40:50.188969 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m14:40:50.189626 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
alter table "dev"."main"."dim_locations__dbt_tmp" rename to "dim_locations"
[0m14:40:50.190428 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:40:50.191386 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: COMMIT
[0m14:40:50.192081 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m14:40:50.192517 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: COMMIT
[0m14:40:50.192899 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m14:40:50.194729 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m14:40:50.194961 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m14:40:50.196584 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m14:40:50.197410 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:40:50.200009 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.dim_locations"
[0m14:40:50.200452 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.dim_locations"} */
drop table if exists "dev"."main"."dim_locations__dbt_backup" cascade
[0m14:40:50.204424 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:40:50.206220 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.dim_locations: Close
[0m14:40:50.206584 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m14:40:50.207228 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '066604cd-9ab8-44a2-8a50-44ba9a9f563e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a95c1921b0>]}
[0m14:40:50.207519 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: BEGIN
[0m14:40:50.208308 [info ] [Thread-4 (]: 32 of 91 OK created sql table model main.dim_locations ......................... [[32mOK[0m in 0.07s]
[0m14:40:50.208651 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m14:40:50.208894 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:50.209458 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.dim_locations
[0m14:40:50.210001 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: BEGIN
[0m14:40:50.210811 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:40:50.211187 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m14:40:50.211777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:50.212420 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"
[0m14:40:50.212872 [info ] [Thread-4 (]: 35 of 91 START test unique_dim_payment_types_payment_type_id ................... [RUN]
[0m14:40:50.213550 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:40:50.213876 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_name
from "dev"."main"."dim_payment_types"
where payment_type_name is null



  
  
      
    ) dbt_internal_test
[0m14:40:50.214345 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.dim_locations, now test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62)
[0m14:40:50.214781 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"
[0m14:40:50.215318 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m14:40:50.215720 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type_id
from "dev"."main"."dim_payment_types"
where payment_type_id is null



  
  
      
    ) dbt_internal_test
[0m14:40:50.215983 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:50.218683 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m14:40:50.220090 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: ROLLBACK
[0m14:40:50.220369 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:50.221764 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0'
[0m14:40:50.222775 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: ROLLBACK
[0m14:40:50.223036 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0: Close
[0m14:40:50.224015 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10'
[0m14:40:50.224637 [info ] [Thread-3 (]: 34 of 91 PASS not_null_dim_payment_types_payment_type_name ..................... [[32mPASS[0m in 0.05s]
[0m14:40:50.225043 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10: Close
[0m14:40:50.225621 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0
[0m14:40:50.226291 [info ] [Thread-1 (]: 33 of 91 PASS not_null_dim_payment_types_payment_type_id ....................... [[32mPASS[0m in 0.06s]
[0m14:40:50.226819 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m14:40:50.227302 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10
[0m14:40:50.227688 [info ] [Thread-3 (]: 36 of 91 START test not_null_dim_locations_borough ............................. [RUN]
[0m14:40:50.228252 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m14:40:50.229038 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0, now test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af)
[0m14:40:50.229495 [info ] [Thread-1 (]: 37 of 91 START test not_null_dim_locations_location_id ......................... [RUN]
[0m14:40:50.230219 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m14:40:50.230812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10, now test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476)
[0m14:40:50.231114 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m14:40:50.233663 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m14:40:50.234054 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m14:40:50.235536 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m14:40:50.238382 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m14:40:50.243418 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m14:40:50.245135 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m14:40:50.246328 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m14:40:50.246585 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m14:40:50.246822 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: BEGIN
[0m14:40:50.248738 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m14:40:50.249299 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:50.249855 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m14:40:50.250547 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: BEGIN
[0m14:40:50.250791 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:50.251084 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:50.251797 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"
[0m14:40:50.252390 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:50.252664 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type_id as unique_field,
    count(*) as n_records

from "dev"."main"."dim_payment_types"
where payment_type_id is not null
group by payment_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:40:50.253048 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"
[0m14:40:50.253643 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select borough
from "dev"."main"."dim_locations"
where borough is null



  
  
      
    ) dbt_internal_test
[0m14:40:50.254211 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:50.254583 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:40:50.255720 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: ROLLBACK
[0m14:40:50.256643 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: ROLLBACK
[0m14:40:50.257382 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62'
[0m14:40:50.257964 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af'
[0m14:40:50.258339 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62: Close
[0m14:40:50.258658 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m14:40:50.258868 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af: Close
[0m14:40:50.259445 [info ] [Thread-4 (]: 35 of 91 PASS unique_dim_payment_types_payment_type_id ......................... [[32mPASS[0m in 0.05s]
[0m14:40:50.259658 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: BEGIN
[0m14:40:50.260142 [info ] [Thread-3 (]: 36 of 91 PASS not_null_dim_locations_borough ................................... [[32mPASS[0m in 0.03s]
[0m14:40:50.260542 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62
[0m14:40:50.260935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:50.261411 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af
[0m14:40:50.261825 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m14:40:50.262546 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:40:50.262810 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m14:40:50.263248 [info ] [Thread-4 (]: 38 of 91 START test not_null_dim_locations_zone_name ........................... [RUN]
[0m14:40:50.263612 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"
[0m14:40:50.264021 [info ] [Thread-3 (]: 39 of 91 START test unique_dim_locations_location_id ........................... [RUN]
[0m14:40:50.264371 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62, now test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d)
[0m14:40:50.265040 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "dev"."main"."dim_locations"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m14:40:50.265446 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af, now test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d)
[0m14:40:50.265805 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m14:40:50.266530 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m14:40:50.266910 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:50.269513 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m14:40:50.271853 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m14:40:50.273121 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: ROLLBACK
[0m14:40:50.274127 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476'
[0m14:40:50.274448 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476: Close
[0m14:40:50.274929 [info ] [Thread-1 (]: 37 of 91 PASS not_null_dim_locations_location_id ............................... [[32mPASS[0m in 0.04s]
[0m14:40:50.275545 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476
[0m14:40:50.277556 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m14:40:50.280134 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m14:40:50.280393 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m14:40:50.282209 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m14:40:50.284313 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m14:40:50.284727 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: BEGIN
[0m14:40:50.285166 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:50.285865 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m14:40:50.286131 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:50.286383 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: BEGIN
[0m14:40:50.286742 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"
[0m14:40:50.287048 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:50.287365 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select zone_name
from "dev"."main"."dim_locations"
where zone_name is null



  
  
      
    ) dbt_internal_test
[0m14:40:50.287980 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:50.288402 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"
[0m14:40:50.288774 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "dev"."main"."dim_locations"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:40:50.289088 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:50.290444 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: ROLLBACK
[0m14:40:50.290713 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:50.291361 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d'
[0m14:40:50.292157 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: ROLLBACK
[0m14:40:50.292379 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d: Close
[0m14:40:50.292975 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d'
[0m14:40:50.293449 [info ] [Thread-4 (]: 38 of 91 PASS not_null_dim_locations_zone_name ................................. [[32mPASS[0m in 0.03s]
[0m14:40:50.293698 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d: Close
[0m14:40:50.294181 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d
[0m14:40:50.295104 [info ] [Thread-3 (]: 39 of 91 PASS unique_dim_locations_location_id ................................. [[32mPASS[0m in 0.03s]
[0m14:40:50.295767 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d
[0m14:40:51.228919 [debug] [Thread-2 (]: SQL status: OK in 1.651 seconds
[0m14:40:51.232488 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m14:40:51.232869 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
alter table "dev"."main"."stg_yellow_trips" rename to "stg_yellow_trips__dbt_backup"
[0m14:40:51.233827 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:40:51.235364 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m14:40:51.235710 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
alter table "dev"."main"."stg_yellow_trips__dbt_tmp" rename to "stg_yellow_trips"
[0m14:40:51.236190 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:40:51.237130 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: COMMIT
[0m14:40:51.237452 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m14:40:51.237708 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: COMMIT
[0m14:40:51.308171 [debug] [Thread-2 (]: SQL status: OK in 0.070 seconds
[0m14:40:51.309919 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.stg_yellow_trips"
[0m14:40:51.310252 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips"} */
drop table if exists "dev"."main"."stg_yellow_trips__dbt_backup" cascade
[0m14:40:51.315702 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m14:40:51.317040 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.stg_yellow_trips: Close
[0m14:40:51.377248 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '066604cd-9ab8-44a2-8a50-44ba9a9f563e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a95c37d8e0>]}
[0m14:40:51.378210 [info ] [Thread-2 (]: 2 of 91 OK created sql table model main.stg_yellow_trips ....................... [[32mOK[0m in 1.90s]
[0m14:40:51.378669 [debug] [Thread-2 (]: Finished running node model.nyc_taxi_pipeline_00.stg_yellow_trips
[0m14:40:51.380008 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m14:40:51.380248 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m14:40:51.380496 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m14:40:51.380696 [info ] [Thread-1 (]: 40 of 91 START test accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6  [RUN]
[0m14:40:51.380915 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m14:40:51.381101 [info ] [Thread-4 (]: 41 of 91 START test accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99  [RUN]
[0m14:40:51.381577 [info ] [Thread-3 (]: 42 of 91 START test accepted_values_stg_yellow_trips_vendor_id__1__2__6 ........ [RUN]
[0m14:40:51.381986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44)
[0m14:40:51.382422 [info ] [Thread-2 (]: 43 of 91 START test assert_fare_not_exceeds_total .............................. [RUN]
[0m14:40:51.382879 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098)
[0m14:40:51.383280 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d, now test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27)
[0m14:40:51.383762 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m14:40:51.384428 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.stg_yellow_trips, now test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total)
[0m14:40:51.384791 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m14:40:51.385096 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m14:40:51.392060 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m14:40:51.392475 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m14:40:51.395586 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m14:40:51.398762 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m14:40:51.400930 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m14:40:51.406031 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m14:40:51.406496 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m14:40:51.406768 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m14:40:51.409643 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m14:40:51.410883 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m14:40:51.411142 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m14:40:51.412438 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m14:40:51.414265 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m14:40:51.416704 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m14:40:51.416979 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m14:40:51.417233 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: BEGIN
[0m14:40:51.417595 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m14:40:51.417838 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: BEGIN
[0m14:40:51.418518 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:51.418970 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m14:40:51.419202 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: BEGIN
[0m14:40:51.419589 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:40:51.420258 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: BEGIN
[0m14:40:51.420570 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:51.421010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:51.437678 [debug] [Thread-4 (]: SQL status: OK in 0.019 seconds
[0m14:40:51.438123 [debug] [Thread-3 (]: SQL status: OK in 0.018 seconds
[0m14:40:51.438402 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"
[0m14:40:51.438661 [debug] [Thread-2 (]: SQL status: OK in 0.019 seconds
[0m14:40:51.438959 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m14:40:51.439144 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"
[0m14:40:51.439514 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        rate_code_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by rate_code_id

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5','6','99'
)



  
  
      
    ) dbt_internal_test
[0m14:40:51.439828 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"
[0m14:40:51.440095 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"
[0m14:40:51.440421 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        vendor_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by vendor_id

)

select *
from all_values
where value_field not in (
    '1','2','6'
)



  
  
      
    ) dbt_internal_test
[0m14:40:51.441078 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
    Singular test: fare_amount should not exceed total_amount.
*/

select
    trip_id,
    fare_amount,
    total_amount
from "dev"."main"."stg_yellow_trips"
where fare_amount > total_amount + 0.01
  and total_amount > 0
  
  
      
    ) dbt_internal_test
[0m14:40:51.441382 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        payment_type_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_yellow_trips"
    group by payment_type_id

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6'
)



  
  
      
    ) dbt_internal_test
[0m14:40:51.465619 [debug] [Thread-4 (]: SQL status: OK in 0.025 seconds
[0m14:40:51.468296 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: ROLLBACK
[0m14:40:51.470788 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098'
[0m14:40:51.471857 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098: Close
[0m14:40:51.473074 [debug] [Thread-3 (]: SQL status: OK in 0.031 seconds
[0m14:40:51.473508 [info ] [Thread-4 (]: 41 of 91 PASS accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99  [[32mPASS[0m in 0.09s]
[0m14:40:51.475551 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: ROLLBACK
[0m14:40:51.477184 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098
[0m14:40:51.478645 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27'
[0m14:40:51.478922 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m14:40:51.479432 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m14:40:51.480395 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27: Close
[0m14:40:51.482239 [info ] [Thread-4 (]: 44 of 91 START test not_null_stg_yellow_trips_dropoff_datetime ................. [RUN]
[0m14:40:51.484384 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: ROLLBACK
[0m14:40:51.485199 [info ] [Thread-3 (]: 42 of 91 PASS accepted_values_stg_yellow_trips_vendor_id__1__2__6 .............. [[32mPASS[0m in 0.10s]
[0m14:40:51.485461 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052)
[0m14:40:51.485750 [debug] [Thread-2 (]: SQL status: OK in 0.043 seconds
[0m14:40:51.486324 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44'
[0m14:40:51.486644 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27
[0m14:40:51.487044 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m14:40:51.488151 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: ROLLBACK
[0m14:40:51.488353 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44: Close
[0m14:40:51.488737 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m14:40:51.491401 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m14:40:51.492212 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total'
[0m14:40:51.492589 [info ] [Thread-1 (]: 40 of 91 PASS accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6  [[32mPASS[0m in 0.11s]
[0m14:40:51.492837 [info ] [Thread-3 (]: 45 of 91 START test not_null_stg_yellow_trips_dropoff_location_id .............. [RUN]
[0m14:40:51.493322 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total: Close
[0m14:40:51.493669 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44
[0m14:40:51.493957 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048)
[0m14:40:51.494380 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m14:40:51.494708 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m14:40:51.495013 [info ] [Thread-1 (]: 46 of 91 START test not_null_stg_yellow_trips_fare_amount ...................... [RUN]
[0m14:40:51.497932 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m14:40:51.498517 [info ] [Thread-2 (]: 43 of 91 PASS assert_fare_not_exceeds_total .................................... [[32mPASS[0m in 0.11s]
[0m14:40:51.498766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97)
[0m14:40:51.499495 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total
[0m14:40:51.499855 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m14:40:51.500078 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m14:40:51.500483 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m14:40:51.501776 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m14:40:51.503885 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m14:40:51.504281 [info ] [Thread-2 (]: 47 of 91 START test not_null_stg_yellow_trips_pickup_datetime .................. [RUN]
[0m14:40:51.505040 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m14:40:51.505505 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed)
[0m14:40:51.506667 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m14:40:51.506951 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m14:40:51.509465 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m14:40:51.510358 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m14:40:51.510583 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m14:40:51.512481 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m14:40:51.512948 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: BEGIN
[0m14:40:51.513487 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m14:40:51.513677 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:51.514407 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: BEGIN
[0m14:40:51.514981 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m14:40:51.515202 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:51.516430 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m14:40:51.516651 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m14:40:51.517078 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: BEGIN
[0m14:40:51.517353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:51.521958 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m14:40:51.522256 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: BEGIN
[0m14:40:51.522581 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:40:51.527857 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m14:40:51.528080 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m14:40:51.528354 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"
[0m14:40:51.528554 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m14:40:51.528759 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m14:40:51.528953 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"
[0m14:40:51.529286 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_datetime
from "dev"."main"."stg_yellow_trips"
where dropoff_datetime is null



  
  
      
    ) dbt_internal_test
[0m14:40:51.529582 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"
[0m14:40:51.530080 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"
[0m14:40:51.530398 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_location_id
from "dev"."main"."stg_yellow_trips"
where dropoff_location_id is null



  
  
      
    ) dbt_internal_test
[0m14:40:51.530851 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fare_amount
from "dev"."main"."stg_yellow_trips"
where fare_amount is null



  
  
      
    ) dbt_internal_test
[0m14:40:51.531225 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "dev"."main"."stg_yellow_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m14:40:51.531457 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:51.532303 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:40:51.532598 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:40:51.533847 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: ROLLBACK
[0m14:40:51.534061 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:40:51.534929 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: ROLLBACK
[0m14:40:51.535871 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: ROLLBACK
[0m14:40:51.536333 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052'
[0m14:40:51.536982 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: ROLLBACK
[0m14:40:51.537390 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048'
[0m14:40:51.537964 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97'
[0m14:40:51.538229 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052: Close
[0m14:40:51.538697 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed'
[0m14:40:51.538959 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048: Close
[0m14:40:51.539217 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97: Close
[0m14:40:51.539636 [info ] [Thread-4 (]: 44 of 91 PASS not_null_stg_yellow_trips_dropoff_datetime ....................... [[32mPASS[0m in 0.05s]
[0m14:40:51.539872 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed: Close
[0m14:40:51.540308 [info ] [Thread-3 (]: 45 of 91 PASS not_null_stg_yellow_trips_dropoff_location_id .................... [[32mPASS[0m in 0.05s]
[0m14:40:51.540607 [info ] [Thread-1 (]: 46 of 91 PASS not_null_stg_yellow_trips_fare_amount ............................ [[32mPASS[0m in 0.04s]
[0m14:40:51.540999 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052
[0m14:40:51.541486 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048
[0m14:40:51.541811 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97
[0m14:40:51.542275 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m14:40:51.542611 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m14:40:51.543073 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m14:40:51.543454 [info ] [Thread-2 (]: 47 of 91 PASS not_null_stg_yellow_trips_pickup_datetime ........................ [[32mPASS[0m in 0.04s]
[0m14:40:51.543654 [info ] [Thread-4 (]: 48 of 91 START test not_null_stg_yellow_trips_pickup_location_id ............... [RUN]
[0m14:40:51.543966 [info ] [Thread-3 (]: 49 of 91 START test not_null_stg_yellow_trips_total_amount ..................... [RUN]
[0m14:40:51.544247 [info ] [Thread-1 (]: 50 of 91 START test not_null_stg_yellow_trips_trip_distance_miles .............. [RUN]
[0m14:40:51.544733 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed
[0m14:40:51.545036 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1)
[0m14:40:51.545365 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6)
[0m14:40:51.545646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7)
[0m14:40:51.545974 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m14:40:51.546286 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m14:40:51.546574 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m14:40:51.546852 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m14:40:51.547111 [info ] [Thread-2 (]: 51 of 91 START test not_null_stg_yellow_trips_trip_id .......................... [RUN]
[0m14:40:51.549925 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m14:40:51.552066 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m14:40:51.554313 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m14:40:51.554750 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1)
[0m14:40:51.556088 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m14:40:51.557916 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m14:40:51.561174 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m14:40:51.561387 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m14:40:51.562686 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m14:40:51.564106 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m14:40:51.564401 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m14:40:51.565718 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m14:40:51.565926 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m14:40:51.567774 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m14:40:51.568614 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m14:40:51.568880 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m14:40:51.569104 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: BEGIN
[0m14:40:51.569430 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: BEGIN
[0m14:40:51.569758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:51.570079 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:51.570325 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m14:40:51.570789 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m14:40:51.571055 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: BEGIN
[0m14:40:51.571286 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: BEGIN
[0m14:40:51.571557 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:51.571836 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:40:51.583258 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m14:40:51.583516 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m14:40:51.583765 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"
[0m14:40:51.583952 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m14:40:51.584133 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m14:40:51.584424 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"
[0m14:40:51.584681 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_location_id
from "dev"."main"."stg_yellow_trips"
where pickup_location_id is null



  
  
      
    ) dbt_internal_test
[0m14:40:51.584932 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"
[0m14:40:51.585177 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"
[0m14:40:51.585473 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_distance_miles
from "dev"."main"."stg_yellow_trips"
where trip_distance_miles is null



  
  
      
    ) dbt_internal_test
[0m14:40:51.585894 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."stg_yellow_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m14:40:51.586208 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."stg_yellow_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m14:40:51.586430 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:51.587129 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:40:51.587414 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:40:51.588279 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: ROLLBACK
[0m14:40:51.588477 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:51.589261 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: ROLLBACK
[0m14:40:51.589991 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: ROLLBACK
[0m14:40:51.590449 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1'
[0m14:40:51.591355 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: ROLLBACK
[0m14:40:51.591773 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7'
[0m14:40:51.592361 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1'
[0m14:40:51.592672 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1: Close
[0m14:40:51.593207 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6'
[0m14:40:51.594785 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6: Close
[0m14:40:51.593956 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1: Close
[0m14:40:51.594549 [info ] [Thread-4 (]: 48 of 91 PASS not_null_stg_yellow_trips_pickup_location_id ..................... [[32mPASS[0m in 0.05s]
[0m14:40:51.593385 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7: Close
[0m14:40:51.595260 [info ] [Thread-3 (]: 49 of 91 PASS not_null_stg_yellow_trips_total_amount ........................... [[32mPASS[0m in 0.05s]
[0m14:40:51.595612 [info ] [Thread-2 (]: 51 of 91 PASS not_null_stg_yellow_trips_trip_id ................................ [[32mPASS[0m in 0.04s]
[0m14:40:51.596157 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1
[0m14:40:51.596721 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6
[0m14:40:51.597062 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1
[0m14:40:51.597372 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m14:40:51.597681 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m14:40:51.598347 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m14:40:51.598781 [info ] [Thread-4 (]: 52 of 91 START test not_null_stg_yellow_trips_vendor_id ........................ [RUN]
[0m14:40:51.599298 [info ] [Thread-1 (]: 50 of 91 PASS not_null_stg_yellow_trips_trip_distance_miles .................... [[32mPASS[0m in 0.05s]
[0m14:40:51.599520 [info ] [Thread-3 (]: 53 of 91 START test unique_stg_yellow_trips_trip_id ............................ [RUN]
[0m14:40:51.599863 [info ] [Thread-2 (]: 54 of 91 START test relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_  [RUN]
[0m14:40:51.600185 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1, now test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57)
[0m14:40:51.600555 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7
[0m14:40:51.600865 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6, now test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965)
[0m14:40:51.601148 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1, now test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a)
[0m14:40:51.601426 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m14:40:51.601673 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m14:40:51.601941 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m14:40:51.602168 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m14:40:51.604787 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m14:40:51.605315 [info ] [Thread-1 (]: 55 of 91 START test relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_  [RUN]
[0m14:40:51.607517 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m14:40:51.611712 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m14:40:51.612549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7, now test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f)
[0m14:40:51.613171 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m14:40:51.615731 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m14:40:51.619306 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m14:40:51.620785 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m14:40:51.621401 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m14:40:51.621814 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m14:40:51.622870 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m14:40:51.623074 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m14:40:51.624469 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m14:40:51.625865 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m14:40:51.626736 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m14:40:51.627026 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: BEGIN
[0m14:40:51.627320 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:40:51.627809 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m14:40:51.628051 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m14:40:51.628257 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: BEGIN
[0m14:40:51.628563 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: BEGIN
[0m14:40:51.628847 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:51.629044 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m14:40:51.629338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:51.629707 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: BEGIN
[0m14:40:51.630022 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:51.640524 [debug] [Thread-2 (]: SQL status: OK in 0.013 seconds
[0m14:40:51.640807 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m14:40:51.641040 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m14:40:51.641235 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"
[0m14:40:51.641401 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m14:40:51.642098 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"
[0m14:40:51.642422 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"
[0m14:40:51.642718 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select dropoff_location_id as from_field
    from "dev"."main"."stg_yellow_trips"
    where dropoff_location_id is not null
),

parent as (
    select location_id as to_field
    from "dev"."main"."stg_taxi_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:40:51.643129 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"
[0m14:40:51.643447 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_yellow_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:40:51.644006 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select pickup_location_id as from_field
    from "dev"."main"."stg_yellow_trips"
    where pickup_location_id is not null
),

parent as (
    select location_id as to_field
    from "dev"."main"."stg_taxi_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:40:51.644612 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "dev"."main"."stg_yellow_trips"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m14:40:51.645886 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:40:51.649560 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: ROLLBACK
[0m14:40:51.652473 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57'
[0m14:40:51.654639 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57: Close
[0m14:40:51.655765 [info ] [Thread-4 (]: 52 of 91 PASS not_null_stg_yellow_trips_vendor_id .............................. [[32mPASS[0m in 0.06s]
[0m14:40:51.658133 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57
[0m14:40:51.746686 [debug] [Thread-2 (]: SQL status: OK in 0.102 seconds
[0m14:40:51.747210 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m14:40:51.748428 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: ROLLBACK
[0m14:40:51.749399 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: ROLLBACK
[0m14:40:51.750063 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a'
[0m14:40:51.750925 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f'
[0m14:40:51.751396 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a: Close
[0m14:40:51.751826 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f: Close
[0m14:40:51.752412 [info ] [Thread-2 (]: 54 of 91 PASS relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_  [[32mPASS[0m in 0.15s]
[0m14:40:51.752975 [info ] [Thread-1 (]: 55 of 91 PASS relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_  [[32mPASS[0m in 0.14s]
[0m14:40:51.754055 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a
[0m14:40:51.760265 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f
[0m14:40:51.774746 [debug] [Thread-3 (]: SQL status: OK in 0.130 seconds
[0m14:40:51.776415 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: ROLLBACK
[0m14:40:51.777126 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965'
[0m14:40:51.777529 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965: Close
[0m14:40:51.795834 [info ] [Thread-3 (]: 53 of 91 PASS unique_stg_yellow_trips_trip_id .................................. [[32mPASS[0m in 0.19s]
[0m14:40:51.796608 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965
[0m14:40:51.797439 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m14:40:51.797856 [info ] [Thread-4 (]: 56 of 91 START sql view model main.int_trip_metrics ............................ [RUN]
[0m14:40:51.798243 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57, now model.nyc_taxi_pipeline_00.int_trip_metrics)
[0m14:40:51.798562 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m14:40:51.802265 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m14:40:51.806999 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m14:40:51.882539 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m14:40:51.889575 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m14:40:51.889958 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: BEGIN
[0m14:40:51.890232 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:51.908982 [debug] [Thread-4 (]: SQL status: OK in 0.019 seconds
[0m14:40:51.909689 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m14:40:51.910076 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */

  
  create view "dev"."main"."int_trip_metrics__dbt_tmp" as (
    /*
    Intermediate model: Trip-level enrichment with calculated metrics.
    Uses adapter-dispatched macros for cross-dialect compatibility.
*/

with trips as (
    select * from "dev"."main"."stg_yellow_trips"
),

enriched as (
    select
        trip_id,
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        payment_type_id,
        pickup_datetime,
        dropoff_datetime,
        passenger_count,
        trip_distance_miles,
        store_and_fwd_flag,

        -- calculated: duration in minutes
        
    datediff('minute', pickup_datetime, dropoff_datetime)
 as trip_duration_minutes,

        -- calculated: average speed (avoid division by zero)
        case
            when 
    datediff('minute', pickup_datetime, dropoff_datetime)
 > 0
            then round(
                trip_distance_miles / (
    datediff('minute', pickup_datetime, dropoff_datetime)
 / 60.0),
                2
            )
            else null
        end as avg_speed_mph,

        -- calculated: cost per mile
        case
            when trip_distance_miles > 0
            then round(fare_amount / trip_distance_miles, 2)
            else null
        end as cost_per_mile,

        -- calculated: tip percentage
        case
            when fare_amount > 0
            then round((tip_amount / fare_amount) * 100, 2)
            else null
        end as tip_percentage,

        -- time dimensions (using adapter-dispatched macros)
        date_trunc('day', pickup_datetime)::date as pickup_date,
        extract(hour from pickup_datetime) as pickup_hour,
        
    dayname(pickup_datetime)
 as pickup_day_of_week,
        case
            when extract(dow from pickup_datetime) in (0, 6) then true
            else false
        end as is_weekend,

        -- financials passthrough
        fare_amount,
        extra_amount,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount,
        congestion_surcharge,
        airport_fee

    from trips
)

select *
from enriched
where trip_duration_minutes between 1 and 720
  and (avg_speed_mph is null or avg_speed_mph < 100)
  );

[0m14:40:51.911305 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:51.913290 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m14:40:51.913740 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
alter view "dev"."main"."int_trip_metrics" rename to "int_trip_metrics__dbt_backup"
[0m14:40:51.914305 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:40:51.915863 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m14:40:51.916371 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
alter view "dev"."main"."int_trip_metrics__dbt_tmp" rename to "int_trip_metrics"
[0m14:40:51.916843 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:40:51.917633 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: COMMIT
[0m14:40:51.917934 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m14:40:51.918181 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: COMMIT
[0m14:40:51.924234 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m14:40:51.925736 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_trip_metrics"
[0m14:40:51.926099 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_trip_metrics"} */
drop view if exists "dev"."main"."int_trip_metrics__dbt_backup" cascade
[0m14:40:51.928372 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:40:51.929315 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_trip_metrics: Close
[0m14:40:51.961851 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '066604cd-9ab8-44a2-8a50-44ba9a9f563e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a8fa52e420>]}
[0m14:40:51.962549 [info ] [Thread-4 (]: 56 of 91 OK created sql view model main.int_trip_metrics ....................... [[32mOK[0m in 0.16s]
[0m14:40:51.963013 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.int_trip_metrics
[0m14:40:51.963896 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m14:40:51.964179 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m14:40:51.964426 [info ] [Thread-1 (]: 57 of 91 START test assert_trip_duration_positive .............................. [RUN]
[0m14:40:51.964812 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m14:40:51.965046 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m14:40:51.965274 [info ] [Thread-3 (]: 58 of 91 START test dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0  [RUN]
[0m14:40:51.965667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f, now test.nyc_taxi_pipeline_00.assert_trip_duration_positive)
[0m14:40:51.966008 [info ] [Thread-2 (]: 59 of 91 START test dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1  [RUN]
[0m14:40:51.966392 [info ] [Thread-4 (]: 60 of 91 START test not_null_int_trip_metrics_is_weekend ....................... [RUN]
[0m14:40:51.966774 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574)
[0m14:40:51.967107 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m14:40:51.967483 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718)
[0m14:40:51.967924 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_trip_metrics, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed)
[0m14:40:51.968309 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m14:40:51.970186 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m14:40:51.970531 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m14:40:51.970866 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m14:40:51.975279 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m14:40:51.977611 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m14:40:51.979566 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m14:40:51.980537 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m14:40:51.981791 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m14:40:51.985038 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m14:40:51.985245 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m14:40:51.987112 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m14:40:51.987470 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m14:40:51.987673 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m14:40:51.988675 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m14:40:51.989161 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: BEGIN
[0m14:40:51.990262 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m14:40:51.990720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:51.992584 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m14:40:51.993197 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: BEGIN
[0m14:40:51.993428 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m14:40:51.993657 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:51.994008 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: BEGIN
[0m14:40:51.994429 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:40:51.994658 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m14:40:51.994960 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: BEGIN
[0m14:40:51.995226 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:52.004786 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m14:40:52.005057 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m14:40:52.005269 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m14:40:52.005465 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"
[0m14:40:52.005639 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m14:40:52.005991 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"
[0m14:40:52.006331 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"
[0m14:40:52.006611 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.assert_trip_duration_positive"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
    Singular test: No trip should have negative duration.
*/

select
    trip_id,
    pickup_datetime,
    dropoff_datetime,
    trip_duration_minutes
from "dev"."main"."int_trip_metrics"
where trip_duration_minutes < 0
  
  
      
    ) dbt_internal_test
[0m14:40:52.006853 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"
[0m14:40:52.007095 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_trip_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not trip_duration_minutes >= 1
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not trip_duration_minutes <= 720
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m14:40:52.007484 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_trip_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m14:40:52.008007 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."int_trip_metrics"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m14:40:52.008903 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:52.010386 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: ROLLBACK
[0m14:40:52.010680 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:52.012687 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.assert_trip_duration_positive'
[0m14:40:52.014409 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: ROLLBACK
[0m14:40:52.015455 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.assert_trip_duration_positive: Close
[0m14:40:52.017357 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed'
[0m14:40:52.020158 [info ] [Thread-1 (]: 57 of 91 PASS assert_trip_duration_positive .................................... [[32mPASS[0m in 0.05s]
[0m14:40:52.021957 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed: Close
[0m14:40:52.024248 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.assert_trip_duration_positive
[0m14:40:52.025809 [info ] [Thread-4 (]: 60 of 91 PASS not_null_int_trip_metrics_is_weekend ............................. [[32mPASS[0m in 0.06s]
[0m14:40:52.026621 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m14:40:52.028680 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed
[0m14:40:52.030832 [info ] [Thread-1 (]: 61 of 91 START test not_null_int_trip_metrics_pickup_date ...................... [RUN]
[0m14:40:52.033401 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m14:40:52.035161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.assert_trip_duration_positive, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3)
[0m14:40:52.036706 [info ] [Thread-4 (]: 62 of 91 START test not_null_int_trip_metrics_pickup_hour ...................... [RUN]
[0m14:40:52.039581 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m14:40:52.041664 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082)
[0m14:40:52.045980 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m14:40:52.048296 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m14:40:52.054414 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m14:40:52.061164 [debug] [Thread-3 (]: SQL status: OK in 0.052 seconds
[0m14:40:52.062538 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: ROLLBACK
[0m14:40:52.062822 [debug] [Thread-2 (]: SQL status: OK in 0.054 seconds
[0m14:40:52.063359 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574'
[0m14:40:52.064282 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: ROLLBACK
[0m14:40:52.064504 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m14:40:52.064717 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574: Close
[0m14:40:52.064918 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m14:40:52.065544 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718'
[0m14:40:52.066917 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m14:40:52.067477 [info ] [Thread-3 (]: 58 of 91 PASS dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0 ..... [[32mPASS[0m in 0.10s]
[0m14:40:52.068604 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m14:40:52.068923 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718: Close
[0m14:40:52.069447 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574
[0m14:40:52.070098 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m14:40:52.070415 [info ] [Thread-3 (]: 63 of 91 START test not_null_int_trip_metrics_trip_duration_minutes ............ [RUN]
[0m14:40:52.070776 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c)
[0m14:40:52.071197 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m14:40:52.074318 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m14:40:52.075109 [info ] [Thread-2 (]: 59 of 91 PASS dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1  [[32mPASS[0m in 0.11s]
[0m14:40:52.075711 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718
[0m14:40:52.076118 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m14:40:52.076357 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m14:40:52.076856 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: BEGIN
[0m14:40:52.077138 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m14:40:52.077352 [info ] [Thread-2 (]: 64 of 91 START test not_null_int_trip_metrics_trip_id .......................... [RUN]
[0m14:40:52.077704 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:52.077990 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: BEGIN
[0m14:40:52.078318 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718, now test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f)
[0m14:40:52.078814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:52.079140 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m14:40:52.081458 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m14:40:52.082313 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m14:40:52.084331 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m14:40:52.085582 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m14:40:52.086702 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m14:40:52.091804 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m14:40:52.092221 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: BEGIN
[0m14:40:52.092486 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:52.092715 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m14:40:52.093029 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: BEGIN
[0m14:40:52.093261 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:40:52.094518 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m14:40:52.094910 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"
[0m14:40:52.095165 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m14:40:52.095454 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."int_trip_metrics"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m14:40:52.095631 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:40:52.095834 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:40:52.096299 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"
[0m14:40:52.096800 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"
[0m14:40:52.097078 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"
[0m14:40:52.097383 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_trip_metrics"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m14:40:52.097691 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_duration_minutes
from "dev"."main"."int_trip_metrics"
where trip_duration_minutes is null



  
  
      
    ) dbt_internal_test
[0m14:40:52.097913 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:52.098096 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."int_trip_metrics"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m14:40:52.099464 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: ROLLBACK
[0m14:40:52.099941 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:52.100516 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:40:52.101976 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082'
[0m14:40:52.104811 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: ROLLBACK
[0m14:40:52.105870 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: ROLLBACK
[0m14:40:52.107317 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082: Close
[0m14:40:52.108370 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3'
[0m14:40:52.111232 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f'
[0m14:40:52.113063 [info ] [Thread-4 (]: 62 of 91 PASS not_null_int_trip_metrics_pickup_hour ............................ [[32mPASS[0m in 0.07s]
[0m14:40:52.114788 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3: Close
[0m14:40:52.115919 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f: Close
[0m14:40:52.118572 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082
[0m14:40:52.121100 [info ] [Thread-1 (]: 61 of 91 PASS not_null_int_trip_metrics_pickup_date ............................ [[32mPASS[0m in 0.09s]
[0m14:40:52.122810 [info ] [Thread-2 (]: 64 of 91 PASS not_null_int_trip_metrics_trip_id ................................ [[32mPASS[0m in 0.04s]
[0m14:40:52.125374 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3
[0m14:40:52.128065 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f
[0m14:40:52.152322 [debug] [Thread-3 (]: SQL status: OK in 0.054 seconds
[0m14:40:52.153680 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: ROLLBACK
[0m14:40:52.154456 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c'
[0m14:40:52.154747 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c: Close
[0m14:40:52.158662 [info ] [Thread-3 (]: 63 of 91 PASS not_null_int_trip_metrics_trip_duration_minutes .................. [[32mPASS[0m in 0.09s]
[0m14:40:52.159250 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c
[0m14:40:52.159970 [debug] [Thread-4 (]: Began running node model.nyc_taxi_pipeline_00.int_daily_summary
[0m14:40:52.160209 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m14:40:52.160404 [debug] [Thread-2 (]: Began running node model.nyc_taxi_pipeline_00.fct_trips
[0m14:40:52.160684 [info ] [Thread-4 (]: 65 of 91 START sql view model main.int_daily_summary ........................... [RUN]
[0m14:40:52.161117 [info ] [Thread-1 (]: 66 of 91 START sql view model main.int_hourly_patterns ......................... [RUN]
[0m14:40:52.161504 [info ] [Thread-2 (]: 67 of 91 START sql incremental model main.fct_trips ............................ [RUN]
[0m14:40:52.161882 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082, now model.nyc_taxi_pipeline_00.int_daily_summary)
[0m14:40:52.162224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3, now model.nyc_taxi_pipeline_00.int_hourly_patterns)
[0m14:40:52.162532 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f, now model.nyc_taxi_pipeline_00.fct_trips)
[0m14:40:52.162798 [debug] [Thread-4 (]: Began compiling node model.nyc_taxi_pipeline_00.int_daily_summary
[0m14:40:52.163067 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m14:40:52.163383 [debug] [Thread-2 (]: Began compiling node model.nyc_taxi_pipeline_00.fct_trips
[0m14:40:52.165062 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m14:40:52.166514 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m14:40:52.170264 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.fct_trips"
[0m14:40:52.173722 [debug] [Thread-4 (]: Began executing node model.nyc_taxi_pipeline_00.int_daily_summary
[0m14:40:52.173951 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m14:40:52.175640 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m14:40:52.177499 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m14:40:52.177740 [debug] [Thread-2 (]: Began executing node model.nyc_taxi_pipeline_00.fct_trips
[0m14:40:52.194483 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m14:40:52.195006 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
DESCRIBE (select * from (
        /*
    Fact table: Fully enriched trip records with location names.
    Incremental with delete+insert strategy.
*/



with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

pickup_locations as (
    select * from "dev"."main"."dim_locations"
),

dropoff_locations as (
    select * from "dev"."main"."dim_locations"
),

final as (
    select
        t.trip_id,
        t.vendor_id,
        t.rate_code_id,
        t.payment_type_id,
        t.pickup_location_id,
        t.dropoff_location_id,
        t.pickup_datetime,
        t.dropoff_datetime,
        t.pickup_date,
        t.pickup_hour,
        t.pickup_day_of_week,
        t.is_weekend,
        t.passenger_count,
        t.trip_distance_miles,
        t.trip_duration_minutes,
        t.avg_speed_mph,
        t.cost_per_mile,
        t.fare_amount,
        t.extra_amount,
        t.mta_tax,
        t.tip_amount,
        t.tip_percentage,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.congestion_surcharge,
        t.airport_fee,

        -- enriched from dimensions
        pu.borough as pickup_borough,
        pu.zone_name as pickup_zone,
        do_loc.borough as dropoff_borough,
        do_loc.zone_name as dropoff_zone

    from trip_metrics t
    left join pickup_locations pu
        on t.pickup_location_id = pu.location_id
    left join dropoff_locations do_loc
        on t.dropoff_location_id = do_loc.location_id

    
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:40:52.195331 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:40:52.195601 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m14:40:52.196057 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: BEGIN
[0m14:40:52.196355 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:52.196897 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m14:40:52.197165 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: BEGIN
[0m14:40:52.197415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:52.211701 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m14:40:52.212069 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m14:40:52.212347 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m14:40:52.212661 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m14:40:52.212859 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m14:40:52.213157 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */

  
  create view "dev"."main"."int_daily_summary__dbt_tmp" as (
    /*
    Intermediate model: Daily aggregated trip and revenue metrics.
    One row per day with counts, averages, and revenue totals.
*/

with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

daily_agg as (
    select
        pickup_date,
        pickup_day_of_week,
        is_weekend,

        count(*) as total_trips,
        sum(passenger_count) as total_passengers,

        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(avg(avg_speed_mph), 2) as avg_speed_mph,

        round(sum(fare_amount), 2) as total_fare_revenue,
        round(sum(tip_amount), 2) as total_tip_revenue,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_trip_revenue,
        round(avg(tip_percentage), 2) as avg_tip_percentage,

        count(case when payment_type_id = 1 then 1 end) as credit_card_trips,
        count(case when payment_type_id = 2 then 1 end) as cash_trips

    from trip_metrics
    group by pickup_date, pickup_day_of_week, is_weekend
)

select * from daily_agg
  );

[0m14:40:52.214767 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m14:40:52.214993 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */

  
  create view "dev"."main"."int_hourly_patterns__dbt_tmp" as (
    /*
    Intermediate model: Hourly trip patterns by date.
    One row per date + hour combination.
*/

with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

hourly_agg as (
    select
        pickup_date,
        pickup_hour,
        pickup_day_of_week,
        is_weekend,

        count(*) as total_trips,
        round(avg(trip_distance_miles), 2) as avg_distance,
        round(avg(trip_duration_minutes), 2) as avg_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue

    from trip_metrics
    group by pickup_date, pickup_hour, pickup_day_of_week, is_weekend
)

select * from hourly_agg
  );

[0m14:40:52.215698 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as varchar)
 as trip_id, 
      
    cast(null as integer)
 as vendor_id, 
      
    cast(null as integer)
 as rate_code_id, 
      
    cast(null as integer)
 as payment_type_id, 
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as integer)
 as dropoff_location_id, 
      
    cast(null as timestamp)
 as pickup_datetime, 
      
    cast(null as timestamp)
 as dropoff_datetime, 
      
    cast(null as date)
 as pickup_date, 
      
    cast(null as bigint)
 as pickup_hour, 
      
    cast(null as varchar)
 as pickup_day_of_week, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as integer)
 as passenger_count, 
      
    cast(null as double)
 as trip_distance_miles, 
      
    cast(null as bigint)
 as trip_duration_minutes, 
      
    cast(null as double)
 as avg_speed_mph, 
      
    cast(null as double)
 as cost_per_mile, 
      
    cast(null as decimal(10,2))
 as fare_amount, 
      
    cast(null as decimal(10,2))
 as extra_amount, 
      
    cast(null as decimal(10,2))
 as mta_tax, 
      
    cast(null as decimal(10,2))
 as tip_amount, 
      
    cast(null as double)
 as tip_percentage, 
      
    cast(null as decimal(10,2))
 as tolls_amount, 
      
    cast(null as decimal(10,2))
 as improvement_surcharge, 
      
    cast(null as decimal(10,2))
 as total_amount, 
      
    cast(null as decimal(10,2))
 as congestion_surcharge, 
      
    cast(null as decimal(10,2))
 as airport_fee, 
      
    cast(null as varchar)
 as pickup_borough, 
      
    cast(null as varchar)
 as pickup_zone, 
      
    cast(null as varchar)
 as dropoff_borough, 
      
    cast(null as varchar)
 as dropoff_zone
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:40:52.216426 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:52.216805 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:52.217133 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:40:52.218874 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m14:40:52.220507 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m14:40:52.222965 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.fct_trips"
[0m14:40:52.223186 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
alter view "dev"."main"."int_daily_summary" rename to "int_daily_summary__dbt_backup"
[0m14:40:52.223848 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
alter view "dev"."main"."int_hourly_patterns" rename to "int_hourly_patterns__dbt_backup"
[0m14:40:52.225031 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:40:52.225529 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:40:52.227076 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m14:40:52.228659 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m14:40:52.229049 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
alter view "dev"."main"."int_daily_summary__dbt_tmp" rename to "int_daily_summary"
[0m14:40:52.229543 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
alter view "dev"."main"."int_hourly_patterns__dbt_tmp" rename to "int_hourly_patterns"
[0m14:40:52.230400 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:40:52.230636 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m14:40:52.230838 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:52.231499 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: COMMIT
[0m14:40:52.231849 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: BEGIN
[0m14:40:52.232619 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: COMMIT
[0m14:40:52.232921 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m14:40:52.233480 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:40:52.233672 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m14:40:52.234043 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: COMMIT
[0m14:40:52.234275 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m14:40:52.234532 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: COMMIT
[0m14:40:52.235015 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */

  
    
    
      
    

    create  table
      "dev"."main"."fct_trips__dbt_tmp"
  
  (
    trip_id varchar,
    vendor_id integer,
    rate_code_id integer,
    payment_type_id integer,
    pickup_location_id integer,
    dropoff_location_id integer,
    pickup_datetime timestamp,
    dropoff_datetime timestamp,
    pickup_date date,
    pickup_hour bigint,
    pickup_day_of_week varchar,
    is_weekend boolean,
    passenger_count integer,
    trip_distance_miles double,
    trip_duration_minutes bigint,
    avg_speed_mph double,
    cost_per_mile double,
    fare_amount decimal(10,2),
    extra_amount decimal(10,2),
    mta_tax decimal(10,2),
    tip_amount decimal(10,2),
    tip_percentage double,
    tolls_amount decimal(10,2),
    improvement_surcharge decimal(10,2),
    total_amount decimal(10,2),
    congestion_surcharge decimal(10,2),
    airport_fee decimal(10,2),
    pickup_borough varchar,
    pickup_zone varchar,
    dropoff_borough varchar,
    dropoff_zone varchar
    
    )
 ;
    insert into "dev"."main"."fct_trips__dbt_tmp" 
  (
    
      
      trip_id ,
    
      
      vendor_id ,
    
      
      rate_code_id ,
    
      
      payment_type_id ,
    
      
      pickup_location_id ,
    
      
      dropoff_location_id ,
    
      
      pickup_datetime ,
    
      
      dropoff_datetime ,
    
      
      pickup_date ,
    
      
      pickup_hour ,
    
      
      pickup_day_of_week ,
    
      
      is_weekend ,
    
      
      passenger_count ,
    
      
      trip_distance_miles ,
    
      
      trip_duration_minutes ,
    
      
      avg_speed_mph ,
    
      
      cost_per_mile ,
    
      
      fare_amount ,
    
      
      extra_amount ,
    
      
      mta_tax ,
    
      
      tip_amount ,
    
      
      tip_percentage ,
    
      
      tolls_amount ,
    
      
      improvement_surcharge ,
    
      
      total_amount ,
    
      
      congestion_surcharge ,
    
      
      airport_fee ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      dropoff_borough ,
    
      
      dropoff_zone 
    
  )
 (
      
    select trip_id, vendor_id, rate_code_id, payment_type_id, pickup_location_id, dropoff_location_id, pickup_datetime, dropoff_datetime, pickup_date, pickup_hour, pickup_day_of_week, is_weekend, passenger_count, trip_distance_miles, trip_duration_minutes, avg_speed_mph, cost_per_mile, fare_amount, extra_amount, mta_tax, tip_amount, tip_percentage, tolls_amount, improvement_surcharge, total_amount, congestion_surcharge, airport_fee, pickup_borough, pickup_zone, dropoff_borough, dropoff_zone
    from (
        /*
    Fact table: Fully enriched trip records with location names.
    Incremental with delete+insert strategy.
*/



with trip_metrics as (
    select * from "dev"."main"."int_trip_metrics"
),

pickup_locations as (
    select * from "dev"."main"."dim_locations"
),

dropoff_locations as (
    select * from "dev"."main"."dim_locations"
),

final as (
    select
        t.trip_id,
        t.vendor_id,
        t.rate_code_id,
        t.payment_type_id,
        t.pickup_location_id,
        t.dropoff_location_id,
        t.pickup_datetime,
        t.dropoff_datetime,
        t.pickup_date,
        t.pickup_hour,
        t.pickup_day_of_week,
        t.is_weekend,
        t.passenger_count,
        t.trip_distance_miles,
        t.trip_duration_minutes,
        t.avg_speed_mph,
        t.cost_per_mile,
        t.fare_amount,
        t.extra_amount,
        t.mta_tax,
        t.tip_amount,
        t.tip_percentage,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.congestion_surcharge,
        t.airport_fee,

        -- enriched from dimensions
        pu.borough as pickup_borough,
        pu.zone_name as pickup_zone,
        do_loc.borough as dropoff_borough,
        do_loc.zone_name as dropoff_zone

    from trip_metrics t
    left join pickup_locations pu
        on t.pickup_location_id = pu.location_id
    left join dropoff_locations do_loc
        on t.dropoff_location_id = do_loc.location_id

    
)

select * from final
    ) as model_subq
    );
  
  
  
[0m14:40:52.240215 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m14:40:52.243156 [debug] [Thread-4 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_daily_summary"
[0m14:40:52.245363 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_daily_summary"} */
drop view if exists "dev"."main"."int_daily_summary__dbt_backup" cascade
[0m14:40:52.250525 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m14:40:52.255064 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.int_hourly_patterns"
[0m14:40:52.257354 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns"} */
drop view if exists "dev"."main"."int_hourly_patterns__dbt_backup" cascade
[0m14:40:52.260009 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m14:40:52.262989 [debug] [Thread-4 (]: On model.nyc_taxi_pipeline_00.int_daily_summary: Close
[0m14:40:52.265642 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '066604cd-9ab8-44a2-8a50-44ba9a9f563e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a95c115880>]}
[0m14:40:52.267582 [info ] [Thread-4 (]: 65 of 91 OK created sql view model main.int_daily_summary ...................... [[32mOK[0m in 0.10s]
[0m14:40:52.269939 [debug] [Thread-4 (]: Finished running node model.nyc_taxi_pipeline_00.int_daily_summary
[0m14:40:52.272403 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m14:40:52.272625 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m14:40:52.272858 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m14:40:52.274450 [info ] [Thread-3 (]: 68 of 91 START test dbt_utils_accepted_range_int_daily_summary_total_trips__0 .. [RUN]
[0m14:40:52.276200 [info ] [Thread-4 (]: 69 of 91 START test not_null_int_daily_summary_pickup_date ..................... [RUN]
[0m14:40:52.278642 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.int_hourly_patterns: Close
[0m14:40:52.280507 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863)
[0m14:40:52.282833 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_daily_summary, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686)
[0m14:40:52.284687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '066604cd-9ab8-44a2-8a50-44ba9a9f563e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a8ec1478c0>]}
[0m14:40:52.285943 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m14:40:52.288123 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m14:40:52.290261 [info ] [Thread-1 (]: 66 of 91 OK created sql view model main.int_hourly_patterns .................... [[32mOK[0m in 0.12s]
[0m14:40:52.295322 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m14:40:52.299348 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m14:40:52.301301 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.int_hourly_patterns
[0m14:40:52.307728 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m14:40:52.309917 [info ] [Thread-1 (]: 70 of 91 START test not_null_int_daily_summary_total_revenue ................... [RUN]
[0m14:40:52.311107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.int_hourly_patterns, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50)
[0m14:40:52.313258 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m14:40:52.317635 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m14:40:52.336148 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m14:40:52.340339 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m14:40:52.340943 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m14:40:52.350910 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m14:40:52.351864 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m14:40:52.362544 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m14:40:52.380099 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m14:40:52.381143 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m14:40:52.382065 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: BEGIN
[0m14:40:52.383840 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: BEGIN
[0m14:40:52.386001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:52.391763 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:52.394647 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m14:40:52.396832 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m14:40:52.398135 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"
[0m14:40:52.399317 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"
[0m14:40:52.401033 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "dev"."main"."int_daily_summary"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m14:40:52.402154 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_daily_summary"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m14:40:52.405089 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m14:40:52.409060 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: BEGIN
[0m14:40:52.411495 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:52.410915 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:40:52.416032 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m14:40:52.418207 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: ROLLBACK
[0m14:40:52.421975 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"
[0m14:40:52.425063 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686'
[0m14:40:52.427094 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_daily_summary"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_trips >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m14:40:52.429015 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686: Close
[0m14:40:52.433454 [info ] [Thread-4 (]: 69 of 91 PASS not_null_int_daily_summary_pickup_date ........................... [[32mPASS[0m in 0.15s]
[0m14:40:52.435293 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686
[0m14:40:52.437647 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m14:40:52.439551 [info ] [Thread-4 (]: 71 of 91 START test not_null_int_daily_summary_total_trips ..................... [RUN]
[0m14:40:52.442509 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686, now test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10)
[0m14:40:52.443866 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m14:40:52.448953 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m14:40:52.482067 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m14:40:52.485870 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m14:40:52.528086 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m14:40:52.528836 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: BEGIN
[0m14:40:52.529365 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:52.530069 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:52.530512 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"
[0m14:40:52.530939 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_trips
from "dev"."main"."int_daily_summary"
where total_trips is null



  
  
      
    ) dbt_internal_test
[0m14:40:52.601952 [debug] [Thread-1 (]: SQL status: OK in 0.199 seconds
[0m14:40:52.603494 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: ROLLBACK
[0m14:40:52.604040 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50'
[0m14:40:52.604354 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50: Close
[0m14:40:52.604957 [info ] [Thread-1 (]: 70 of 91 PASS not_null_int_daily_summary_total_revenue ......................... [[32mPASS[0m in 0.29s]
[0m14:40:52.605740 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50
[0m14:40:52.606080 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m14:40:52.606565 [info ] [Thread-1 (]: 72 of 91 START test unique_int_daily_summary_pickup_date ....................... [RUN]
[0m14:40:52.606914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50, now test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e)
[0m14:40:52.607516 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m14:40:52.610137 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m14:40:52.617791 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m14:40:52.620268 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m14:40:52.628058 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m14:40:52.628443 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: BEGIN
[0m14:40:52.628747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:52.629261 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:52.629532 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"
[0m14:40:52.629787 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pickup_date as unique_field,
    count(*) as n_records

from "dev"."main"."int_daily_summary"
where pickup_date is not null
group by pickup_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:40:52.663745 [debug] [Thread-3 (]: SQL status: OK in 0.232 seconds
[0m14:40:52.665248 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: ROLLBACK
[0m14:40:52.665907 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863'
[0m14:40:52.666193 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863: Close
[0m14:40:52.666664 [info ] [Thread-3 (]: 68 of 91 PASS dbt_utils_accepted_range_int_daily_summary_total_trips__0 ........ [[32mPASS[0m in 0.39s]
[0m14:40:52.667423 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863
[0m14:40:52.668378 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m14:40:52.668917 [info ] [Thread-3 (]: 73 of 91 START test dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0  [RUN]
[0m14:40:52.669319 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863, now test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe)
[0m14:40:52.669642 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m14:40:52.671986 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m14:40:52.677712 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m14:40:52.679220 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m14:40:52.686733 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m14:40:52.687159 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: BEGIN
[0m14:40:52.687625 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:52.688308 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:52.688625 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"
[0m14:40:52.688883 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."int_hourly_patterns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not pickup_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m14:40:52.700992 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m14:40:52.702390 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: ROLLBACK
[0m14:40:52.703049 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe'
[0m14:40:52.703299 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe: Close
[0m14:40:52.703868 [info ] [Thread-3 (]: 73 of 91 PASS dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0 .. [[32mPASS[0m in 0.03s]
[0m14:40:52.704304 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe
[0m14:40:52.704871 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m14:40:52.705423 [info ] [Thread-3 (]: 74 of 91 START test not_null_int_hourly_patterns_pickup_date ................... [RUN]
[0m14:40:52.705806 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2)
[0m14:40:52.706335 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m14:40:52.708759 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m14:40:52.715703 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m14:40:52.717626 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m14:40:52.724122 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m14:40:52.724476 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: BEGIN
[0m14:40:52.724779 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:52.725404 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:52.725748 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"
[0m14:40:52.726030 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "dev"."main"."int_hourly_patterns"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m14:40:52.728177 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:40:52.729300 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: ROLLBACK
[0m14:40:52.730034 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2'
[0m14:40:52.730398 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2: Close
[0m14:40:52.730875 [info ] [Thread-3 (]: 74 of 91 PASS not_null_int_hourly_patterns_pickup_date ......................... [[32mPASS[0m in 0.03s]
[0m14:40:52.731463 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2
[0m14:40:52.731958 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m14:40:52.732450 [info ] [Thread-3 (]: 75 of 91 START test not_null_int_hourly_patterns_pickup_hour ................... [RUN]
[0m14:40:52.732966 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d)
[0m14:40:52.733377 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m14:40:52.735918 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m14:40:52.738849 [debug] [Thread-4 (]: SQL status: OK in 0.207 seconds
[0m14:40:52.739981 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: ROLLBACK
[0m14:40:52.740603 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10'
[0m14:40:52.740882 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10: Close
[0m14:40:52.741281 [info ] [Thread-4 (]: 71 of 91 PASS not_null_int_daily_summary_total_trips ........................... [[32mPASS[0m in 0.30s]
[0m14:40:52.741765 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10
[0m14:40:52.742559 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m14:40:52.743361 [info ] [Thread-4 (]: 76 of 91 START test not_null_int_hourly_patterns_total_trips ................... [RUN]
[0m14:40:52.743790 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10, now test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf)
[0m14:40:52.744339 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m14:40:52.746716 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m14:40:52.746972 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m14:40:52.748514 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m14:40:52.753683 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m14:40:52.754954 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m14:40:52.756351 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m14:40:52.756693 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: BEGIN
[0m14:40:52.757262 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:52.757865 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:52.758285 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"
[0m14:40:52.758716 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."int_hourly_patterns"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m14:40:52.759772 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m14:40:52.760172 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: BEGIN
[0m14:40:52.760825 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:52.761346 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:40:52.761588 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:52.762666 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: ROLLBACK
[0m14:40:52.763001 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"
[0m14:40:52.763869 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d'
[0m14:40:52.764110 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_trips
from "dev"."main"."int_hourly_patterns"
where total_trips is null



  
  
      
    ) dbt_internal_test
[0m14:40:52.764498 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d: Close
[0m14:40:52.765200 [info ] [Thread-3 (]: 75 of 91 PASS not_null_int_hourly_patterns_pickup_hour ......................... [[32mPASS[0m in 0.03s]
[0m14:40:52.765635 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d
[0m14:40:52.770004 [debug] [Thread-1 (]: SQL status: OK in 0.140 seconds
[0m14:40:52.771124 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: ROLLBACK
[0m14:40:52.772148 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e'
[0m14:40:52.772646 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e: Close
[0m14:40:52.773144 [info ] [Thread-1 (]: 72 of 91 PASS unique_int_daily_summary_pickup_date ............................. [[32mPASS[0m in 0.17s]
[0m14:40:52.773791 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e
[0m14:40:52.774459 [debug] [Thread-3 (]: Began running node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m14:40:52.775370 [info ] [Thread-3 (]: 77 of 91 START sql table model main.mart_daily_revenue ......................... [RUN]
[0m14:40:52.775754 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d, now model.nyc_taxi_pipeline_00.mart_daily_revenue)
[0m14:40:52.776208 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m14:40:52.778104 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m14:40:52.783855 [debug] [Thread-3 (]: Began executing node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m14:40:52.787343 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m14:40:52.787823 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Daily revenue metrics with running totals.
*/

with daily as (
    select * from "dev"."main"."int_daily_summary"
),

dates as (
    select * from "dev"."main"."dim_dates"
),

final as (
    select
        d.date_key,
        d.day_of_week_name,
        d.is_weekend,
        d.is_holiday,
        d.week_of_year,

        daily.total_trips,
        daily.total_passengers,
        daily.total_fare_revenue,
        daily.total_tip_revenue,
        daily.total_revenue,
        daily.avg_trip_revenue,
        daily.avg_tip_percentage,
        daily.credit_card_trips,
        daily.cash_trips,
        daily.avg_trip_distance,
        daily.avg_trip_duration_min,

        -- running total
        sum(daily.total_revenue) over (order by d.date_key) as cumulative_revenue,

        -- day-over-day change
        daily.total_revenue - lag(daily.total_revenue) over (order by d.date_key) as revenue_change_vs_prior_day

    from daily
    inner join dates d
        on daily.pickup_date = d.date_key
)

select * from final
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:40:52.788243 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:52.790196 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:40:52.792526 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m14:40:52.792900 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as date)
 as date_key, 
      
    cast(null as varchar)
 as day_of_week_name, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as boolean)
 as is_holiday, 
      
    cast(null as bigint)
 as week_of_year, 
      
    cast(null as bigint)
 as total_trips, 
      
    cast(null as hugeint)
 as total_passengers, 
      
    cast(null as decimal(38,2))
 as total_fare_revenue, 
      
    cast(null as decimal(38,2))
 as total_tip_revenue, 
      
    cast(null as decimal(38,2))
 as total_revenue, 
      
    cast(null as double)
 as avg_trip_revenue, 
      
    cast(null as double)
 as avg_tip_percentage, 
      
    cast(null as bigint)
 as credit_card_trips, 
      
    cast(null as bigint)
 as cash_trips, 
      
    cast(null as double)
 as avg_trip_distance, 
      
    cast(null as double)
 as avg_trip_duration_min, 
      
    cast(null as decimal(38,2))
 as cumulative_revenue, 
      
    cast(null as decimal(38,2))
 as revenue_change_vs_prior_day
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:40:52.793541 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:40:52.795473 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m14:40:52.803113 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m14:40:52.803500 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: BEGIN
[0m14:40:52.803973 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:40:52.804283 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m14:40:52.804605 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_daily_revenue__dbt_tmp"
  
  (
    date_key date,
    day_of_week_name varchar,
    is_weekend boolean,
    is_holiday boolean,
    week_of_year bigint,
    total_trips bigint,
    total_passengers hugeint,
    total_fare_revenue decimal(38,2),
    total_tip_revenue decimal(38,2),
    total_revenue decimal(38,2),
    avg_trip_revenue double,
    avg_tip_percentage double,
    credit_card_trips bigint,
    cash_trips bigint,
    avg_trip_distance double,
    avg_trip_duration_min double,
    cumulative_revenue decimal(38,2),
    revenue_change_vs_prior_day decimal(38,2)
    
    )
 ;
    insert into "dev"."main"."mart_daily_revenue__dbt_tmp" 
  (
    
      
      date_key ,
    
      
      day_of_week_name ,
    
      
      is_weekend ,
    
      
      is_holiday ,
    
      
      week_of_year ,
    
      
      total_trips ,
    
      
      total_passengers ,
    
      
      total_fare_revenue ,
    
      
      total_tip_revenue ,
    
      
      total_revenue ,
    
      
      avg_trip_revenue ,
    
      
      avg_tip_percentage ,
    
      
      credit_card_trips ,
    
      
      cash_trips ,
    
      
      avg_trip_distance ,
    
      
      avg_trip_duration_min ,
    
      
      cumulative_revenue ,
    
      
      revenue_change_vs_prior_day 
    
  )
 (
      
    select date_key, day_of_week_name, is_weekend, is_holiday, week_of_year, total_trips, total_passengers, total_fare_revenue, total_tip_revenue, total_revenue, avg_trip_revenue, avg_tip_percentage, credit_card_trips, cash_trips, avg_trip_distance, avg_trip_duration_min, cumulative_revenue, revenue_change_vs_prior_day
    from (
        /*
    Analytics mart: Daily revenue metrics with running totals.
*/

with daily as (
    select * from "dev"."main"."int_daily_summary"
),

dates as (
    select * from "dev"."main"."dim_dates"
),

final as (
    select
        d.date_key,
        d.day_of_week_name,
        d.is_weekend,
        d.is_holiday,
        d.week_of_year,

        daily.total_trips,
        daily.total_passengers,
        daily.total_fare_revenue,
        daily.total_tip_revenue,
        daily.total_revenue,
        daily.avg_trip_revenue,
        daily.avg_tip_percentage,
        daily.credit_card_trips,
        daily.cash_trips,
        daily.avg_trip_distance,
        daily.avg_trip_duration_min,

        -- running total
        sum(daily.total_revenue) over (order by d.date_key) as cumulative_revenue,

        -- day-over-day change
        daily.total_revenue - lag(daily.total_revenue) over (order by d.date_key) as revenue_change_vs_prior_day

    from daily
    inner join dates d
        on daily.pickup_date = d.date_key
)

select * from final
    ) as model_subq
    );
  
  
[0m14:40:52.866626 [debug] [Thread-4 (]: SQL status: OK in 0.102 seconds
[0m14:40:52.868745 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: ROLLBACK
[0m14:40:52.869940 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf'
[0m14:40:52.870442 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf: Close
[0m14:40:52.871602 [info ] [Thread-4 (]: 76 of 91 PASS not_null_int_hourly_patterns_total_trips ......................... [[32mPASS[0m in 0.13s]
[0m14:40:52.872500 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf
[0m14:40:52.873692 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m14:40:52.879640 [info ] [Thread-1 (]: 78 of 91 START sql table model main.mart_hourly_demand ......................... [RUN]
[0m14:40:52.880353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e, now model.nyc_taxi_pipeline_00.mart_hourly_demand)
[0m14:40:52.881169 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m14:40:52.883356 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m14:40:52.891624 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m14:40:52.894379 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m14:40:52.894868 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Hourly demand patterns.
*/

with hourly as (
    select * from "dev"."main"."int_hourly_patterns"
),

final as (
    select
        pickup_hour,
        is_weekend,

        count(*) as days_observed,
        round(avg(total_trips), 0) as avg_trips_per_period,
        round(avg(avg_distance), 2) as avg_distance,
        round(avg(avg_duration_min), 2) as avg_duration_min,
        round(avg(total_revenue), 2) as avg_revenue_per_period,
        sum(total_trips) as total_trips_all_days

    from hourly
    group by pickup_hour, is_weekend
)

select * from final
order by is_weekend, pickup_hour
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:40:52.895251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:52.897025 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:40:52.898580 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m14:40:52.899125 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as bigint)
 as pickup_hour, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as bigint)
 as days_observed, 
      
    cast(null as double)
 as avg_trips_per_period, 
      
    cast(null as double)
 as avg_distance, 
      
    cast(null as double)
 as avg_duration_min, 
      
    cast(null as double)
 as avg_revenue_per_period, 
      
    cast(null as hugeint)
 as total_trips_all_days
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:40:52.899883 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:40:52.901263 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m14:40:52.908066 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m14:40:52.908349 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: BEGIN
[0m14:40:52.908836 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:40:52.909117 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m14:40:52.909407 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_hourly_demand__dbt_tmp"
  
  (
    pickup_hour bigint,
    is_weekend boolean,
    days_observed bigint,
    avg_trips_per_period double,
    avg_distance double,
    avg_duration_min double,
    avg_revenue_per_period double,
    total_trips_all_days hugeint
    
    )
 ;
    insert into "dev"."main"."mart_hourly_demand__dbt_tmp" 
  (
    
      
      pickup_hour ,
    
      
      is_weekend ,
    
      
      days_observed ,
    
      
      avg_trips_per_period ,
    
      
      avg_distance ,
    
      
      avg_duration_min ,
    
      
      avg_revenue_per_period ,
    
      
      total_trips_all_days 
    
  )
 (
      
    select pickup_hour, is_weekend, days_observed, avg_trips_per_period, avg_distance, avg_duration_min, avg_revenue_per_period, total_trips_all_days
    from (
        /*
    Analytics mart: Hourly demand patterns.
*/

with hourly as (
    select * from "dev"."main"."int_hourly_patterns"
),

final as (
    select
        pickup_hour,
        is_weekend,

        count(*) as days_observed,
        round(avg(total_trips), 0) as avg_trips_per_period,
        round(avg(avg_distance), 2) as avg_distance,
        round(avg(avg_duration_min), 2) as avg_duration_min,
        round(avg(total_revenue), 2) as avg_revenue_per_period,
        sum(total_trips) as total_trips_all_days

    from hourly
    group by pickup_hour, is_weekend
)

select * from final
order by is_weekend, pickup_hour
    ) as model_subq
    );
  
  
[0m14:40:52.991723 [debug] [Thread-3 (]: SQL status: OK in 0.187 seconds
[0m14:40:52.994003 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m14:40:52.994676 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
alter table "dev"."main"."mart_daily_revenue" rename to "mart_daily_revenue__dbt_backup"
[0m14:40:52.995801 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:40:52.997709 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m14:40:52.998272 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
alter table "dev"."main"."mart_daily_revenue__dbt_tmp" rename to "mart_daily_revenue"
[0m14:40:52.999084 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:40:52.999969 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: COMMIT
[0m14:40:53.000282 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m14:40:53.000535 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: COMMIT
[0m14:40:53.004167 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:40:53.005407 [debug] [Thread-3 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_daily_revenue"
[0m14:40:53.005748 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue"} */
drop table if exists "dev"."main"."mart_daily_revenue__dbt_backup" cascade
[0m14:40:53.008476 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:40:53.009289 [debug] [Thread-3 (]: On model.nyc_taxi_pipeline_00.mart_daily_revenue: Close
[0m14:40:53.010027 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '066604cd-9ab8-44a2-8a50-44ba9a9f563e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a95c37cf50>]}
[0m14:40:53.010675 [info ] [Thread-3 (]: 77 of 91 OK created sql table model main.mart_daily_revenue .................... [[32mOK[0m in 0.23s]
[0m14:40:53.011441 [debug] [Thread-3 (]: Finished running node model.nyc_taxi_pipeline_00.mart_daily_revenue
[0m14:40:53.012416 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m14:40:53.012669 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m14:40:53.012967 [info ] [Thread-4 (]: 79 of 91 START test not_null_mart_daily_revenue_date_key ....................... [RUN]
[0m14:40:53.013568 [info ] [Thread-3 (]: 80 of 91 START test not_null_mart_daily_revenue_total_revenue .................. [RUN]
[0m14:40:53.014448 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf, now test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a)
[0m14:40:53.015127 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.mart_daily_revenue, now test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9)
[0m14:40:53.015673 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m14:40:53.016230 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m14:40:53.019498 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m14:40:53.021562 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m14:40:53.028206 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m14:40:53.030119 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m14:40:53.030370 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m14:40:53.031865 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m14:40:53.036187 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m14:40:53.036530 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: BEGIN
[0m14:40:53.037150 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:53.037486 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m14:40:53.038065 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:53.038319 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: BEGIN
[0m14:40:53.038717 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"
[0m14:40:53.039057 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:53.039486 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "dev"."main"."mart_daily_revenue"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m14:40:53.040480 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:53.041338 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"
[0m14:40:53.041717 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:53.041951 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "dev"."main"."mart_daily_revenue"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m14:40:53.043105 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: ROLLBACK
[0m14:40:53.044142 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:40:53.044616 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9'
[0m14:40:53.046205 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: ROLLBACK
[0m14:40:53.047000 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9: Close
[0m14:40:53.047890 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a'
[0m14:40:53.048833 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a: Close
[0m14:40:53.048628 [info ] [Thread-3 (]: 80 of 91 PASS not_null_mart_daily_revenue_total_revenue ........................ [[32mPASS[0m in 0.03s]
[0m14:40:53.049497 [info ] [Thread-4 (]: 79 of 91 PASS not_null_mart_daily_revenue_date_key ............................. [[32mPASS[0m in 0.04s]
[0m14:40:53.049977 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9
[0m14:40:53.050390 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a
[0m14:40:53.050825 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m14:40:53.051554 [info ] [Thread-3 (]: 81 of 91 START test unique_mart_daily_revenue_date_key ......................... [RUN]
[0m14:40:53.051938 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9, now test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7)
[0m14:40:53.052272 [debug] [Thread-1 (]: SQL status: OK in 0.142 seconds
[0m14:40:53.052482 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m14:40:53.054270 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m14:40:53.056419 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m14:40:53.056798 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
alter table "dev"."main"."mart_hourly_demand" rename to "mart_hourly_demand__dbt_backup"
[0m14:40:53.057791 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:40:53.059275 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m14:40:53.059599 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
alter table "dev"."main"."mart_hourly_demand__dbt_tmp" rename to "mart_hourly_demand"
[0m14:40:53.060112 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:40:53.060853 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: COMMIT
[0m14:40:53.061137 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m14:40:53.061417 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: COMMIT
[0m14:40:53.063225 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m14:40:53.064486 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m14:40:53.065795 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:40:53.067082 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_hourly_demand"
[0m14:40:53.067411 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand"} */
drop table if exists "dev"."main"."mart_hourly_demand__dbt_backup" cascade
[0m14:40:53.069837 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:40:53.070864 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_hourly_demand: Close
[0m14:40:53.071514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '066604cd-9ab8-44a2-8a50-44ba9a9f563e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a95c37d370>]}
[0m14:40:53.072053 [info ] [Thread-1 (]: 78 of 91 OK created sql table model main.mart_hourly_demand .................... [[32mOK[0m in 0.19s]
[0m14:40:53.072328 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m14:40:53.072630 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.mart_hourly_demand
[0m14:40:53.072957 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: BEGIN
[0m14:40:53.073573 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m14:40:53.073781 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:53.073995 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m14:40:53.074387 [info ] [Thread-4 (]: 82 of 91 START test not_null_mart_hourly_demand_is_weekend ..................... [RUN]
[0m14:40:53.075178 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:40:53.075439 [info ] [Thread-1 (]: 83 of 91 START test not_null_mart_hourly_demand_pickup_hour .................... [RUN]
[0m14:40:53.075841 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a, now test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8)
[0m14:40:53.076159 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"
[0m14:40:53.076525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.mart_hourly_demand, now test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418)
[0m14:40:53.076860 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m14:40:53.077168 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "dev"."main"."mart_daily_revenue"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:40:53.077450 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m14:40:53.079505 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m14:40:53.082576 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m14:40:53.082859 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:40:53.084159 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: ROLLBACK
[0m14:40:53.084817 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7'
[0m14:40:53.085132 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7: Close
[0m14:40:53.085748 [info ] [Thread-3 (]: 81 of 91 PASS unique_mart_daily_revenue_date_key ............................... [[32mPASS[0m in 0.03s]
[0m14:40:53.086161 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7
[0m14:40:53.087736 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m14:40:53.089030 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m14:40:53.089231 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m14:40:53.090556 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m14:40:53.092913 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m14:40:53.093285 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: BEGIN
[0m14:40:53.093538 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:53.093743 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m14:40:53.094206 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:40:53.094612 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: BEGIN
[0m14:40:53.095015 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"
[0m14:40:53.095301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:53.095593 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "dev"."main"."mart_hourly_demand"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m14:40:53.096021 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:53.096428 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"
[0m14:40:53.096704 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:40:53.096877 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_hour
from "dev"."main"."mart_hourly_demand"
where pickup_hour is null



  
  
      
    ) dbt_internal_test
[0m14:40:53.097828 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: ROLLBACK
[0m14:40:53.098368 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8'
[0m14:40:53.098591 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:40:53.098810 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8: Close
[0m14:40:53.099892 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: ROLLBACK
[0m14:40:53.100564 [info ] [Thread-4 (]: 82 of 91 PASS not_null_mart_hourly_demand_is_weekend ........................... [[32mPASS[0m in 0.02s]
[0m14:40:53.101032 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418'
[0m14:40:53.101704 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8
[0m14:40:53.102010 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418: Close
[0m14:40:53.102971 [info ] [Thread-1 (]: 83 of 91 PASS not_null_mart_hourly_demand_pickup_hour .......................... [[32mPASS[0m in 0.03s]
[0m14:40:53.103551 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418
[0m14:40:56.115136 [debug] [Thread-2 (]: SQL status: OK in 3.879 seconds
[0m14:40:56.117565 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m14:40:56.117998 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
alter table "dev"."main"."fct_trips" rename to "fct_trips__dbt_backup"
[0m14:40:56.118566 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:40:56.120156 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m14:40:56.120530 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
alter table "dev"."main"."fct_trips__dbt_tmp" rename to "fct_trips"
[0m14:40:56.121266 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:40:56.122190 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: COMMIT
[0m14:40:56.122652 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m14:40:56.122899 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: COMMIT
[0m14:40:57.088738 [debug] [Thread-2 (]: SQL status: OK in 0.406 seconds
[0m14:40:57.090970 [debug] [Thread-2 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.fct_trips"
[0m14:40:57.091379 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.fct_trips"} */
drop table if exists "dev"."main"."fct_trips__dbt_backup" cascade
[0m14:40:58.167620 [debug] [Thread-2 (]: SQL status: OK in 0.319 seconds
[0m14:40:58.168837 [debug] [Thread-2 (]: On model.nyc_taxi_pipeline_00.fct_trips: Close
[0m14:40:58.195935 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '066604cd-9ab8-44a2-8a50-44ba9a9f563e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a95c1ace90>]}
[0m14:40:58.196893 [info ] [Thread-2 (]: 67 of 91 OK created sql incremental model main.fct_trips ....................... [[32mOK[0m in 6.03s]
[0m14:40:58.197424 [debug] [Thread-2 (]: Finished running node model.nyc_taxi_pipeline_00.fct_trips
[0m14:40:58.198268 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m14:40:58.198497 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m14:40:58.198760 [debug] [Thread-1 (]: Began running node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m14:40:58.198962 [info ] [Thread-3 (]: 84 of 91 START test not_null_fct_trips_pickup_datetime ......................... [RUN]
[0m14:40:58.199200 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m14:40:58.199400 [info ] [Thread-4 (]: 85 of 91 START test not_null_fct_trips_total_amount ............................ [RUN]
[0m14:40:58.199791 [info ] [Thread-1 (]: 86 of 91 START test not_null_fct_trips_trip_id ................................. [RUN]
[0m14:40:58.200267 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7, now test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83)
[0m14:40:58.200658 [info ] [Thread-2 (]: 87 of 91 START test unique_fct_trips_trip_id ................................... [RUN]
[0m14:40:58.201189 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8, now test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d)
[0m14:40:58.201529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418, now test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d)
[0m14:40:58.201840 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m14:40:58.202193 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nyc_taxi_pipeline_00.fct_trips, now test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab)
[0m14:40:58.202475 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m14:40:58.202892 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m14:40:58.205462 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m14:40:58.206073 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m14:40:58.208247 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m14:40:58.210320 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m14:40:58.213625 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m14:40:58.217685 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m14:40:58.218983 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m14:40:58.219196 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m14:40:58.220475 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m14:40:58.220701 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m14:40:58.221932 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m14:40:58.222161 [debug] [Thread-1 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m14:40:58.223452 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m14:40:58.225456 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m14:40:58.225933 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: BEGIN
[0m14:40:58.226201 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m14:40:58.226437 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:58.226827 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m14:40:58.227006 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: BEGIN
[0m14:40:58.227861 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m14:40:58.228080 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: BEGIN
[0m14:40:58.228646 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:40:58.229017 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: BEGIN
[0m14:40:58.229330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:58.229856 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:58.243483 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m14:40:58.243824 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m14:40:58.244078 [debug] [Thread-3 (]: SQL status: OK in 0.018 seconds
[0m14:40:58.244294 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"
[0m14:40:58.244536 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m14:40:58.244842 [debug] [Thread-1 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"
[0m14:40:58.245116 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m14:40:58.245376 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."main"."fct_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:40:58.245619 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"
[0m14:40:58.245881 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "dev"."main"."fct_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m14:40:58.246138 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "dev"."main"."fct_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m14:40:58.246575 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."fct_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m14:40:58.247310 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:40:58.248788 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:40:58.250877 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:40:58.253715 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: ROLLBACK
[0m14:40:58.255573 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: ROLLBACK
[0m14:40:58.257377 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: ROLLBACK
[0m14:40:58.259370 [debug] [Thread-1 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d'
[0m14:40:58.262378 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83'
[0m14:40:58.264793 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d'
[0m14:40:58.267110 [debug] [Thread-1 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d: Close
[0m14:40:58.269076 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83: Close
[0m14:40:58.270311 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d: Close
[0m14:40:58.271899 [info ] [Thread-1 (]: 86 of 91 PASS not_null_fct_trips_trip_id ....................................... [[32mPASS[0m in 0.07s]
[0m14:40:58.274058 [info ] [Thread-3 (]: 84 of 91 PASS not_null_fct_trips_pickup_datetime ............................... [[32mPASS[0m in 0.07s]
[0m14:40:58.276579 [info ] [Thread-4 (]: 85 of 91 PASS not_null_fct_trips_total_amount .................................. [[32mPASS[0m in 0.08s]
[0m14:40:58.277918 [debug] [Thread-1 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d
[0m14:40:58.281140 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83
[0m14:40:58.283234 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d
[0m14:40:58.361440 [debug] [Thread-2 (]: SQL status: OK in 0.115 seconds
[0m14:40:58.363225 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: ROLLBACK
[0m14:40:58.363891 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab'
[0m14:40:58.364387 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab: Close
[0m14:40:58.385334 [info ] [Thread-2 (]: 87 of 91 PASS unique_fct_trips_trip_id ......................................... [[32mPASS[0m in 0.18s]
[0m14:40:58.386358 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab
[0m14:40:58.387331 [debug] [Thread-1 (]: Began running node model.nyc_taxi_pipeline_00.mart_location_performance
[0m14:40:58.387921 [info ] [Thread-1 (]: 88 of 91 START sql table model main.mart_location_performance .................. [RUN]
[0m14:40:58.388350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d, now model.nyc_taxi_pipeline_00.mart_location_performance)
[0m14:40:58.388656 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi_pipeline_00.mart_location_performance
[0m14:40:58.391142 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m14:40:58.397698 [debug] [Thread-1 (]: Began executing node model.nyc_taxi_pipeline_00.mart_location_performance
[0m14:40:58.399708 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m14:40:58.400142 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
DESCRIBE (select * from (
        /*
    Analytics mart: Location-level performance summary.
    Uses adapter-dispatched mode_compat() for cross-dialect support.
*/

with trips as (
    select * from "dev"."main"."fct_trips"
),

final as (
    select
        pickup_location_id,
        pickup_borough,
        pickup_zone,

        count(*) as total_pickups,
        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue_per_trip,
        round(avg(tip_percentage), 2) as avg_tip_pct,
        round(avg(passenger_count), 2) as avg_passengers,

        -- most common dropoff destination
        
    mode(dropoff_zone)
 as most_common_dropoff_zone,

        -- busiest hour
        
    mode(pickup_hour)
 as peak_pickup_hour

    from trips
    where pickup_zone is not null
    group by pickup_location_id, pickup_borough, pickup_zone
)

select * from final
order by total_pickups desc
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:40:58.400507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:58.414850 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m14:40:58.416695 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m14:40:58.417189 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as varchar)
 as pickup_borough, 
      
    cast(null as varchar)
 as pickup_zone, 
      
    cast(null as bigint)
 as total_pickups, 
      
    cast(null as double)
 as avg_trip_distance, 
      
    cast(null as double)
 as avg_trip_duration_min, 
      
    cast(null as decimal(38,2))
 as total_revenue, 
      
    cast(null as double)
 as avg_revenue_per_trip, 
      
    cast(null as double)
 as avg_tip_pct, 
      
    cast(null as double)
 as avg_passengers, 
      
    cast(null as varchar)
 as most_common_dropoff_zone, 
      
    cast(null as bigint)
 as peak_pickup_hour
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:40:58.418202 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:40:58.419634 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m14:40:58.426323 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m14:40:58.426671 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: BEGIN
[0m14:40:58.427242 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:40:58.427630 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m14:40:58.428166 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */

  
    
    
      
    

    create  table
      "dev"."main"."mart_location_performance__dbt_tmp"
  
  (
    pickup_location_id integer,
    pickup_borough varchar,
    pickup_zone varchar,
    total_pickups bigint,
    avg_trip_distance double,
    avg_trip_duration_min double,
    total_revenue decimal(38,2),
    avg_revenue_per_trip double,
    avg_tip_pct double,
    avg_passengers double,
    most_common_dropoff_zone varchar,
    peak_pickup_hour bigint
    
    )
 ;
    insert into "dev"."main"."mart_location_performance__dbt_tmp" 
  (
    
      
      pickup_location_id ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      total_pickups ,
    
      
      avg_trip_distance ,
    
      
      avg_trip_duration_min ,
    
      
      total_revenue ,
    
      
      avg_revenue_per_trip ,
    
      
      avg_tip_pct ,
    
      
      avg_passengers ,
    
      
      most_common_dropoff_zone ,
    
      
      peak_pickup_hour 
    
  )
 (
      
    select pickup_location_id, pickup_borough, pickup_zone, total_pickups, avg_trip_distance, avg_trip_duration_min, total_revenue, avg_revenue_per_trip, avg_tip_pct, avg_passengers, most_common_dropoff_zone, peak_pickup_hour
    from (
        /*
    Analytics mart: Location-level performance summary.
    Uses adapter-dispatched mode_compat() for cross-dialect support.
*/

with trips as (
    select * from "dev"."main"."fct_trips"
),

final as (
    select
        pickup_location_id,
        pickup_borough,
        pickup_zone,

        count(*) as total_pickups,
        round(avg(trip_distance_miles), 2) as avg_trip_distance,
        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,
        round(sum(total_amount), 2) as total_revenue,
        round(avg(total_amount), 2) as avg_revenue_per_trip,
        round(avg(tip_percentage), 2) as avg_tip_pct,
        round(avg(passenger_count), 2) as avg_passengers,

        -- most common dropoff destination
        
    mode(dropoff_zone)
 as most_common_dropoff_zone,

        -- busiest hour
        
    mode(pickup_hour)
 as peak_pickup_hour

    from trips
    where pickup_zone is not null
    group by pickup_location_id, pickup_borough, pickup_zone
)

select * from final
order by total_pickups desc
    ) as model_subq
    );
  
  
[0m14:40:58.543479 [debug] [Thread-1 (]: SQL status: OK in 0.115 seconds
[0m14:40:58.546002 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m14:40:58.546562 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
alter table "dev"."main"."mart_location_performance" rename to "mart_location_performance__dbt_backup"
[0m14:40:58.547371 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:40:58.548844 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m14:40:58.549194 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
alter table "dev"."main"."mart_location_performance__dbt_tmp" rename to "mart_location_performance"
[0m14:40:58.549626 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:40:58.550403 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: COMMIT
[0m14:40:58.550850 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m14:40:58.551146 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: COMMIT
[0m14:40:58.557546 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:40:58.560214 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_taxi_pipeline_00.mart_location_performance"
[0m14:40:58.560671 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "model.nyc_taxi_pipeline_00.mart_location_performance"} */
drop table if exists "dev"."main"."mart_location_performance__dbt_backup" cascade
[0m14:40:58.563338 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:40:58.564302 [debug] [Thread-1 (]: On model.nyc_taxi_pipeline_00.mart_location_performance: Close
[0m14:40:58.605385 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '066604cd-9ab8-44a2-8a50-44ba9a9f563e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a8ec10f290>]}
[0m14:40:58.606304 [info ] [Thread-1 (]: 88 of 91 OK created sql table model main.mart_location_performance ............. [[32mOK[0m in 0.22s]
[0m14:40:58.606827 [debug] [Thread-1 (]: Finished running node model.nyc_taxi_pipeline_00.mart_location_performance
[0m14:40:58.607631 [debug] [Thread-4 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m14:40:58.607962 [debug] [Thread-2 (]: Began running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m14:40:58.608150 [info ] [Thread-4 (]: 89 of 91 START test not_null_mart_location_performance_pickup_location_id ...... [RUN]
[0m14:40:58.608534 [debug] [Thread-3 (]: Began running node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m14:40:58.608761 [info ] [Thread-2 (]: 90 of 91 START test not_null_mart_location_performance_total_pickups ........... [RUN]
[0m14:40:58.609166 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d, now test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c)
[0m14:40:58.609652 [info ] [Thread-3 (]: 91 of 91 START test unique_mart_location_performance_pickup_location_id ........ [RUN]
[0m14:40:58.610066 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab, now test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259)
[0m14:40:58.610380 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m14:40:58.610657 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83, now test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62)
[0m14:40:58.610905 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m14:40:58.613297 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m14:40:58.613776 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m14:40:58.615733 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m14:40:58.618234 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m14:40:58.621566 [debug] [Thread-4 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m14:40:58.621794 [debug] [Thread-2 (]: Began executing node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m14:40:58.622983 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m14:40:58.623222 [debug] [Thread-3 (]: Began executing node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m14:40:58.624280 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m14:40:58.626248 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m14:40:58.628245 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m14:40:58.628459 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m14:40:58.628698 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: BEGIN
[0m14:40:58.629081 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: BEGIN
[0m14:40:58.629415 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:58.629685 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:40:58.629933 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m14:40:58.630411 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: BEGIN
[0m14:40:58.630699 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:58.643416 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m14:40:58.643691 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m14:40:58.643943 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m14:40:58.644144 [debug] [Thread-4 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"
[0m14:40:58.644443 [debug] [Thread-3 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"
[0m14:40:58.644709 [debug] [Thread-2 (]: Using duckdb connection "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"
[0m14:40:58.644965 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_location_id
from "dev"."main"."mart_location_performance"
where pickup_location_id is null



  
  
      
    ) dbt_internal_test
[0m14:40:58.645587 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pickup_location_id as unique_field,
    count(*) as n_records

from "dev"."main"."mart_location_performance"
where pickup_location_id is not null
group by pickup_location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:40:58.645900 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "nyc_taxi_pipeline_00", "target_name": "dev", "node_id": "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_pickups
from "dev"."main"."mart_location_performance"
where total_pickups is null



  
  
      
    ) dbt_internal_test
[0m14:40:58.646607 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:40:58.647830 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: ROLLBACK
[0m14:40:58.648097 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:40:58.648290 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:40:58.648794 [debug] [Thread-4 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c'
[0m14:40:58.649497 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: ROLLBACK
[0m14:40:58.650148 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: ROLLBACK
[0m14:40:58.650319 [debug] [Thread-4 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c: Close
[0m14:40:58.650810 [debug] [Thread-2 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259'
[0m14:40:58.651355 [debug] [Thread-3 (]: Failed to rollback 'test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62'
[0m14:40:58.651796 [info ] [Thread-4 (]: 89 of 91 PASS not_null_mart_location_performance_pickup_location_id ............ [[32mPASS[0m in 0.04s]
[0m14:40:58.652162 [debug] [Thread-2 (]: On test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259: Close
[0m14:40:58.652631 [debug] [Thread-3 (]: On test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62: Close
[0m14:40:58.653099 [debug] [Thread-4 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c
[0m14:40:58.653485 [info ] [Thread-2 (]: 90 of 91 PASS not_null_mart_location_performance_total_pickups ................. [[32mPASS[0m in 0.04s]
[0m14:40:58.654309 [debug] [Thread-2 (]: Finished running node test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259
[0m14:40:58.655856 [info ] [Thread-3 (]: 91 of 91 PASS unique_mart_location_performance_pickup_location_id .............. [[32mPASS[0m in 0.05s]
[0m14:40:58.656427 [debug] [Thread-3 (]: Finished running node test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62
[0m14:40:58.658089 [debug] [MainThread]: Using duckdb connection "master"
[0m14:40:58.658621 [debug] [MainThread]: On master: BEGIN
[0m14:40:58.658865 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:40:58.672887 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m14:40:58.673528 [debug] [MainThread]: On master: COMMIT
[0m14:40:58.673863 [debug] [MainThread]: Using duckdb connection "master"
[0m14:40:58.674144 [debug] [MainThread]: On master: COMMIT
[0m14:40:58.674524 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:40:58.674828 [debug] [MainThread]: On master: Close
[0m14:40:58.677227 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:58.677542 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m14:40:58.677807 [debug] [MainThread]: Connection 'model.nyc_taxi_pipeline_00.mart_location_performance' was properly closed.
[0m14:40:58.678059 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259' was properly closed.
[0m14:40:58.678313 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62' was properly closed.
[0m14:40:58.678541 [debug] [MainThread]: Connection 'test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c' was properly closed.
[0m14:40:58.678975 [info ] [MainThread]: 
[0m14:40:58.679285 [info ] [MainThread]: Finished running 1 incremental model, 3 seeds, 7 table models, 74 data tests, 6 view models in 0 hours 0 minutes and 9.38 seconds (9.38s).
[0m14:40:58.683662 [debug] [MainThread]: Command end result
[0m14:40:58.713877 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:40:58.717347 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:40:58.725037 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m14:40:58.725318 [info ] [MainThread]: 
[0m14:40:58.725667 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:40:58.725929 [info ] [MainThread]: 
[0m14:40:58.726263 [info ] [MainThread]: Done. PASS=91 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=91
[0m14:40:58.727284 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 9.003889, "process_in_blocks": "0", "process_kernel_time": 3.544445, "process_mem_max_rss": "1791508", "process_out_blocks": "136", "process_user_time": 20.210155}
[0m14:40:58.727696 [debug] [MainThread]: Command `dbt build` succeeded at 14:40:58.727616 after 9.00 seconds
[0m14:40:58.728035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a9709f1dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a95c1646e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a970efc200>]}
[0m14:40:58.728312 [debug] [MainThread]: Flushing usage events
[0m14:40:59.093073 [debug] [MainThread]: An error was encountered while trying to flush usage events
