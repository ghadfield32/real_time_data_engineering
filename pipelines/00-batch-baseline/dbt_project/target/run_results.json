{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.4", "generated_at": "2026-02-21T14:40:58.679574Z", "invocation_id": "066604cd-9ab8-44a2-8a50-44ba9a9f563e", "invocation_started_at": "2026-02-21T14:40:48.447558Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:49.500414Z", "completed_at": "2026-02-21T14:40:49.500417Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:49.508288Z", "completed_at": "2026-02-21T14:40:49.626592Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.14704513549804688, "adapter_response": {"_message": "CREATE 7", "code": "CREATE", "rows_affected": 7}, "message": "CREATE 7", "failures": null, "unique_id": "seed.nyc_taxi_pipeline_00.rate_code_lookup", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:49.499744Z", "completed_at": "2026-02-21T14:40:49.499751Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:49.500925Z", "completed_at": "2026-02-21T14:40:49.629522Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.15230870246887207, "adapter_response": {"_message": "CREATE 6", "code": "CREATE", "rows_affected": 6}, "message": "CREATE 6", "failures": null, "unique_id": "seed.nyc_taxi_pipeline_00.payment_type_lookup", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:49.480882Z", "completed_at": "2026-02-21T14:40:49.563663Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:49.565407Z", "completed_at": "2026-02-21T14:40:49.676178Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.20061445236206055, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nyc_taxi_pipeline_00.dim_dates", "compiled": true, "compiled_code": "/*\n    Dimension table: Calendar dates for January 2024.\n    Uses adapter-dispatched macros for dayname/monthname.\n*/\n\nwith date_spine as (\n    \n\n\n\n\n\nwith rawdata as (\n\n    \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 31\n    order by generated_number\n\n\n\n),\n\nall_periods as (\n\n    select (\n        \n\n    date_add(cast('2024-01-01' as date), interval (row_number() over (order by generated_number) - 1) day)\n\n\n    ) as date_day\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_day <= cast('2024-02-01' as date)\n\n)\n\nselect * from filtered\n\n\n),\n\nfinal as (\n    select\n        cast(date_day as date) as date_key,\n        extract(year from date_day) as year,\n        extract(month from date_day) as month,\n        extract(day from date_day) as day_of_month,\n        extract(dow from date_day) as day_of_week_num,\n        \n    dayname(date_day)\n as day_of_week_name,\n        \n    monthname(date_day)\n as month_name,\n        extract(week from date_day) as week_of_year,\n        case\n            when extract(dow from date_day) in (0, 6) then true\n            else false\n        end as is_weekend,\n        case\n            when cast(date_day as date) in (\n                cast('2024-01-01' as date),\n                cast('2024-01-15' as date)\n            ) then true\n            else false\n        end as is_holiday\n\n    from date_spine\n)\n\nselect * from final", "relation_name": "\"dev\".\"main\".\"dim_dates\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:49.645560Z", "completed_at": "2026-02-21T14:40:49.663998Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:49.665588Z", "completed_at": "2026-02-21T14:40:49.697088Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05906391143798828, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_rate_code_lookup_rate_code_id.63f831eaec", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rate_code_id\nfrom \"dev\".\"main\".\"rate_code_lookup\"\nwhere rate_code_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:49.642113Z", "completed_at": "2026-02-21T14:40:49.642118Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:49.643588Z", "completed_at": "2026-02-21T14:40:49.709903Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07260799407958984, "adapter_response": {"_message": "CREATE 265", "code": "CREATE", "rows_affected": 265}, "message": "CREATE 265", "failures": null, "unique_id": "seed.nyc_taxi_pipeline_00.taxi_zone_lookup", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:49.685351Z", "completed_at": "2026-02-21T14:40:49.698216Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:49.699073Z", "completed_at": "2026-02-21T14:40:49.723271Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04099416732788086, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.unique_rate_code_lookup_rate_code_id.dabde9102d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    rate_code_id as unique_field,\n    count(*) as n_records\n\nfrom \"dev\".\"main\".\"rate_code_lookup\"\nwhere rate_code_id is not null\ngroup by rate_code_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:49.706360Z", "completed_at": "2026-02-21T14:40:49.716458Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:49.717870Z", "completed_at": "2026-02-21T14:40:49.740047Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.036535024642944336, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_payment_type_lookup_payment_type_id.5e37661521", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_type_id\nfrom \"dev\".\"main\".\"payment_type_lookup\"\nwhere payment_type_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:49.719845Z", "completed_at": "2026-02-21T14:40:49.732266Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:49.733101Z", "completed_at": "2026-02-21T14:40:49.754209Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04006648063659668, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.unique_payment_type_lookup_payment_type_id.cabba233a7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    payment_type_id as unique_field,\n    count(*) as n_records\n\nfrom \"dev\".\"main\".\"payment_type_lookup\"\nwhere payment_type_id is not null\ngroup by payment_type_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:49.728492Z", "completed_at": "2026-02-21T14:40:49.743035Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:49.744394Z", "completed_at": "2026-02-21T14:40:49.769320Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04328203201293945, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_date_key.8dfe93e348", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_key\nfrom \"dev\".\"main\".\"dim_dates\"\nwhere date_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:49.748759Z", "completed_at": "2026-02-21T14:40:49.760363Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:49.761524Z", "completed_at": "2026-02-21T14:40:49.787046Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.041429758071899414, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_day_of_week_name.c9f15af541", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect day_of_week_name\nfrom \"dev\".\"main\".\"dim_dates\"\nwhere day_of_week_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:49.764504Z", "completed_at": "2026-02-21T14:40:49.777241Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:49.777903Z", "completed_at": "2026-02-21T14:40:49.802749Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.047120094299316406, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_holiday.9c87ee151a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect is_holiday\nfrom \"dev\".\"main\".\"dim_dates\"\nwhere is_holiday is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:49.773926Z", "completed_at": "2026-02-21T14:40:49.781404Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:49.782140Z", "completed_at": "2026-02-21T14:40:49.803956Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.034868717193603516, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_dim_dates_is_weekend.11ee2914a0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect is_weekend\nfrom \"dev\".\"main\".\"dim_dates\"\nwhere is_weekend is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:49.796476Z", "completed_at": "2026-02-21T14:40:49.812997Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:49.816908Z", "completed_at": "2026-02-21T14:40:49.841200Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05145072937011719, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.unique_dim_dates_date_key.61e1d0726d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    date_key as unique_field,\n    count(*) as n_records\n\nfrom \"dev\".\"main\".\"dim_dates\"\nwhere date_key is not null\ngroup by date_key\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:49.819589Z", "completed_at": "2026-02-21T14:40:49.827454Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:49.828175Z", "completed_at": "2026-02-21T14:40:49.848547Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04247713088989258, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_LocationID.681670029a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect LocationID\nfrom \"dev\".\"main\".\"taxi_zone_lookup\"\nwhere LocationID is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:49.813821Z", "completed_at": "2026-02-21T14:40:49.830030Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:49.830660Z", "completed_at": "2026-02-21T14:40:49.849646Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04338526725769043, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_taxi_zone_lookup_Borough.b38d52d9fa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect Borough\nfrom \"dev\".\"main\".\"taxi_zone_lookup\"\nwhere Borough is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:49.857109Z", "completed_at": "2026-02-21T14:40:49.868992Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:49.869395Z", "completed_at": "2026-02-21T14:40:49.896234Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04883384704589844, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.unique_taxi_zone_lookup_LocationID.7117f203c8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    LocationID as unique_field,\n    count(*) as n_records\n\nfrom \"dev\".\"main\".\"taxi_zone_lookup\"\nwhere LocationID is not null\ngroup by LocationID\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:49.866750Z", "completed_at": "2026-02-21T14:40:49.872590Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:49.885181Z", "completed_at": "2026-02-21T14:40:49.943044Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.08092975616455078, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nyc_taxi_pipeline_00.stg_payment_types", "compiled": true, "compiled_code": "/*\n    Staging model: Payment type lookup\n    Maps payment_type_id to human-readable names.\n*/\n\nwith source as (\n    select * from \"dev\".\"main\".\"payment_type_lookup\"\n),\n\nrenamed as (\n    select\n        payment_type_id,\n        payment_type_name\n    from source\n)\n\nselect * from renamed", "relation_name": "\"dev\".\"main\".\"stg_payment_types\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:49.864573Z", "completed_at": "2026-02-21T14:40:49.872162Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:49.872954Z", "completed_at": "2026-02-21T14:40:49.946823Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0863344669342041, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nyc_taxi_pipeline_00.stg_rate_codes", "compiled": true, "compiled_code": "/*\n    Staging model: Rate code lookup\n    Maps rate_code_id to human-readable names.\n*/\n\nwith source as (\n    select * from \"dev\".\"main\".\"rate_code_lookup\"\n),\n\nrenamed as (\n    select\n        rate_code_id,\n        rate_code_name\n    from source\n)\n\nselect * from renamed", "relation_name": "\"dev\".\"main\".\"stg_rate_codes\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:49.918108Z", "completed_at": "2026-02-21T14:40:49.928478Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:49.929543Z", "completed_at": "2026-02-21T14:40:49.988427Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07607626914978027, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nyc_taxi_pipeline_00.stg_taxi_zones", "compiled": true, "compiled_code": "/*\n    Staging model: Taxi zone lookup\n    Maps LocationID to borough and zone name.\n*/\n\nwith source as (\n    select * from \"dev\".\"main\".\"taxi_zone_lookup\"\n),\n\nrenamed as (\n    select\n        cast(\"LocationID\" as integer) as location_id,\n        \"Borough\" as borough,\n        \"Zone\" as zone_name,\n        service_zone\n    from source\n)\n\nselect * from renamed", "relation_name": "\"dev\".\"main\".\"stg_taxi_zones\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:49.959322Z", "completed_at": "2026-02-21T14:40:49.969640Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:49.971590Z", "completed_at": "2026-02-21T14:40:49.994487Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.048262596130371094, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_id.65f5cf5d78", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_type_id\nfrom \"dev\".\"main\".\"stg_payment_types\"\nwhere payment_type_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:49.963763Z", "completed_at": "2026-02-21T14:40:49.974102Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:49.974989Z", "completed_at": "2026-02-21T14:40:50.000396Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04330921173095703, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_stg_payment_types_payment_type_name.16ff531e39", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_type_name\nfrom \"dev\".\"main\".\"stg_payment_types\"\nwhere payment_type_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:50.011902Z", "completed_at": "2026-02-21T14:40:50.023126Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:50.023648Z", "completed_at": "2026-02-21T14:40:50.037995Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.033496856689453125, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_id.a3d3d6524a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rate_code_id\nfrom \"dev\".\"main\".\"stg_rate_codes\"\nwhere rate_code_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:50.005697Z", "completed_at": "2026-02-21T14:40:50.020191Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:50.020771Z", "completed_at": "2026-02-21T14:40:50.039002Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04189324378967285, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.unique_stg_payment_types_payment_type_id.0455602534", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    payment_type_id as unique_field,\n    count(*) as n_records\n\nfrom \"dev\".\"main\".\"stg_payment_types\"\nwhere payment_type_id is not null\ngroup by payment_type_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:50.015958Z", "completed_at": "2026-02-21T14:40:50.024777Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:50.025498Z", "completed_at": "2026-02-21T14:40:50.040624Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03063178062438965, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_stg_rate_codes_rate_code_name.d13a52ad0f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rate_code_name\nfrom \"dev\".\"main\".\"stg_rate_codes\"\nwhere rate_code_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:50.053134Z", "completed_at": "2026-02-21T14:40:50.065196Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:50.065782Z", "completed_at": "2026-02-21T14:40:50.079769Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.033332109451293945, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.unique_stg_rate_codes_rate_code_id.6afe3a82e3", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    rate_code_id as unique_field,\n    count(*) as n_records\n\nfrom \"dev\".\"main\".\"stg_rate_codes\"\nwhere rate_code_id is not null\ngroup by rate_code_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:50.059109Z", "completed_at": "2026-02-21T14:40:50.067598Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:50.069928Z", "completed_at": "2026-02-21T14:40:50.086521Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0387270450592041, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_location_id.5b95dc00bf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect location_id\nfrom \"dev\".\"main\".\"stg_taxi_zones\"\nwhere location_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:50.056363Z", "completed_at": "2026-02-21T14:40:50.067291Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:50.068214Z", "completed_at": "2026-02-21T14:40:50.087682Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04291939735412598, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_borough.4c0b9ae98b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect borough\nfrom \"dev\".\"main\".\"stg_taxi_zones\"\nwhere borough is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:50.091267Z", "completed_at": "2026-02-21T14:40:50.103847Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:50.104251Z", "completed_at": "2026-02-21T14:40:50.123500Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03917098045349121, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_stg_taxi_zones_zone_name.a3a6153c84", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect zone_name\nfrom \"dev\".\"main\".\"stg_taxi_zones\"\nwhere zone_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:50.098923Z", "completed_at": "2026-02-21T14:40:50.106591Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:50.106963Z", "completed_at": "2026-02-21T14:40:50.126069Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03215312957763672, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.unique_stg_taxi_zones_location_id.ff20549a5c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    location_id as unique_field,\n    count(*) as n_records\n\nfrom \"dev\".\"main\".\"stg_taxi_zones\"\nwhere location_id is not null\ngroup by location_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:50.101595Z", "completed_at": "2026-02-21T14:40:50.109756Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:50.110136Z", "completed_at": "2026-02-21T14:40:50.166041Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.06878495216369629, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nyc_taxi_pipeline_00.dim_payment_types", "compiled": true, "compiled_code": "/*\n    Dimension table: Payment type descriptions.\n*/\n\nwith payment_types as (\n    select * from \"dev\".\"main\".\"stg_payment_types\"\n),\n\nfinal as (\n    select\n        payment_type_id,\n        payment_type_name\n    from payment_types\n)\n\nselect * from final", "relation_name": "\"dev\".\"main\".\"dim_payment_types\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:50.134751Z", "completed_at": "2026-02-21T14:40:50.147764Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:50.148650Z", "completed_at": "2026-02-21T14:40:50.206127Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07376480102539062, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nyc_taxi_pipeline_00.dim_locations", "compiled": true, "compiled_code": "/*\n    Dimension table: TLC Taxi Zone locations.\n*/\n\nwith zones as (\n    select * from \"dev\".\"main\".\"stg_taxi_zones\"\n),\n\nfinal as (\n    select\n        location_id,\n        borough,\n        zone_name,\n        service_zone\n    from zones\n)\n\nselect * from final", "relation_name": "\"dev\".\"main\".\"dim_locations\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:50.177877Z", "completed_at": "2026-02-21T14:40:50.192767Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:50.193473Z", "completed_at": "2026-02-21T14:40:50.220015Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.052739620208740234, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_name.1acd2a71b0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_type_name\nfrom \"dev\".\"main\".\"dim_payment_types\"\nwhere payment_type_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:50.174272Z", "completed_at": "2026-02-21T14:40:50.194879Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:50.195600Z", "completed_at": "2026-02-21T14:40:50.222686Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.055121660232543945, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_dim_payment_types_payment_type_id.8406acab10", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_type_id\nfrom \"dev\".\"main\".\"dim_payment_types\"\nwhere payment_type_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:50.216527Z", "completed_at": "2026-02-21T14:40:50.231003Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:50.234399Z", "completed_at": "2026-02-21T14:40:50.255627Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04508543014526367, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.unique_dim_payment_types_payment_type_id.24066a2d62", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    payment_type_id as unique_field,\n    count(*) as n_records\n\nfrom \"dev\".\"main\".\"dim_payment_types\"\nwhere payment_type_id is not null\ngroup by payment_type_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:50.231325Z", "completed_at": "2026-02-21T14:40:50.243216Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:50.243791Z", "completed_at": "2026-02-21T14:40:50.256563Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.031139850616455078, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_borough.0b7e3fa5af", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect borough\nfrom \"dev\".\"main\".\"dim_locations\"\nwhere borough is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:50.236261Z", "completed_at": "2026-02-21T14:40:50.246493Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:50.247100Z", "completed_at": "2026-02-21T14:40:50.273036Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.044167518615722656, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_location_id.70b6875476", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect location_id\nfrom \"dev\".\"main\".\"dim_locations\"\nwhere location_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:50.267089Z", "completed_at": "2026-02-21T14:40:50.277443Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:50.277960Z", "completed_at": "2026-02-21T14:40:50.290360Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.029039859771728516, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_dim_locations_zone_name.612cdedf7d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect zone_name\nfrom \"dev\".\"main\".\"dim_locations\"\nwhere zone_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:50.269939Z", "completed_at": "2026-02-21T14:40:50.280302Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:50.280944Z", "completed_at": "2026-02-21T14:40:50.292096Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.029642581939697266, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.unique_dim_locations_location_id.09f471618d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    location_id as unique_field,\n    count(*) as n_records\n\nfrom \"dev\".\"main\".\"dim_locations\"\nwhere location_id is not null\ngroup by location_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:49.491748Z", "completed_at": "2026-02-21T14:40:49.511010Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:49.511417Z", "completed_at": "2026-02-21T14:40:51.316959Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.8985826969146729, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nyc_taxi_pipeline_00.stg_yellow_trips", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from read_parquet('/data/yellow_tripdata_2024-01.parquet')\n),\n\nrenamed as (\n    select\n        -- surrogate key (MD5 hash of composite key)\n        md5(cast(coalesce(cast(VendorID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(PULocationID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DOLocationID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(fare_amount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(total_amount as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,\n\n        -- identifiers\n        cast(\"VendorID\" as integer) as vendor_id,\n        cast(\"RatecodeID\" as integer) as rate_code_id,\n        cast(\"PULocationID\" as integer) as pickup_location_id,\n        cast(\"DOLocationID\" as integer) as dropoff_location_id,\n        cast(payment_type as integer) as payment_type_id,\n\n        -- timestamps\n        cast(tpep_pickup_datetime as timestamp) as pickup_datetime,\n        cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,\n\n        -- trip info\n        cast(passenger_count as integer) as passenger_count,\n        cast(trip_distance as double) as trip_distance_miles,\n        store_and_fwd_flag,\n\n        -- financials\n        round(cast(fare_amount as decimal(10, 2)), 2) as fare_amount,\n        round(cast(extra as decimal(10, 2)), 2) as extra_amount,\n        round(cast(mta_tax as decimal(10, 2)), 2) as mta_tax,\n        round(cast(tip_amount as decimal(10, 2)), 2) as tip_amount,\n        round(cast(tolls_amount as decimal(10, 2)), 2) as tolls_amount,\n        round(cast(improvement_surcharge as decimal(10, 2)), 2) as improvement_surcharge,\n        round(cast(total_amount as decimal(10, 2)), 2) as total_amount,\n        round(cast(congestion_surcharge as decimal(10, 2)), 2) as congestion_surcharge,\n        round(cast(Airport_fee as decimal(10, 2)), 2) as airport_fee\n\n    from source\n    where tpep_pickup_datetime is not null\n      and tpep_dropoff_datetime is not null\n      and trip_distance >= 0\n      and fare_amount >= 0\n      -- filter out-of-range dates (data quality: ~18 trips outside Jan 2024)\n      and cast(tpep_pickup_datetime as date) >= date '2024-01-01'\n      and cast(tpep_pickup_datetime as date) < date '2024-02-01'\n)\n\nselect * from renamed", "relation_name": "\"dev\".\"main\".\"stg_yellow_trips\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:51.392950Z", "completed_at": "2026-02-21T14:40:51.411037Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:51.413220Z", "completed_at": "2026-02-21T14:40:51.468198Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.09057235717773438, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_rate_code_id__1__2__3__4__5__6__99.175004b098", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        rate_code_id as value_field,\n        count(*) as n_records\n\n    from \"dev\".\"main\".\"stg_yellow_trips\"\n    group by rate_code_id\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    '1','2','3','4','5','6','99'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:51.396079Z", "completed_at": "2026-02-21T14:40:51.406661Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:51.411326Z", "completed_at": "2026-02-21T14:40:51.475478Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.10193181037902832, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_vendor_id__1__2__6.447352dc27", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        vendor_id as value_field,\n        count(*) as n_records\n\n    from \"dev\".\"main\".\"stg_yellow_trips\"\n    group by vendor_id\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    '1','2','6'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:51.385495Z", "completed_at": "2026-02-21T14:40:51.405802Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:51.406976Z", "completed_at": "2026-02-21T14:40:51.484073Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1106271743774414, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.accepted_values_stg_yellow_trips_payment_type_id__0__1__2__3__4__5__6.dc80a43a44", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        payment_type_id as value_field,\n        count(*) as n_records\n\n    from \"dev\".\"main\".\"stg_yellow_trips\"\n    group by payment_type_id\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    '0','1','2','3','4','5','6'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:51.399489Z", "completed_at": "2026-02-21T14:40:51.406388Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:51.409962Z", "completed_at": "2026-02-21T14:40:51.488080Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.11409831047058105, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.assert_fare_not_exceeds_total", "compiled": true, "compiled_code": "/*\n    Singular test: fare_amount should not exceed total_amount.\n*/\n\nselect\n    trip_id,\n    fare_amount,\n    total_amount\nfrom \"dev\".\"main\".\"stg_yellow_trips\"\nwhere fare_amount > total_amount + 0.01\n  and total_amount > 0", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:51.489023Z", "completed_at": "2026-02-21T14:40:51.499765Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:51.500727Z", "completed_at": "2026-02-21T14:40:51.533478Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.054174184799194336, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_datetime.369e989052", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dropoff_datetime\nfrom \"dev\".\"main\".\"stg_yellow_trips\"\nwhere dropoff_datetime is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:51.495268Z", "completed_at": "2026-02-21T14:40:51.504956Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:51.505776Z", "completed_at": "2026-02-21T14:40:51.534853Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04633784294128418, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_dropoff_location_id.19a28c5048", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dropoff_location_id\nfrom \"dev\".\"main\".\"stg_yellow_trips\"\nwhere dropoff_location_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:51.502024Z", "completed_at": "2026-02-21T14:40:51.510290Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:51.510724Z", "completed_at": "2026-02-21T14:40:51.535812Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04185080528259277, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_fare_amount.7dfa275a97", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect fare_amount\nfrom \"dev\".\"main\".\"stg_yellow_trips\"\nwhere fare_amount is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:51.507390Z", "completed_at": "2026-02-21T14:40:51.514895Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:51.515526Z", "completed_at": "2026-02-21T14:40:51.536922Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03796863555908203, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_datetime.069acef7ed", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect pickup_datetime\nfrom \"dev\".\"main\".\"stg_yellow_trips\"\nwhere pickup_datetime is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:51.547803Z", "completed_at": "2026-02-21T14:40:51.561313Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:51.563087Z", "completed_at": "2026-02-21T14:40:51.588204Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04947710037231445, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_pickup_location_id.cf34a865b1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect pickup_location_id\nfrom \"dev\".\"main\".\"stg_yellow_trips\"\nwhere pickup_location_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:51.550190Z", "completed_at": "2026-02-21T14:40:51.564313Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:51.564832Z", "completed_at": "2026-02-21T14:40:51.591288Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04987049102783203, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_total_amount.64a0bc33f6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_amount\nfrom \"dev\".\"main\".\"stg_yellow_trips\"\nwhere total_amount is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:51.556288Z", "completed_at": "2026-02-21T14:40:51.565868Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:51.566220Z", "completed_at": "2026-02-21T14:40:51.589928Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04087352752685547, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_id.cf5e2695a1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect trip_id\nfrom \"dev\".\"main\".\"stg_yellow_trips\"\nwhere trip_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:51.552541Z", "completed_at": "2026-02-21T14:40:51.561074Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:51.561569Z", "completed_at": "2026-02-21T14:40:51.589191Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05359482765197754, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_trip_distance_miles.578ef2b1d7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect trip_distance_miles\nfrom \"dev\".\"main\".\"stg_yellow_trips\"\nwhere trip_distance_miles is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:51.602479Z", "completed_at": "2026-02-21T14:40:51.623015Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:51.624897Z", "completed_at": "2026-02-21T14:40:51.649482Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05552244186401367, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_stg_yellow_trips_vendor_id.5bb8ca4a57", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect vendor_id\nfrom \"dev\".\"main\".\"stg_yellow_trips\"\nwhere vendor_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:51.607823Z", "completed_at": "2026-02-21T14:40:51.619217Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:51.619662Z", "completed_at": "2026-02-21T14:40:51.748331Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.1512300968170166, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_dropoff_location_id__location_id__ref_stg_taxi_zones_.4a3b71af0a", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select dropoff_location_id as from_field\n    from \"dev\".\"main\".\"stg_yellow_trips\"\n    where dropoff_location_id is not null\n),\n\nparent as (\n    select location_id as to_field\n    from \"dev\".\"main\".\"stg_taxi_zones\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:51.613350Z", "completed_at": "2026-02-21T14:40:51.621760Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:51.623358Z", "completed_at": "2026-02-21T14:40:51.749321Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1404118537902832, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.relationships_stg_yellow_trips_pickup_location_id__location_id__ref_stg_taxi_zones_.e8fa05c47f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select pickup_location_id as from_field\n    from \"dev\".\"main\".\"stg_yellow_trips\"\n    where pickup_location_id is not null\n),\n\nparent as (\n    select location_id as to_field\n    from \"dev\".\"main\".\"stg_taxi_zones\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:51.605615Z", "completed_at": "2026-02-21T14:40:51.621324Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:51.621920Z", "completed_at": "2026-02-21T14:40:51.776309Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.19483542442321777, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.unique_stg_yellow_trips_trip_id.a67db06965", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    trip_id as unique_field,\n    count(*) as n_records\n\nfrom \"dev\".\"main\".\"stg_yellow_trips\"\nwhere trip_id is not null\ngroup by trip_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:51.798761Z", "completed_at": "2026-02-21T14:40:51.806922Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:51.807255Z", "completed_at": "2026-02-21T14:40:51.929251Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.16348910331726074, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nyc_taxi_pipeline_00.int_trip_metrics", "compiled": true, "compiled_code": "/*\n    Intermediate model: Trip-level enrichment with calculated metrics.\n    Uses adapter-dispatched macros for cross-dialect compatibility.\n*/\n\nwith trips as (\n    select * from \"dev\".\"main\".\"stg_yellow_trips\"\n),\n\nenriched as (\n    select\n        trip_id,\n        vendor_id,\n        rate_code_id,\n        pickup_location_id,\n        dropoff_location_id,\n        payment_type_id,\n        pickup_datetime,\n        dropoff_datetime,\n        passenger_count,\n        trip_distance_miles,\n        store_and_fwd_flag,\n\n        -- calculated: duration in minutes\n        \n    datediff('minute', pickup_datetime, dropoff_datetime)\n as trip_duration_minutes,\n\n        -- calculated: average speed (avoid division by zero)\n        case\n            when \n    datediff('minute', pickup_datetime, dropoff_datetime)\n > 0\n            then round(\n                trip_distance_miles / (\n    datediff('minute', pickup_datetime, dropoff_datetime)\n / 60.0),\n                2\n            )\n            else null\n        end as avg_speed_mph,\n\n        -- calculated: cost per mile\n        case\n            when trip_distance_miles > 0\n            then round(fare_amount / trip_distance_miles, 2)\n            else null\n        end as cost_per_mile,\n\n        -- calculated: tip percentage\n        case\n            when fare_amount > 0\n            then round((tip_amount / fare_amount) * 100, 2)\n            else null\n        end as tip_percentage,\n\n        -- time dimensions (using adapter-dispatched macros)\n        date_trunc('day', pickup_datetime)::date as pickup_date,\n        extract(hour from pickup_datetime) as pickup_hour,\n        \n    dayname(pickup_datetime)\n as pickup_day_of_week,\n        case\n            when extract(dow from pickup_datetime) in (0, 6) then true\n            else false\n        end as is_weekend,\n\n        -- financials passthrough\n        fare_amount,\n        extra_amount,\n        mta_tax,\n        tip_amount,\n        tolls_amount,\n        improvement_surcharge,\n        total_amount,\n        congestion_surcharge,\n        airport_fee\n\n    from trips\n)\n\nselect *\nfrom enriched\nwhere trip_duration_minutes between 1 and 720\n  and (avg_speed_mph is null or avg_speed_mph < 100)", "relation_name": "\"dev\".\"main\".\"int_trip_metrics\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:51.968694Z", "completed_at": "2026-02-21T14:40:51.980451Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:51.980757Z", "completed_at": "2026-02-21T14:40:52.010302Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05445551872253418, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.assert_trip_duration_positive", "compiled": true, "compiled_code": "/*\n    Singular test: No trip should have negative duration.\n*/\n\nselect\n    trip_id,\n    pickup_datetime,\n    dropoff_datetime,\n    trip_duration_minutes\nfrom \"dev\".\"main\".\"int_trip_metrics\"\nwhere trip_duration_minutes < 0", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:51.977878Z", "completed_at": "2026-02-21T14:40:51.987592Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:51.989377Z", "completed_at": "2026-02-21T14:40:52.014334Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05783700942993164, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_is_weekend.d4657ab4ed", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect is_weekend\nfrom \"dev\".\"main\".\"int_trip_metrics\"\nwhere is_weekend is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:51.971197Z", "completed_at": "2026-02-21T14:40:51.984957Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:51.985389Z", "completed_at": "2026-02-21T14:40:52.062434Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.10069036483764648, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_pickup_hour__23__0.b735300574", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from \"dev\".\"main\".\"int_trip_metrics\"\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pickup_hour >= 0\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pickup_hour <= 23\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:51.975744Z", "completed_at": "2026-02-21T14:40:51.985176Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:51.987805Z", "completed_at": "2026-02-21T14:40:52.064211Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.10760974884033203, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_trip_metrics_trip_duration_minutes__720__1.067f9c9718", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from \"dev\".\"main\".\"int_trip_metrics\"\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not trip_duration_minutes >= 1\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not trip_duration_minutes <= 720\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:52.052179Z", "completed_at": "2026-02-21T14:40:52.064836Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:52.067627Z", "completed_at": "2026-02-21T14:40:52.099396Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07137680053710938, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_hour.8a05fd6082", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect pickup_hour\nfrom \"dev\".\"main\".\"int_trip_metrics\"\nwhere pickup_hour is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:52.043731Z", "completed_at": "2026-02-21T14:40:52.064400Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:52.065764Z", "completed_at": "2026-02-21T14:40:52.104737Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0858147144317627, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_pickup_date.f3d690f1e3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect pickup_date\nfrom \"dev\".\"main\".\"int_trip_metrics\"\nwhere pickup_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:52.079512Z", "completed_at": "2026-02-21T14:40:52.085513Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:52.085808Z", "completed_at": "2026-02-21T14:40:52.105805Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04444742202758789, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_id.1101f7bb5f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect trip_id\nfrom \"dev\".\"main\".\"int_trip_metrics\"\nwhere trip_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:52.071604Z", "completed_at": "2026-02-21T14:40:52.082243Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:52.082503Z", "completed_at": "2026-02-21T14:40:52.153574Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.08787775039672852, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_int_trip_metrics_trip_duration_minutes.d8c26e6c3c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect trip_duration_minutes\nfrom \"dev\".\"main\".\"int_trip_metrics\"\nwhere trip_duration_minutes is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:52.163609Z", "completed_at": "2026-02-21T14:40:52.173628Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:52.174090Z", "completed_at": "2026-02-21T14:40:52.262927Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.10370635986328125, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nyc_taxi_pipeline_00.int_daily_summary", "compiled": true, "compiled_code": "/*\n    Intermediate model: Daily aggregated trip and revenue metrics.\n    One row per day with counts, averages, and revenue totals.\n*/\n\nwith trip_metrics as (\n    select * from \"dev\".\"main\".\"int_trip_metrics\"\n),\n\ndaily_agg as (\n    select\n        pickup_date,\n        pickup_day_of_week,\n        is_weekend,\n\n        count(*) as total_trips,\n        sum(passenger_count) as total_passengers,\n\n        round(avg(trip_distance_miles), 2) as avg_trip_distance,\n        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,\n        round(avg(avg_speed_mph), 2) as avg_speed_mph,\n\n        round(sum(fare_amount), 2) as total_fare_revenue,\n        round(sum(tip_amount), 2) as total_tip_revenue,\n        round(sum(total_amount), 2) as total_revenue,\n        round(avg(total_amount), 2) as avg_trip_revenue,\n        round(avg(tip_percentage), 2) as avg_tip_percentage,\n\n        count(case when payment_type_id = 1 then 1 end) as credit_card_trips,\n        count(case when payment_type_id = 2 then 1 end) as cash_trips\n\n    from trip_metrics\n    group by pickup_date, pickup_day_of_week, is_weekend\n)\n\nselect * from daily_agg", "relation_name": "\"dev\".\"main\".\"int_daily_summary\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:52.165359Z", "completed_at": "2026-02-21T14:40:52.173867Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:52.176140Z", "completed_at": "2026-02-21T14:40:52.278574Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.12240290641784668, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nyc_taxi_pipeline_00.int_hourly_patterns", "compiled": true, "compiled_code": "/*\n    Intermediate model: Hourly trip patterns by date.\n    One row per date + hour combination.\n*/\n\nwith trip_metrics as (\n    select * from \"dev\".\"main\".\"int_trip_metrics\"\n),\n\nhourly_agg as (\n    select\n        pickup_date,\n        pickup_hour,\n        pickup_day_of_week,\n        is_weekend,\n\n        count(*) as total_trips,\n        round(avg(trip_distance_miles), 2) as avg_distance,\n        round(avg(trip_duration_minutes), 2) as avg_duration_min,\n        round(sum(total_amount), 2) as total_revenue,\n        round(avg(total_amount), 2) as avg_revenue\n\n    from trip_metrics\n    group by pickup_date, pickup_hour, pickup_day_of_week, is_weekend\n)\n\nselect * from hourly_agg", "relation_name": "\"dev\".\"main\".\"int_hourly_patterns\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:52.297240Z", "completed_at": "2026-02-21T14:40:52.340752Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:52.348504Z", "completed_at": "2026-02-21T14:40:52.418015Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.150437593460083, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_pickup_date.b3f7570686", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect pickup_date\nfrom \"dev\".\"main\".\"int_daily_summary\"\nwhere pickup_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:52.315443Z", "completed_at": "2026-02-21T14:40:52.335833Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:52.337643Z", "completed_at": "2026-02-21T14:40:52.603409Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.2938680648803711, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_revenue.3b1f27ad50", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_revenue\nfrom \"dev\".\"main\".\"int_daily_summary\"\nwhere total_revenue is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:52.292197Z", "completed_at": "2026-02-21T14:40:52.351619Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:52.359576Z", "completed_at": "2026-02-21T14:40:52.665154Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.3861808776855469, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_daily_summary_total_trips__0.67007d1863", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from \"dev\".\"main\".\"int_daily_summary\"\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not total_trips >= 0\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:52.669852Z", "completed_at": "2026-02-21T14:40:52.677596Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:52.677969Z", "completed_at": "2026-02-21T14:40:52.702299Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03453350067138672, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.dbt_utils_accepted_range_int_hourly_patterns_pickup_hour__23__0.4b84d458fe", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from \"dev\".\"main\".\"int_hourly_patterns\"\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pickup_hour >= 0\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pickup_hour <= 23\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:52.706553Z", "completed_at": "2026-02-21T14:40:52.715578Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:52.716242Z", "completed_at": "2026-02-21T14:40:52.729215Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.025069713592529297, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_date.75261743f2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect pickup_date\nfrom \"dev\".\"main\".\"int_hourly_patterns\"\nwhere pickup_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:52.445459Z", "completed_at": "2026-02-21T14:40:52.481736Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:52.482942Z", "completed_at": "2026-02-21T14:40:52.739863Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.29898858070373535, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_int_daily_summary_total_trips.0365021a10", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_trips\nfrom \"dev\".\"main\".\"int_daily_summary\"\nwhere total_trips is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:52.733586Z", "completed_at": "2026-02-21T14:40:52.746874Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:52.747372Z", "completed_at": "2026-02-21T14:40:52.762579Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03218221664428711, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_pickup_hour.638a0a9e9d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect pickup_hour\nfrom \"dev\".\"main\".\"int_hourly_patterns\"\nwhere pickup_hour is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:52.607764Z", "completed_at": "2026-02-21T14:40:52.617651Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:52.618118Z", "completed_at": "2026-02-21T14:40:52.771052Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1662132740020752, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.unique_int_daily_summary_pickup_date.b93ee4526e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    pickup_date as unique_field,\n    count(*) as n_records\n\nfrom \"dev\".\"main\".\"int_daily_summary\"\nwhere pickup_date is not null\ngroup by pickup_date\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:52.744639Z", "completed_at": "2026-02-21T14:40:52.753600Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:52.753941Z", "completed_at": "2026-02-21T14:40:52.868634Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.12780404090881348, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_int_hourly_patterns_total_trips.a66c4ed8cf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_trips\nfrom \"dev\".\"main\".\"int_hourly_patterns\"\nwhere total_trips is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:52.776455Z", "completed_at": "2026-02-21T14:40:52.783750Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:52.784281Z", "completed_at": "2026-02-21T14:40:53.009229Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.23426175117492676, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nyc_taxi_pipeline_00.mart_daily_revenue", "compiled": true, "compiled_code": "/*\n    Analytics mart: Daily revenue metrics with running totals.\n*/\n\nwith daily as (\n    select * from \"dev\".\"main\".\"int_daily_summary\"\n),\n\ndates as (\n    select * from \"dev\".\"main\".\"dim_dates\"\n),\n\nfinal as (\n    select\n        d.date_key,\n        d.day_of_week_name,\n        d.is_weekend,\n        d.is_holiday,\n        d.week_of_year,\n\n        daily.total_trips,\n        daily.total_passengers,\n        daily.total_fare_revenue,\n        daily.total_tip_revenue,\n        daily.total_revenue,\n        daily.avg_trip_revenue,\n        daily.avg_tip_percentage,\n        daily.credit_card_trips,\n        daily.cash_trips,\n        daily.avg_trip_distance,\n        daily.avg_trip_duration_min,\n\n        -- running total\n        sum(daily.total_revenue) over (order by d.date_key) as cumulative_revenue,\n\n        -- day-over-day change\n        daily.total_revenue - lag(daily.total_revenue) over (order by d.date_key) as revenue_change_vs_prior_day\n\n    from daily\n    inner join dates d\n        on daily.pickup_date = d.date_key\n)\n\nselect * from final", "relation_name": "\"dev\".\"main\".\"mart_daily_revenue\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:53.019946Z", "completed_at": "2026-02-21T14:40:53.028085Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:53.028789Z", "completed_at": "2026-02-21T14:40:53.043023Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03347206115722656, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_total_revenue.75c9f689e9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_revenue\nfrom \"dev\".\"main\".\"mart_daily_revenue\"\nwhere total_revenue is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:53.016722Z", "completed_at": "2026-02-21T14:40:53.030285Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:53.030849Z", "completed_at": "2026-02-21T14:40:53.046128Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03505730628967285, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_mart_daily_revenue_date_key.7065ce323a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_key\nfrom \"dev\".\"main\".\"mart_daily_revenue\"\nwhere date_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:52.881545Z", "completed_at": "2026-02-21T14:40:52.891464Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:52.891987Z", "completed_at": "2026-02-21T14:40:53.070798Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1911768913269043, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nyc_taxi_pipeline_00.mart_hourly_demand", "compiled": true, "compiled_code": "/*\n    Analytics mart: Hourly demand patterns.\n*/\n\nwith hourly as (\n    select * from \"dev\".\"main\".\"int_hourly_patterns\"\n),\n\nfinal as (\n    select\n        pickup_hour,\n        is_weekend,\n\n        count(*) as days_observed,\n        round(avg(total_trips), 0) as avg_trips_per_period,\n        round(avg(avg_distance), 2) as avg_distance,\n        round(avg(avg_duration_min), 2) as avg_duration_min,\n        round(avg(total_revenue), 2) as avg_revenue_per_period,\n        sum(total_trips) as total_trips_all_days\n\n    from hourly\n    group by pickup_hour, is_weekend\n)\n\nselect * from final\norder by is_weekend, pickup_hour", "relation_name": "\"dev\".\"main\".\"mart_hourly_demand\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:53.054573Z", "completed_at": "2026-02-21T14:40:53.063136Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:53.063467Z", "completed_at": "2026-02-21T14:40:53.084085Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03380107879638672, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.unique_mart_daily_revenue_date_key.e6ac3c00f7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    date_key as unique_field,\n    count(*) as n_records\n\nfrom \"dev\".\"main\".\"mart_daily_revenue\"\nwhere date_key is not null\ngroup by date_key\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:53.077661Z", "completed_at": "2026-02-21T14:40:53.087661Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:53.088057Z", "completed_at": "2026-02-21T14:40:53.097760Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0247194766998291, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_is_weekend.943ef48ab8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect is_weekend\nfrom \"dev\".\"main\".\"mart_hourly_demand\"\nwhere is_weekend is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:53.080041Z", "completed_at": "2026-02-21T14:40:53.089158Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:53.089569Z", "completed_at": "2026-02-21T14:40:53.099826Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02645087242126465, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_mart_hourly_demand_pickup_hour.ba5dc86418", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect pickup_hour\nfrom \"dev\".\"main\".\"mart_hourly_demand\"\nwhere pickup_hour is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:52.166762Z", "completed_at": "2026-02-21T14:40:52.177656Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:52.178162Z", "completed_at": "2026-02-21T14:40:58.168767Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 6.033177375793457, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nyc_taxi_pipeline_00.fct_trips", "compiled": true, "compiled_code": "/*\n    Fact table: Fully enriched trip records with location names.\n    Incremental with delete+insert strategy.\n*/\n\n\n\nwith trip_metrics as (\n    select * from \"dev\".\"main\".\"int_trip_metrics\"\n),\n\npickup_locations as (\n    select * from \"dev\".\"main\".\"dim_locations\"\n),\n\ndropoff_locations as (\n    select * from \"dev\".\"main\".\"dim_locations\"\n),\n\nfinal as (\n    select\n        t.trip_id,\n        t.vendor_id,\n        t.rate_code_id,\n        t.payment_type_id,\n        t.pickup_location_id,\n        t.dropoff_location_id,\n        t.pickup_datetime,\n        t.dropoff_datetime,\n        t.pickup_date,\n        t.pickup_hour,\n        t.pickup_day_of_week,\n        t.is_weekend,\n        t.passenger_count,\n        t.trip_distance_miles,\n        t.trip_duration_minutes,\n        t.avg_speed_mph,\n        t.cost_per_mile,\n        t.fare_amount,\n        t.extra_amount,\n        t.mta_tax,\n        t.tip_amount,\n        t.tip_percentage,\n        t.tolls_amount,\n        t.improvement_surcharge,\n        t.total_amount,\n        t.congestion_surcharge,\n        t.airport_fee,\n\n        -- enriched from dimensions\n        pu.borough as pickup_borough,\n        pu.zone_name as pickup_zone,\n        do_loc.borough as dropoff_borough,\n        do_loc.zone_name as dropoff_zone\n\n    from trip_metrics t\n    left join pickup_locations pu\n        on t.pickup_location_id = pu.location_id\n    left join dropoff_locations do_loc\n        on t.dropoff_location_id = do_loc.location_id\n\n    \n)\n\nselect * from final", "relation_name": "\"dev\".\"main\".\"fct_trips\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:58.208567Z", "completed_at": "2026-02-21T14:40:58.222103Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:58.222436Z", "completed_at": "2026-02-21T14:40:58.253638Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07024836540222168, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_trip_id.df65bf8c1d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect trip_id\nfrom \"dev\".\"main\".\"fct_trips\"\nwhere trip_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:58.203153Z", "completed_at": "2026-02-21T14:40:58.217593Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:58.217938Z", "completed_at": "2026-02-21T14:40:58.255506Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07380199432373047, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_pickup_datetime.3c78164d83", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect pickup_datetime\nfrom \"dev\".\"main\".\"fct_trips\"\nwhere pickup_datetime is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:58.206377Z", "completed_at": "2026-02-21T14:40:58.220624Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:58.221023Z", "completed_at": "2026-02-21T14:40:58.257305Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07537269592285156, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_fct_trips_total_amount.0e8ec5477d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_amount\nfrom \"dev\".\"main\".\"fct_trips\"\nwhere total_amount is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:58.210834Z", "completed_at": "2026-02-21T14:40:58.219117Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:58.219555Z", "completed_at": "2026-02-21T14:40:58.363132Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.1830146312713623, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.unique_fct_trips_trip_id.9b74cb6aab", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    trip_id as unique_field,\n    count(*) as n_records\n\nfrom \"dev\".\"main\".\"fct_trips\"\nwhere trip_id is not null\ngroup by trip_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:58.388873Z", "completed_at": "2026-02-21T14:40:58.397603Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:58.397972Z", "completed_at": "2026-02-21T14:40:58.564240Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.21692323684692383, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.nyc_taxi_pipeline_00.mart_location_performance", "compiled": true, "compiled_code": "/*\n    Analytics mart: Location-level performance summary.\n    Uses adapter-dispatched mode_compat() for cross-dialect support.\n*/\n\nwith trips as (\n    select * from \"dev\".\"main\".\"fct_trips\"\n),\n\nfinal as (\n    select\n        pickup_location_id,\n        pickup_borough,\n        pickup_zone,\n\n        count(*) as total_pickups,\n        round(avg(trip_distance_miles), 2) as avg_trip_distance,\n        round(avg(trip_duration_minutes), 2) as avg_trip_duration_min,\n        round(sum(total_amount), 2) as total_revenue,\n        round(avg(total_amount), 2) as avg_revenue_per_trip,\n        round(avg(tip_percentage), 2) as avg_tip_pct,\n        round(avg(passenger_count), 2) as avg_passengers,\n\n        -- most common dropoff destination\n        \n    mode(dropoff_zone)\n as most_common_dropoff_zone,\n\n        -- busiest hour\n        \n    mode(pickup_hour)\n as peak_pickup_hour\n\n    from trips\n    where pickup_zone is not null\n    group by pickup_location_id, pickup_borough, pickup_zone\n)\n\nselect * from final\norder by total_pickups desc", "relation_name": "\"dev\".\"main\".\"mart_location_performance\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:58.611098Z", "completed_at": "2026-02-21T14:40:58.621479Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:58.621972Z", "completed_at": "2026-02-21T14:40:58.647733Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04262590408325195, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_pickup_location_id.16ab95486c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect pickup_location_id\nfrom \"dev\".\"main\".\"mart_location_performance\"\nwhere pickup_location_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:58.614024Z", "completed_at": "2026-02-21T14:40:58.621711Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:58.623380Z", "completed_at": "2026-02-21T14:40:58.649434Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04342794418334961, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.not_null_mart_location_performance_total_pickups.e9d9f3f259", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_pickups\nfrom \"dev\".\"main\".\"mart_location_performance\"\nwhere total_pickups is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-21T14:40:58.616569Z", "completed_at": "2026-02-21T14:40:58.623141Z"}, {"name": "execute", "started_at": "2026-02-21T14:40:58.625281Z", "completed_at": "2026-02-21T14:40:58.650089Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04514884948730469, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.nyc_taxi_pipeline_00.unique_mart_location_performance_pickup_location_id.d5833a3c62", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    pickup_location_id as unique_field,\n    count(*) as n_records\n\nfrom \"dev\".\"main\".\"mart_location_performance\"\nwhere pickup_location_id is not null\ngroup by pickup_location_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 9.377303838729858, "args": {"require_unique_project_resource_names": false, "log_format": "default", "indirect_selection": "eager", "invocation_command": "dbt build --full-refresh --profiles-dir .", "partial_parse": true, "skip_nodes_if_on_run_start_fails": false, "log_path": "/dbt/logs", "log_file_max_bytes": 10485760, "require_yaml_configuration_for_mf_time_spines": false, "select": [], "use_colors_file": true, "require_batched_execution_for_custom_microbatch_strategy": false, "print": true, "export_saved_queries": false, "require_all_warnings_handled_by_warn_error": false, "log_format_file": "debug", "favor_state": false, "upload_to_artifacts_ingest_api": false, "partial_parse_file_diff": true, "require_ref_searches_node_package_before_root": false, "exclude": [], "write_json": true, "state_modified_compare_more_unrendered_values": false, "printer_width": 80, "strict_mode": false, "require_nested_cumulative_type_params": false, "log_level_file": "debug", "use_colors": true, "defer": false, "require_generic_test_arguments_property": true, "require_explicit_package_overrides_for_builtin_materializations": true, "log_level": "info", "send_anonymous_usage_stats": true, "full_refresh": true, "empty": false, "show_all_deprecations": false, "which": "build", "static_parser": true, "use_fast_test_edges": false, "project_dir": "/dbt", "resource_types": [], "show_resource_report": false, "cache_selected_only": false, "include_saved_query": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "require_resource_names_without_spaces": true, "macro_debugging": false, "populate_cache": true, "show": false, "state_modified_compare_vars": false, "vars": {}, "exclude_resource_types": [], "introspect": true, "validate_macro_args": false, "source_freshness_run_project_hooks": true, "version_check": true, "profiles_dir": ".", "quiet": false}}