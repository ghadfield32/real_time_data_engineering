# Data quality validation â€” checks cleaned data quality in the fact table
# Note: Silver Iceberg table is read by dbt and materialized into fct_trips.
# Thresholds calibrated for 10k-event benchmark runs (~9,855 Silver rows).
checks for fct_trips:
  - row_count > 5000:
      name: "Fact table has expected volume"
  - duplicate_count(trip_id) = 0:
      name: "No duplicate trip IDs"
  - avg(fare_amount) between 5 and 30:
      name: "Average fare in reasonable range"
  - min(fare_amount) >= 0:
      name: "No negative fares"
